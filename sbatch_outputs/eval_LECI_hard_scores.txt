nohup: ignoring input
Time to evaluate models!

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:11:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mId_val ACCURACY: 0.8883Id_val Loss: 0.4567
Id_test ACCURACY: 0.8753Id_test Loss: 0.4923
Test ACCURACY: 0.8990Test Loss: 0.4482


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:11:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mId_val ACCURACY: 0.8927Id_val Loss: 0.4355
Id_test ACCURACY: 0.8933Id_test Loss: 0.4533
Test ACCURACY: 0.8907Test Loss: 0.4426


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:11:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mId_val ACCURACY: 0.9150Id_val Loss: 0.3813
Id_test ACCURACY: 0.9053Id_test Loss: 0.4430
Test ACCURACY: 0.7097Test Loss: 0.7779


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:11:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mId_val ACCURACY: 0.8940Id_val Loss: 0.5266
Id_test ACCURACY: 0.8807Id_test Loss: 0.5593
Test ACCURACY: 0.9053Test Loss: 0.4999


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:11:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:11:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mId_val ACCURACY: 0.8910Id_val Loss: 0.4744
Id_test ACCURACY: 0.8860Id_test Loss: 0.5215
Test ACCURACY: 0.8647Test Loss: 0.5046


Final accuracies: 
ID_VAL     = 0.896 +- 0.010
ID_TEST    = 0.888 +- 0.010
TEST       = 0.854 +- 0.073

Final losses: 
ID_VAL     = 0.4549 +- 0.0476
ID_TEST    = 0.4939 +- 0.0431
TEST       = 0.5346 +- 0.1243
Diff id_val-test  = 0.0797 
DONE EVAL LECI GOODMotif2/basis default

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:12:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:15 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:15 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:15 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.8919
Train Loss: 0.4402
ID Validation ACCURACY: 0.8920
ID Validation Loss: 0.4334
ID Test ACCURACY: 0.8870
ID Test Loss: 0.4639
OOD Validation ACCURACY: 0.7780
OOD Validation Loss: 0.6049
OOD Test ACCURACY: 0.7937
OOD Test Loss: 0.6760

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.8381
Train Loss: 0.5254
ID Validation ACCURACY: 0.8367
ID Validation Loss: 0.5281
ID Test ACCURACY: 0.8403
ID Test Loss: 0.5399
OOD Validation ACCURACY: 0.9063
OOD Validation Loss: 0.5418
OOD Test ACCURACY: 0.8933
OOD Test Loss: 0.4537

[0m[1;37mINFO[0m: [1mChartInfo 0.8870 0.7937 0.8403 0.8933 0.8367 0.9063[0mId_val ACCURACY: 0.8920Id_val Loss: 0.4334
Id_test ACCURACY: 0.8870Id_test Loss: 0.4639
Test ACCURACY: 0.7937Test Loss: 0.6760


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:12:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ACCURACY: 0.8941
Train Loss: 0.4387
ID Validation ACCURACY: 0.8933
ID Validation Loss: 0.4199
ID Test ACCURACY: 0.8857
ID Test Loss: 0.4740
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.4243
OOD Test ACCURACY: 0.9167
OOD Test Loss: 0.3882

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ACCURACY: 0.8941
Train Loss: 0.4387
ID Validation ACCURACY: 0.8933
ID Validation Loss: 0.4199
ID Test ACCURACY: 0.8857
ID Test Loss: 0.4740
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.4243
OOD Test ACCURACY: 0.9167
OOD Test Loss: 0.3882

[0m[1;37mINFO[0m: [1mChartInfo 0.8857 0.9167 0.8857 0.9167 0.8933 0.9263[0mId_val ACCURACY: 0.8933Id_val Loss: 0.4199
Id_test ACCURACY: 0.8857Id_test Loss: 0.4740
Test ACCURACY: 0.9167Test Loss: 0.3882


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:12:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8840
Train Loss: 0.4621
ID Validation ACCURACY: 0.8847
ID Validation Loss: 0.4565
ID Test ACCURACY: 0.8710
ID Test Loss: 0.4904
OOD Validation ACCURACY: 0.8557
OOD Validation Loss: 0.5559
OOD Test ACCURACY: 0.8713
OOD Test Loss: 0.4670

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 118...
[0m[1;37mINFO[0m: [1mCheckpoint 118: 
-----------------------------------
Train ACCURACY: 0.8378
Train Loss: 0.5626
ID Validation ACCURACY: 0.8373
ID Validation Loss: 0.5631
ID Test ACCURACY: 0.8380
ID Test Loss: 0.5713
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.5173
OOD Test ACCURACY: 0.8860
OOD Test Loss: 0.4481

[0m[1;37mINFO[0m: [1mChartInfo 0.8710 0.8713 0.8380 0.8860 0.8373 0.9187[0mId_val ACCURACY: 0.8847Id_val Loss: 0.4565
Id_test ACCURACY: 0.8710Id_test Loss: 0.4904
Test ACCURACY: 0.8713Test Loss: 0.4670


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:12:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 131...
[0m[1;37mINFO[0m: [1mCheckpoint 131: 
-----------------------------------
Train ACCURACY: 0.8867
Train Loss: 0.4438
ID Validation ACCURACY: 0.8937
ID Validation Loss: 0.4262
ID Test ACCURACY: 0.8900
ID Test Loss: 0.4573
OOD Validation ACCURACY: 0.8703
OOD Validation Loss: 0.5403
OOD Test ACCURACY: 0.8920
OOD Test Loss: 0.4081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 151...
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.8267
Train Loss: 0.5441
ID Validation ACCURACY: 0.8370
ID Validation Loss: 0.5474
ID Test ACCURACY: 0.8303
ID Test Loss: 0.5671
OOD Validation ACCURACY: 0.8900
OOD Validation Loss: 0.5611
OOD Test ACCURACY: 0.7843
OOD Test Loss: 0.6018

[0m[1;37mINFO[0m: [1mChartInfo 0.8900 0.8920 0.8303 0.7843 0.8370 0.8900[0mId_val ACCURACY: 0.8937Id_val Loss: 0.4262
Id_test ACCURACY: 0.8900Id_test Loss: 0.4573
Test ACCURACY: 0.8920Test Loss: 0.4081


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:12:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:32 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:32 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:32 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:12:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.8653
Train Loss: 0.4841
ID Validation ACCURACY: 0.8673
ID Validation Loss: 0.4704
ID Test ACCURACY: 0.8673
ID Test Loss: 0.4934
OOD Validation ACCURACY: 0.8580
OOD Validation Loss: 0.5922
OOD Test ACCURACY: 0.8357
OOD Test Loss: 0.5047

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ACCURACY: 0.8568
Train Loss: 0.4933
ID Validation ACCURACY: 0.8580
ID Validation Loss: 0.4774
ID Test ACCURACY: 0.8570
ID Test Loss: 0.5011
OOD Validation ACCURACY: 0.8980
OOD Validation Loss: 0.5087
OOD Test ACCURACY: 0.8823
OOD Test Loss: 0.4434

[0m[1;37mINFO[0m: [1mChartInfo 0.8673 0.8357 0.8570 0.8823 0.8580 0.8980[0mId_val ACCURACY: 0.8673Id_val Loss: 0.4704
Id_test ACCURACY: 0.8673Id_test Loss: 0.4934
Test ACCURACY: 0.8357Test Loss: 0.5047


Final accuracies: 
ID_VAL     = 0.886 +- 0.010
ID_TEST    = 0.880 +- 0.009
TEST       = 0.862 +- 0.043

Final losses: 
ID_VAL     = 0.4413 +- 0.0191
ID_TEST    = 0.4758 +- 0.0142
TEST       = 0.4888 +- 0.1024
Diff id_val-test  = 0.0475 
DONE EVAL LECI GOODMotif2/basis hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:13:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 190...
[0m[1;37mINFO[0m: [1mCheckpoint 190: 
-----------------------------------
Train ACCURACY: 0.9133
Train Loss: 0.4290
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.4031
ID Test ACCURACY: 0.9080
ID Test Loss: 0.4515
OOD Validation ACCURACY: 0.9227
OOD Validation Loss: 0.3936
OOD Test ACCURACY: 0.8737
OOD Test Loss: 0.4903

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 104...
[0m[1;37mINFO[0m: [1mCheckpoint 104: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.4715
ID Validation ACCURACY: 0.8663
ID Validation Loss: 0.4430
ID Test ACCURACY: 0.8633
ID Test Loss: 0.4820
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3746
OOD Test ACCURACY: 0.7837
OOD Test Loss: 0.6415

[0m[1;37mINFO[0m: [1mChartInfo 0.9080 0.8737 0.8633 0.7837 0.8663 0.9313[0mId_val ACCURACY: 0.9237Id_val Loss: 0.4031
Id_test ACCURACY: 0.9080Id_test Loss: 0.4515
Test ACCURACY: 0.8737Test Loss: 0.4903


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:13:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9118
Train Loss: 0.4030
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.3794
ID Test ACCURACY: 0.9047
ID Test Loss: 0.4384
OOD Validation ACCURACY: 0.9233
OOD Validation Loss: 0.3768
OOD Test ACCURACY: 0.8853
OOD Test Loss: 0.4748

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 113...
[0m[1;37mINFO[0m: [1mCheckpoint 113: 
-----------------------------------
Train ACCURACY: 0.8885
Train Loss: 0.4487
ID Validation ACCURACY: 0.8923
ID Validation Loss: 0.4387
ID Test ACCURACY: 0.8827
ID Test Loss: 0.4705
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.4388
OOD Test ACCURACY: 0.7740
OOD Test Loss: 0.7590

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.8853 0.8827 0.7740 0.8923 0.9290[0mId_val ACCURACY: 0.9210Id_val Loss: 0.3794
Id_test ACCURACY: 0.9047Id_test Loss: 0.4384
Test ACCURACY: 0.8853Test Loss: 0.4748


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:13:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.8932
Train Loss: 0.4562
ID Validation ACCURACY: 0.9020
ID Validation Loss: 0.4325
ID Test ACCURACY: 0.8937
ID Test Loss: 0.4701
OOD Validation ACCURACY: 0.9143
OOD Validation Loss: 0.4605
OOD Test ACCURACY: 0.8143
OOD Test Loss: 0.5237

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.8433
Train Loss: 0.5132
ID Validation ACCURACY: 0.8480
ID Validation Loss: 0.5068
ID Test ACCURACY: 0.8413
ID Test Loss: 0.5417
OOD Validation ACCURACY: 0.9147
OOD Validation Loss: 0.5475
OOD Test ACCURACY: 0.8277
OOD Test Loss: 0.5372

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.8143 0.8413 0.8277 0.8480 0.9147[0mId_val ACCURACY: 0.9020Id_val Loss: 0.4325
Id_test ACCURACY: 0.8937Id_test Loss: 0.4701
Test ACCURACY: 0.8143Test Loss: 0.5237


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:13:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ACCURACY: 0.9057
Train Loss: 0.4303
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4156
ID Test ACCURACY: 0.8993
ID Test Loss: 0.4653
OOD Validation ACCURACY: 0.9207
OOD Validation Loss: 0.4392
OOD Test ACCURACY: 0.8143
OOD Test Loss: 0.4806

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 142...
[0m[1;37mINFO[0m: [1mCheckpoint 142: 
-----------------------------------
Train ACCURACY: 0.8659
Train Loss: 0.5021
ID Validation ACCURACY: 0.8630
ID Validation Loss: 0.5023
ID Test ACCURACY: 0.8600
ID Test Loss: 0.5351
OOD Validation ACCURACY: 0.9283
OOD Validation Loss: 0.4432
OOD Test ACCURACY: 0.7227
OOD Test Loss: 0.7492

[0m[1;37mINFO[0m: [1mChartInfo 0.8993 0.8143 0.8600 0.7227 0.8630 0.9283[0mId_val ACCURACY: 0.9100Id_val Loss: 0.4156
Id_test ACCURACY: 0.8993Id_test Loss: 0.4653
Test ACCURACY: 0.8143Test Loss: 0.4806


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:13:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.9087
Train Loss: 0.4218
ID Validation ACCURACY: 0.9160
ID Validation Loss: 0.3999
ID Test ACCURACY: 0.9063
ID Test Loss: 0.4570
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.4378
OOD Test ACCURACY: 0.7653
OOD Test Loss: 0.7567

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 126...
[0m[1;37mINFO[0m: [1mCheckpoint 126: 
-----------------------------------
Train ACCURACY: 0.8616
Train Loss: 0.5039
ID Validation ACCURACY: 0.8560
ID Validation Loss: 0.5048
ID Test ACCURACY: 0.8567
ID Test Loss: 0.5356
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4136
OOD Test ACCURACY: 0.7727
OOD Test Loss: 0.6722

[0m[1;37mINFO[0m: [1mChartInfo 0.9063 0.7653 0.8567 0.7727 0.8560 0.9293[0mId_val ACCURACY: 0.9160Id_val Loss: 0.3999
Id_test ACCURACY: 0.9063Id_test Loss: 0.4570
Test ACCURACY: 0.7653Test Loss: 0.7567


Final accuracies: 
ID_VAL     = 0.915 +- 0.008
ID_TEST    = 0.902 +- 0.005
TEST       = 0.831 +- 0.044

Final losses: 
ID_VAL     = 0.4061 +- 0.0176
ID_TEST    = 0.4565 +- 0.0111
TEST       = 0.5452 +- 0.1071
Diff id_val-test  = 0.1391 
DONE EVAL LECI GOODMotif2/basis anneal

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:13:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:13:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 174...
[0m[1;37mINFO[0m: [1mCheckpoint 174: 
-----------------------------------
Train ROC-AUC: 0.9747
Train Loss: 0.1592
ID Validation ROC-AUC: 0.9216
ID Validation Loss: 0.3096
ID Test ROC-AUC: 0.9242
ID Test Loss: 0.3130
OOD Validation ROC-AUC: 0.6625
OOD Validation Loss: 0.4639
OOD Test ROC-AUC: 0.7200
OOD Test Loss: 0.6879

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ROC-AUC: 0.9117
Train Loss: 0.2596
ID Validation ROC-AUC: 0.8990
ID Validation Loss: 0.2737
ID Test ROC-AUC: 0.9017
ID Test Loss: 0.2762
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.2996
OOD Test ROC-AUC: 0.7346
OOD Test Loss: 0.4781

[0m[1;37mINFO[0m: [1mChartInfo 0.9242 0.7200 0.9017 0.7346 0.8990 0.6935[0mId_val ROC-AUC: 0.9216Id_val Loss: 0.3096
Id_test ROC-AUC: 0.9242Id_test Loss: 0.3130
Test ROC-AUC: 0.7200Test Loss: 0.6879


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:14:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9783
Train Loss: 0.1269
ID Validation ROC-AUC: 0.9244
ID Validation Loss: 0.2658
ID Test ROC-AUC: 0.9267
ID Test Loss: 0.2679
OOD Validation ROC-AUC: 0.6593
OOD Validation Loss: 0.4783
OOD Test ROC-AUC: 0.7128
OOD Test Loss: 0.6262

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9086
Train Loss: 0.2436
ID Validation ROC-AUC: 0.8959
ID Validation Loss: 0.2566
ID Test ROC-AUC: 0.8988
ID Test Loss: 0.2585
OOD Validation ROC-AUC: 0.6869
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7309
OOD Test Loss: 0.4531

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.7128 0.8988 0.7309 0.8959 0.6869[0mId_val ROC-AUC: 0.9244Id_val Loss: 0.2658
Id_test ROC-AUC: 0.9267Id_test Loss: 0.2679
Test ROC-AUC: 0.7128Test Loss: 0.6262


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:14:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:32 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ROC-AUC: 0.9586
Train Loss: 0.1793
ID Validation ROC-AUC: 0.9217
ID Validation Loss: 0.2533
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2525
OOD Validation ROC-AUC: 0.6759
OOD Validation Loss: 0.3745
OOD Test ROC-AUC: 0.7109
OOD Test Loss: 0.5685

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ROC-AUC: 0.9479
Train Loss: 0.1985
ID Validation ROC-AUC: 0.9155
ID Validation Loss: 0.2618
ID Test ROC-AUC: 0.9197
ID Test Loss: 0.2606
OOD Validation ROC-AUC: 0.6885
OOD Validation Loss: 0.3598
OOD Test ROC-AUC: 0.7250
OOD Test Loss: 0.5469

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7109 0.9197 0.7250 0.9155 0.6885[0mId_val ROC-AUC: 0.9217Id_val Loss: 0.2533
Id_test ROC-AUC: 0.9244Id_test Loss: 0.2525
Test ROC-AUC: 0.7109Test Loss: 0.5685


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:14:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:14:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ROC-AUC: 0.9561
Train Loss: 0.1699
ID Validation ROC-AUC: 0.9223
ID Validation Loss: 0.2340
ID Test ROC-AUC: 0.9235
ID Test Loss: 0.2358
OOD Validation ROC-AUC: 0.6576
OOD Validation Loss: 0.3970
OOD Test ROC-AUC: 0.7067
OOD Test Loss: 0.5494

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ROC-AUC: 0.9016
Train Loss: 0.2482
ID Validation ROC-AUC: 0.8949
ID Validation Loss: 0.2557
ID Test ROC-AUC: 0.8953
ID Test Loss: 0.2587
OOD Validation ROC-AUC: 0.6908
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7285
OOD Test Loss: 0.4503

[0m[1;37mINFO[0m: [1mChartInfo 0.9235 0.7067 0.8953 0.7285 0.8949 0.6908[0mId_val ROC-AUC: 0.9223Id_val Loss: 0.2340
Id_test ROC-AUC: 0.9235Id_test Loss: 0.2358
Test ROC-AUC: 0.7067Test Loss: 0.5494


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:15:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:15:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ROC-AUC: 0.9604
Train Loss: 0.1577
ID Validation ROC-AUC: 0.9213
ID Validation Loss: 0.2276
ID Test ROC-AUC: 0.9231
ID Test Loss: 0.2288
OOD Validation ROC-AUC: 0.6638
OOD Validation Loss: 0.4052
OOD Test ROC-AUC: 0.7105
OOD Test Loss: 0.5421

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ROC-AUC: 0.8989
Train Loss: 0.2529
ID Validation ROC-AUC: 0.8912
ID Validation Loss: 0.2608
ID Test ROC-AUC: 0.8911
ID Test Loss: 0.2654
OOD Validation ROC-AUC: 0.6866
OOD Validation Loss: 0.2898
OOD Test ROC-AUC: 0.7229
OOD Test Loss: 0.4564

[0m[1;37mINFO[0m: [1mChartInfo 0.9231 0.7105 0.8911 0.7229 0.8912 0.6866[0mId_val ROC-AUC: 0.9213Id_val Loss: 0.2276
Id_test ROC-AUC: 0.9231Id_test Loss: 0.2288
Test ROC-AUC: 0.7105Test Loss: 0.5421


Final accuracies: 
ID_VAL     = 0.922 +- 0.001
ID_TEST    = 0.924 +- 0.001
TEST       = 0.712 +- 0.004

Final losses: 
ID_VAL     = 0.2580 +- 0.0291
ID_TEST    = 0.2596 +- 0.0300
TEST       = 0.5948 +- 0.0551
Diff id_val-test  = 0.3368 
DONE EVAL LECI LBAPcore/assay default

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:16:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ROC-AUC: 0.9405
Train Loss: 0.1942
ID Validation ROC-AUC: 0.9147
ID Validation Loss: 0.2335
ID Test ROC-AUC: 0.9139
ID Test Loss: 0.2386
OOD Validation ROC-AUC: 0.6753
OOD Validation Loss: 0.3634
OOD Test ROC-AUC: 0.7237
OOD Test Loss: 0.5074

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 32...
[0m[1;37mINFO[0m: [1mCheckpoint 32: 
-----------------------------------
Train ROC-AUC: 0.9080
Train Loss: 0.2574
ID Validation ROC-AUC: 0.8953
ID Validation Loss: 0.2724
ID Test ROC-AUC: 0.8989
ID Test Loss: 0.2750
OOD Validation ROC-AUC: 0.6820
OOD Validation Loss: 0.3270
OOD Test ROC-AUC: 0.7152
OOD Test Loss: 0.5211

[0m[1;37mINFO[0m: [1mChartInfo 0.9139 0.7237 0.8989 0.7152 0.8953 0.6820[0mId_val ROC-AUC: 0.9147Id_val Loss: 0.2335
Id_test ROC-AUC: 0.9139Id_test Loss: 0.2386
Test ROC-AUC: 0.7237Test Loss: 0.5074


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:16:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:16:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ROC-AUC: 0.9425
Train Loss: 0.2003
ID Validation ROC-AUC: 0.9150
ID Validation Loss: 0.2409
ID Test ROC-AUC: 0.9183
ID Test Loss: 0.2410
OOD Validation ROC-AUC: 0.6828
OOD Validation Loss: 0.3429
OOD Test ROC-AUC: 0.7205
OOD Test Loss: 0.5074

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ROC-AUC: 0.9245
Train Loss: 0.2217
ID Validation ROC-AUC: 0.9060
ID Validation Loss: 0.2463
ID Test ROC-AUC: 0.9075
ID Test Loss: 0.2497
OOD Validation ROC-AUC: 0.6846
OOD Validation Loss: 0.3341
OOD Test ROC-AUC: 0.7191
OOD Test Loss: 0.5035

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.7205 0.9075 0.7191 0.9060 0.6846[0mId_val ROC-AUC: 0.9150Id_val Loss: 0.2409
Id_test ROC-AUC: 0.9183Id_test Loss: 0.2410
Test ROC-AUC: 0.7205Test Loss: 0.5074


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:17:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9569
Train Loss: 0.1864
ID Validation ROC-AUC: 0.9175
ID Validation Loss: 0.2713
ID Test ROC-AUC: 0.9203
ID Test Loss: 0.2713
OOD Validation ROC-AUC: 0.6411
OOD Validation Loss: 0.4568
OOD Test ROC-AUC: 0.7036
OOD Test Loss: 0.6502

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ROC-AUC: 0.9073
Train Loss: 0.2446
ID Validation ROC-AUC: 0.8959
ID Validation Loss: 0.2560
ID Test ROC-AUC: 0.8982
ID Test Loss: 0.2587
OOD Validation ROC-AUC: 0.6940
OOD Validation Loss: 0.2990
OOD Test ROC-AUC: 0.7231
OOD Test Loss: 0.4718

[0m[1;37mINFO[0m: [1mChartInfo 0.9203 0.7036 0.8982 0.7231 0.8959 0.6940[0mId_val ROC-AUC: 0.9175Id_val Loss: 0.2713
Id_test ROC-AUC: 0.9203Id_test Loss: 0.2713
Test ROC-AUC: 0.7036Test Loss: 0.6502


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:17:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:17:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ROC-AUC: 0.9447
Train Loss: 0.1827
ID Validation ROC-AUC: 0.9169
ID Validation Loss: 0.2215
ID Test ROC-AUC: 0.9158
ID Test Loss: 0.2272
OOD Validation ROC-AUC: 0.6674
OOD Validation Loss: 0.3692
OOD Test ROC-AUC: 0.7147
OOD Test Loss: 0.4982

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ROC-AUC: 0.9068
Train Loss: 0.2273
ID Validation ROC-AUC: 0.8970
ID Validation Loss: 0.2363
ID Test ROC-AUC: 0.8980
ID Test Loss: 0.2379
OOD Validation ROC-AUC: 0.6903
OOD Validation Loss: 0.3044
OOD Test ROC-AUC: 0.7198
OOD Test Loss: 0.4398

[0m[1;37mINFO[0m: [1mChartInfo 0.9158 0.7147 0.8980 0.7198 0.8970 0.6903[0mId_val ROC-AUC: 0.9169Id_val Loss: 0.2215
Id_test ROC-AUC: 0.9158Id_test Loss: 0.2272
Test ROC-AUC: 0.7147Test Loss: 0.4982


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:18:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ROC-AUC: 0.9466
Train Loss: 0.1891
ID Validation ROC-AUC: 0.9179
ID Validation Loss: 0.2351
ID Test ROC-AUC: 0.9179
ID Test Loss: 0.2392
OOD Validation ROC-AUC: 0.6628
OOD Validation Loss: 0.3930
OOD Test ROC-AUC: 0.7160
OOD Test Loss: 0.5238

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ROC-AUC: 0.9058
Train Loss: 0.2379
ID Validation ROC-AUC: 0.8966
ID Validation Loss: 0.2461
ID Test ROC-AUC: 0.8970
ID Test Loss: 0.2496
OOD Validation ROC-AUC: 0.6940
OOD Validation Loss: 0.2886
OOD Test ROC-AUC: 0.7178
OOD Test Loss: 0.4448

[0m[1;37mINFO[0m: [1mChartInfo 0.9179 0.7160 0.8970 0.7178 0.8966 0.6940[0mId_val ROC-AUC: 0.9179Id_val Loss: 0.2351
Id_test ROC-AUC: 0.9179Id_test Loss: 0.2392
Test ROC-AUC: 0.7160Test Loss: 0.5238


Final accuracies: 
ID_VAL     = 0.916 +- 0.001
ID_TEST    = 0.917 +- 0.002
TEST       = 0.716 +- 0.007

Final losses: 
ID_VAL     = 0.2405 +- 0.0167
ID_TEST    = 0.2435 +- 0.0148
TEST       = 0.5374 +- 0.0570
Diff id_val-test  = 0.2969 
DONE EVAL LECI LBAPcore/assay hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:18:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:18:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 134...
[0m[1;37mINFO[0m: [1mCheckpoint 134: 
-----------------------------------
Train ROC-AUC: 0.9606
Train Loss: 0.1904
ID Validation ROC-AUC: 0.9212
ID Validation Loss: 0.2962
ID Test ROC-AUC: 0.9210
ID Test Loss: 0.3012
OOD Validation ROC-AUC: 0.6635
OOD Validation Loss: 0.4561
OOD Test ROC-AUC: 0.7091
OOD Test Loss: 0.6939

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 40...
[0m[1;37mINFO[0m: [1mCheckpoint 40: 
-----------------------------------
Train ROC-AUC: 0.9251
Train Loss: 0.2264
ID Validation ROC-AUC: 0.9081
ID Validation Loss: 0.2504
ID Test ROC-AUC: 0.9110
ID Test Loss: 0.2528
OOD Validation ROC-AUC: 0.6936
OOD Validation Loss: 0.3228
OOD Test ROC-AUC: 0.7297
OOD Test Loss: 0.4971

[0m[1;37mINFO[0m: [1mChartInfo 0.9210 0.7091 0.9110 0.7297 0.9081 0.6936[0mId_val ROC-AUC: 0.9212Id_val Loss: 0.2962
Id_test ROC-AUC: 0.9210Id_test Loss: 0.3012
Test ROC-AUC: 0.7091Test Loss: 0.6939


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:19:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ROC-AUC: 0.9605
Train Loss: 0.2505
ID Validation ROC-AUC: 0.9157
ID Validation Loss: 0.3918
ID Test ROC-AUC: 0.9192
ID Test Loss: 0.3917
OOD Validation ROC-AUC: 0.6648
OOD Validation Loss: 0.5222
OOD Test ROC-AUC: 0.7175
OOD Test Loss: 0.8314

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ROC-AUC: 0.9381
Train Loss: 0.2348
ID Validation ROC-AUC: 0.9119
ID Validation Loss: 0.2767
ID Test ROC-AUC: 0.9142
ID Test Loss: 0.2805
OOD Validation ROC-AUC: 0.6863
OOD Validation Loss: 0.3481
OOD Test ROC-AUC: 0.7199
OOD Test Loss: 0.5608

[0m[1;37mINFO[0m: [1mChartInfo 0.9192 0.7175 0.9142 0.7199 0.9119 0.6863[0mId_val ROC-AUC: 0.9157Id_val Loss: 0.3918
Id_test ROC-AUC: 0.9192Id_test Loss: 0.3917
Test ROC-AUC: 0.7175Test Loss: 0.8314


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:19:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:19:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 126...
[0m[1;37mINFO[0m: [1mCheckpoint 126: 
-----------------------------------
Train ROC-AUC: 0.9559
Train Loss: 0.2057
ID Validation ROC-AUC: 0.9210
ID Validation Loss: 0.2740
ID Test ROC-AUC: 0.9223
ID Test Loss: 0.2792
OOD Validation ROC-AUC: 0.6772
OOD Validation Loss: 0.3678
OOD Test ROC-AUC: 0.7146
OOD Test Loss: 0.5936

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 35...
[0m[1;37mINFO[0m: [1mCheckpoint 35: 
-----------------------------------
Train ROC-AUC: 0.9155
Train Loss: 0.2480
ID Validation ROC-AUC: 0.9024
ID Validation Loss: 0.2639
ID Test ROC-AUC: 0.9052
ID Test Loss: 0.2658
OOD Validation ROC-AUC: 0.7014
OOD Validation Loss: 0.3032
OOD Test ROC-AUC: 0.7263
OOD Test Loss: 0.4896

[0m[1;37mINFO[0m: [1mChartInfo 0.9223 0.7146 0.9052 0.7263 0.9024 0.7014[0mId_val ROC-AUC: 0.9210Id_val Loss: 0.2740
Id_test ROC-AUC: 0.9223Id_test Loss: 0.2792
Test ROC-AUC: 0.7146Test Loss: 0.5936


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:20:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ROC-AUC: 0.9637
Train Loss: 0.1733
ID Validation ROC-AUC: 0.9197
ID Validation Loss: 0.2855
ID Test ROC-AUC: 0.9230
ID Test Loss: 0.2842
OOD Validation ROC-AUC: 0.6698
OOD Validation Loss: 0.4491
OOD Test ROC-AUC: 0.7168
OOD Test Loss: 0.6524

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 32...
[0m[1;37mINFO[0m: [1mCheckpoint 32: 
-----------------------------------
Train ROC-AUC: 0.9142
Train Loss: 0.2487
ID Validation ROC-AUC: 0.8961
ID Validation Loss: 0.2652
ID Test ROC-AUC: 0.9014
ID Test Loss: 0.2653
OOD Validation ROC-AUC: 0.6964
OOD Validation Loss: 0.2900
OOD Test ROC-AUC: 0.7264
OOD Test Loss: 0.4688

[0m[1;37mINFO[0m: [1mChartInfo 0.9230 0.7168 0.9014 0.7264 0.8961 0.6964[0mId_val ROC-AUC: 0.9197Id_val Loss: 0.2855
Id_test ROC-AUC: 0.9230Id_test Loss: 0.2842
Test ROC-AUC: 0.7168Test Loss: 0.6524


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:20:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:20:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ROC-AUC: 0.9564
Train Loss: 0.2145
ID Validation ROC-AUC: 0.9201
ID Validation Loss: 0.3048
ID Test ROC-AUC: 0.9208
ID Test Loss: 0.3133
OOD Validation ROC-AUC: 0.6613
OOD Validation Loss: 0.4567
OOD Test ROC-AUC: 0.7128
OOD Test Loss: 0.6765

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ROC-AUC: 0.9022
Train Loss: 0.2623
ID Validation ROC-AUC: 0.8925
ID Validation Loss: 0.2723
ID Test ROC-AUC: 0.8954
ID Test Loss: 0.2749
OOD Validation ROC-AUC: 0.6933
OOD Validation Loss: 0.3003
OOD Test ROC-AUC: 0.7343
OOD Test Loss: 0.4787

[0m[1;37mINFO[0m: [1mChartInfo 0.9208 0.7128 0.8954 0.7343 0.8925 0.6933[0mId_val ROC-AUC: 0.9201Id_val Loss: 0.3048
Id_test ROC-AUC: 0.9208Id_test Loss: 0.3133
Test ROC-AUC: 0.7128Test Loss: 0.6765


Final accuracies: 
ID_VAL     = 0.920 +- 0.002
ID_TEST    = 0.921 +- 0.001
TEST       = 0.714 +- 0.003

Final losses: 
ID_VAL     = 0.3105 +- 0.0420
ID_TEST    = 0.3139 +- 0.0408
TEST       = 0.6896 +- 0.0786
Diff id_val-test  = 0.3791 
DONE EVAL LECI LBAPcore/assay anneal

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:21:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:21:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9879
Train Loss: 0.0408
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3836
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3737
OOD Validation ACCURACY: 0.8210
OOD Validation Loss: 0.7581
OOD Test ACCURACY: 0.3357
OOD Test Loss: 4.8493

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ACCURACY: 0.9669
Train Loss: 0.1038
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3636
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3454
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.3944
OOD Test ACCURACY: 0.5937
OOD Test Loss: 1.5026

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.3357 0.8920 0.5937 0.8889 0.8796[0mId_val ACCURACY: 0.9473Id_val Loss: 0.1843
Id_test ACCURACY: 0.9476Id_test Loss: 0.1860
Test ACCURACY: 0.3371Test Loss: 4.7760


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:22:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9954
Train Loss: 0.0235
ID Validation ACCURACY: 0.9044
ID Validation Loss: 0.3485
ID Test ACCURACY: 0.8980
ID Test Loss: 0.3777
OOD Validation ACCURACY: 0.8489
OOD Validation Loss: 0.5902
OOD Test ACCURACY: 0.4007
OOD Test Loss: 3.1852

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9265
Train Loss: 0.2243
ID Validation ACCURACY: 0.8853
ID Validation Loss: 0.3617
ID Test ACCURACY: 0.8787
ID Test Loss: 0.3669
OOD Validation ACCURACY: 0.8706
OOD Validation Loss: 0.3979
OOD Test ACCURACY: 0.4916
OOD Test Loss: 2.4039

[0m[1;37mINFO[0m: [1mChartInfo 0.8980 0.4007 0.8787 0.4916 0.8853 0.8706[0mId_val ACCURACY: 0.9556Id_val Loss: 0.1634
Id_test ACCURACY: 0.9529Id_test Loss: 0.1732
Test ACCURACY: 0.3989Test Loss: 3.1366


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:22:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0184
ID Validation ACCURACY: 0.8971
ID Validation Loss: 0.4034
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3939
OOD Validation ACCURACY: 0.7454
OOD Validation Loss: 1.2265
OOD Test ACCURACY: 0.2080
OOD Test Loss: 15.1594

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.9543
Train Loss: 0.1370
ID Validation ACCURACY: 0.8837
ID Validation Loss: 0.3612
ID Test ACCURACY: 0.8867
ID Test Loss: 0.3557
OOD Validation ACCURACY: 0.8760
OOD Validation Loss: 0.3949
OOD Test ACCURACY: 0.6457
OOD Test Loss: 1.3561

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.2080 0.8867 0.6457 0.8837 0.8760[0mId_val ACCURACY: 0.9577Id_val Loss: 0.1681
Id_test ACCURACY: 0.9529Id_test Loss: 0.1957
Test ACCURACY: 0.2174Test Loss: 15.1381


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:22:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:22:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:22:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.9953
Train Loss: 0.0210
ID Validation ACCURACY: 0.8947
ID Validation Loss: 0.4144
ID Test ACCURACY: 0.8940
ID Test Loss: 0.4075
OOD Validation ACCURACY: 0.8159
OOD Validation Loss: 0.9172
OOD Test ACCURACY: 0.1800
OOD Test Loss: 30.3619

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9521
Train Loss: 0.1419
ID Validation ACCURACY: 0.8747
ID Validation Loss: 0.3859
ID Test ACCURACY: 0.8801
ID Test Loss: 0.3806
OOD Validation ACCURACY: 0.8700
OOD Validation Loss: 0.4310
OOD Test ACCURACY: 0.7046
OOD Test Loss: 1.0001

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1800 0.8801 0.7046 0.8747 0.8700[0mId_val ACCURACY: 0.9569Id_val Loss: 0.1716
Id_test ACCURACY: 0.9524Id_test Loss: 0.1856
Test ACCURACY: 0.1794Test Loss: 30.9420


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:23:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 177...
[0m[1;37mINFO[0m: [1mCheckpoint 177: 
-----------------------------------
Train ACCURACY: 0.9977
Train Loss: 0.0148
ID Validation ACCURACY: 0.8996
ID Validation Loss: 0.3885
ID Test ACCURACY: 0.8940
ID Test Loss: 0.3976
OOD Validation ACCURACY: 0.6997
OOD Validation Loss: 1.7319
OOD Test ACCURACY: 0.1520
OOD Test Loss: 75.5642

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9054
Train Loss: 0.2814
ID Validation ACCURACY: 0.8654
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.8644
ID Test Loss: 0.4072
OOD Validation ACCURACY: 0.8570
OOD Validation Loss: 0.4363
OOD Test ACCURACY: 0.7327
OOD Test Loss: 0.9882

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1520 0.8644 0.7327 0.8654 0.8570[0mId_val ACCURACY: 0.9586Id_val Loss: 0.1679
Id_test ACCURACY: 0.9551Id_test Loss: 0.1825
Test ACCURACY: 0.1467Test Loss: 76.6868


Final accuracies: 
ID_VAL     = 0.955 +- 0.004
ID_TEST    = 0.952 +- 0.002
TEST       = 0.256 +- 0.096

Final losses: 
ID_VAL     = 0.1710 +- 0.0071
ID_TEST    = 0.1846 +- 0.0072
TEST       = 26.1359 +- 27.1465
Diff id_val-test  = 25.9649 
DONE EVAL LECI GOODCMNIST/color default

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:23:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:23:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9865
Train Loss: 0.0496
ID Validation ACCURACY: 0.9023
ID Validation Loss: 0.3348
ID Test ACCURACY: 0.8950
ID Test Loss: 0.3490
OOD Validation ACCURACY: 0.8601
OOD Validation Loss: 0.5178
OOD Test ACCURACY: 0.5090
OOD Test Loss: 2.2948

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 152...
[0m[1;37mINFO[0m: [1mCheckpoint 152: 
-----------------------------------
Train ACCURACY: 0.9802
Train Loss: 0.0672
ID Validation ACCURACY: 0.8973
ID Validation Loss: 0.3395
ID Test ACCURACY: 0.8970
ID Test Loss: 0.3382
OOD Validation ACCURACY: 0.8766
OOD Validation Loss: 0.4130
OOD Test ACCURACY: 0.7004
OOD Test Loss: 1.1259

[0m[1;37mINFO[0m: [1mChartInfo 0.8950 0.5090 0.8970 0.7004 0.8973 0.8766[0mId_val ACCURACY: 0.9500Id_val Loss: 0.1679
Id_test ACCURACY: 0.9474Id_test Loss: 0.1840
Test ACCURACY: 0.5100Test Loss: 2.2428


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:24:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 170...
[0m[1;37mINFO[0m: [1mCheckpoint 170: 
-----------------------------------
Train ACCURACY: 0.9906
Train Loss: 0.0371
ID Validation ACCURACY: 0.9056
ID Validation Loss: 0.3352
ID Test ACCURACY: 0.9003
ID Test Loss: 0.3439
OOD Validation ACCURACY: 0.8774
OOD Validation Loss: 0.4662
OOD Test ACCURACY: 0.3624
OOD Test Loss: 5.2321

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9487
Train Loss: 0.1558
ID Validation ACCURACY: 0.8891
ID Validation Loss: 0.3358
ID Test ACCURACY: 0.8887
ID Test Loss: 0.3454
OOD Validation ACCURACY: 0.8904
OOD Validation Loss: 0.3545
OOD Test ACCURACY: 0.5050
OOD Test Loss: 2.1260

[0m[1;37mINFO[0m: [1mChartInfo 0.9003 0.3624 0.8887 0.5050 0.8891 0.8904[0mId_val ACCURACY: 0.9549Id_val Loss: 0.1613
Id_test ACCURACY: 0.9549Id_test Loss: 0.1670
Test ACCURACY: 0.3646Test Loss: 5.1827


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:24:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:24:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9966
Train Loss: 0.0179
ID Validation ACCURACY: 0.9039
ID Validation Loss: 0.3644
ID Test ACCURACY: 0.9053
ID Test Loss: 0.3586
OOD Validation ACCURACY: 0.7946
OOD Validation Loss: 0.9352
OOD Test ACCURACY: 0.2296
OOD Test Loss: 9.8341

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9394
Train Loss: 0.1848
ID Validation ACCURACY: 0.8913
ID Validation Loss: 0.3438
ID Test ACCURACY: 0.8839
ID Test Loss: 0.3521
OOD Validation ACCURACY: 0.8734
OOD Validation Loss: 0.3847
OOD Test ACCURACY: 0.7427
OOD Test Loss: 0.8389

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.2296 0.8839 0.7427 0.8913 0.8734[0mId_val ACCURACY: 0.9589Id_val Loss: 0.1554
Id_test ACCURACY: 0.9571Id_test Loss: 0.1710
Test ACCURACY: 0.2237Test Loss: 9.8415


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:24:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9944
Train Loss: 0.0239
ID Validation ACCURACY: 0.8983
ID Validation Loss: 0.3773
ID Test ACCURACY: 0.8936
ID Test Loss: 0.3920
OOD Validation ACCURACY: 0.8399
OOD Validation Loss: 0.6466
OOD Test ACCURACY: 0.2553
OOD Test Loss: 5.9224

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.9490
Train Loss: 0.1516
ID Validation ACCURACY: 0.8876
ID Validation Loss: 0.3446
ID Test ACCURACY: 0.8911
ID Test Loss: 0.3452
OOD Validation ACCURACY: 0.8807
OOD Validation Loss: 0.3782
OOD Test ACCURACY: 0.6684
OOD Test Loss: 1.1653

[0m[1;37mINFO[0m: [1mChartInfo 0.8936 0.2553 0.8911 0.6684 0.8876 0.8807[0mId_val ACCURACY: 0.9566Id_val Loss: 0.1745
Id_test ACCURACY: 0.9516Id_test Loss: 0.1824
Test ACCURACY: 0.2560Test Loss: 5.8811


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:25:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:25:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 181...
[0m[1;37mINFO[0m: [1mCheckpoint 181: 
-----------------------------------
Train ACCURACY: 0.9917
Train Loss: 0.0313
ID Validation ACCURACY: 0.9021
ID Validation Loss: 0.3555
ID Test ACCURACY: 0.8964
ID Test Loss: 0.3775
OOD Validation ACCURACY: 0.8617
OOD Validation Loss: 0.5250
OOD Test ACCURACY: 0.3239
OOD Test Loss: 6.1359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9405
Train Loss: 0.1783
ID Validation ACCURACY: 0.8880
ID Validation Loss: 0.3388
ID Test ACCURACY: 0.8861
ID Test Loss: 0.3539
OOD Validation ACCURACY: 0.8879
OOD Validation Loss: 0.3554
OOD Test ACCURACY: 0.7159
OOD Test Loss: 1.1142

[0m[1;37mINFO[0m: [1mChartInfo 0.8964 0.3239 0.8861 0.7159 0.8880 0.8879[0mId_val ACCURACY: 0.9553Id_val Loss: 0.1643
Id_test ACCURACY: 0.9529Id_test Loss: 0.1882
Test ACCURACY: 0.3390Test Loss: 6.0203


Final accuracies: 
ID_VAL     = 0.955 +- 0.003
ID_TEST    = 0.953 +- 0.003
TEST       = 0.339 +- 0.100

Final losses: 
ID_VAL     = 0.1647 +- 0.0064
ID_TEST    = 0.1785 +- 0.0081
TEST       = 5.8337 +- 2.4256
Diff id_val-test  = 5.6690 
DONE EVAL LECI GOODCMNIST/color hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:26:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9973
Train Loss: 0.0144
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.3711
ID Test ACCURACY: 0.9004
ID Test Loss: 0.3799
OOD Validation ACCURACY: 0.8129
OOD Validation Loss: 0.8676
OOD Test ACCURACY: 0.2194
OOD Test Loss: 19.2538

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.9687
Train Loss: 0.0998
ID Validation ACCURACY: 0.8989
ID Validation Loss: 0.3196
ID Test ACCURACY: 0.8967
ID Test Loss: 0.3308
OOD Validation ACCURACY: 0.8863
OOD Validation Loss: 0.3868
OOD Test ACCURACY: 0.6399
OOD Test Loss: 1.9603

[0m[1;37mINFO[0m: [1mChartInfo 0.9004 0.2194 0.8967 0.6399 0.8989 0.8863[0mId_val ACCURACY: 0.9620Id_val Loss: 0.1498
Id_test ACCURACY: 0.9569Id_test Loss: 0.1746
Test ACCURACY: 0.2100Test Loss: 19.6836


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:26:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:26:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 0.9936
Train Loss: 0.0282
ID Validation ACCURACY: 0.8979
ID Validation Loss: 0.3626
ID Test ACCURACY: 0.8979
ID Test Loss: 0.3687
OOD Validation ACCURACY: 0.8104
OOD Validation Loss: 0.8374
OOD Test ACCURACY: 0.1843
OOD Test Loss: 20.7846

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9705
Train Loss: 0.0954
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.3536
ID Test ACCURACY: 0.8901
ID Test Loss: 0.3469
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.3745
OOD Test ACCURACY: 0.6829
OOD Test Loss: 1.2031

[0m[1;37mINFO[0m: [1mChartInfo 0.8979 0.1843 0.8901 0.6829 0.8883 0.8867[0mId_val ACCURACY: 0.9557Id_val Loss: 0.1653
Id_test ACCURACY: 0.9521Id_test Loss: 0.1788
Test ACCURACY: 0.1763Test Loss: 20.7385


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:27:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:20 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.9969
Train Loss: 0.0175
ID Validation ACCURACY: 0.8983
ID Validation Loss: 0.3772
ID Test ACCURACY: 0.8996
ID Test Loss: 0.3773
OOD Validation ACCURACY: 0.6556
OOD Validation Loss: 1.9834
OOD Test ACCURACY: 0.2234
OOD Test Loss: 34.5511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 113...
[0m[1;37mINFO[0m: [1mCheckpoint 113: 
-----------------------------------
Train ACCURACY: 0.9576
Train Loss: 0.1270
ID Validation ACCURACY: 0.8917
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.8914
ID Test Loss: 0.3444
OOD Validation ACCURACY: 0.8607
OOD Validation Loss: 0.4442
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9599

[0m[1;37mINFO[0m: [1mChartInfo 0.8996 0.2234 0.8914 0.7160 0.8917 0.8607[0mId_val ACCURACY: 0.9577Id_val Loss: 0.1685
Id_test ACCURACY: 0.9561Id_test Loss: 0.1736
Test ACCURACY: 0.2141Test Loss: 34.8963


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:27:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:27:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 170...
[0m[1;37mINFO[0m: [1mCheckpoint 170: 
-----------------------------------
Train ACCURACY: 0.9948
Train Loss: 0.0239
ID Validation ACCURACY: 0.9039
ID Validation Loss: 0.3607
ID Test ACCURACY: 0.8994
ID Test Loss: 0.3693
OOD Validation ACCURACY: 0.8719
OOD Validation Loss: 0.4937
OOD Test ACCURACY: 0.5734
OOD Test Loss: 1.9596

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9614
Train Loss: 0.1157
ID Validation ACCURACY: 0.8914
ID Validation Loss: 0.3430
ID Test ACCURACY: 0.8853
ID Test Loss: 0.3519
OOD Validation ACCURACY: 0.8899
OOD Validation Loss: 0.3549
OOD Test ACCURACY: 0.6547
OOD Test Loss: 1.2699

[0m[1;37mINFO[0m: [1mChartInfo 0.8994 0.5734 0.8853 0.6547 0.8914 0.8899[0mId_val ACCURACY: 0.9576Id_val Loss: 0.1589
Id_test ACCURACY: 0.9544Id_test Loss: 0.1755
Test ACCURACY: 0.5759Test Loss: 1.8598


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:28:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:28:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9900
Train Loss: 0.0382
ID Validation ACCURACY: 0.9037
ID Validation Loss: 0.3520
ID Test ACCURACY: 0.8939
ID Test Loss: 0.3777
OOD Validation ACCURACY: 0.8174
OOD Validation Loss: 0.6925
OOD Test ACCURACY: 0.2504
OOD Test Loss: 5.2588

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 73...
[0m[1;37mINFO[0m: [1mCheckpoint 73: 
-----------------------------------
Train ACCURACY: 0.9243
Train Loss: 0.2256
ID Validation ACCURACY: 0.8811
ID Validation Loss: 0.3636
ID Test ACCURACY: 0.8820
ID Test Loss: 0.3644
OOD Validation ACCURACY: 0.8760
OOD Validation Loss: 0.3793
OOD Test ACCURACY: 0.6897
OOD Test Loss: 1.0648

[0m[1;37mINFO[0m: [1mChartInfo 0.8939 0.2504 0.8820 0.6897 0.8811 0.8760[0mId_val ACCURACY: 0.9527Id_val Loss: 0.1695
Id_test ACCURACY: 0.9487Id_test Loss: 0.1847
Test ACCURACY: 0.2499Test Loss: 5.2090


Final accuracies: 
ID_VAL     = 0.957 +- 0.003
ID_TEST    = 0.954 +- 0.003
TEST       = 0.285 +- 0.147

Final losses: 
ID_VAL     = 0.1624 +- 0.0073
ID_TEST    = 0.1774 +- 0.0040
TEST       = 16.4774 +- 11.9025
Diff id_val-test  = 16.3151 
DONE EVAL LECI GOODCMNIST/color anneal

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:29:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.4334
ID Test ACCURACY: 0.9151
ID Test Loss: 0.4930
OOD Validation ACCURACY: 0.8823
OOD Validation Loss: 0.6328
OOD Test ACCURACY: 0.8311
OOD Test Loss: 1.1309

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 162...
[0m[1;37mINFO[0m: [1mCheckpoint 162: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9172
ID Validation Loss: 0.4056
ID Test ACCURACY: 0.9130
ID Test Loss: 0.4650
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.6111
OOD Test ACCURACY: 0.8308
OOD Test Loss: 1.1121

[0m[1;37mINFO[0m: [1mChartInfo 0.9151 0.8311 0.9130 0.8308 0.9172 0.8837[0mId_val ACCURACY: 0.9210Id_val Loss: 0.4334
Id_test ACCURACY: 0.9151Id_test Loss: 0.4930
Test ACCURACY: 0.8311Test Loss: 1.1309


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:29:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 158...
[0m[1;37mINFO[0m: [1mCheckpoint 158: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9219
ID Validation Loss: 0.4149
ID Test ACCURACY: 0.9153
ID Test Loss: 0.4712
OOD Validation ACCURACY: 0.8844
OOD Validation Loss: 0.6335
OOD Test ACCURACY: 0.8226
OOD Test Loss: 1.5522

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9206
ID Validation Loss: 0.4566
ID Test ACCURACY: 0.9164
ID Test Loss: 0.5199
OOD Validation ACCURACY: 0.8857
OOD Validation Loss: 0.7013
OOD Test ACCURACY: 0.8256
OOD Test Loss: 1.5657

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.8226 0.9164 0.8256 0.9206 0.8857[0mId_val ACCURACY: 0.9219Id_val Loss: 0.4149
Id_test ACCURACY: 0.9153Id_test Loss: 0.4712
Test ACCURACY: 0.8226Test Loss: 1.5522


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:29:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:29:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:29:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9217
ID Validation Loss: 0.4089
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4793
OOD Validation ACCURACY: 0.8800
OOD Validation Loss: 0.6717
OOD Test ACCURACY: 0.8278
OOD Test Loss: 1.4934

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0032
ID Validation ACCURACY: 0.9189
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9128
ID Test Loss: 0.3801
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.5452
OOD Test ACCURACY: 0.8331
OOD Test Loss: 1.2119

[0m[1;37mINFO[0m: [1mChartInfo 0.9170 0.8278 0.9128 0.8331 0.9189 0.8837[0mId_val ACCURACY: 0.9217Id_val Loss: 0.4089
Id_test ACCURACY: 0.9170Id_test Loss: 0.4793
Test ACCURACY: 0.8278Test Loss: 1.4934


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:30:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9225
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.9176
ID Test Loss: 0.4755
OOD Validation ACCURACY: 0.8817
OOD Validation Loss: 0.6167
OOD Test ACCURACY: 0.8206
OOD Test Loss: 1.3282

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9204
ID Validation Loss: 0.4402
ID Test ACCURACY: 0.9183
ID Test Loss: 0.5109
OOD Validation ACCURACY: 0.8846
OOD Validation Loss: 0.6529
OOD Test ACCURACY: 0.8255
OOD Test Loss: 1.3708

[0m[1;37mINFO[0m: [1mChartInfo 0.9176 0.8206 0.9183 0.8255 0.9204 0.8846[0mId_val ACCURACY: 0.9225Id_val Loss: 0.4107
Id_test ACCURACY: 0.9176Id_test Loss: 0.4755
Test ACCURACY: 0.8206Test Loss: 1.3282


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:30:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:30:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9208
ID Validation Loss: 0.4313
ID Test ACCURACY: 0.9178
ID Test Loss: 0.4948
OOD Validation ACCURACY: 0.8829
OOD Validation Loss: 0.6848
OOD Test ACCURACY: 0.8338
OOD Test Loss: 1.5415

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9178
ID Validation Loss: 0.4301
ID Test ACCURACY: 0.9166
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8847
OOD Validation Loss: 0.6580
OOD Test ACCURACY: 0.8312
OOD Test Loss: 1.4830

[0m[1;37mINFO[0m: [1mChartInfo 0.9178 0.8338 0.9166 0.8312 0.9178 0.8847[0mId_val ACCURACY: 0.9208Id_val Loss: 0.4313
Id_test ACCURACY: 0.9178Id_test Loss: 0.4948
Test ACCURACY: 0.8338Test Loss: 1.5415


Final accuracies: 
ID_VAL     = 0.922 +- 0.001
ID_TEST    = 0.917 +- 0.001
TEST       = 0.827 +- 0.005

Final losses: 
ID_VAL     = 0.4198 +- 0.0104
ID_TEST    = 0.4828 +- 0.0095
TEST       = 1.4092 +- 0.1607
Diff id_val-test  = 0.9894 
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
DONE EVAL LECI GOODSST2/length default

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:31:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 161...
[0m[1;37mINFO[0m: [1mCheckpoint 161: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.9232
ID Validation Loss: 0.4071
ID Test ACCURACY: 0.9138
ID Test Loss: 0.4704
OOD Validation ACCURACY: 0.8802
OOD Validation Loss: 0.6430
OOD Test ACCURACY: 0.8284
OOD Test Loss: 1.3885

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9219
ID Validation Loss: 0.4384
ID Test ACCURACY: 0.9176
ID Test Loss: 0.5121
OOD Validation ACCURACY: 0.8828
OOD Validation Loss: 0.6819
OOD Test ACCURACY: 0.8285
OOD Test Loss: 1.4679

[0m[1;37mINFO[0m: [1mChartInfo 0.9138 0.8284 0.9176 0.8285 0.9219 0.8828[0mId_val ACCURACY: 0.9232Id_val Loss: 0.4071
Id_test ACCURACY: 0.9138Id_test Loss: 0.4704
Test ACCURACY: 0.8284Test Loss: 1.3885


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:31:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:42 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:42 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:42 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9215
ID Validation Loss: 0.4292
ID Test ACCURACY: 0.9138
ID Test Loss: 0.4908
OOD Validation ACCURACY: 0.8802
OOD Validation Loss: 0.6680
OOD Test ACCURACY: 0.8261
OOD Test Loss: 1.4346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0057
ID Validation ACCURACY: 0.9157
ID Validation Loss: 0.2928
ID Test ACCURACY: 0.9127
ID Test Loss: 0.3309
OOD Validation ACCURACY: 0.8829
OOD Validation Loss: 0.4550
OOD Test ACCURACY: 0.8361
OOD Test Loss: 0.9548

[0m[1;37mINFO[0m: [1mChartInfo 0.9138 0.8261 0.9127 0.8361 0.9157 0.8829[0mId_val ACCURACY: 0.9215Id_val Loss: 0.4292
Id_test ACCURACY: 0.9138Id_test Loss: 0.4908
Test ACCURACY: 0.8261Test Loss: 1.4346


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:31:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:31:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 80...
[0m[1;37mINFO[0m: [1mCheckpoint 80: 
-----------------------------------
Train ACCURACY: 0.9991
Train Loss: 0.0067
ID Validation ACCURACY: 0.9191
ID Validation Loss: 0.3068
ID Test ACCURACY: 0.9104
ID Test Loss: 0.3679
OOD Validation ACCURACY: 0.8770
OOD Validation Loss: 0.5744
OOD Test ACCURACY: 0.8208
OOD Test Loss: 1.4759

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9187
ID Validation Loss: 0.4818
ID Test ACCURACY: 0.9189
ID Test Loss: 0.5496
OOD Validation ACCURACY: 0.8843
OOD Validation Loss: 0.6971
OOD Test ACCURACY: 0.8280
OOD Test Loss: 1.3584

[0m[1;37mINFO[0m: [1mChartInfo 0.9104 0.8208 0.9189 0.8280 0.9187 0.8843[0mId_val ACCURACY: 0.9191Id_val Loss: 0.3068
Id_test ACCURACY: 0.9104Id_test Loss: 0.3679
Test ACCURACY: 0.8208Test Loss: 1.4759


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:32:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:13 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9194
ID Validation Loss: 0.4390
ID Test ACCURACY: 0.9162
ID Test Loss: 0.5246
OOD Validation ACCURACY: 0.8849
OOD Validation Loss: 0.6551
OOD Test ACCURACY: 0.8289
OOD Test Loss: 1.3384

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9178
ID Validation Loss: 0.4486
ID Test ACCURACY: 0.9172
ID Test Loss: 0.5292
OOD Validation ACCURACY: 0.8852
OOD Validation Loss: 0.6477
OOD Test ACCURACY: 0.8321
OOD Test Loss: 1.2473

[0m[1;37mINFO[0m: [1mChartInfo 0.9162 0.8289 0.9172 0.8321 0.9178 0.8852[0mId_val ACCURACY: 0.9194Id_val Loss: 0.4390
Id_test ACCURACY: 0.9162Id_test Loss: 0.5246
Test ACCURACY: 0.8289Test Loss: 1.3384


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:32:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:32:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0005
ID Validation ACCURACY: 0.9202
ID Validation Loss: 0.3844
ID Test ACCURACY: 0.9149
ID Test Loss: 0.4498
OOD Validation ACCURACY: 0.8829
OOD Validation Loss: 0.5759
OOD Test ACCURACY: 0.8366
OOD Test Loss: 0.9989

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.9170
ID Validation Loss: 0.4333
ID Test ACCURACY: 0.9164
ID Test Loss: 0.5038
OOD Validation ACCURACY: 0.8868
OOD Validation Loss: 0.6171
OOD Test ACCURACY: 0.8387
OOD Test Loss: 1.0809

[0m[1;37mINFO[0m: [1mChartInfo 0.9149 0.8366 0.9164 0.8387 0.9170 0.8868[0mId_val ACCURACY: 0.9202Id_val Loss: 0.3844
Id_test ACCURACY: 0.9149Id_test Loss: 0.4498
Test ACCURACY: 0.8366Test Loss: 0.9989


Final accuracies: 
ID_VAL     = 0.921 +- 0.002
ID_TEST    = 0.914 +- 0.002
TEST       = 0.828 +- 0.005

Final losses: 
ID_VAL     = 0.3933 +- 0.0472
ID_TEST    = 0.4607 +- 0.0526
TEST       = 1.3273 +- 0.1705
Diff id_val-test  = 0.9340 
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
DONE EVAL LECI GOODSST2/length hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:33:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.9208
ID Validation Loss: 0.3884
ID Test ACCURACY: 0.9149
ID Test Loss: 0.4476
OOD Validation ACCURACY: 0.8772
OOD Validation Loss: 0.5532
OOD Test ACCURACY: 0.8226
OOD Test Loss: 0.9289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 148...
[0m[1;37mINFO[0m: [1mCheckpoint 148: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0021
ID Validation ACCURACY: 0.9159
ID Validation Loss: 0.3511
ID Test ACCURACY: 0.9110
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.8826
OOD Validation Loss: 0.4988
OOD Test ACCURACY: 0.8356
OOD Test Loss: 0.8592

[0m[1;37mINFO[0m: [1mChartInfo 0.9149 0.8226 0.9110 0.8356 0.9159 0.8826[0mId_val ACCURACY: 0.9208Id_val Loss: 0.3884
Id_test ACCURACY: 0.9149Id_test Loss: 0.4476
Test ACCURACY: 0.8226Test Loss: 0.9289


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:33:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.3737
ID Test ACCURACY: 0.9161
ID Test Loss: 0.4207
OOD Validation ACCURACY: 0.8817
OOD Validation Loss: 0.5304
OOD Test ACCURACY: 0.8254
OOD Test Loss: 1.0888

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9194
ID Validation Loss: 0.4219
ID Test ACCURACY: 0.9157
ID Test Loss: 0.4817
OOD Validation ACCURACY: 0.8832
OOD Validation Loss: 0.6079
OOD Test ACCURACY: 0.8258
OOD Test Loss: 1.2557

[0m[1;37mINFO[0m: [1mChartInfo 0.9161 0.8254 0.9157 0.8258 0.9194 0.8832[0mId_val ACCURACY: 0.9210Id_val Loss: 0.3737
Id_test ACCURACY: 0.9161Id_test Loss: 0.4207
Test ACCURACY: 0.8254Test Loss: 1.0888


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:33:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:33:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.4058
ID Test ACCURACY: 0.9147
ID Test Loss: 0.4863
OOD Validation ACCURACY: 0.8811
OOD Validation Loss: 0.5978
OOD Test ACCURACY: 0.8111
OOD Test Loss: 1.3825

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9211
ID Validation Loss: 0.4242
ID Test ACCURACY: 0.9145
ID Test Loss: 0.5078
OOD Validation ACCURACY: 0.8839
OOD Validation Loss: 0.6388
OOD Test ACCURACY: 0.8267
OOD Test Loss: 1.3856

[0m[1;37mINFO[0m: [1mChartInfo 0.9147 0.8111 0.9145 0.8267 0.9211 0.8839[0mId_val ACCURACY: 0.9247Id_val Loss: 0.4058
Id_test ACCURACY: 0.9147Id_test Loss: 0.4863
Test ACCURACY: 0.8111Test Loss: 1.3825


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:34:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:05 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 181...
[0m[1;37mINFO[0m: [1mCheckpoint 181: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9223
ID Validation Loss: 0.3683
ID Test ACCURACY: 0.9161
ID Test Loss: 0.4352
OOD Validation ACCURACY: 0.8814
OOD Validation Loss: 0.5797
OOD Test ACCURACY: 0.8193
OOD Test Loss: 1.6663

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0050
ID Validation ACCURACY: 0.9183
ID Validation Loss: 0.3159
ID Test ACCURACY: 0.9144
ID Test Loss: 0.3601
OOD Validation ACCURACY: 0.8839
OOD Validation Loss: 0.5335
OOD Test ACCURACY: 0.8287
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mChartInfo 0.9161 0.8193 0.9144 0.8287 0.9183 0.8839[0mId_val ACCURACY: 0.9223Id_val Loss: 0.3683
Id_test ACCURACY: 0.9161Id_test Loss: 0.4352
Test ACCURACY: 0.8193Test Loss: 1.6663


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 23 18:34:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/23/2024 06:34:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9994
Train Loss: 0.0042
ID Validation ACCURACY: 0.9200
ID Validation Loss: 0.3042
ID Test ACCURACY: 0.9100
ID Test Loss: 0.3409
OOD Validation ACCURACY: 0.8736
OOD Validation Loss: 0.4929
OOD Test ACCURACY: 0.8157
OOD Test Loss: 0.9444

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.9155
ID Validation Loss: 0.4081
ID Test ACCURACY: 0.9153
ID Test Loss: 0.4411
OOD Validation ACCURACY: 0.8864
OOD Validation Loss: 0.5536
OOD Test ACCURACY: 0.8255
OOD Test Loss: 1.0612

[0m[1;37mINFO[0m: [1mChartInfo 0.9100 0.8157 0.9153 0.8255 0.9155 0.8864[0mId_val ACCURACY: 0.9200Id_val Loss: 0.3042
Id_test ACCURACY: 0.9100Id_test Loss: 0.3409
Test ACCURACY: 0.8157Test Loss: 0.9444


Final accuracies: 
ID_VAL     = 0.922 +- 0.002
ID_TEST    = 0.914 +- 0.002
TEST       = 0.819 +- 0.005

Final losses: 
ID_VAL     = 0.3681 +- 0.0345
ID_TEST    = 0.4261 +- 0.0479
TEST       = 1.2022 +- 0.2835
Diff id_val-test  = 0.8341 
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
DONE EVAL LECI GOODSST2/length anneal
DONE all :)
