I'm the stability of the DET :))
The PID of this script is: 298662 running on GPU-0
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:47:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.4515
Train Loss: 2.0116
ID Validation ACCURACY: 0.4543
ID Validation Loss: 2.0095
ID Test ACCURACY: 0.4537
ID Test Loss: 1.9627
OOD Validation ACCURACY: 0.3667
OOD Validation Loss: 1.7075
OOD Test ACCURACY: 0.4907
OOD Test Loss: 20.5069

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 0.3873
Train Loss: 2.8169
ID Validation ACCURACY: 0.4017
ID Validation Loss: 2.8787
ID Test ACCURACY: 0.3987
ID Test Loss: 2.7126
OOD Validation ACCURACY: 0.4830
OOD Validation Loss: 1.4196
OOD Test ACCURACY: 0.3533
OOD Test Loss: 4.9358

[0m[1;37mINFO[0m: [1mChartInfo 0.4537 0.4907 0.3987 0.3533 0.4017 0.4830[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.405
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.317


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.032100
Plausibility completed in  0:00:25.255276
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3113, device='cuda:0')  +-  tensor(0.1338, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3369, device='cuda:0')  +-  tensor(0.1753, device='cuda:0') (0.009)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3113, device='cuda:0')  +-  tensor(0.1338, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3941, device='cuda:0')  +-  tensor(0.0812, device='cuda:0') (0.011)
Original Stability MCC for r=0.3 = 0.987 +- 0.048
Intervened Stability MCC for r=0.3 = 0.542 +- 0.363
Original Stability F1 for r=0.3 = 0.991 +- 0.033
Intervened Stability F1 for r=0.3 = 0.715 +- 0.217
Num considered samples: 2914


ratio=0.6


Interventions completed in  0:00:06.065092
Plausibility completed in  0:00:23.705309
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2961, device='cuda:0')  +-  tensor(0.1250, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2879, device='cuda:0')  +-  tensor(0.1725, device='cuda:0') (0.006)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2961, device='cuda:0')  +-  tensor(0.1250, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6387, device='cuda:0')  +-  tensor(0.2236, device='cuda:0') (0.006)
Original Stability MCC for r=0.6 = 0.993 +- 0.036
Intervened Stability MCC for r=0.6 = 0.356 +- 0.358
Original Stability F1 for r=0.6 = 0.997 +- 0.014
Intervened Stability F1 for r=0.6 = 0.807 +- 0.106
Num considered samples: 2684
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:48:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 11:48:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 32...
[0m[1;37mINFO[0m: [1mCheckpoint 32: 
-----------------------------------
Train ACCURACY: 0.5550
Train Loss: 1.0486
ID Validation ACCURACY: 0.5667
ID Validation Loss: 1.0182
ID Test ACCURACY: 0.5497
ID Test Loss: 1.0586
OOD Validation ACCURACY: 0.2923
OOD Validation Loss: 1.8056
OOD Test ACCURACY: 0.3420
OOD Test Loss: 2.4359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.3756
Train Loss: 1.3215
ID Validation ACCURACY: 0.3880
ID Validation Loss: 1.2841
ID Test ACCURACY: 0.3630
ID Test Loss: 1.3120
OOD Validation ACCURACY: 0.4910
OOD Validation Loss: 1.0719
OOD Test ACCURACY: 0.4573
OOD Test Loss: 1.3658

[0m[1;37mINFO[0m: [1mChartInfo 0.5497 0.3420 0.3630 0.4573 0.3880 0.4910[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.144
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.161


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.982395
Plausibility completed in  0:00:26.202027
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2445, device='cuda:0')  +-  tensor(0.1776, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2781, device='cuda:0')  +-  tensor(0.2110, device='cuda:0') (0.015)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2445, device='cuda:0')  +-  tensor(0.1776, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4344, device='cuda:0')  +-  tensor(0.1008, device='cuda:0') (0.018)
Original Stability MCC for r=0.3 = 0.991 +- 0.039
Intervened Stability MCC for r=0.3 = 0.603 +- 0.269
Original Stability F1 for r=0.3 = 0.994 +- 0.026
Intervened Stability F1 for r=0.3 = 0.747 +- 0.170
Num considered samples: 2907


ratio=0.6


Interventions completed in  0:00:04.909276
Plausibility completed in  0:00:21.170402
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2245, device='cuda:0')  +-  tensor(0.1765, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2011, device='cuda:0')  +-  tensor(0.2089, device='cuda:0') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2245, device='cuda:0')  +-  tensor(0.1765, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6262, device='cuda:0')  +-  tensor(0.3197, device='cuda:0') (0.008)
Original Stability MCC for r=0.6 = 0.982 +- 0.073
Intervened Stability MCC for r=0.6 = 0.654 +- 0.286
Original Stability F1 for r=0.6 = 0.994 +- 0.025
Intervened Stability F1 for r=0.6 = 0.892 +- 0.085
Num considered samples: 2395
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:49:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.3922
Train Loss: 2.5243
ID Validation ACCURACY: 0.4000
ID Validation Loss: 2.6128
ID Test ACCURACY: 0.4023
ID Test Loss: 2.4780
OOD Validation ACCURACY: 0.3473
OOD Validation Loss: 1.5777
OOD Test ACCURACY: 0.4613
OOD Test Loss: 12.1111

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ACCURACY: 0.3601
Train Loss: 2.8396
ID Validation ACCURACY: 0.3580
ID Validation Loss: 2.9725
ID Test ACCURACY: 0.3643
ID Test Loss: 2.7594
OOD Validation ACCURACY: 0.4673
OOD Validation Loss: 1.2057
OOD Test ACCURACY: 0.3347
OOD Test Loss: 10.3926

[0m[1;37mINFO[0m: [1mChartInfo 0.4023 0.4613 0.3643 0.3347 0.3580 0.4673[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.399
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.308


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.083408
Plausibility completed in  0:00:25.905687
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3133, device='cuda:0')  +-  tensor(0.1401, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3484, device='cuda:0')  +-  tensor(0.1795, device='cuda:0') (0.009)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3133, device='cuda:0')  +-  tensor(0.1401, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4003, device='cuda:0')  +-  tensor(0.0601, device='cuda:0') (0.009)
Original Stability MCC for r=0.3 = 0.997 +- 0.024
Intervened Stability MCC for r=0.3 = 0.501 +- 0.383
Original Stability F1 for r=0.3 = 0.998 +- 0.016
Intervened Stability F1 for r=0.3 = 0.693 +- 0.227
Num considered samples: 2973


ratio=0.6


Interventions completed in  0:00:05.758488
Plausibility completed in  0:00:24.102323
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2981, device='cuda:0')  +-  tensor(0.1319, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2971, device='cuda:0')  +-  tensor(0.1787, device='cuda:0') (0.006)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2981, device='cuda:0')  +-  tensor(0.1319, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6528, device='cuda:0')  +-  tensor(0.2052, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 0.996 +- 0.025
Intervened Stability MCC for r=0.6 = 0.327 +- 0.376
Original Stability F1 for r=0.6 = 0.998 +- 0.009
Intervened Stability F1 for r=0.6 = 0.801 +- 0.107
Num considered samples: 2743
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:51:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.4899
Train Loss: 2.0486
ID Validation ACCURACY: 0.4887
ID Validation Loss: 2.1187
ID Test ACCURACY: 0.4963
ID Test Loss: 1.9416
OOD Validation ACCURACY: 0.3943
OOD Validation Loss: 1.1884
OOD Test ACCURACY: 0.4750
OOD Test Loss: 32.6168

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.3959
Train Loss: 2.6359
ID Validation ACCURACY: 0.4100
ID Validation Loss: 2.6788
ID Test ACCURACY: 0.4033
ID Test Loss: 2.6084
OOD Validation ACCURACY: 0.5240
OOD Validation Loss: 1.4202
OOD Test ACCURACY: 0.4643
OOD Test Loss: 2.3969

[0m[1;37mINFO[0m: [1mChartInfo 0.4963 0.4750 0.4033 0.4643 0.4100 0.5240[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.445
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.328


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.787791
Plausibility completed in  0:00:25.264081
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3154, device='cuda:0')  +-  tensor(0.1338, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3435, device='cuda:0')  +-  tensor(0.1837, device='cuda:0') (0.011)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3154, device='cuda:0')  +-  tensor(0.1338, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3969, device='cuda:0')  +-  tensor(0.0813, device='cuda:0') (0.012)
Original Stability MCC for r=0.3 = 0.995 +- 0.033
Intervened Stability MCC for r=0.3 = 0.559 +- 0.340
Original Stability F1 for r=0.3 = 0.997 +- 0.022
Intervened Stability F1 for r=0.3 = 0.724 +- 0.202
Num considered samples: 2914


ratio=0.6


Interventions completed in  0:00:05.868833
Plausibility completed in  0:00:24.115020
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2999, device='cuda:0')  +-  tensor(0.1246, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2908, device='cuda:0')  +-  tensor(0.1785, device='cuda:0') (0.008)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2999, device='cuda:0')  +-  tensor(0.1246, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6452, device='cuda:0')  +-  tensor(0.2265, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 0.976 +- 0.092
Intervened Stability MCC for r=0.6 = 0.373 +- 0.359
Original Stability F1 for r=0.6 = 0.991 +- 0.034
Intervened Stability F1 for r=0.6 = 0.817 +- 0.094
Num considered samples: 2684
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:52:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 11:52:22 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.5243
Train Loss: 1.6300
ID Validation ACCURACY: 0.5290
ID Validation Loss: 1.6217
ID Test ACCURACY: 0.5153
ID Test Loss: 1.6486
OOD Validation ACCURACY: 0.3360
OOD Validation Loss: 2.9312
OOD Test ACCURACY: 0.5983
OOD Test Loss: 1.1300

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ACCURACY: 0.3722
Train Loss: 2.1560
ID Validation ACCURACY: 0.3763
ID Validation Loss: 2.0934
ID Test ACCURACY: 0.3590
ID Test Loss: 2.1927
OOD Validation ACCURACY: 0.4270
OOD Validation Loss: 1.7656
OOD Test ACCURACY: 0.5453
OOD Test Loss: 1.2780

[0m[1;37mINFO[0m: [1mChartInfo 0.5153 0.5983 0.3590 0.5453 0.3763 0.4270[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.161
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.148


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.939752
Plausibility completed in  0:00:26.069035
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2259, device='cuda:0')  +-  tensor(0.1735, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2470, device='cuda:0')  +-  tensor(0.1952, device='cuda:0') (0.023)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2259, device='cuda:0')  +-  tensor(0.1735, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4563, device='cuda:0')  +-  tensor(0.1215, device='cuda:0') (0.028)
Original Stability MCC for r=0.3 = 0.996 +- 0.027
Intervened Stability MCC for r=0.3 = 0.558 +- 0.304
Original Stability F1 for r=0.3 = 0.997 +- 0.018
Intervened Stability F1 for r=0.3 = 0.720 +- 0.188
Num considered samples: 2907


ratio=0.6


Interventions completed in  0:00:05.259385
Plausibility completed in  0:00:21.273685
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1960, device='cuda:0')  +-  tensor(0.1453, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1560, device='cuda:0')  +-  tensor(0.1371, device='cuda:0') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1960, device='cuda:0')  +-  tensor(0.1453, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6569, device='cuda:0')  +-  tensor(0.3113, device='cuda:0') (0.008)
Original Stability MCC for r=0.6 = 0.991 +- 0.047
Intervened Stability MCC for r=0.6 = 0.671 +- 0.268
Original Stability F1 for r=0.6 = 0.997 +- 0.016
Intervened Stability F1 for r=0.6 = 0.896 +- 0.080
Num considered samples: 2463

\FINISHED GOODMotif2 - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.2820858  0.26291248] +- [0.03875183 0.04394641] (mean across ratios: 0.27 +- 0.03)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.31078497 0.24661621] +- [0.04075417 0.05742486] (mean across ratios: 0.28 +- 0.04)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.37454295 0.68083436] +- [0.0278868  0.04136143] (mean across ratios: 0.53 +- 0.02)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.41640273 0.64396454] +- [0.02471291 0.01083395] (mean across ratios: 0.53 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99542366 0.99551697] +- [0.00253794 0.00259333] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.71950235 0.84241159] +- [0.01738967 0.04223177] (mean across ratios: 0.78 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99323717 0.98766375] +- [0.0037181 0.0071827] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.55270227 0.4760228 ] +- [0.03288787 0.15305985] (mean across ratios: 0.51 +- 0.08)

Overall time of execution:  0:06:30.521150
DONE CIGA GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:53:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.4515
Train Loss: 2.0116
ID Validation ACCURACY: 0.4543
ID Validation Loss: 2.0095
ID Test ACCURACY: 0.4537
ID Test Loss: 1.9627
OOD Validation ACCURACY: 0.3667
OOD Validation Loss: 1.7075
OOD Test ACCURACY: 0.4907
OOD Test Loss: 20.5069

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 0.3873
Train Loss: 2.8169
ID Validation ACCURACY: 0.4017
ID Validation Loss: 2.8787
ID Test ACCURACY: 0.3987
ID Test Loss: 2.7126
OOD Validation ACCURACY: 0.4830
OOD Validation Loss: 1.4196
OOD Test ACCURACY: 0.3533
OOD Test Loss: 4.9358

[0m[1;37mINFO[0m: [1mChartInfo 0.4537 0.4907 0.3987 0.3533 0.4017 0.4830[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.405
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.317


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.348357
Plausibility completed in  0:00:27.467553
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3113, device='cuda:0')  +-  tensor(0.1338, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3682, device='cuda:0')  +-  tensor(0.2055, device='cuda:0') (0.010)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3113, device='cuda:0')  +-  tensor(0.1338, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4238, device='cuda:0')  +-  tensor(0.1040, device='cuda:0') (0.011)
Original Stability MCC for r=0.3 = 0.987 +- 0.048
Intervened Stability MCC for r=0.3 = 0.370 +- 0.494
Original Stability F1 for r=0.3 = 0.991 +- 0.033
Intervened Stability F1 for r=0.3 = 0.636 +- 0.282
Num considered samples: 2914


ratio=0.6


Interventions completed in  0:00:05.476956
Plausibility completed in  0:00:24.297700
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2961, device='cuda:0')  +-  tensor(0.1250, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3002, device='cuda:0')  +-  tensor(0.1825, device='cuda:0') (0.006)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2961, device='cuda:0')  +-  tensor(0.1250, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6799, device='cuda:0')  +-  tensor(0.2456, device='cuda:0') (0.006)
Original Stability MCC for r=0.6 = 0.992 +- 0.037
Intervened Stability MCC for r=0.6 = 0.182 +- 0.364
Original Stability F1 for r=0.6 = 0.997 +- 0.014
Intervened Stability F1 for r=0.6 = 0.803 +- 0.116
Num considered samples: 2684
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:55:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 32...
[0m[1;37mINFO[0m: [1mCheckpoint 32: 
-----------------------------------
Train ACCURACY: 0.5550
Train Loss: 1.0486
ID Validation ACCURACY: 0.5667
ID Validation Loss: 1.0182
ID Test ACCURACY: 0.5497
ID Test Loss: 1.0586
OOD Validation ACCURACY: 0.2923
OOD Validation Loss: 1.8056
OOD Test ACCURACY: 0.3420
OOD Test Loss: 2.4359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.3756
Train Loss: 1.3215
ID Validation ACCURACY: 0.3880
ID Validation Loss: 1.2841
ID Test ACCURACY: 0.3630
ID Test Loss: 1.3120
OOD Validation ACCURACY: 0.4910
OOD Validation Loss: 1.0719
OOD Test ACCURACY: 0.4573
OOD Test Loss: 1.3658

[0m[1;37mINFO[0m: [1mChartInfo 0.5497 0.3420 0.3630 0.4573 0.3880 0.4910[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.144
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.161


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.435185
Plausibility completed in  0:00:29.021303
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2445, device='cuda:0')  +-  tensor(0.1776, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3215, device='cuda:0')  +-  tensor(0.2398, device='cuda:0') (0.016)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2445, device='cuda:0')  +-  tensor(0.1776, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4707, device='cuda:0')  +-  tensor(0.1191, device='cuda:0') (0.020)
Original Stability MCC for r=0.3 = 0.991 +- 0.043
Intervened Stability MCC for r=0.3 = 0.503 +- 0.324
Original Stability F1 for r=0.3 = 0.994 +- 0.029
Intervened Stability F1 for r=0.3 = 0.700 +- 0.196
Num considered samples: 2907


ratio=0.6


Interventions completed in  0:00:05.171256
Plausibility completed in  0:00:22.026809
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2245, device='cuda:0')  +-  tensor(0.1764, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2172, device='cuda:0')  +-  tensor(0.2211, device='cuda:0') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2245, device='cuda:0')  +-  tensor(0.1764, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6560, device='cuda:0')  +-  tensor(0.3360, device='cuda:0') (0.006)
Original Stability MCC for r=0.6 = 0.982 +- 0.072
Intervened Stability MCC for r=0.6 = 0.580 +- 0.352
Original Stability F1 for r=0.6 = 0.993 +- 0.025
Intervened Stability F1 for r=0.6 = 0.882 +- 0.097
Num considered samples: 2396
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:56:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 11:56:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.3922
Train Loss: 2.5243
ID Validation ACCURACY: 0.4000
ID Validation Loss: 2.6128
ID Test ACCURACY: 0.4023
ID Test Loss: 2.4780
OOD Validation ACCURACY: 0.3473
OOD Validation Loss: 1.5777
OOD Test ACCURACY: 0.4613
OOD Test Loss: 12.1111

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ACCURACY: 0.3601
Train Loss: 2.8396
ID Validation ACCURACY: 0.3580
ID Validation Loss: 2.9725
ID Test ACCURACY: 0.3643
ID Test Loss: 2.7594
OOD Validation ACCURACY: 0.4673
OOD Validation Loss: 1.2057
OOD Test ACCURACY: 0.3347
OOD Test Loss: 10.3926

[0m[1;37mINFO[0m: [1mChartInfo 0.4023 0.4613 0.3643 0.3347 0.3580 0.4673[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.399
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.308


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.481678
Plausibility completed in  0:00:30.457367
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3133, device='cuda:0')  +-  tensor(0.1401, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3783, device='cuda:0')  +-  tensor(0.2042, device='cuda:0') (0.009)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3133, device='cuda:0')  +-  tensor(0.1401, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4309, device='cuda:0')  +-  tensor(0.0840, device='cuda:0') (0.008)
Original Stability MCC for r=0.3 = 0.997 +- 0.023
Intervened Stability MCC for r=0.3 = 0.350 +- 0.479
Original Stability F1 for r=0.3 = 0.998 +- 0.015
Intervened Stability F1 for r=0.3 = 0.626 +- 0.271
Num considered samples: 2973


ratio=0.6


Interventions completed in  0:00:05.889580
Plausibility completed in  0:00:25.320828
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2981, device='cuda:0')  +-  tensor(0.1319, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3094, device='cuda:0')  +-  tensor(0.1887, device='cuda:0') (0.006)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2981, device='cuda:0')  +-  tensor(0.1319, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6955, device='cuda:0')  +-  tensor(0.2269, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 0.996 +- 0.025
Intervened Stability MCC for r=0.6 = 0.188 +- 0.395
Original Stability F1 for r=0.6 = 0.998 +- 0.009
Intervened Stability F1 for r=0.6 = 0.805 +- 0.120
Num considered samples: 2743
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:58:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:06 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.4899
Train Loss: 2.0486
ID Validation ACCURACY: 0.4887
ID Validation Loss: 2.1187
ID Test ACCURACY: 0.4963
ID Test Loss: 1.9416
OOD Validation ACCURACY: 0.3943
OOD Validation Loss: 1.1884
OOD Test ACCURACY: 0.4750
OOD Test Loss: 32.6168

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.3959
Train Loss: 2.6359
ID Validation ACCURACY: 0.4100
ID Validation Loss: 2.6788
ID Test ACCURACY: 0.4033
ID Test Loss: 2.6084
OOD Validation ACCURACY: 0.5240
OOD Validation Loss: 1.4202
OOD Test ACCURACY: 0.4643
OOD Test Loss: 2.3969

[0m[1;37mINFO[0m: [1mChartInfo 0.4963 0.4750 0.4033 0.4643 0.4100 0.5240[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.445
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.328


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:07.143934
Plausibility completed in  0:00:28.494241
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3154, device='cuda:0')  +-  tensor(0.1338, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3802, device='cuda:0')  +-  tensor(0.2250, device='cuda:0') (0.011)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3154, device='cuda:0')  +-  tensor(0.1338, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4291, device='cuda:0')  +-  tensor(0.1027, device='cuda:0') (0.010)
Original Stability MCC for r=0.3 = 0.995 +- 0.033
Intervened Stability MCC for r=0.3 = 0.427 +- 0.472
Original Stability F1 for r=0.3 = 0.997 +- 0.022
Intervened Stability F1 for r=0.3 = 0.666 +- 0.260
Num considered samples: 2914


ratio=0.6


Interventions completed in  0:00:05.995352
Plausibility completed in  0:00:24.629853
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2999, device='cuda:0')  +-  tensor(0.1246, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3016, device='cuda:0')  +-  tensor(0.1955, device='cuda:0') (0.007)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2999, device='cuda:0')  +-  tensor(0.1246, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6898, device='cuda:0')  +-  tensor(0.2505, device='cuda:0') (0.006)
Original Stability MCC for r=0.6 = 0.977 +- 0.089
Intervened Stability MCC for r=0.6 = 0.234 +- 0.360
Original Stability F1 for r=0.6 = 0.992 +- 0.033
Intervened Stability F1 for r=0.6 = 0.821 +- 0.108
Num considered samples: 2684
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:59:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.5243
Train Loss: 1.6300
ID Validation ACCURACY: 0.5290
ID Validation Loss: 1.6217
ID Test ACCURACY: 0.5153
ID Test Loss: 1.6486
OOD Validation ACCURACY: 0.3360
OOD Validation Loss: 2.9312
OOD Test ACCURACY: 0.5983
OOD Test Loss: 1.1300

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ACCURACY: 0.3722
Train Loss: 2.1560
ID Validation ACCURACY: 0.3763
ID Validation Loss: 2.0934
ID Test ACCURACY: 0.3590
ID Test Loss: 2.1927
OOD Validation ACCURACY: 0.4270
OOD Validation Loss: 1.7656
OOD Test ACCURACY: 0.5453
OOD Test Loss: 1.2780

[0m[1;37mINFO[0m: [1mChartInfo 0.5153 0.5983 0.3590 0.5453 0.3763 0.4270[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.161
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.148


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:07.175879
Plausibility completed in  0:00:26.815570
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2259, device='cuda:0')  +-  tensor(0.1735, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2826, device='cuda:0')  +-  tensor(0.2216, device='cuda:0') (0.020)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2259, device='cuda:0')  +-  tensor(0.1735, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4951, device='cuda:0')  +-  tensor(0.1521, device='cuda:0') (0.026)
Original Stability MCC for r=0.3 = 0.996 +- 0.030
Intervened Stability MCC for r=0.3 = 0.466 +- 0.371
Original Stability F1 for r=0.3 = 0.997 +- 0.020
Intervened Stability F1 for r=0.3 = 0.679 +- 0.217
Num considered samples: 2907


ratio=0.6


Interventions completed in  0:00:05.326784
Plausibility completed in  0:00:22.447220
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1964, device='cuda:0')  +-  tensor(0.1459, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1663, device='cuda:0')  +-  tensor(0.1436, device='cuda:0') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1964, device='cuda:0')  +-  tensor(0.1459, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6790, device='cuda:0')  +-  tensor(0.3209, device='cuda:0') (0.007)
Original Stability MCC for r=0.6 = 0.991 +- 0.046
Intervened Stability MCC for r=0.6 = 0.563 +- 0.345
Original Stability F1 for r=0.6 = 0.997 +- 0.016
Intervened Stability F1 for r=0.6 = 0.878 +- 0.093
Num considered samples: 2465

\FINISHED GOODMotif2 - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.2820858  0.26299446] +- [0.03875183 0.04382159] (mean across ratios: 0.27 +- 0.03)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.34618129 0.25894336] +- [0.03827794 0.0572484 ] (mean across ratios: 0.30 +- 0.03)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.37454295 0.68083769] +- [0.0278868  0.04136793] (mean across ratios: 0.53 +- 0.02)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.4499267  0.68005188] +- [0.02811863 0.01349979] (mean across ratios: 0.56 +- 0.02)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99529425 0.99552913] +- [0.00256153 0.00254778] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.66139448 0.83761245] +- [0.02724993 0.03514041] (mean across ratios: 0.75 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99304498 0.98771616] +- [0.00375724 0.00704716] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.4230115  0.34963041] +- [0.05740085 0.18243306] (mean across ratios: 0.39 +- 0.10)

Overall time of execution:  0:07:11.793236
DONE CIGA GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 12:01:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:17 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:17 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:17 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing  5  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.2955
Train Loss: 2.1309
ID Validation ACCURACY: 0.2990
ID Validation Loss: 2.1134
ID Test ACCURACY: 0.2890
ID Test Loss: 2.1875
OOD Validation ACCURACY: 0.2706
OOD Validation Loss: 2.4837
OOD Test ACCURACY: 0.2086
OOD Test Loss: 4.6387

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.2797
Train Loss: 2.1018
ID Validation ACCURACY: 0.2841
ID Validation Loss: 2.0829
ID Test ACCURACY: 0.2744
ID Test Loss: 2.1502
OOD Validation ACCURACY: 0.2713
OOD Validation Loss: 2.2479
OOD Test ACCURACY: 0.1836
OOD Test Loss: 3.7387

[0m[1;37mINFO[0m: [1mChartInfo 0.2890 0.2086 0.2744 0.1836 0.2841 0.2713[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:23.267779
Plausibility completed in  0:02:00.125050
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3776, device='cuda:0')  +-  tensor(0.0198, device='cuda:0') (0.006)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.729 +- 0.109
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.820 +- 0.072
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.923351
Plausibility completed in  0:01:42.540450
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7103, device='cuda:0')  +-  tensor(0.0165, device='cuda:0') (0.006)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.725 +- 0.127
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.908 +- 0.042
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 12:23:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing  5  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 12:23:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.4261
Train Loss: 1.5957
ID Validation ACCURACY: 0.4141
ID Validation Loss: 1.6418
ID Test ACCURACY: 0.4197
ID Test Loss: 1.6257
OOD Validation ACCURACY: 0.3443
OOD Validation Loss: 2.1405
OOD Test ACCURACY: 0.2526
OOD Test Loss: 2.5709

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.3952
Train Loss: 1.7198
ID Validation ACCURACY: 0.3889
ID Validation Loss: 1.7556
ID Test ACCURACY: 0.3903
ID Test Loss: 1.7504
OOD Validation ACCURACY: 0.3587
OOD Validation Loss: 2.0597
OOD Test ACCURACY: 0.2260
OOD Test Loss: 2.7268

[0m[1;37mINFO[0m: [1mChartInfo 0.4197 0.2526 0.3903 0.2260 0.3889 0.3587[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.824163
Plausibility completed in  0:01:44.722632
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4497, device='cuda:0')  +-  tensor(0.0507, device='cuda:0') (0.009)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.642 +- 0.119
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.762 +- 0.079
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:15.226288
Plausibility completed in  0:01:44.484718
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7946, device='cuda:0')  +-  tensor(0.0434, device='cuda:0') (0.008)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.711 +- 0.104
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.903 +- 0.035
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 12:42:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing  5  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 12:42:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.3742
Train Loss: 1.7882
ID Validation ACCURACY: 0.3836
ID Validation Loss: 1.7873
ID Test ACCURACY: 0.3733
ID Test Loss: 1.8005
OOD Validation ACCURACY: 0.3237
OOD Validation Loss: 2.1818
OOD Test ACCURACY: 0.1913
OOD Test Loss: 3.2680

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.3845
Train Loss: 1.7577
ID Validation ACCURACY: 0.3803
ID Validation Loss: 1.7604
ID Test ACCURACY: 0.3764
ID Test Loss: 1.7715
OOD Validation ACCURACY: 0.3377
OOD Validation Loss: 2.0441
OOD Test ACCURACY: 0.1530
OOD Test Loss: 4.8804

[0m[1;37mINFO[0m: [1mChartInfo 0.3733 0.1913 0.3764 0.1530 0.3803 0.3377[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:18.793016
Plausibility completed in  0:01:48.537993
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4337, device='cuda:0')  +-  tensor(0.0462, device='cuda:0') (0.009)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.710 +- 0.121
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.807 +- 0.081
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.746392
Plausibility completed in  0:01:41.756901
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7734, device='cuda:0')  +-  tensor(0.0386, device='cuda:0') (0.009)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.744 +- 0.093
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.915 +- 0.031
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 12:59:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing  5  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 12:59:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.4318
Train Loss: 1.6191
ID Validation ACCURACY: 0.4249
ID Validation Loss: 1.6400
ID Test ACCURACY: 0.4277
ID Test Loss: 1.6411
OOD Validation ACCURACY: 0.3363
OOD Validation Loss: 2.1037
OOD Test ACCURACY: 0.2310
OOD Test Loss: 2.6250

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.4277
Train Loss: 1.6056
ID Validation ACCURACY: 0.4169
ID Validation Loss: 1.6171
ID Test ACCURACY: 0.4223
ID Test Loss: 1.6322
OOD Validation ACCURACY: 0.3510
OOD Validation Loss: 1.9996
OOD Test ACCURACY: 0.2556
OOD Test Loss: 2.4187

[0m[1;37mINFO[0m: [1mChartInfo 0.4277 0.2310 0.4223 0.2556 0.4169 0.3510[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:18.844020
Plausibility completed in  0:01:57.686386
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4418, device='cuda:0')  +-  tensor(0.0452, device='cuda:0') (0.009)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.635 +- 0.121
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.757 +- 0.080
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.868005
Plausibility completed in  0:01:41.158413
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7836, device='cuda:0')  +-  tensor(0.0404, device='cuda:0') (0.008)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.684 +- 0.117
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.894 +- 0.040
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 13:14:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mUsing  5  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:21 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 01:14:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 0.4111
Train Loss: 1.6693
ID Validation ACCURACY: 0.4090
ID Validation Loss: 1.6845
ID Test ACCURACY: 0.4119
ID Test Loss: 1.6805
OOD Validation ACCURACY: 0.3519
OOD Validation Loss: 2.0506
OOD Test ACCURACY: 0.2664
OOD Test Loss: 2.5518

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 0.4111
Train Loss: 1.6693
ID Validation ACCURACY: 0.4090
ID Validation Loss: 1.6845
ID Test ACCURACY: 0.4119
ID Test Loss: 1.6805
OOD Validation ACCURACY: 0.3519
OOD Validation Loss: 2.0506
OOD Test ACCURACY: 0.2664
OOD Test Loss: 2.5518

[0m[1;37mINFO[0m: [1mChartInfo 0.4119 0.2664 0.4119 0.2664 0.4090 0.3519[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:20.710841
Plausibility completed in  0:02:04.468043
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4378, device='cuda:0')  +-  tensor(0.0480, device='cuda:0') (0.009)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.663 +- 0.120
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.776 +- 0.080
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.846774
Plausibility completed in  0:01:41.780949
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7775, device='cuda:0')  +-  tensor(0.0398, device='cuda:0') (0.009)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.716 +- 0.101
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.905 +- 0.034
Num considered samples: 7000

\FINISHED GOODCMNIST - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.39071664 0.71474732] +- [0.02351512 0.02888046] (mean across ratios: 0.55 +- 0.02)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.42810256 0.76788658] +- [0.02580986 0.02968272] (mean across ratios: 0.60 +- 0.02)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999886 0.99999923] +- [6.95512397e-07 2.35419484e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.78409956 0.90515345] +- [0.02486598 0.00658588] (mean across ratios: 0.84 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999894 0.99999918] +- [1.02019753e-06 5.34982817e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.67610675 0.71618937] +- [0.03729813 0.01954086] (mean across ratios: 0.70 +- 0.02)

Overall time of execution:  1:27:59.199697
DONE CIGA GOODCMNIST/color 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 13:29:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:30 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:30 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing  5  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 01:29:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.2955
Train Loss: 2.1309
ID Validation ACCURACY: 0.2990
ID Validation Loss: 2.1134
ID Test ACCURACY: 0.2890
ID Test Loss: 2.1875
OOD Validation ACCURACY: 0.2706
OOD Validation Loss: 2.4837
OOD Test ACCURACY: 0.2086
OOD Test Loss: 4.6387

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.2797
Train Loss: 2.1018
ID Validation ACCURACY: 0.2841
ID Validation Loss: 2.0829
ID Test ACCURACY: 0.2744
ID Test Loss: 2.1502
OOD Validation ACCURACY: 0.2713
OOD Validation Loss: 2.2479
OOD Test ACCURACY: 0.1836
OOD Test Loss: 3.7387

[0m[1;37mINFO[0m: [1mChartInfo 0.2890 0.2086 0.2744 0.1836 0.2841 0.2713[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:20.079248
Plausibility completed in  0:02:00.901249
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4175, device='cuda:0')  +-  tensor(0.0165, device='cuda:0') (0.007)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.601 +- 0.139
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.751 +- 0.087
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:16.435006
Plausibility completed in  0:01:48.536731
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7815, device='cuda:0')  +-  tensor(0.0148, device='cuda:0') (0.006)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.563 +- 0.148
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.891 +- 0.036
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 13:48:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing  5  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.4261
Train Loss: 1.5957
ID Validation ACCURACY: 0.4141
ID Validation Loss: 1.6418
ID Test ACCURACY: 0.4197
ID Test Loss: 1.6257
OOD Validation ACCURACY: 0.3443
OOD Validation Loss: 2.1405
OOD Test ACCURACY: 0.2526
OOD Test Loss: 2.5709

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.3952
Train Loss: 1.7198
ID Validation ACCURACY: 0.3889
ID Validation Loss: 1.7556
ID Test ACCURACY: 0.3903
ID Test Loss: 1.7504
OOD Validation ACCURACY: 0.3587
OOD Validation Loss: 2.0597
OOD Test ACCURACY: 0.2260
OOD Test Loss: 2.7268

[0m[1;37mINFO[0m: [1mChartInfo 0.4197 0.2526 0.3903 0.2260 0.3889 0.3587[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:18.913907
Plausibility completed in  0:01:55.529538
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5047, device='cuda:0')  +-  tensor(0.0558, device='cuda:0') (0.013)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.511 +- 0.140
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.695 +- 0.089
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:17.048985
Plausibility completed in  0:01:48.995789
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8627, device='cuda:0')  +-  tensor(0.0381, device='cuda:0') (0.010)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.595 +- 0.115
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.898 +- 0.031
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 14:03:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing  5  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.3742
Train Loss: 1.7882
ID Validation ACCURACY: 0.3836
ID Validation Loss: 1.7873
ID Test ACCURACY: 0.3733
ID Test Loss: 1.8005
OOD Validation ACCURACY: 0.3237
OOD Validation Loss: 2.1818
OOD Test ACCURACY: 0.1913
OOD Test Loss: 3.2680

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.3845
Train Loss: 1.7577
ID Validation ACCURACY: 0.3803
ID Validation Loss: 1.7604
ID Test ACCURACY: 0.3764
ID Test Loss: 1.7715
OOD Validation ACCURACY: 0.3377
OOD Validation Loss: 2.0441
OOD Test ACCURACY: 0.1530
OOD Test Loss: 4.8804

[0m[1;37mINFO[0m: [1mChartInfo 0.3733 0.1913 0.3764 0.1530 0.3803 0.3377[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:17.077989
Plausibility completed in  0:02:01.018168
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4826, device='cuda:0')  +-  tensor(0.0454, device='cuda:0') (0.012)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.587 +- 0.143
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.742 +- 0.090
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:22.232389
Plausibility completed in  0:01:52.807068
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8445, device='cuda:0')  +-  tensor(0.0324, device='cuda:0') (0.010)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.629 +- 0.100
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.907 +- 0.026
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 14:18:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:35 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing  5  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 02:18:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.4318
Train Loss: 1.6191
ID Validation ACCURACY: 0.4249
ID Validation Loss: 1.6400
ID Test ACCURACY: 0.4277
ID Test Loss: 1.6411
OOD Validation ACCURACY: 0.3363
OOD Validation Loss: 2.1037
OOD Test ACCURACY: 0.2310
OOD Test Loss: 2.6250

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.4277
Train Loss: 1.6056
ID Validation ACCURACY: 0.4169
ID Validation Loss: 1.6171
ID Test ACCURACY: 0.4223
ID Test Loss: 1.6322
OOD Validation ACCURACY: 0.3510
OOD Validation Loss: 1.9996
OOD Test ACCURACY: 0.2556
OOD Test Loss: 2.4187

[0m[1;37mINFO[0m: [1mChartInfo 0.4277 0.2310 0.4223 0.2556 0.4169 0.3510[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:18.552191
Plausibility completed in  0:02:01.535186
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4941, device='cuda:0')  +-  tensor(0.0502, device='cuda:0') (0.014)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.500 +- 0.139
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.688 +- 0.087
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:19.834262
Plausibility completed in  0:02:00.677904
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8513, device='cuda:0')  +-  tensor(0.0360, device='cuda:0') (0.010)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.560 +- 0.126
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.889 +- 0.034
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 14:33:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:26 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:26 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing  5  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 02:33:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 0.4111
Train Loss: 1.6693
ID Validation ACCURACY: 0.4090
ID Validation Loss: 1.6845
ID Test ACCURACY: 0.4119
ID Test Loss: 1.6805
OOD Validation ACCURACY: 0.3519
OOD Validation Loss: 2.0506
OOD Test ACCURACY: 0.2664
OOD Test Loss: 2.5518

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 0.4111
Train Loss: 1.6693
ID Validation ACCURACY: 0.4090
ID Validation Loss: 1.6845
ID Test ACCURACY: 0.4119
ID Test Loss: 1.6805
OOD Validation ACCURACY: 0.3519
OOD Validation Loss: 2.0506
OOD Test ACCURACY: 0.2664
OOD Test Loss: 2.5518

[0m[1;37mINFO[0m: [1mChartInfo 0.4119 0.2664 0.4119 0.2664 0.4090 0.3519[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:19.167456
Plausibility completed in  0:01:56.963666
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4889, device='cuda:0')  +-  tensor(0.0470, device='cuda:0') (0.013)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.541 +- 0.133
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.713 +- 0.084
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:17.389297
Plausibility completed in  0:01:57.194444
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8432, device='cuda:0')  +-  tensor(0.0314, device='cuda:0') (0.010)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.581 +- 0.109
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.895 +- 0.029
Num considered samples: 7000

\FINISHED GOODCMNIST - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.39071661 0.71474727] +- [0.02351499 0.02888036] (mean across ratios: 0.55 +- 0.02)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.47756633 0.8366239 ] +- [0.03087648 0.02841905] (mean across ratios: 0.66 +- 0.02)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999868 0.99999909] +- [2.90538254e-07 1.43051147e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.71759079 0.89609149] +- [0.02501013 0.00623822] (mean across ratios: 0.81 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999871 0.99999886] +- [3.94652971e-07 3.40112272e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.5480812  0.58555944] +- [0.0399335  0.02503987] (mean across ratios: 0.57 +- 0.02)

Overall time of execution:  1:18:44.895967
DONE CIGA GOODCMNIST/color 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 14:48:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 02:48:31 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:05 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:15 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:25 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:41 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 150...
[0m[1;37mINFO[0m: [1mCheckpoint 150: 
-----------------------------------
Train ROC-AUC: 0.9480
Train Loss: 0.3695
ID Validation ROC-AUC: 0.9027
ID Validation Loss: 0.4699
ID Test ROC-AUC: 0.9084
ID Test Loss: 0.4696
OOD Validation ROC-AUC: 0.5843
OOD Validation Loss: 0.5387
OOD Test ROC-AUC: 0.6552
OOD Test Loss: 0.8904

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 45...
[0m[1;37mINFO[0m: [1mCheckpoint 45: 
-----------------------------------
Train ROC-AUC: 0.9099
Train Loss: 0.2545
ID Validation ROC-AUC: 0.8783
ID Validation Loss: 0.2915
ID Test ROC-AUC: 0.8887
ID Test Loss: 0.2844
OOD Validation ROC-AUC: 0.6509
OOD Validation Loss: 0.3384
OOD Test ROC-AUC: 0.6766
OOD Test Loss: 0.5363

[0m[1;37mINFO[0m: [1mChartInfo 0.9084 0.6552 0.8887 0.6766 0.8783 0.6509[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 02:49:58 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:26.095695
Plausibility completed in  0:10:37.528887
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4795, device='cuda:0')  +-  tensor(0.0681, device='cuda:0') (0.020)
Original Stability MCC for r=0.3 = 0.998 +- 0.017
Intervened Stability MCC for r=0.3 = 0.721 +- 0.192
Original Stability F1 for r=0.3 = 0.999 +- 0.012
Intervened Stability F1 for r=0.3 = 0.819 +- 0.122
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:27.296903
Plausibility completed in  0:10:20.420424
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8224, device='cuda:0')  +-  tensor(0.0563, device='cuda:0') (0.023)
Original Stability MCC for r=0.6 = 0.998 +- 0.019
Intervened Stability MCC for r=0.6 = 0.757 +- 0.194
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.924 +- 0.057
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 15:14:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 03:14:49 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 03:15:40 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 03:15:56 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 03:16:14 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 03:16:38 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 150...
[0m[1;37mINFO[0m: [1mCheckpoint 150: 
-----------------------------------
Train ROC-AUC: 0.9689
Train Loss: 0.1480
ID Validation ROC-AUC: 0.9058
ID Validation Loss: 0.2470
ID Test ROC-AUC: 0.9023
ID Test Loss: 0.2550
OOD Validation ROC-AUC: 0.6055
OOD Validation Loss: 0.6083
OOD Test ROC-AUC: 0.6627
OOD Test Loss: 0.6582

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 10...
[0m[1;37mINFO[0m: [1mCheckpoint 10: 
-----------------------------------
Train ROC-AUC: 0.8477
Train Loss: 0.3118
ID Validation ROC-AUC: 0.8262
ID Validation Loss: 0.3219
ID Test ROC-AUC: 0.8375
ID Test Loss: 0.3183
OOD Validation ROC-AUC: 0.6697
OOD Validation Loss: 0.4002
OOD Test ROC-AUC: 0.6582
OOD Test Loss: 0.4850

[0m[1;37mINFO[0m: [1mChartInfo 0.9023 0.6627 0.8375 0.6582 0.8262 0.6697[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 03:17:00 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:34.801288
Plausibility completed in  0:10:46.792513
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5618, device='cuda:0')  +-  tensor(0.0771, device='cuda:0') (0.031)
Original Stability MCC for r=0.3 = 0.998 +- 0.016
Intervened Stability MCC for r=0.3 = 0.783 +- 0.174
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.860 +- 0.110
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:35.674222
Plausibility completed in  0:11:15.499501
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8543, device='cuda:0')  +-  tensor(0.0427, device='cuda:0') (0.029)
Original Stability MCC for r=0.6 = 0.998 +- 0.017
Intervened Stability MCC for r=0.6 = 0.672 +- 0.209
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.897 +- 0.061
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 15:44:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:43 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 03:45:27 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 03:45:43 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 03:45:59 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:20 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 03:46:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ROC-AUC: 0.9459
Train Loss: 0.2739
ID Validation ROC-AUC: 0.9033
ID Validation Loss: 0.3429
ID Test ROC-AUC: 0.9089
ID Test Loss: 0.3383
OOD Validation ROC-AUC: 0.6038
OOD Validation Loss: 0.4024
OOD Test ROC-AUC: 0.6620
OOD Test Loss: 0.6481

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 14...
[0m[1;37mINFO[0m: [1mCheckpoint 14: 
-----------------------------------
Train ROC-AUC: 0.8786
Train Loss: 0.2942
ID Validation ROC-AUC: 0.8634
ID Validation Loss: 0.3109
ID Test ROC-AUC: 0.8696
ID Test Loss: 0.3099
OOD Validation ROC-AUC: 0.6437
OOD Validation Loss: 0.3274
OOD Test ROC-AUC: 0.6934
OOD Test Loss: 0.5211

[0m[1;37mINFO[0m: [1mChartInfo 0.9089 0.6620 0.8696 0.6934 0.8634 0.6437[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 03:46:46 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:36.126818
Plausibility completed in  0:11:15.497467
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4943, device='cuda:0')  +-  tensor(0.0784, device='cuda:0') (0.021)
Original Stability MCC for r=0.3 = 0.998 +- 0.018
Intervened Stability MCC for r=0.3 = 0.697 +- 0.204
Original Stability F1 for r=0.3 = 0.999 +- 0.012
Intervened Stability F1 for r=0.3 = 0.804 +- 0.130
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:35.828972
Plausibility completed in  0:11:05.608047
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8327, device='cuda:0')  +-  tensor(0.0631, device='cuda:0') (0.024)
Original Stability MCC for r=0.6 = 0.998 +- 0.019
Intervened Stability MCC for r=0.6 = 0.741 +- 0.209
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.919 +- 0.061
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 16:14:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:06 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:37 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:48 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:58 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:16 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 04:15:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 159...
[0m[1;37mINFO[0m: [1mCheckpoint 159: 
-----------------------------------
Train ROC-AUC: 0.9548
Train Loss: 0.3192
ID Validation ROC-AUC: 0.9041
ID Validation Loss: 0.4545
ID Test ROC-AUC: 0.9006
ID Test Loss: 0.4686
OOD Validation ROC-AUC: 0.5961
OOD Validation Loss: 0.5439
OOD Test ROC-AUC: 0.6685
OOD Test Loss: 0.8654

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ROC-AUC: 0.8746
Train Loss: 0.3120
ID Validation ROC-AUC: 0.8599
ID Validation Loss: 0.3287
ID Test ROC-AUC: 0.8641
ID Test Loss: 0.3301
OOD Validation ROC-AUC: 0.6526
OOD Validation Loss: 0.3467
OOD Test ROC-AUC: 0.6783
OOD Test Loss: 0.5797

[0m[1;37mINFO[0m: [1mChartInfo 0.9006 0.6685 0.8641 0.6783 0.8599 0.6526[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 04:15:37 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:33.870851
Plausibility completed in  0:11:27.694635
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5104, device='cuda:0')  +-  tensor(0.0805, device='cuda:0') (0.024)
Original Stability MCC for r=0.3 = 0.998 +- 0.019
Intervened Stability MCC for r=0.3 = 0.732 +- 0.190
Original Stability F1 for r=0.3 = 0.999 +- 0.013
Intervened Stability F1 for r=0.3 = 0.826 +- 0.121
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:25.089035
Plausibility completed in  0:10:29.247679
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8535, device='cuda:0')  +-  tensor(0.0606, device='cuda:0') (0.024)
Original Stability MCC for r=0.6 = 0.998 +- 0.017
Intervened Stability MCC for r=0.6 = 0.775 +- 0.188
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.930 +- 0.055
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 16:42:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 04:42:28 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:05 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:15 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:26 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:41 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 04:43:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 152...
[0m[1;37mINFO[0m: [1mCheckpoint 152: 
-----------------------------------
Train ROC-AUC: 0.9637
Train Loss: 0.2273
ID Validation ROC-AUC: 0.9083
ID Validation Loss: 0.3490
ID Test ROC-AUC: 0.9104
ID Test Loss: 0.3513
OOD Validation ROC-AUC: 0.5940
OOD Validation Loss: 0.4940
OOD Test ROC-AUC: 0.6574
OOD Test Loss: 0.7667

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ROC-AUC: 0.8938
Train Loss: 0.2424
ID Validation ROC-AUC: 0.8717
ID Validation Loss: 0.2611
ID Test ROC-AUC: 0.8711
ID Test Loss: 0.2630
OOD Validation ROC-AUC: 0.6590
OOD Validation Loss: 0.3149
OOD Test ROC-AUC: 0.6741
OOD Test Loss: 0.4665

[0m[1;37mINFO[0m: [1mChartInfo 0.9104 0.6574 0.8711 0.6741 0.8717 0.6590[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 04:43:58 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.414187
Plausibility completed in  0:10:29.621804
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4993, device='cuda:0')  +-  tensor(0.0727, device='cuda:0') (0.024)
Original Stability MCC for r=0.3 = 0.998 +- 0.017
Intervened Stability MCC for r=0.3 = 0.727 +- 0.187
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.823 +- 0.119
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.541515
Plausibility completed in  0:10:14.136417
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8320, device='cuda:0')  +-  tensor(0.0566, device='cuda:0') (0.026)
Original Stability MCC for r=0.6 = 0.997 +- 0.019
Intervened Stability MCC for r=0.6 = 0.729 +- 0.198
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.915 +- 0.057
Num considered samples: 11314

\FINISHED LBAPcore - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.48446835 0.82983488] +- [0.03211441 0.02195516] (mean across ratios: 0.66 +- 0.02)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.50905849 0.83897368] +- [0.02818679 0.01272606] (mean across ratios: 0.67 +- 0.02)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99866024 0.99912356] +- [7.38445271e-05 1.53336845e-04] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.82623019 0.91715854] +- [0.01835978 0.01116222] (mean across ratios: 0.87 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99804291 0.99770931] +- [0.00010996 0.00038667] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.73196038 0.73475754] +- [0.02809091 0.03509209] (mean across ratios: 0.73 +- 0.02)

Overall time of execution:  2:20:04.230830
DONE CIGA LBAPcore/assay 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 17:08:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 05:08:53 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 05:09:36 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 05:09:51 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:07 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:32 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 05:10:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 150...
[0m[1;37mINFO[0m: [1mCheckpoint 150: 
-----------------------------------
Train ROC-AUC: 0.9480
Train Loss: 0.3695
ID Validation ROC-AUC: 0.9027
ID Validation Loss: 0.4699
ID Test ROC-AUC: 0.9084
ID Test Loss: 0.4696
OOD Validation ROC-AUC: 0.5843
OOD Validation Loss: 0.5387
OOD Test ROC-AUC: 0.6552
OOD Test Loss: 0.8904

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 45...
[0m[1;37mINFO[0m: [1mCheckpoint 45: 
-----------------------------------
Train ROC-AUC: 0.9099
Train Loss: 0.2545
ID Validation ROC-AUC: 0.8783
ID Validation Loss: 0.2915
ID Test ROC-AUC: 0.8887
ID Test Loss: 0.2844
OOD Validation ROC-AUC: 0.6509
OOD Validation Loss: 0.3384
OOD Test ROC-AUC: 0.6766
OOD Test Loss: 0.5363

[0m[1;37mINFO[0m: [1mChartInfo 0.9084 0.6552 0.8887 0.6766 0.8783 0.6509[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 05:10:58 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:26.692510
Plausibility completed in  0:10:56.224937
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5208, device='cuda:0')  +-  tensor(0.0714, device='cuda:0') (0.028)
Original Stability MCC for r=0.3 = 0.998 +- 0.018
Intervened Stability MCC for r=0.3 = 0.567 +- 0.233
Original Stability F1 for r=0.3 = 0.999 +- 0.012
Intervened Stability F1 for r=0.3 = 0.746 +- 0.131
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:26.363135
Plausibility completed in  0:09:31.489592
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8726, device='cuda:0')  +-  tensor(0.0512, device='cuda:0') (0.023)
Original Stability MCC for r=0.6 = 0.998 +- 0.017
Intervened Stability MCC for r=0.6 = 0.574 +- 0.306
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.921 +- 0.052
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 17:35:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 05:35:29 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 05:36:02 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 05:36:15 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 05:36:26 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 05:36:43 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 150...
[0m[1;37mINFO[0m: [1mCheckpoint 150: 
-----------------------------------
Train ROC-AUC: 0.9689
Train Loss: 0.1480
ID Validation ROC-AUC: 0.9058
ID Validation Loss: 0.2470
ID Test ROC-AUC: 0.9023
ID Test Loss: 0.2550
OOD Validation ROC-AUC: 0.6055
OOD Validation Loss: 0.6083
OOD Test ROC-AUC: 0.6627
OOD Test Loss: 0.6582

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 10...
[0m[1;37mINFO[0m: [1mCheckpoint 10: 
-----------------------------------
Train ROC-AUC: 0.8477
Train Loss: 0.3118
ID Validation ROC-AUC: 0.8262
ID Validation Loss: 0.3219
ID Test ROC-AUC: 0.8375
ID Test Loss: 0.3183
OOD Validation ROC-AUC: 0.6697
OOD Validation Loss: 0.4002
OOD Test ROC-AUC: 0.6582
OOD Test Loss: 0.4850

[0m[1;37mINFO[0m: [1mChartInfo 0.9023 0.6627 0.8375 0.6582 0.8262 0.6697[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 05:37:00 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:28.688370
Plausibility completed in  0:09:47.503340
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5676, device='cuda:0')  +-  tensor(0.0625, device='cuda:0') (0.040)
Original Stability MCC for r=0.3 = 0.998 +- 0.016
Intervened Stability MCC for r=0.3 = 0.613 +- 0.232
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.775 +- 0.125
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:26.046536
Plausibility completed in  0:09:39.182541
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8675, device='cuda:0')  +-  tensor(0.0444, device='cuda:0') (0.030)
Original Stability MCC for r=0.6 = 0.998 +- 0.016
Intervened Stability MCC for r=0.6 = 0.391 +- 0.304
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.882 +- 0.060
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 18:00:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 06:00:30 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:02 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:13 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:24 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:41 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ROC-AUC: 0.9459
Train Loss: 0.2739
ID Validation ROC-AUC: 0.9033
ID Validation Loss: 0.3429
ID Test ROC-AUC: 0.9089
ID Test Loss: 0.3383
OOD Validation ROC-AUC: 0.6038
OOD Validation Loss: 0.4024
OOD Test ROC-AUC: 0.6620
OOD Test Loss: 0.6481

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 14...
[0m[1;37mINFO[0m: [1mCheckpoint 14: 
-----------------------------------
Train ROC-AUC: 0.8786
Train Loss: 0.2942
ID Validation ROC-AUC: 0.8634
ID Validation Loss: 0.3109
ID Test ROC-AUC: 0.8696
ID Test Loss: 0.3099
OOD Validation ROC-AUC: 0.6437
OOD Validation Loss: 0.3274
OOD Test ROC-AUC: 0.6934
OOD Test Loss: 0.5211

[0m[1;37mINFO[0m: [1mChartInfo 0.9089 0.6620 0.8696 0.6934 0.8634 0.6437[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 06:01:58 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.559098
Plausibility completed in  0:10:20.039398
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5303, device='cuda:0')  +-  tensor(0.0782, device='cuda:0') (0.029)
Original Stability MCC for r=0.3 = 0.998 +- 0.017
Intervened Stability MCC for r=0.3 = 0.531 +- 0.245
Original Stability F1 for r=0.3 = 0.999 +- 0.012
Intervened Stability F1 for r=0.3 = 0.725 +- 0.138
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:25.369892
Plausibility completed in  0:10:03.693204
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8762, device='cuda:0')  +-  tensor(0.0525, device='cuda:0') (0.026)
Original Stability MCC for r=0.6 = 0.998 +- 0.020
Intervened Stability MCC for r=0.6 = 0.540 +- 0.317
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.914 +- 0.057
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 18:27:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 06:27:22 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 06:27:58 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:10 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:22 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:48 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 159...
[0m[1;37mINFO[0m: [1mCheckpoint 159: 
-----------------------------------
Train ROC-AUC: 0.9548
Train Loss: 0.3192
ID Validation ROC-AUC: 0.9041
ID Validation Loss: 0.4545
ID Test ROC-AUC: 0.9006
ID Test Loss: 0.4686
OOD Validation ROC-AUC: 0.5961
OOD Validation Loss: 0.5439
OOD Test ROC-AUC: 0.6685
OOD Test Loss: 0.8654

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ROC-AUC: 0.8746
Train Loss: 0.3120
ID Validation ROC-AUC: 0.8599
ID Validation Loss: 0.3287
ID Test ROC-AUC: 0.8641
ID Test Loss: 0.3301
OOD Validation ROC-AUC: 0.6526
OOD Validation Loss: 0.3467
OOD Test ROC-AUC: 0.6783
OOD Test Loss: 0.5797

[0m[1;37mINFO[0m: [1mChartInfo 0.9006 0.6685 0.8641 0.6783 0.8599 0.6526[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 06:29:14 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:26.030153
Plausibility completed in  0:09:20.160465
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5580, device='cuda:0')  +-  tensor(0.0850, device='cuda:0') (0.034)
Original Stability MCC for r=0.3 = 0.998 +- 0.019
Intervened Stability MCC for r=0.3 = 0.582 +- 0.237
Original Stability F1 for r=0.3 = 0.999 +- 0.013
Intervened Stability F1 for r=0.3 = 0.756 +- 0.133
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.419257
Plausibility completed in  0:09:24.905045
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9018, device='cuda:0')  +-  tensor(0.0517, device='cuda:0') (0.025)
Original Stability MCC for r=0.6 = 0.998 +- 0.018
Intervened Stability MCC for r=0.6 = 0.618 +- 0.302
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.929 +- 0.051
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 18:52:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 06:52:14 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 06:52:56 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:07 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:18 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:35 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 152...
[0m[1;37mINFO[0m: [1mCheckpoint 152: 
-----------------------------------
Train ROC-AUC: 0.9637
Train Loss: 0.2273
ID Validation ROC-AUC: 0.9083
ID Validation Loss: 0.3490
ID Test ROC-AUC: 0.9104
ID Test Loss: 0.3513
OOD Validation ROC-AUC: 0.5940
OOD Validation Loss: 0.4940
OOD Test ROC-AUC: 0.6574
OOD Test Loss: 0.7667

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ROC-AUC: 0.8938
Train Loss: 0.2424
ID Validation ROC-AUC: 0.8717
ID Validation Loss: 0.2611
ID Test ROC-AUC: 0.8711
ID Test Loss: 0.2630
OOD Validation ROC-AUC: 0.6590
OOD Validation Loss: 0.3149
OOD Test ROC-AUC: 0.6741
OOD Test Loss: 0.4665

[0m[1;37mINFO[0m: [1mChartInfo 0.9104 0.6574 0.8711 0.6741 0.8717 0.6590[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 06:53:51 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.005231
Plausibility completed in  0:09:12.248482
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5329, device='cuda:0')  +-  tensor(0.0701, device='cuda:0') (0.032)
Original Stability MCC for r=0.3 = 0.998 +- 0.015
Intervened Stability MCC for r=0.3 = 0.574 +- 0.232
Original Stability F1 for r=0.3 = 0.999 +- 0.010
Intervened Stability F1 for r=0.3 = 0.751 +- 0.130
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:31.001314
Plausibility completed in  0:09:29.082043
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8739, device='cuda:0')  +-  tensor(0.0491, device='cuda:0') (0.026)
Original Stability MCC for r=0.6 = 0.997 +- 0.021
Intervened Stability MCC for r=0.6 = 0.532 +- 0.301
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.911 +- 0.053
Num considered samples: 11314

\FINISHED LBAPcore - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.48446832 0.82983482] +- [0.0321144 0.0219552] (mean across ratios: 0.66 +- 0.02)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.54190969 0.87842357] +- [0.0177856  0.01204126] (mean across ratios: 0.71 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99870288 0.99911631] +- [0.00010143 0.00017948] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.75051332 0.91138883] +- [0.01615654 0.01614833] (mean across ratios: 0.83 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99810594 0.99768777] +- [0.00015238 0.0004613 ] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.57357188 0.53090695] +- [0.02636046 0.07613826] (mean across ratios: 0.55 +- 0.04)

Overall time of execution:  2:07:39.341389
DONE CIGA LBAPcore/assay 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:16:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 07:16:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.8550
Train Loss: 0.4111
ID Validation ACCURACY: 0.8098
ID Validation Loss: 0.4890
ID Test ACCURACY: 0.8080
ID Test Loss: 0.5001
OOD Validation ACCURACY: 0.7392
OOD Validation Loss: 0.5336
OOD Test ACCURACY: 0.5942
OOD Test Loss: 0.6023

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.8550
Train Loss: 0.4111
ID Validation ACCURACY: 0.8098
ID Validation Loss: 0.4890
ID Test ACCURACY: 0.8080
ID Test Loss: 0.5001
OOD Validation ACCURACY: 0.7392
OOD Validation Loss: 0.5336
OOD Test ACCURACY: 0.5942
OOD Test Loss: 0.6023

[0m[1;37mINFO[0m: [1mChartInfo 0.8080 0.5942 0.8080 0.5942 0.8098 0.7392[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 07:16:51 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.503050
Plausibility completed in  0:00:16.268000
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1963, device='cuda:0')  +-  tensor(0.2709, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 0.998 +- 0.042
Intervened Stability MCC for r=0.3 = 0.731 +- 0.501
Original Stability F1 for r=0.3 = 0.999 +- 0.022
Intervened Stability F1 for r=0.3 = 0.876 +- 0.226
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.368792
Plausibility completed in  0:00:15.959271
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3098, device='cuda:0')  +-  tensor(0.4200, device='cuda:0') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.038
Intervened Stability MCC for r=0.6 = 0.410 +- 0.552
Original Stability F1 for r=0.6 = 1.000 +- 0.008
Intervened Stability F1 for r=0.6 = 0.952 +- 0.110
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:17:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 07:17:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0754
ID Validation ACCURACY: 0.8604
ID Validation Loss: 1.0229
ID Test ACCURACY: 0.8561
ID Test Loss: 1.1527
OOD Validation ACCURACY: 0.8477
OOD Validation Loss: 3.3872
OOD Test ACCURACY: 0.7903
OOD Test Loss: 4.9558

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 118...
[0m[1;37mINFO[0m: [1mCheckpoint 118: 
-----------------------------------
Train ACCURACY: 0.9484
Train Loss: 0.0768
ID Validation ACCURACY: 0.8532
ID Validation Loss: 1.2979
ID Test ACCURACY: 0.8521
ID Test Loss: 1.5484
OOD Validation ACCURACY: 0.8587
OOD Validation Loss: 3.8430
OOD Test ACCURACY: 0.8120
OOD Test Loss: 5.5150

[0m[1;37mINFO[0m: [1mChartInfo 0.8561 0.7903 0.8521 0.8120 0.8532 0.8587[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 07:17:44 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.178826
Plausibility completed in  0:00:16.426055
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2325, device='cuda:0')  +-  tensor(0.3263, device='cuda:0') (0.020)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.751 +- 0.492
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.882 +- 0.230
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.125134
Plausibility completed in  0:00:16.050079
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3222, device='cuda:0')  +-  tensor(0.4358, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.472 +- 0.542
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.966 +- 0.094
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:18:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 07:18:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8623
ID Validation Loss: 2.4682
ID Test ACCURACY: 0.8612
ID Test Loss: 2.9010
OOD Validation ACCURACY: 0.8557
OOD Validation Loss: 5.3706
OOD Test ACCURACY: 0.7949
OOD Test Loss: 8.1971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9484
Train Loss: 0.0805
ID Validation ACCURACY: 0.8544
ID Validation Loss: 0.8464
ID Test ACCURACY: 0.8542
ID Test Loss: 1.0687
OOD Validation ACCURACY: 0.8595
OOD Validation Loss: 2.9836
OOD Test ACCURACY: 0.7982
OOD Test Loss: 3.4505

[0m[1;37mINFO[0m: [1mChartInfo 0.8612 0.7949 0.8542 0.7982 0.8544 0.8595[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 07:18:35 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.182979
Plausibility completed in  0:00:16.122599
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2425, device='cuda:0')  +-  tensor(0.3427, device='cuda:0') (0.023)
Original Stability MCC for r=0.3 = 0.998 +- 0.035
Intervened Stability MCC for r=0.3 = 0.756 +- 0.491
Original Stability F1 for r=0.3 = 0.999 +- 0.018
Intervened Stability F1 for r=0.3 = 0.887 +- 0.225
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.322232
Plausibility completed in  0:00:16.031340
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3261, device='cuda:0')  +-  tensor(0.4411, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.473 +- 0.541
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.966 +- 0.093
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:19:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 170...
[0m[1;37mINFO[0m: [1mCheckpoint 170: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8623
ID Validation Loss: 1.5974
ID Test ACCURACY: 0.8544
ID Test Loss: 2.0365
OOD Validation ACCURACY: 0.8543
OOD Validation Loss: 3.4836
OOD Test ACCURACY: 0.7864
OOD Test Loss: 7.7740

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0755
ID Validation ACCURACY: 0.8536
ID Validation Loss: 1.0924
ID Test ACCURACY: 0.8563
ID Test Loss: 1.3289
OOD Validation ACCURACY: 0.8577
OOD Validation Loss: 2.8081
OOD Test ACCURACY: 0.7972
OOD Test Loss: 3.9612

[0m[1;37mINFO[0m: [1mChartInfo 0.8544 0.7864 0.8563 0.7972 0.8536 0.8577[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 07:19:26 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.408475
Plausibility completed in  0:00:15.884154
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2379, device='cuda:0')  +-  tensor(0.3363, device='cuda:0') (0.023)
Original Stability MCC for r=0.3 = 1.000 +- 0.010
Intervened Stability MCC for r=0.3 = 0.715 +- 0.519
Original Stability F1 for r=0.3 = 1.000 +- 0.005
Intervened Stability F1 for r=0.3 = 0.867 +- 0.240
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.366928
Plausibility completed in  0:00:16.024745
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:0')  +-  tensor(0.4388, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 0.999 +- 0.036
Intervened Stability MCC for r=0.6 = 0.460 +- 0.544
Original Stability F1 for r=0.6 = 1.000 +- 0.011
Intervened Stability F1 for r=0.6 = 0.963 +- 0.098
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:20:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0757
ID Validation ACCURACY: 0.8610
ID Validation Loss: 0.8028
ID Test ACCURACY: 0.8600
ID Test Loss: 1.0996
OOD Validation ACCURACY: 0.8599
OOD Validation Loss: 2.7628
OOD Test ACCURACY: 0.8133
OOD Test Loss: 3.9052

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9481
Train Loss: 0.0779
ID Validation ACCURACY: 0.8563
ID Validation Loss: 0.7223
ID Test ACCURACY: 0.8585
ID Test Loss: 0.9870
OOD Validation ACCURACY: 0.8610
OOD Validation Loss: 2.2647
OOD Test ACCURACY: 0.8027
OOD Test Loss: 3.2630

[0m[1;37mINFO[0m: [1mChartInfo 0.8600 0.8133 0.8585 0.8027 0.8563 0.8610[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 07:20:18 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.427200
Plausibility completed in  0:00:16.154351
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2376, device='cuda:0')  +-  tensor(0.3349, device='cuda:0') (0.021)
Original Stability MCC for r=0.3 = 1.000 +- 0.010
Intervened Stability MCC for r=0.3 = 0.753 +- 0.484
Original Stability F1 for r=0.3 = 1.000 +- 0.005
Intervened Stability F1 for r=0.3 = 0.884 +- 0.223
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.359432
Plausibility completed in  0:00:16.139987
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3238, device='cuda:0')  +-  tensor(0.4381, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.463 +- 0.544
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.964 +- 0.097
Num considered samples: 1895

\FINISHED GOODSST2 - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.51554304 0.75407799] +- [0.08176573 0.05463544] (mean across ratios: 0.63 +- 0.05)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.22934242 0.32118158] +- [0.01683485 0.00584981] (mean across ratios: 0.28 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.9995455 0.9998787] +- [0.00048549 0.00015113] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.87895659 0.96203651] +- [0.00712125 0.0053938 ] (mean across ratios: 0.92 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99912096 0.99952506] +- [0.00092748 0.00058235] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.74112517 0.45560064] +- [0.01559496 0.02337613] (mean across ratios: 0.60 +- 0.01)

Overall time of execution:  0:04:20.676133
DONE CIGA GOODSST2/length 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:21:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.8550
Train Loss: 0.4111
ID Validation ACCURACY: 0.8098
ID Validation Loss: 0.4890
ID Test ACCURACY: 0.8080
ID Test Loss: 0.5001
OOD Validation ACCURACY: 0.7392
OOD Validation Loss: 0.5336
OOD Test ACCURACY: 0.5942
OOD Test Loss: 0.6023

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.8550
Train Loss: 0.4111
ID Validation ACCURACY: 0.8098
ID Validation Loss: 0.4890
ID Test ACCURACY: 0.8080
ID Test Loss: 0.5001
OOD Validation ACCURACY: 0.7392
OOD Validation Loss: 0.5336
OOD Test ACCURACY: 0.5942
OOD Test Loss: 0.6023

[0m[1;37mINFO[0m: [1mChartInfo 0.8080 0.5942 0.8080 0.5942 0.8098 0.7392[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 07:21:24 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.624515
Plausibility completed in  0:00:19.431779
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1963, device='cuda:0')  +-  tensor(0.2709, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 0.998 +- 0.042
Intervened Stability MCC for r=0.3 = 0.731 +- 0.501
Original Stability F1 for r=0.3 = 0.999 +- 0.022
Intervened Stability F1 for r=0.3 = 0.876 +- 0.226
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.773317
Plausibility completed in  0:00:20.261524
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3098, device='cuda:0')  +-  tensor(0.4200, device='cuda:0') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.038
Intervened Stability MCC for r=0.6 = 0.410 +- 0.552
Original Stability F1 for r=0.6 = 1.000 +- 0.008
Intervened Stability F1 for r=0.6 = 0.952 +- 0.110
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:22:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0754
ID Validation ACCURACY: 0.8604
ID Validation Loss: 1.0229
ID Test ACCURACY: 0.8561
ID Test Loss: 1.1527
OOD Validation ACCURACY: 0.8477
OOD Validation Loss: 3.3872
OOD Test ACCURACY: 0.7903
OOD Test Loss: 4.9558

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 118...
[0m[1;37mINFO[0m: [1mCheckpoint 118: 
-----------------------------------
Train ACCURACY: 0.9484
Train Loss: 0.0768
ID Validation ACCURACY: 0.8532
ID Validation Loss: 1.2979
ID Test ACCURACY: 0.8521
ID Test Loss: 1.5484
OOD Validation ACCURACY: 0.8587
OOD Validation Loss: 3.8430
OOD Test ACCURACY: 0.8120
OOD Test Loss: 5.5150

[0m[1;37mINFO[0m: [1mChartInfo 0.8561 0.7903 0.8521 0.8120 0.8532 0.8587[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 07:22:25 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:04.334265
Plausibility completed in  0:00:19.367267
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2325, device='cuda:0')  +-  tensor(0.3263, device='cuda:0') (0.020)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.751 +- 0.492
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.882 +- 0.230
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:04.592092
Plausibility completed in  0:00:16.430004
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3222, device='cuda:0')  +-  tensor(0.4358, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.472 +- 0.542
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.966 +- 0.094
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:23:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8623
ID Validation Loss: 2.4682
ID Test ACCURACY: 0.8612
ID Test Loss: 2.9010
OOD Validation ACCURACY: 0.8557
OOD Validation Loss: 5.3706
OOD Test ACCURACY: 0.7949
OOD Test Loss: 8.1971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9484
Train Loss: 0.0805
ID Validation ACCURACY: 0.8544
ID Validation Loss: 0.8464
ID Test ACCURACY: 0.8542
ID Test Loss: 1.0687
OOD Validation ACCURACY: 0.8595
OOD Validation Loss: 2.9836
OOD Test ACCURACY: 0.7982
OOD Test Loss: 3.4505

[0m[1;37mINFO[0m: [1mChartInfo 0.8612 0.7949 0.8542 0.7982 0.8544 0.8595[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 07:23:25 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.624812
Plausibility completed in  0:00:16.262894
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2425, device='cuda:0')  +-  tensor(0.3427, device='cuda:0') (0.023)
Original Stability MCC for r=0.3 = 0.998 +- 0.035
Intervened Stability MCC for r=0.3 = 0.756 +- 0.491
Original Stability F1 for r=0.3 = 0.999 +- 0.018
Intervened Stability F1 for r=0.3 = 0.887 +- 0.225
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.390512
Plausibility completed in  0:00:16.398763
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3261, device='cuda:0')  +-  tensor(0.4411, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.473 +- 0.541
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.966 +- 0.093
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:24:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 07:24:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 170...
[0m[1;37mINFO[0m: [1mCheckpoint 170: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8623
ID Validation Loss: 1.5974
ID Test ACCURACY: 0.8544
ID Test Loss: 2.0365
OOD Validation ACCURACY: 0.8543
OOD Validation Loss: 3.4836
OOD Test ACCURACY: 0.7864
OOD Test Loss: 7.7740

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0755
ID Validation ACCURACY: 0.8536
ID Validation Loss: 1.0924
ID Test ACCURACY: 0.8563
ID Test Loss: 1.3289
OOD Validation ACCURACY: 0.8577
OOD Validation Loss: 2.8081
OOD Test ACCURACY: 0.7972
OOD Test Loss: 3.9612

[0m[1;37mINFO[0m: [1mChartInfo 0.8544 0.7864 0.8563 0.7972 0.8536 0.8577[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 07:24:18 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.427712
Plausibility completed in  0:00:16.403854
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2379, device='cuda:0')  +-  tensor(0.3363, device='cuda:0') (0.023)
Original Stability MCC for r=0.3 = 1.000 +- 0.010
Intervened Stability MCC for r=0.3 = 0.715 +- 0.519
Original Stability F1 for r=0.3 = 1.000 +- 0.005
Intervened Stability F1 for r=0.3 = 0.867 +- 0.240
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.404586
Plausibility completed in  0:00:16.117504
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:0')  +-  tensor(0.4388, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 0.999 +- 0.036
Intervened Stability MCC for r=0.6 = 0.460 +- 0.544
Original Stability F1 for r=0.6 = 1.000 +- 0.011
Intervened Stability F1 for r=0.6 = 0.963 +- 0.098
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:25:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0757
ID Validation ACCURACY: 0.8610
ID Validation Loss: 0.8028
ID Test ACCURACY: 0.8600
ID Test Loss: 1.0996
OOD Validation ACCURACY: 0.8599
OOD Validation Loss: 2.7628
OOD Test ACCURACY: 0.8133
OOD Test Loss: 3.9052

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9481
Train Loss: 0.0779
ID Validation ACCURACY: 0.8563
ID Validation Loss: 0.7223
ID Test ACCURACY: 0.8585
ID Test Loss: 0.9870
OOD Validation ACCURACY: 0.8610
OOD Validation Loss: 2.2647
OOD Test ACCURACY: 0.8027
OOD Test Loss: 3.2630

[0m[1;37mINFO[0m: [1mChartInfo 0.8600 0.8133 0.8585 0.8027 0.8563 0.8610[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 07:25:09 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.467016
Plausibility completed in  0:00:16.117301
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2376, device='cuda:0')  +-  tensor(0.3349, device='cuda:0') (0.021)
Original Stability MCC for r=0.3 = 1.000 +- 0.010
Intervened Stability MCC for r=0.3 = 0.753 +- 0.484
Original Stability F1 for r=0.3 = 1.000 +- 0.005
Intervened Stability F1 for r=0.3 = 0.884 +- 0.223
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.398199
Plausibility completed in  0:00:16.133778
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3238, device='cuda:0')  +-  tensor(0.4381, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.463 +- 0.544
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.964 +- 0.097
Num considered samples: 1895

\FINISHED GOODSST2 - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.51554304 0.75407799] +- [0.08176573 0.05463544] (mean across ratios: 0.63 +- 0.05)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.22934242 0.32118158] +- [0.01683485 0.00584981] (mean across ratios: 0.28 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.9995455 0.9998787] +- [0.00048549 0.00015113] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.87895235 0.96203651] +- [0.00712855 0.0053938 ] (mean across ratios: 0.92 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99912096 0.99952506] +- [0.00092748 0.00058235] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.74111813 0.45560064] +- [0.01560662 0.02337613] (mean across ratios: 0.60 +- 0.01)

Overall time of execution:  0:04:39.021296
DONE CIGA GOODSST2/length 0.10
DONE all :)
