nohup: ignoring input
I'm computing faithfulness :)
The PID of this script is: 100739

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:38:56 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:38:56 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:38:56 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:38:56 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:38:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:38:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:38:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:38:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:38:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:38:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:38:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.380
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.336
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.257


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.380346
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.975
SUFF_SIMPLE for r=0.05 class 0.0 = 0.969 +- 0.266 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.951 +- 0.266 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.05 all KL = 0.899 +- 0.266 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.05 all L1 = 0.959 +- 0.118 (in-sample avg dev_std = 0.268)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.336188
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.976
SUFF_SIMPLE for r=0.1 class 0.0 = 0.969 +- 0.265 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.956 +- 0.265 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.1 all KL = 0.902 +- 0.265 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.1 all L1 = 0.962 +- 0.112 (in-sample avg dev_std = 0.259)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.257332
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.974
SUFF_SIMPLE for r=0.2 class 0.0 = 0.962 +- 0.265 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.957 +- 0.265 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.2 all KL = 0.9 +- 0.265 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.2 all L1 = 0.959 +- 0.120 (in-sample avg dev_std = 0.255)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.380346
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.983
NEC for r=0.05 class 0.0 = 0.007 +- 0.240 (in-sample avg dev_std = 0.174)
NEC for r=0.05 class 1.0 = 0.059 +- 0.240 (in-sample avg dev_std = 0.174)
NEC for r=0.05 all KL = 0.105 +- 0.240 (in-sample avg dev_std = 0.174)
NEC for r=0.05 all L1 = 0.036 +- 0.103 (in-sample avg dev_std = 0.174)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.336188
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.99
NEC for r=0.1 class 0.0 = 0.003 +- 0.210 (in-sample avg dev_std = 0.157)
NEC for r=0.1 class 1.0 = 0.043 +- 0.210 (in-sample avg dev_std = 0.157)
NEC for r=0.1 all KL = 0.084 +- 0.210 (in-sample avg dev_std = 0.157)
NEC for r=0.1 all L1 = 0.025 +- 0.073 (in-sample avg dev_std = 0.157)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.257332
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.991
NEC for r=0.2 class 0.0 = 0.006 +- 0.183 (in-sample avg dev_std = 0.166)
NEC for r=0.2 class 1.0 = 0.029 +- 0.183 (in-sample avg dev_std = 0.166)
NEC for r=0.2 all KL = 0.058 +- 0.183 (in-sample avg dev_std = 0.166)
NEC for r=0.2 all L1 = 0.019 +- 0.066 (in-sample avg dev_std = 0.166)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:39:07 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:39:07 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:07 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:07 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:39:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:07 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:39:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 76 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.381
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.358
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.275


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381432
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.978
SUFF_SIMPLE for r=0.05 class 0.0 = 0.951 +- 0.264 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.968 +- 0.264 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.05 all KL = 0.887 +- 0.264 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.05 all L1 = 0.96 +- 0.099 (in-sample avg dev_std = 0.258)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.357552
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.979
SUFF_SIMPLE for r=0.1 class 0.0 = 0.957 +- 0.245 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.969 +- 0.245 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.1 all KL = 0.906 +- 0.245 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.1 all L1 = 0.964 +- 0.102 (in-sample avg dev_std = 0.236)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27508
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.977
SUFF_SIMPLE for r=0.2 class 0.0 = 0.951 +- 0.267 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.97 +- 0.267 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.2 all KL = 0.893 +- 0.267 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.2 all L1 = 0.961 +- 0.104 (in-sample avg dev_std = 0.246)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381432
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.983
NEC for r=0.05 class 0.0 = 0.003 +- 0.220 (in-sample avg dev_std = 0.162)
NEC for r=0.05 class 1.0 = 0.068 +- 0.220 (in-sample avg dev_std = 0.162)
NEC for r=0.05 all KL = 0.093 +- 0.220 (in-sample avg dev_std = 0.162)
NEC for r=0.05 all L1 = 0.039 +- 0.112 (in-sample avg dev_std = 0.162)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.357552
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.988
NEC for r=0.1 class 0.0 = 0.003 +- 0.183 (in-sample avg dev_std = 0.151)
NEC for r=0.1 class 1.0 = 0.046 +- 0.183 (in-sample avg dev_std = 0.151)
NEC for r=0.1 all KL = 0.066 +- 0.183 (in-sample avg dev_std = 0.151)
NEC for r=0.1 all L1 = 0.027 +- 0.088 (in-sample avg dev_std = 0.151)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27508
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.992
NEC for r=0.2 class 0.0 = 0.005 +- 0.150 (in-sample avg dev_std = 0.139)
NEC for r=0.2 class 1.0 = 0.031 +- 0.150 (in-sample avg dev_std = 0.139)
NEC for r=0.2 all KL = 0.049 +- 0.150 (in-sample avg dev_std = 0.139)
NEC for r=0.2 all L1 = 0.019 +- 0.069 (in-sample avg dev_std = 0.139)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:39:17 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:39:18 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:18 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:18 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:39:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:18 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:39:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.384
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.360
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.279


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.384268
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.975
SUFF_SIMPLE for r=0.05 class 0.0 = 0.939 +- 0.267 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.971 +- 0.267 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.05 all KL = 0.889 +- 0.267 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.05 all L1 = 0.957 +- 0.110 (in-sample avg dev_std = 0.257)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35975
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.973
SUFF_SIMPLE for r=0.1 class 0.0 = 0.94 +- 0.272 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.967 +- 0.272 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.1 all KL = 0.891 +- 0.272 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.1 all L1 = 0.955 +- 0.122 (in-sample avg dev_std = 0.268)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.279174
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.971
SUFF_SIMPLE for r=0.2 class 0.0 = 0.932 +- 0.280 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.972 +- 0.280 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.2 all KL = 0.883 +- 0.280 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.2 all L1 = 0.954 +- 0.119 (in-sample avg dev_std = 0.270)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.384268
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.995
NEC for r=0.05 class 0.0 = 0.007 +- 0.153 (in-sample avg dev_std = 0.111)
NEC for r=0.05 class 1.0 = 0.025 +- 0.153 (in-sample avg dev_std = 0.111)
NEC for r=0.05 all KL = 0.042 +- 0.153 (in-sample avg dev_std = 0.111)
NEC for r=0.05 all L1 = 0.017 +- 0.070 (in-sample avg dev_std = 0.111)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35975
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.998
NEC for r=0.1 class 0.0 = 0.006 +- 0.097 (in-sample avg dev_std = 0.068)
NEC for r=0.1 class 1.0 = 0.01 +- 0.097 (in-sample avg dev_std = 0.068)
NEC for r=0.1 all KL = 0.022 +- 0.097 (in-sample avg dev_std = 0.068)
NEC for r=0.1 all L1 = 0.008 +- 0.034 (in-sample avg dev_std = 0.068)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.279174
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.998
NEC for r=0.2 class 0.0 = 0.006 +- 0.085 (in-sample avg dev_std = 0.067)
NEC for r=0.2 class 1.0 = 0.007 +- 0.085 (in-sample avg dev_std = 0.067)
NEC for r=0.2 all KL = 0.018 +- 0.085 (in-sample avg dev_std = 0.067)
NEC for r=0.2 all L1 = 0.007 +- 0.029 (in-sample avg dev_std = 0.067)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:39:28 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:39:28 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:28 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:28 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:39:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:28 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:39:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.385
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.363
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.283


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.385418
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.982
SUFF_SIMPLE for r=0.05 class 0.0 = 0.961 +- 0.244 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.97 +- 0.244 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.05 all KL = 0.908 +- 0.244 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.05 all L1 = 0.966 +- 0.099 (in-sample avg dev_std = 0.222)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.362618
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.983
SUFF_SIMPLE for r=0.1 class 0.0 = 0.96 +- 0.235 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.975 +- 0.235 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.1 all KL = 0.911 +- 0.235 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.1 all L1 = 0.968 +- 0.093 (in-sample avg dev_std = 0.209)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.28274
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.983
SUFF_SIMPLE for r=0.2 class 0.0 = 0.954 +- 0.245 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.977 +- 0.245 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.2 all KL = 0.906 +- 0.245 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.2 all L1 = 0.967 +- 0.097 (in-sample avg dev_std = 0.208)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.385418
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.977
NEC for r=0.05 class 0.0 = 0.026 +- 0.283 (in-sample avg dev_std = 0.229)
NEC for r=0.05 class 1.0 = 0.088 +- 0.283 (in-sample avg dev_std = 0.229)
NEC for r=0.05 all KL = 0.162 +- 0.283 (in-sample avg dev_std = 0.229)
NEC for r=0.05 all L1 = 0.061 +- 0.128 (in-sample avg dev_std = 0.229)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.362618
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.992
NEC for r=0.1 class 0.0 = 0.016 +- 0.220 (in-sample avg dev_std = 0.164)
NEC for r=0.1 class 1.0 = 0.051 +- 0.220 (in-sample avg dev_std = 0.164)
NEC for r=0.1 all KL = 0.107 +- 0.220 (in-sample avg dev_std = 0.164)
NEC for r=0.1 all L1 = 0.035 +- 0.081 (in-sample avg dev_std = 0.164)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.28274
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.993
NEC for r=0.2 class 0.0 = 0.011 +- 0.187 (in-sample avg dev_std = 0.152)
NEC for r=0.2 class 1.0 = 0.034 +- 0.187 (in-sample avg dev_std = 0.152)
NEC for r=0.2 all KL = 0.077 +- 0.187 (in-sample avg dev_std = 0.152)
NEC for r=0.2 all L1 = 0.024 +- 0.062 (in-sample avg dev_std = 0.152)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:39:38 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:39:38 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:38 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:38 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:39:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:38 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:39:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.398
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.356
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.268


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.397598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.986
SUFF_SIMPLE for r=0.05 class 0.0 = 0.977 +- 0.201 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.975 +- 0.201 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.05 all KL = 0.939 +- 0.201 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.05 all L1 = 0.976 +- 0.087 (in-sample avg dev_std = 0.188)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35575
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.984
SUFF_SIMPLE for r=0.1 class 0.0 = 0.975 +- 0.209 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.972 +- 0.209 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.1 all KL = 0.935 +- 0.209 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.1 all L1 = 0.973 +- 0.094 (in-sample avg dev_std = 0.197)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26753
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.984
SUFF_SIMPLE for r=0.2 class 0.0 = 0.972 +- 0.221 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.971 +- 0.221 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.2 all KL = 0.926 +- 0.221 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.2 all L1 = 0.971 +- 0.092 (in-sample avg dev_std = 0.206)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.397598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.975
NEC for r=0.05 class 0.0 = 0.031 +- 0.255 (in-sample avg dev_std = 0.227)
NEC for r=0.05 class 1.0 = 0.06 +- 0.255 (in-sample avg dev_std = 0.227)
NEC for r=0.05 all KL = 0.116 +- 0.255 (in-sample avg dev_std = 0.227)
NEC for r=0.05 all L1 = 0.047 +- 0.126 (in-sample avg dev_std = 0.227)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35575
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.989
NEC for r=0.1 class 0.0 = 0.013 +- 0.191 (in-sample avg dev_std = 0.174)
NEC for r=0.1 class 1.0 = 0.036 +- 0.191 (in-sample avg dev_std = 0.174)
NEC for r=0.1 all KL = 0.073 +- 0.191 (in-sample avg dev_std = 0.174)
NEC for r=0.1 all L1 = 0.026 +- 0.077 (in-sample avg dev_std = 0.174)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26753
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.994
NEC for r=0.2 class 0.0 = 0.01 +- 0.153 (in-sample avg dev_std = 0.142)
NEC for r=0.2 class 1.0 = 0.019 +- 0.153 (in-sample avg dev_std = 0.142)
NEC for r=0.2 all KL = 0.048 +- 0.153 (in-sample avg dev_std = 0.142)
NEC for r=0.2 all L1 = 0.015 +- 0.050 (in-sample avg dev_std = 0.142)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:39:48 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:39:48 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:48 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:48 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:39:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:48 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:39:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.395
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.369
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.288


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39523800000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.98
SUFF_SIMPLE for r=0.05 class 0.0 = 0.962 +- 0.238 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.969 +- 0.238 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.05 all KL = 0.911 +- 0.238 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.05 all L1 = 0.966 +- 0.098 (in-sample avg dev_std = 0.220)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.368854
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.986
SUFF_SIMPLE for r=0.1 class 0.0 = 0.969 +- 0.204 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.978 +- 0.204 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.1 all KL = 0.933 +- 0.204 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.1 all L1 = 0.974 +- 0.087 (in-sample avg dev_std = 0.190)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.28763799999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.979
SUFF_SIMPLE for r=0.2 class 0.0 = 0.964 +- 0.219 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.973 +- 0.219 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.2 all KL = 0.93 +- 0.219 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.2 all L1 = 0.969 +- 0.107 (in-sample avg dev_std = 0.204)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39523800000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.918
NEC for r=0.05 class 0.0 = 0.017 +- 0.381 (in-sample avg dev_std = 0.342)
NEC for r=0.05 class 1.0 = 0.241 +- 0.381 (in-sample avg dev_std = 0.342)
NEC for r=0.05 all KL = 0.315 +- 0.381 (in-sample avg dev_std = 0.342)
NEC for r=0.05 all L1 = 0.141 +- 0.205 (in-sample avg dev_std = 0.342)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.368854
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.956
NEC for r=0.1 class 0.0 = 0.006 +- 0.324 (in-sample avg dev_std = 0.301)
NEC for r=0.1 class 1.0 = 0.154 +- 0.324 (in-sample avg dev_std = 0.301)
NEC for r=0.1 all KL = 0.234 +- 0.324 (in-sample avg dev_std = 0.301)
NEC for r=0.1 all L1 = 0.088 +- 0.143 (in-sample avg dev_std = 0.301)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.28763799999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.978
NEC for r=0.2 class 0.0 = 0.011 +- 0.259 (in-sample avg dev_std = 0.247)
NEC for r=0.2 class 1.0 = 0.087 +- 0.259 (in-sample avg dev_std = 0.247)
NEC for r=0.2 all KL = 0.155 +- 0.259 (in-sample avg dev_std = 0.247)
NEC for r=0.2 all L1 = 0.053 +- 0.102 (in-sample avg dev_std = 0.247)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:39:58 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:39:59 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:59 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:59 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:39:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:39:59 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:39:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.382
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.327
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.243


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381698
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.969
SUFF_SIMPLE for r=0.05 class 0.0 = 0.957 +- 0.282 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.948 +- 0.282 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.05 all KL = 0.885 +- 0.282 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.05 all L1 = 0.952 +- 0.126 (in-sample avg dev_std = 0.289)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.326568
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.968
SUFF_SIMPLE for r=0.1 class 0.0 = 0.95 +- 0.283 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.95 +- 0.283 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.1 all KL = 0.879 +- 0.283 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.1 all L1 = 0.95 +- 0.126 (in-sample avg dev_std = 0.290)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24307399999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.966
SUFF_SIMPLE for r=0.2 class 0.0 = 0.952 +- 0.283 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.947 +- 0.283 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.2 all KL = 0.884 +- 0.283 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.2 all L1 = 0.949 +- 0.135 (in-sample avg dev_std = 0.289)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381698
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.964
NEC for r=0.05 class 0.0 = 0.024 +- 0.276 (in-sample avg dev_std = 0.220)
NEC for r=0.05 class 1.0 = 0.072 +- 0.276 (in-sample avg dev_std = 0.220)
NEC for r=0.05 all KL = 0.119 +- 0.276 (in-sample avg dev_std = 0.220)
NEC for r=0.05 all L1 = 0.051 +- 0.141 (in-sample avg dev_std = 0.220)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.326568
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.979
NEC for r=0.1 class 0.0 = 0.018 +- 0.229 (in-sample avg dev_std = 0.195)
NEC for r=0.1 class 1.0 = 0.043 +- 0.229 (in-sample avg dev_std = 0.195)
NEC for r=0.1 all KL = 0.085 +- 0.229 (in-sample avg dev_std = 0.195)
NEC for r=0.1 all L1 = 0.032 +- 0.103 (in-sample avg dev_std = 0.195)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24307399999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.991
NEC for r=0.2 class 0.0 = 0.008 +- 0.175 (in-sample avg dev_std = 0.145)
NEC for r=0.2 class 1.0 = 0.024 +- 0.175 (in-sample avg dev_std = 0.145)
NEC for r=0.2 all KL = 0.052 +- 0.175 (in-sample avg dev_std = 0.145)
NEC for r=0.2 all L1 = 0.017 +- 0.060 (in-sample avg dev_std = 0.145)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:40:08 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:40:08 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:08 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:08 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:40:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:08 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:40:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.396
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.359
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.274


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39629000000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.977
SUFF_SIMPLE for r=0.05 class 0.0 = 0.969 +- 0.265 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.956 +- 0.265 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.05 all KL = 0.897 +- 0.265 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.05 all L1 = 0.962 +- 0.110 (in-sample avg dev_std = 0.252)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.359076
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.981
SUFF_SIMPLE for r=0.1 class 0.0 = 0.971 +- 0.244 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.966 +- 0.244 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.1 all KL = 0.912 +- 0.244 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.1 all L1 = 0.968 +- 0.097 (in-sample avg dev_std = 0.227)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.273518
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.979
SUFF_SIMPLE for r=0.2 class 0.0 = 0.97 +- 0.243 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.966 +- 0.243 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 all KL = 0.918 +- 0.243 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 all L1 = 0.968 +- 0.106 (in-sample avg dev_std = 0.226)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39629000000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.931
NEC for r=0.05 class 0.0 = 0.009 +- 0.374 (in-sample avg dev_std = 0.319)
NEC for r=0.05 class 1.0 = 0.191 +- 0.374 (in-sample avg dev_std = 0.319)
NEC for r=0.05 all KL = 0.266 +- 0.374 (in-sample avg dev_std = 0.319)
NEC for r=0.05 all L1 = 0.11 +- 0.195 (in-sample avg dev_std = 0.319)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.359076
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.964
NEC for r=0.1 class 0.0 = 0.007 +- 0.316 (in-sample avg dev_std = 0.286)
NEC for r=0.1 class 1.0 = 0.115 +- 0.316 (in-sample avg dev_std = 0.286)
NEC for r=0.1 all KL = 0.185 +- 0.316 (in-sample avg dev_std = 0.286)
NEC for r=0.1 all L1 = 0.067 +- 0.138 (in-sample avg dev_std = 0.286)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.273518
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.983
NEC for r=0.2 class 0.0 = 0.007 +- 0.241 (in-sample avg dev_std = 0.217)
NEC for r=0.2 class 1.0 = 0.058 +- 0.241 (in-sample avg dev_std = 0.217)
NEC for r=0.2 all KL = 0.112 +- 0.241 (in-sample avg dev_std = 0.217)
NEC for r=0.2 all L1 = 0.035 +- 0.088 (in-sample avg dev_std = 0.217)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:40:18 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:40:18 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:18 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:18 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:40:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:18 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:40:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.388
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.360
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.274


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.38822
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.979
SUFF_SIMPLE for r=0.05 class 0.0 = 0.964 +- 0.258 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.963 +- 0.258 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.05 all KL = 0.899 +- 0.258 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.05 all L1 = 0.963 +- 0.100 (in-sample avg dev_std = 0.252)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.360244
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.982
SUFF_SIMPLE for r=0.1 class 0.0 = 0.965 +- 0.235 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.971 +- 0.235 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.1 all KL = 0.919 +- 0.235 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.1 all L1 = 0.968 +- 0.098 (in-sample avg dev_std = 0.231)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27441200000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.979
SUFF_SIMPLE for r=0.2 class 0.0 = 0.963 +- 0.257 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.963 +- 0.257 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.2 all KL = 0.904 +- 0.257 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.2 all L1 = 0.963 +- 0.107 (in-sample avg dev_std = 0.247)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.38822
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.978
NEC for r=0.05 class 0.0 = 0.004 +- 0.223 (in-sample avg dev_std = 0.158)
NEC for r=0.05 class 1.0 = 0.059 +- 0.223 (in-sample avg dev_std = 0.158)
NEC for r=0.05 all KL = 0.081 +- 0.223 (in-sample avg dev_std = 0.158)
NEC for r=0.05 all L1 = 0.035 +- 0.122 (in-sample avg dev_std = 0.158)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.360244
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.988
NEC for r=0.1 class 0.0 = 0.005 +- 0.186 (in-sample avg dev_std = 0.155)
NEC for r=0.1 class 1.0 = 0.037 +- 0.186 (in-sample avg dev_std = 0.155)
NEC for r=0.1 all KL = 0.057 +- 0.186 (in-sample avg dev_std = 0.155)
NEC for r=0.1 all L1 = 0.023 +- 0.089 (in-sample avg dev_std = 0.155)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27441200000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.994
NEC for r=0.2 class 0.0 = 0.003 +- 0.141 (in-sample avg dev_std = 0.123)
NEC for r=0.2 class 1.0 = 0.021 +- 0.141 (in-sample avg dev_std = 0.123)
NEC for r=0.2 all KL = 0.036 +- 0.141 (in-sample avg dev_std = 0.123)
NEC for r=0.2 all L1 = 0.013 +- 0.059 (in-sample avg dev_std = 0.123)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:40:28 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:40:28 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:28 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:28 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:40:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:28 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:40:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.386
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.364
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.285


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.386046
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.975
SUFF_SIMPLE for r=0.05 class 0.0 = 0.929 +- 0.283 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.979 +- 0.283 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.05 all KL = 0.878 +- 0.283 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.05 all L1 = 0.956 +- 0.111 (in-sample avg dev_std = 0.259)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.36420800000000003
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.978
SUFF_SIMPLE for r=0.1 class 0.0 = 0.945 +- 0.251 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.975 +- 0.251 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.1 all KL = 0.908 +- 0.251 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.1 all L1 = 0.962 +- 0.113 (in-sample avg dev_std = 0.245)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.285144
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.979
SUFF_SIMPLE for r=0.2 class 0.0 = 0.941 +- 0.258 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.981 +- 0.258 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.2 all KL = 0.904 +- 0.258 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.2 all L1 = 0.963 +- 0.107 (in-sample avg dev_std = 0.241)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.386046
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.947
NEC for r=0.05 class 0.0 = 0.034 +- 0.337 (in-sample avg dev_std = 0.269)
NEC for r=0.05 class 1.0 = 0.118 +- 0.337 (in-sample avg dev_std = 0.269)
NEC for r=0.05 all KL = 0.187 +- 0.337 (in-sample avg dev_std = 0.269)
NEC for r=0.05 all L1 = 0.081 +- 0.184 (in-sample avg dev_std = 0.269)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.36420800000000003
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.968
NEC for r=0.1 class 0.0 = 0.024 +- 0.303 (in-sample avg dev_std = 0.263)
NEC for r=0.1 class 1.0 = 0.079 +- 0.303 (in-sample avg dev_std = 0.263)
NEC for r=0.1 all KL = 0.149 +- 0.303 (in-sample avg dev_std = 0.263)
NEC for r=0.1 all L1 = 0.054 +- 0.136 (in-sample avg dev_std = 0.263)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.285144
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.982
NEC for r=0.2 class 0.0 = 0.031 +- 0.274 (in-sample avg dev_std = 0.234)
NEC for r=0.2 class 1.0 = 0.044 +- 0.274 (in-sample avg dev_std = 0.234)
NEC for r=0.2 all KL = 0.119 +- 0.274 (in-sample avg dev_std = 0.234)
NEC for r=0.2 all L1 = 0.038 +- 0.102 (in-sample avg dev_std = 0.234)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.899, 0.902, 0.9], 'all_L1': [0.959, 0.962, 0.959]}), defaultdict(<class 'list'>, {'all_KL': [0.887, 0.906, 0.893], 'all_L1': [0.96, 0.964, 0.961]}), defaultdict(<class 'list'>, {'all_KL': [0.889, 0.891, 0.883], 'all_L1': [0.957, 0.955, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.908, 0.911, 0.906], 'all_L1': [0.966, 0.968, 0.967]}), defaultdict(<class 'list'>, {'all_KL': [0.939, 0.935, 0.926], 'all_L1': [0.976, 0.973, 0.971]}), defaultdict(<class 'list'>, {'all_KL': [0.911, 0.933, 0.93], 'all_L1': [0.966, 0.974, 0.969]}), defaultdict(<class 'list'>, {'all_KL': [0.885, 0.879, 0.884], 'all_L1': [0.952, 0.95, 0.949]}), defaultdict(<class 'list'>, {'all_KL': [0.897, 0.912, 0.918], 'all_L1': [0.962, 0.968, 0.968]}), defaultdict(<class 'list'>, {'all_KL': [0.899, 0.919, 0.904], 'all_L1': [0.963, 0.968, 0.963]}), defaultdict(<class 'list'>, {'all_KL': [0.878, 0.908, 0.904], 'all_L1': [0.956, 0.962, 0.963]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.105, 0.084, 0.058], 'all_L1': [0.036, 0.025, 0.019]}), defaultdict(<class 'list'>, {'all_KL': [0.093, 0.066, 0.049], 'all_L1': [0.039, 0.027, 0.019]}), defaultdict(<class 'list'>, {'all_KL': [0.042, 0.022, 0.018], 'all_L1': [0.017, 0.008, 0.007]}), defaultdict(<class 'list'>, {'all_KL': [0.162, 0.107, 0.077], 'all_L1': [0.061, 0.035, 0.024]}), defaultdict(<class 'list'>, {'all_KL': [0.116, 0.073, 0.048], 'all_L1': [0.047, 0.026, 0.015]}), defaultdict(<class 'list'>, {'all_KL': [0.315, 0.234, 0.155], 'all_L1': [0.141, 0.088, 0.053]}), defaultdict(<class 'list'>, {'all_KL': [0.119, 0.085, 0.052], 'all_L1': [0.051, 0.032, 0.017]}), defaultdict(<class 'list'>, {'all_KL': [0.266, 0.185, 0.112], 'all_L1': [0.11, 0.067, 0.035]}), defaultdict(<class 'list'>, {'all_KL': [0.081, 0.057, 0.036], 'all_L1': [0.035, 0.023, 0.013]}), defaultdict(<class 'list'>, {'all_KL': [0.187, 0.149, 0.119], 'all_L1': [0.081, 0.054, 0.038]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.962 +- 0.006, 0.964 +- 0.007, 0.962 +- 0.007
suff_simple class all_KL  =  0.899 +- 0.016, 0.910 +- 0.016, 0.905 +- 0.015
[[0.9745000004768372, 0.9757500290870667, 0.9735000133514404], [0.9779999852180481, 0.9792500138282776, 0.9772499799728394], [0.9750000238418579, 0.9732499718666077, 0.9714999794960022], [0.9815000295639038, 0.9832500219345093, 0.9825000166893005], [0.9862499833106995, 0.984250009059906, 0.984250009059906], [0.9800000190734863, 0.9860000014305115, 0.9792500138282776], [0.968999981880188, 0.9677500128746033, 0.9662500023841858], [0.9769999980926514, 0.981249988079071, 0.9794999957084656], [0.9794999957084656, 0.9815000295639038, 0.9787499904632568], [0.9752500057220459, 0.9777500033378601, 0.9785000085830688]]
[[0.899, 0.902, 0.9], [0.887, 0.906, 0.893], [0.889, 0.891, 0.883], [0.908, 0.911, 0.906], [0.939, 0.935, 0.926], [0.911, 0.933, 0.93], [0.885, 0.879, 0.884], [0.897, 0.912, 0.918], [0.899, 0.919, 0.904], [0.878, 0.908, 0.904]]
suff_simple_acc_int  =  0.978 +- 0.004, 0.979 +- 0.005, 0.977 +- 0.005
nec class all_L1  =  0.062 +- 0.036, 0.038 +- 0.023, 0.024 +- 0.013
nec class all_KL  =  0.149 +- 0.081, 0.106 +- 0.061, 0.072 +- 0.041
[[0.9832500219345093, 0.9900000095367432, 0.9909999966621399], [0.9827499985694885, 0.9884999990463257, 0.9915000200271606], [0.9947500228881836, 0.9984999895095825, 0.9984999895095825], [0.9772499799728394, 0.9915000200271606, 0.9934999942779541], [0.9754999876022339, 0.9887499809265137, 0.9942499995231628], [0.9182500243186951, 0.956250011920929, 0.9775000214576721], [0.9639999866485596, 0.9787499904632568, 0.9912499785423279], [0.9307500123977661, 0.9639999866485596, 0.9829999804496765], [0.9779999852180481, 0.987500011920929, 0.9942499995231628], [0.9465000033378601, 0.9682499766349792, 0.9815000295639038]]
[[0.105, 0.084, 0.058], [0.093, 0.066, 0.049], [0.042, 0.022, 0.018], [0.162, 0.107, 0.077], [0.116, 0.073, 0.048], [0.315, 0.234, 0.155], [0.119, 0.085, 0.052], [0.266, 0.185, 0.112], [0.081, 0.057, 0.036], [0.187, 0.149, 0.119]]
nec_acc_int  =  0.965 +- 0.024, 0.981 +- 0.013, 0.990 +- 0.006


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.512 +- 0.019, 0.501 +- 0.013, 0.493 +- 0.009
Faith. Armon (L1)= 		  =  0.114 +- 0.062, 0.073 +- 0.041, 0.047 +- 0.025
Faith. GMean (L1)= 	  =  0.234 +- 0.069, 0.185 +- 0.056, 0.147 +- 0.041
Faith. Aritm (KL)= 		  =  0.524 +- 0.043, 0.508 +- 0.035, 0.489 +- 0.026
Faith. Armon (KL)= 		  =  0.246 +- 0.114, 0.185 +- 0.095, 0.131 +- 0.068
Faith. GMean (KL)= 	  =  0.352 +- 0.098, 0.298 +- 0.090, 0.246 +- 0.073
Computed for split load_split = id



Completed in  0:01:41.022097  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



REPRODUCIBILITY TEST

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:40:40 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:40:41 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:41 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:41 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:40:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:40:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.380
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.336
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.257


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.380346
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.771
SUFF_SIMPLE for r=0.05 class 0.0 = 0.838 +- 0.459 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.657 +- 0.459 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.05 all KL = 0.54 +- 0.459 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.05 all L1 = 0.738 +- 0.313 (in-sample avg dev_std = 0.514)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.336188
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.765
SUFF_SIMPLE for r=0.1 class 0.0 = 0.837 +- 0.455 (in-sample avg dev_std = 0.497)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.652 +- 0.455 (in-sample avg dev_std = 0.497)
SUFF_SIMPLE for r=0.1 all KL = 0.543 +- 0.455 (in-sample avg dev_std = 0.497)
SUFF_SIMPLE for r=0.1 all L1 = 0.735 +- 0.319 (in-sample avg dev_std = 0.497)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.257332
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.761
SUFF_SIMPLE for r=0.2 class 0.0 = 0.812 +- 0.454 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.649 +- 0.454 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.2 all KL = 0.519 +- 0.454 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.2 all L1 = 0.721 +- 0.316 (in-sample avg dev_std = 0.503)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.380346
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.547
NEC for r=0.05 class 0.0 = 0.026 +- 0.488 (in-sample avg dev_std = 0.089)
NEC for r=0.05 class 1.0 = 0.711 +- 0.488 (in-sample avg dev_std = 0.089)
NEC for r=0.05 all KL = 0.496 +- 0.488 (in-sample avg dev_std = 0.089)
NEC for r=0.05 all L1 = 0.406 +- 0.418 (in-sample avg dev_std = 0.089)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.336188
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.613
NEC for r=0.1 class 0.0 = 0.03 +- 0.487 (in-sample avg dev_std = 0.439)
NEC for r=0.1 class 1.0 = 0.677 +- 0.487 (in-sample avg dev_std = 0.439)
NEC for r=0.1 all KL = 0.546 +- 0.487 (in-sample avg dev_std = 0.439)
NEC for r=0.1 all L1 = 0.389 +- 0.376 (in-sample avg dev_std = 0.439)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.257332
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.765
NEC for r=0.2 class 0.0 = 0.055 +- 0.462 (in-sample avg dev_std = 0.488)
NEC for r=0.2 class 1.0 = 0.444 +- 0.462 (in-sample avg dev_std = 0.488)
NEC for r=0.2 all KL = 0.503 +- 0.462 (in-sample avg dev_std = 0.488)
NEC for r=0.2 all L1 = 0.27 +- 0.311 (in-sample avg dev_std = 0.488)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:40:51 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:40:51 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:51 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:51 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:40:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:40:51 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:40:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 76 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.381
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.358
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.275


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381432
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.795
SUFF_SIMPLE for r=0.05 class 0.0 = 0.795 +- 0.447 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.714 +- 0.447 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.05 all KL = 0.552 +- 0.447 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.05 all L1 = 0.751 +- 0.299 (in-sample avg dev_std = 0.521)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.357552
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.791
SUFF_SIMPLE for r=0.1 class 0.0 = 0.798 +- 0.442 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.711 +- 0.442 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.1 all KL = 0.559 +- 0.442 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.1 all L1 = 0.749 +- 0.306 (in-sample avg dev_std = 0.494)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27508
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.771
SUFF_SIMPLE for r=0.2 class 0.0 = 0.772 +- 0.450 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.702 +- 0.450 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.2 all KL = 0.544 +- 0.450 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.2 all L1 = 0.733 +- 0.319 (in-sample avg dev_std = 0.480)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381432
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.548
NEC for r=0.05 class 0.0 = 0.009 +- 0.489 (in-sample avg dev_std = 0.059)
NEC for r=0.05 class 1.0 = 0.728 +- 0.489 (in-sample avg dev_std = 0.059)
NEC for r=0.05 all KL = 0.499 +- 0.489 (in-sample avg dev_std = 0.059)
NEC for r=0.05 all L1 = 0.408 +- 0.417 (in-sample avg dev_std = 0.059)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.357552
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.582
NEC for r=0.1 class 0.0 = 0.02 +- 0.489 (in-sample avg dev_std = 0.423)
NEC for r=0.1 class 1.0 = 0.726 +- 0.489 (in-sample avg dev_std = 0.423)
NEC for r=0.1 all KL = 0.549 +- 0.489 (in-sample avg dev_std = 0.423)
NEC for r=0.1 all L1 = 0.411 +- 0.387 (in-sample avg dev_std = 0.423)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27508
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.734
NEC for r=0.2 class 0.0 = 0.036 +- 0.462 (in-sample avg dev_std = 0.500)
NEC for r=0.2 class 1.0 = 0.516 +- 0.462 (in-sample avg dev_std = 0.500)
NEC for r=0.2 all KL = 0.508 +- 0.462 (in-sample avg dev_std = 0.500)
NEC for r=0.2 all L1 = 0.302 +- 0.326 (in-sample avg dev_std = 0.500)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:41:00 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:41:00 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:00 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:00 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:41:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:00 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:41:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.384
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.360
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.279


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.384268
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.77
SUFF_SIMPLE for r=0.05 class 0.0 = 0.754 +- 0.460 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.721 +- 0.460 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.05 all KL = 0.544 +- 0.460 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.05 all L1 = 0.736 +- 0.315 (in-sample avg dev_std = 0.516)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35975
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.755
SUFF_SIMPLE for r=0.1 class 0.0 = 0.745 +- 0.463 (in-sample avg dev_std = 0.534)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.706 +- 0.463 (in-sample avg dev_std = 0.534)
SUFF_SIMPLE for r=0.1 all KL = 0.522 +- 0.463 (in-sample avg dev_std = 0.534)
SUFF_SIMPLE for r=0.1 all L1 = 0.723 +- 0.320 (in-sample avg dev_std = 0.534)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.279174
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.734
SUFF_SIMPLE for r=0.2 class 0.0 = 0.743 +- 0.462 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.681 +- 0.462 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.2 all KL = 0.506 +- 0.462 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.2 all L1 = 0.709 +- 0.330 (in-sample avg dev_std = 0.514)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.384268
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.613
NEC for r=0.05 class 0.0 = 0.027 +- 0.480 (in-sample avg dev_std = 0.086)
NEC for r=0.05 class 1.0 = 0.641 +- 0.480 (in-sample avg dev_std = 0.086)
NEC for r=0.05 all KL = 0.464 +- 0.480 (in-sample avg dev_std = 0.086)
NEC for r=0.05 all L1 = 0.367 +- 0.405 (in-sample avg dev_std = 0.086)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35975
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.632
NEC for r=0.1 class 0.0 = 0.041 +- 0.482 (in-sample avg dev_std = 0.474)
NEC for r=0.1 class 1.0 = 0.658 +- 0.482 (in-sample avg dev_std = 0.474)
NEC for r=0.1 all KL = 0.543 +- 0.482 (in-sample avg dev_std = 0.474)
NEC for r=0.1 all L1 = 0.383 +- 0.369 (in-sample avg dev_std = 0.474)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.279174
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.766
NEC for r=0.2 class 0.0 = 0.062 +- 0.465 (in-sample avg dev_std = 0.509)
NEC for r=0.2 class 1.0 = 0.438 +- 0.465 (in-sample avg dev_std = 0.509)
NEC for r=0.2 all KL = 0.503 +- 0.465 (in-sample avg dev_std = 0.509)
NEC for r=0.2 all L1 = 0.27 +- 0.309 (in-sample avg dev_std = 0.509)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:41:10 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:41:10 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:10 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:10 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:41:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:10 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:41:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.385
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.363
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.283


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.385418
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.791
SUFF_SIMPLE for r=0.05 class 0.0 = 0.83 +- 0.430 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.675 +- 0.430 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.05 all KL = 0.513 +- 0.430 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.05 all L1 = 0.744 +- 0.295 (in-sample avg dev_std = 0.505)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.362618
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.797
SUFF_SIMPLE for r=0.1 class 0.0 = 0.833 +- 0.429 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.687 +- 0.429 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.1 all KL = 0.529 +- 0.429 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.1 all L1 = 0.752 +- 0.294 (in-sample avg dev_std = 0.499)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.28274
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.789
SUFF_SIMPLE for r=0.2 class 0.0 = 0.825 +- 0.433 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.681 +- 0.433 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 all KL = 0.513 +- 0.433 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 all L1 = 0.745 +- 0.296 (in-sample avg dev_std = 0.493)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.385418
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.041 +- 0.486 (in-sample avg dev_std = 0.038)
NEC for r=0.05 class 1.0 = 0.779 +- 0.486 (in-sample avg dev_std = 0.038)
NEC for r=0.05 all KL = 0.553 +- 0.486 (in-sample avg dev_std = 0.038)
NEC for r=0.05 all L1 = 0.45 +- 0.414 (in-sample avg dev_std = 0.038)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.362618
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.52
NEC for r=0.1 class 0.0 = 0.06 +- 0.478 (in-sample avg dev_std = 0.415)
NEC for r=0.1 class 1.0 = 0.784 +- 0.478 (in-sample avg dev_std = 0.415)
NEC for r=0.1 all KL = 0.595 +- 0.478 (in-sample avg dev_std = 0.415)
NEC for r=0.1 all L1 = 0.461 +- 0.392 (in-sample avg dev_std = 0.415)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.28274
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.664
NEC for r=0.2 class 0.0 = 0.074 +- 0.461 (in-sample avg dev_std = 0.579)
NEC for r=0.2 class 1.0 = 0.617 +- 0.461 (in-sample avg dev_std = 0.579)
NEC for r=0.2 all KL = 0.594 +- 0.461 (in-sample avg dev_std = 0.579)
NEC for r=0.2 all L1 = 0.375 +- 0.336 (in-sample avg dev_std = 0.579)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:41:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:41:19 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:19 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:19 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:41:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:19 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:41:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.398
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.356
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.268


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.397598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.795
SUFF_SIMPLE for r=0.05 class 0.0 = 0.781 +- 0.452 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.722 +- 0.452 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.05 all KL = 0.559 +- 0.452 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.05 all L1 = 0.749 +- 0.303 (in-sample avg dev_std = 0.537)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35575
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.777
SUFF_SIMPLE for r=0.1 class 0.0 = 0.792 +- 0.453 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.703 +- 0.453 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.1 all KL = 0.572 +- 0.453 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.1 all L1 = 0.743 +- 0.318 (in-sample avg dev_std = 0.504)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26753
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.757
SUFF_SIMPLE for r=0.2 class 0.0 = 0.778 +- 0.459 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.683 +- 0.459 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.2 all KL = 0.549 +- 0.459 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.2 all L1 = 0.726 +- 0.327 (in-sample avg dev_std = 0.484)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.397598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.526
NEC for r=0.05 class 0.0 = 0.074 +- 0.488 (in-sample avg dev_std = 0.082)
NEC for r=0.05 class 1.0 = 0.711 +- 0.488 (in-sample avg dev_std = 0.082)
NEC for r=0.05 all KL = 0.518 +- 0.488 (in-sample avg dev_std = 0.082)
NEC for r=0.05 all L1 = 0.427 +- 0.418 (in-sample avg dev_std = 0.082)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35575
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.612
NEC for r=0.1 class 0.0 = 0.064 +- 0.475 (in-sample avg dev_std = 0.469)
NEC for r=0.1 class 1.0 = 0.656 +- 0.475 (in-sample avg dev_std = 0.469)
NEC for r=0.1 all KL = 0.561 +- 0.475 (in-sample avg dev_std = 0.469)
NEC for r=0.1 all L1 = 0.392 +- 0.370 (in-sample avg dev_std = 0.469)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26753
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.778
NEC for r=0.2 class 0.0 = 0.089 +- 0.448 (in-sample avg dev_std = 0.501)
NEC for r=0.2 class 1.0 = 0.409 +- 0.448 (in-sample avg dev_std = 0.501)
NEC for r=0.2 all KL = 0.495 +- 0.448 (in-sample avg dev_std = 0.501)
NEC for r=0.2 all L1 = 0.267 +- 0.298 (in-sample avg dev_std = 0.501)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:41:29 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:41:29 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:29 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:29 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:41:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:29 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:41:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.395
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.369
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.288


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39523800000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.81
SUFF_SIMPLE for r=0.05 class 0.0 = 0.839 +- 0.447 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.718 +- 0.447 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.05 all KL = 0.592 +- 0.447 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.05 all L1 = 0.772 +- 0.299 (in-sample avg dev_std = 0.474)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.368854
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.818
SUFF_SIMPLE for r=0.1 class 0.0 = 0.859 +- 0.437 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.722 +- 0.437 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.1 all KL = 0.608 +- 0.437 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.1 all L1 = 0.783 +- 0.294 (in-sample avg dev_std = 0.459)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.28763799999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.807
SUFF_SIMPLE for r=0.2 class 0.0 = 0.851 +- 0.441 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.718 +- 0.441 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.2 all KL = 0.607 +- 0.441 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.2 all L1 = 0.777 +- 0.304 (in-sample avg dev_std = 0.433)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39523800000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.514
NEC for r=0.05 class 0.0 = 0.01 +- 0.490 (in-sample avg dev_std = 0.016)
NEC for r=0.05 class 1.0 = 0.784 +- 0.490 (in-sample avg dev_std = 0.016)
NEC for r=0.05 all KL = 0.534 +- 0.490 (in-sample avg dev_std = 0.016)
NEC for r=0.05 all L1 = 0.439 +- 0.417 (in-sample avg dev_std = 0.016)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.368854
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.5
NEC for r=0.1 class 0.0 = 0.026 +- 0.488 (in-sample avg dev_std = 0.336)
NEC for r=0.1 class 1.0 = 0.812 +- 0.488 (in-sample avg dev_std = 0.336)
NEC for r=0.1 all KL = 0.567 +- 0.488 (in-sample avg dev_std = 0.336)
NEC for r=0.1 all L1 = 0.461 +- 0.409 (in-sample avg dev_std = 0.336)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.28763799999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.629
NEC for r=0.2 class 0.0 = 0.046 +- 0.471 (in-sample avg dev_std = 0.564)
NEC for r=0.2 class 1.0 = 0.679 +- 0.471 (in-sample avg dev_std = 0.564)
NEC for r=0.2 all KL = 0.581 +- 0.471 (in-sample avg dev_std = 0.564)
NEC for r=0.2 all L1 = 0.397 +- 0.355 (in-sample avg dev_std = 0.564)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:41:38 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:41:38 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:38 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:38 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:41:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:38 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:41:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.382
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.327
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.243


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381698
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.779
SUFF_SIMPLE for r=0.05 class 0.0 = 0.786 +- 0.450 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.689 +- 0.450 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.05 all KL = 0.523 +- 0.450 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.05 all L1 = 0.733 +- 0.302 (in-sample avg dev_std = 0.552)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.326568
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.771
SUFF_SIMPLE for r=0.1 class 0.0 = 0.774 +- 0.453 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.683 +- 0.453 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.1 all KL = 0.517 +- 0.453 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.1 all L1 = 0.724 +- 0.306 (in-sample avg dev_std = 0.547)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24307399999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.774
SUFF_SIMPLE for r=0.2 class 0.0 = 0.789 +- 0.446 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.693 +- 0.446 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.2 all KL = 0.541 +- 0.446 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.2 all L1 = 0.736 +- 0.312 (in-sample avg dev_std = 0.501)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381698
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.527
NEC for r=0.05 class 0.0 = 0.059 +- 0.490 (in-sample avg dev_std = 0.115)
NEC for r=0.05 class 1.0 = 0.713 +- 0.490 (in-sample avg dev_std = 0.115)
NEC for r=0.05 all KL = 0.509 +- 0.490 (in-sample avg dev_std = 0.115)
NEC for r=0.05 all L1 = 0.421 +- 0.420 (in-sample avg dev_std = 0.115)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.326568
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.635
NEC for r=0.1 class 0.0 = 0.049 +- 0.485 (in-sample avg dev_std = 0.449)
NEC for r=0.1 class 1.0 = 0.626 +- 0.485 (in-sample avg dev_std = 0.449)
NEC for r=0.1 all KL = 0.539 +- 0.485 (in-sample avg dev_std = 0.449)
NEC for r=0.1 all L1 = 0.368 +- 0.365 (in-sample avg dev_std = 0.449)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24307399999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.797
NEC for r=0.2 class 0.0 = 0.07 +- 0.450 (in-sample avg dev_std = 0.435)
NEC for r=0.2 class 1.0 = 0.378 +- 0.450 (in-sample avg dev_std = 0.435)
NEC for r=0.2 all KL = 0.451 +- 0.450 (in-sample avg dev_std = 0.435)
NEC for r=0.2 all L1 = 0.241 +- 0.301 (in-sample avg dev_std = 0.435)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:41:48 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:41:48 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:48 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:48 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:48 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:41:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.396
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.359
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.274


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39629000000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.794
SUFF_SIMPLE for r=0.05 class 0.0 = 0.879 +- 0.445 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.662 +- 0.445 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.05 all KL = 0.573 +- 0.445 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.05 all L1 = 0.759 +- 0.306 (in-sample avg dev_std = 0.477)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.359076
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.796
SUFF_SIMPLE for r=0.1 class 0.0 = 0.888 +- 0.443 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.661 +- 0.443 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.1 all KL = 0.57 +- 0.443 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.1 all L1 = 0.762 +- 0.303 (in-sample avg dev_std = 0.473)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.273518
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.78
SUFF_SIMPLE for r=0.2 class 0.0 = 0.872 +- 0.449 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.652 +- 0.449 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.2 all KL = 0.571 +- 0.449 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.2 all L1 = 0.75 +- 0.317 (in-sample avg dev_std = 0.466)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39629000000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.497
NEC for r=0.05 class 0.0 = 0.038 +- 0.491 (in-sample avg dev_std = 0.033)
NEC for r=0.05 class 1.0 = 0.779 +- 0.491 (in-sample avg dev_std = 0.033)
NEC for r=0.05 all KL = 0.548 +- 0.491 (in-sample avg dev_std = 0.033)
NEC for r=0.05 all L1 = 0.449 +- 0.418 (in-sample avg dev_std = 0.033)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.359076
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.528
NEC for r=0.1 class 0.0 = 0.037 +- 0.487 (in-sample avg dev_std = 0.418)
NEC for r=0.1 class 1.0 = 0.777 +- 0.487 (in-sample avg dev_std = 0.418)
NEC for r=0.1 all KL = 0.567 +- 0.487 (in-sample avg dev_std = 0.418)
NEC for r=0.1 all L1 = 0.447 +- 0.398 (in-sample avg dev_std = 0.418)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.273518
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.673
NEC for r=0.2 class 0.0 = 0.047 +- 0.476 (in-sample avg dev_std = 0.587)
NEC for r=0.2 class 1.0 = 0.622 +- 0.476 (in-sample avg dev_std = 0.587)
NEC for r=0.2 all KL = 0.577 +- 0.476 (in-sample avg dev_std = 0.587)
NEC for r=0.2 all L1 = 0.366 +- 0.338 (in-sample avg dev_std = 0.587)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:41:58 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:41:58 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:58 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:58 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:41:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:41:58 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:41:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.388
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.360
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.274


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.38822
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.799
SUFF_SIMPLE for r=0.05 class 0.0 = 0.818 +- 0.450 (in-sample avg dev_std = 0.497)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.712 +- 0.450 (in-sample avg dev_std = 0.497)
SUFF_SIMPLE for r=0.05 all KL = 0.569 +- 0.450 (in-sample avg dev_std = 0.497)
SUFF_SIMPLE for r=0.05 all L1 = 0.759 +- 0.301 (in-sample avg dev_std = 0.497)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.360244
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.787
SUFF_SIMPLE for r=0.1 class 0.0 = 0.808 +- 0.451 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.703 +- 0.451 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 all KL = 0.557 +- 0.451 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 all L1 = 0.75 +- 0.307 (in-sample avg dev_std = 0.506)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27441200000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.774
SUFF_SIMPLE for r=0.2 class 0.0 = 0.801 +- 0.456 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.685 +- 0.456 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.2 all KL = 0.542 +- 0.456 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.2 all L1 = 0.737 +- 0.313 (in-sample avg dev_std = 0.503)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.38822
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.555
NEC for r=0.05 class 0.0 = 0.01 +- 0.487 (in-sample avg dev_std = 0.081)
NEC for r=0.05 class 1.0 = 0.719 +- 0.487 (in-sample avg dev_std = 0.081)
NEC for r=0.05 all KL = 0.498 +- 0.487 (in-sample avg dev_std = 0.081)
NEC for r=0.05 all L1 = 0.403 +- 0.414 (in-sample avg dev_std = 0.081)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.360244
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.601
NEC for r=0.1 class 0.0 = 0.022 +- 0.489 (in-sample avg dev_std = 0.445)
NEC for r=0.1 class 1.0 = 0.694 +- 0.489 (in-sample avg dev_std = 0.445)
NEC for r=0.1 all KL = 0.544 +- 0.489 (in-sample avg dev_std = 0.445)
NEC for r=0.1 all L1 = 0.394 +- 0.381 (in-sample avg dev_std = 0.445)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27441200000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.741
NEC for r=0.2 class 0.0 = 0.054 +- 0.471 (in-sample avg dev_std = 0.518)
NEC for r=0.2 class 1.0 = 0.488 +- 0.471 (in-sample avg dev_std = 0.518)
NEC for r=0.2 all KL = 0.514 +- 0.471 (in-sample avg dev_std = 0.518)
NEC for r=0.2 all L1 = 0.295 +- 0.321 (in-sample avg dev_std = 0.518)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:42:08 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:42:08 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:08 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:08 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:08 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:42:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.386
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.364
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.285


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.386046
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.787
SUFF_SIMPLE for r=0.05 class 0.0 = 0.782 +- 0.452 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.716 +- 0.452 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.05 all KL = 0.552 +- 0.452 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.05 all L1 = 0.746 +- 0.306 (in-sample avg dev_std = 0.536)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.36420800000000003
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.789
SUFF_SIMPLE for r=0.1 class 0.0 = 0.789 +- 0.451 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.719 +- 0.451 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.1 all KL = 0.554 +- 0.451 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.1 all L1 = 0.75 +- 0.304 (in-sample avg dev_std = 0.525)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.285144
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.772
SUFF_SIMPLE for r=0.2 class 0.0 = 0.796 +- 0.452 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.696 +- 0.452 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.2 all KL = 0.553 +- 0.452 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.2 all L1 = 0.74 +- 0.315 (in-sample avg dev_std = 0.505)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.386046
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.447
NEC for r=0.05 class 0.0 = 0.091 +- 0.486 (in-sample avg dev_std = 0.053)
NEC for r=0.05 class 1.0 = 0.815 +- 0.486 (in-sample avg dev_std = 0.053)
NEC for r=0.05 all KL = 0.587 +- 0.486 (in-sample avg dev_std = 0.053)
NEC for r=0.05 all L1 = 0.492 +- 0.414 (in-sample avg dev_std = 0.053)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.36420800000000003
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.476
NEC for r=0.1 class 0.0 = 0.127 +- 0.464 (in-sample avg dev_std = 0.410)
NEC for r=0.1 class 1.0 = 0.796 +- 0.464 (in-sample avg dev_std = 0.410)
NEC for r=0.1 all KL = 0.635 +- 0.464 (in-sample avg dev_std = 0.410)
NEC for r=0.1 all L1 = 0.498 +- 0.386 (in-sample avg dev_std = 0.410)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.285144
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.616
NEC for r=0.2 class 0.0 = 0.182 +- 0.431 (in-sample avg dev_std = 0.618)
NEC for r=0.2 class 1.0 = 0.625 +- 0.431 (in-sample avg dev_std = 0.618)
NEC for r=0.2 all KL = 0.68 +- 0.431 (in-sample avg dev_std = 0.618)
NEC for r=0.2 all L1 = 0.428 +- 0.326 (in-sample avg dev_std = 0.618)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.54, 0.543, 0.519], 'all_L1': [0.738, 0.735, 0.721]}), defaultdict(<class 'list'>, {'all_KL': [0.552, 0.559, 0.544], 'all_L1': [0.751, 0.749, 0.733]}), defaultdict(<class 'list'>, {'all_KL': [0.544, 0.522, 0.506], 'all_L1': [0.736, 0.723, 0.709]}), defaultdict(<class 'list'>, {'all_KL': [0.513, 0.529, 0.513], 'all_L1': [0.744, 0.752, 0.745]}), defaultdict(<class 'list'>, {'all_KL': [0.559, 0.572, 0.549], 'all_L1': [0.749, 0.743, 0.726]}), defaultdict(<class 'list'>, {'all_KL': [0.592, 0.608, 0.607], 'all_L1': [0.772, 0.783, 0.777]}), defaultdict(<class 'list'>, {'all_KL': [0.523, 0.517, 0.541], 'all_L1': [0.733, 0.724, 0.736]}), defaultdict(<class 'list'>, {'all_KL': [0.573, 0.57, 0.571], 'all_L1': [0.759, 0.762, 0.75]}), defaultdict(<class 'list'>, {'all_KL': [0.569, 0.557, 0.542], 'all_L1': [0.759, 0.75, 0.737]}), defaultdict(<class 'list'>, {'all_KL': [0.552, 0.554, 0.553], 'all_L1': [0.746, 0.75, 0.74]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.496, 0.546, 0.503], 'all_L1': [0.406, 0.389, 0.27]}), defaultdict(<class 'list'>, {'all_KL': [0.499, 0.549, 0.508], 'all_L1': [0.408, 0.411, 0.302]}), defaultdict(<class 'list'>, {'all_KL': [0.464, 0.543, 0.503], 'all_L1': [0.367, 0.383, 0.27]}), defaultdict(<class 'list'>, {'all_KL': [0.553, 0.595, 0.594], 'all_L1': [0.45, 0.461, 0.375]}), defaultdict(<class 'list'>, {'all_KL': [0.518, 0.561, 0.495], 'all_L1': [0.427, 0.392, 0.267]}), defaultdict(<class 'list'>, {'all_KL': [0.534, 0.567, 0.581], 'all_L1': [0.439, 0.461, 0.397]}), defaultdict(<class 'list'>, {'all_KL': [0.509, 0.539, 0.451], 'all_L1': [0.421, 0.368, 0.241]}), defaultdict(<class 'list'>, {'all_KL': [0.548, 0.567, 0.577], 'all_L1': [0.449, 0.447, 0.366]}), defaultdict(<class 'list'>, {'all_KL': [0.498, 0.544, 0.514], 'all_L1': [0.403, 0.394, 0.295]}), defaultdict(<class 'list'>, {'all_KL': [0.587, 0.635, 0.68], 'all_L1': [0.492, 0.498, 0.428]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.749 +- 0.011, 0.747 +- 0.017, 0.737 +- 0.017
suff_simple class all_KL  =  0.552 +- 0.022, 0.553 +- 0.026, 0.544 +- 0.028
[[0.7710000276565552, 0.765250027179718, 0.7607499957084656], [0.7947499752044678, 0.7914999723434448, 0.7707499861717224], [0.7697499990463257, 0.7552499771118164, 0.7335000038146973], [0.7912499904632568, 0.796999990940094, 0.7894999980926514], [0.7950000166893005, 0.7770000100135803, 0.7574999928474426], [0.8100000023841858, 0.8182500004768372, 0.8067499995231628], [0.7792500257492065, 0.7714999914169312, 0.7742499709129333], [0.7935000061988831, 0.7962499856948853, 0.7802500128746033], [0.7990000247955322, 0.7870000004768372, 0.7742499709129333], [0.7870000004768372, 0.7885000109672546, 0.7722499966621399]]
[[0.54, 0.543, 0.519], [0.552, 0.559, 0.544], [0.544, 0.522, 0.506], [0.513, 0.529, 0.513], [0.559, 0.572, 0.549], [0.592, 0.608, 0.607], [0.523, 0.517, 0.541], [0.573, 0.57, 0.571], [0.569, 0.557, 0.542], [0.552, 0.554, 0.553]]
suff_simple_acc_int  =  0.789 +- 0.012, 0.785 +- 0.017, 0.772 +- 0.018
nec class all_L1  =  0.426 +- 0.032, 0.420 +- 0.041, 0.321 +- 0.061
nec class all_KL  =  0.521 +- 0.034, 0.565 +- 0.028, 0.541 +- 0.063
[[0.546750009059906, 0.612500011920929, 0.7649999856948853], [0.5475000143051147, 0.5822499990463257, 0.734250009059906], [0.612500011920929, 0.6324999928474426, 0.765749990940094], [0.49924999475479126, 0.5199999809265137, 0.6639999747276306], [0.5260000228881836, 0.6117500066757202, 0.778249979019165], [0.5139999985694885, 0.500249981880188, 0.6287500262260437], [0.5270000100135803, 0.6347500085830688, 0.796750009059906], [0.4972499907016754, 0.528249979019165, 0.6727499961853027], [0.5550000071525574, 0.6014999747276306, 0.7409999966621399], [0.44749999046325684, 0.47600001096725464, 0.6162499785423279]]
[[0.496, 0.546, 0.503], [0.499, 0.549, 0.508], [0.464, 0.543, 0.503], [0.553, 0.595, 0.594], [0.518, 0.561, 0.495], [0.534, 0.567, 0.581], [0.509, 0.539, 0.451], [0.548, 0.567, 0.577], [0.498, 0.544, 0.514], [0.587, 0.635, 0.68]]
nec_acc_int  =  0.527 +- 0.041, 0.570 +- 0.055, 0.716 +- 0.062


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.587 +- 0.019, 0.584 +- 0.027, 0.529 +- 0.037
Faith. Armon (L1)= 		  =  0.543 +- 0.027, 0.537 +- 0.036, 0.445 +- 0.061
Faith. GMean (L1)= 	  =  0.565 +- 0.023, 0.560 +- 0.032, 0.485 +- 0.050
Faith. Aritm (KL)= 		  =  0.536 +- 0.021, 0.559 +- 0.020, 0.543 +- 0.038
Faith. Armon (KL)= 		  =  0.535 +- 0.021, 0.558 +- 0.020, 0.541 +- 0.038
Faith. GMean (KL)= 	  =  0.536 +- 0.021, 0.559 +- 0.020, 0.542 +- 0.038
Computed for split load_split = id



Completed in  0:01:37.146010  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



REPRODUCIBILITY TEST

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:42:21 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:42:21 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:21 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:21 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:42:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:42:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.380
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.336
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.257


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.380346
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.556
SUFF_SIMPLE for r=0.05 class 0.0 = 0.762 +- 0.438 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.369 +- 0.438 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.05 all KL = 0.326 +- 0.438 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.05 all L1 = 0.544 +- 0.352 (in-sample avg dev_std = 0.557)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.336188
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.598
SUFF_SIMPLE for r=0.1 class 0.0 = 0.72 +- 0.431 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.407 +- 0.431 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.1 all KL = 0.31 +- 0.431 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.1 all L1 = 0.547 +- 0.338 (in-sample avg dev_std = 0.529)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.257332
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.549
SUFF_SIMPLE for r=0.2 class 0.0 = 0.687 +- 0.433 (in-sample avg dev_std = 0.540)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.408 +- 0.433 (in-sample avg dev_std = 0.540)
SUFF_SIMPLE for r=0.2 all KL = 0.308 +- 0.433 (in-sample avg dev_std = 0.540)
SUFF_SIMPLE for r=0.2 all L1 = 0.532 +- 0.344 (in-sample avg dev_std = 0.540)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.380346
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.544
NEC for r=0.05 class 0.0 = 0.025 +- 0.489 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.713 +- 0.489 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.495 +- 0.489 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.406 +- 0.420 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.336188
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.47
NEC for r=0.1 class 0.0 = 0.043 +- 0.491 (in-sample avg dev_std = 0.041)
NEC for r=0.1 class 1.0 = 0.809 +- 0.491 (in-sample avg dev_std = 0.041)
NEC for r=0.1 all KL = 0.554 +- 0.491 (in-sample avg dev_std = 0.041)
NEC for r=0.1 all L1 = 0.467 +- 0.421 (in-sample avg dev_std = 0.041)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.257332
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.564
NEC for r=0.2 class 0.0 = 0.106 +- 0.471 (in-sample avg dev_std = 0.445)
NEC for r=0.2 class 1.0 = 0.707 +- 0.471 (in-sample avg dev_std = 0.445)
NEC for r=0.2 all KL = 0.61 +- 0.471 (in-sample avg dev_std = 0.445)
NEC for r=0.2 all L1 = 0.439 +- 0.372 (in-sample avg dev_std = 0.445)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:42:31 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:42:31 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:31 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:31 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:42:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:31 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:42:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 76 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.381
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.358
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.275


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381432
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.58
SUFF_SIMPLE for r=0.05 class 0.0 = 0.705 +- 0.425 (in-sample avg dev_std = 0.560)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.431 +- 0.425 (in-sample avg dev_std = 0.560)
SUFF_SIMPLE for r=0.05 all KL = 0.327 +- 0.425 (in-sample avg dev_std = 0.560)
SUFF_SIMPLE for r=0.05 all L1 = 0.553 +- 0.343 (in-sample avg dev_std = 0.560)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.357552
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.585
SUFF_SIMPLE for r=0.1 class 0.0 = 0.713 +- 0.423 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.437 +- 0.423 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.1 all KL = 0.339 +- 0.423 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.1 all L1 = 0.56 +- 0.348 (in-sample avg dev_std = 0.526)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27508
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.565
SUFF_SIMPLE for r=0.2 class 0.0 = 0.675 +- 0.426 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.435 +- 0.426 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.2 all KL = 0.322 +- 0.426 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.2 all L1 = 0.542 +- 0.349 (in-sample avg dev_std = 0.518)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381432
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.546
NEC for r=0.05 class 0.0 = 0.009 +- 0.489 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.729 +- 0.489 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.499 +- 0.489 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.408 +- 0.417 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.357552
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.479
NEC for r=0.1 class 0.0 = 0.023 +- 0.492 (in-sample avg dev_std = 0.055)
NEC for r=0.1 class 1.0 = 0.813 +- 0.492 (in-sample avg dev_std = 0.055)
NEC for r=0.1 all KL = 0.548 +- 0.492 (in-sample avg dev_std = 0.055)
NEC for r=0.1 all L1 = 0.46 +- 0.421 (in-sample avg dev_std = 0.055)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27508
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.55
NEC for r=0.2 class 0.0 = 0.085 +- 0.468 (in-sample avg dev_std = 0.444)
NEC for r=0.2 class 1.0 = 0.736 +- 0.468 (in-sample avg dev_std = 0.444)
NEC for r=0.2 all KL = 0.607 +- 0.468 (in-sample avg dev_std = 0.444)
NEC for r=0.2 all L1 = 0.446 +- 0.376 (in-sample avg dev_std = 0.444)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:42:41 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:42:41 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:41 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:41 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:42:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:42:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.384
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.360
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.279


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.384268
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.559
SUFF_SIMPLE for r=0.05 class 0.0 = 0.697 +- 0.454 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.441 +- 0.454 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.05 all KL = 0.357 +- 0.454 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.05 all L1 = 0.555 +- 0.365 (in-sample avg dev_std = 0.528)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35975
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.546
SUFF_SIMPLE for r=0.1 class 0.0 = 0.7 +- 0.444 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.42 +- 0.444 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.1 all KL = 0.336 +- 0.444 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.1 all L1 = 0.545 +- 0.364 (in-sample avg dev_std = 0.529)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.279174
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.503
SUFF_SIMPLE for r=0.2 class 0.0 = 0.645 +- 0.438 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.399 +- 0.438 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.2 all KL = 0.301 +- 0.438 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.2 all L1 = 0.509 +- 0.362 (in-sample avg dev_std = 0.512)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.384268
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.608
NEC for r=0.05 class 0.0 = 0.027 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.643 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.464 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.368 +- 0.407 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35975
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.509
NEC for r=0.1 class 0.0 = 0.052 +- 0.483 (in-sample avg dev_std = 0.053)
NEC for r=0.1 class 1.0 = 0.768 +- 0.483 (in-sample avg dev_std = 0.053)
NEC for r=0.1 all KL = 0.547 +- 0.483 (in-sample avg dev_std = 0.053)
NEC for r=0.1 all L1 = 0.448 +- 0.413 (in-sample avg dev_std = 0.053)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.279174
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.576
NEC for r=0.2 class 0.0 = 0.155 +- 0.466 (in-sample avg dev_std = 0.496)
NEC for r=0.2 class 1.0 = 0.656 +- 0.466 (in-sample avg dev_std = 0.496)
NEC for r=0.2 all KL = 0.625 +- 0.466 (in-sample avg dev_std = 0.496)
NEC for r=0.2 all L1 = 0.432 +- 0.362 (in-sample avg dev_std = 0.496)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:42:50 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:42:50 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:50 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:50 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:42:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:42:50 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:42:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.385
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.363
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.283


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.385418
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.582
SUFF_SIMPLE for r=0.05 class 0.0 = 0.865 +- 0.432 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.311 +- 0.432 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.05 all KL = 0.331 +- 0.432 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.05 all L1 = 0.558 +- 0.346 (in-sample avg dev_std = 0.547)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.362618
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.581
SUFF_SIMPLE for r=0.1 class 0.0 = 0.857 +- 0.438 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.312 +- 0.438 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.1 all KL = 0.332 +- 0.438 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.1 all L1 = 0.555 +- 0.346 (in-sample avg dev_std = 0.567)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.28274
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.568
SUFF_SIMPLE for r=0.2 class 0.0 = 0.834 +- 0.432 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.302 +- 0.432 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.2 all KL = 0.314 +- 0.432 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.2 all L1 = 0.539 +- 0.343 (in-sample avg dev_std = 0.578)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.385418
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.5
NEC for r=0.05 class 0.0 = 0.039 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.779 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.55 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.449 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.362618
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.464
NEC for r=0.1 class 0.0 = 0.06 +- 0.483 (in-sample avg dev_std = 0.007)
NEC for r=0.1 class 1.0 = 0.82 +- 0.483 (in-sample avg dev_std = 0.007)
NEC for r=0.1 all KL = 0.58 +- 0.483 (in-sample avg dev_std = 0.007)
NEC for r=0.1 all L1 = 0.481 +- 0.415 (in-sample avg dev_std = 0.007)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.28274
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.49
NEC for r=0.2 class 0.0 = 0.107 +- 0.458 (in-sample avg dev_std = 0.430)
NEC for r=0.2 class 1.0 = 0.799 +- 0.458 (in-sample avg dev_std = 0.430)
NEC for r=0.2 all KL = 0.64 +- 0.458 (in-sample avg dev_std = 0.430)
NEC for r=0.2 all L1 = 0.49 +- 0.382 (in-sample avg dev_std = 0.430)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:43:00 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:43:00 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:00 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:00 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:43:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:00 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:43:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.398
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.356
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.268


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.397598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.557
SUFF_SIMPLE for r=0.05 class 0.0 = 0.657 +- 0.427 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.454 +- 0.427 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.05 all KL = 0.32 +- 0.427 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.05 all L1 = 0.544 +- 0.350 (in-sample avg dev_std = 0.552)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35575
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.532
SUFF_SIMPLE for r=0.1 class 0.0 = 0.645 +- 0.428 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.437 +- 0.428 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.1 all KL = 0.312 +- 0.428 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.1 all L1 = 0.53 +- 0.355 (in-sample avg dev_std = 0.535)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26753
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.515
SUFF_SIMPLE for r=0.2 class 0.0 = 0.614 +- 0.434 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.435 +- 0.434 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.2 all KL = 0.307 +- 0.434 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.2 all L1 = 0.515 +- 0.359 (in-sample avg dev_std = 0.518)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.397598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.526
NEC for r=0.05 class 0.0 = 0.075 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.713 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.519 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.428 +- 0.418 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35575
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.463
NEC for r=0.1 class 0.0 = 0.083 +- 0.484 (in-sample avg dev_std = 0.061)
NEC for r=0.1 class 1.0 = 0.794 +- 0.484 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all KL = 0.571 +- 0.484 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all L1 = 0.477 +- 0.417 (in-sample avg dev_std = 0.061)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26753
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.601
NEC for r=0.2 class 0.0 = 0.143 +- 0.453 (in-sample avg dev_std = 0.483)
NEC for r=0.2 class 1.0 = 0.637 +- 0.453 (in-sample avg dev_std = 0.483)
NEC for r=0.2 all KL = 0.623 +- 0.453 (in-sample avg dev_std = 0.483)
NEC for r=0.2 all L1 = 0.416 +- 0.354 (in-sample avg dev_std = 0.483)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:43:09 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:43:09 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:09 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:09 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:43:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:43:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.395
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.369
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.288


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39523800000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.617
SUFF_SIMPLE for r=0.05 class 0.0 = 0.852 +- 0.438 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.384 +- 0.438 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.05 all KL = 0.361 +- 0.438 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.05 all L1 = 0.593 +- 0.344 (in-sample avg dev_std = 0.526)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.368854
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.62
SUFF_SIMPLE for r=0.1 class 0.0 = 0.856 +- 0.437 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.387 +- 0.437 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.1 all KL = 0.366 +- 0.437 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.1 all L1 = 0.596 +- 0.344 (in-sample avg dev_std = 0.522)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.28763799999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.613
SUFF_SIMPLE for r=0.2 class 0.0 = 0.832 +- 0.429 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.387 +- 0.429 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.2 all KL = 0.349 +- 0.429 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.2 all L1 = 0.585 +- 0.342 (in-sample avg dev_std = 0.510)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39523800000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.514
NEC for r=0.05 class 0.0 = 0.01 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.784 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.534 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.439 +- 0.417 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.368854
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.461
NEC for r=0.1 class 0.0 = 0.023 +- 0.492 (in-sample avg dev_std = 0.021)
NEC for r=0.1 class 1.0 = 0.834 +- 0.492 (in-sample avg dev_std = 0.021)
NEC for r=0.1 all KL = 0.557 +- 0.492 (in-sample avg dev_std = 0.021)
NEC for r=0.1 all L1 = 0.472 +- 0.423 (in-sample avg dev_std = 0.021)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.28763799999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.479
NEC for r=0.2 class 0.0 = 0.051 +- 0.477 (in-sample avg dev_std = 0.319)
NEC for r=0.2 class 1.0 = 0.826 +- 0.477 (in-sample avg dev_std = 0.319)
NEC for r=0.2 all KL = 0.6 +- 0.477 (in-sample avg dev_std = 0.319)
NEC for r=0.2 all L1 = 0.48 +- 0.403 (in-sample avg dev_std = 0.319)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:43:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:43:19 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:19 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:19 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:43:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:19 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:43:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.382
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.327
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.243


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381698
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.617
SUFF_SIMPLE for r=0.05 class 0.0 = 0.638 +- 0.420 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.488 +- 0.420 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.05 all KL = 0.302 +- 0.420 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.05 all L1 = 0.555 +- 0.322 (in-sample avg dev_std = 0.587)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.326568
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.619
SUFF_SIMPLE for r=0.1 class 0.0 = 0.616 +- 0.409 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.53 +- 0.409 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.1 all KL = 0.31 +- 0.409 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.1 all L1 = 0.568 +- 0.329 (in-sample avg dev_std = 0.566)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24307399999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.592
SUFF_SIMPLE for r=0.2 class 0.0 = 0.64 +- 0.414 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.476 +- 0.414 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.2 all KL = 0.306 +- 0.414 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.2 all L1 = 0.549 +- 0.337 (in-sample avg dev_std = 0.555)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381698
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.522
NEC for r=0.05 class 0.0 = 0.06 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.716 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.51 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.423 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.326568
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.472
NEC for r=0.1 class 0.0 = 0.059 +- 0.491 (in-sample avg dev_std = 0.076)
NEC for r=0.1 class 1.0 = 0.793 +- 0.491 (in-sample avg dev_std = 0.076)
NEC for r=0.1 all KL = 0.556 +- 0.491 (in-sample avg dev_std = 0.076)
NEC for r=0.1 all L1 = 0.466 +- 0.418 (in-sample avg dev_std = 0.076)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24307399999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.618
NEC for r=0.2 class 0.0 = 0.126 +- 0.460 (in-sample avg dev_std = 0.445)
NEC for r=0.2 class 1.0 = 0.622 +- 0.460 (in-sample avg dev_std = 0.445)
NEC for r=0.2 all KL = 0.6 +- 0.460 (in-sample avg dev_std = 0.445)
NEC for r=0.2 all L1 = 0.4 +- 0.359 (in-sample avg dev_std = 0.445)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:43:28 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:43:28 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:28 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:28 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:28 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:43:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.396
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.359
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.274


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39629000000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.585
SUFF_SIMPLE for r=0.05 class 0.0 = 0.869 +- 0.438 (in-sample avg dev_std = 0.519)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.334 +- 0.438 (in-sample avg dev_std = 0.519)
SUFF_SIMPLE for r=0.05 all KL = 0.35 +- 0.438 (in-sample avg dev_std = 0.519)
SUFF_SIMPLE for r=0.05 all L1 = 0.573 +- 0.355 (in-sample avg dev_std = 0.519)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.359076
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.589
SUFF_SIMPLE for r=0.1 class 0.0 = 0.866 +- 0.440 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.336 +- 0.440 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.1 all KL = 0.354 +- 0.440 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.1 all L1 = 0.572 +- 0.355 (in-sample avg dev_std = 0.523)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.273518
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.572
SUFF_SIMPLE for r=0.2 class 0.0 = 0.835 +- 0.430 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.331 +- 0.430 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.2 all KL = 0.335 +- 0.430 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.2 all L1 = 0.556 +- 0.351 (in-sample avg dev_std = 0.516)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39629000000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.498
NEC for r=0.05 class 0.0 = 0.037 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.779 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.547 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.448 +- 0.419 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.359076
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.458
NEC for r=0.1 class 0.0 = 0.052 +- 0.487 (in-sample avg dev_std = 0.024)
NEC for r=0.1 class 1.0 = 0.817 +- 0.487 (in-sample avg dev_std = 0.024)
NEC for r=0.1 all KL = 0.566 +- 0.487 (in-sample avg dev_std = 0.024)
NEC for r=0.1 all L1 = 0.476 +- 0.420 (in-sample avg dev_std = 0.024)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.273518
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.5
NEC for r=0.2 class 0.0 = 0.084 +- 0.473 (in-sample avg dev_std = 0.419)
NEC for r=0.2 class 1.0 = 0.793 +- 0.473 (in-sample avg dev_std = 0.419)
NEC for r=0.2 all KL = 0.616 +- 0.473 (in-sample avg dev_std = 0.419)
NEC for r=0.2 all L1 = 0.477 +- 0.388 (in-sample avg dev_std = 0.419)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:43:37 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:43:37 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:37 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:37 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:43:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:37 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:43:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.388
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.360
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.274


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.38822
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.59
SUFF_SIMPLE for r=0.05 class 0.0 = 0.745 +- 0.444 (in-sample avg dev_std = 0.540)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.428 +- 0.444 (in-sample avg dev_std = 0.540)
SUFF_SIMPLE for r=0.05 all KL = 0.349 +- 0.444 (in-sample avg dev_std = 0.540)
SUFF_SIMPLE for r=0.05 all L1 = 0.57 +- 0.354 (in-sample avg dev_std = 0.540)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.360244
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.582
SUFF_SIMPLE for r=0.1 class 0.0 = 0.725 +- 0.435 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.432 +- 0.435 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.1 all KL = 0.335 +- 0.435 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.1 all L1 = 0.563 +- 0.351 (in-sample avg dev_std = 0.545)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27441200000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.55
SUFF_SIMPLE for r=0.2 class 0.0 = 0.693 +- 0.440 (in-sample avg dev_std = 0.532)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.415 +- 0.440 (in-sample avg dev_std = 0.532)
SUFF_SIMPLE for r=0.2 all KL = 0.324 +- 0.440 (in-sample avg dev_std = 0.532)
SUFF_SIMPLE for r=0.2 all L1 = 0.539 +- 0.354 (in-sample avg dev_std = 0.532)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.38822
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.552
NEC for r=0.05 class 0.0 = 0.01 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.721 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.498 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.404 +- 0.415 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.360244
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.477
NEC for r=0.1 class 0.0 = 0.038 +- 0.491 (in-sample avg dev_std = 0.029)
NEC for r=0.1 class 1.0 = 0.807 +- 0.491 (in-sample avg dev_std = 0.029)
NEC for r=0.1 all KL = 0.554 +- 0.491 (in-sample avg dev_std = 0.029)
NEC for r=0.1 all L1 = 0.464 +- 0.420 (in-sample avg dev_std = 0.029)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27441200000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.548
NEC for r=0.2 class 0.0 = 0.12 +- 0.467 (in-sample avg dev_std = 0.480)
NEC for r=0.2 class 1.0 = 0.72 +- 0.467 (in-sample avg dev_std = 0.480)
NEC for r=0.2 all KL = 0.627 +- 0.467 (in-sample avg dev_std = 0.480)
NEC for r=0.2 all L1 = 0.453 +- 0.371 (in-sample avg dev_std = 0.480)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 17:43:46 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 05:43:46 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:46 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:46 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 05:43:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 05:43:46 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 05:43:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.386
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.364
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.285


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.386046
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.557
SUFF_SIMPLE for r=0.05 class 0.0 = 0.767 +- 0.430 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.36 +- 0.430 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.05 all KL = 0.316 +- 0.430 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.05 all L1 = 0.541 +- 0.348 (in-sample avg dev_std = 0.568)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.36420800000000003
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.553
SUFF_SIMPLE for r=0.1 class 0.0 = 0.771 +- 0.436 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.358 +- 0.436 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.1 all KL = 0.328 +- 0.436 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.1 all L1 = 0.542 +- 0.354 (in-sample avg dev_std = 0.550)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.285144
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.536
SUFF_SIMPLE for r=0.2 class 0.0 = 0.76 +- 0.413 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.328 +- 0.413 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.2 all KL = 0.285 +- 0.413 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.2 all L1 = 0.52 +- 0.343 (in-sample avg dev_std = 0.547)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.386046
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
NEC for r=0.05 class 0.0 = 0.093 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.815 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.588 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.36420800000000003
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.42
NEC for r=0.1 class 0.0 = 0.138 +- 0.470 (in-sample avg dev_std = 0.018)
NEC for r=0.1 class 1.0 = 0.827 +- 0.470 (in-sample avg dev_std = 0.018)
NEC for r=0.1 all KL = 0.624 +- 0.470 (in-sample avg dev_std = 0.018)
NEC for r=0.1 all L1 = 0.52 +- 0.406 (in-sample avg dev_std = 0.018)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.285144
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.444
NEC for r=0.2 class 0.0 = 0.244 +- 0.434 (in-sample avg dev_std = 0.439)
NEC for r=0.2 class 1.0 = 0.778 +- 0.434 (in-sample avg dev_std = 0.439)
NEC for r=0.2 all KL = 0.703 +- 0.434 (in-sample avg dev_std = 0.439)
NEC for r=0.2 all L1 = 0.54 +- 0.364 (in-sample avg dev_std = 0.439)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.326, 0.31, 0.308], 'all_L1': [0.544, 0.547, 0.532]}), defaultdict(<class 'list'>, {'all_KL': [0.327, 0.339, 0.322], 'all_L1': [0.553, 0.56, 0.542]}), defaultdict(<class 'list'>, {'all_KL': [0.357, 0.336, 0.301], 'all_L1': [0.555, 0.545, 0.509]}), defaultdict(<class 'list'>, {'all_KL': [0.331, 0.332, 0.314], 'all_L1': [0.558, 0.555, 0.539]}), defaultdict(<class 'list'>, {'all_KL': [0.32, 0.312, 0.307], 'all_L1': [0.544, 0.53, 0.515]}), defaultdict(<class 'list'>, {'all_KL': [0.361, 0.366, 0.349], 'all_L1': [0.593, 0.596, 0.585]}), defaultdict(<class 'list'>, {'all_KL': [0.302, 0.31, 0.306], 'all_L1': [0.555, 0.568, 0.549]}), defaultdict(<class 'list'>, {'all_KL': [0.35, 0.354, 0.335], 'all_L1': [0.573, 0.572, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.349, 0.335, 0.324], 'all_L1': [0.57, 0.563, 0.539]}), defaultdict(<class 'list'>, {'all_KL': [0.316, 0.328, 0.285], 'all_L1': [0.541, 0.542, 0.52]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.495, 0.554, 0.61], 'all_L1': [0.406, 0.467, 0.439]}), defaultdict(<class 'list'>, {'all_KL': [0.499, 0.548, 0.607], 'all_L1': [0.408, 0.46, 0.446]}), defaultdict(<class 'list'>, {'all_KL': [0.464, 0.547, 0.625], 'all_L1': [0.368, 0.448, 0.432]}), defaultdict(<class 'list'>, {'all_KL': [0.55, 0.58, 0.64], 'all_L1': [0.449, 0.481, 0.49]}), defaultdict(<class 'list'>, {'all_KL': [0.519, 0.571, 0.623], 'all_L1': [0.428, 0.477, 0.416]}), defaultdict(<class 'list'>, {'all_KL': [0.534, 0.557, 0.6], 'all_L1': [0.439, 0.472, 0.48]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.556, 0.6], 'all_L1': [0.423, 0.466, 0.4]}), defaultdict(<class 'list'>, {'all_KL': [0.547, 0.566, 0.616], 'all_L1': [0.448, 0.476, 0.477]}), defaultdict(<class 'list'>, {'all_KL': [0.498, 0.554, 0.627], 'all_L1': [0.404, 0.464, 0.453]}), defaultdict(<class 'list'>, {'all_KL': [0.588, 0.624, 0.703], 'all_L1': [0.493, 0.52, 0.54]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.559 +- 0.015, 0.558 +- 0.018, 0.539 +- 0.021
suff_simple class all_KL  =  0.334 +- 0.018, 0.332 +- 0.018, 0.315 +- 0.017
[[0.5562499761581421, 0.5975000262260437, 0.5494999885559082], [0.5795000195503235, 0.5852500200271606, 0.5647500157356262], [0.5590000152587891, 0.5460000038146973, 0.5034999847412109], [0.5822499990463257, 0.5809999704360962, 0.5677499771118164], [0.5565000176429749, 0.5317500233650208, 0.515250027179718], [0.6165000200271606, 0.6200000047683716, 0.6132500171661377], [0.6172500252723694, 0.6192499995231628, 0.5922499895095825], [0.5845000147819519, 0.5889999866485596, 0.5715000033378601], [0.590499997138977, 0.5822499990463257, 0.5502499938011169], [0.5567499995231628, 0.5534999966621399, 0.5362499952316284]]
[[0.326, 0.31, 0.308], [0.327, 0.339, 0.322], [0.357, 0.336, 0.301], [0.331, 0.332, 0.314], [0.32, 0.312, 0.307], [0.361, 0.366, 0.349], [0.302, 0.31, 0.306], [0.35, 0.354, 0.335], [0.349, 0.335, 0.324], [0.316, 0.328, 0.285]]
suff_simple_acc_int  =  0.580 +- 0.022, 0.581 +- 0.028, 0.556 +- 0.032
nec class all_L1  =  0.427 +- 0.032, 0.473 +- 0.018, 0.457 +- 0.039
nec class all_KL  =  0.520 +- 0.034, 0.566 +- 0.022, 0.625 +- 0.029
[[0.5440000295639038, 0.4699999988079071, 0.5642499923706055], [0.5460000038146973, 0.4790000021457672, 0.5497499704360962], [0.6079999804496765, 0.5087500214576721, 0.5759999752044678], [0.5, 0.46399998664855957, 0.4897499978542328], [0.5260000228881836, 0.4632500112056732, 0.6012499928474426], [0.5139999985694885, 0.46050000190734863, 0.47874999046325684], [0.5220000147819519, 0.4722500145435333, 0.6182500123977661], [0.49799999594688416, 0.4582499861717224, 0.49950000643730164], [0.5519999861717224, 0.476500004529953, 0.5475000143051147], [0.44600000977516174, 0.41999998688697815, 0.4440000057220459]]
[[0.495, 0.554, 0.61], [0.499, 0.548, 0.607], [0.464, 0.547, 0.625], [0.55, 0.58, 0.64], [0.519, 0.571, 0.623], [0.534, 0.557, 0.6], [0.51, 0.556, 0.6], [0.547, 0.566, 0.616], [0.498, 0.554, 0.627], [0.588, 0.624, 0.703]]
nec_acc_int  =  0.526 +- 0.040, 0.467 +- 0.021, 0.537 +- 0.054


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.493 +- 0.018, 0.515 +- 0.011, 0.498 +- 0.023
Faith. Armon (L1)= 		  =  0.483 +- 0.021, 0.512 +- 0.011, 0.494 +- 0.025
Faith. GMean (L1)= 	  =  0.488 +- 0.019, 0.514 +- 0.011, 0.496 +- 0.024
Faith. Aritm (KL)= 		  =  0.427 +- 0.017, 0.449 +- 0.013, 0.470 +- 0.011
Faith. Armon (KL)= 		  =  0.406 +- 0.015, 0.418 +- 0.014, 0.418 +- 0.012
Faith. GMean (KL)= 	  =  0.416 +- 0.015, 0.433 +- 0.013, 0.443 +- 0.009
Computed for split load_split = id



Completed in  0:01:34.305145  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



REPRODUCIBILITY TEST
DONE all :)
