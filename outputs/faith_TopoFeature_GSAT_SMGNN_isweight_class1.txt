nohup: ignoring input
I'm computing faithfulness :)
The PID of this script is: 977632

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 18:03:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 06:03:40 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 06:03:40 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 06:03:40 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 06:03:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:03:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:03:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:03:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:03:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:03:40 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 06:03:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.509
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.771
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.685
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.656
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.070
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.848
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.766
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.710
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.229
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.705
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.663
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.604


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.509173285198556
len(reference) = 277
Effective ratio: 0.257 +- 0.142
Model Accuracy over intervened graphs for r=0.5 =  0.638
SUFF_SIMPLE for r=0.5 class 1.0 = 0.635 +- 0.478 (in-sample avg dev_std = 0.517)
SUFF_SIMPLE for r=0.5 all KL = 0.428 +- 0.478 (in-sample avg dev_std = 0.517)
SUFF_SIMPLE for r=0.5 all L1 = 0.635 +- 0.357 (in-sample avg dev_std = 0.517)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.770898916967509
len(reference) = 277
Effective ratio: 0.063 +- 0.051
Model Accuracy over intervened graphs for r=0.8 =  0.684
SUFF_SIMPLE for r=0.8 class 1.0 = 0.633 +- 0.474 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.8 all KL = 0.419 +- 0.474 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.8 all L1 = 0.633 +- 0.351 (in-sample avg dev_std = 0.537)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6848158844765344
len(reference) = 277
Effective ratio: 0.057 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.678
SUFF_SIMPLE for r=0.9 class 1.0 = 0.635 +- 0.473 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.9 all KL = 0.423 +- 0.473 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.9 all L1 = 0.635 +- 0.354 (in-sample avg dev_std = 0.528)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6561841155234657
len(reference) = 277
Effective ratio: 0.051 +- 0.038
Model Accuracy over intervened graphs for r=0.95 =  0.667
SUFF_SIMPLE for r=0.95 class 1.0 = 0.64 +- 0.470 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.95 all KL = 0.429 +- 0.470 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.95 all L1 = 0.64 +- 0.357 (in-sample avg dev_std = 0.529)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.458
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07047936507936509
len(reference) = 2520
Effective ratio: 0.370 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.162
SUFF_SIMPLE for r=0.5 class 1.0 = 0.595 +- 0.440 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.5 all KL = 0.516 +- 0.440 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.5 all L1 = 0.595 +- 0.357 (in-sample avg dev_std = 0.449)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8475571428571429
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.147
SUFF_SIMPLE for r=0.8 class 1.0 = 0.581 +- 0.439 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.8 all KL = 0.502 +- 0.439 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.8 all L1 = 0.581 +- 0.359 (in-sample avg dev_std = 0.464)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.458
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7663146825396826
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.141
SUFF_SIMPLE for r=0.9 class 1.0 = 0.58 +- 0.439 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.9 all KL = 0.501 +- 0.439 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.9 all L1 = 0.58 +- 0.360 (in-sample avg dev_std = 0.451)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.458
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7103154761904762
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.128
SUFF_SIMPLE for r=0.95 class 1.0 = 0.577 +- 0.440 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.95 all KL = 0.504 +- 0.440 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.95 all L1 = 0.577 +- 0.364 (in-sample avg dev_std = 0.434)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.777
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.22853241491085902
len(reference) = 2461
Effective ratio: 0.423 +- 0.152
Model Accuracy over intervened graphs for r=0.5 =  0.569
SUFF_SIMPLE for r=0.5 class 1.0 = 0.665 +- 0.449 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.5 all KL = 0.591 +- 0.449 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.5 all L1 = 0.665 +- 0.369 (in-sample avg dev_std = 0.256)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.778
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7053063209076176
len(reference) = 2468
Effective ratio: 0.072 +- 0.116
Model Accuracy over intervened graphs for r=0.8 =  0.681
SUFF_SIMPLE for r=0.8 class 1.0 = 0.685 +- 0.446 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.8 all KL = 0.562 +- 0.446 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.8 all L1 = 0.685 +- 0.326 (in-sample avg dev_std = 0.350)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.778
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6630097244732577
len(reference) = 2468
Effective ratio: 0.054 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.65
SUFF_SIMPLE for r=0.9 class 1.0 = 0.68 +- 0.445 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.9 all KL = 0.553 +- 0.445 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.9 all L1 = 0.68 +- 0.330 (in-sample avg dev_std = 0.370)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.778
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6043982982171799
len(reference) = 2468
Effective ratio: 0.046 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.62
SUFF_SIMPLE for r=0.95 class 1.0 = 0.675 +- 0.447 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.95 all KL = 0.553 +- 0.447 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.95 all L1 = 0.675 +- 0.338 (in-sample avg dev_std = 0.373)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.509173285198556
len(reference) = 277
Effective ratio: 0.257 +- 0.142
Model Accuracy over intervened graphs for r=0.5 =  0.467
NEC for r=0.5 class 1.0 = 0.554 +- 0.285 (in-sample avg dev_std = 0.605)
NEC for r=0.5 all KL = 0.871 +- 0.285 (in-sample avg dev_std = 0.605)
NEC for r=0.5 all L1 = 0.554 +- 0.299 (in-sample avg dev_std = 0.605)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.770898916967509
len(reference) = 277
Effective ratio: 0.063 +- 0.051
Model Accuracy over intervened graphs for r=0.8 =  0.007
NEC for r=0.8 class 1.0 = 0.854 +- 0.084 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.993 +- 0.084 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.854 +- 0.074 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6848158844765344
len(reference) = 277
Effective ratio: 0.057 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.018
NEC for r=0.9 class 1.0 = 0.845 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.982 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.845 +- 0.115 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6561841155234657
len(reference) = 277
Effective ratio: 0.051 +- 0.038
Model Accuracy over intervened graphs for r=0.95 =  0.076
NEC for r=0.95 class 1.0 = 0.796 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.926 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.796 +- 0.226 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.458
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07047936507936509
len(reference) = 2520
Effective ratio: 0.370 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.141
NEC for r=0.5 class 1.0 = 0.408 +- 0.424 (in-sample avg dev_std = 0.483)
NEC for r=0.5 all KL = 0.496 +- 0.424 (in-sample avg dev_std = 0.483)
NEC for r=0.5 all L1 = 0.408 +- 0.344 (in-sample avg dev_std = 0.483)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8475571428571429
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.428 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.459 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.428 +- 0.400 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.458
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7663146825396826
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.428 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.459 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.428 +- 0.400 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.458
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7103154761904762
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.428 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.459 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.428 +- 0.400 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.778
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.22853241491085902
len(reference) = 2468
Effective ratio: 0.423 +- 0.152
Model Accuracy over intervened graphs for r=0.5 =  0.406
NEC for r=0.5 class 1.0 = 0.525 +- 0.356 (in-sample avg dev_std = 0.558)
NEC for r=0.5 all KL = 0.725 +- 0.356 (in-sample avg dev_std = 0.558)
NEC for r=0.5 all L1 = 0.525 +- 0.298 (in-sample avg dev_std = 0.558)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.778
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7053063209076176
len(reference) = 2468
Effective ratio: 0.072 +- 0.116
Model Accuracy over intervened graphs for r=0.8 =  0.087
NEC for r=0.8 class 1.0 = 0.662 +- 0.390 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.766 +- 0.390 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.662 +- 0.331 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.778
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6630097244732577
len(reference) = 2468
Effective ratio: 0.054 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.094
NEC for r=0.9 class 1.0 = 0.64 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.736 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.64 +- 0.350 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.778
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6043982982171799
len(reference) = 2468
Effective ratio: 0.046 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.118
NEC for r=0.95 class 1.0 = 0.618 +- 0.426 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.71 +- 0.426 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.618 +- 0.363 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 18:09:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 06:09:10 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 06:09:10 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 06:09:10 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 06:09:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:09:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:09:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:09:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:09:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:09:10 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 06:09:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 76 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.469
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.940
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.813
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.705
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.072
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.947
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.916
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.879
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.246
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.777
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.718
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.637


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.4693032490974729
len(reference) = 277
Effective ratio: 0.273 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.674
SUFF_SIMPLE for r=0.5 class 1.0 = 0.667 +- 0.476 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.5 all KL = 0.497 +- 0.476 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.5 all L1 = 0.667 +- 0.365 (in-sample avg dev_std = 0.484)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9399350180505416
len(reference) = 277
Effective ratio: 0.087 +- 0.071
Model Accuracy over intervened graphs for r=0.8 =  0.689
SUFF_SIMPLE for r=0.8 class 1.0 = 0.676 +- 0.478 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.8 all KL = 0.504 +- 0.478 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.8 all L1 = 0.676 +- 0.357 (in-sample avg dev_std = 0.515)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8125631768953069
len(reference) = 277
Effective ratio: 0.069 +- 0.050
Model Accuracy over intervened graphs for r=0.9 =  0.697
SUFF_SIMPLE for r=0.9 class 1.0 = 0.681 +- 0.479 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.9 all KL = 0.504 +- 0.479 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.9 all L1 = 0.681 +- 0.353 (in-sample avg dev_std = 0.518)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7045126353790613
len(reference) = 277
Effective ratio: 0.059 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.709
SUFF_SIMPLE for r=0.95 class 1.0 = 0.688 +- 0.472 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.95 all KL = 0.503 +- 0.472 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.95 all L1 = 0.688 +- 0.347 (in-sample avg dev_std = 0.530)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.788
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0722547619047619
len(reference) = 2520
Effective ratio: 0.350 +- 0.107
Model Accuracy over intervened graphs for r=0.5 =  0.225
SUFF_SIMPLE for r=0.5 class 1.0 = 0.405 +- 0.366 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.5 all KL = 0.301 +- 0.366 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.5 all L1 = 0.405 +- 0.299 (in-sample avg dev_std = 0.488)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9467277777777777
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.245
SUFF_SIMPLE for r=0.8 class 1.0 = 0.409 +- 0.360 (in-sample avg dev_std = 0.531)
SUFF_SIMPLE for r=0.8 all KL = 0.297 +- 0.360 (in-sample avg dev_std = 0.531)
SUFF_SIMPLE for r=0.8 all L1 = 0.409 +- 0.291 (in-sample avg dev_std = 0.531)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.788
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.916395238095238
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.245
SUFF_SIMPLE for r=0.9 class 1.0 = 0.406 +- 0.356 (in-sample avg dev_std = 0.538)
SUFF_SIMPLE for r=0.9 all KL = 0.293 +- 0.356 (in-sample avg dev_std = 0.538)
SUFF_SIMPLE for r=0.9 all L1 = 0.406 +- 0.287 (in-sample avg dev_std = 0.538)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.788
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8785488095238096
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.244
SUFF_SIMPLE for r=0.95 class 1.0 = 0.408 +- 0.361 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.95 all KL = 0.298 +- 0.361 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.95 all L1 = 0.408 +- 0.292 (in-sample avg dev_std = 0.529)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.734
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2458427876823339
len(reference) = 2467
Effective ratio: 0.356 +- 0.141
Model Accuracy over intervened graphs for r=0.5 =  0.545
SUFF_SIMPLE for r=0.5 class 1.0 = 0.606 +- 0.444 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.5 all KL = 0.534 +- 0.444 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.5 all L1 = 0.606 +- 0.360 (in-sample avg dev_std = 0.335)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.735
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7774262560777958
len(reference) = 2468
Effective ratio: 0.080 +- 0.113
Model Accuracy over intervened graphs for r=0.8 =  0.544
SUFF_SIMPLE for r=0.8 class 1.0 = 0.616 +- 0.438 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.8 all KL = 0.532 +- 0.438 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.8 all L1 = 0.616 +- 0.350 (in-sample avg dev_std = 0.375)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7183829011345219
len(reference) = 2468
Effective ratio: 0.061 +- 0.086
Model Accuracy over intervened graphs for r=0.9 =  0.535
SUFF_SIMPLE for r=0.9 class 1.0 = 0.626 +- 0.434 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.9 all KL = 0.54 +- 0.434 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.9 all L1 = 0.626 +- 0.346 (in-sample avg dev_std = 0.387)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.735
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6367119124797408
len(reference) = 2468
Effective ratio: 0.047 +- 0.063
Model Accuracy over intervened graphs for r=0.95 =  0.524
SUFF_SIMPLE for r=0.95 class 1.0 = 0.643 +- 0.430 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.95 all KL = 0.559 +- 0.430 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.95 all L1 = 0.643 +- 0.341 (in-sample avg dev_std = 0.390)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.4693032490974729
len(reference) = 277
Effective ratio: 0.273 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.491
NEC for r=0.5 class 1.0 = 0.564 +- 0.261 (in-sample avg dev_std = 0.704)
NEC for r=0.5 all KL = 0.888 +- 0.261 (in-sample avg dev_std = 0.704)
NEC for r=0.5 all L1 = 0.564 +- 0.267 (in-sample avg dev_std = 0.704)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9399350180505416
len(reference) = 277
Effective ratio: 0.087 +- 0.071
Model Accuracy over intervened graphs for r=0.8 =  0.004
NEC for r=0.8 class 1.0 = 0.858 +- 0.037 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.998 +- 0.037 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.858 +- 0.049 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8125631768953069
len(reference) = 277
Effective ratio: 0.069 +- 0.050
Model Accuracy over intervened graphs for r=0.9 =  0.025
NEC for r=0.9 class 1.0 = 0.843 +- 0.109 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.987 +- 0.109 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.843 +- 0.106 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7045126353790613
len(reference) = 277
Effective ratio: 0.059 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.047
NEC for r=0.95 class 1.0 = 0.824 +- 0.195 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.96 +- 0.195 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.824 +- 0.170 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.788
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0722547619047619
len(reference) = 2520
Effective ratio: 0.350 +- 0.107
Model Accuracy over intervened graphs for r=0.5 =  0.298
NEC for r=0.5 class 1.0 = 0.572 +- 0.331 (in-sample avg dev_std = 0.626)
NEC for r=0.5 all KL = 0.712 +- 0.331 (in-sample avg dev_std = 0.626)
NEC for r=0.5 all L1 = 0.572 +- 0.256 (in-sample avg dev_std = 0.626)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9467277777777777
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.707 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.772 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.707 +- 0.285 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.788
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.916395238095238
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.707 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.772 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.707 +- 0.284 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.788
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8785488095238096
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.001
NEC for r=0.95 class 1.0 = 0.707 +- 0.354 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.771 +- 0.354 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.707 +- 0.285 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.735
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2458427876823339
len(reference) = 2468
Effective ratio: 0.356 +- 0.141
Model Accuracy over intervened graphs for r=0.5 =  0.268
NEC for r=0.5 class 1.0 = 0.55 +- 0.382 (in-sample avg dev_std = 0.502)
NEC for r=0.5 all KL = 0.682 +- 0.382 (in-sample avg dev_std = 0.502)
NEC for r=0.5 all L1 = 0.55 +- 0.306 (in-sample avg dev_std = 0.502)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.735
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7774262560777958
len(reference) = 2468
Effective ratio: 0.080 +- 0.113
Model Accuracy over intervened graphs for r=0.8 =  0.084
NEC for r=0.8 class 1.0 = 0.614 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.7 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.614 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7183829011345219
len(reference) = 2468
Effective ratio: 0.061 +- 0.086
Model Accuracy over intervened graphs for r=0.9 =  0.096
NEC for r=0.9 class 1.0 = 0.597 +- 0.428 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.678 +- 0.428 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.597 +- 0.363 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.735
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6367119124797408
len(reference) = 2468
Effective ratio: 0.047 +- 0.063
Model Accuracy over intervened graphs for r=0.95 =  0.114
NEC for r=0.95 class 1.0 = 0.576 +- 0.439 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.649 +- 0.439 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.576 +- 0.374 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 18:14:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 06:14:08 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 06:14:08 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 06:14:08 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:14:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:14:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:14:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:14:08 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 06:14:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.597
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.888
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.801
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.682
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.104
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.937
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.907
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.863
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.245
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.748
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.746
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.664


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5966462093862817
len(reference) = 277
Effective ratio: 0.214 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.665
SUFF_SIMPLE for r=0.5 class 1.0 = 0.661 +- 0.483 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.5 all KL = 0.486 +- 0.483 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.5 all L1 = 0.661 +- 0.368 (in-sample avg dev_std = 0.494)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8880902527075812
len(reference) = 277
Effective ratio: 0.075 +- 0.052
Model Accuracy over intervened graphs for r=0.8 =  0.698
SUFF_SIMPLE for r=0.8 class 1.0 = 0.684 +- 0.487 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.8 all KL = 0.51 +- 0.487 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.8 all L1 = 0.684 +- 0.357 (in-sample avg dev_std = 0.510)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8011263537906137
len(reference) = 277
Effective ratio: 0.066 +- 0.046
Model Accuracy over intervened graphs for r=0.9 =  0.707
SUFF_SIMPLE for r=0.9 class 1.0 = 0.689 +- 0.481 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.9 all KL = 0.493 +- 0.481 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.9 all L1 = 0.689 +- 0.351 (in-sample avg dev_std = 0.516)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6816606498194946
len(reference) = 277
Effective ratio: 0.056 +- 0.041
Model Accuracy over intervened graphs for r=0.95 =  0.706
SUFF_SIMPLE for r=0.95 class 1.0 = 0.687 +- 0.479 (in-sample avg dev_std = 0.519)
SUFF_SIMPLE for r=0.95 all KL = 0.497 +- 0.479 (in-sample avg dev_std = 0.519)
SUFF_SIMPLE for r=0.95 all L1 = 0.687 +- 0.353 (in-sample avg dev_std = 0.519)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.874
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10414126984126985
len(reference) = 2520
Effective ratio: 0.262 +- 0.115
Model Accuracy over intervened graphs for r=0.5 =  0.19
SUFF_SIMPLE for r=0.5 class 1.0 = 0.338 +- 0.334 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.5 all KL = 0.168 +- 0.334 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.5 all L1 = 0.338 +- 0.285 (in-sample avg dev_std = 0.521)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9371210317460318
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.215
SUFF_SIMPLE for r=0.8 class 1.0 = 0.358 +- 0.353 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.8 all KL = 0.19 +- 0.353 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.8 all L1 = 0.358 +- 0.301 (in-sample avg dev_std = 0.516)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9074825396825396
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.216
SUFF_SIMPLE for r=0.9 class 1.0 = 0.36 +- 0.356 (in-sample avg dev_std = 0.519)
SUFF_SIMPLE for r=0.9 all KL = 0.193 +- 0.356 (in-sample avg dev_std = 0.519)
SUFF_SIMPLE for r=0.9 all L1 = 0.36 +- 0.301 (in-sample avg dev_std = 0.519)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.874
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8634924603174604
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.214
SUFF_SIMPLE for r=0.95 class 1.0 = 0.359 +- 0.359 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.95 all KL = 0.196 +- 0.359 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.95 all L1 = 0.359 +- 0.303 (in-sample avg dev_std = 0.511)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.741
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.24458306320907616
len(reference) = 2465
Effective ratio: 0.407 +- 0.140
Model Accuracy over intervened graphs for r=0.5 =  0.573
SUFF_SIMPLE for r=0.5 class 1.0 = 0.599 +- 0.442 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.5 all KL = 0.529 +- 0.442 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.5 all L1 = 0.599 +- 0.363 (in-sample avg dev_std = 0.315)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.741
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7477086709886548
len(reference) = 2468
Effective ratio: 0.079 +- 0.110
Model Accuracy over intervened graphs for r=0.8 =  0.558
SUFF_SIMPLE for r=0.8 class 1.0 = 0.63 +- 0.435 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.8 all KL = 0.56 +- 0.435 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.8 all L1 = 0.63 +- 0.353 (in-sample avg dev_std = 0.329)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7464862236628849
len(reference) = 2468
Effective ratio: 0.062 +- 0.092
Model Accuracy over intervened graphs for r=0.9 =  0.564
SUFF_SIMPLE for r=0.9 class 1.0 = 0.634 +- 0.431 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.9 all KL = 0.563 +- 0.431 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.9 all L1 = 0.634 +- 0.351 (in-sample avg dev_std = 0.339)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.741
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6643585899513776
len(reference) = 2468
Effective ratio: 0.050 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.561
SUFF_SIMPLE for r=0.95 class 1.0 = 0.646 +- 0.430 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.95 all KL = 0.579 +- 0.430 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.95 all L1 = 0.646 +- 0.350 (in-sample avg dev_std = 0.330)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5966462093862817
len(reference) = 277
Effective ratio: 0.214 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.37
NEC for r=0.5 class 1.0 = 0.61 +- 0.311 (in-sample avg dev_std = 0.542)
NEC for r=0.5 all KL = 0.863 +- 0.311 (in-sample avg dev_std = 0.542)
NEC for r=0.5 all L1 = 0.61 +- 0.312 (in-sample avg dev_std = 0.542)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8880902527075812
len(reference) = 277
Effective ratio: 0.075 +- 0.052
Model Accuracy over intervened graphs for r=0.8 =  0.094
NEC for r=0.8 class 1.0 = 0.797 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.958 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.797 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8011263537906137
len(reference) = 277
Effective ratio: 0.066 +- 0.046
Model Accuracy over intervened graphs for r=0.9 =  0.159
NEC for r=0.9 class 1.0 = 0.757 +- 0.202 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.942 +- 0.202 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.757 +- 0.238 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6816606498194946
len(reference) = 277
Effective ratio: 0.056 +- 0.041
Model Accuracy over intervened graphs for r=0.95 =  0.191
NEC for r=0.95 class 1.0 = 0.727 +- 0.267 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.908 +- 0.267 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.727 +- 0.274 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.874
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10414126984126985
len(reference) = 2520
Effective ratio: 0.262 +- 0.115
Model Accuracy over intervened graphs for r=0.5 =  0.234
NEC for r=0.5 class 1.0 = 0.666 +- 0.289 (in-sample avg dev_std = 0.637)
NEC for r=0.5 all KL = 0.86 +- 0.289 (in-sample avg dev_std = 0.637)
NEC for r=0.5 all L1 = 0.666 +- 0.243 (in-sample avg dev_std = 0.637)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9371210317460318
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.769 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.872 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.769 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9074825396825396
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.001
NEC for r=0.9 class 1.0 = 0.769 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.872 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.769 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.874
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8634924603174604
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.005
NEC for r=0.95 class 1.0 = 0.769 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.872 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.769 +- 0.247 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.741
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.24458306320907616
len(reference) = 2468
Effective ratio: 0.407 +- 0.140
Model Accuracy over intervened graphs for r=0.5 =  0.299
NEC for r=0.5 class 1.0 = 0.505 +- 0.392 (in-sample avg dev_std = 0.488)
NEC for r=0.5 all KL = 0.619 +- 0.392 (in-sample avg dev_std = 0.488)
NEC for r=0.5 all L1 = 0.505 +- 0.316 (in-sample avg dev_std = 0.488)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.741
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7477086709886548
len(reference) = 2468
Effective ratio: 0.079 +- 0.110
Model Accuracy over intervened graphs for r=0.8 =  0.098
NEC for r=0.8 class 1.0 = 0.586 +- 0.426 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.664 +- 0.426 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.586 +- 0.366 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7464862236628849
len(reference) = 2468
Effective ratio: 0.062 +- 0.092
Model Accuracy over intervened graphs for r=0.9 =  0.123
NEC for r=0.9 class 1.0 = 0.564 +- 0.435 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.639 +- 0.435 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.564 +- 0.374 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.741
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6643585899513776
len(reference) = 2468
Effective ratio: 0.050 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.139
NEC for r=0.95 class 1.0 = 0.55 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.623 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.55 +- 0.379 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 18:19:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 06:19:45 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 06:19:45 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 06:19:45 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 06:19:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:19:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:19:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:19:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:19:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:19:45 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 06:19:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.503
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.943
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.866
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.799
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.107
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.903
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.954
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.968
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.286
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.848
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.820
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.770


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5026534296028882
len(reference) = 277
Effective ratio: 0.266 +- 0.142
Model Accuracy over intervened graphs for r=0.5 =  0.682
SUFF_SIMPLE for r=0.5 class 1.0 = 0.666 +- 0.448 (in-sample avg dev_std = 0.482)
SUFF_SIMPLE for r=0.5 all KL = 0.445 +- 0.448 (in-sample avg dev_std = 0.482)
SUFF_SIMPLE for r=0.5 all L1 = 0.666 +- 0.348 (in-sample avg dev_std = 0.482)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9430361010830325
len(reference) = 277
Effective ratio: 0.091 +- 0.074
Model Accuracy over intervened graphs for r=0.8 =  0.685
SUFF_SIMPLE for r=0.8 class 1.0 = 0.658 +- 0.447 (in-sample avg dev_std = 0.538)
SUFF_SIMPLE for r=0.8 all KL = 0.425 +- 0.447 (in-sample avg dev_std = 0.538)
SUFF_SIMPLE for r=0.8 all L1 = 0.658 +- 0.339 (in-sample avg dev_std = 0.538)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8663501805054151
len(reference) = 277
Effective ratio: 0.076 +- 0.055
Model Accuracy over intervened graphs for r=0.9 =  0.686
SUFF_SIMPLE for r=0.9 class 1.0 = 0.654 +- 0.448 (in-sample avg dev_std = 0.524)
SUFF_SIMPLE for r=0.9 all KL = 0.418 +- 0.448 (in-sample avg dev_std = 0.524)
SUFF_SIMPLE for r=0.9 all L1 = 0.654 +- 0.338 (in-sample avg dev_std = 0.524)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7991516245487365
len(reference) = 277
Effective ratio: 0.068 +- 0.050
Model Accuracy over intervened graphs for r=0.95 =  0.685
SUFF_SIMPLE for r=0.95 class 1.0 = 0.652 +- 0.435 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.95 all KL = 0.404 +- 0.435 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.95 all L1 = 0.652 +- 0.336 (in-sample avg dev_std = 0.545)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.775
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10677738095238096
len(reference) = 2520
Effective ratio: 0.225 +- 0.066
Model Accuracy over intervened graphs for r=0.5 =  0.011
SUFF_SIMPLE for r=0.5 class 1.0 = 0.305 +- 0.366 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.5 all KL = 0.232 +- 0.366 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.5 all L1 = 0.305 +- 0.296 (in-sample avg dev_std = 0.179)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9031869047619048
len(reference) = 2520
Effective ratio: 0.015 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.012
SUFF_SIMPLE for r=0.8 class 1.0 = 0.306 +- 0.367 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.8 all KL = 0.232 +- 0.367 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.8 all L1 = 0.306 +- 0.296 (in-sample avg dev_std = 0.181)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9540456349206348
len(reference) = 2520
Effective ratio: 0.014 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.013
SUFF_SIMPLE for r=0.9 class 1.0 = 0.306 +- 0.366 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.9 all KL = 0.232 +- 0.366 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.9 all L1 = 0.306 +- 0.296 (in-sample avg dev_std = 0.191)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.775
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9678015873015874
len(reference) = 2520
Effective ratio: 0.013 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.013
SUFF_SIMPLE for r=0.95 class 1.0 = 0.306 +- 0.366 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.95 all KL = 0.232 +- 0.366 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.95 all L1 = 0.306 +- 0.296 (in-sample avg dev_std = 0.187)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.845
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2860761750405187
len(reference) = 2468
Effective ratio: 0.316 +- 0.177
Model Accuracy over intervened graphs for r=0.5 =  0.615
SUFF_SIMPLE for r=0.5 class 1.0 = 0.7 +- 0.442 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.5 all KL = 0.646 +- 0.442 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.5 all L1 = 0.7 +- 0.361 (in-sample avg dev_std = 0.225)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.845
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8476004862236628
len(reference) = 2468
Effective ratio: 0.088 +- 0.121
Model Accuracy over intervened graphs for r=0.8 =  0.61
SUFF_SIMPLE for r=0.8 class 1.0 = 0.707 +- 0.436 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.8 all KL = 0.657 +- 0.436 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.8 all L1 = 0.707 +- 0.357 (in-sample avg dev_std = 0.243)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.819965964343598
len(reference) = 2468
Effective ratio: 0.063 +- 0.074
Model Accuracy over intervened graphs for r=0.9 =  0.609
SUFF_SIMPLE for r=0.9 class 1.0 = 0.712 +- 0.433 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.9 all KL = 0.664 +- 0.433 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.9 all L1 = 0.712 +- 0.356 (in-sample avg dev_std = 0.254)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.845
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7702868719611021
len(reference) = 2468
Effective ratio: 0.052 +- 0.056
Model Accuracy over intervened graphs for r=0.95 =  0.607
SUFF_SIMPLE for r=0.95 class 1.0 = 0.71 +- 0.427 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.95 all KL = 0.658 +- 0.427 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.95 all L1 = 0.71 +- 0.353 (in-sample avg dev_std = 0.268)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5026534296028882
len(reference) = 277
Effective ratio: 0.266 +- 0.142
Model Accuracy over intervened graphs for r=0.5 =  0.348
NEC for r=0.5 class 1.0 = 0.658 +- 0.158 (in-sample avg dev_std = 0.649)
NEC for r=0.5 all KL = 0.949 +- 0.158 (in-sample avg dev_std = 0.649)
NEC for r=0.5 all L1 = 0.658 +- 0.237 (in-sample avg dev_std = 0.649)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9430361010830325
len(reference) = 277
Effective ratio: 0.091 +- 0.074
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.863 +- 0.003 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.863 +- 0.011 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8663501805054151
len(reference) = 277
Effective ratio: 0.076 +- 0.055
Model Accuracy over intervened graphs for r=0.9 =  0.004
NEC for r=0.9 class 1.0 = 0.859 +- 0.059 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.996 +- 0.059 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.859 +- 0.051 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7991516245487365
len(reference) = 277
Effective ratio: 0.068 +- 0.050
Model Accuracy over intervened graphs for r=0.95 =  0.011
NEC for r=0.95 class 1.0 = 0.854 +- 0.090 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.991 +- 0.090 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.854 +- 0.080 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.775
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10677738095238096
len(reference) = 2520
Effective ratio: 0.225 +- 0.066
Model Accuracy over intervened graphs for r=0.5 =  0.022
NEC for r=0.5 class 1.0 = 0.691 +- 0.366 (in-sample avg dev_std = 0.241)
NEC for r=0.5 all KL = 0.768 +- 0.366 (in-sample avg dev_std = 0.241)
NEC for r=0.5 all L1 = 0.691 +- 0.294 (in-sample avg dev_std = 0.241)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9031869047619048
len(reference) = 2520
Effective ratio: 0.015 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.698 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.768 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.698 +- 0.299 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9540456349206348
len(reference) = 2520
Effective ratio: 0.014 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.698 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.768 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.698 +- 0.299 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.775
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9678015873015874
len(reference) = 2520
Effective ratio: 0.013 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.698 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.768 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.698 +- 0.298 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.845
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2860761750405187
len(reference) = 2468
Effective ratio: 0.316 +- 0.177
Model Accuracy over intervened graphs for r=0.5 =  0.18
NEC for r=0.5 class 1.0 = 0.654 +- 0.338 (in-sample avg dev_std = 0.503)
NEC for r=0.5 all KL = 0.792 +- 0.338 (in-sample avg dev_std = 0.503)
NEC for r=0.5 all L1 = 0.654 +- 0.278 (in-sample avg dev_std = 0.503)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.845
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8476004862236628
len(reference) = 2468
Effective ratio: 0.088 +- 0.121
Model Accuracy over intervened graphs for r=0.8 =  0.025
NEC for r=0.8 class 1.0 = 0.731 +- 0.336 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.833 +- 0.336 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.731 +- 0.279 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.819965964343598
len(reference) = 2468
Effective ratio: 0.063 +- 0.074
Model Accuracy over intervened graphs for r=0.9 =  0.044
NEC for r=0.9 class 1.0 = 0.721 +- 0.345 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.823 +- 0.345 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.721 +- 0.288 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.845
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7702868719611021
len(reference) = 2468
Effective ratio: 0.052 +- 0.056
Model Accuracy over intervened graphs for r=0.95 =  0.066
NEC for r=0.95 class 1.0 = 0.707 +- 0.355 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.808 +- 0.355 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.707 +- 0.300 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 18:25:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 06:25:00 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 06:25:00 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 06:25:00 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 06:25:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:25:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:25:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:25:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:25:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:25:00 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 06:25:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.757
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.738
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.693
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.670
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.103
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.870
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.801
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.738
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.310
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.722
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.674
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.633


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.7566606498194945
len(reference) = 277
Effective ratio: 0.159 +- 0.127
Model Accuracy over intervened graphs for r=0.5 =  0.678
SUFF_SIMPLE for r=0.5 class 1.0 = 0.67 +- 0.478 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.5 all KL = 0.499 +- 0.478 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.5 all L1 = 0.67 +- 0.361 (in-sample avg dev_std = 0.506)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7381480144404332
len(reference) = 277
Effective ratio: 0.059 +- 0.047
Model Accuracy over intervened graphs for r=0.8 =  0.703
SUFF_SIMPLE for r=0.8 class 1.0 = 0.681 +- 0.477 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.8 all KL = 0.495 +- 0.477 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.8 all L1 = 0.681 +- 0.346 (in-sample avg dev_std = 0.535)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6927833935018051
len(reference) = 277
Effective ratio: 0.054 +- 0.041
Model Accuracy over intervened graphs for r=0.9 =  0.703
SUFF_SIMPLE for r=0.9 class 1.0 = 0.68 +- 0.477 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.9 all KL = 0.493 +- 0.477 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.9 all L1 = 0.68 +- 0.346 (in-sample avg dev_std = 0.537)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6701805054151624
len(reference) = 277
Effective ratio: 0.050 +- 0.033
Model Accuracy over intervened graphs for r=0.95 =  0.729
SUFF_SIMPLE for r=0.95 class 1.0 = 0.696 +- 0.476 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.95 all KL = 0.52 +- 0.476 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.95 all L1 = 0.696 +- 0.341 (in-sample avg dev_std = 0.562)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.497
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10276190476190478
len(reference) = 2520
Effective ratio: 0.259 +- 0.117
Model Accuracy over intervened graphs for r=0.5 =  0.312
SUFF_SIMPLE for r=0.5 class 1.0 = 0.578 +- 0.408 (in-sample avg dev_std = 0.565)
SUFF_SIMPLE for r=0.5 all KL = 0.479 +- 0.408 (in-sample avg dev_std = 0.565)
SUFF_SIMPLE for r=0.5 all L1 = 0.578 +- 0.320 (in-sample avg dev_std = 0.565)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8695309523809523
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.327
SUFF_SIMPLE for r=0.8 class 1.0 = 0.572 +- 0.407 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.8 all KL = 0.472 +- 0.407 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.8 all L1 = 0.572 +- 0.322 (in-sample avg dev_std = 0.556)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.497
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8009753968253969
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.315
SUFF_SIMPLE for r=0.9 class 1.0 = 0.567 +- 0.411 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.9 all KL = 0.475 +- 0.411 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.9 all L1 = 0.567 +- 0.328 (in-sample avg dev_std = 0.541)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.497
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7382642857142857
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.304
SUFF_SIMPLE for r=0.95 class 1.0 = 0.561 +- 0.412 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.95 all KL = 0.47 +- 0.412 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.95 all L1 = 0.561 +- 0.329 (in-sample avg dev_std = 0.545)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.746
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.31009724473257694
len(reference) = 2461
Effective ratio: 0.372 +- 0.231
Model Accuracy over intervened graphs for r=0.5 =  0.599
SUFF_SIMPLE for r=0.5 class 1.0 = 0.612 +- 0.447 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.5 all KL = 0.546 +- 0.447 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.5 all L1 = 0.612 +- 0.363 (in-sample avg dev_std = 0.287)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.745
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7224136952998379
len(reference) = 2468
Effective ratio: 0.070 +- 0.111
Model Accuracy over intervened graphs for r=0.8 =  0.606
SUFF_SIMPLE for r=0.8 class 1.0 = 0.609 +- 0.445 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.8 all KL = 0.509 +- 0.445 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.8 all L1 = 0.609 +- 0.346 (in-sample avg dev_std = 0.379)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6738727714748785
len(reference) = 2468
Effective ratio: 0.054 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.612
SUFF_SIMPLE for r=0.9 class 1.0 = 0.614 +- 0.444 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.9 all KL = 0.506 +- 0.444 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.9 all L1 = 0.614 +- 0.340 (in-sample avg dev_std = 0.424)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.745
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6332378444084279
len(reference) = 2468
Effective ratio: 0.046 +- 0.072
Model Accuracy over intervened graphs for r=0.95 =  0.61
SUFF_SIMPLE for r=0.95 class 1.0 = 0.621 +- 0.443 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.95 all KL = 0.51 +- 0.443 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.95 all L1 = 0.621 +- 0.335 (in-sample avg dev_std = 0.443)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.7566606498194945
len(reference) = 277
Effective ratio: 0.159 +- 0.127
Model Accuracy over intervened graphs for r=0.5 =  0.222
NEC for r=0.5 class 1.0 = 0.712 +- 0.247 (in-sample avg dev_std = 0.383)
NEC for r=0.5 all KL = 0.913 +- 0.247 (in-sample avg dev_std = 0.383)
NEC for r=0.5 all L1 = 0.712 +- 0.270 (in-sample avg dev_std = 0.383)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7381480144404332
len(reference) = 277
Effective ratio: 0.059 +- 0.047
Model Accuracy over intervened graphs for r=0.8 =  0.007
NEC for r=0.8 class 1.0 = 0.855 +- 0.085 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.993 +- 0.085 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.855 +- 0.074 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6927833935018051
len(reference) = 277
Effective ratio: 0.054 +- 0.041
Model Accuracy over intervened graphs for r=0.9 =  0.032
NEC for r=0.9 class 1.0 = 0.835 +- 0.177 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.968 +- 0.177 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.835 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6701805054151624
len(reference) = 277
Effective ratio: 0.050 +- 0.033
Model Accuracy over intervened graphs for r=0.95 =  0.072
NEC for r=0.95 class 1.0 = 0.803 +- 0.245 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.933 +- 0.245 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.803 +- 0.216 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.497
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10276190476190478
len(reference) = 2520
Effective ratio: 0.259 +- 0.117
Model Accuracy over intervened graphs for r=0.5 =  0.202
NEC for r=0.5 class 1.0 = 0.454 +- 0.403 (in-sample avg dev_std = 0.530)
NEC for r=0.5 all KL = 0.544 +- 0.403 (in-sample avg dev_std = 0.530)
NEC for r=0.5 all L1 = 0.454 +- 0.323 (in-sample avg dev_std = 0.530)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8695309523809523
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.468 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.497 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.468 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.497
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8009753968253969
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.468 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.497 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.468 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.497
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7382642857142857
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.468 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.497 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.468 +- 0.390 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.745
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.31009724473257694
len(reference) = 2468
Effective ratio: 0.372 +- 0.231
Model Accuracy over intervened graphs for r=0.5 =  0.327
NEC for r=0.5 class 1.0 = 0.542 +- 0.359 (in-sample avg dev_std = 0.478)
NEC for r=0.5 all KL = 0.679 +- 0.359 (in-sample avg dev_std = 0.478)
NEC for r=0.5 all L1 = 0.542 +- 0.301 (in-sample avg dev_std = 0.478)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.745
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7224136952998379
len(reference) = 2468
Effective ratio: 0.070 +- 0.111
Model Accuracy over intervened graphs for r=0.8 =  0.092
NEC for r=0.8 class 1.0 = 0.614 +- 0.414 (in-sample avg dev_std = 0.061)
NEC for r=0.8 all KL = 0.695 +- 0.414 (in-sample avg dev_std = 0.061)
NEC for r=0.8 all L1 = 0.614 +- 0.352 (in-sample avg dev_std = 0.061)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6738727714748785
len(reference) = 2468
Effective ratio: 0.054 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.099
NEC for r=0.9 class 1.0 = 0.592 +- 0.430 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.664 +- 0.430 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.592 +- 0.367 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.745
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6332378444084279
len(reference) = 2468
Effective ratio: 0.046 +- 0.072
Model Accuracy over intervened graphs for r=0.95 =  0.115
NEC for r=0.95 class 1.0 = 0.578 +- 0.438 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.645 +- 0.438 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.578 +- 0.374 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 18:30:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 06:30:10 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 06:30:10 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 06:30:10 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 06:30:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:30:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:30:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:30:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:30:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:30:10 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 06:30:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.533
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.951
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.896
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.806
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.105
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.943
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.946
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.924
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.230
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.847
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.836
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.782


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.532841155234657
len(reference) = 277
Effective ratio: 0.237 +- 0.120
Model Accuracy over intervened graphs for r=0.5 =  0.717
SUFF_SIMPLE for r=0.5 class 1.0 = 0.702 +- 0.455 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.5 all KL = 0.532 +- 0.455 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.5 all L1 = 0.702 +- 0.349 (in-sample avg dev_std = 0.427)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9512635379061372
len(reference) = 277
Effective ratio: 0.087 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.737
SUFF_SIMPLE for r=0.8 class 1.0 = 0.713 +- 0.454 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.8 all KL = 0.532 +- 0.454 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.8 all L1 = 0.713 +- 0.339 (in-sample avg dev_std = 0.469)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.895779783393502
len(reference) = 277
Effective ratio: 0.077 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.718
SUFF_SIMPLE for r=0.9 class 1.0 = 0.696 +- 0.457 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.9 all KL = 0.521 +- 0.457 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.9 all L1 = 0.696 +- 0.348 (in-sample avg dev_std = 0.473)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8060361010830325
len(reference) = 277
Effective ratio: 0.068 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.704
SUFF_SIMPLE for r=0.95 class 1.0 = 0.681 +- 0.458 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.95 all KL = 0.494 +- 0.458 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.95 all L1 = 0.681 +- 0.346 (in-sample avg dev_std = 0.491)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.362
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10485793650793651
len(reference) = 2520
Effective ratio: 0.333 +- 0.178
Model Accuracy over intervened graphs for r=0.5 =  0.028
SUFF_SIMPLE for r=0.5 class 1.0 = 0.645 +- 0.426 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.5 all KL = 0.62 +- 0.426 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.5 all L1 = 0.645 +- 0.374 (in-sample avg dev_std = 0.238)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9433142857142858
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.029
SUFF_SIMPLE for r=0.8 class 1.0 = 0.644 +- 0.426 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.8 all KL = 0.619 +- 0.426 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.8 all L1 = 0.644 +- 0.374 (in-sample avg dev_std = 0.247)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.362
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9455095238095239
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.028
SUFF_SIMPLE for r=0.9 class 1.0 = 0.643 +- 0.427 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.9 all KL = 0.616 +- 0.427 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.9 all L1 = 0.643 +- 0.373 (in-sample avg dev_std = 0.248)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.362
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9239833333333334
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.028
SUFF_SIMPLE for r=0.95 class 1.0 = 0.644 +- 0.427 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.95 all KL = 0.618 +- 0.427 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.95 all L1 = 0.644 +- 0.374 (in-sample avg dev_std = 0.247)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.562
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.22969854132901132
len(reference) = 2464
Effective ratio: 0.481 +- 0.158
Model Accuracy over intervened graphs for r=0.5 =  0.484
SUFF_SIMPLE for r=0.5 class 1.0 = 0.538 +- 0.421 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.5 all KL = 0.454 +- 0.421 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.5 all L1 = 0.538 +- 0.352 (in-sample avg dev_std = 0.302)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8466000810372772
len(reference) = 2468
Effective ratio: 0.088 +- 0.122
Model Accuracy over intervened graphs for r=0.8 =  0.438
SUFF_SIMPLE for r=0.8 class 1.0 = 0.585 +- 0.419 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.8 all KL = 0.512 +- 0.419 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.8 all L1 = 0.585 +- 0.348 (in-sample avg dev_std = 0.325)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.562
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8357747163695299
len(reference) = 2468
Effective ratio: 0.063 +- 0.078
Model Accuracy over intervened graphs for r=0.9 =  0.429
SUFF_SIMPLE for r=0.9 class 1.0 = 0.579 +- 0.406 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.9 all KL = 0.487 +- 0.406 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.9 all L1 = 0.579 +- 0.338 (in-sample avg dev_std = 0.368)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.562
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7820020259319288
len(reference) = 2468
Effective ratio: 0.052 +- 0.060
Model Accuracy over intervened graphs for r=0.95 =  0.422
SUFF_SIMPLE for r=0.95 class 1.0 = 0.583 +- 0.403 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.95 all KL = 0.487 +- 0.403 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.95 all L1 = 0.583 +- 0.336 (in-sample avg dev_std = 0.379)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.532841155234657
len(reference) = 277
Effective ratio: 0.237 +- 0.120
Model Accuracy over intervened graphs for r=0.5 =  0.273
NEC for r=0.5 class 1.0 = 0.725 +- 0.086 (in-sample avg dev_std = 0.671)
NEC for r=0.5 all KL = 0.98 +- 0.086 (in-sample avg dev_std = 0.671)
NEC for r=0.5 all L1 = 0.725 +- 0.175 (in-sample avg dev_std = 0.671)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9512635379061372
len(reference) = 277
Effective ratio: 0.087 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.004
NEC for r=0.8 class 1.0 = 0.862 +- 0.011 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.999 +- 0.011 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.862 +- 0.021 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.895779783393502
len(reference) = 277
Effective ratio: 0.077 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.004
NEC for r=0.9 class 1.0 = 0.858 +- 0.052 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.997 +- 0.052 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.858 +- 0.050 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8060361010830325
len(reference) = 277
Effective ratio: 0.068 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.018
NEC for r=0.95 class 1.0 = 0.846 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.983 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.846 +- 0.110 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.362
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10485793650793651
len(reference) = 2520
Effective ratio: 0.333 +- 0.178
Model Accuracy over intervened graphs for r=0.5 =  0.022
NEC for r=0.5 class 1.0 = 0.358 +- 0.423 (in-sample avg dev_std = 0.201)
NEC for r=0.5 all KL = 0.382 +- 0.423 (in-sample avg dev_std = 0.201)
NEC for r=0.5 all L1 = 0.358 +- 0.374 (in-sample avg dev_std = 0.201)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9433142857142858
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.351 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.364 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.351 +- 0.385 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.362
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9455095238095239
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.351 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.364 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.351 +- 0.385 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.362
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9239833333333334
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.351 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.364 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.351 +- 0.385 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.562
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.22969854132901132
len(reference) = 2468
Effective ratio: 0.481 +- 0.158
Model Accuracy over intervened graphs for r=0.5 =  0.13
NEC for r=0.5 class 1.0 = 0.469 +- 0.422 (in-sample avg dev_std = 0.402)
NEC for r=0.5 all KL = 0.551 +- 0.422 (in-sample avg dev_std = 0.402)
NEC for r=0.5 all L1 = 0.469 +- 0.352 (in-sample avg dev_std = 0.402)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8466000810372772
len(reference) = 2468
Effective ratio: 0.088 +- 0.122
Model Accuracy over intervened graphs for r=0.8 =  0.054
NEC for r=0.8 class 1.0 = 0.489 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.546 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.489 +- 0.388 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.562
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8357747163695299
len(reference) = 2468
Effective ratio: 0.063 +- 0.078
Model Accuracy over intervened graphs for r=0.9 =  0.067
NEC for r=0.9 class 1.0 = 0.476 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.533 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.476 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.562
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7820020259319288
len(reference) = 2468
Effective ratio: 0.052 +- 0.060
Model Accuracy over intervened graphs for r=0.95 =  0.075
NEC for r=0.95 class 1.0 = 0.468 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.521 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.468 +- 0.392 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 18:35:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 06:35:52 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 06:35:52 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 06:35:52 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 06:35:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:35:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:35:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:35:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:35:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:35:52 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 06:35:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.424
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.715
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.699
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.640
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.105
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.844
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.748
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.686
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.263
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.694
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.630
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.596


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.424158844765343
len(reference) = 277
Effective ratio: 0.273 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.674
SUFF_SIMPLE for r=0.5 class 1.0 = 0.644 +- 0.466 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.5 all KL = 0.414 +- 0.466 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.5 all L1 = 0.644 +- 0.347 (in-sample avg dev_std = 0.543)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7153212996389892
len(reference) = 277
Effective ratio: 0.059 +- 0.051
Model Accuracy over intervened graphs for r=0.8 =  0.728
SUFF_SIMPLE for r=0.8 class 1.0 = 0.694 +- 0.468 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.8 all KL = 0.485 +- 0.468 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.8 all L1 = 0.694 +- 0.336 (in-sample avg dev_std = 0.555)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6993032490974729
len(reference) = 277
Effective ratio: 0.055 +- 0.045
Model Accuracy over intervened graphs for r=0.9 =  0.71
SUFF_SIMPLE for r=0.9 class 1.0 = 0.678 +- 0.469 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.9 all KL = 0.466 +- 0.469 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.9 all L1 = 0.678 +- 0.342 (in-sample avg dev_std = 0.570)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6397472924187725
len(reference) = 277
Effective ratio: 0.046 +- 0.031
Model Accuracy over intervened graphs for r=0.95 =  0.708
SUFF_SIMPLE for r=0.95 class 1.0 = 0.673 +- 0.475 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.95 all KL = 0.452 +- 0.475 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.95 all L1 = 0.673 +- 0.338 (in-sample avg dev_std = 0.577)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.637
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10522261904761906
len(reference) = 2520
Effective ratio: 0.245 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.452
SUFF_SIMPLE for r=0.5 class 1.0 = 0.614 +- 0.402 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.5 all KL = 0.489 +- 0.402 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.5 all L1 = 0.614 +- 0.305 (in-sample avg dev_std = 0.543)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8442154761904761
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.462
SUFF_SIMPLE for r=0.8 class 1.0 = 0.599 +- 0.390 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.8 all KL = 0.46 +- 0.390 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.8 all L1 = 0.599 +- 0.297 (in-sample avg dev_std = 0.564)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.747843253968254
len(reference) = 2520
Effective ratio: 0.009 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.439
SUFF_SIMPLE for r=0.9 class 1.0 = 0.585 +- 0.392 (in-sample avg dev_std = 0.580)
SUFF_SIMPLE for r=0.9 all KL = 0.443 +- 0.392 (in-sample avg dev_std = 0.580)
SUFF_SIMPLE for r=0.9 all L1 = 0.585 +- 0.296 (in-sample avg dev_std = 0.580)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.637
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6862718253968254
len(reference) = 2520
Effective ratio: 0.008 +- 0.001
Model Accuracy over intervened graphs for r=0.95 =  0.43
SUFF_SIMPLE for r=0.95 class 1.0 = 0.574 +- 0.388 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.95 all KL = 0.427 +- 0.388 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.95 all L1 = 0.574 +- 0.293 (in-sample avg dev_std = 0.591)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.796
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2632455429497569
len(reference) = 2466
Effective ratio: 0.367 +- 0.204
Model Accuracy over intervened graphs for r=0.5 =  0.616
SUFF_SIMPLE for r=0.5 class 1.0 = 0.642 +- 0.442 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.5 all KL = 0.549 +- 0.442 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.5 all L1 = 0.642 +- 0.356 (in-sample avg dev_std = 0.333)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6935741491085899
len(reference) = 2468
Effective ratio: 0.067 +- 0.113
Model Accuracy over intervened graphs for r=0.8 =  0.728
SUFF_SIMPLE for r=0.8 class 1.0 = 0.729 +- 0.410 (in-sample avg dev_std = 0.396)
SUFF_SIMPLE for r=0.8 all KL = 0.589 +- 0.410 (in-sample avg dev_std = 0.396)
SUFF_SIMPLE for r=0.8 all L1 = 0.729 +- 0.302 (in-sample avg dev_std = 0.396)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6301106158833063
len(reference) = 2468
Effective ratio: 0.054 +- 0.090
Model Accuracy over intervened graphs for r=0.9 =  0.706
SUFF_SIMPLE for r=0.9 class 1.0 = 0.719 +- 0.414 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.9 all KL = 0.582 +- 0.414 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.9 all L1 = 0.719 +- 0.306 (in-sample avg dev_std = 0.406)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.796
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.5956073743922203
len(reference) = 2468
Effective ratio: 0.046 +- 0.076
Model Accuracy over intervened graphs for r=0.95 =  0.687
SUFF_SIMPLE for r=0.95 class 1.0 = 0.699 +- 0.421 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.95 all KL = 0.567 +- 0.421 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.95 all L1 = 0.699 +- 0.316 (in-sample avg dev_std = 0.420)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.424158844765343
len(reference) = 277
Effective ratio: 0.273 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.646
NEC for r=0.5 class 1.0 = 0.387 +- 0.373 (in-sample avg dev_std = 0.541)
NEC for r=0.5 all KL = 0.728 +- 0.373 (in-sample avg dev_std = 0.541)
NEC for r=0.5 all L1 = 0.387 +- 0.319 (in-sample avg dev_std = 0.541)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7153212996389892
len(reference) = 277
Effective ratio: 0.059 +- 0.051
Model Accuracy over intervened graphs for r=0.8 =  0.022
NEC for r=0.8 class 1.0 = 0.847 +- 0.084 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.993 +- 0.084 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.847 +- 0.085 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6993032490974729
len(reference) = 277
Effective ratio: 0.055 +- 0.045
Model Accuracy over intervened graphs for r=0.9 =  0.04
NEC for r=0.9 class 1.0 = 0.829 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.97 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.829 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6397472924187725
len(reference) = 277
Effective ratio: 0.046 +- 0.031
Model Accuracy over intervened graphs for r=0.95 =  0.137
NEC for r=0.95 class 1.0 = 0.745 +- 0.319 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.878 +- 0.319 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.745 +- 0.285 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.637
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10522261904761906
len(reference) = 2520
Effective ratio: 0.245 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.3
NEC for r=0.5 class 1.0 = 0.514 +- 0.344 (in-sample avg dev_std = 0.596)
NEC for r=0.5 all KL = 0.66 +- 0.344 (in-sample avg dev_std = 0.596)
NEC for r=0.5 all L1 = 0.514 +- 0.279 (in-sample avg dev_std = 0.596)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8442154761904761
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.586 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.636 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.586 +- 0.364 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.747843253968254
len(reference) = 2520
Effective ratio: 0.009 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.586 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.636 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.586 +- 0.364 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.637
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6862718253968254
len(reference) = 2520
Effective ratio: 0.008 +- 0.001
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.586 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.636 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.586 +- 0.364 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.796
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2632455429497569
len(reference) = 2468
Effective ratio: 0.367 +- 0.204
Model Accuracy over intervened graphs for r=0.5 =  0.413
NEC for r=0.5 class 1.0 = 0.558 +- 0.350 (in-sample avg dev_std = 0.534)
NEC for r=0.5 all KL = 0.739 +- 0.350 (in-sample avg dev_std = 0.534)
NEC for r=0.5 all L1 = 0.558 +- 0.296 (in-sample avg dev_std = 0.534)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6935741491085899
len(reference) = 2468
Effective ratio: 0.067 +- 0.113
Model Accuracy over intervened graphs for r=0.8 =  0.098
NEC for r=0.8 class 1.0 = 0.681 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.779 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.681 +- 0.320 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6301106158833063
len(reference) = 2468
Effective ratio: 0.054 +- 0.090
Model Accuracy over intervened graphs for r=0.9 =  0.111
NEC for r=0.9 class 1.0 = 0.66 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.752 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.66 +- 0.337 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.796
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.5956073743922203
len(reference) = 2468
Effective ratio: 0.046 +- 0.076
Model Accuracy over intervened graphs for r=0.95 =  0.13
NEC for r=0.95 class 1.0 = 0.636 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.723 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.636 +- 0.354 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 18:41:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 06:41:31 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 06:41:31 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 06:41:31 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 06:41:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:41:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:41:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:41:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:41:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:41:31 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 06:41:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.650
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.771
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.680
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.649
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.061
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.847
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.753
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.658
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.266
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.645
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.605
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.569


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.6496931407942238
len(reference) = 277
Effective ratio: 0.189 +- 0.124
Model Accuracy over intervened graphs for r=0.5 =  0.647
SUFF_SIMPLE for r=0.5 class 1.0 = 0.638 +- 0.456 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.5 all KL = 0.425 +- 0.456 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.5 all L1 = 0.638 +- 0.357 (in-sample avg dev_std = 0.506)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.770725631768953
len(reference) = 277
Effective ratio: 0.063 +- 0.052
Model Accuracy over intervened graphs for r=0.8 =  0.638
SUFF_SIMPLE for r=0.8 class 1.0 = 0.624 +- 0.457 (in-sample avg dev_std = 0.531)
SUFF_SIMPLE for r=0.8 all KL = 0.406 +- 0.457 (in-sample avg dev_std = 0.531)
SUFF_SIMPLE for r=0.8 all L1 = 0.624 +- 0.358 (in-sample avg dev_std = 0.531)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6800794223826715
len(reference) = 277
Effective ratio: 0.057 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.653
SUFF_SIMPLE for r=0.9 class 1.0 = 0.63 +- 0.454 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.9 all KL = 0.399 +- 0.454 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.9 all L1 = 0.63 +- 0.350 (in-sample avg dev_std = 0.554)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6492238267148015
len(reference) = 277
Effective ratio: 0.053 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.641
SUFF_SIMPLE for r=0.95 class 1.0 = 0.621 +- 0.452 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.95 all KL = 0.386 +- 0.452 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.95 all L1 = 0.621 +- 0.349 (in-sample avg dev_std = 0.550)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.588
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.06138650793650794
len(reference) = 2520
Effective ratio: 0.437 +- 0.156
Model Accuracy over intervened graphs for r=0.5 =  0.183
SUFF_SIMPLE for r=0.5 class 1.0 = 0.507 +- 0.420 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.5 all KL = 0.402 +- 0.420 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.5 all L1 = 0.507 +- 0.340 (in-sample avg dev_std = 0.545)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8469876984126985
len(reference) = 2520
Effective ratio: 0.010 +- 0.004
Model Accuracy over intervened graphs for r=0.8 =  0.195
SUFF_SIMPLE for r=0.8 class 1.0 = 0.514 +- 0.419 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.8 all KL = 0.405 +- 0.419 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.8 all L1 = 0.514 +- 0.337 (in-sample avg dev_std = 0.553)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.588
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7529039682539682
len(reference) = 2520
Effective ratio: 0.009 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.184
SUFF_SIMPLE for r=0.9 class 1.0 = 0.509 +- 0.420 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.9 all KL = 0.402 +- 0.420 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.9 all L1 = 0.509 +- 0.339 (in-sample avg dev_std = 0.547)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.588
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6583392857142857
len(reference) = 2520
Effective ratio: 0.008 +- 0.004
Model Accuracy over intervened graphs for r=0.95 =  0.176
SUFF_SIMPLE for r=0.95 class 1.0 = 0.507 +- 0.424 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.95 all KL = 0.406 +- 0.424 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.95 all L1 = 0.507 +- 0.343 (in-sample avg dev_std = 0.535)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.762
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.26644854132901136
len(reference) = 2468
Effective ratio: 0.365 +- 0.169
Model Accuracy over intervened graphs for r=0.5 =  0.546
SUFF_SIMPLE for r=0.5 class 1.0 = 0.647 +- 0.447 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.5 all KL = 0.555 +- 0.447 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.5 all L1 = 0.647 +- 0.363 (in-sample avg dev_std = 0.325)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6445927876823339
len(reference) = 2468
Effective ratio: 0.074 +- 0.117
Model Accuracy over intervened graphs for r=0.8 =  0.541
SUFF_SIMPLE for r=0.8 class 1.0 = 0.652 +- 0.444 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.8 all KL = 0.558 +- 0.444 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.8 all L1 = 0.652 +- 0.358 (in-sample avg dev_std = 0.357)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6052491896272286
len(reference) = 2468
Effective ratio: 0.055 +- 0.088
Model Accuracy over intervened graphs for r=0.9 =  0.538
SUFF_SIMPLE for r=0.9 class 1.0 = 0.655 +- 0.443 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.9 all KL = 0.563 +- 0.443 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.9 all L1 = 0.655 +- 0.358 (in-sample avg dev_std = 0.360)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.762
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.5686551863857374
len(reference) = 2468
Effective ratio: 0.044 +- 0.061
Model Accuracy over intervened graphs for r=0.95 =  0.534
SUFF_SIMPLE for r=0.95 class 1.0 = 0.664 +- 0.444 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.95 all KL = 0.57 +- 0.444 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.95 all L1 = 0.664 +- 0.359 (in-sample avg dev_std = 0.358)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.6496931407942238
len(reference) = 277
Effective ratio: 0.189 +- 0.124
Model Accuracy over intervened graphs for r=0.5 =  0.177
NEC for r=0.5 class 1.0 = 0.772 +- 0.071 (in-sample avg dev_std = 0.530)
NEC for r=0.5 all KL = 0.99 +- 0.071 (in-sample avg dev_std = 0.530)
NEC for r=0.5 all L1 = 0.772 +- 0.157 (in-sample avg dev_std = 0.530)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.770725631768953
len(reference) = 277
Effective ratio: 0.063 +- 0.052
Model Accuracy over intervened graphs for r=0.8 =  0.004
NEC for r=0.8 class 1.0 = 0.859 +- 0.056 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.997 +- 0.056 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.859 +- 0.045 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6800794223826715
len(reference) = 277
Effective ratio: 0.057 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.014
NEC for r=0.9 class 1.0 = 0.851 +- 0.116 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.986 +- 0.116 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.851 +- 0.099 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6492238267148015
len(reference) = 277
Effective ratio: 0.053 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.058
NEC for r=0.95 class 1.0 = 0.818 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.951 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.818 +- 0.186 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.588
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.06138650793650794
len(reference) = 2520
Effective ratio: 0.437 +- 0.156
Model Accuracy over intervened graphs for r=0.5 =  0.18
NEC for r=0.5 class 1.0 = 0.502 +- 0.402 (in-sample avg dev_std = 0.568)
NEC for r=0.5 all KL = 0.616 +- 0.402 (in-sample avg dev_std = 0.568)
NEC for r=0.5 all L1 = 0.502 +- 0.325 (in-sample avg dev_std = 0.568)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8469876984126985
len(reference) = 2520
Effective ratio: 0.010 +- 0.004
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.533 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.583 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.533 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.588
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7529039682539682
len(reference) = 2520
Effective ratio: 0.009 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.533 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.582 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.533 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.588
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6583392857142857
len(reference) = 2520
Effective ratio: 0.008 +- 0.004
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.533 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.582 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.533 +- 0.389 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.762
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.26644854132901136
len(reference) = 2468
Effective ratio: 0.365 +- 0.169
Model Accuracy over intervened graphs for r=0.5 =  0.228
NEC for r=0.5 class 1.0 = 0.578 +- 0.365 (in-sample avg dev_std = 0.535)
NEC for r=0.5 all KL = 0.738 +- 0.365 (in-sample avg dev_std = 0.535)
NEC for r=0.5 all L1 = 0.578 +- 0.303 (in-sample avg dev_std = 0.535)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6445927876823339
len(reference) = 2468
Effective ratio: 0.074 +- 0.117
Model Accuracy over intervened graphs for r=0.8 =  0.051
NEC for r=0.8 class 1.0 = 0.652 +- 0.399 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.751 +- 0.399 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.652 +- 0.340 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6052491896272286
len(reference) = 2468
Effective ratio: 0.055 +- 0.088
Model Accuracy over intervened graphs for r=0.9 =  0.066
NEC for r=0.9 class 1.0 = 0.64 +- 0.413 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.73 +- 0.413 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.64 +- 0.350 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.762
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.5686551863857374
len(reference) = 2468
Effective ratio: 0.044 +- 0.061
Model Accuracy over intervened graphs for r=0.95 =  0.088
NEC for r=0.95 class 1.0 = 0.623 +- 0.421 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.712 +- 0.421 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.623 +- 0.359 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 18:47:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 06:47:02 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 06:47:02 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 06:47:02 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 06:47:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:47:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:47:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:47:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:47:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:47:02 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 06:47:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.665
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.818
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.706
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.639
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.094
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.929
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.881
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.824
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.288
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.774
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.696
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.621


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.6653212996389892
len(reference) = 277
Effective ratio: 0.185 +- 0.130
Model Accuracy over intervened graphs for r=0.5 =  0.658
SUFF_SIMPLE for r=0.5 class 1.0 = 0.658 +- 0.487 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.5 all KL = 0.499 +- 0.487 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.5 all L1 = 0.658 +- 0.373 (in-sample avg dev_std = 0.477)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8176606498194946
len(reference) = 277
Effective ratio: 0.066 +- 0.049
Model Accuracy over intervened graphs for r=0.8 =  0.699
SUFF_SIMPLE for r=0.8 class 1.0 = 0.678 +- 0.482 (in-sample avg dev_std = 0.538)
SUFF_SIMPLE for r=0.8 all KL = 0.485 +- 0.482 (in-sample avg dev_std = 0.538)
SUFF_SIMPLE for r=0.8 all L1 = 0.678 +- 0.350 (in-sample avg dev_std = 0.538)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7056425992779783
len(reference) = 277
Effective ratio: 0.059 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.705
SUFF_SIMPLE for r=0.9 class 1.0 = 0.689 +- 0.485 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.9 all KL = 0.512 +- 0.485 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.9 all L1 = 0.689 +- 0.353 (in-sample avg dev_std = 0.516)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.639014440433213
len(reference) = 277
Effective ratio: 0.051 +- 0.037
Model Accuracy over intervened graphs for r=0.95 =  0.703
SUFF_SIMPLE for r=0.95 class 1.0 = 0.685 +- 0.481 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.95 all KL = 0.493 +- 0.481 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.95 all L1 = 0.685 +- 0.351 (in-sample avg dev_std = 0.527)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.782
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0940670634920635
len(reference) = 2520
Effective ratio: 0.315 +- 0.134
Model Accuracy over intervened graphs for r=0.5 =  0.248
SUFF_SIMPLE for r=0.5 class 1.0 = 0.439 +- 0.393 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.5 all KL = 0.276 +- 0.393 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.5 all L1 = 0.439 +- 0.319 (in-sample avg dev_std = 0.563)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9287698412698413
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.293
SUFF_SIMPLE for r=0.8 class 1.0 = 0.464 +- 0.394 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.8 all KL = 0.291 +- 0.394 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.8 all L1 = 0.464 +- 0.318 (in-sample avg dev_std = 0.582)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.782
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8814742063492061
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.293
SUFF_SIMPLE for r=0.9 class 1.0 = 0.463 +- 0.393 (in-sample avg dev_std = 0.588)
SUFF_SIMPLE for r=0.9 all KL = 0.288 +- 0.393 (in-sample avg dev_std = 0.588)
SUFF_SIMPLE for r=0.9 all L1 = 0.463 +- 0.316 (in-sample avg dev_std = 0.588)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.782
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8236523809523809
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.29
SUFF_SIMPLE for r=0.95 class 1.0 = 0.458 +- 0.388 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.95 all KL = 0.281 +- 0.388 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.95 all L1 = 0.458 +- 0.313 (in-sample avg dev_std = 0.592)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.81
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2883565640194489
len(reference) = 2468
Effective ratio: 0.344 +- 0.192
Model Accuracy over intervened graphs for r=0.5 =  0.601
SUFF_SIMPLE for r=0.5 class 1.0 = 0.636 +- 0.446 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.5 all KL = 0.55 +- 0.446 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.5 all L1 = 0.636 +- 0.358 (in-sample avg dev_std = 0.344)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.81
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7735948136142625
len(reference) = 2468
Effective ratio: 0.072 +- 0.111
Model Accuracy over intervened graphs for r=0.8 =  0.587
SUFF_SIMPLE for r=0.8 class 1.0 = 0.648 +- 0.441 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.8 all KL = 0.557 +- 0.441 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.8 all L1 = 0.648 +- 0.348 (in-sample avg dev_std = 0.382)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6957860615883306
len(reference) = 2468
Effective ratio: 0.056 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.578
SUFF_SIMPLE for r=0.9 class 1.0 = 0.652 +- 0.438 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.9 all KL = 0.563 +- 0.438 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.9 all L1 = 0.652 +- 0.346 (in-sample avg dev_std = 0.386)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.81
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6210311993517017
len(reference) = 2468
Effective ratio: 0.047 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.579
SUFF_SIMPLE for r=0.95 class 1.0 = 0.659 +- 0.435 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.95 all KL = 0.571 +- 0.435 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.95 all L1 = 0.659 +- 0.345 (in-sample avg dev_std = 0.381)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.6653212996389892
len(reference) = 277
Effective ratio: 0.185 +- 0.130
Model Accuracy over intervened graphs for r=0.5 =  0.253
NEC for r=0.5 class 1.0 = 0.709 +- 0.196 (in-sample avg dev_std = 0.517)
NEC for r=0.5 all KL = 0.943 +- 0.196 (in-sample avg dev_std = 0.517)
NEC for r=0.5 all L1 = 0.709 +- 0.243 (in-sample avg dev_std = 0.517)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8176606498194946
len(reference) = 277
Effective ratio: 0.066 +- 0.049
Model Accuracy over intervened graphs for r=0.8 =  0.022
NEC for r=0.8 class 1.0 = 0.848 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.998 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.848 +- 0.074 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7056425992779783
len(reference) = 277
Effective ratio: 0.059 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.04
NEC for r=0.9 class 1.0 = 0.832 +- 0.133 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.98 +- 0.133 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.832 +- 0.134 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.639014440433213
len(reference) = 277
Effective ratio: 0.051 +- 0.037
Model Accuracy over intervened graphs for r=0.95 =  0.087
NEC for r=0.95 class 1.0 = 0.793 +- 0.247 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.932 +- 0.247 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.793 +- 0.223 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.782
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0940670634920635
len(reference) = 2520
Effective ratio: 0.315 +- 0.134
Model Accuracy over intervened graphs for r=0.5 =  0.353
NEC for r=0.5 class 1.0 = 0.515 +- 0.360 (in-sample avg dev_std = 0.668)
NEC for r=0.5 all KL = 0.727 +- 0.360 (in-sample avg dev_std = 0.668)
NEC for r=0.5 all L1 = 0.515 +- 0.281 (in-sample avg dev_std = 0.668)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9287698412698413
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.694 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.777 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.694 +- 0.317 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.782
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8814742063492061
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.694 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.777 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.694 +- 0.317 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.782
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8236523809523809
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.001
NEC for r=0.95 class 1.0 = 0.693 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.776 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.693 +- 0.317 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.81
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2883565640194489
len(reference) = 2468
Effective ratio: 0.344 +- 0.192
Model Accuracy over intervened graphs for r=0.5 =  0.238
NEC for r=0.5 class 1.0 = 0.595 +- 0.369 (in-sample avg dev_std = 0.497)
NEC for r=0.5 all KL = 0.725 +- 0.369 (in-sample avg dev_std = 0.497)
NEC for r=0.5 all L1 = 0.595 +- 0.304 (in-sample avg dev_std = 0.497)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.81
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7735948136142625
len(reference) = 2468
Effective ratio: 0.072 +- 0.111
Model Accuracy over intervened graphs for r=0.8 =  0.072
NEC for r=0.8 class 1.0 = 0.664 +- 0.385 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.762 +- 0.385 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.664 +- 0.329 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6957860615883306
len(reference) = 2468
Effective ratio: 0.056 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.091
NEC for r=0.9 class 1.0 = 0.646 +- 0.401 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.739 +- 0.401 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.646 +- 0.342 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.81
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6210311993517017
len(reference) = 2468
Effective ratio: 0.047 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.113
NEC for r=0.95 class 1.0 = 0.626 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.713 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.626 +- 0.356 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 18:52:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 06:52:25 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 06:52:25 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 06:52:25 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 06:52:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:52:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:52:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:52:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:52:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:52:25 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 06:52:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.536
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.942
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.877
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.799
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.151
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.923
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.936
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.933
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.236
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.833
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.820
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.731


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5360938628158844
len(reference) = 277
Effective ratio: 0.241 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.671
SUFF_SIMPLE for r=0.5 class 1.0 = 0.665 +- 0.473 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.5 all KL = 0.474 +- 0.473 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.5 all L1 = 0.665 +- 0.365 (in-sample avg dev_std = 0.473)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.941797833935018
len(reference) = 277
Effective ratio: 0.089 +- 0.066
Model Accuracy over intervened graphs for r=0.8 =  0.716
SUFF_SIMPLE for r=0.8 class 1.0 = 0.696 +- 0.478 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.8 all KL = 0.502 +- 0.478 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.8 all L1 = 0.696 +- 0.349 (in-sample avg dev_std = 0.506)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8772490974729241
len(reference) = 277
Effective ratio: 0.075 +- 0.050
Model Accuracy over intervened graphs for r=0.9 =  0.709
SUFF_SIMPLE for r=0.9 class 1.0 = 0.688 +- 0.474 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.9 all KL = 0.482 +- 0.474 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.9 all L1 = 0.688 +- 0.348 (in-sample avg dev_std = 0.518)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7993682310469314
len(reference) = 277
Effective ratio: 0.065 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.718
SUFF_SIMPLE for r=0.95 class 1.0 = 0.696 +- 0.477 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.95 all KL = 0.493 +- 0.477 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.95 all L1 = 0.696 +- 0.345 (in-sample avg dev_std = 0.521)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.508
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.15098968253968256
len(reference) = 2520
Effective ratio: 0.197 +- 0.104
Model Accuracy over intervened graphs for r=0.5 =  0.009
SUFF_SIMPLE for r=0.5 class 1.0 = 0.519 +- 0.438 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.5 all KL = 0.494 +- 0.438 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.5 all L1 = 0.519 +- 0.378 (in-sample avg dev_std = 0.157)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9233301587301586
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.01
SUFF_SIMPLE for r=0.8 class 1.0 = 0.519 +- 0.439 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.8 all KL = 0.494 +- 0.439 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.8 all L1 = 0.519 +- 0.378 (in-sample avg dev_std = 0.160)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.508
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9362694444444446
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.009
SUFF_SIMPLE for r=0.9 class 1.0 = 0.519 +- 0.439 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.9 all KL = 0.494 +- 0.439 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.9 all L1 = 0.519 +- 0.379 (in-sample avg dev_std = 0.159)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.508
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9327579365079364
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.009
SUFF_SIMPLE for r=0.95 class 1.0 = 0.519 +- 0.439 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.95 all KL = 0.494 +- 0.439 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.95 all L1 = 0.519 +- 0.379 (in-sample avg dev_std = 0.157)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.913
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2356600486223663
len(reference) = 2468
Effective ratio: 0.439 +- 0.136
Model Accuracy over intervened graphs for r=0.5 =  0.701
SUFF_SIMPLE for r=0.5 class 1.0 = 0.719 +- 0.458 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.5 all KL = 0.651 +- 0.458 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.5 all L1 = 0.719 +- 0.379 (in-sample avg dev_std = 0.222)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.913
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8331892220421393
len(reference) = 2468
Effective ratio: 0.071 +- 0.085
Model Accuracy over intervened graphs for r=0.8 =  0.703
SUFF_SIMPLE for r=0.8 class 1.0 = 0.725 +- 0.457 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.8 all KL = 0.656 +- 0.457 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.8 all L1 = 0.725 +- 0.375 (in-sample avg dev_std = 0.257)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8197504051863859
len(reference) = 2468
Effective ratio: 0.056 +- 0.063
Model Accuracy over intervened graphs for r=0.9 =  0.7
SUFF_SIMPLE for r=0.9 class 1.0 = 0.726 +- 0.455 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.9 all KL = 0.653 +- 0.455 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.9 all L1 = 0.726 +- 0.372 (in-sample avg dev_std = 0.287)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.913
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7309874392220422
len(reference) = 2468
Effective ratio: 0.047 +- 0.051
Model Accuracy over intervened graphs for r=0.95 =  0.7
SUFF_SIMPLE for r=0.95 class 1.0 = 0.729 +- 0.451 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.95 all KL = 0.654 +- 0.451 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.95 all L1 = 0.729 +- 0.368 (in-sample avg dev_std = 0.300)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5360938628158844
len(reference) = 277
Effective ratio: 0.241 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.35
NEC for r=0.5 class 1.0 = 0.664 +- 0.157 (in-sample avg dev_std = 0.687)
NEC for r=0.5 all KL = 0.965 +- 0.157 (in-sample avg dev_std = 0.687)
NEC for r=0.5 all L1 = 0.664 +- 0.226 (in-sample avg dev_std = 0.687)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.941797833935018
len(reference) = 277
Effective ratio: 0.089 +- 0.066
Model Accuracy over intervened graphs for r=0.8 =  0.018
NEC for r=0.8 class 1.0 = 0.852 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.993 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.852 +- 0.082 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8772490974729241
len(reference) = 277
Effective ratio: 0.075 +- 0.050
Model Accuracy over intervened graphs for r=0.9 =  0.025
NEC for r=0.9 class 1.0 = 0.845 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.983 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.845 +- 0.118 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7993682310469314
len(reference) = 277
Effective ratio: 0.065 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.043
NEC for r=0.95 class 1.0 = 0.83 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.965 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.83 +- 0.163 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.508
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.15098968253968256
len(reference) = 2520
Effective ratio: 0.197 +- 0.104
Model Accuracy over intervened graphs for r=0.5 =  0.012
NEC for r=0.5 class 1.0 = 0.479 +- 0.437 (in-sample avg dev_std = 0.135)
NEC for r=0.5 all KL = 0.504 +- 0.437 (in-sample avg dev_std = 0.135)
NEC for r=0.5 all L1 = 0.479 +- 0.377 (in-sample avg dev_std = 0.135)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9233301587301586
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.483 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.505 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.483 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.508
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9362694444444446
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.483 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.505 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.483 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.508
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9327579365079364
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.483 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.505 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.483 +- 0.382 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.913
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2356600486223663
len(reference) = 2468
Effective ratio: 0.439 +- 0.136
Model Accuracy over intervened graphs for r=0.5 =  0.52
NEC for r=0.5 class 1.0 = 0.453 +- 0.380 (in-sample avg dev_std = 0.579)
NEC for r=0.5 all KL = 0.713 +- 0.380 (in-sample avg dev_std = 0.579)
NEC for r=0.5 all L1 = 0.453 +- 0.316 (in-sample avg dev_std = 0.579)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.913
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8331892220421393
len(reference) = 2468
Effective ratio: 0.071 +- 0.085
Model Accuracy over intervened graphs for r=0.8 =  0.12
NEC for r=0.8 class 1.0 = 0.716 +- 0.328 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.856 +- 0.328 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.716 +- 0.290 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8197504051863859
len(reference) = 2468
Effective ratio: 0.056 +- 0.063
Model Accuracy over intervened graphs for r=0.9 =  0.122
NEC for r=0.9 class 1.0 = 0.714 +- 0.334 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.851 +- 0.334 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.714 +- 0.294 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.913
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7309874392220422
len(reference) = 2468
Effective ratio: 0.047 +- 0.051
Model Accuracy over intervened graphs for r=0.95 =  0.129
NEC for r=0.95 class 1.0 = 0.705 +- 0.346 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.84 +- 0.346 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.705 +- 0.302 (in-sample avg dev_std = 0.000)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.428, 0.419, 0.423, 0.429], 'all_L1': [0.635, 0.633, 0.635, 0.64]}), defaultdict(<class 'list'>, {'all_KL': [0.497, 0.504, 0.504, 0.503], 'all_L1': [0.667, 0.676, 0.681, 0.688]}), defaultdict(<class 'list'>, {'all_KL': [0.486, 0.51, 0.493, 0.497], 'all_L1': [0.661, 0.684, 0.689, 0.687]}), defaultdict(<class 'list'>, {'all_KL': [0.445, 0.425, 0.418, 0.404], 'all_L1': [0.666, 0.658, 0.654, 0.652]}), defaultdict(<class 'list'>, {'all_KL': [0.499, 0.495, 0.493, 0.52], 'all_L1': [0.67, 0.681, 0.68, 0.696]}), defaultdict(<class 'list'>, {'all_KL': [0.532, 0.532, 0.521, 0.494], 'all_L1': [0.702, 0.713, 0.696, 0.681]}), defaultdict(<class 'list'>, {'all_KL': [0.414, 0.485, 0.466, 0.452], 'all_L1': [0.644, 0.694, 0.678, 0.673]}), defaultdict(<class 'list'>, {'all_KL': [0.425, 0.406, 0.399, 0.386], 'all_L1': [0.638, 0.624, 0.63, 0.621]}), defaultdict(<class 'list'>, {'all_KL': [0.499, 0.485, 0.512, 0.493], 'all_L1': [0.658, 0.678, 0.689, 0.685]}), defaultdict(<class 'list'>, {'all_KL': [0.474, 0.502, 0.482, 0.493], 'all_L1': [0.665, 0.696, 0.688, 0.696]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.871, 0.993, 0.982, 0.926], 'all_L1': [0.554, 0.854, 0.845, 0.796]}), defaultdict(<class 'list'>, {'all_KL': [0.888, 0.998, 0.987, 0.96], 'all_L1': [0.564, 0.858, 0.843, 0.824]}), defaultdict(<class 'list'>, {'all_KL': [0.863, 0.958, 0.942, 0.908], 'all_L1': [0.61, 0.797, 0.757, 0.727]}), defaultdict(<class 'list'>, {'all_KL': [0.949, 1.0, 0.996, 0.991], 'all_L1': [0.658, 0.863, 0.859, 0.854]}), defaultdict(<class 'list'>, {'all_KL': [0.913, 0.993, 0.968, 0.933], 'all_L1': [0.712, 0.855, 0.835, 0.803]}), defaultdict(<class 'list'>, {'all_KL': [0.98, 0.999, 0.997, 0.983], 'all_L1': [0.725, 0.862, 0.858, 0.846]}), defaultdict(<class 'list'>, {'all_KL': [0.728, 0.993, 0.97, 0.878], 'all_L1': [0.387, 0.847, 0.829, 0.745]}), defaultdict(<class 'list'>, {'all_KL': [0.99, 0.997, 0.986, 0.951], 'all_L1': [0.772, 0.859, 0.851, 0.818]}), defaultdict(<class 'list'>, {'all_KL': [0.943, 0.998, 0.98, 0.932], 'all_L1': [0.709, 0.848, 0.832, 0.793]}), defaultdict(<class 'list'>, {'all_KL': [0.965, 0.993, 0.983, 0.965], 'all_L1': [0.664, 0.852, 0.845, 0.83]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.516, 0.502, 0.501, 0.504], 'all_L1': [0.595, 0.581, 0.58, 0.577]}), defaultdict(<class 'list'>, {'all_KL': [0.301, 0.297, 0.293, 0.298], 'all_L1': [0.405, 0.409, 0.406, 0.408]}), defaultdict(<class 'list'>, {'all_KL': [0.168, 0.19, 0.193, 0.196], 'all_L1': [0.338, 0.358, 0.36, 0.359]}), defaultdict(<class 'list'>, {'all_KL': [0.232, 0.232, 0.232, 0.232], 'all_L1': [0.305, 0.306, 0.306, 0.306]}), defaultdict(<class 'list'>, {'all_KL': [0.479, 0.472, 0.475, 0.47], 'all_L1': [0.578, 0.572, 0.567, 0.561]}), defaultdict(<class 'list'>, {'all_KL': [0.62, 0.619, 0.616, 0.618], 'all_L1': [0.645, 0.644, 0.643, 0.644]}), defaultdict(<class 'list'>, {'all_KL': [0.489, 0.46, 0.443, 0.427], 'all_L1': [0.614, 0.599, 0.585, 0.574]}), defaultdict(<class 'list'>, {'all_KL': [0.402, 0.405, 0.402, 0.406], 'all_L1': [0.507, 0.514, 0.509, 0.507]}), defaultdict(<class 'list'>, {'all_KL': [0.276, 0.291, 0.288, 0.281], 'all_L1': [0.439, 0.464, 0.463, 0.458]}), defaultdict(<class 'list'>, {'all_KL': [0.494, 0.494, 0.494, 0.494], 'all_L1': [0.519, 0.519, 0.519, 0.519]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.496, 0.459, 0.459, 0.459], 'all_L1': [0.408, 0.428, 0.428, 0.428]}), defaultdict(<class 'list'>, {'all_KL': [0.712, 0.772, 0.772, 0.771], 'all_L1': [0.572, 0.707, 0.707, 0.707]}), defaultdict(<class 'list'>, {'all_KL': [0.86, 0.872, 0.872, 0.872], 'all_L1': [0.666, 0.769, 0.769, 0.769]}), defaultdict(<class 'list'>, {'all_KL': [0.768, 0.768, 0.768, 0.768], 'all_L1': [0.691, 0.698, 0.698, 0.698]}), defaultdict(<class 'list'>, {'all_KL': [0.544, 0.497, 0.497, 0.497], 'all_L1': [0.454, 0.468, 0.468, 0.468]}), defaultdict(<class 'list'>, {'all_KL': [0.382, 0.364, 0.364, 0.364], 'all_L1': [0.358, 0.351, 0.351, 0.351]}), defaultdict(<class 'list'>, {'all_KL': [0.66, 0.636, 0.636, 0.636], 'all_L1': [0.514, 0.586, 0.586, 0.586]}), defaultdict(<class 'list'>, {'all_KL': [0.616, 0.583, 0.582, 0.582], 'all_L1': [0.502, 0.533, 0.533, 0.533]}), defaultdict(<class 'list'>, {'all_KL': [0.727, 0.777, 0.777, 0.776], 'all_L1': [0.515, 0.694, 0.694, 0.693]}), defaultdict(<class 'list'>, {'all_KL': [0.504, 0.505, 0.505, 0.505], 'all_L1': [0.479, 0.483, 0.483, 0.483]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.591, 0.562, 0.553, 0.553], 'all_L1': [0.665, 0.685, 0.68, 0.675]}), defaultdict(<class 'list'>, {'all_KL': [0.534, 0.532, 0.54, 0.559], 'all_L1': [0.606, 0.616, 0.626, 0.643]}), defaultdict(<class 'list'>, {'all_KL': [0.529, 0.56, 0.563, 0.579], 'all_L1': [0.599, 0.63, 0.634, 0.646]}), defaultdict(<class 'list'>, {'all_KL': [0.646, 0.657, 0.664, 0.658], 'all_L1': [0.7, 0.707, 0.712, 0.71]}), defaultdict(<class 'list'>, {'all_KL': [0.546, 0.509, 0.506, 0.51], 'all_L1': [0.612, 0.609, 0.614, 0.621]}), defaultdict(<class 'list'>, {'all_KL': [0.454, 0.512, 0.487, 0.487], 'all_L1': [0.538, 0.585, 0.579, 0.583]}), defaultdict(<class 'list'>, {'all_KL': [0.549, 0.589, 0.582, 0.567], 'all_L1': [0.642, 0.729, 0.719, 0.699]}), defaultdict(<class 'list'>, {'all_KL': [0.555, 0.558, 0.563, 0.57], 'all_L1': [0.647, 0.652, 0.655, 0.664]}), defaultdict(<class 'list'>, {'all_KL': [0.55, 0.557, 0.563, 0.571], 'all_L1': [0.636, 0.648, 0.652, 0.659]}), defaultdict(<class 'list'>, {'all_KL': [0.651, 0.656, 0.653, 0.654], 'all_L1': [0.719, 0.725, 0.726, 0.729]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.725, 0.766, 0.736, 0.71], 'all_L1': [0.525, 0.662, 0.64, 0.618]}), defaultdict(<class 'list'>, {'all_KL': [0.682, 0.7, 0.678, 0.649], 'all_L1': [0.55, 0.614, 0.597, 0.576]}), defaultdict(<class 'list'>, {'all_KL': [0.619, 0.664, 0.639, 0.623], 'all_L1': [0.505, 0.586, 0.564, 0.55]}), defaultdict(<class 'list'>, {'all_KL': [0.792, 0.833, 0.823, 0.808], 'all_L1': [0.654, 0.731, 0.721, 0.707]}), defaultdict(<class 'list'>, {'all_KL': [0.679, 0.695, 0.664, 0.645], 'all_L1': [0.542, 0.614, 0.592, 0.578]}), defaultdict(<class 'list'>, {'all_KL': [0.551, 0.546, 0.533, 0.521], 'all_L1': [0.469, 0.489, 0.476, 0.468]}), defaultdict(<class 'list'>, {'all_KL': [0.739, 0.779, 0.752, 0.723], 'all_L1': [0.558, 0.681, 0.66, 0.636]}), defaultdict(<class 'list'>, {'all_KL': [0.738, 0.751, 0.73, 0.712], 'all_L1': [0.578, 0.652, 0.64, 0.623]}), defaultdict(<class 'list'>, {'all_KL': [0.725, 0.762, 0.739, 0.713], 'all_L1': [0.595, 0.664, 0.646, 0.626]}), defaultdict(<class 'list'>, {'all_KL': [0.713, 0.856, 0.851, 0.84], 'all_L1': [0.453, 0.716, 0.714, 0.705]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.661 +- 0.018, 0.674 +- 0.026, 0.672 +- 0.022, 0.672 +- 0.024
suff_simple class all_KL  =  0.470 +- 0.038, 0.476 +- 0.041, 0.471 +- 0.041, 0.467 +- 0.044
suff_simple_acc_int  =  0.670 +- 0.020, 0.698 +- 0.026, 0.697 +- 0.018, 0.697 +- 0.025
nec class all_L1  =  0.635 +- 0.106, 0.849 +- 0.018, 0.835 +- 0.028, 0.804 +- 0.039
nec class all_KL  =  0.909 +- 0.074, 0.992 +- 0.012, 0.979 +- 0.015, 0.943 +- 0.033
nec_acc_int  =  0.360 +- 0.135, 0.018 +- 0.026, 0.036 +- 0.043, 0.074 +- 0.052

Eval split val
suff_simple class all_L1  =  0.495 +- 0.112, 0.497 +- 0.105, 0.494 +- 0.103, 0.491 +- 0.102
suff_simple class all_KL  =  0.398 +- 0.139, 0.396 +- 0.131, 0.394 +- 0.130, 0.393 +- 0.129
suff_simple_acc_int  =  0.182 +- 0.134, 0.193 +- 0.141, 0.188 +- 0.136, 0.184 +- 0.133
nec class all_L1  =  0.516 +- 0.099, 0.572 +- 0.133, 0.572 +- 0.133, 0.572 +- 0.133
nec class all_KL  =  0.627 +- 0.138, 0.623 +- 0.160, 0.623 +- 0.160, 0.623 +- 0.159
nec_acc_int  =  0.176 +- 0.119, 0.000 +- 0.000, 0.000 +- 0.000, 0.001 +- 0.001

Eval split test
suff_simple class all_L1  =  0.636 +- 0.049, 0.659 +- 0.048, 0.660 +- 0.046, 0.663 +- 0.041
suff_simple class all_KL  =  0.560 +- 0.055, 0.569 +- 0.049, 0.567 +- 0.053, 0.571 +- 0.051
suff_simple_acc_int  =  0.585 +- 0.054, 0.600 +- 0.083, 0.592 +- 0.079, 0.584 +- 0.077
nec class all_L1  =  0.543 +- 0.056, 0.641 +- 0.066, 0.625 +- 0.069, 0.609 +- 0.067
nec class all_KL  =  0.696 +- 0.065, 0.735 +- 0.085, 0.714 +- 0.087, 0.694 +- 0.087
nec_acc_int  =  0.301 +- 0.112, 0.078 +- 0.026, 0.091 +- 0.024, 0.109 +- 0.023


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.648 +- 0.057, 0.762 +- 0.015, 0.754 +- 0.015, 0.738 +- 0.021
Faith. Armon (L1)= 		  =  0.643 +- 0.065, 0.751 +- 0.017, 0.744 +- 0.015, 0.731 +- 0.020
Faith. GMean (L1)= 	  =  0.646 +- 0.061, 0.756 +- 0.016, 0.749 +- 0.015, 0.734 +- 0.021
Faith. Aritm (KL)= 		  =  0.689 +- 0.048, 0.734 +- 0.020, 0.725 +- 0.020, 0.705 +- 0.026
Faith. Armon (KL)= 		  =  0.618 +- 0.043, 0.642 +- 0.038, 0.635 +- 0.037, 0.623 +- 0.040
Faith. GMean (KL)= 	  =  0.653 +- 0.044, 0.687 +- 0.029, 0.678 +- 0.029, 0.663 +- 0.033

Eval split val
Faith. Aritm (L1)= 		  =  0.505 +- 0.022, 0.534 +- 0.034, 0.533 +- 0.033, 0.531 +- 0.032
Faith. Armon (L1)= 		  =  0.484 +- 0.036, 0.507 +- 0.045, 0.505 +- 0.043, 0.504 +- 0.042
Faith. GMean (L1)= 	  =  0.494 +- 0.027, 0.520 +- 0.037, 0.519 +- 0.036, 0.517 +- 0.035
Faith. Aritm (KL)= 		  =  0.512 +- 0.021, 0.510 +- 0.023, 0.508 +- 0.022, 0.508 +- 0.021
Faith. Armon (KL)= 		  =  0.450 +- 0.080, 0.445 +- 0.064, 0.444 +- 0.062, 0.443 +- 0.060
Faith. GMean (KL)= 	  =  0.478 +- 0.050, 0.475 +- 0.036, 0.473 +- 0.033, 0.473 +- 0.031

Eval split test
Faith. Aritm (L1)= 		  =  0.590 +- 0.043, 0.650 +- 0.055, 0.642 +- 0.056, 0.636 +- 0.054
Faith. Armon (L1)= 		  =  0.584 +- 0.044, 0.649 +- 0.056, 0.641 +- 0.057, 0.634 +- 0.055
Faith. GMean (L1)= 	  =  0.587 +- 0.043, 0.649 +- 0.056, 0.642 +- 0.057, 0.635 +- 0.054
Faith. Aritm (KL)= 		  =  0.628 +- 0.057, 0.652 +- 0.064, 0.641 +- 0.068, 0.633 +- 0.067
Faith. Armon (KL)= 		  =  0.620 +- 0.056, 0.641 +- 0.062, 0.632 +- 0.066, 0.626 +- 0.064
Faith. GMean (KL)= 	  =  0.624 +- 0.056, 0.646 +- 0.063, 0.636 +- 0.067, 0.629 +- 0.066
Computed for split load_split = id



Completed in  0:54:05.660110  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 18:57:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 06:57:50 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 06:57:50 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 06:57:50 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 06:57:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:57:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:57:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:57:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 06:57:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 06:57:50 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 06:57:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.088
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.029
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.029
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.029
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.103
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.045
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.040
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.037


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08793862815884478
len(reference) = 277
Effective ratio: 0.266 +- 0.168
Model Accuracy over intervened graphs for r=0.5 =  0.723
SUFF_SIMPLE for r=0.5 class 1.0 = 0.674 +- 0.419 (in-sample avg dev_std = 0.559)
SUFF_SIMPLE for r=0.5 all KL = 0.364 +- 0.419 (in-sample avg dev_std = 0.559)
SUFF_SIMPLE for r=0.5 all L1 = 0.674 +- 0.306 (in-sample avg dev_std = 0.559)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02931046931407942
len(reference) = 277
Effective ratio: 0.023 +- 0.029
Model Accuracy over intervened graphs for r=0.8 =  0.682
SUFF_SIMPLE for r=0.8 class 1.0 = 0.641 +- 0.430 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.8 all KL = 0.356 +- 0.430 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.8 all L1 = 0.641 +- 0.320 (in-sample avg dev_std = 0.601)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.029270758122743684
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.674
SUFF_SIMPLE for r=0.9 class 1.0 = 0.625 +- 0.417 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.9 all KL = 0.322 +- 0.417 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.9 all L1 = 0.625 +- 0.315 (in-sample avg dev_std = 0.615)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.029270758122743684
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  0.677
SUFF_SIMPLE for r=0.95 class 1.0 = 0.629 +- 0.417 (in-sample avg dev_std = 0.617)
SUFF_SIMPLE for r=0.95 all KL = 0.324 +- 0.417 (in-sample avg dev_std = 0.617)
SUFF_SIMPLE for r=0.95 all L1 = 0.629 +- 0.315 (in-sample avg dev_std = 0.617)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.458
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012482539682539684
len(reference) = 2520
Effective ratio: 0.316 +- 0.146
Model Accuracy over intervened graphs for r=0.5 =  0.126
SUFF_SIMPLE for r=0.5 class 1.0 = 0.581 +- 0.441 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.5 all KL = 0.507 +- 0.441 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.5 all L1 = 0.581 +- 0.362 (in-sample avg dev_std = 0.449)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004179761904761905
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.129
SUFF_SIMPLE for r=0.8 class 1.0 = 0.581 +- 0.439 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.8 all KL = 0.505 +- 0.439 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.8 all L1 = 0.581 +- 0.359 (in-sample avg dev_std = 0.465)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.458
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004336507936507937
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.129
SUFF_SIMPLE for r=0.9 class 1.0 = 0.581 +- 0.440 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.9 all KL = 0.505 +- 0.440 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.9 all L1 = 0.581 +- 0.361 (in-sample avg dev_std = 0.458)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.458
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004336507936507937
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.129
SUFF_SIMPLE for r=0.95 class 1.0 = 0.581 +- 0.440 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.95 all KL = 0.505 +- 0.440 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.95 all L1 = 0.581 +- 0.361 (in-sample avg dev_std = 0.458)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.778
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10253808752025932
len(reference) = 2453
Effective ratio: 0.450 +- 0.196
Model Accuracy over intervened graphs for r=0.5 =  0.573
SUFF_SIMPLE for r=0.5 class 1.0 = 0.649 +- 0.405 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.5 all KL = 0.455 +- 0.405 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.5 all L1 = 0.649 +- 0.305 (in-sample avg dev_std = 0.505)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.778
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0451114262560778
len(reference) = 2468
Effective ratio: 0.035 +- 0.072
Model Accuracy over intervened graphs for r=0.8 =  0.493
SUFF_SIMPLE for r=0.8 class 1.0 = 0.589 +- 0.373 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.8 all KL = 0.363 +- 0.373 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.8 all L1 = 0.589 +- 0.302 (in-sample avg dev_std = 0.553)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.778
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03955145867098865
len(reference) = 2468
Effective ratio: 0.028 +- 0.056
Model Accuracy over intervened graphs for r=0.9 =  0.495
SUFF_SIMPLE for r=0.9 class 1.0 = 0.591 +- 0.376 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.9 all KL = 0.369 +- 0.376 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.9 all L1 = 0.591 +- 0.304 (in-sample avg dev_std = 0.551)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.778
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03711831442463533
len(reference) = 2468
Effective ratio: 0.026 +- 0.049
Model Accuracy over intervened graphs for r=0.95 =  0.488
SUFF_SIMPLE for r=0.95 class 1.0 = 0.591 +- 0.374 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.95 all KL = 0.369 +- 0.374 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.95 all L1 = 0.591 +- 0.303 (in-sample avg dev_std = 0.555)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08793862815884478
len(reference) = 277
Effective ratio: 0.266 +- 0.168
Model Accuracy over intervened graphs for r=0.5 =  0.864
NEC for r=0.5 class 1.0 = 0.174 +- 0.438 (in-sample avg dev_std = 0.424)
NEC for r=0.5 all KL = 0.333 +- 0.438 (in-sample avg dev_std = 0.424)
NEC for r=0.5 all L1 = 0.174 +- 0.269 (in-sample avg dev_std = 0.424)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02931046931407942
len(reference) = 277
Effective ratio: 0.023 +- 0.029
Model Accuracy over intervened graphs for r=0.8 =  0.993
NEC for r=0.8 class 1.0 = 0.006 +- 0.085 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.008 +- 0.085 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.006 +- 0.069 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.029270758122743684
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 1.0 = 0.003 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.005 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.003 +- 0.046 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.029270758122743684
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  0.996
NEC for r=0.95 class 1.0 = 0.003 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.005 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.003 +- 0.046 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.458
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012482539682539684
len(reference) = 2520
Effective ratio: 0.316 +- 0.146
Model Accuracy over intervened graphs for r=0.5 =  0.281
NEC for r=0.5 class 1.0 = 0.304 +- 0.401 (in-sample avg dev_std = 0.407)
NEC for r=0.5 all KL = 0.372 +- 0.401 (in-sample avg dev_std = 0.407)
NEC for r=0.5 all L1 = 0.304 +- 0.324 (in-sample avg dev_std = 0.407)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004179761904761905
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.455
NEC for r=0.8 class 1.0 = 0.029 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.011 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.029 +- 0.085 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.458
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004336507936507937
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.455
NEC for r=0.9 class 1.0 = 0.028 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.011 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.028 +- 0.085 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.458
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004336507936507937
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.455
NEC for r=0.95 class 1.0 = 0.028 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.011 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.028 +- 0.085 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.778
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10253808752025932
len(reference) = 2468
Effective ratio: 0.450 +- 0.196
Model Accuracy over intervened graphs for r=0.5 =  0.632
NEC for r=0.5 class 1.0 = 0.239 +- 0.398 (in-sample avg dev_std = 0.358)
NEC for r=0.5 all KL = 0.344 +- 0.398 (in-sample avg dev_std = 0.358)
NEC for r=0.5 all L1 = 0.239 +- 0.298 (in-sample avg dev_std = 0.358)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.778
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0451114262560778
len(reference) = 2468
Effective ratio: 0.035 +- 0.072
Model Accuracy over intervened graphs for r=0.8 =  0.765
NEC for r=0.8 class 1.0 = 0.048 +- 0.200 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.051 +- 0.200 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.048 +- 0.169 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.778
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03955145867098865
len(reference) = 2468
Effective ratio: 0.028 +- 0.056
Model Accuracy over intervened graphs for r=0.9 =  0.768
NEC for r=0.9 class 1.0 = 0.04 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.042 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.04 +- 0.154 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.778
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03711831442463533
len(reference) = 2468
Effective ratio: 0.026 +- 0.049
Model Accuracy over intervened graphs for r=0.95 =  0.769
NEC for r=0.95 class 1.0 = 0.04 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.042 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.04 +- 0.156 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 19:03:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 07:03:31 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 07:03:31 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 07:03:31 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 07:03:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:03:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:03:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:03:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:03:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:03:31 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 07:03:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 76 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.082
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.024
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.024
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.023
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.101
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.044
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.038
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.037


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08242960288808664
len(reference) = 277
Effective ratio: 0.296 +- 0.169
Model Accuracy over intervened graphs for r=0.5 =  0.765
SUFF_SIMPLE for r=0.5 class 1.0 = 0.695 +- 0.416 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.5 all KL = 0.39 +- 0.416 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.5 all L1 = 0.695 +- 0.282 (in-sample avg dev_std = 0.577)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02425992779783394
len(reference) = 277
Effective ratio: 0.026 +- 0.034
Model Accuracy over intervened graphs for r=0.8 =  0.731
SUFF_SIMPLE for r=0.8 class 1.0 = 0.667 +- 0.420 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.8 all KL = 0.372 +- 0.420 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.8 all L1 = 0.667 +- 0.291 (in-sample avg dev_std = 0.615)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.024220216606498198
len(reference) = 277
Effective ratio: 0.023 +- 0.029
Model Accuracy over intervened graphs for r=0.9 =  0.731
SUFF_SIMPLE for r=0.9 class 1.0 = 0.668 +- 0.417 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.9 all KL = 0.372 +- 0.417 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.9 all L1 = 0.668 +- 0.292 (in-sample avg dev_std = 0.612)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02327436823104693
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.95 =  0.733
SUFF_SIMPLE for r=0.95 class 1.0 = 0.67 +- 0.409 (in-sample avg dev_std = 0.610)
SUFF_SIMPLE for r=0.95 all KL = 0.374 +- 0.409 (in-sample avg dev_std = 0.610)
SUFF_SIMPLE for r=0.95 all L1 = 0.67 +- 0.294 (in-sample avg dev_std = 0.610)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.788
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012992063492063492
len(reference) = 2520
Effective ratio: 0.288 +- 0.095
Model Accuracy over intervened graphs for r=0.5 =  0.249
SUFF_SIMPLE for r=0.5 class 1.0 = 0.414 +- 0.358 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.5 all KL = 0.298 +- 0.358 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.5 all L1 = 0.414 +- 0.287 (in-sample avg dev_std = 0.546)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004023015873015873
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.248
SUFF_SIMPLE for r=0.8 class 1.0 = 0.412 +- 0.355 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.8 all KL = 0.295 +- 0.355 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.8 all L1 = 0.412 +- 0.284 (in-sample avg dev_std = 0.547)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.788
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.003926587301587302
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.254
SUFF_SIMPLE for r=0.9 class 1.0 = 0.414 +- 0.353 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.9 all KL = 0.296 +- 0.353 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.9 all L1 = 0.414 +- 0.285 (in-sample avg dev_std = 0.551)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.788
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.003926587301587302
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.254
SUFF_SIMPLE for r=0.95 class 1.0 = 0.414 +- 0.353 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.95 all KL = 0.296 +- 0.353 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.95 all L1 = 0.414 +- 0.285 (in-sample avg dev_std = 0.551)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.734
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10083022690437601
len(reference) = 2450
Effective ratio: 0.369 +- 0.188
Model Accuracy over intervened graphs for r=0.5 =  0.539
SUFF_SIMPLE for r=0.5 class 1.0 = 0.614 +- 0.385 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.5 all KL = 0.453 +- 0.385 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.5 all L1 = 0.614 +- 0.285 (in-sample avg dev_std = 0.557)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.735
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.044486223662884926
len(reference) = 2468
Effective ratio: 0.036 +- 0.070
Model Accuracy over intervened graphs for r=0.8 =  0.44
SUFF_SIMPLE for r=0.8 class 1.0 = 0.533 +- 0.353 (in-sample avg dev_std = 0.603)
SUFF_SIMPLE for r=0.8 all KL = 0.344 +- 0.353 (in-sample avg dev_std = 0.603)
SUFF_SIMPLE for r=0.8 all L1 = 0.533 +- 0.267 (in-sample avg dev_std = 0.603)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03843881685575364
len(reference) = 2468
Effective ratio: 0.027 +- 0.051
Model Accuracy over intervened graphs for r=0.9 =  0.437
SUFF_SIMPLE for r=0.9 class 1.0 = 0.534 +- 0.348 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.9 all KL = 0.345 +- 0.348 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.9 all L1 = 0.534 +- 0.265 (in-sample avg dev_std = 0.613)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.735
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.037037682333873584
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.95 =  0.434
SUFF_SIMPLE for r=0.95 class 1.0 = 0.533 +- 0.346 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.95 all KL = 0.341 +- 0.346 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.95 all L1 = 0.533 +- 0.262 (in-sample avg dev_std = 0.614)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08242960288808664
len(reference) = 277
Effective ratio: 0.296 +- 0.169
Model Accuracy over intervened graphs for r=0.5 =  0.893
NEC for r=0.5 class 1.0 = 0.14 +- 0.405 (in-sample avg dev_std = 0.396)
NEC for r=0.5 all KL = 0.278 +- 0.405 (in-sample avg dev_std = 0.396)
NEC for r=0.5 all L1 = 0.14 +- 0.240 (in-sample avg dev_std = 0.396)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02425992779783394
len(reference) = 277
Effective ratio: 0.026 +- 0.034
Model Accuracy over intervened graphs for r=0.8 =  0.996
NEC for r=0.8 class 1.0 = 0.004 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.005 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.004 +- 0.052 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.024220216606498198
len(reference) = 277
Effective ratio: 0.023 +- 0.029
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 1.0 = 0.004 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.005 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.004 +- 0.052 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02327436823104693
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.95 =  0.996
NEC for r=0.95 class 1.0 = 0.004 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.005 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.004 +- 0.052 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.788
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012992063492063492
len(reference) = 2520
Effective ratio: 0.288 +- 0.095
Model Accuracy over intervened graphs for r=0.5 =  0.436
NEC for r=0.5 class 1.0 = 0.448 +- 0.370 (in-sample avg dev_std = 0.528)
NEC for r=0.5 all KL = 0.556 +- 0.370 (in-sample avg dev_std = 0.528)
NEC for r=0.5 all L1 = 0.448 +- 0.295 (in-sample avg dev_std = 0.528)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004023015873015873
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.777
NEC for r=0.8 class 1.0 = 0.041 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.016 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.041 +- 0.104 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.788
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.003926587301587302
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.777
NEC for r=0.9 class 1.0 = 0.041 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.016 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.041 +- 0.104 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.788
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.003926587301587302
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.777
NEC for r=0.95 class 1.0 = 0.041 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.016 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.041 +- 0.104 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.735
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10083022690437601
len(reference) = 2468
Effective ratio: 0.369 +- 0.188
Model Accuracy over intervened graphs for r=0.5 =  0.578
NEC for r=0.5 class 1.0 = 0.278 +- 0.400 (in-sample avg dev_std = 0.373)
NEC for r=0.5 all KL = 0.357 +- 0.400 (in-sample avg dev_std = 0.373)
NEC for r=0.5 all L1 = 0.278 +- 0.305 (in-sample avg dev_std = 0.373)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.735
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.044486223662884926
len(reference) = 2468
Effective ratio: 0.036 +- 0.070
Model Accuracy over intervened graphs for r=0.8 =  0.729
NEC for r=0.8 class 1.0 = 0.04 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.042 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.04 +- 0.149 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03843881685575364
len(reference) = 2468
Effective ratio: 0.027 +- 0.051
Model Accuracy over intervened graphs for r=0.9 =  0.73
NEC for r=0.9 class 1.0 = 0.034 +- 0.161 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.034 +- 0.161 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.034 +- 0.135 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.735
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.037037682333873584
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.95 =  0.73
NEC for r=0.95 class 1.0 = 0.034 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.033 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.034 +- 0.136 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 19:08:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 07:08:56 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 07:08:56 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 07:08:56 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 07:08:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:08:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:08:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:08:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:08:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:08:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 07:08:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.086
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.039
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.039
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.040
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.044
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.038
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.036


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08564620938628159
len(reference) = 277
Effective ratio: 0.226 +- 0.133
Model Accuracy over intervened graphs for r=0.5 =  0.755
SUFF_SIMPLE for r=0.5 class 1.0 = 0.715 +- 0.439 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.5 all KL = 0.429 +- 0.439 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.5 all L1 = 0.715 +- 0.310 (in-sample avg dev_std = 0.509)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.038844765342960295
len(reference) = 277
Effective ratio: 0.023 +- 0.026
Model Accuracy over intervened graphs for r=0.8 =  0.74
SUFF_SIMPLE for r=0.8 class 1.0 = 0.699 +- 0.456 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.8 all KL = 0.42 +- 0.456 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.8 all L1 = 0.699 +- 0.311 (in-sample avg dev_std = 0.556)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03942960288808664
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.739
SUFF_SIMPLE for r=0.9 class 1.0 = 0.689 +- 0.443 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.9 all KL = 0.389 +- 0.443 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.9 all L1 = 0.689 +- 0.306 (in-sample avg dev_std = 0.583)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03974007220216606
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.95 =  0.735
SUFF_SIMPLE for r=0.95 class 1.0 = 0.689 +- 0.450 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.95 all KL = 0.395 +- 0.450 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.95 all L1 = 0.689 +- 0.308 (in-sample avg dev_std = 0.581)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.874
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012588888888888889
len(reference) = 2520
Effective ratio: 0.204 +- 0.118
Model Accuracy over intervened graphs for r=0.5 =  0.231
SUFF_SIMPLE for r=0.5 class 1.0 = 0.365 +- 0.348 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.5 all KL = 0.187 +- 0.348 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.5 all L1 = 0.365 +- 0.295 (in-sample avg dev_std = 0.552)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.235
SUFF_SIMPLE for r=0.8 class 1.0 = 0.366 +- 0.344 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.8 all KL = 0.184 +- 0.344 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.8 all L1 = 0.366 +- 0.293 (in-sample avg dev_std = 0.558)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.236
SUFF_SIMPLE for r=0.9 class 1.0 = 0.364 +- 0.343 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.9 all KL = 0.184 +- 0.343 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.9 all L1 = 0.364 +- 0.292 (in-sample avg dev_std = 0.562)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.874
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.236
SUFF_SIMPLE for r=0.95 class 1.0 = 0.364 +- 0.343 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.95 all KL = 0.184 +- 0.343 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.95 all L1 = 0.364 +- 0.292 (in-sample avg dev_std = 0.562)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.742
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10006361426256079
len(reference) = 2448
Effective ratio: 0.433 +- 0.174
Model Accuracy over intervened graphs for r=0.5 =  0.505
SUFF_SIMPLE for r=0.5 class 1.0 = 0.602 +- 0.386 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.5 all KL = 0.467 +- 0.386 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.5 all L1 = 0.602 +- 0.297 (in-sample avg dev_std = 0.522)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.741
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.044401539708265804
len(reference) = 2468
Effective ratio: 0.035 +- 0.067
Model Accuracy over intervened graphs for r=0.8 =  0.454
SUFF_SIMPLE for r=0.8 class 1.0 = 0.552 +- 0.359 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.8 all KL = 0.398 +- 0.359 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.8 all L1 = 0.552 +- 0.282 (in-sample avg dev_std = 0.570)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03819448946515397
len(reference) = 2468
Effective ratio: 0.028 +- 0.055
Model Accuracy over intervened graphs for r=0.9 =  0.455
SUFF_SIMPLE for r=0.9 class 1.0 = 0.553 +- 0.356 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.9 all KL = 0.398 +- 0.356 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.9 all L1 = 0.553 +- 0.281 (in-sample avg dev_std = 0.574)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.741
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.036159643435980555
len(reference) = 2468
Effective ratio: 0.026 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.451
SUFF_SIMPLE for r=0.95 class 1.0 = 0.55 +- 0.355 (in-sample avg dev_std = 0.575)
SUFF_SIMPLE for r=0.95 all KL = 0.395 +- 0.355 (in-sample avg dev_std = 0.575)
SUFF_SIMPLE for r=0.95 all L1 = 0.55 +- 0.281 (in-sample avg dev_std = 0.575)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08564620938628159
len(reference) = 277
Effective ratio: 0.226 +- 0.133
Model Accuracy over intervened graphs for r=0.5 =  0.867
NEC for r=0.5 class 1.0 = 0.144 +- 0.412 (in-sample avg dev_std = 0.326)
NEC for r=0.5 all KL = 0.255 +- 0.412 (in-sample avg dev_std = 0.326)
NEC for r=0.5 all L1 = 0.144 +- 0.272 (in-sample avg dev_std = 0.326)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.038844765342960295
len(reference) = 277
Effective ratio: 0.023 +- 0.026
Model Accuracy over intervened graphs for r=0.8 =  0.986
NEC for r=0.8 class 1.0 = 0.015 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.019 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.015 +- 0.106 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03942960288808664
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.986
NEC for r=0.9 class 1.0 = 0.015 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.02 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.015 +- 0.106 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03974007220216606
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.95 =  0.986
NEC for r=0.95 class 1.0 = 0.015 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.02 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.015 +- 0.106 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.874
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012588888888888889
len(reference) = 2520
Effective ratio: 0.204 +- 0.118
Model Accuracy over intervened graphs for r=0.5 =  0.502
NEC for r=0.5 class 1.0 = 0.398 +- 0.450 (in-sample avg dev_std = 0.439)
NEC for r=0.5 all KL = 0.549 +- 0.450 (in-sample avg dev_std = 0.439)
NEC for r=0.5 all L1 = 0.398 +- 0.357 (in-sample avg dev_std = 0.439)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.864
NEC for r=0.8 class 1.0 = 0.026 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.016 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.026 +- 0.097 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.864
NEC for r=0.9 class 1.0 = 0.025 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.016 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.025 +- 0.096 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.874
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.864
NEC for r=0.95 class 1.0 = 0.025 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.016 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.025 +- 0.096 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.741
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10006361426256079
len(reference) = 2468
Effective ratio: 0.433 +- 0.174
Model Accuracy over intervened graphs for r=0.5 =  0.603
NEC for r=0.5 class 1.0 = 0.257 +- 0.372 (in-sample avg dev_std = 0.357)
NEC for r=0.5 all KL = 0.316 +- 0.372 (in-sample avg dev_std = 0.357)
NEC for r=0.5 all L1 = 0.257 +- 0.294 (in-sample avg dev_std = 0.357)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.741
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.044401539708265804
len(reference) = 2468
Effective ratio: 0.035 +- 0.067
Model Accuracy over intervened graphs for r=0.8 =  0.722
NEC for r=0.8 class 1.0 = 0.05 +- 0.190 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.048 +- 0.190 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.05 +- 0.161 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03819448946515397
len(reference) = 2468
Effective ratio: 0.028 +- 0.055
Model Accuracy over intervened graphs for r=0.9 =  0.724
NEC for r=0.9 class 1.0 = 0.042 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.041 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.042 +- 0.150 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.741
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.036159643435980555
len(reference) = 2468
Effective ratio: 0.026 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.725
NEC for r=0.95 class 1.0 = 0.041 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.04 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.041 +- 0.149 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 19:14:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 07:14:23 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 07:14:23 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 07:14:23 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 07:14:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:14:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:14:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:14:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:14:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:14:23 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 07:14:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.085
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.028
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.025
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.025
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.049
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.039
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.038


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08533574007220215
len(reference) = 277
Effective ratio: 0.284 +- 0.166
Model Accuracy over intervened graphs for r=0.5 =  0.614
SUFF_SIMPLE for r=0.5 class 1.0 = 0.546 +- 0.314 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.5 all KL = 0.187 +- 0.314 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.5 all L1 = 0.546 +- 0.283 (in-sample avg dev_std = 0.649)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.027989169675090252
len(reference) = 277
Effective ratio: 0.026 +- 0.042
Model Accuracy over intervened graphs for r=0.8 =  0.57
SUFF_SIMPLE for r=0.8 class 1.0 = 0.507 +- 0.268 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.8 all KL = 0.136 +- 0.268 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.8 all L1 = 0.507 +- 0.273 (in-sample avg dev_std = 0.694)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.024624548736462092
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.576
SUFF_SIMPLE for r=0.9 class 1.0 = 0.521 +- 0.294 (in-sample avg dev_std = 0.667)
SUFF_SIMPLE for r=0.9 all KL = 0.17 +- 0.294 (in-sample avg dev_std = 0.667)
SUFF_SIMPLE for r=0.9 all L1 = 0.521 +- 0.291 (in-sample avg dev_std = 0.667)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.025379061371841153
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  0.566
SUFF_SIMPLE for r=0.95 class 1.0 = 0.505 +- 0.288 (in-sample avg dev_std = 0.690)
SUFF_SIMPLE for r=0.95 all KL = 0.154 +- 0.288 (in-sample avg dev_std = 0.690)
SUFF_SIMPLE for r=0.95 all L1 = 0.505 +- 0.280 (in-sample avg dev_std = 0.690)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.775
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012614682539682542
len(reference) = 2520
Effective ratio: 0.158 +- 0.057
Model Accuracy over intervened graphs for r=0.5 =  0.013
SUFF_SIMPLE for r=0.5 class 1.0 = 0.306 +- 0.366 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.5 all KL = 0.232 +- 0.366 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.5 all L1 = 0.306 +- 0.296 (in-sample avg dev_std = 0.186)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.003830555555555555
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.013
SUFF_SIMPLE for r=0.8 class 1.0 = 0.306 +- 0.367 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.8 all KL = 0.232 +- 0.367 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.8 all L1 = 0.306 +- 0.296 (in-sample avg dev_std = 0.187)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0036873015873015867
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.012
SUFF_SIMPLE for r=0.9 class 1.0 = 0.306 +- 0.367 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.9 all KL = 0.232 +- 0.367 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.9 all L1 = 0.306 +- 0.296 (in-sample avg dev_std = 0.179)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.775
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0036873015873015867
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.012
SUFF_SIMPLE for r=0.95 class 1.0 = 0.306 +- 0.367 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.95 all KL = 0.232 +- 0.367 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.95 all L1 = 0.306 +- 0.296 (in-sample avg dev_std = 0.183)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.845
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09989019448946516
len(reference) = 2466
Effective ratio: 0.309 +- 0.216
Model Accuracy over intervened graphs for r=0.5 =  0.433
SUFF_SIMPLE for r=0.5 class 1.0 = 0.502 +- 0.355 (in-sample avg dev_std = 0.630)
SUFF_SIMPLE for r=0.5 all KL = 0.313 +- 0.355 (in-sample avg dev_std = 0.630)
SUFF_SIMPLE for r=0.5 all L1 = 0.502 +- 0.276 (in-sample avg dev_std = 0.630)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.845
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04850283630470016
len(reference) = 2468
Effective ratio: 0.038 +- 0.072
Model Accuracy over intervened graphs for r=0.8 =  0.408
SUFF_SIMPLE for r=0.8 class 1.0 = 0.48 +- 0.339 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.8 all KL = 0.282 +- 0.339 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.8 all L1 = 0.48 +- 0.266 (in-sample avg dev_std = 0.655)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03907779578606159
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.405
SUFF_SIMPLE for r=0.9 class 1.0 = 0.479 +- 0.338 (in-sample avg dev_std = 0.651)
SUFF_SIMPLE for r=0.9 all KL = 0.283 +- 0.338 (in-sample avg dev_std = 0.651)
SUFF_SIMPLE for r=0.9 all L1 = 0.479 +- 0.269 (in-sample avg dev_std = 0.651)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.845
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03779659643435981
len(reference) = 2468
Effective ratio: 0.025 +- 0.044
Model Accuracy over intervened graphs for r=0.95 =  0.408
SUFF_SIMPLE for r=0.95 class 1.0 = 0.479 +- 0.338 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.95 all KL = 0.281 +- 0.338 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.95 all L1 = 0.479 +- 0.266 (in-sample avg dev_std = 0.655)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08533574007220215
len(reference) = 277
Effective ratio: 0.284 +- 0.166
Model Accuracy over intervened graphs for r=0.5 =  0.822
NEC for r=0.5 class 1.0 = 0.219 +- 0.437 (in-sample avg dev_std = 0.461)
NEC for r=0.5 all KL = 0.412 +- 0.437 (in-sample avg dev_std = 0.461)
NEC for r=0.5 all L1 = 0.219 +- 0.290 (in-sample avg dev_std = 0.461)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.027989169675090252
len(reference) = 277
Effective ratio: 0.026 +- 0.042
Model Accuracy over intervened graphs for r=0.8 =  0.993
NEC for r=0.8 class 1.0 = 0.012 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.025 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.012 +- 0.079 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.024624548736462092
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  1.0
NEC for r=0.9 class 1.0 = 0.005 +- 0.073 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.013 +- 0.073 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.005 +- 0.028 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.025379061371841153
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  1.0
NEC for r=0.95 class 1.0 = 0.005 +- 0.073 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.013 +- 0.073 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.005 +- 0.028 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.775
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012614682539682542
len(reference) = 2520
Effective ratio: 0.158 +- 0.057
Model Accuracy over intervened graphs for r=0.5 =  0.133
NEC for r=0.5 class 1.0 = 0.618 +- 0.388 (in-sample avg dev_std = 0.321)
NEC for r=0.5 all KL = 0.711 +- 0.388 (in-sample avg dev_std = 0.321)
NEC for r=0.5 all L1 = 0.618 +- 0.318 (in-sample avg dev_std = 0.321)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.003830555555555555
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.752
NEC for r=0.8 class 1.0 = 0.045 +- 0.102 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.022 +- 0.102 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.045 +- 0.120 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0036873015873015867
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.753
NEC for r=0.9 class 1.0 = 0.043 +- 0.098 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.021 +- 0.098 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.043 +- 0.117 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.775
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0036873015873015867
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.753
NEC for r=0.95 class 1.0 = 0.043 +- 0.098 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.021 +- 0.098 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.043 +- 0.117 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.845
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09989019448946516
len(reference) = 2468
Effective ratio: 0.309 +- 0.216
Model Accuracy over intervened graphs for r=0.5 =  0.57
NEC for r=0.5 class 1.0 = 0.318 +- 0.433 (in-sample avg dev_std = 0.369)
NEC for r=0.5 all KL = 0.405 +- 0.433 (in-sample avg dev_std = 0.369)
NEC for r=0.5 all L1 = 0.318 +- 0.341 (in-sample avg dev_std = 0.369)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.845
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04850283630470016
len(reference) = 2468
Effective ratio: 0.038 +- 0.072
Model Accuracy over intervened graphs for r=0.8 =  0.806
NEC for r=0.8 class 1.0 = 0.057 +- 0.226 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.067 +- 0.226 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.057 +- 0.184 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03907779578606159
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.819
NEC for r=0.9 class 1.0 = 0.044 +- 0.195 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.051 +- 0.195 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.044 +- 0.158 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.845
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03779659643435981
len(reference) = 2468
Effective ratio: 0.025 +- 0.044
Model Accuracy over intervened graphs for r=0.95 =  0.82
NEC for r=0.95 class 1.0 = 0.043 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.049 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.043 +- 0.156 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 19:19:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 07:19:51 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 07:19:51 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 07:19:51 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 07:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:19:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:19:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:19:51 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 07:19:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.024
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.025
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.025
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.098
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.043
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.037
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.036


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07673646209386281
len(reference) = 277
Effective ratio: 0.187 +- 0.136
Model Accuracy over intervened graphs for r=0.5 =  0.81
SUFF_SIMPLE for r=0.5 class 1.0 = 0.762 +- 0.448 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.5 all KL = 0.533 +- 0.448 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.5 all L1 = 0.762 +- 0.284 (in-sample avg dev_std = 0.545)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.024451263537906137
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.8 =  0.792
SUFF_SIMPLE for r=0.8 class 1.0 = 0.729 +- 0.438 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.8 all KL = 0.462 +- 0.438 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.8 all L1 = 0.729 +- 0.278 (in-sample avg dev_std = 0.613)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02471480144404332
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.9 =  0.791
SUFF_SIMPLE for r=0.9 class 1.0 = 0.723 +- 0.437 (in-sample avg dev_std = 0.620)
SUFF_SIMPLE for r=0.9 all KL = 0.461 +- 0.437 (in-sample avg dev_std = 0.620)
SUFF_SIMPLE for r=0.9 all L1 = 0.723 +- 0.283 (in-sample avg dev_std = 0.620)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02471480144404332
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.95 =  0.801
SUFF_SIMPLE for r=0.95 class 1.0 = 0.732 +- 0.435 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.95 all KL = 0.461 +- 0.435 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.95 all L1 = 0.732 +- 0.271 (in-sample avg dev_std = 0.616)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.497
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012023412698412698
len(reference) = 2519
Effective ratio: 0.207 +- 0.130
Model Accuracy over intervened graphs for r=0.5 =  0.308
SUFF_SIMPLE for r=0.5 class 1.0 = 0.579 +- 0.409 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.5 all KL = 0.486 +- 0.409 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.5 all L1 = 0.579 +- 0.323 (in-sample avg dev_std = 0.556)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004024603174603175
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.31
SUFF_SIMPLE for r=0.8 class 1.0 = 0.575 +- 0.405 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.8 all KL = 0.477 +- 0.405 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.8 all L1 = 0.575 +- 0.319 (in-sample avg dev_std = 0.569)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.497
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004051587301587301
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.311
SUFF_SIMPLE for r=0.9 class 1.0 = 0.576 +- 0.405 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.9 all KL = 0.475 +- 0.405 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.9 all L1 = 0.576 +- 0.318 (in-sample avg dev_std = 0.570)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.497
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004051587301587301
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.312
SUFF_SIMPLE for r=0.95 class 1.0 = 0.578 +- 0.407 (in-sample avg dev_std = 0.565)
SUFF_SIMPLE for r=0.95 all KL = 0.48 +- 0.407 (in-sample avg dev_std = 0.565)
SUFF_SIMPLE for r=0.95 all L1 = 0.578 +- 0.320 (in-sample avg dev_std = 0.565)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.754
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09792463533225283
len(reference) = 2428
Effective ratio: 0.385 +- 0.265
Model Accuracy over intervened graphs for r=0.5 =  0.566
SUFF_SIMPLE for r=0.5 class 1.0 = 0.637 +- 0.393 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.5 all KL = 0.498 +- 0.393 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.5 all L1 = 0.637 +- 0.297 (in-sample avg dev_std = 0.503)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.745
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04330794165316046
len(reference) = 2468
Effective ratio: 0.033 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.615
SUFF_SIMPLE for r=0.8 class 1.0 = 0.607 +- 0.353 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.8 all KL = 0.402 +- 0.353 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.8 all L1 = 0.607 +- 0.259 (in-sample avg dev_std = 0.608)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.037397487844408425
len(reference) = 2468
Effective ratio: 0.026 +- 0.051
Model Accuracy over intervened graphs for r=0.9 =  0.617
SUFF_SIMPLE for r=0.9 class 1.0 = 0.594 +- 0.341 (in-sample avg dev_std = 0.627)
SUFF_SIMPLE for r=0.9 all KL = 0.378 +- 0.341 (in-sample avg dev_std = 0.627)
SUFF_SIMPLE for r=0.9 all L1 = 0.594 +- 0.253 (in-sample avg dev_std = 0.627)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.745
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03567544570502431
len(reference) = 2468
Effective ratio: 0.025 +- 0.045
Model Accuracy over intervened graphs for r=0.95 =  0.619
SUFF_SIMPLE for r=0.95 class 1.0 = 0.596 +- 0.342 (in-sample avg dev_std = 0.626)
SUFF_SIMPLE for r=0.95 all KL = 0.38 +- 0.342 (in-sample avg dev_std = 0.626)
SUFF_SIMPLE for r=0.95 all L1 = 0.596 +- 0.253 (in-sample avg dev_std = 0.626)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07673646209386281
len(reference) = 277
Effective ratio: 0.187 +- 0.136
Model Accuracy over intervened graphs for r=0.5 =  0.907
NEC for r=0.5 class 1.0 = 0.103 +- 0.355 (in-sample avg dev_std = 0.281)
NEC for r=0.5 all KL = 0.176 +- 0.355 (in-sample avg dev_std = 0.281)
NEC for r=0.5 all L1 = 0.103 +- 0.235 (in-sample avg dev_std = 0.281)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.024451263537906137
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.8 =  0.996
NEC for r=0.8 class 1.0 = 0.005 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.008 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.005 +- 0.058 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02471480144404332
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 1.0 = 0.005 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.008 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.005 +- 0.058 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02471480144404332
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.95 =  0.996
NEC for r=0.95 class 1.0 = 0.005 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.008 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.005 +- 0.058 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.497
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012023412698412698
len(reference) = 2520
Effective ratio: 0.207 +- 0.130
Model Accuracy over intervened graphs for r=0.5 =  0.44
NEC for r=0.5 class 1.0 = 0.291 +- 0.378 (in-sample avg dev_std = 0.357)
NEC for r=0.5 all KL = 0.324 +- 0.378 (in-sample avg dev_std = 0.357)
NEC for r=0.5 all L1 = 0.291 +- 0.316 (in-sample avg dev_std = 0.357)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004024603174603175
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.493
NEC for r=0.8 class 1.0 = 0.034 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.013 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.034 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.497
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004051587301587301
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.493
NEC for r=0.9 class 1.0 = 0.034 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.012 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.034 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.497
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004051587301587301
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.493
NEC for r=0.95 class 1.0 = 0.034 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.012 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.034 +- 0.091 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.745
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09792463533225283
len(reference) = 2468
Effective ratio: 0.385 +- 0.265
Model Accuracy over intervened graphs for r=0.5 =  0.677
NEC for r=0.5 class 1.0 = 0.23 +- 0.374 (in-sample avg dev_std = 0.350)
NEC for r=0.5 all KL = 0.294 +- 0.374 (in-sample avg dev_std = 0.350)
NEC for r=0.5 all L1 = 0.23 +- 0.286 (in-sample avg dev_std = 0.350)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.745
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04330794165316046
len(reference) = 2468
Effective ratio: 0.033 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.738
NEC for r=0.8 class 1.0 = 0.043 +- 0.183 (in-sample avg dev_std = 0.002)
NEC for r=0.8 all KL = 0.043 +- 0.183 (in-sample avg dev_std = 0.002)
NEC for r=0.8 all L1 = 0.043 +- 0.157 (in-sample avg dev_std = 0.002)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.037397487844408425
len(reference) = 2468
Effective ratio: 0.026 +- 0.051
Model Accuracy over intervened graphs for r=0.9 =  0.736
NEC for r=0.9 class 1.0 = 0.04 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.04 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.04 +- 0.148 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.745
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03567544570502431
len(reference) = 2468
Effective ratio: 0.025 +- 0.045
Model Accuracy over intervened graphs for r=0.95 =  0.735
NEC for r=0.95 class 1.0 = 0.038 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.038 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.038 +- 0.145 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 19:25:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 07:25:08 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 07:25:08 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 07:25:08 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 07:25:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:25:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:25:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:25:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:25:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:25:08 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 07:25:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.079
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.029
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.021
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.021
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.003
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.003
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.003
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.099
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.043
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.034
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.031


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07925270758122743
len(reference) = 277
Effective ratio: 0.262 +- 0.148
Model Accuracy over intervened graphs for r=0.5 =  0.596
SUFF_SIMPLE for r=0.5 class 1.0 = 0.52 +- 0.259 (in-sample avg dev_std = 0.690)
SUFF_SIMPLE for r=0.5 all KL = 0.148 +- 0.259 (in-sample avg dev_std = 0.690)
SUFF_SIMPLE for r=0.5 all L1 = 0.52 +- 0.256 (in-sample avg dev_std = 0.690)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02926714801444043
len(reference) = 277
Effective ratio: 0.025 +- 0.034
Model Accuracy over intervened graphs for r=0.8 =  0.584
SUFF_SIMPLE for r=0.8 class 1.0 = 0.507 +- 0.252 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.8 all KL = 0.138 +- 0.252 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.8 all L1 = 0.507 +- 0.256 (in-sample avg dev_std = 0.719)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.021375451263537903
len(reference) = 277
Effective ratio: 0.022 +- 0.024
Model Accuracy over intervened graphs for r=0.9 =  0.574
SUFF_SIMPLE for r=0.9 class 1.0 = 0.503 +- 0.258 (in-sample avg dev_std = 0.704)
SUFF_SIMPLE for r=0.9 all KL = 0.145 +- 0.258 (in-sample avg dev_std = 0.704)
SUFF_SIMPLE for r=0.9 all L1 = 0.503 +- 0.262 (in-sample avg dev_std = 0.704)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.020916967509025268
len(reference) = 277
Effective ratio: 0.020 +- 0.018
Model Accuracy over intervened graphs for r=0.95 =  0.583
SUFF_SIMPLE for r=0.95 class 1.0 = 0.502 +- 0.241 (in-sample avg dev_std = 0.729)
SUFF_SIMPLE for r=0.95 all KL = 0.132 +- 0.241 (in-sample avg dev_std = 0.729)
SUFF_SIMPLE for r=0.95 all L1 = 0.502 +- 0.252 (in-sample avg dev_std = 0.729)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.362
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012303968253968255
len(reference) = 2519
Effective ratio: 0.282 +- 0.182
Model Accuracy over intervened graphs for r=0.5 =  0.017
SUFF_SIMPLE for r=0.5 class 1.0 = 0.645 +- 0.428 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.5 all KL = 0.624 +- 0.428 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.5 all L1 = 0.645 +- 0.378 (in-sample avg dev_std = 0.196)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0033551587301587304
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.018
SUFF_SIMPLE for r=0.8 class 1.0 = 0.644 +- 0.427 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.8 all KL = 0.621 +- 0.427 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.8 all L1 = 0.644 +- 0.377 (in-sample avg dev_std = 0.205)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.362
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0029444444444444444
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.018
SUFF_SIMPLE for r=0.9 class 1.0 = 0.647 +- 0.428 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.9 all KL = 0.624 +- 0.428 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.9 all L1 = 0.647 +- 0.377 (in-sample avg dev_std = 0.203)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.362
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0029444444444444444
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.018
SUFF_SIMPLE for r=0.95 class 1.0 = 0.647 +- 0.428 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.95 all KL = 0.624 +- 0.428 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.95 all L1 = 0.647 +- 0.377 (in-sample avg dev_std = 0.203)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.562
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0994967585089141
len(reference) = 2457
Effective ratio: 0.526 +- 0.189
Model Accuracy over intervened graphs for r=0.5 =  0.268
SUFF_SIMPLE for r=0.5 class 1.0 = 0.553 +- 0.401 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.5 all KL = 0.451 +- 0.401 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.5 all L1 = 0.553 +- 0.326 (in-sample avg dev_std = 0.480)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04309805510534846
len(reference) = 2468
Effective ratio: 0.039 +- 0.074
Model Accuracy over intervened graphs for r=0.8 =  0.221
SUFF_SIMPLE for r=0.8 class 1.0 = 0.51 +- 0.382 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.8 all KL = 0.391 +- 0.382 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.8 all L1 = 0.51 +- 0.310 (in-sample avg dev_std = 0.549)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.562
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.033601296596434356
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.214
SUFF_SIMPLE for r=0.9 class 1.0 = 0.509 +- 0.379 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.9 all KL = 0.39 +- 0.379 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.9 all L1 = 0.509 +- 0.311 (in-sample avg dev_std = 0.551)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.562
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03141247974068071
len(reference) = 2468
Effective ratio: 0.024 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.217
SUFF_SIMPLE for r=0.95 class 1.0 = 0.505 +- 0.377 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.95 all KL = 0.384 +- 0.377 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.95 all L1 = 0.505 +- 0.309 (in-sample avg dev_std = 0.557)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07925270758122743
len(reference) = 277
Effective ratio: 0.262 +- 0.148
Model Accuracy over intervened graphs for r=0.5 =  0.825
NEC for r=0.5 class 1.0 = 0.217 +- 0.437 (in-sample avg dev_std = 0.455)
NEC for r=0.5 all KL = 0.395 +- 0.437 (in-sample avg dev_std = 0.455)
NEC for r=0.5 all L1 = 0.217 +- 0.288 (in-sample avg dev_std = 0.455)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02926714801444043
len(reference) = 277
Effective ratio: 0.025 +- 0.034
Model Accuracy over intervened graphs for r=0.8 =  0.989
NEC for r=0.8 class 1.0 = 0.014 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.022 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.014 +- 0.093 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.021375451263537903
len(reference) = 277
Effective ratio: 0.022 +- 0.024
Model Accuracy over intervened graphs for r=0.9 =  0.993
NEC for r=0.9 class 1.0 = 0.009 +- 0.102 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.016 +- 0.102 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.009 +- 0.070 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.020916967509025268
len(reference) = 277
Effective ratio: 0.020 +- 0.018
Model Accuracy over intervened graphs for r=0.95 =  0.993
NEC for r=0.95 class 1.0 = 0.009 +- 0.102 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.016 +- 0.102 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.009 +- 0.070 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.362
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012303968253968255
len(reference) = 2520
Effective ratio: 0.282 +- 0.182
Model Accuracy over intervened graphs for r=0.5 =  0.153
NEC for r=0.5 class 1.0 = 0.275 +- 0.371 (in-sample avg dev_std = 0.229)
NEC for r=0.5 all KL = 0.289 +- 0.371 (in-sample avg dev_std = 0.229)
NEC for r=0.5 all L1 = 0.275 +- 0.328 (in-sample avg dev_std = 0.229)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0033551587301587304
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.358
NEC for r=0.8 class 1.0 = 0.031 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.01 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.031 +- 0.086 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.362
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0029444444444444444
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.359
NEC for r=0.9 class 1.0 = 0.03 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.01 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.03 +- 0.086 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.362
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0029444444444444444
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.359
NEC for r=0.95 class 1.0 = 0.03 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.01 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.03 +- 0.086 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.562
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0994967585089141
len(reference) = 2468
Effective ratio: 0.526 +- 0.189
Model Accuracy over intervened graphs for r=0.5 =  0.34
NEC for r=0.5 class 1.0 = 0.346 +- 0.399 (in-sample avg dev_std = 0.402)
NEC for r=0.5 all KL = 0.415 +- 0.399 (in-sample avg dev_std = 0.402)
NEC for r=0.5 all L1 = 0.346 +- 0.324 (in-sample avg dev_std = 0.402)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04309805510534846
len(reference) = 2468
Effective ratio: 0.039 +- 0.074
Model Accuracy over intervened graphs for r=0.8 =  0.534
NEC for r=0.8 class 1.0 = 0.062 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.061 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.062 +- 0.181 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.562
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.033601296596434356
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.548
NEC for r=0.9 class 1.0 = 0.046 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.044 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.562
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03141247974068071
len(reference) = 2468
Effective ratio: 0.024 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.548
NEC for r=0.95 class 1.0 = 0.045 +- 0.173 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.042 +- 0.173 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.045 +- 0.149 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 19:30:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 07:30:43 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 07:30:43 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 07:30:43 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:30:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:30:43 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 07:30:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.081
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.028
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.029
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.029
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.005
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.005
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.005
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.042
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.038
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.037


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08138989169675091
len(reference) = 277
Effective ratio: 0.247 +- 0.131
Model Accuracy over intervened graphs for r=0.5 =  0.795
SUFF_SIMPLE for r=0.5 class 1.0 = 0.749 +- 0.447 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.5 all KL = 0.485 +- 0.447 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.5 all L1 = 0.749 +- 0.291 (in-sample avg dev_std = 0.516)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.028498194945848376
len(reference) = 277
Effective ratio: 0.022 +- 0.026
Model Accuracy over intervened graphs for r=0.8 =  0.766
SUFF_SIMPLE for r=0.8 class 1.0 = 0.716 +- 0.449 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.8 all KL = 0.457 +- 0.449 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.8 all L1 = 0.716 +- 0.300 (in-sample avg dev_std = 0.582)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02885559566787004
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.769
SUFF_SIMPLE for r=0.9 class 1.0 = 0.721 +- 0.451 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.9 all KL = 0.475 +- 0.451 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.9 all L1 = 0.721 +- 0.302 (in-sample avg dev_std = 0.574)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02885559566787004
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.95 =  0.769
SUFF_SIMPLE for r=0.95 class 1.0 = 0.721 +- 0.451 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.95 all KL = 0.475 +- 0.451 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.95 all L1 = 0.721 +- 0.302 (in-sample avg dev_std = 0.574)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.637
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012407539682539683
len(reference) = 2520
Effective ratio: 0.193 +- 0.126
Model Accuracy over intervened graphs for r=0.5 =  0.412
SUFF_SIMPLE for r=0.5 class 1.0 = 0.571 +- 0.381 (in-sample avg dev_std = 0.610)
SUFF_SIMPLE for r=0.5 all KL = 0.419 +- 0.381 (in-sample avg dev_std = 0.610)
SUFF_SIMPLE for r=0.5 all L1 = 0.571 +- 0.287 (in-sample avg dev_std = 0.610)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004638095238095238
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.42
SUFF_SIMPLE for r=0.8 class 1.0 = 0.572 +- 0.379 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.8 all KL = 0.419 +- 0.379 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.8 all L1 = 0.572 +- 0.285 (in-sample avg dev_std = 0.612)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004582936507936508
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.415
SUFF_SIMPLE for r=0.9 class 1.0 = 0.57 +- 0.379 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.9 all KL = 0.417 +- 0.379 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.9 all L1 = 0.57 +- 0.287 (in-sample avg dev_std = 0.608)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.637
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004582936507936508
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.415
SUFF_SIMPLE for r=0.95 class 1.0 = 0.57 +- 0.379 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.95 all KL = 0.417 +- 0.379 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.95 all L1 = 0.57 +- 0.287 (in-sample avg dev_std = 0.608)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.797
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09998946515397082
len(reference) = 2459
Effective ratio: 0.351 +- 0.245
Model Accuracy over intervened graphs for r=0.5 =  0.617
SUFF_SIMPLE for r=0.5 class 1.0 = 0.655 +- 0.396 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.5 all KL = 0.469 +- 0.396 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.5 all L1 = 0.655 +- 0.304 (in-sample avg dev_std = 0.494)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04160413290113452
len(reference) = 2468
Effective ratio: 0.032 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.585
SUFF_SIMPLE for r=0.8 class 1.0 = 0.605 +- 0.370 (in-sample avg dev_std = 0.580)
SUFF_SIMPLE for r=0.8 all KL = 0.387 +- 0.370 (in-sample avg dev_std = 0.580)
SUFF_SIMPLE for r=0.8 all L1 = 0.605 +- 0.280 (in-sample avg dev_std = 0.580)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03847406807131281
len(reference) = 2468
Effective ratio: 0.027 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.584
SUFF_SIMPLE for r=0.9 class 1.0 = 0.605 +- 0.363 (in-sample avg dev_std = 0.579)
SUFF_SIMPLE for r=0.9 all KL = 0.383 +- 0.363 (in-sample avg dev_std = 0.579)
SUFF_SIMPLE for r=0.9 all L1 = 0.605 +- 0.276 (in-sample avg dev_std = 0.579)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.796
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03702188006482982
len(reference) = 2468
Effective ratio: 0.025 +- 0.047
Model Accuracy over intervened graphs for r=0.95 =  0.583
SUFF_SIMPLE for r=0.95 class 1.0 = 0.603 +- 0.361 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.95 all KL = 0.38 +- 0.361 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.95 all L1 = 0.603 +- 0.276 (in-sample avg dev_std = 0.582)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08138989169675091
len(reference) = 277
Effective ratio: 0.247 +- 0.131
Model Accuracy over intervened graphs for r=0.5 =  0.914
NEC for r=0.5 class 1.0 = 0.113 +- 0.388 (in-sample avg dev_std = 0.351)
NEC for r=0.5 all KL = 0.234 +- 0.388 (in-sample avg dev_std = 0.351)
NEC for r=0.5 all L1 = 0.113 +- 0.224 (in-sample avg dev_std = 0.351)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.028498194945848376
len(reference) = 277
Effective ratio: 0.022 +- 0.026
Model Accuracy over intervened graphs for r=0.8 =  0.989
NEC for r=0.8 class 1.0 = 0.011 +- 0.117 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.015 +- 0.117 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.011 +- 0.093 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02885559566787004
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.989
NEC for r=0.9 class 1.0 = 0.011 +- 0.117 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.015 +- 0.117 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.011 +- 0.093 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02885559566787004
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.95 =  0.989
NEC for r=0.95 class 1.0 = 0.011 +- 0.117 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.015 +- 0.117 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.011 +- 0.093 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.637
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012407539682539683
len(reference) = 2520
Effective ratio: 0.193 +- 0.126
Model Accuracy over intervened graphs for r=0.5 =  0.567
NEC for r=0.5 class 1.0 = 0.263 +- 0.356 (in-sample avg dev_std = 0.371)
NEC for r=0.5 all KL = 0.305 +- 0.356 (in-sample avg dev_std = 0.371)
NEC for r=0.5 all L1 = 0.263 +- 0.291 (in-sample avg dev_std = 0.371)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004638095238095238
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.636
NEC for r=0.8 class 1.0 = 0.028 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.012 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.028 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004582936507936508
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.636
NEC for r=0.9 class 1.0 = 0.028 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.012 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.028 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.637
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004582936507936508
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.636
NEC for r=0.95 class 1.0 = 0.028 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.012 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.028 +- 0.091 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.796
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09998946515397082
len(reference) = 2468
Effective ratio: 0.351 +- 0.245
Model Accuracy over intervened graphs for r=0.5 =  0.708
NEC for r=0.5 class 1.0 = 0.212 +- 0.375 (in-sample avg dev_std = 0.321)
NEC for r=0.5 all KL = 0.275 +- 0.375 (in-sample avg dev_std = 0.321)
NEC for r=0.5 all L1 = 0.212 +- 0.289 (in-sample avg dev_std = 0.321)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04160413290113452
len(reference) = 2468
Effective ratio: 0.032 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.783
NEC for r=0.8 class 1.0 = 0.05 +- 0.205 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.052 +- 0.205 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.05 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03847406807131281
len(reference) = 2468
Effective ratio: 0.027 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.787
NEC for r=0.9 class 1.0 = 0.047 +- 0.198 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.048 +- 0.198 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.047 +- 0.170 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.796
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03702188006482982
len(reference) = 2468
Effective ratio: 0.025 +- 0.047
Model Accuracy over intervened graphs for r=0.95 =  0.787
NEC for r=0.95 class 1.0 = 0.047 +- 0.197 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.047 +- 0.197 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.047 +- 0.169 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 19:36:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 07:36:05 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 07:36:05 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 07:36:05 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 07:36:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:36:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:36:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:36:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:36:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:36:05 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 07:36:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.086
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.035
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.032
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.032
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.005
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.005
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.005
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.047
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.040
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.039


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08607581227436822
len(reference) = 277
Effective ratio: 0.210 +- 0.140
Model Accuracy over intervened graphs for r=0.5 =  0.599
SUFF_SIMPLE for r=0.5 class 1.0 = 0.542 +- 0.310 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.5 all KL = 0.18 +- 0.310 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.5 all L1 = 0.542 +- 0.293 (in-sample avg dev_std = 0.655)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03488447653429603
len(reference) = 277
Effective ratio: 0.023 +- 0.031
Model Accuracy over intervened graphs for r=0.8 =  0.578
SUFF_SIMPLE for r=0.8 class 1.0 = 0.515 +- 0.271 (in-sample avg dev_std = 0.699)
SUFF_SIMPLE for r=0.8 all KL = 0.138 +- 0.271 (in-sample avg dev_std = 0.699)
SUFF_SIMPLE for r=0.8 all L1 = 0.515 +- 0.278 (in-sample avg dev_std = 0.699)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03218772563176896
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.559
SUFF_SIMPLE for r=0.9 class 1.0 = 0.507 +- 0.289 (in-sample avg dev_std = 0.693)
SUFF_SIMPLE for r=0.9 all KL = 0.15 +- 0.289 (in-sample avg dev_std = 0.693)
SUFF_SIMPLE for r=0.9 all L1 = 0.507 +- 0.288 (in-sample avg dev_std = 0.693)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03218772563176896
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  0.559
SUFF_SIMPLE for r=0.95 class 1.0 = 0.507 +- 0.289 (in-sample avg dev_std = 0.693)
SUFF_SIMPLE for r=0.95 all KL = 0.15 +- 0.289 (in-sample avg dev_std = 0.693)
SUFF_SIMPLE for r=0.95 all L1 = 0.507 +- 0.288 (in-sample avg dev_std = 0.693)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.588
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.01276190476190476
len(reference) = 2520
Effective ratio: 0.394 +- 0.179
Model Accuracy over intervened graphs for r=0.5 =  0.137
SUFF_SIMPLE for r=0.5 class 1.0 = 0.494 +- 0.427 (in-sample avg dev_std = 0.513)
SUFF_SIMPLE for r=0.5 all KL = 0.399 +- 0.427 (in-sample avg dev_std = 0.513)
SUFF_SIMPLE for r=0.5 all L1 = 0.494 +- 0.348 (in-sample avg dev_std = 0.513)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004647619047619047
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.135
SUFF_SIMPLE for r=0.8 class 1.0 = 0.492 +- 0.424 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.8 all KL = 0.396 +- 0.424 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.8 all L1 = 0.492 +- 0.345 (in-sample avg dev_std = 0.521)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.588
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0046718253968253964
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.137
SUFF_SIMPLE for r=0.9 class 1.0 = 0.491 +- 0.424 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.9 all KL = 0.395 +- 0.424 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.9 all L1 = 0.491 +- 0.345 (in-sample avg dev_std = 0.522)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.588
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0046718253968253964
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.137
SUFF_SIMPLE for r=0.95 class 1.0 = 0.491 +- 0.424 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.95 all KL = 0.395 +- 0.424 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.95 all L1 = 0.491 +- 0.345 (in-sample avg dev_std = 0.522)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.762
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09982658022690438
len(reference) = 2466
Effective ratio: 0.360 +- 0.196
Model Accuracy over intervened graphs for r=0.5 =  0.42
SUFF_SIMPLE for r=0.5 class 1.0 = 0.524 +- 0.377 (in-sample avg dev_std = 0.619)
SUFF_SIMPLE for r=0.5 all KL = 0.319 +- 0.377 (in-sample avg dev_std = 0.619)
SUFF_SIMPLE for r=0.5 all L1 = 0.524 +- 0.297 (in-sample avg dev_std = 0.619)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04666369529983792
len(reference) = 2468
Effective ratio: 0.036 +- 0.073
Model Accuracy over intervened graphs for r=0.8 =  0.383
SUFF_SIMPLE for r=0.8 class 1.0 = 0.499 +- 0.350 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.8 all KL = 0.282 +- 0.350 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.8 all L1 = 0.499 +- 0.282 (in-sample avg dev_std = 0.648)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03987722852512156
len(reference) = 2468
Effective ratio: 0.027 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.386
SUFF_SIMPLE for r=0.9 class 1.0 = 0.5 +- 0.351 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.9 all KL = 0.283 +- 0.351 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.9 all L1 = 0.5 +- 0.282 (in-sample avg dev_std = 0.648)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.762
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.038538492706645056
len(reference) = 2468
Effective ratio: 0.025 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.387
SUFF_SIMPLE for r=0.95 class 1.0 = 0.5 +- 0.352 (in-sample avg dev_std = 0.650)
SUFF_SIMPLE for r=0.95 all KL = 0.284 +- 0.352 (in-sample avg dev_std = 0.650)
SUFF_SIMPLE for r=0.95 all L1 = 0.5 +- 0.283 (in-sample avg dev_std = 0.650)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08607581227436822
len(reference) = 277
Effective ratio: 0.210 +- 0.140
Model Accuracy over intervened graphs for r=0.5 =  0.801
NEC for r=0.5 class 1.0 = 0.222 +- 0.452 (in-sample avg dev_std = 0.409)
NEC for r=0.5 all KL = 0.375 +- 0.452 (in-sample avg dev_std = 0.409)
NEC for r=0.5 all L1 = 0.222 +- 0.312 (in-sample avg dev_std = 0.409)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03488447653429603
len(reference) = 277
Effective ratio: 0.023 +- 0.031
Model Accuracy over intervened graphs for r=0.8 =  0.986
NEC for r=0.8 class 1.0 = 0.018 +- 0.157 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.031 +- 0.157 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.018 +- 0.106 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03218772563176896
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.989
NEC for r=0.9 class 1.0 = 0.015 +- 0.142 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.025 +- 0.142 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.015 +- 0.097 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03218772563176896
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  0.989
NEC for r=0.95 class 1.0 = 0.015 +- 0.142 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.025 +- 0.142 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.015 +- 0.097 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.588
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.01276190476190476
len(reference) = 2520
Effective ratio: 0.394 +- 0.179
Model Accuracy over intervened graphs for r=0.5 =  0.4
NEC for r=0.5 class 1.0 = 0.358 +- 0.388 (in-sample avg dev_std = 0.555)
NEC for r=0.5 all KL = 0.478 +- 0.388 (in-sample avg dev_std = 0.555)
NEC for r=0.5 all L1 = 0.358 +- 0.298 (in-sample avg dev_std = 0.555)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004647619047619047
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.582
NEC for r=0.8 class 1.0 = 0.029 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.012 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.029 +- 0.090 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.588
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0046718253968253964
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.581
NEC for r=0.9 class 1.0 = 0.029 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.012 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.029 +- 0.089 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.588
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0046718253968253964
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.581
NEC for r=0.95 class 1.0 = 0.029 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.012 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.029 +- 0.089 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.762
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09982658022690438
len(reference) = 2468
Effective ratio: 0.360 +- 0.196
Model Accuracy over intervened graphs for r=0.5 =  0.544
NEC for r=0.5 class 1.0 = 0.299 +- 0.423 (in-sample avg dev_std = 0.398)
NEC for r=0.5 all KL = 0.401 +- 0.423 (in-sample avg dev_std = 0.398)
NEC for r=0.5 all L1 = 0.299 +- 0.329 (in-sample avg dev_std = 0.398)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04666369529983792
len(reference) = 2468
Effective ratio: 0.036 +- 0.073
Model Accuracy over intervened graphs for r=0.8 =  0.739
NEC for r=0.8 class 1.0 = 0.052 +- 0.207 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.057 +- 0.207 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.052 +- 0.170 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03987722852512156
len(reference) = 2468
Effective ratio: 0.027 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.747
NEC for r=0.9 class 1.0 = 0.044 +- 0.188 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.048 +- 0.188 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.044 +- 0.156 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.762
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.038538492706645056
len(reference) = 2468
Effective ratio: 0.025 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.748
NEC for r=0.95 class 1.0 = 0.044 +- 0.188 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.048 +- 0.188 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.044 +- 0.155 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 19:41:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 07:41:16 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 07:41:16 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 07:41:16 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 07:41:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:41:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:41:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:41:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:41:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:41:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 07:41:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.083
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.032
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.032
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.005
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.005
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.005
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.098
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.042
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.038
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.036


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08342960288808664
len(reference) = 277
Effective ratio: 0.198 +- 0.132
Model Accuracy over intervened graphs for r=0.5 =  0.731
SUFF_SIMPLE for r=0.5 class 1.0 = 0.688 +- 0.441 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.5 all KL = 0.408 +- 0.441 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.5 all L1 = 0.688 +- 0.311 (in-sample avg dev_std = 0.563)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03289530685920578
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.8 =  0.712
SUFF_SIMPLE for r=0.8 class 1.0 = 0.671 +- 0.430 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.8 all KL = 0.381 +- 0.430 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.8 all L1 = 0.671 +- 0.315 (in-sample avg dev_std = 0.569)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.032108303249097477
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.705
SUFF_SIMPLE for r=0.9 class 1.0 = 0.659 +- 0.422 (in-sample avg dev_std = 0.593)
SUFF_SIMPLE for r=0.9 all KL = 0.344 +- 0.422 (in-sample avg dev_std = 0.593)
SUFF_SIMPLE for r=0.9 all L1 = 0.659 +- 0.309 (in-sample avg dev_std = 0.593)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.032108303249097477
len(reference) = 277
Effective ratio: 0.021 +- 0.020
Model Accuracy over intervened graphs for r=0.95 =  0.712
SUFF_SIMPLE for r=0.95 class 1.0 = 0.667 +- 0.425 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.95 all KL = 0.362 +- 0.425 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.95 all L1 = 0.667 +- 0.310 (in-sample avg dev_std = 0.587)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.782
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012563095238095238
len(reference) = 2520
Effective ratio: 0.251 +- 0.141
Model Accuracy over intervened graphs for r=0.5 =  0.287
SUFF_SIMPLE for r=0.5 class 1.0 = 0.461 +- 0.389 (in-sample avg dev_std = 0.590)
SUFF_SIMPLE for r=0.5 all KL = 0.282 +- 0.389 (in-sample avg dev_std = 0.590)
SUFF_SIMPLE for r=0.5 all L1 = 0.461 +- 0.314 (in-sample avg dev_std = 0.590)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0049531746031746034
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.293
SUFF_SIMPLE for r=0.8 class 1.0 = 0.463 +- 0.384 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.8 all KL = 0.278 +- 0.384 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.8 all L1 = 0.463 +- 0.309 (in-sample avg dev_std = 0.599)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.782
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004774206349206349
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.294
SUFF_SIMPLE for r=0.9 class 1.0 = 0.46 +- 0.382 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.9 all KL = 0.273 +- 0.382 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.9 all L1 = 0.46 +- 0.307 (in-sample avg dev_std = 0.608)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.782
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004774206349206349
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.294
SUFF_SIMPLE for r=0.95 class 1.0 = 0.46 +- 0.382 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.95 all KL = 0.273 +- 0.382 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.95 all L1 = 0.46 +- 0.307 (in-sample avg dev_std = 0.608)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.812
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.098459886547812
len(reference) = 2458
Effective ratio: 0.336 +- 0.228
Model Accuracy over intervened graphs for r=0.5 =  0.543
SUFF_SIMPLE for r=0.5 class 1.0 = 0.586 +- 0.372 (in-sample avg dev_std = 0.580)
SUFF_SIMPLE for r=0.5 all KL = 0.399 +- 0.372 (in-sample avg dev_std = 0.580)
SUFF_SIMPLE for r=0.5 all L1 = 0.586 +- 0.283 (in-sample avg dev_std = 0.580)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.81
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.041549837925445705
len(reference) = 2468
Effective ratio: 0.032 +- 0.065
Model Accuracy over intervened graphs for r=0.8 =  0.469
SUFF_SIMPLE for r=0.8 class 1.0 = 0.544 +- 0.350 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.8 all KL = 0.346 +- 0.350 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.8 all L1 = 0.544 +- 0.275 (in-sample avg dev_std = 0.615)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.038261345218800646
len(reference) = 2468
Effective ratio: 0.027 +- 0.054
Model Accuracy over intervened graphs for r=0.9 =  0.468
SUFF_SIMPLE for r=0.9 class 1.0 = 0.54 +- 0.345 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.9 all KL = 0.34 +- 0.345 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.9 all L1 = 0.54 +- 0.274 (in-sample avg dev_std = 0.615)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.81
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.036215559157212314
len(reference) = 2468
Effective ratio: 0.026 +- 0.049
Model Accuracy over intervened graphs for r=0.95 =  0.47
SUFF_SIMPLE for r=0.95 class 1.0 = 0.544 +- 0.346 (in-sample avg dev_std = 0.617)
SUFF_SIMPLE for r=0.95 all KL = 0.342 +- 0.346 (in-sample avg dev_std = 0.617)
SUFF_SIMPLE for r=0.95 all L1 = 0.544 +- 0.274 (in-sample avg dev_std = 0.617)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08342960288808664
len(reference) = 277
Effective ratio: 0.198 +- 0.132
Model Accuracy over intervened graphs for r=0.5 =  0.894
NEC for r=0.5 class 1.0 = 0.118 +- 0.377 (in-sample avg dev_std = 0.297)
NEC for r=0.5 all KL = 0.2 +- 0.377 (in-sample avg dev_std = 0.297)
NEC for r=0.5 all L1 = 0.118 +- 0.255 (in-sample avg dev_std = 0.297)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03289530685920578
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.8 =  0.996
NEC for r=0.8 class 1.0 = 0.005 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.01 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.005 +- 0.059 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.032108303249097477
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 1.0 = 0.005 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.01 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.005 +- 0.059 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.032108303249097477
len(reference) = 277
Effective ratio: 0.021 +- 0.020
Model Accuracy over intervened graphs for r=0.95 =  0.996
NEC for r=0.95 class 1.0 = 0.005 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.01 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.005 +- 0.059 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.782
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012563095238095238
len(reference) = 2520
Effective ratio: 0.251 +- 0.141
Model Accuracy over intervened graphs for r=0.5 =  0.53
NEC for r=0.5 class 1.0 = 0.316 +- 0.422 (in-sample avg dev_std = 0.447)
NEC for r=0.5 all KL = 0.419 +- 0.422 (in-sample avg dev_std = 0.447)
NEC for r=0.5 all L1 = 0.316 +- 0.331 (in-sample avg dev_std = 0.447)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0049531746031746034
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.775
NEC for r=0.8 class 1.0 = 0.028 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.013 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.028 +- 0.095 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.782
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004774206349206349
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.775
NEC for r=0.9 class 1.0 = 0.027 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.013 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.027 +- 0.094 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.782
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004774206349206349
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.775
NEC for r=0.95 class 1.0 = 0.027 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.013 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.027 +- 0.094 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.81
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.098459886547812
len(reference) = 2468
Effective ratio: 0.336 +- 0.228
Model Accuracy over intervened graphs for r=0.5 =  0.639
NEC for r=0.5 class 1.0 = 0.247 +- 0.394 (in-sample avg dev_std = 0.341)
NEC for r=0.5 all KL = 0.314 +- 0.394 (in-sample avg dev_std = 0.341)
NEC for r=0.5 all L1 = 0.247 +- 0.307 (in-sample avg dev_std = 0.341)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.81
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.041549837925445705
len(reference) = 2468
Effective ratio: 0.032 +- 0.065
Model Accuracy over intervened graphs for r=0.8 =  0.798
NEC for r=0.8 class 1.0 = 0.038 +- 0.176 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.04 +- 0.176 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.038 +- 0.147 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.038261345218800646
len(reference) = 2468
Effective ratio: 0.027 +- 0.054
Model Accuracy over intervened graphs for r=0.9 =  0.8
NEC for r=0.9 class 1.0 = 0.035 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.037 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.035 +- 0.140 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.81
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.036215559157212314
len(reference) = 2468
Effective ratio: 0.026 +- 0.049
Model Accuracy over intervened graphs for r=0.95 =  0.8
NEC for r=0.95 class 1.0 = 0.035 +- 0.165 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.036 +- 0.165 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.035 +- 0.140 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 19:46:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 07:46:35 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 07:46:35 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 07:46:35 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:46:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:46:35 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 07:46:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.084
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.028
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.026
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.025
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.098
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.039
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.035
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.034


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08423104693140794
len(reference) = 277
Effective ratio: 0.259 +- 0.149
Model Accuracy over intervened graphs for r=0.5 =  0.669
SUFF_SIMPLE for r=0.5 class 1.0 = 0.603 +- 0.377 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.5 all KL = 0.238 +- 0.377 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.5 all L1 = 0.603 +- 0.295 (in-sample avg dev_std = 0.665)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.028335740072202166
len(reference) = 277
Effective ratio: 0.026 +- 0.036
Model Accuracy over intervened graphs for r=0.8 =  0.647
SUFF_SIMPLE for r=0.8 class 1.0 = 0.576 +- 0.340 (in-sample avg dev_std = 0.713)
SUFF_SIMPLE for r=0.8 all KL = 0.193 +- 0.340 (in-sample avg dev_std = 0.713)
SUFF_SIMPLE for r=0.8 all L1 = 0.576 +- 0.289 (in-sample avg dev_std = 0.713)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02587003610108303
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.628
SUFF_SIMPLE for r=0.9 class 1.0 = 0.556 +- 0.306 (in-sample avg dev_std = 0.730)
SUFF_SIMPLE for r=0.9 all KL = 0.155 +- 0.306 (in-sample avg dev_std = 0.730)
SUFF_SIMPLE for r=0.9 all L1 = 0.556 +- 0.278 (in-sample avg dev_std = 0.730)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.025129963898916967
len(reference) = 277
Effective ratio: 0.021 +- 0.021
Model Accuracy over intervened graphs for r=0.95 =  0.654
SUFF_SIMPLE for r=0.95 class 1.0 = 0.573 +- 0.316 (in-sample avg dev_std = 0.735)
SUFF_SIMPLE for r=0.95 all KL = 0.16 +- 0.316 (in-sample avg dev_std = 0.735)
SUFF_SIMPLE for r=0.95 all L1 = 0.573 +- 0.268 (in-sample avg dev_std = 0.735)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.508
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.01231031746031746
len(reference) = 2520
Effective ratio: 0.164 +- 0.102
Model Accuracy over intervened graphs for r=0.5 =  0.009
SUFF_SIMPLE for r=0.5 class 1.0 = 0.519 +- 0.438 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.5 all KL = 0.494 +- 0.438 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.5 all L1 = 0.519 +- 0.379 (in-sample avg dev_std = 0.156)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0035619047619047622
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.008
SUFF_SIMPLE for r=0.8 class 1.0 = 0.519 +- 0.438 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.8 all KL = 0.494 +- 0.438 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.8 all L1 = 0.519 +- 0.379 (in-sample avg dev_std = 0.152)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.508
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0035043650793650793
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.009
SUFF_SIMPLE for r=0.9 class 1.0 = 0.519 +- 0.439 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.9 all KL = 0.494 +- 0.439 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.9 all L1 = 0.519 +- 0.379 (in-sample avg dev_std = 0.158)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.508
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0035043650793650793
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.009
SUFF_SIMPLE for r=0.95 class 1.0 = 0.519 +- 0.439 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.95 all KL = 0.495 +- 0.439 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.95 all L1 = 0.519 +- 0.379 (in-sample avg dev_std = 0.152)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.913
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09786912479740681
len(reference) = 2456
Effective ratio: 0.443 +- 0.150
Model Accuracy over intervened graphs for r=0.5 =  0.585
SUFF_SIMPLE for r=0.5 class 1.0 = 0.6 +- 0.414 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.5 all KL = 0.355 +- 0.414 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.5 all L1 = 0.6 +- 0.320 (in-sample avg dev_std = 0.574)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.913
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03915275526742301
len(reference) = 2468
Effective ratio: 0.031 +- 0.053
Model Accuracy over intervened graphs for r=0.8 =  0.559
SUFF_SIMPLE for r=0.8 class 1.0 = 0.564 +- 0.360 (in-sample avg dev_std = 0.660)
SUFF_SIMPLE for r=0.8 all KL = 0.268 +- 0.360 (in-sample avg dev_std = 0.660)
SUFF_SIMPLE for r=0.8 all L1 = 0.564 +- 0.293 (in-sample avg dev_std = 0.660)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0349339546191248
len(reference) = 2468
Effective ratio: 0.025 +- 0.046
Model Accuracy over intervened graphs for r=0.9 =  0.554
SUFF_SIMPLE for r=0.9 class 1.0 = 0.556 +- 0.355 (in-sample avg dev_std = 0.672)
SUFF_SIMPLE for r=0.9 all KL = 0.256 +- 0.355 (in-sample avg dev_std = 0.672)
SUFF_SIMPLE for r=0.9 all L1 = 0.556 +- 0.290 (in-sample avg dev_std = 0.672)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.913
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.034293760129659644
len(reference) = 2468
Effective ratio: 0.025 +- 0.044
Model Accuracy over intervened graphs for r=0.95 =  0.559
SUFF_SIMPLE for r=0.95 class 1.0 = 0.561 +- 0.354 (in-sample avg dev_std = 0.673)
SUFF_SIMPLE for r=0.95 all KL = 0.257 +- 0.354 (in-sample avg dev_std = 0.673)
SUFF_SIMPLE for r=0.95 all L1 = 0.561 +- 0.289 (in-sample avg dev_std = 0.673)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08423104693140794
len(reference) = 277
Effective ratio: 0.259 +- 0.149
Model Accuracy over intervened graphs for r=0.5 =  0.86
NEC for r=0.5 class 1.0 = 0.176 +- 0.451 (in-sample avg dev_std = 0.425)
NEC for r=0.5 all KL = 0.375 +- 0.451 (in-sample avg dev_std = 0.425)
NEC for r=0.5 all L1 = 0.176 +- 0.264 (in-sample avg dev_std = 0.425)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.028335740072202166
len(reference) = 277
Effective ratio: 0.026 +- 0.036
Model Accuracy over intervened graphs for r=0.8 =  0.993
NEC for r=0.8 class 1.0 = 0.008 +- 0.128 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.021 +- 0.128 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.008 +- 0.070 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02587003610108303
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 1.0 = 0.005 +- 0.110 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.015 +- 0.110 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.005 +- 0.055 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.025129963898916967
len(reference) = 277
Effective ratio: 0.021 +- 0.021
Model Accuracy over intervened graphs for r=0.95 =  0.996
NEC for r=0.95 class 1.0 = 0.005 +- 0.110 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.015 +- 0.110 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.005 +- 0.055 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.508
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.01231031746031746
len(reference) = 2520
Effective ratio: 0.164 +- 0.102
Model Accuracy over intervened graphs for r=0.5 =  0.145
NEC for r=0.5 class 1.0 = 0.382 +- 0.413 (in-sample avg dev_std = 0.138)
NEC for r=0.5 all KL = 0.397 +- 0.413 (in-sample avg dev_std = 0.138)
NEC for r=0.5 all L1 = 0.382 +- 0.362 (in-sample avg dev_std = 0.138)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0035619047619047622
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.482
NEC for r=0.8 class 1.0 = 0.044 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.019 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.044 +- 0.113 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.508
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0035043650793650793
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.482
NEC for r=0.9 class 1.0 = 0.043 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.018 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.043 +- 0.112 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.508
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0035043650793650793
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.482
NEC for r=0.95 class 1.0 = 0.043 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.018 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.043 +- 0.112 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.913
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09786912479740681
len(reference) = 2468
Effective ratio: 0.443 +- 0.150
Model Accuracy over intervened graphs for r=0.5 =  0.714
NEC for r=0.5 class 1.0 = 0.245 +- 0.426 (in-sample avg dev_std = 0.407)
NEC for r=0.5 all KL = 0.411 +- 0.426 (in-sample avg dev_std = 0.407)
NEC for r=0.5 all L1 = 0.245 +- 0.310 (in-sample avg dev_std = 0.407)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.913
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03915275526742301
len(reference) = 2468
Effective ratio: 0.031 +- 0.053
Model Accuracy over intervened graphs for r=0.8 =  0.904
NEC for r=0.8 class 1.0 = 0.037 +- 0.176 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.043 +- 0.176 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.037 +- 0.148 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0349339546191248
len(reference) = 2468
Effective ratio: 0.025 +- 0.046
Model Accuracy over intervened graphs for r=0.9 =  0.907
NEC for r=0.9 class 1.0 = 0.032 +- 0.162 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.036 +- 0.162 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.032 +- 0.138 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.913
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.034293760129659644
len(reference) = 2468
Effective ratio: 0.025 +- 0.044
Model Accuracy over intervened graphs for r=0.95 =  0.908
NEC for r=0.95 class 1.0 = 0.031 +- 0.159 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.035 +- 0.159 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.031 +- 0.136 (in-sample avg dev_std = 0.000)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.364, 0.356, 0.322, 0.324], 'all_L1': [0.674, 0.641, 0.625, 0.629]}), defaultdict(<class 'list'>, {'all_KL': [0.39, 0.372, 0.372, 0.374], 'all_L1': [0.695, 0.667, 0.668, 0.67]}), defaultdict(<class 'list'>, {'all_KL': [0.429, 0.42, 0.389, 0.395], 'all_L1': [0.715, 0.699, 0.689, 0.689]}), defaultdict(<class 'list'>, {'all_KL': [0.187, 0.136, 0.17, 0.154], 'all_L1': [0.546, 0.507, 0.521, 0.505]}), defaultdict(<class 'list'>, {'all_KL': [0.533, 0.462, 0.461, 0.461], 'all_L1': [0.762, 0.729, 0.723, 0.732]}), defaultdict(<class 'list'>, {'all_KL': [0.148, 0.138, 0.145, 0.132], 'all_L1': [0.52, 0.507, 0.503, 0.502]}), defaultdict(<class 'list'>, {'all_KL': [0.485, 0.457, 0.475, 0.475], 'all_L1': [0.749, 0.716, 0.721, 0.721]}), defaultdict(<class 'list'>, {'all_KL': [0.18, 0.138, 0.15, 0.15], 'all_L1': [0.542, 0.515, 0.507, 0.507]}), defaultdict(<class 'list'>, {'all_KL': [0.408, 0.381, 0.344, 0.362], 'all_L1': [0.688, 0.671, 0.659, 0.667]}), defaultdict(<class 'list'>, {'all_KL': [0.238, 0.193, 0.155, 0.16], 'all_L1': [0.603, 0.576, 0.556, 0.573]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.333, 0.008, 0.005, 0.005], 'all_L1': [0.174, 0.006, 0.003, 0.003]}), defaultdict(<class 'list'>, {'all_KL': [0.278, 0.005, 0.005, 0.005], 'all_L1': [0.14, 0.004, 0.004, 0.004]}), defaultdict(<class 'list'>, {'all_KL': [0.255, 0.019, 0.02, 0.02], 'all_L1': [0.144, 0.015, 0.015, 0.015]}), defaultdict(<class 'list'>, {'all_KL': [0.412, 0.025, 0.013, 0.013], 'all_L1': [0.219, 0.012, 0.005, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.176, 0.008, 0.008, 0.008], 'all_L1': [0.103, 0.005, 0.005, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.395, 0.022, 0.016, 0.016], 'all_L1': [0.217, 0.014, 0.009, 0.009]}), defaultdict(<class 'list'>, {'all_KL': [0.234, 0.015, 0.015, 0.015], 'all_L1': [0.113, 0.011, 0.011, 0.011]}), defaultdict(<class 'list'>, {'all_KL': [0.375, 0.031, 0.025, 0.025], 'all_L1': [0.222, 0.018, 0.015, 0.015]}), defaultdict(<class 'list'>, {'all_KL': [0.2, 0.01, 0.01, 0.01], 'all_L1': [0.118, 0.005, 0.005, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.375, 0.021, 0.015, 0.015], 'all_L1': [0.176, 0.008, 0.005, 0.005]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.507, 0.505, 0.505, 0.505], 'all_L1': [0.581, 0.581, 0.581, 0.581]}), defaultdict(<class 'list'>, {'all_KL': [0.298, 0.295, 0.296, 0.296], 'all_L1': [0.414, 0.412, 0.414, 0.414]}), defaultdict(<class 'list'>, {'all_KL': [0.187, 0.184, 0.184, 0.184], 'all_L1': [0.365, 0.366, 0.364, 0.364]}), defaultdict(<class 'list'>, {'all_KL': [0.232, 0.232, 0.232, 0.232], 'all_L1': [0.306, 0.306, 0.306, 0.306]}), defaultdict(<class 'list'>, {'all_KL': [0.486, 0.477, 0.475, 0.48], 'all_L1': [0.579, 0.575, 0.576, 0.578]}), defaultdict(<class 'list'>, {'all_KL': [0.624, 0.621, 0.624, 0.624], 'all_L1': [0.645, 0.644, 0.647, 0.647]}), defaultdict(<class 'list'>, {'all_KL': [0.419, 0.419, 0.417, 0.417], 'all_L1': [0.571, 0.572, 0.57, 0.57]}), defaultdict(<class 'list'>, {'all_KL': [0.399, 0.396, 0.395, 0.395], 'all_L1': [0.494, 0.492, 0.491, 0.491]}), defaultdict(<class 'list'>, {'all_KL': [0.282, 0.278, 0.273, 0.273], 'all_L1': [0.461, 0.463, 0.46, 0.46]}), defaultdict(<class 'list'>, {'all_KL': [0.494, 0.494, 0.494, 0.495], 'all_L1': [0.519, 0.519, 0.519, 0.519]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.372, 0.011, 0.011, 0.011], 'all_L1': [0.304, 0.029, 0.028, 0.028]}), defaultdict(<class 'list'>, {'all_KL': [0.556, 0.016, 0.016, 0.016], 'all_L1': [0.448, 0.041, 0.041, 0.041]}), defaultdict(<class 'list'>, {'all_KL': [0.549, 0.016, 0.016, 0.016], 'all_L1': [0.398, 0.026, 0.025, 0.025]}), defaultdict(<class 'list'>, {'all_KL': [0.711, 0.022, 0.021, 0.021], 'all_L1': [0.618, 0.045, 0.043, 0.043]}), defaultdict(<class 'list'>, {'all_KL': [0.324, 0.013, 0.012, 0.012], 'all_L1': [0.291, 0.034, 0.034, 0.034]}), defaultdict(<class 'list'>, {'all_KL': [0.289, 0.01, 0.01, 0.01], 'all_L1': [0.275, 0.031, 0.03, 0.03]}), defaultdict(<class 'list'>, {'all_KL': [0.305, 0.012, 0.012, 0.012], 'all_L1': [0.263, 0.028, 0.028, 0.028]}), defaultdict(<class 'list'>, {'all_KL': [0.478, 0.012, 0.012, 0.012], 'all_L1': [0.358, 0.029, 0.029, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.419, 0.013, 0.013, 0.013], 'all_L1': [0.316, 0.028, 0.027, 0.027]}), defaultdict(<class 'list'>, {'all_KL': [0.397, 0.019, 0.018, 0.018], 'all_L1': [0.382, 0.044, 0.043, 0.043]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.455, 0.363, 0.369, 0.369], 'all_L1': [0.649, 0.589, 0.591, 0.591]}), defaultdict(<class 'list'>, {'all_KL': [0.453, 0.344, 0.345, 0.341], 'all_L1': [0.614, 0.533, 0.534, 0.533]}), defaultdict(<class 'list'>, {'all_KL': [0.467, 0.398, 0.398, 0.395], 'all_L1': [0.602, 0.552, 0.553, 0.55]}), defaultdict(<class 'list'>, {'all_KL': [0.313, 0.282, 0.283, 0.281], 'all_L1': [0.502, 0.48, 0.479, 0.479]}), defaultdict(<class 'list'>, {'all_KL': [0.498, 0.402, 0.378, 0.38], 'all_L1': [0.637, 0.607, 0.594, 0.596]}), defaultdict(<class 'list'>, {'all_KL': [0.451, 0.391, 0.39, 0.384], 'all_L1': [0.553, 0.51, 0.509, 0.505]}), defaultdict(<class 'list'>, {'all_KL': [0.469, 0.387, 0.383, 0.38], 'all_L1': [0.655, 0.605, 0.605, 0.603]}), defaultdict(<class 'list'>, {'all_KL': [0.319, 0.282, 0.283, 0.284], 'all_L1': [0.524, 0.499, 0.5, 0.5]}), defaultdict(<class 'list'>, {'all_KL': [0.399, 0.346, 0.34, 0.342], 'all_L1': [0.586, 0.544, 0.54, 0.544]}), defaultdict(<class 'list'>, {'all_KL': [0.355, 0.268, 0.256, 0.257], 'all_L1': [0.6, 0.564, 0.556, 0.561]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.344, 0.051, 0.042, 0.042], 'all_L1': [0.239, 0.048, 0.04, 0.04]}), defaultdict(<class 'list'>, {'all_KL': [0.357, 0.042, 0.034, 0.033], 'all_L1': [0.278, 0.04, 0.034, 0.034]}), defaultdict(<class 'list'>, {'all_KL': [0.316, 0.048, 0.041, 0.04], 'all_L1': [0.257, 0.05, 0.042, 0.041]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.067, 0.051, 0.049], 'all_L1': [0.318, 0.057, 0.044, 0.043]}), defaultdict(<class 'list'>, {'all_KL': [0.294, 0.043, 0.04, 0.038], 'all_L1': [0.23, 0.043, 0.04, 0.038]}), defaultdict(<class 'list'>, {'all_KL': [0.415, 0.061, 0.044, 0.042], 'all_L1': [0.346, 0.062, 0.046, 0.045]}), defaultdict(<class 'list'>, {'all_KL': [0.275, 0.052, 0.048, 0.047], 'all_L1': [0.212, 0.05, 0.047, 0.047]}), defaultdict(<class 'list'>, {'all_KL': [0.401, 0.057, 0.048, 0.048], 'all_L1': [0.299, 0.052, 0.044, 0.044]}), defaultdict(<class 'list'>, {'all_KL': [0.314, 0.04, 0.037, 0.036], 'all_L1': [0.247, 0.038, 0.035, 0.035]}), defaultdict(<class 'list'>, {'all_KL': [0.411, 0.043, 0.036, 0.035], 'all_L1': [0.245, 0.037, 0.032, 0.031]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.649 +- 0.085, 0.623 +- 0.084, 0.617 +- 0.083, 0.619 +- 0.086
suff_simple class all_KL  =  0.336 +- 0.130, 0.305 +- 0.131, 0.298 +- 0.125, 0.299 +- 0.129
suff_simple_acc_int  =  0.706 +- 0.077, 0.680 +- 0.077, 0.675 +- 0.081, 0.679 +- 0.082
nec class all_L1  =  0.163 +- 0.043, 0.010 +- 0.005, 0.008 +- 0.004, 0.008 +- 0.004
nec class all_KL  =  0.303 +- 0.081, 0.016 +- 0.008, 0.013 +- 0.006, 0.013 +- 0.006
nec_acc_int  =  0.865 +- 0.036, 0.992 +- 0.004, 0.994 +- 0.004, 0.994 +- 0.004

Eval split val
suff_simple class all_L1  =  0.494 +- 0.102, 0.493 +- 0.101, 0.493 +- 0.102, 0.493 +- 0.102
suff_simple class all_KL  =  0.393 +- 0.133, 0.390 +- 0.132, 0.389 +- 0.133, 0.390 +- 0.133
suff_simple_acc_int  =  0.179 +- 0.133, 0.181 +- 0.135, 0.181 +- 0.135, 0.182 +- 0.135
nec class all_L1  =  0.365 +- 0.101, 0.034 +- 0.007, 0.033 +- 0.007, 0.033 +- 0.007
nec class all_KL  =  0.440 +- 0.127, 0.014 +- 0.004, 0.014 +- 0.003, 0.014 +- 0.003
nec_acc_int  =  0.358 +- 0.159, 0.618 +- 0.161, 0.618 +- 0.161, 0.618 +- 0.161

Eval split test
suff_simple class all_L1  =  0.592 +- 0.049, 0.548 +- 0.042, 0.546 +- 0.040, 0.546 +- 0.041
suff_simple class all_KL  =  0.418 +- 0.063, 0.346 +- 0.049, 0.342 +- 0.048, 0.341 +- 0.047
suff_simple_acc_int  =  0.505 +- 0.099, 0.463 +- 0.108, 0.461 +- 0.109, 0.462 +- 0.109
nec class all_L1  =  0.267 +- 0.040, 0.048 +- 0.008, 0.040 +- 0.005, 0.040 +- 0.005
nec class all_KL  =  0.353 +- 0.050, 0.050 +- 0.009, 0.042 +- 0.005, 0.041 +- 0.005
nec_acc_int  =  0.600 +- 0.102, 0.752 +- 0.089, 0.757 +- 0.087, 0.757 +- 0.087


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.406 +- 0.023, 0.316 +- 0.041, 0.312 +- 0.042, 0.314 +- 0.043
Faith. Armon (L1)= 		  =  0.253 +- 0.048, 0.019 +- 0.009, 0.015 +- 0.008, 0.015 +- 0.008
Faith. GMean (L1)= 	  =  0.319 +- 0.024, 0.075 +- 0.017, 0.066 +- 0.019, 0.066 +- 0.019
Faith. Aritm (KL)= 		  =  0.320 +- 0.030, 0.161 +- 0.062, 0.156 +- 0.061, 0.156 +- 0.063
Faith. Armon (KL)= 		  =  0.285 +- 0.040, 0.029 +- 0.013, 0.025 +- 0.010, 0.024 +- 0.010
Faith. GMean (KL)= 	  =  0.301 +- 0.033, 0.063 +- 0.013, 0.058 +- 0.016, 0.058 +- 0.016

Eval split val
Faith. Aritm (L1)= 		  =  0.429 +- 0.026, 0.263 +- 0.050, 0.263 +- 0.050, 0.263 +- 0.050
Faith. Armon (L1)= 		  =  0.398 +- 0.024, 0.062 +- 0.011, 0.061 +- 0.011, 0.061 +- 0.011
Faith. GMean (L1)= 	  =  0.413 +- 0.022, 0.127 +- 0.015, 0.125 +- 0.015, 0.125 +- 0.015
Faith. Aritm (KL)= 		  =  0.416 +- 0.040, 0.202 +- 0.065, 0.202 +- 0.065, 0.202 +- 0.066
Faith. Armon (KL)= 		  =  0.380 +- 0.048, 0.027 +- 0.006, 0.027 +- 0.006, 0.027 +- 0.006
Faith. GMean (KL)= 	  =  0.397 +- 0.040, 0.072 +- 0.011, 0.072 +- 0.010, 0.072 +- 0.010

Eval split test
Faith. Aritm (L1)= 		  =  0.430 +- 0.014, 0.298 +- 0.019, 0.293 +- 0.020, 0.293 +- 0.020
Faith. Armon (L1)= 		  =  0.364 +- 0.029, 0.087 +- 0.013, 0.075 +- 0.009, 0.074 +- 0.009
Faith. GMean (L1)= 	  =  0.395 +- 0.018, 0.161 +- 0.012, 0.148 +- 0.010, 0.147 +- 0.010
Faith. Aritm (KL)= 		  =  0.386 +- 0.023, 0.198 +- 0.024, 0.192 +- 0.024, 0.191 +- 0.024
Faith. Armon (KL)= 		  =  0.376 +- 0.025, 0.087 +- 0.012, 0.075 +- 0.008, 0.073 +- 0.008
Faith. GMean (KL)= 	  =  0.381 +- 0.024, 0.131 +- 0.013, 0.119 +- 0.011, 0.118 +- 0.011
Computed for split load_split = id



Completed in  0:54:10.307320  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.05 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 19:52:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 07:52:06 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 07:52:06 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 07:52:06 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 07:52:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:52:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:52:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:52:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:52:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:52:06 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 07:52:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.978
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.965
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.800
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.303
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.964
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.954
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.803
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.312
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.929
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.915
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.741
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.343


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9783862815884475
len(reference) = 276
Effective ratio: 0.119 +- 0.111
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9649638989169675
len(reference) = 277
Effective ratio: 0.085 +- 0.079
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.799754512635379
len(reference) = 277
Effective ratio: 0.058 +- 0.052
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3028303249097473
len(reference) = 277
Effective ratio: 0.020 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9642238095238096
len(reference) = 2520
Effective ratio: 0.019 +- 0.005
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.953540873015873
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8033261904761905
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3124440476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9290684764991898
len(reference) = 2251
Effective ratio: 0.189 +- 0.322
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9152747163695298
len(reference) = 2337
Effective ratio: 0.138 +- 0.261
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.7412783630470016
len(reference) = 2394
Effective ratio: 0.104 +- 0.219
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.34304902755267425
len(reference) = 2468
Effective ratio: 0.023 +- 0.039
Model Accuracy over intervened graphs for r=0.6 =  0.995
SUFF_SIMPLE for r=0.6 class 1.0 = 0.994 +- 0.094 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.6 all KL = 0.989 +- 0.094 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.6 all L1 = 0.994 +- 0.056 (in-sample avg dev_std = 0.100)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9783862815884475
len(reference) = 277
Effective ratio: 0.119 +- 0.111
Model Accuracy over intervened graphs for r=0.01 =  0.032
NEC for r=0.01 class 1.0 = 0.846 +- 0.040 (in-sample avg dev_std = 0.239)
NEC for r=0.01 all KL = 0.993 +- 0.040 (in-sample avg dev_std = 0.239)
NEC for r=0.01 all L1 = 0.846 +- 0.082 (in-sample avg dev_std = 0.239)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9649638989169675
len(reference) = 277
Effective ratio: 0.085 +- 0.079
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.864 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.999 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.864 +- 0.001 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.799754512635379
len(reference) = 277
Effective ratio: 0.058 +- 0.052
Model Accuracy over intervened graphs for r=0.25 =  0.437
NEC for r=0.25 class 1.0 = 0.526 +- 0.447 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.643 +- 0.447 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.526 +- 0.381 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3028303249097473
len(reference) = 277
Effective ratio: 0.020 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.001 +- 0.024 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.002 +- 0.024 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.001 +- 0.013 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9642238095238096
len(reference) = 2520
Effective ratio: 0.019 +- 0.005
Model Accuracy over intervened graphs for r=0.01 =  0.0
NEC for r=0.01 class 1.0 = 0.852 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.962 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.852 +- 0.024 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.953540873015873
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.852 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.961 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.852 +- 0.024 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8033261904761905
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.25 =  0.42
NEC for r=0.25 class 1.0 = 0.52 +- 0.448 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.595 +- 0.448 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.52 +- 0.383 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3124440476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.996
NEC for r=0.6 class 1.0 = 0.006 +- 0.072 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.007 +- 0.072 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.006 +- 0.059 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9290684764991898
len(reference) = 2468
Effective ratio: 0.189 +- 0.322
Model Accuracy over intervened graphs for r=0.01 =  0.114
NEC for r=0.01 class 1.0 = 0.772 +- 0.272 (in-sample avg dev_std = 0.176)
NEC for r=0.01 all KL = 0.908 +- 0.272 (in-sample avg dev_std = 0.176)
NEC for r=0.01 all L1 = 0.772 +- 0.252 (in-sample avg dev_std = 0.176)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9152747163695298
len(reference) = 2468
Effective ratio: 0.138 +- 0.261
Model Accuracy over intervened graphs for r=0.1 =  0.064
NEC for r=0.1 class 1.0 = 0.811 +- 0.224 (in-sample avg dev_std = 0.100)
NEC for r=0.1 all KL = 0.942 +- 0.224 (in-sample avg dev_std = 0.100)
NEC for r=0.1 all L1 = 0.811 +- 0.201 (in-sample avg dev_std = 0.100)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.7412783630470016
len(reference) = 2468
Effective ratio: 0.104 +- 0.219
Model Accuracy over intervened graphs for r=0.25 =  0.444
NEC for r=0.25 class 1.0 = 0.49 +- 0.486 (in-sample avg dev_std = 0.063)
NEC for r=0.25 all KL = 0.575 +- 0.486 (in-sample avg dev_std = 0.063)
NEC for r=0.25 all L1 = 0.49 +- 0.419 (in-sample avg dev_std = 0.063)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.34304902755267425
len(reference) = 2468
Effective ratio: 0.023 +- 0.039
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.002 +- 0.031 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.002 +- 0.031 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.002 +- 0.019 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 19:57:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 07:57:06 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 07:57:06 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 07:57:06 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 07:57:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:57:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:57:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:57:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 07:57:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 07:57:06 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 07:57:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.801
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.942
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.957
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.910
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.833
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.980
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.984
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.937
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.906
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.915
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.897
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.881


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8012346570397112
len(reference) = 260
Effective ratio: 0.479 +- 0.270
Model Accuracy over intervened graphs for r=0.01 =  0.99
SUFF_SIMPLE for r=0.01 class 1.0 = 0.988 +- 0.132 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.01 all KL = 0.98 +- 0.132 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.01 all L1 = 0.988 +- 0.083 (in-sample avg dev_std = 0.139)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9422851985559568
len(reference) = 272
Effective ratio: 0.147 +- 0.172
Model Accuracy over intervened graphs for r=0.1 =  0.996
SUFF_SIMPLE for r=0.1 class 1.0 = 0.994 +- 0.089 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.1 all KL = 0.989 +- 0.089 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.1 all L1 = 0.994 +- 0.047 (in-sample avg dev_std = 0.102)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9570649819494583
len(reference) = 277
Effective ratio: 0.084 +- 0.081
Model Accuracy over intervened graphs for r=0.25 =  0.998
SUFF_SIMPLE for r=0.25 class 1.0 = 0.997 +- 0.064 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.25 all KL = 0.992 +- 0.064 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.25 all L1 = 0.997 +- 0.025 (in-sample avg dev_std = 0.079)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9102418772563177
len(reference) = 277
Effective ratio: 0.072 +- 0.055
Model Accuracy over intervened graphs for r=0.6 =  0.998
SUFF_SIMPLE for r=0.6 class 1.0 = 0.997 +- 0.065 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.6 all KL = 0.992 +- 0.065 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.6 all L1 = 0.997 +- 0.025 (in-sample avg dev_std = 0.080)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8328400793650794
len(reference) = 2520
Effective ratio: 0.091 +- 0.028
Model Accuracy over intervened graphs for r=0.01 =  0.975
SUFF_SIMPLE for r=0.01 class 1.0 = 0.959 +- 0.224 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.01 all KL = 0.909 +- 0.224 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.01 all L1 = 0.959 +- 0.105 (in-sample avg dev_std = 0.293)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9798198412698413
len(reference) = 2520
Effective ratio: 0.015 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.974
SUFF_SIMPLE for r=0.1 class 1.0 = 0.958 +- 0.229 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.1 all KL = 0.906 +- 0.229 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.1 all L1 = 0.958 +- 0.107 (in-sample avg dev_std = 0.299)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9841551587301587
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.979
SUFF_SIMPLE for r=0.25 class 1.0 = 0.964 +- 0.210 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.25 all KL = 0.919 +- 0.210 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.25 all L1 = 0.964 +- 0.096 (in-sample avg dev_std = 0.276)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9368936507936507
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.978
SUFF_SIMPLE for r=0.6 class 1.0 = 0.963 +- 0.213 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.6 all KL = 0.917 +- 0.213 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.6 all L1 = 0.963 +- 0.097 (in-sample avg dev_std = 0.280)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9055555105348461
len(reference) = 2060
Effective ratio: 0.277 +- 0.393
Model Accuracy over intervened graphs for r=0.01 =  0.998
SUFF_SIMPLE for r=0.01 class 1.0 = 0.997 +- 0.057 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.01 all KL = 0.996 +- 0.057 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.01 all L1 = 0.997 +- 0.042 (in-sample avg dev_std = 0.044)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9151738249594813
len(reference) = 2209
Effective ratio: 0.210 +- 0.344
Model Accuracy over intervened graphs for r=0.1 =  0.996
SUFF_SIMPLE for r=0.1 class 1.0 = 0.997 +- 0.062 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.1 all KL = 0.995 +- 0.062 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.1 all L1 = 0.997 +- 0.041 (in-sample avg dev_std = 0.053)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.998
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8974448946515398
len(reference) = 2325
Effective ratio: 0.144 +- 0.277
Model Accuracy over intervened graphs for r=0.25 =  0.999
SUFF_SIMPLE for r=0.25 class 1.0 = 0.999 +- 0.036 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.25 all KL = 0.998 +- 0.036 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.25 all L1 = 0.999 +- 0.027 (in-sample avg dev_std = 0.025)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.998
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8807499999999999
len(reference) = 2457
Effective ratio: 0.089 +- 0.158
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.998 +- 0.042 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.6 all KL = 0.998 +- 0.042 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.6 all L1 = 0.998 +- 0.035 (in-sample avg dev_std = 0.015)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8012346570397112
len(reference) = 277
Effective ratio: 0.479 +- 0.270
Model Accuracy over intervened graphs for r=0.01 =  0.96
NEC for r=0.01 class 1.0 = 0.063 +- 0.282 (in-sample avg dev_std = 0.363)
NEC for r=0.01 all KL = 0.134 +- 0.282 (in-sample avg dev_std = 0.363)
NEC for r=0.01 all L1 = 0.063 +- 0.141 (in-sample avg dev_std = 0.363)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9422851985559568
len(reference) = 277
Effective ratio: 0.147 +- 0.172
Model Accuracy over intervened graphs for r=0.1 =  0.101
NEC for r=0.1 class 1.0 = 0.795 +- 0.168 (in-sample avg dev_std = 0.302)
NEC for r=0.1 all KL = 0.952 +- 0.168 (in-sample avg dev_std = 0.302)
NEC for r=0.1 all L1 = 0.795 +- 0.194 (in-sample avg dev_std = 0.302)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9570649819494583
len(reference) = 277
Effective ratio: 0.084 +- 0.081
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.864 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.999 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.864 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9102418772563177
len(reference) = 277
Effective ratio: 0.072 +- 0.055
Model Accuracy over intervened graphs for r=0.6 =  0.022
NEC for r=0.6 class 1.0 = 0.845 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.977 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.845 +- 0.124 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8328400793650794
len(reference) = 2520
Effective ratio: 0.091 +- 0.028
Model Accuracy over intervened graphs for r=0.01 =  0.182
NEC for r=0.01 class 1.0 = 0.75 +- 0.204 (in-sample avg dev_std = 0.489)
NEC for r=0.01 all KL = 0.925 +- 0.204 (in-sample avg dev_std = 0.489)
NEC for r=0.01 all L1 = 0.75 +- 0.220 (in-sample avg dev_std = 0.489)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9798198412698413
len(reference) = 2520
Effective ratio: 0.015 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.863 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.995 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.863 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9841551587301587
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.863 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.995 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.863 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9368936507936507
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.05
NEC for r=0.6 class 1.0 = 0.822 +- 0.205 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.949 +- 0.205 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.822 +- 0.179 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.998
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9055555105348461
len(reference) = 2468
Effective ratio: 0.277 +- 0.393
Model Accuracy over intervened graphs for r=0.01 =  0.224
NEC for r=0.01 class 1.0 = 0.697 +- 0.311 (in-sample avg dev_std = 0.359)
NEC for r=0.01 all KL = 0.856 +- 0.311 (in-sample avg dev_std = 0.359)
NEC for r=0.01 all L1 = 0.697 +- 0.301 (in-sample avg dev_std = 0.359)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9151738249594813
len(reference) = 2468
Effective ratio: 0.210 +- 0.344
Model Accuracy over intervened graphs for r=0.1 =  0.139
NEC for r=0.1 class 1.0 = 0.758 +- 0.263 (in-sample avg dev_std = 0.258)
NEC for r=0.1 all KL = 0.905 +- 0.263 (in-sample avg dev_std = 0.258)
NEC for r=0.1 all L1 = 0.758 +- 0.257 (in-sample avg dev_std = 0.258)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.998
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8974448946515398
len(reference) = 2468
Effective ratio: 0.144 +- 0.277
Model Accuracy over intervened graphs for r=0.25 =  0.085
NEC for r=0.25 class 1.0 = 0.797 +- 0.227 (in-sample avg dev_std = 0.173)
NEC for r=0.25 all KL = 0.935 +- 0.227 (in-sample avg dev_std = 0.173)
NEC for r=0.25 all L1 = 0.797 +- 0.216 (in-sample avg dev_std = 0.173)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.998
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8807499999999999
len(reference) = 2468
Effective ratio: 0.089 +- 0.158
Model Accuracy over intervened graphs for r=0.6 =  0.034
NEC for r=0.6 class 1.0 = 0.834 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.965 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.834 +- 0.155 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 20:02:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 08:02:30 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 08:02:30 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 08:02:30 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 08:02:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:02:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:02:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:02:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:02:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:02:30 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 08:02:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.787
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.901
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.981
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.944
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.783
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.930
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.983
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.980
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.900
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.906
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.911
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.894


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7870505415162454
len(reference) = 246
Effective ratio: 0.473 +- 0.268
Model Accuracy over intervened graphs for r=0.01 =  0.989
SUFF_SIMPLE for r=0.01 class 1.0 = 0.987 +- 0.125 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.01 all KL = 0.978 +- 0.125 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.01 all L1 = 0.987 +- 0.086 (in-sample avg dev_std = 0.130)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9009675090252709
len(reference) = 273
Effective ratio: 0.176 +- 0.193
Model Accuracy over intervened graphs for r=0.1 =  0.994
SUFF_SIMPLE for r=0.1 class 1.0 = 0.992 +- 0.100 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all KL = 0.986 +- 0.100 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all L1 = 0.992 +- 0.063 (in-sample avg dev_std = 0.123)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9813212996389893
len(reference) = 276
Effective ratio: 0.105 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.995
SUFF_SIMPLE for r=0.25 class 1.0 = 0.993 +- 0.088 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.25 all KL = 0.987 +- 0.088 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.25 all L1 = 0.993 +- 0.052 (in-sample avg dev_std = 0.113)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9436895306859208
len(reference) = 277
Effective ratio: 0.084 +- 0.069
Model Accuracy over intervened graphs for r=0.6 =  0.998
SUFF_SIMPLE for r=0.6 class 1.0 = 0.996 +- 0.067 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.6 all KL = 0.992 +- 0.067 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.6 all L1 = 0.996 +- 0.032 (in-sample avg dev_std = 0.091)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.86
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7825789682539683
len(reference) = 2520
Effective ratio: 0.100 +- 0.028
Model Accuracy over intervened graphs for r=0.01 =  0.86
SUFF_SIMPLE for r=0.01 class 1.0 = 0.999 +- 0.027 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.01 all KL = 0.999 +- 0.027 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.01 all L1 = 0.999 +- 0.013 (in-sample avg dev_std = 0.036)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9304154761904762
len(reference) = 2520
Effective ratio: 0.019 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.86
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.014 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.014 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.006 (in-sample avg dev_std = 0.020)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.86
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.983297619047619
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.86
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.020 (in-sample avg dev_std = 0.028)
SUFF_SIMPLE for r=0.25 all KL = 0.999 +- 0.020 (in-sample avg dev_std = 0.028)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.009 (in-sample avg dev_std = 0.028)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9803599206349206
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.86
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8995619935170177
len(reference) = 1932
Effective ratio: 0.289 +- 0.410
Model Accuracy over intervened graphs for r=0.01 =  0.996
SUFF_SIMPLE for r=0.01 class 1.0 = 0.996 +- 0.074 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.01 all KL = 0.994 +- 0.074 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.01 all L1 = 0.996 +- 0.055 (in-sample avg dev_std = 0.061)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9055405186385737
len(reference) = 2118
Effective ratio: 0.225 +- 0.362
Model Accuracy over intervened graphs for r=0.1 =  0.995
SUFF_SIMPLE for r=0.1 class 1.0 = 0.996 +- 0.067 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.1 all KL = 0.994 +- 0.067 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.1 all L1 = 0.996 +- 0.052 (in-sample avg dev_std = 0.047)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.995
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.910589546191248
len(reference) = 2293
Effective ratio: 0.172 +- 0.301
Model Accuracy over intervened graphs for r=0.25 =  0.997
SUFF_SIMPLE for r=0.25 class 1.0 = 0.996 +- 0.067 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.25 all KL = 0.994 +- 0.067 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.25 all L1 = 0.996 +- 0.053 (in-sample avg dev_std = 0.045)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.992
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8941519448946517
len(reference) = 2457
Effective ratio: 0.098 +- 0.166
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.992 +- 0.092 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.6 all KL = 0.991 +- 0.092 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.6 all L1 = 0.992 +- 0.078 (in-sample avg dev_std = 0.035)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7870505415162454
len(reference) = 277
Effective ratio: 0.473 +- 0.268
Model Accuracy over intervened graphs for r=0.01 =  0.949
NEC for r=0.01 class 1.0 = 0.075 +- 0.280 (in-sample avg dev_std = 0.387)
NEC for r=0.01 all KL = 0.141 +- 0.280 (in-sample avg dev_std = 0.387)
NEC for r=0.01 all L1 = 0.075 +- 0.160 (in-sample avg dev_std = 0.387)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9009675090252709
len(reference) = 277
Effective ratio: 0.176 +- 0.193
Model Accuracy over intervened graphs for r=0.1 =  0.264
NEC for r=0.1 class 1.0 = 0.689 +- 0.253 (in-sample avg dev_std = 0.536)
NEC for r=0.1 all KL = 0.871 +- 0.253 (in-sample avg dev_std = 0.536)
NEC for r=0.1 all L1 = 0.689 +- 0.265 (in-sample avg dev_std = 0.536)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9813212996389893
len(reference) = 277
Effective ratio: 0.105 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.003
NEC for r=0.25 class 1.0 = 0.861 +- 0.015 (in-sample avg dev_std = 0.055)
NEC for r=0.25 all KL = 0.995 +- 0.015 (in-sample avg dev_std = 0.055)
NEC for r=0.25 all L1 = 0.861 +- 0.028 (in-sample avg dev_std = 0.055)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9436895306859208
len(reference) = 277
Effective ratio: 0.084 +- 0.069
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.863 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.996 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.863 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.86
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7825789682539683
len(reference) = 2520
Effective ratio: 0.100 +- 0.028
Model Accuracy over intervened graphs for r=0.01 =  0.231
NEC for r=0.01 class 1.0 = 0.615 +- 0.351 (in-sample avg dev_std = 0.499)
NEC for r=0.01 all KL = 0.734 +- 0.351 (in-sample avg dev_std = 0.499)
NEC for r=0.01 all L1 = 0.615 +- 0.297 (in-sample avg dev_std = 0.499)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9304154761904762
len(reference) = 2520
Effective ratio: 0.019 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.776 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.856 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.776 +- 0.198 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.86
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.983297619047619
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.776 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.856 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.776 +- 0.198 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9803599206349206
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.776 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.856 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.776 +- 0.198 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.992
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8995619935170177
len(reference) = 2468
Effective ratio: 0.289 +- 0.410
Model Accuracy over intervened graphs for r=0.01 =  0.236
NEC for r=0.01 class 1.0 = 0.689 +- 0.319 (in-sample avg dev_std = 0.355)
NEC for r=0.01 all KL = 0.837 +- 0.319 (in-sample avg dev_std = 0.355)
NEC for r=0.01 all L1 = 0.689 +- 0.306 (in-sample avg dev_std = 0.355)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9055405186385737
len(reference) = 2468
Effective ratio: 0.225 +- 0.362
Model Accuracy over intervened graphs for r=0.1 =  0.144
NEC for r=0.1 class 1.0 = 0.756 +- 0.266 (in-sample avg dev_std = 0.263)
NEC for r=0.1 all KL = 0.896 +- 0.266 (in-sample avg dev_std = 0.263)
NEC for r=0.1 all L1 = 0.756 +- 0.256 (in-sample avg dev_std = 0.263)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.992
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.910589546191248
len(reference) = 2468
Effective ratio: 0.172 +- 0.301
Model Accuracy over intervened graphs for r=0.25 =  0.078
NEC for r=0.25 class 1.0 = 0.8 +- 0.221 (in-sample avg dev_std = 0.177)
NEC for r=0.25 all KL = 0.934 +- 0.221 (in-sample avg dev_std = 0.177)
NEC for r=0.25 all L1 = 0.8 +- 0.208 (in-sample avg dev_std = 0.177)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.992
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8941519448946517
len(reference) = 2468
Effective ratio: 0.098 +- 0.166
Model Accuracy over intervened graphs for r=0.6 =  0.009
NEC for r=0.6 class 1.0 = 0.848 +- 0.130 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.978 +- 0.130 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.848 +- 0.112 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 20:07:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 08:07:24 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 08:07:24 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 08:07:24 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 08:07:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:07:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:07:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:07:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:07:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:07:24 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 08:07:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.868
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.976
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.914
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.249
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.680
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.933
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.922
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.908
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.900
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.862
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.279


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8683935018050543
len(reference) = 273
Effective ratio: 0.229 +- 0.163
Model Accuracy over intervened graphs for r=0.01 =  0.894
SUFF_SIMPLE for r=0.01 class 1.0 = 0.849 +- 0.326 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.01 all KL = 0.764 +- 0.326 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.01 all L1 = 0.849 +- 0.218 (in-sample avg dev_std = 0.486)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9756967509025269
len(reference) = 277
Effective ratio: 0.103 +- 0.096
Model Accuracy over intervened graphs for r=0.1 =  0.912
SUFF_SIMPLE for r=0.1 class 1.0 = 0.872 +- 0.304 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.1 all KL = 0.787 +- 0.304 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.1 all L1 = 0.872 +- 0.193 (in-sample avg dev_std = 0.468)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9138483754512636
len(reference) = 277
Effective ratio: 0.083 +- 0.079
Model Accuracy over intervened graphs for r=0.25 =  0.925
SUFF_SIMPLE for r=0.25 class 1.0 = 0.884 +- 0.288 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.25 all KL = 0.804 +- 0.288 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.25 all L1 = 0.884 +- 0.177 (in-sample avg dev_std = 0.452)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2486462093862816
len(reference) = 277
Effective ratio: 0.020 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.902
SUFF_SIMPLE for r=0.6 class 1.0 = 0.856 +- 0.320 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.6 all KL = 0.76 +- 0.320 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.6 all L1 = 0.856 +- 0.200 (in-sample avg dev_std = 0.510)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.762
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.6796630952380952
len(reference) = 2520
Effective ratio: 0.082 +- 0.024
Model Accuracy over intervened graphs for r=0.01 =  0.342
SUFF_SIMPLE for r=0.01 class 1.0 = 0.478 +- 0.356 (in-sample avg dev_std = 0.770)
SUFF_SIMPLE for r=0.01 all KL = 0.346 +- 0.356 (in-sample avg dev_std = 0.770)
SUFF_SIMPLE for r=0.01 all L1 = 0.478 +- 0.234 (in-sample avg dev_std = 0.770)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9326305555555555
len(reference) = 2520
Effective ratio: 0.016 +- 0.004
Model Accuracy over intervened graphs for r=0.1 =  0.347
SUFF_SIMPLE for r=0.1 class 1.0 = 0.485 +- 0.356 (in-sample avg dev_std = 0.767)
SUFF_SIMPLE for r=0.1 all KL = 0.352 +- 0.356 (in-sample avg dev_std = 0.767)
SUFF_SIMPLE for r=0.1 all L1 = 0.485 +- 0.236 (in-sample avg dev_std = 0.767)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.762
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9220797619047617
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.36
SUFF_SIMPLE for r=0.25 class 1.0 = 0.491 +- 0.350 (in-sample avg dev_std = 0.777)
SUFF_SIMPLE for r=0.25 all KL = 0.353 +- 0.350 (in-sample avg dev_std = 0.777)
SUFF_SIMPLE for r=0.25 all L1 = 0.491 +- 0.228 (in-sample avg dev_std = 0.777)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2460301587301587
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.365
SUFF_SIMPLE for r=0.6 class 1.0 = 0.494 +- 0.351 (in-sample avg dev_std = 0.781)
SUFF_SIMPLE for r=0.6 all KL = 0.356 +- 0.351 (in-sample avg dev_std = 0.781)
SUFF_SIMPLE for r=0.6 all L1 = 0.494 +- 0.228 (in-sample avg dev_std = 0.781)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9083071312803889
len(reference) = 2091
Effective ratio: 0.232 +- 0.368
Model Accuracy over intervened graphs for r=0.01 =  0.98
SUFF_SIMPLE for r=0.01 class 1.0 = 0.977 +- 0.156 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.01 all KL = 0.965 +- 0.156 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.01 all L1 = 0.977 +- 0.114 (in-sample avg dev_std = 0.150)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.993
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8995255267423015
len(reference) = 2253
Effective ratio: 0.175 +- 0.309
Model Accuracy over intervened graphs for r=0.1 =  0.985
SUFF_SIMPLE for r=0.1 class 1.0 = 0.979 +- 0.142 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.1 all KL = 0.968 +- 0.142 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.1 all L1 = 0.979 +- 0.099 (in-sample avg dev_std = 0.156)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.982
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8620251215559157
len(reference) = 2381
Effective ratio: 0.134 +- 0.256
Model Accuracy over intervened graphs for r=0.25 =  0.99
SUFF_SIMPLE for r=0.25 class 1.0 = 0.978 +- 0.142 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.25 all KL = 0.97 +- 0.142 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.25 all L1 = 0.978 +- 0.111 (in-sample avg dev_std = 0.130)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.977
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.27854457050243114
len(reference) = 2468
Effective ratio: 0.023 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.988
SUFF_SIMPLE for r=0.6 class 1.0 = 0.959 +- 0.197 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.6 all KL = 0.942 +- 0.197 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.6 all L1 = 0.959 +- 0.148 (in-sample avg dev_std = 0.197)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8683935018050543
len(reference) = 277
Effective ratio: 0.229 +- 0.163
Model Accuracy over intervened graphs for r=0.01 =  0.674
NEC for r=0.01 class 1.0 = 0.346 +- 0.400 (in-sample avg dev_std = 0.544)
NEC for r=0.01 all KL = 0.482 +- 0.400 (in-sample avg dev_std = 0.544)
NEC for r=0.01 all L1 = 0.346 +- 0.333 (in-sample avg dev_std = 0.544)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9756967509025269
len(reference) = 277
Effective ratio: 0.103 +- 0.096
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.86 +- 0.009 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.989 +- 0.009 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.86 +- 0.002 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9138483754512636
len(reference) = 277
Effective ratio: 0.083 +- 0.079
Model Accuracy over intervened graphs for r=0.25 =  0.029
NEC for r=0.25 class 1.0 = 0.842 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.969 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.842 +- 0.101 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2486462093862816
len(reference) = 277
Effective ratio: 0.020 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.986
NEC for r=0.6 class 1.0 = 0.012 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.014 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.012 +- 0.102 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.762
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.6796630952380952
len(reference) = 2520
Effective ratio: 0.082 +- 0.024
Model Accuracy over intervened graphs for r=0.01 =  0.045
NEC for r=0.01 class 1.0 = 0.702 +- 0.331 (in-sample avg dev_std = 0.311)
NEC for r=0.01 all KL = 0.766 +- 0.331 (in-sample avg dev_std = 0.311)
NEC for r=0.01 all L1 = 0.702 +- 0.232 (in-sample avg dev_std = 0.311)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9326305555555555
len(reference) = 2520
Effective ratio: 0.016 +- 0.004
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.729 +- 0.326 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.78 +- 0.326 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.729 +- 0.221 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.762
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9220797619047617
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.729 +- 0.326 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.78 +- 0.326 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.729 +- 0.221 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2460301587301587
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.748
NEC for r=0.6 class 1.0 = 0.014 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.014 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.014 +- 0.101 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.977
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9083071312803889
len(reference) = 2468
Effective ratio: 0.232 +- 0.368
Model Accuracy over intervened graphs for r=0.01 =  0.153
NEC for r=0.01 class 1.0 = 0.757 +- 0.260 (in-sample avg dev_std = 0.277)
NEC for r=0.01 all KL = 0.888 +- 0.260 (in-sample avg dev_std = 0.277)
NEC for r=0.01 all L1 = 0.757 +- 0.247 (in-sample avg dev_std = 0.277)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8995255267423015
len(reference) = 2468
Effective ratio: 0.175 +- 0.309
Model Accuracy over intervened graphs for r=0.1 =  0.088
NEC for r=0.1 class 1.0 = 0.797 +- 0.220 (in-sample avg dev_std = 0.201)
NEC for r=0.1 all KL = 0.924 +- 0.220 (in-sample avg dev_std = 0.201)
NEC for r=0.1 all L1 = 0.797 +- 0.203 (in-sample avg dev_std = 0.201)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.977
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8620251215559157
len(reference) = 2468
Effective ratio: 0.134 +- 0.256
Model Accuracy over intervened graphs for r=0.25 =  0.073
NEC for r=0.25 class 1.0 = 0.801 +- 0.220 (in-sample avg dev_std = 0.163)
NEC for r=0.25 all KL = 0.925 +- 0.220 (in-sample avg dev_std = 0.163)
NEC for r=0.25 all L1 = 0.801 +- 0.196 (in-sample avg dev_std = 0.163)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.977
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.27854457050243114
len(reference) = 2468
Effective ratio: 0.023 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.878
NEC for r=0.6 class 1.0 = 0.107 +- 0.313 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.12 +- 0.313 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.107 +- 0.271 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 20:12:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 08:12:15 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 08:12:15 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 08:12:15 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 08:12:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:12:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:12:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:12:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:12:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:12:15 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 08:12:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.972
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.992
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.988
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.782
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.930
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.985
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.994
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.814
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.945
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.942
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.914
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.775


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.971956678700361
len(reference) = 275
Effective ratio: 0.153 +- 0.134
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9921046931407942
len(reference) = 277
Effective ratio: 0.095 +- 0.084
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9875992779783394
len(reference) = 277
Effective ratio: 0.089 +- 0.077
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7816353790613718
len(reference) = 277
Effective ratio: 0.060 +- 0.055
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.891
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9297126984126985
len(reference) = 2520
Effective ratio: 0.035 +- 0.011
Model Accuracy over intervened graphs for r=0.01 =  0.89
SUFF_SIMPLE for r=0.01 class 1.0 = 0.999 +- 0.034 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.01 all KL = 0.998 +- 0.034 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.01 all L1 = 0.999 +- 0.015 (in-sample avg dev_std = 0.041)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9846265873015873
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.89
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.026 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.1 all KL = 0.998 +- 0.026 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.1 all L1 = 0.999 +- 0.011 (in-sample avg dev_std = 0.034)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.891
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9937595238095238
len(reference) = 2520
Effective ratio: 0.013 +- 0.002
Model Accuracy over intervened graphs for r=0.25 =  0.89
SUFF_SIMPLE for r=0.25 class 1.0 = 0.999 +- 0.028 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.25 all KL = 0.999 +- 0.028 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.25 all L1 = 0.999 +- 0.014 (in-sample avg dev_std = 0.035)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8141019841269842
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.89
SUFF_SIMPLE for r=0.6 class 1.0 = 0.998 +- 0.043 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.6 all KL = 0.996 +- 0.043 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.6 all L1 = 0.998 +- 0.020 (in-sample avg dev_std = 0.054)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9452820097244733
len(reference) = 2132
Effective ratio: 0.211 +- 0.349
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9417666126418153
len(reference) = 2279
Effective ratio: 0.162 +- 0.290
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9144080226904376
len(reference) = 2367
Effective ratio: 0.130 +- 0.242
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7754542139384117
len(reference) = 2457
Effective ratio: 0.087 +- 0.163
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.971956678700361
len(reference) = 277
Effective ratio: 0.153 +- 0.134
Model Accuracy over intervened graphs for r=0.01 =  0.346
NEC for r=0.01 class 1.0 = 0.623 +- 0.315 (in-sample avg dev_std = 0.543)
NEC for r=0.01 all KL = 0.818 +- 0.315 (in-sample avg dev_std = 0.543)
NEC for r=0.01 all L1 = 0.623 +- 0.310 (in-sample avg dev_std = 0.543)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9921046931407942
len(reference) = 277
Effective ratio: 0.095 +- 0.084
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.864 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.998 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.864 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9875992779783394
len(reference) = 277
Effective ratio: 0.089 +- 0.077
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.864 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.998 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.864 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7816353790613718
len(reference) = 277
Effective ratio: 0.060 +- 0.055
Model Accuracy over intervened graphs for r=0.6 =  0.444
NEC for r=0.6 class 1.0 = 0.487 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.571 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.487 +- 0.419 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.891
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9297126984126985
len(reference) = 2520
Effective ratio: 0.035 +- 0.011
Model Accuracy over intervened graphs for r=0.01 =  0.0
NEC for r=0.01 class 1.0 = 0.802 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.874 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.802 +- 0.124 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9846265873015873
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.802 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.874 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.802 +- 0.124 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.891
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9937595238095238
len(reference) = 2520
Effective ratio: 0.013 +- 0.002
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.802 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.874 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.802 +- 0.124 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8141019841269842
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.365
NEC for r=0.6 class 1.0 = 0.489 +- 0.451 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.525 +- 0.451 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.489 +- 0.383 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9452820097244733
len(reference) = 2468
Effective ratio: 0.211 +- 0.349
Model Accuracy over intervened graphs for r=0.01 =  0.133
NEC for r=0.01 class 1.0 = 0.761 +- 0.266 (in-sample avg dev_std = 0.237)
NEC for r=0.01 all KL = 0.904 +- 0.266 (in-sample avg dev_std = 0.237)
NEC for r=0.01 all L1 = 0.761 +- 0.257 (in-sample avg dev_std = 0.237)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9417666126418153
len(reference) = 2468
Effective ratio: 0.162 +- 0.290
Model Accuracy over intervened graphs for r=0.1 =  0.078
NEC for r=0.1 class 1.0 = 0.804 +- 0.200 (in-sample avg dev_std = 0.192)
NEC for r=0.1 all KL = 0.946 +- 0.200 (in-sample avg dev_std = 0.192)
NEC for r=0.1 all L1 = 0.804 +- 0.199 (in-sample avg dev_std = 0.192)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9144080226904376
len(reference) = 2468
Effective ratio: 0.130 +- 0.242
Model Accuracy over intervened graphs for r=0.25 =  0.048
NEC for r=0.25 class 1.0 = 0.826 +- 0.176 (in-sample avg dev_std = 0.130)
NEC for r=0.25 all KL = 0.962 +- 0.176 (in-sample avg dev_std = 0.130)
NEC for r=0.25 all L1 = 0.826 +- 0.166 (in-sample avg dev_std = 0.130)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7754542139384117
len(reference) = 2468
Effective ratio: 0.087 +- 0.163
Model Accuracy over intervened graphs for r=0.6 =  0.118
NEC for r=0.6 class 1.0 = 0.766 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.888 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.766 +- 0.267 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 20:17:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 08:17:52 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 08:17:52 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 08:17:52 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 08:17:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:17:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:17:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:17:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:17:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:17:52 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 08:17:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.805
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.919
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.981
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.790
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.783
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.934
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.976
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.816
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.891
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.894
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.894
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.842


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8053718411552346
len(reference) = 252
Effective ratio: 0.415 +- 0.281
Model Accuracy over intervened graphs for r=0.01 =  0.967
SUFF_SIMPLE for r=0.01 class 1.0 = 0.959 +- 0.224 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.01 all KL = 0.928 +- 0.224 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.01 all L1 = 0.959 +- 0.142 (in-sample avg dev_std = 0.237)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9186462093862816
len(reference) = 272
Effective ratio: 0.159 +- 0.187
Model Accuracy over intervened graphs for r=0.1 =  0.968
SUFF_SIMPLE for r=0.1 class 1.0 = 0.955 +- 0.238 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.1 all KL = 0.913 +- 0.238 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.1 all L1 = 0.955 +- 0.136 (in-sample avg dev_std = 0.278)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9812202166064982
len(reference) = 276
Effective ratio: 0.103 +- 0.116
Model Accuracy over intervened graphs for r=0.25 =  0.984
SUFF_SIMPLE for r=0.25 class 1.0 = 0.974 +- 0.183 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.25 all KL = 0.94 +- 0.183 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.25 all L1 = 0.974 +- 0.084 (in-sample avg dev_std = 0.238)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7898808664259929
len(reference) = 277
Effective ratio: 0.057 +- 0.051
Model Accuracy over intervened graphs for r=0.6 =  0.988
SUFF_SIMPLE for r=0.6 class 1.0 = 0.98 +- 0.164 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.6 all KL = 0.955 +- 0.164 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.6 all L1 = 0.98 +- 0.075 (in-sample avg dev_std = 0.207)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.94
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7831559523809524
len(reference) = 2520
Effective ratio: 0.080 +- 0.024
Model Accuracy over intervened graphs for r=0.01 =  0.709
SUFF_SIMPLE for r=0.01 class 1.0 = 0.682 +- 0.353 (in-sample avg dev_std = 0.744)
SUFF_SIMPLE for r=0.01 all KL = 0.488 +- 0.353 (in-sample avg dev_std = 0.744)
SUFF_SIMPLE for r=0.01 all L1 = 0.682 +- 0.219 (in-sample avg dev_std = 0.744)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9343480158730157
len(reference) = 2520
Effective ratio: 0.018 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.74
SUFF_SIMPLE for r=0.1 class 1.0 = 0.718 +- 0.351 (in-sample avg dev_std = 0.710)
SUFF_SIMPLE for r=0.1 all KL = 0.531 +- 0.351 (in-sample avg dev_std = 0.710)
SUFF_SIMPLE for r=0.1 all L1 = 0.718 +- 0.212 (in-sample avg dev_std = 0.710)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.94
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9764575396825398
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.742
SUFF_SIMPLE for r=0.25 class 1.0 = 0.72 +- 0.353 (in-sample avg dev_std = 0.707)
SUFF_SIMPLE for r=0.25 all KL = 0.538 +- 0.353 (in-sample avg dev_std = 0.707)
SUFF_SIMPLE for r=0.25 all L1 = 0.72 +- 0.212 (in-sample avg dev_std = 0.707)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8164583333333333
len(reference) = 2520
Effective ratio: 0.008 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.764
SUFF_SIMPLE for r=0.6 class 1.0 = 0.747 +- 0.354 (in-sample avg dev_std = 0.679)
SUFF_SIMPLE for r=0.6 all KL = 0.573 +- 0.354 (in-sample avg dev_std = 0.679)
SUFF_SIMPLE for r=0.6 all L1 = 0.747 +- 0.207 (in-sample avg dev_std = 0.679)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8909145056726094
len(reference) = 1937
Effective ratio: 0.282 +- 0.408
Model Accuracy over intervened graphs for r=0.01 =  0.985
SUFF_SIMPLE for r=0.01 class 1.0 = 0.983 +- 0.150 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.01 all KL = 0.97 +- 0.150 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.01 all L1 = 0.983 +- 0.099 (in-sample avg dev_std = 0.144)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8942106969205834
len(reference) = 2093
Effective ratio: 0.224 +- 0.366
Model Accuracy over intervened graphs for r=0.1 =  0.983
SUFF_SIMPLE for r=0.1 class 1.0 = 0.981 +- 0.157 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.1 all KL = 0.966 +- 0.157 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.1 all L1 = 0.981 +- 0.102 (in-sample avg dev_std = 0.155)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.991
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8938026742301458
len(reference) = 2208
Effective ratio: 0.179 +- 0.322
Model Accuracy over intervened graphs for r=0.25 =  0.985
SUFF_SIMPLE for r=0.25 class 1.0 = 0.981 +- 0.151 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.25 all KL = 0.967 +- 0.151 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.25 all L1 = 0.981 +- 0.099 (in-sample avg dev_std = 0.149)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.982
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8421628849270667
len(reference) = 2460
Effective ratio: 0.078 +- 0.144
Model Accuracy over intervened graphs for r=0.6 =  0.995
SUFF_SIMPLE for r=0.6 class 1.0 = 0.977 +- 0.167 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.6 all KL = 0.965 +- 0.167 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.6 all L1 = 0.977 +- 0.124 (in-sample avg dev_std = 0.128)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8053718411552346
len(reference) = 277
Effective ratio: 0.415 +- 0.281
Model Accuracy over intervened graphs for r=0.01 =  0.936
NEC for r=0.01 class 1.0 = 0.097 +- 0.314 (in-sample avg dev_std = 0.442)
NEC for r=0.01 all KL = 0.197 +- 0.314 (in-sample avg dev_std = 0.442)
NEC for r=0.01 all L1 = 0.097 +- 0.168 (in-sample avg dev_std = 0.442)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9186462093862816
len(reference) = 277
Effective ratio: 0.159 +- 0.187
Model Accuracy over intervened graphs for r=0.1 =  0.142
NEC for r=0.1 class 1.0 = 0.769 +- 0.184 (in-sample avg dev_std = 0.391)
NEC for r=0.1 all KL = 0.935 +- 0.184 (in-sample avg dev_std = 0.391)
NEC for r=0.1 all L1 = 0.769 +- 0.213 (in-sample avg dev_std = 0.391)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9812202166064982
len(reference) = 277
Effective ratio: 0.103 +- 0.116
Model Accuracy over intervened graphs for r=0.25 =  0.003
NEC for r=0.25 class 1.0 = 0.861 +- 0.014 (in-sample avg dev_std = 0.070)
NEC for r=0.25 all KL = 0.997 +- 0.014 (in-sample avg dev_std = 0.070)
NEC for r=0.25 all L1 = 0.861 +- 0.028 (in-sample avg dev_std = 0.070)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7898808664259929
len(reference) = 277
Effective ratio: 0.057 +- 0.051
Model Accuracy over intervened graphs for r=0.6 =  0.238
NEC for r=0.6 class 1.0 = 0.664 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.77 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.664 +- 0.358 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.94
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7831559523809524
len(reference) = 2520
Effective ratio: 0.080 +- 0.024
Model Accuracy over intervened graphs for r=0.01 =  0.077
NEC for r=0.01 class 1.0 = 0.778 +- 0.203 (in-sample avg dev_std = 0.357)
NEC for r=0.01 all KL = 0.883 +- 0.203 (in-sample avg dev_std = 0.357)
NEC for r=0.01 all L1 = 0.778 +- 0.152 (in-sample avg dev_std = 0.357)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9343480158730157
len(reference) = 2520
Effective ratio: 0.018 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.824 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.907 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.824 +- 0.084 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.94
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9764575396825398
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.824 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.907 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.824 +- 0.084 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8164583333333333
len(reference) = 2520
Effective ratio: 0.008 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.193
NEC for r=0.6 class 1.0 = 0.655 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.72 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.655 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.982
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8909145056726094
len(reference) = 2468
Effective ratio: 0.282 +- 0.408
Model Accuracy over intervened graphs for r=0.01 =  0.226
NEC for r=0.01 class 1.0 = 0.701 +- 0.304 (in-sample avg dev_std = 0.355)
NEC for r=0.01 all KL = 0.857 +- 0.304 (in-sample avg dev_std = 0.355)
NEC for r=0.01 all L1 = 0.701 +- 0.296 (in-sample avg dev_std = 0.355)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8942106969205834
len(reference) = 2468
Effective ratio: 0.224 +- 0.366
Model Accuracy over intervened graphs for r=0.1 =  0.149
NEC for r=0.1 class 1.0 = 0.757 +- 0.260 (in-sample avg dev_std = 0.279)
NEC for r=0.1 all KL = 0.903 +- 0.260 (in-sample avg dev_std = 0.279)
NEC for r=0.1 all L1 = 0.757 +- 0.253 (in-sample avg dev_std = 0.279)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.982
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8938026742301458
len(reference) = 2468
Effective ratio: 0.179 +- 0.322
Model Accuracy over intervened graphs for r=0.25 =  0.1
NEC for r=0.25 class 1.0 = 0.785 +- 0.242 (in-sample avg dev_std = 0.209)
NEC for r=0.25 all KL = 0.923 +- 0.242 (in-sample avg dev_std = 0.209)
NEC for r=0.25 all L1 = 0.785 +- 0.228 (in-sample avg dev_std = 0.209)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.982
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8421628849270667
len(reference) = 2468
Effective ratio: 0.078 +- 0.144
Model Accuracy over intervened graphs for r=0.6 =  0.141
NEC for r=0.6 class 1.0 = 0.727 +- 0.360 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.841 +- 0.360 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.727 +- 0.312 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 20:22:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 08:22:48 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 08:22:48 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 08:22:48 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 08:22:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:22:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:22:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:22:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:22:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:22:48 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 08:22:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.919
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.980
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.968
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.952
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.948
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.995
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.989
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.953
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.925
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.932
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.937
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.944


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9191913357400723
len(reference) = 261
Effective ratio: 0.297 +- 0.254
Model Accuracy over intervened graphs for r=0.01 =  0.836
SUFF_SIMPLE for r=0.01 class 1.0 = 0.804 +- 0.421 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.01 all KL = 0.693 +- 0.421 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.01 all L1 = 0.804 +- 0.289 (in-sample avg dev_std = 0.536)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9802851985559566
len(reference) = 276
Effective ratio: 0.103 +- 0.133
Model Accuracy over intervened graphs for r=0.1 =  0.899
SUFF_SIMPLE for r=0.1 class 1.0 = 0.862 +- 0.372 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 all KL = 0.751 +- 0.372 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 all L1 = 0.862 +- 0.225 (in-sample avg dev_std = 0.506)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9677581227436821
len(reference) = 277
Effective ratio: 0.075 +- 0.070
Model Accuracy over intervened graphs for r=0.25 =  0.893
SUFF_SIMPLE for r=0.25 class 1.0 = 0.855 +- 0.380 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.25 all KL = 0.744 +- 0.380 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.25 all L1 = 0.855 +- 0.233 (in-sample avg dev_std = 0.512)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9522021660649819
len(reference) = 277
Effective ratio: 0.070 +- 0.054
Model Accuracy over intervened graphs for r=0.6 =  0.909
SUFF_SIMPLE for r=0.6 class 1.0 = 0.873 +- 0.360 (in-sample avg dev_std = 0.490)
SUFF_SIMPLE for r=0.6 all KL = 0.764 +- 0.360 (in-sample avg dev_std = 0.490)
SUFF_SIMPLE for r=0.6 all L1 = 0.873 +- 0.213 (in-sample avg dev_std = 0.490)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9475535714285714
len(reference) = 2520
Effective ratio: 0.041 +- 0.014
Model Accuracy over intervened graphs for r=0.01 =  0.779
SUFF_SIMPLE for r=0.01 class 1.0 = 0.708 +- 0.378 (in-sample avg dev_std = 0.718)
SUFF_SIMPLE for r=0.01 all KL = 0.525 +- 0.378 (in-sample avg dev_std = 0.718)
SUFF_SIMPLE for r=0.01 all L1 = 0.708 +- 0.250 (in-sample avg dev_std = 0.718)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9951130952380952
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.803
SUFF_SIMPLE for r=0.1 class 1.0 = 0.736 +- 0.378 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.1 all KL = 0.563 +- 0.378 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.1 all L1 = 0.736 +- 0.245 (in-sample avg dev_std = 0.687)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9889357142857143
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.807
SUFF_SIMPLE for r=0.25 class 1.0 = 0.741 +- 0.378 (in-sample avg dev_std = 0.684)
SUFF_SIMPLE for r=0.25 all KL = 0.567 +- 0.378 (in-sample avg dev_std = 0.684)
SUFF_SIMPLE for r=0.25 all L1 = 0.741 +- 0.243 (in-sample avg dev_std = 0.684)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9528603174603175
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.795
SUFF_SIMPLE for r=0.6 class 1.0 = 0.727 +- 0.378 (in-sample avg dev_std = 0.697)
SUFF_SIMPLE for r=0.6 all KL = 0.549 +- 0.378 (in-sample avg dev_std = 0.697)
SUFF_SIMPLE for r=0.6 all L1 = 0.727 +- 0.248 (in-sample avg dev_std = 0.697)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.996
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9245494327390598
len(reference) = 2044
Effective ratio: 0.256 +- 0.389
Model Accuracy over intervened graphs for r=0.01 =  0.953
SUFF_SIMPLE for r=0.01 class 1.0 = 0.948 +- 0.254 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.01 all KL = 0.917 +- 0.254 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.01 all L1 = 0.948 +- 0.174 (in-sample avg dev_std = 0.256)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9322435170178283
len(reference) = 2238
Effective ratio: 0.180 +- 0.324
Model Accuracy over intervened graphs for r=0.1 =  0.966
SUFF_SIMPLE for r=0.1 class 1.0 = 0.941 +- 0.264 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.1 all KL = 0.91 +- 0.264 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.1 all L1 = 0.941 +- 0.187 (in-sample avg dev_std = 0.259)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.966
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9367629659643436
len(reference) = 2434
Effective ratio: 0.119 +- 0.225
Model Accuracy over intervened graphs for r=0.25 =  0.966
SUFF_SIMPLE for r=0.25 class 1.0 = 0.935 +- 0.273 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.25 all KL = 0.905 +- 0.273 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.25 all L1 = 0.935 +- 0.199 (in-sample avg dev_std = 0.254)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.966
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9444355753646678
len(reference) = 2458
Effective ratio: 0.086 +- 0.154
Model Accuracy over intervened graphs for r=0.6 =  0.97
SUFF_SIMPLE for r=0.6 class 1.0 = 0.932 +- 0.279 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.6 all KL = 0.901 +- 0.279 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.6 all L1 = 0.932 +- 0.205 (in-sample avg dev_std = 0.259)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9191913357400723
len(reference) = 277
Effective ratio: 0.297 +- 0.254
Model Accuracy over intervened graphs for r=0.01 =  0.676
NEC for r=0.01 class 1.0 = 0.396 +- 0.365 (in-sample avg dev_std = 0.778)
NEC for r=0.01 all KL = 0.646 +- 0.365 (in-sample avg dev_std = 0.778)
NEC for r=0.01 all L1 = 0.396 +- 0.279 (in-sample avg dev_std = 0.778)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9802851985559566
len(reference) = 277
Effective ratio: 0.103 +- 0.133
Model Accuracy over intervened graphs for r=0.1 =  0.007
NEC for r=0.1 class 1.0 = 0.859 +- 0.016 (in-sample avg dev_std = 0.113)
NEC for r=0.1 all KL = 0.996 +- 0.016 (in-sample avg dev_std = 0.113)
NEC for r=0.1 all L1 = 0.859 +- 0.037 (in-sample avg dev_std = 0.113)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9677581227436821
len(reference) = 277
Effective ratio: 0.075 +- 0.070
Model Accuracy over intervened graphs for r=0.25 =  0.004
NEC for r=0.25 class 1.0 = 0.86 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.994 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.86 +- 0.052 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9522021660649819
len(reference) = 277
Effective ratio: 0.070 +- 0.054
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.863 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.998 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.863 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9475535714285714
len(reference) = 2520
Effective ratio: 0.041 +- 0.014
Model Accuracy over intervened graphs for r=0.01 =  0.0
NEC for r=0.01 class 1.0 = 0.849 +- 0.086 (in-sample avg dev_std = 0.013)
NEC for r=0.01 all KL = 0.955 +- 0.086 (in-sample avg dev_std = 0.013)
NEC for r=0.01 all L1 = 0.849 +- 0.031 (in-sample avg dev_std = 0.013)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9951130952380952
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.849 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.955 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.849 +- 0.031 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9889357142857143
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.849 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.955 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.849 +- 0.031 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9528603174603175
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.849 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.955 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.849 +- 0.031 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.966
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9245494327390598
len(reference) = 2468
Effective ratio: 0.256 +- 0.389
Model Accuracy over intervened graphs for r=0.01 =  0.121
NEC for r=0.01 class 1.0 = 0.791 +- 0.156 (in-sample avg dev_std = 0.414)
NEC for r=0.01 all KL = 0.954 +- 0.156 (in-sample avg dev_std = 0.414)
NEC for r=0.01 all L1 = 0.791 +- 0.177 (in-sample avg dev_std = 0.414)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.966
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9322435170178283
len(reference) = 2468
Effective ratio: 0.180 +- 0.324
Model Accuracy over intervened graphs for r=0.1 =  0.084
NEC for r=0.1 class 1.0 = 0.795 +- 0.201 (in-sample avg dev_std = 0.306)
NEC for r=0.1 all KL = 0.943 +- 0.201 (in-sample avg dev_std = 0.306)
NEC for r=0.1 all L1 = 0.795 +- 0.197 (in-sample avg dev_std = 0.306)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.966
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9367629659643436
len(reference) = 2468
Effective ratio: 0.119 +- 0.225
Model Accuracy over intervened graphs for r=0.25 =  0.075
NEC for r=0.25 class 1.0 = 0.781 +- 0.285 (in-sample avg dev_std = 0.104)
NEC for r=0.25 all KL = 0.905 +- 0.285 (in-sample avg dev_std = 0.104)
NEC for r=0.25 all L1 = 0.781 +- 0.248 (in-sample avg dev_std = 0.104)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.966
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9444355753646678
len(reference) = 2468
Effective ratio: 0.086 +- 0.154
Model Accuracy over intervened graphs for r=0.6 =  0.007
NEC for r=0.6 class 1.0 = 0.829 +- 0.194 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.958 +- 0.194 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.829 +- 0.167 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 20:27:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 08:27:53 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 08:27:53 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 08:27:53 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 08:27:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:27:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:27:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:27:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:27:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:27:53 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 08:27:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.722
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.838
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.966
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.888
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.511
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.679
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.924
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.914
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.887
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.894
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.893
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.879


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7215162454873647
len(reference) = 252
Effective ratio: 0.516 +- 0.237
Model Accuracy over intervened graphs for r=0.01 =  0.898
SUFF_SIMPLE for r=0.01 class 1.0 = 0.874 +- 0.334 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.01 all KL = 0.802 +- 0.334 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.01 all L1 = 0.874 +- 0.233 (in-sample avg dev_std = 0.426)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8380541516245488
len(reference) = 272
Effective ratio: 0.196 +- 0.183
Model Accuracy over intervened graphs for r=0.1 =  0.928
SUFF_SIMPLE for r=0.1 class 1.0 = 0.908 +- 0.302 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.1 all KL = 0.853 +- 0.302 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.1 all L1 = 0.908 +- 0.203 (in-sample avg dev_std = 0.382)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9659061371841154
len(reference) = 276
Effective ratio: 0.108 +- 0.111
Model Accuracy over intervened graphs for r=0.25 =  0.952
SUFF_SIMPLE for r=0.25 class 1.0 = 0.932 +- 0.254 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.25 all KL = 0.882 +- 0.254 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.25 all L1 = 0.932 +- 0.159 (in-sample avg dev_std = 0.350)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8875487364620939
len(reference) = 277
Effective ratio: 0.072 +- 0.062
Model Accuracy over intervened graphs for r=0.6 =  0.947
SUFF_SIMPLE for r=0.6 class 1.0 = 0.924 +- 0.268 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.6 all KL = 0.863 +- 0.268 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.6 all L1 = 0.924 +- 0.159 (in-sample avg dev_std = 0.383)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.638
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.5114269841269842
len(reference) = 2520
Effective ratio: 0.203 +- 0.052
Model Accuracy over intervened graphs for r=0.01 =  0.263
SUFF_SIMPLE for r=0.01 class 1.0 = 0.572 +- 0.423 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.01 all KL = 0.437 +- 0.423 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.01 all L1 = 0.572 +- 0.334 (in-sample avg dev_std = 0.685)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6792698412698414
len(reference) = 2520
Effective ratio: 0.047 +- 0.015
Model Accuracy over intervened graphs for r=0.1 =  0.286
SUFF_SIMPLE for r=0.1 class 1.0 = 0.586 +- 0.418 (in-sample avg dev_std = 0.700)
SUFF_SIMPLE for r=0.1 all KL = 0.449 +- 0.418 (in-sample avg dev_std = 0.700)
SUFF_SIMPLE for r=0.1 all L1 = 0.586 +- 0.325 (in-sample avg dev_std = 0.700)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.638
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9241452380952381
len(reference) = 2520
Effective ratio: 0.016 +- 0.004
Model Accuracy over intervened graphs for r=0.25 =  0.281
SUFF_SIMPLE for r=0.25 class 1.0 = 0.578 +- 0.416 (in-sample avg dev_std = 0.716)
SUFF_SIMPLE for r=0.25 all KL = 0.437 +- 0.416 (in-sample avg dev_std = 0.716)
SUFF_SIMPLE for r=0.25 all L1 = 0.578 +- 0.320 (in-sample avg dev_std = 0.716)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.638
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9141051587301587
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.27
SUFF_SIMPLE for r=0.6 class 1.0 = 0.572 +- 0.418 (in-sample avg dev_std = 0.702)
SUFF_SIMPLE for r=0.6 all KL = 0.434 +- 0.418 (in-sample avg dev_std = 0.702)
SUFF_SIMPLE for r=0.6 all L1 = 0.572 +- 0.325 (in-sample avg dev_std = 0.702)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8865717179902756
len(reference) = 1932
Effective ratio: 0.295 +- 0.412
Model Accuracy over intervened graphs for r=0.01 =  0.99
SUFF_SIMPLE for r=0.01 class 1.0 = 0.989 +- 0.114 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.01 all KL = 0.982 +- 0.114 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.01 all L1 = 0.989 +- 0.080 (in-sample avg dev_std = 0.113)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8935611831442465
len(reference) = 2080
Effective ratio: 0.231 +- 0.371
Model Accuracy over intervened graphs for r=0.1 =  0.988
SUFF_SIMPLE for r=0.1 class 1.0 = 0.987 +- 0.122 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.1 all KL = 0.98 +- 0.122 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.1 all L1 = 0.987 +- 0.090 (in-sample avg dev_std = 0.108)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.997
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.893347244732577
len(reference) = 2199
Effective ratio: 0.186 +- 0.326
Model Accuracy over intervened graphs for r=0.25 =  0.989
SUFF_SIMPLE for r=0.25 class 1.0 = 0.989 +- 0.110 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.25 all KL = 0.982 +- 0.110 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.25 all L1 = 0.989 +- 0.076 (in-sample avg dev_std = 0.113)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8794254457050245
len(reference) = 2417
Effective ratio: 0.110 +- 0.216
Model Accuracy over intervened graphs for r=0.6 =  0.994
SUFF_SIMPLE for r=0.6 class 1.0 = 0.978 +- 0.155 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.6 all KL = 0.966 +- 0.155 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.6 all L1 = 0.978 +- 0.113 (in-sample avg dev_std = 0.146)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7215162454873647
len(reference) = 277
Effective ratio: 0.516 +- 0.237
Model Accuracy over intervened graphs for r=0.01 =  0.909
NEC for r=0.01 class 1.0 = 0.135 +- 0.317 (in-sample avg dev_std = 0.515)
NEC for r=0.01 all KL = 0.243 +- 0.317 (in-sample avg dev_std = 0.515)
NEC for r=0.01 all L1 = 0.135 +- 0.191 (in-sample avg dev_std = 0.515)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8380541516245488
len(reference) = 277
Effective ratio: 0.196 +- 0.183
Model Accuracy over intervened graphs for r=0.1 =  0.427
NEC for r=0.1 class 1.0 = 0.589 +- 0.271 (in-sample avg dev_std = 0.707)
NEC for r=0.1 all KL = 0.798 +- 0.271 (in-sample avg dev_std = 0.707)
NEC for r=0.1 all L1 = 0.589 +- 0.270 (in-sample avg dev_std = 0.707)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9659061371841154
len(reference) = 277
Effective ratio: 0.108 +- 0.111
Model Accuracy over intervened graphs for r=0.25 =  0.003
NEC for r=0.25 class 1.0 = 0.859 +- 0.018 (in-sample avg dev_std = 0.055)
NEC for r=0.25 all KL = 0.991 +- 0.018 (in-sample avg dev_std = 0.055)
NEC for r=0.25 all L1 = 0.859 +- 0.028 (in-sample avg dev_std = 0.055)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8875487364620939
len(reference) = 277
Effective ratio: 0.072 +- 0.062
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.86 +- 0.007 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.992 +- 0.007 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.86 +- 0.001 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.638
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.5114269841269842
len(reference) = 2520
Effective ratio: 0.203 +- 0.052
Model Accuracy over intervened graphs for r=0.01 =  0.351
NEC for r=0.01 class 1.0 = 0.374 +- 0.398 (in-sample avg dev_std = 0.728)
NEC for r=0.01 all KL = 0.52 +- 0.398 (in-sample avg dev_std = 0.728)
NEC for r=0.01 all L1 = 0.374 +- 0.293 (in-sample avg dev_std = 0.728)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6792698412698414
len(reference) = 2520
Effective ratio: 0.047 +- 0.015
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.569 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.636 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.569 +- 0.385 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.638
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9241452380952381
len(reference) = 2520
Effective ratio: 0.016 +- 0.004
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.569 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.636 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.569 +- 0.385 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.638
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9141051587301587
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.569 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.636 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.569 +- 0.385 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.987
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8865717179902756
len(reference) = 2468
Effective ratio: 0.295 +- 0.412
Model Accuracy over intervened graphs for r=0.01 =  0.237
NEC for r=0.01 class 1.0 = 0.692 +- 0.301 (in-sample avg dev_std = 0.384)
NEC for r=0.01 all KL = 0.842 +- 0.301 (in-sample avg dev_std = 0.384)
NEC for r=0.01 all L1 = 0.692 +- 0.293 (in-sample avg dev_std = 0.384)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8935611831442465
len(reference) = 2468
Effective ratio: 0.231 +- 0.371
Model Accuracy over intervened graphs for r=0.1 =  0.154
NEC for r=0.1 class 1.0 = 0.749 +- 0.272 (in-sample avg dev_std = 0.274)
NEC for r=0.1 all KL = 0.886 +- 0.272 (in-sample avg dev_std = 0.274)
NEC for r=0.1 all L1 = 0.749 +- 0.260 (in-sample avg dev_std = 0.274)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.987
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.893347244732577
len(reference) = 2468
Effective ratio: 0.186 +- 0.326
Model Accuracy over intervened graphs for r=0.25 =  0.106
NEC for r=0.25 class 1.0 = 0.783 +- 0.235 (in-sample avg dev_std = 0.213)
NEC for r=0.25 all KL = 0.917 +- 0.235 (in-sample avg dev_std = 0.213)
NEC for r=0.25 all L1 = 0.783 +- 0.223 (in-sample avg dev_std = 0.213)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8794254457050245
len(reference) = 2468
Effective ratio: 0.110 +- 0.216
Model Accuracy over intervened graphs for r=0.6 =  0.036
NEC for r=0.6 class 1.0 = 0.821 +- 0.187 (in-sample avg dev_std = 0.113)
NEC for r=0.6 all KL = 0.95 +- 0.187 (in-sample avg dev_std = 0.113)
NEC for r=0.6 all L1 = 0.821 +- 0.170 (in-sample avg dev_std = 0.113)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 20:33:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 08:33:40 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 08:33:40 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 08:33:40 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 08:33:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:33:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:33:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:33:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:33:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:33:40 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 08:33:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.984
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.990
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.987
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.974
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.978
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.994
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.993
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.984
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.955
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.954
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.954
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.941


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9839819494584837
len(reference) = 276
Effective ratio: 0.123 +- 0.102
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9896895306859206
len(reference) = 276
Effective ratio: 0.095 +- 0.095
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9865451263537907
len(reference) = 276
Effective ratio: 0.092 +- 0.095
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9738989169675092
len(reference) = 276
Effective ratio: 0.089 +- 0.090
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.731
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9777166666666667
len(reference) = 2520
Effective ratio: 0.022 +- 0.007
Model Accuracy over intervened graphs for r=0.01 =  0.731
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9936079365079364
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.731
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.731
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9926206349206349
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.731
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.731
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9842785714285712
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.731
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.954978525121556
len(reference) = 2236
Effective ratio: 0.181 +- 0.312
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9542390599675851
len(reference) = 2336
Effective ratio: 0.142 +- 0.261
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9541871961102106
len(reference) = 2433
Effective ratio: 0.129 +- 0.234
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9410628038897891
len(reference) = 2443
Effective ratio: 0.121 +- 0.219
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9839819494584837
len(reference) = 277
Effective ratio: 0.123 +- 0.102
Model Accuracy over intervened graphs for r=0.01 =  0.012
NEC for r=0.01 class 1.0 = 0.856 +- 0.019 (in-sample avg dev_std = 0.184)
NEC for r=0.01 all KL = 0.988 +- 0.019 (in-sample avg dev_std = 0.184)
NEC for r=0.01 all L1 = 0.856 +- 0.034 (in-sample avg dev_std = 0.184)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9896895306859206
len(reference) = 277
Effective ratio: 0.095 +- 0.095
Model Accuracy over intervened graphs for r=0.1 =  0.002
NEC for r=0.1 class 1.0 = 0.86 +- 0.011 (in-sample avg dev_std = 0.060)
NEC for r=0.1 all KL = 0.99 +- 0.011 (in-sample avg dev_std = 0.060)
NEC for r=0.1 all L1 = 0.86 +- 0.021 (in-sample avg dev_std = 0.060)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9865451263537907
len(reference) = 277
Effective ratio: 0.092 +- 0.095
Model Accuracy over intervened graphs for r=0.25 =  0.002
NEC for r=0.25 class 1.0 = 0.86 +- 0.012 (in-sample avg dev_std = 0.059)
NEC for r=0.25 all KL = 0.99 +- 0.012 (in-sample avg dev_std = 0.059)
NEC for r=0.25 all L1 = 0.86 +- 0.021 (in-sample avg dev_std = 0.059)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9738989169675092
len(reference) = 277
Effective ratio: 0.089 +- 0.090
Model Accuracy over intervened graphs for r=0.6 =  0.001
NEC for r=0.6 class 1.0 = 0.86 +- 0.008 (in-sample avg dev_std = 0.060)
NEC for r=0.6 all KL = 0.99 +- 0.008 (in-sample avg dev_std = 0.060)
NEC for r=0.6 all L1 = 0.86 +- 0.010 (in-sample avg dev_std = 0.060)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.731
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9777166666666667
len(reference) = 2520
Effective ratio: 0.022 +- 0.007
Model Accuracy over intervened graphs for r=0.01 =  0.0
NEC for r=0.01 class 1.0 = 0.704 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.759 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.704 +- 0.259 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9936079365079364
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.704 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.759 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.704 +- 0.259 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.731
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9926206349206349
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.704 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.759 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.704 +- 0.259 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.731
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9842785714285712
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.704 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.759 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.704 +- 0.259 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.954978525121556
len(reference) = 2468
Effective ratio: 0.181 +- 0.312
Model Accuracy over intervened graphs for r=0.01 =  0.035
NEC for r=0.01 class 1.0 = 0.843 +- 0.066 (in-sample avg dev_std = 0.272)
NEC for r=0.01 all KL = 0.98 +- 0.066 (in-sample avg dev_std = 0.272)
NEC for r=0.01 all L1 = 0.843 +- 0.078 (in-sample avg dev_std = 0.272)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9542390599675851
len(reference) = 2468
Effective ratio: 0.142 +- 0.261
Model Accuracy over intervened graphs for r=0.1 =  0.021
NEC for r=0.1 class 1.0 = 0.85 +- 0.043 (in-sample avg dev_std = 0.208)
NEC for r=0.1 all KL = 0.984 +- 0.043 (in-sample avg dev_std = 0.208)
NEC for r=0.1 all L1 = 0.85 +- 0.060 (in-sample avg dev_std = 0.208)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9541871961102106
len(reference) = 2468
Effective ratio: 0.129 +- 0.234
Model Accuracy over intervened graphs for r=0.25 =  0.016
NEC for r=0.25 class 1.0 = 0.852 +- 0.066 (in-sample avg dev_std = 0.131)
NEC for r=0.25 all KL = 0.982 +- 0.066 (in-sample avg dev_std = 0.131)
NEC for r=0.25 all L1 = 0.852 +- 0.065 (in-sample avg dev_std = 0.131)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9410628038897891
len(reference) = 2468
Effective ratio: 0.121 +- 0.219
Model Accuracy over intervened graphs for r=0.6 =  0.021
NEC for r=0.6 class 1.0 = 0.848 +- 0.093 (in-sample avg dev_std = 0.117)
NEC for r=0.6 all KL = 0.977 +- 0.093 (in-sample avg dev_std = 0.117)
NEC for r=0.6 all L1 = 0.848 +- 0.086 (in-sample avg dev_std = 0.117)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 20:38:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 08:38:27 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 08:38:27 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 08:38:27 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 08:38:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:38:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:38:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:38:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:38:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:38:27 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 08:38:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.883
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.968
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.982
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.915
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.564
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.801
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.972
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.896
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.923
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.924
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.915
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.900


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.882667870036101
len(reference) = 268
Effective ratio: 0.309 +- 0.208
Model Accuracy over intervened graphs for r=0.01 =  0.569
SUFF_SIMPLE for r=0.01 class 1.0 = 0.499 +- 0.326 (in-sample avg dev_std = 0.775)
SUFF_SIMPLE for r=0.01 all KL = 0.221 +- 0.326 (in-sample avg dev_std = 0.775)
SUFF_SIMPLE for r=0.01 all L1 = 0.499 +- 0.274 (in-sample avg dev_std = 0.775)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.968173285198556
len(reference) = 276
Effective ratio: 0.116 +- 0.117
Model Accuracy over intervened graphs for r=0.1 =  0.598
SUFF_SIMPLE for r=0.1 class 1.0 = 0.501 +- 0.306 (in-sample avg dev_std = 0.846)
SUFF_SIMPLE for r=0.1 all KL = 0.199 +- 0.306 (in-sample avg dev_std = 0.846)
SUFF_SIMPLE for r=0.1 all L1 = 0.501 +- 0.245 (in-sample avg dev_std = 0.846)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9815234657039711
len(reference) = 277
Effective ratio: 0.092 +- 0.087
Model Accuracy over intervened graphs for r=0.25 =  0.622
SUFF_SIMPLE for r=0.25 class 1.0 = 0.523 +- 0.297 (in-sample avg dev_std = 0.847)
SUFF_SIMPLE for r=0.25 all KL = 0.208 +- 0.297 (in-sample avg dev_std = 0.847)
SUFF_SIMPLE for r=0.25 all L1 = 0.523 +- 0.238 (in-sample avg dev_std = 0.847)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9152202166064982
len(reference) = 277
Effective ratio: 0.078 +- 0.075
Model Accuracy over intervened graphs for r=0.6 =  0.656
SUFF_SIMPLE for r=0.6 class 1.0 = 0.551 +- 0.313 (in-sample avg dev_std = 0.837)
SUFF_SIMPLE for r=0.6 all KL = 0.236 +- 0.313 (in-sample avg dev_std = 0.837)
SUFF_SIMPLE for r=0.6 all L1 = 0.551 +- 0.238 (in-sample avg dev_std = 0.837)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.768
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.5641690476190476
len(reference) = 2520
Effective ratio: 0.193 +- 0.055
Model Accuracy over intervened graphs for r=0.01 =  0.038
SUFF_SIMPLE for r=0.01 class 1.0 = 0.313 +- 0.350 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.01 all KL = 0.249 +- 0.350 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.01 all L1 = 0.313 +- 0.276 (in-sample avg dev_std = 0.345)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8012515873015873
len(reference) = 2520
Effective ratio: 0.033 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.049
SUFF_SIMPLE for r=0.1 class 1.0 = 0.314 +- 0.344 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.1 all KL = 0.246 +- 0.344 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.1 all L1 = 0.314 +- 0.271 (in-sample avg dev_std = 0.380)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.768
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9720202380952381
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.05
SUFF_SIMPLE for r=0.25 class 1.0 = 0.314 +- 0.344 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.25 all KL = 0.247 +- 0.344 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.25 all L1 = 0.314 +- 0.271 (in-sample avg dev_std = 0.383)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.768
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.895943253968254
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.054
SUFF_SIMPLE for r=0.6 class 1.0 = 0.315 +- 0.343 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.6 all KL = 0.246 +- 0.343 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.6 all L1 = 0.315 +- 0.269 (in-sample avg dev_std = 0.400)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.994
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9226758508914099
len(reference) = 2033
Effective ratio: 0.248 +- 0.383
Model Accuracy over intervened graphs for r=0.01 =  0.889
SUFF_SIMPLE for r=0.01 class 1.0 = 0.875 +- 0.368 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.01 all KL = 0.811 +- 0.368 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.01 all L1 = 0.875 +- 0.260 (in-sample avg dev_std = 0.372)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.985
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9243221231766612
len(reference) = 2174
Effective ratio: 0.193 +- 0.335
Model Accuracy over intervened graphs for r=0.1 =  0.863
SUFF_SIMPLE for r=0.1 class 1.0 = 0.851 +- 0.390 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.1 all KL = 0.785 +- 0.390 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.1 all L1 = 0.851 +- 0.286 (in-sample avg dev_std = 0.375)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.975
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9154955429497568
len(reference) = 2297
Effective ratio: 0.154 +- 0.288
Model Accuracy over intervened graphs for r=0.25 =  0.874
SUFF_SIMPLE for r=0.25 class 1.0 = 0.866 +- 0.377 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.25 all KL = 0.801 +- 0.377 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.25 all L1 = 0.866 +- 0.269 (in-sample avg dev_std = 0.368)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.962
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8997536466774715
len(reference) = 2397
Effective ratio: 0.117 +- 0.228
Model Accuracy over intervened graphs for r=0.6 =  0.9
SUFF_SIMPLE for r=0.6 class 1.0 = 0.899 +- 0.340 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.6 all KL = 0.84 +- 0.340 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.6 all L1 = 0.899 +- 0.226 (in-sample avg dev_std = 0.360)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.882667870036101
len(reference) = 277
Effective ratio: 0.309 +- 0.208
Model Accuracy over intervened graphs for r=0.01 =  0.454
NEC for r=0.01 class 1.0 = 0.596 +- 0.199 (in-sample avg dev_std = 0.815)
NEC for r=0.01 all KL = 0.883 +- 0.199 (in-sample avg dev_std = 0.815)
NEC for r=0.01 all L1 = 0.596 +- 0.233 (in-sample avg dev_std = 0.815)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.968173285198556
len(reference) = 277
Effective ratio: 0.116 +- 0.117
Model Accuracy over intervened graphs for r=0.1 =  0.005
NEC for r=0.1 class 1.0 = 0.862 +- 0.008 (in-sample avg dev_std = 0.104)
NEC for r=0.1 all KL = 0.999 +- 0.008 (in-sample avg dev_std = 0.104)
NEC for r=0.1 all L1 = 0.862 +- 0.022 (in-sample avg dev_std = 0.104)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9815234657039711
len(reference) = 277
Effective ratio: 0.092 +- 0.087
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.864 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.999 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.864 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9152202166064982
len(reference) = 277
Effective ratio: 0.078 +- 0.075
Model Accuracy over intervened graphs for r=0.6 =  0.065
NEC for r=0.6 class 1.0 = 0.808 +- 0.244 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.935 +- 0.244 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.808 +- 0.211 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.768
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.5641690476190476
len(reference) = 2520
Effective ratio: 0.193 +- 0.055
Model Accuracy over intervened graphs for r=0.01 =  0.144
NEC for r=0.01 class 1.0 = 0.67 +- 0.308 (in-sample avg dev_std = 0.575)
NEC for r=0.01 all KL = 0.76 +- 0.308 (in-sample avg dev_std = 0.575)
NEC for r=0.01 all L1 = 0.67 +- 0.237 (in-sample avg dev_std = 0.575)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8012515873015873
len(reference) = 2520
Effective ratio: 0.033 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.696 +- 0.356 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.75 +- 0.356 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.696 +- 0.285 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.768
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9720202380952381
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.696 +- 0.356 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.75 +- 0.356 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.696 +- 0.285 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.768
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.895943253968254
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.112
NEC for r=0.6 class 1.0 = 0.613 +- 0.408 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.655 +- 0.408 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.613 +- 0.338 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.947
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9226758508914099
len(reference) = 2468
Effective ratio: 0.248 +- 0.383
Model Accuracy over intervened graphs for r=0.01 =  0.039
NEC for r=0.01 class 1.0 = 0.824 +- 0.129 (in-sample avg dev_std = 0.327)
NEC for r=0.01 all KL = 0.97 +- 0.129 (in-sample avg dev_std = 0.327)
NEC for r=0.01 all L1 = 0.824 +- 0.134 (in-sample avg dev_std = 0.327)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.947
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9243221231766612
len(reference) = 2468
Effective ratio: 0.193 +- 0.335
Model Accuracy over intervened graphs for r=0.1 =  0.024
NEC for r=0.1 class 1.0 = 0.824 +- 0.159 (in-sample avg dev_std = 0.259)
NEC for r=0.1 all KL = 0.963 +- 0.159 (in-sample avg dev_std = 0.259)
NEC for r=0.1 all L1 = 0.824 +- 0.149 (in-sample avg dev_std = 0.259)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.947
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9154955429497568
len(reference) = 2468
Effective ratio: 0.154 +- 0.288
Model Accuracy over intervened graphs for r=0.25 =  0.017
NEC for r=0.25 class 1.0 = 0.827 +- 0.171 (in-sample avg dev_std = 0.205)
NEC for r=0.25 all KL = 0.961 +- 0.171 (in-sample avg dev_std = 0.205)
NEC for r=0.25 all L1 = 0.827 +- 0.153 (in-sample avg dev_std = 0.205)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.947
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8997536466774715
len(reference) = 2468
Effective ratio: 0.117 +- 0.228
Model Accuracy over intervened graphs for r=0.6 =  0.031
NEC for r=0.6 class 1.0 = 0.813 +- 0.219 (in-sample avg dev_std = 0.149)
NEC for r=0.6 all KL = 0.941 +- 0.219 (in-sample avg dev_std = 0.149)
NEC for r=0.6 all L1 = 0.813 +- 0.190 (in-sample avg dev_std = 0.149)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.98, 0.989, 0.992, 0.992], 'all_L1': [0.988, 0.994, 0.997, 0.997]}), defaultdict(<class 'list'>, {'all_KL': [0.978, 0.986, 0.987, 0.992], 'all_L1': [0.987, 0.992, 0.993, 0.996]}), defaultdict(<class 'list'>, {'all_KL': [0.764, 0.787, 0.804, 0.76], 'all_L1': [0.849, 0.872, 0.884, 0.856]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.928, 0.913, 0.94, 0.955], 'all_L1': [0.959, 0.955, 0.974, 0.98]}), defaultdict(<class 'list'>, {'all_KL': [0.693, 0.751, 0.744, 0.764], 'all_L1': [0.804, 0.862, 0.855, 0.873]}), defaultdict(<class 'list'>, {'all_KL': [0.802, 0.853, 0.882, 0.863], 'all_L1': [0.874, 0.908, 0.932, 0.924]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.221, 0.199, 0.208, 0.236], 'all_L1': [0.499, 0.501, 0.523, 0.551]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.993, 0.999, 0.643, 0.002], 'all_L1': [0.846, 0.864, 0.526, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.134, 0.952, 0.999, 0.977], 'all_L1': [0.063, 0.795, 0.864, 0.845]}), defaultdict(<class 'list'>, {'all_KL': [0.141, 0.871, 0.995, 0.996], 'all_L1': [0.075, 0.689, 0.861, 0.863]}), defaultdict(<class 'list'>, {'all_KL': [0.482, 0.989, 0.969, 0.014], 'all_L1': [0.346, 0.86, 0.842, 0.012]}), defaultdict(<class 'list'>, {'all_KL': [0.818, 0.998, 0.998, 0.571], 'all_L1': [0.623, 0.864, 0.864, 0.487]}), defaultdict(<class 'list'>, {'all_KL': [0.197, 0.935, 0.997, 0.77], 'all_L1': [0.097, 0.769, 0.861, 0.664]}), defaultdict(<class 'list'>, {'all_KL': [0.646, 0.996, 0.994, 0.998], 'all_L1': [0.396, 0.859, 0.86, 0.863]}), defaultdict(<class 'list'>, {'all_KL': [0.243, 0.798, 0.991, 0.992], 'all_L1': [0.135, 0.589, 0.859, 0.86]}), defaultdict(<class 'list'>, {'all_KL': [0.988, 0.99, 0.99, 0.99], 'all_L1': [0.856, 0.86, 0.86, 0.86]}), defaultdict(<class 'list'>, {'all_KL': [0.883, 0.999, 0.999, 0.935], 'all_L1': [0.596, 0.862, 0.864, 0.808]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.909, 0.906, 0.919, 0.917], 'all_L1': [0.959, 0.958, 0.964, 0.963]}), defaultdict(<class 'list'>, {'all_KL': [0.999, 1.0, 0.999, 1.0], 'all_L1': [0.999, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.346, 0.352, 0.353, 0.356], 'all_L1': [0.478, 0.485, 0.491, 0.494]}), defaultdict(<class 'list'>, {'all_KL': [0.998, 0.998, 0.999, 0.996], 'all_L1': [0.999, 0.999, 0.999, 0.998]}), defaultdict(<class 'list'>, {'all_KL': [0.488, 0.531, 0.538, 0.573], 'all_L1': [0.682, 0.718, 0.72, 0.747]}), defaultdict(<class 'list'>, {'all_KL': [0.525, 0.563, 0.567, 0.549], 'all_L1': [0.708, 0.736, 0.741, 0.727]}), defaultdict(<class 'list'>, {'all_KL': [0.437, 0.449, 0.437, 0.434], 'all_L1': [0.572, 0.586, 0.578, 0.572]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.249, 0.246, 0.247, 0.246], 'all_L1': [0.313, 0.314, 0.314, 0.315]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.962, 0.961, 0.595, 0.007], 'all_L1': [0.852, 0.852, 0.52, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.925, 0.995, 0.995, 0.949], 'all_L1': [0.75, 0.863, 0.863, 0.822]}), defaultdict(<class 'list'>, {'all_KL': [0.734, 0.856, 0.856, 0.856], 'all_L1': [0.615, 0.776, 0.776, 0.776]}), defaultdict(<class 'list'>, {'all_KL': [0.766, 0.78, 0.78, 0.014], 'all_L1': [0.702, 0.729, 0.729, 0.014]}), defaultdict(<class 'list'>, {'all_KL': [0.874, 0.874, 0.874, 0.525], 'all_L1': [0.802, 0.802, 0.802, 0.489]}), defaultdict(<class 'list'>, {'all_KL': [0.883, 0.907, 0.907, 0.72], 'all_L1': [0.778, 0.824, 0.824, 0.655]}), defaultdict(<class 'list'>, {'all_KL': [0.955, 0.955, 0.955, 0.955], 'all_L1': [0.849, 0.849, 0.849, 0.849]}), defaultdict(<class 'list'>, {'all_KL': [0.52, 0.636, 0.636, 0.636], 'all_L1': [0.374, 0.569, 0.569, 0.569]}), defaultdict(<class 'list'>, {'all_KL': [0.759, 0.759, 0.759, 0.759], 'all_L1': [0.704, 0.704, 0.704, 0.704]}), defaultdict(<class 'list'>, {'all_KL': [0.76, 0.75, 0.75, 0.655], 'all_L1': [0.67, 0.696, 0.696, 0.613]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 0.989], 'all_L1': [1.0, 1.0, 1.0, 0.994]}), defaultdict(<class 'list'>, {'all_KL': [0.996, 0.995, 0.998, 0.998], 'all_L1': [0.997, 0.997, 0.999, 0.998]}), defaultdict(<class 'list'>, {'all_KL': [0.994, 0.994, 0.994, 0.991], 'all_L1': [0.996, 0.996, 0.996, 0.992]}), defaultdict(<class 'list'>, {'all_KL': [0.965, 0.968, 0.97, 0.942], 'all_L1': [0.977, 0.979, 0.978, 0.959]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.97, 0.966, 0.967, 0.965], 'all_L1': [0.983, 0.981, 0.981, 0.977]}), defaultdict(<class 'list'>, {'all_KL': [0.917, 0.91, 0.905, 0.901], 'all_L1': [0.948, 0.941, 0.935, 0.932]}), defaultdict(<class 'list'>, {'all_KL': [0.982, 0.98, 0.982, 0.966], 'all_L1': [0.989, 0.987, 0.989, 0.978]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.811, 0.785, 0.801, 0.84], 'all_L1': [0.875, 0.851, 0.866, 0.899]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.908, 0.942, 0.575, 0.002], 'all_L1': [0.772, 0.811, 0.49, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.856, 0.905, 0.935, 0.965], 'all_L1': [0.697, 0.758, 0.797, 0.834]}), defaultdict(<class 'list'>, {'all_KL': [0.837, 0.896, 0.934, 0.978], 'all_L1': [0.689, 0.756, 0.8, 0.848]}), defaultdict(<class 'list'>, {'all_KL': [0.888, 0.924, 0.925, 0.12], 'all_L1': [0.757, 0.797, 0.801, 0.107]}), defaultdict(<class 'list'>, {'all_KL': [0.904, 0.946, 0.962, 0.888], 'all_L1': [0.761, 0.804, 0.826, 0.766]}), defaultdict(<class 'list'>, {'all_KL': [0.857, 0.903, 0.923, 0.841], 'all_L1': [0.701, 0.757, 0.785, 0.727]}), defaultdict(<class 'list'>, {'all_KL': [0.954, 0.943, 0.905, 0.958], 'all_L1': [0.791, 0.795, 0.781, 0.829]}), defaultdict(<class 'list'>, {'all_KL': [0.842, 0.886, 0.917, 0.95], 'all_L1': [0.692, 0.749, 0.783, 0.821]}), defaultdict(<class 'list'>, {'all_KL': [0.98, 0.984, 0.982, 0.977], 'all_L1': [0.843, 0.85, 0.852, 0.848]}), defaultdict(<class 'list'>, {'all_KL': [0.97, 0.963, 0.961, 0.941], 'all_L1': [0.824, 0.824, 0.827, 0.813]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.896 +- 0.149, 0.908 +- 0.145, 0.916 +- 0.140, 0.918 +- 0.133
suff_simple class all_KL  =  0.837 +- 0.231, 0.848 +- 0.234, 0.856 +- 0.233, 0.856 +- 0.226
suff_simple_acc_int  =  0.914 +- 0.127, 0.929 +- 0.117, 0.937 +- 0.111, 0.940 +- 0.101
nec class all_L1  =  0.403 +- 0.296, 0.801 +- 0.090, 0.826 +- 0.100, 0.626 +- 0.330
nec class all_KL  =  0.552 +- 0.338, 0.953 +- 0.065, 0.957 +- 0.105, 0.725 +- 0.381
nec_acc_int  =  0.595 +- 0.350, 0.095 +- 0.139, 0.048 +- 0.130, 0.276 +- 0.383

Eval split val
suff_simple class all_L1  =  0.771 +- 0.243, 0.780 +- 0.239, 0.781 +- 0.240, 0.782 +- 0.239
suff_simple class all_KL  =  0.695 +- 0.296, 0.705 +- 0.290, 0.706 +- 0.291, 0.707 +- 0.290
suff_simple_acc_int  =  0.659 +- 0.312, 0.668 +- 0.308, 0.670 +- 0.308, 0.671 +- 0.308
nec class all_L1  =  0.710 +- 0.133, 0.766 +- 0.088, 0.733 +- 0.109, 0.550 +- 0.290
nec class all_KL  =  0.814 +- 0.128, 0.847 +- 0.108, 0.811 +- 0.124, 0.608 +- 0.325
nec_acc_int  =  0.103 +- 0.115, 0.000 +- 0.000, 0.042 +- 0.126, 0.246 +- 0.336

Eval split test
suff_simple class all_L1  =  0.977 +- 0.037, 0.973 +- 0.044, 0.974 +- 0.041, 0.973 +- 0.032
suff_simple class all_KL  =  0.964 +- 0.056, 0.960 +- 0.064, 0.962 +- 0.060, 0.959 +- 0.050
suff_simple_acc_int  =  0.979 +- 0.033, 0.978 +- 0.039, 0.980 +- 0.037, 0.984 +- 0.029
nec class all_L1  =  0.753 +- 0.054, 0.790 +- 0.032, 0.774 +- 0.097, 0.659 +- 0.306
nec class all_KL  =  0.900 +- 0.051, 0.929 +- 0.030, 0.902 +- 0.111, 0.762 +- 0.354
nec_acc_int  =  0.152 +- 0.074, 0.095 +- 0.048, 0.104 +- 0.117, 0.227 +- 0.359


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.650 +- 0.161, 0.855 +- 0.078, 0.871 +- 0.077, 0.772 +- 0.172
Faith. Armon (L1)= 		  =  0.484 +- 0.296, 0.840 +- 0.092, 0.857 +- 0.097, 0.665 +- 0.340
Faith. GMean (L1)= 	  =  0.546 +- 0.246, 0.847 +- 0.085, 0.864 +- 0.087, 0.684 +- 0.321
Faith. Aritm (KL)= 		  =  0.695 +- 0.184, 0.900 +- 0.115, 0.907 +- 0.117, 0.790 +- 0.210
Faith. Armon (KL)= 		  =  0.568 +- 0.290, 0.870 +- 0.189, 0.874 +- 0.190, 0.675 +- 0.373
Faith. GMean (KL)= 	  =  0.622 +- 0.244, 0.883 +- 0.157, 0.888 +- 0.158, 0.700 +- 0.347

Eval split val
Faith. Aritm (L1)= 		  =  0.740 +- 0.157, 0.773 +- 0.147, 0.757 +- 0.138, 0.666 +- 0.201
Faith. Armon (L1)= 		  =  0.719 +- 0.167, 0.757 +- 0.160, 0.734 +- 0.151, 0.575 +- 0.309
Faith. GMean (L1)= 	  =  0.729 +- 0.162, 0.765 +- 0.153, 0.745 +- 0.145, 0.596 +- 0.290
Faith. Aritm (KL)= 		  =  0.754 +- 0.179, 0.776 +- 0.176, 0.758 +- 0.165, 0.657 +- 0.229
Faith. Armon (KL)= 		  =  0.717 +- 0.209, 0.741 +- 0.210, 0.718 +- 0.195, 0.566 +- 0.321
Faith. GMean (KL)= 	  =  0.735 +- 0.195, 0.758 +- 0.194, 0.737 +- 0.181, 0.590 +- 0.302

Eval split test
Faith. Aritm (L1)= 		  =  0.865 +- 0.025, 0.882 +- 0.023, 0.874 +- 0.048, 0.816 +- 0.152
Faith. Armon (L1)= 		  =  0.848 +- 0.031, 0.871 +- 0.023, 0.858 +- 0.070, 0.726 +- 0.318
Faith. GMean (L1)= 	  =  0.856 +- 0.027, 0.876 +- 0.023, 0.866 +- 0.059, 0.746 +- 0.290
Faith. Aritm (KL)= 		  =  0.932 +- 0.027, 0.944 +- 0.031, 0.932 +- 0.057, 0.861 +- 0.177
Faith. Armon (KL)= 		  =  0.928 +- 0.028, 0.943 +- 0.033, 0.925 +- 0.073, 0.778 +- 0.340
Faith. GMean (KL)= 	  =  0.930 +- 0.028, 0.944 +- 0.032, 0.928 +- 0.065, 0.795 +- 0.311
Computed for split load_split = id



Completed in  0:51:51.260577  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN TopoFeature/basis/no_shift NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 20:44:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 08:44:02 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 08:44:02 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 08:44:02 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 08:44:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:44:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:44:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:44:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:44:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:44:02 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 08:44:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.103
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.099
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.058
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.057
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.012
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.113
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.111
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.088
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10290252707581228
len(reference) = 276
Effective ratio: 0.196 +- 0.158
Model Accuracy over intervened graphs for r=0.01 =  0.997
SUFF_SIMPLE for r=0.01 class 1.0 = 0.994 +- 0.092 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.01 all KL = 0.985 +- 0.092 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.01 all L1 = 0.994 +- 0.035 (in-sample avg dev_std = 0.109)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0993971119133574
len(reference) = 277
Effective ratio: 0.118 +- 0.110
Model Accuracy over intervened graphs for r=0.1 =  0.991
SUFF_SIMPLE for r=0.1 class 1.0 = 0.99 +- 0.106 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.1 all KL = 0.984 +- 0.106 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.1 all L1 = 0.99 +- 0.077 (in-sample avg dev_std = 0.080)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.057844765342960285
len(reference) = 277
Effective ratio: 0.024 +- 0.030
Model Accuracy over intervened graphs for r=0.25 =  0.986
SUFF_SIMPLE for r=0.25 class 1.0 = 0.981 +- 0.164 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.25 all KL = 0.964 +- 0.164 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.25 all L1 = 0.981 +- 0.096 (in-sample avg dev_std = 0.184)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05655595667870036
len(reference) = 277
Effective ratio: 0.023 +- 0.022
Model Accuracy over intervened graphs for r=0.6 =  0.98
SUFF_SIMPLE for r=0.6 class 1.0 = 0.972 +- 0.196 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.6 all KL = 0.947 +- 0.196 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.6 all L1 = 0.972 +- 0.113 (in-sample avg dev_std = 0.225)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012415873015873016
len(reference) = 2520
Effective ratio: 0.029 +- 0.007
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.013 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.01 all KL = 0.999 +- 0.013 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.007 (in-sample avg dev_std = 0.022)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012115873015873014
len(reference) = 2520
Effective ratio: 0.016 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.001)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.002 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.002 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.004 (in-sample avg dev_std = 0.010)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.020 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.6 all KL = 0.999 +- 0.020 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.008 (in-sample avg dev_std = 0.024)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.1126754457050243
len(reference) = 2192
Effective ratio: 0.230 +- 0.340
Model Accuracy over intervened graphs for r=0.01 =  0.992
SUFF_SIMPLE for r=0.01 class 1.0 = 0.985 +- 0.134 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.01 all KL = 0.963 +- 0.134 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.01 all L1 = 0.985 +- 0.054 (in-sample avg dev_std = 0.166)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11052674230145866
len(reference) = 2306
Effective ratio: 0.172 +- 0.287
Model Accuracy over intervened graphs for r=0.1 =  0.991
SUFF_SIMPLE for r=0.1 class 1.0 = 0.985 +- 0.134 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.1 all KL = 0.964 +- 0.134 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.1 all L1 = 0.985 +- 0.061 (in-sample avg dev_std = 0.162)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08777066450567261
len(reference) = 2384
Effective ratio: 0.082 +- 0.214
Model Accuracy over intervened graphs for r=0.25 =  0.979
SUFF_SIMPLE for r=0.25 class 1.0 = 0.97 +- 0.196 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.25 all KL = 0.94 +- 0.196 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.25 all L1 = 0.97 +- 0.110 (in-sample avg dev_std = 0.225)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05850202593192869
len(reference) = 2468
Effective ratio: 0.030 +- 0.050
Model Accuracy over intervened graphs for r=0.6 =  0.972
SUFF_SIMPLE for r=0.6 class 1.0 = 0.96 +- 0.228 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.6 all KL = 0.918 +- 0.228 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.6 all L1 = 0.96 +- 0.124 (in-sample avg dev_std = 0.272)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10290252707581228
len(reference) = 277
Effective ratio: 0.196 +- 0.158
Model Accuracy over intervened graphs for r=0.01 =  0.993
NEC for r=0.01 class 1.0 = 0.008 +- 0.106 (in-sample avg dev_std = 0.098)
NEC for r=0.01 all KL = 0.013 +- 0.106 (in-sample avg dev_std = 0.098)
NEC for r=0.01 all L1 = 0.008 +- 0.069 (in-sample avg dev_std = 0.098)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0993971119133574
len(reference) = 277
Effective ratio: 0.118 +- 0.110
Model Accuracy over intervened graphs for r=0.1 =  0.993
NEC for r=0.1 class 1.0 = 0.006 +- 0.085 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.007 +- 0.085 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.006 +- 0.073 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.057844765342960285
len(reference) = 277
Effective ratio: 0.024 +- 0.030
Model Accuracy over intervened graphs for r=0.25 =  1.0
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05655595667870036
len(reference) = 277
Effective ratio: 0.023 +- 0.022
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012415873015873016
len(reference) = 2520
Effective ratio: 0.029 +- 0.007
Model Accuracy over intervened graphs for r=0.01 =  1.0
NEC for r=0.01 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012115873015873014
len(reference) = 2520
Effective ratio: 0.016 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.25 =  1.0
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.1126754457050243
len(reference) = 2468
Effective ratio: 0.230 +- 0.340
Model Accuracy over intervened graphs for r=0.01 =  0.988
NEC for r=0.01 class 1.0 = 0.016 +- 0.152 (in-sample avg dev_std = 0.162)
NEC for r=0.01 all KL = 0.033 +- 0.152 (in-sample avg dev_std = 0.162)
NEC for r=0.01 all L1 = 0.016 +- 0.086 (in-sample avg dev_std = 0.162)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11052674230145866
len(reference) = 2468
Effective ratio: 0.172 +- 0.287
Model Accuracy over intervened graphs for r=0.1 =  0.994
NEC for r=0.1 class 1.0 = 0.008 +- 0.106 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all KL = 0.015 +- 0.106 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all L1 = 0.008 +- 0.061 (in-sample avg dev_std = 0.110)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08777066450567261
len(reference) = 2468
Effective ratio: 0.082 +- 0.214
Model Accuracy over intervened graphs for r=0.25 =  0.998
NEC for r=0.25 class 1.0 = 0.002 +- 0.051 (in-sample avg dev_std = 0.050)
NEC for r=0.25 all KL = 0.003 +- 0.051 (in-sample avg dev_std = 0.050)
NEC for r=0.25 all L1 = 0.002 +- 0.032 (in-sample avg dev_std = 0.050)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05850202593192869
len(reference) = 2468
Effective ratio: 0.030 +- 0.050
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 20:49:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 08:49:33 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 08:49:33 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 08:49:33 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 08:49:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:49:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:49:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:49:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:49:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:49:33 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 08:49:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.092
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.089
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.085
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.065
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.012
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.112
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.111
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.109
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.083


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.0916534296028881
len(reference) = 237
Effective ratio: 0.583 +- 0.272
Model Accuracy over intervened graphs for r=0.01 =  0.968
SUFF_SIMPLE for r=0.01 class 1.0 = 0.953 +- 0.250 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.01 all KL = 0.907 +- 0.250 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.01 all L1 = 0.953 +- 0.134 (in-sample avg dev_std = 0.304)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08918050541516247
len(reference) = 270
Effective ratio: 0.202 +- 0.193
Model Accuracy over intervened graphs for r=0.1 =  0.925
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.315 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.1 all KL = 0.839 +- 0.315 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.1 all L1 = 0.91 +- 0.204 (in-sample avg dev_std = 0.346)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08541516245487363
len(reference) = 277
Effective ratio: 0.141 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.927
SUFF_SIMPLE for r=0.25 class 1.0 = 0.908 +- 0.322 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.25 all KL = 0.83 +- 0.322 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.25 all L1 = 0.908 +- 0.199 (in-sample avg dev_std = 0.375)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.06506859205776173
len(reference) = 277
Effective ratio: 0.024 +- 0.032
Model Accuracy over intervened graphs for r=0.6 =  0.932
SUFF_SIMPLE for r=0.6 class 1.0 = 0.902 +- 0.332 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.6 all KL = 0.805 +- 0.332 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.6 all L1 = 0.902 +- 0.183 (in-sample avg dev_std = 0.433)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012118650793650794
len(reference) = 2520
Effective ratio: 0.110 +- 0.037
Model Accuracy over intervened graphs for r=0.01 =  0.95
SUFF_SIMPLE for r=0.01 class 1.0 = 0.92 +- 0.290 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.01 all KL = 0.824 +- 0.290 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.01 all L1 = 0.92 +- 0.140 (in-sample avg dev_std = 0.414)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01192579365079365
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.948
SUFF_SIMPLE for r=0.1 class 1.0 = 0.916 +- 0.294 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.1 all KL = 0.817 +- 0.294 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.1 all L1 = 0.916 +- 0.143 (in-sample avg dev_std = 0.423)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01169484126984127
len(reference) = 2520
Effective ratio: 0.023 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.949
SUFF_SIMPLE for r=0.25 class 1.0 = 0.917 +- 0.292 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.25 all KL = 0.819 +- 0.292 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.25 all L1 = 0.917 +- 0.141 (in-sample avg dev_std = 0.420)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.010062301587301587
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.947
SUFF_SIMPLE for r=0.6 class 1.0 = 0.913 +- 0.298 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.6 all KL = 0.81 +- 0.298 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.6 all L1 = 0.913 +- 0.143 (in-sample avg dev_std = 0.431)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11172082658022689
len(reference) = 1975
Effective ratio: 0.312 +- 0.401
Model Accuracy over intervened graphs for r=0.01 =  0.971
SUFF_SIMPLE for r=0.01 class 1.0 = 0.96 +- 0.229 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.01 all KL = 0.92 +- 0.229 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.01 all L1 = 0.96 +- 0.129 (in-sample avg dev_std = 0.266)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11134481361426256
len(reference) = 2130
Effective ratio: 0.237 +- 0.354
Model Accuracy over intervened graphs for r=0.1 =  0.967
SUFF_SIMPLE for r=0.1 class 1.0 = 0.955 +- 0.240 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.1 all KL = 0.912 +- 0.240 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.1 all L1 = 0.955 +- 0.138 (in-sample avg dev_std = 0.273)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.999
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10893881685575364
len(reference) = 2296
Effective ratio: 0.176 +- 0.290
Model Accuracy over intervened graphs for r=0.25 =  0.961
SUFF_SIMPLE for r=0.25 class 1.0 = 0.95 +- 0.248 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.25 all KL = 0.907 +- 0.248 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.25 all L1 = 0.95 +- 0.152 (in-sample avg dev_std = 0.268)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.998
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0834035656401945
len(reference) = 2450
Effective ratio: 0.073 +- 0.171
Model Accuracy over intervened graphs for r=0.6 =  0.955
SUFF_SIMPLE for r=0.6 class 1.0 = 0.938 +- 0.274 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.6 all KL = 0.88 +- 0.274 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.6 all L1 = 0.938 +- 0.161 (in-sample avg dev_std = 0.322)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.0916534296028881
len(reference) = 277
Effective ratio: 0.583 +- 0.272
Model Accuracy over intervened graphs for r=0.01 =  0.958
NEC for r=0.01 class 1.0 = 0.062 +- 0.284 (in-sample avg dev_std = 0.348)
NEC for r=0.01 all KL = 0.118 +- 0.284 (in-sample avg dev_std = 0.348)
NEC for r=0.01 all L1 = 0.062 +- 0.157 (in-sample avg dev_std = 0.348)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08918050541516247
len(reference) = 277
Effective ratio: 0.202 +- 0.193
Model Accuracy over intervened graphs for r=0.1 =  0.972
NEC for r=0.1 class 1.0 = 0.036 +- 0.218 (in-sample avg dev_std = 0.241)
NEC for r=0.1 all KL = 0.063 +- 0.218 (in-sample avg dev_std = 0.241)
NEC for r=0.1 all L1 = 0.036 +- 0.135 (in-sample avg dev_std = 0.241)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08541516245487363
len(reference) = 277
Effective ratio: 0.141 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.986
NEC for r=0.25 class 1.0 = 0.012 +- 0.119 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.014 +- 0.119 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.012 +- 0.103 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.06506859205776173
len(reference) = 277
Effective ratio: 0.024 +- 0.032
Model Accuracy over intervened graphs for r=0.6 =  0.996
NEC for r=0.6 class 1.0 = 0.003 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.004 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.003 +- 0.052 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012118650793650794
len(reference) = 2520
Effective ratio: 0.110 +- 0.037
Model Accuracy over intervened graphs for r=0.01 =  0.987
NEC for r=0.01 class 1.0 = 0.017 +- 0.149 (in-sample avg dev_std = 0.155)
NEC for r=0.01 all KL = 0.028 +- 0.149 (in-sample avg dev_std = 0.155)
NEC for r=0.01 all L1 = 0.017 +- 0.095 (in-sample avg dev_std = 0.155)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01192579365079365
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01169484126984127
len(reference) = 2520
Effective ratio: 0.023 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  1.0
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.010062301587301587
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.998
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11172082658022689
len(reference) = 2468
Effective ratio: 0.312 +- 0.401
Model Accuracy over intervened graphs for r=0.01 =  0.964
NEC for r=0.01 class 1.0 = 0.054 +- 0.264 (in-sample avg dev_std = 0.318)
NEC for r=0.01 all KL = 0.107 +- 0.264 (in-sample avg dev_std = 0.318)
NEC for r=0.01 all L1 = 0.054 +- 0.145 (in-sample avg dev_std = 0.318)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11134481361426256
len(reference) = 2468
Effective ratio: 0.237 +- 0.354
Model Accuracy over intervened graphs for r=0.1 =  0.968
NEC for r=0.1 class 1.0 = 0.042 +- 0.235 (in-sample avg dev_std = 0.259)
NEC for r=0.1 all KL = 0.08 +- 0.235 (in-sample avg dev_std = 0.259)
NEC for r=0.1 all L1 = 0.042 +- 0.140 (in-sample avg dev_std = 0.259)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.998
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10893881685575364
len(reference) = 2468
Effective ratio: 0.176 +- 0.290
Model Accuracy over intervened graphs for r=0.25 =  0.974
NEC for r=0.25 class 1.0 = 0.031 +- 0.200 (in-sample avg dev_std = 0.187)
NEC for r=0.25 all KL = 0.051 +- 0.200 (in-sample avg dev_std = 0.187)
NEC for r=0.25 all L1 = 0.031 +- 0.135 (in-sample avg dev_std = 0.187)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.998
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0834035656401945
len(reference) = 2468
Effective ratio: 0.073 +- 0.171
Model Accuracy over intervened graphs for r=0.6 =  0.987
NEC for r=0.6 class 1.0 = 0.011 +- 0.113 (in-sample avg dev_std = 0.025)
NEC for r=0.6 all KL = 0.013 +- 0.113 (in-sample avg dev_std = 0.025)
NEC for r=0.6 all L1 = 0.011 +- 0.097 (in-sample avg dev_std = 0.025)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 20:54:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 08:54:11 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 08:54:11 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 08:54:11 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 08:54:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:54:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:54:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:54:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:54:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:54:11 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 08:54:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.101
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.101
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.101
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.074
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.013
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.013
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.111
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.111
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.109
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.089


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10113718411552347
len(reference) = 233
Effective ratio: 0.580 +- 0.257
Model Accuracy over intervened graphs for r=0.01 =  0.973
SUFF_SIMPLE for r=0.01 class 1.0 = 0.965 +- 0.200 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.01 all KL = 0.941 +- 0.200 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.01 all L1 = 0.965 +- 0.129 (in-sample avg dev_std = 0.232)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.10067509025270759
len(reference) = 271
Effective ratio: 0.227 +- 0.219
Model Accuracy over intervened graphs for r=0.1 =  0.942
SUFF_SIMPLE for r=0.1 class 1.0 = 0.933 +- 0.264 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.1 all KL = 0.892 +- 0.264 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.1 all L1 = 0.933 +- 0.185 (in-sample avg dev_std = 0.282)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10105415162454874
len(reference) = 276
Effective ratio: 0.169 +- 0.141
Model Accuracy over intervened graphs for r=0.25 =  0.938
SUFF_SIMPLE for r=0.25 class 1.0 = 0.928 +- 0.274 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.25 all KL = 0.883 +- 0.274 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.25 all L1 = 0.928 +- 0.191 (in-sample avg dev_std = 0.299)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07420216606498195
len(reference) = 277
Effective ratio: 0.028 +- 0.049
Model Accuracy over intervened graphs for r=0.6 =  0.941
SUFF_SIMPLE for r=0.6 class 1.0 = 0.916 +- 0.296 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.6 all KL = 0.851 +- 0.296 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.6 all L1 = 0.916 +- 0.179 (in-sample avg dev_std = 0.402)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.86
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.01276746031746032
len(reference) = 2520
Effective ratio: 0.134 +- 0.040
Model Accuracy over intervened graphs for r=0.01 =  0.857
SUFF_SIMPLE for r=0.01 class 1.0 = 0.995 +- 0.076 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.01 all KL = 0.989 +- 0.076 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.01 all L1 = 0.995 +- 0.038 (in-sample avg dev_std = 0.107)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01265595238095238
len(reference) = 2520
Effective ratio: 0.027 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.856
SUFF_SIMPLE for r=0.1 class 1.0 = 0.994 +- 0.079 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.1 all KL = 0.988 +- 0.079 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.1 all L1 = 0.994 +- 0.038 (in-sample avg dev_std = 0.113)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.86
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.012505952380952383
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.25 =  0.857
SUFF_SIMPLE for r=0.25 class 1.0 = 0.994 +- 0.075 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.25 all KL = 0.989 +- 0.075 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.25 all L1 = 0.994 +- 0.036 (in-sample avg dev_std = 0.108)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.858
SUFF_SIMPLE for r=0.6 class 1.0 = 0.996 +- 0.064 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.6 all KL = 0.992 +- 0.064 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.6 all L1 = 0.996 +- 0.029 (in-sample avg dev_std = 0.092)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11139789303079414
len(reference) = 1905
Effective ratio: 0.316 +- 0.408
Model Accuracy over intervened graphs for r=0.01 =  0.969
SUFF_SIMPLE for r=0.01 class 1.0 = 0.958 +- 0.215 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.01 all KL = 0.925 +- 0.215 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.01 all L1 = 0.958 +- 0.133 (in-sample avg dev_std = 0.265)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11123662884927069
len(reference) = 2077
Effective ratio: 0.256 +- 0.369
Model Accuracy over intervened graphs for r=0.1 =  0.966
SUFF_SIMPLE for r=0.1 class 1.0 = 0.956 +- 0.220 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.1 all KL = 0.923 +- 0.220 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.1 all L1 = 0.956 +- 0.139 (in-sample avg dev_std = 0.266)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.996
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10948217179902756
len(reference) = 2250
Effective ratio: 0.207 +- 0.319
Model Accuracy over intervened graphs for r=0.25 =  0.956
SUFF_SIMPLE for r=0.25 class 1.0 = 0.948 +- 0.238 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.25 all KL = 0.914 +- 0.238 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.25 all L1 = 0.948 +- 0.162 (in-sample avg dev_std = 0.260)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.992
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0885996758508914
len(reference) = 2435
Effective ratio: 0.094 +- 0.212
Model Accuracy over intervened graphs for r=0.6 =  0.947
SUFF_SIMPLE for r=0.6 class 1.0 = 0.934 +- 0.265 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.6 all KL = 0.893 +- 0.265 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.6 all L1 = 0.934 +- 0.181 (in-sample avg dev_std = 0.294)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10113718411552347
len(reference) = 277
Effective ratio: 0.580 +- 0.257
Model Accuracy over intervened graphs for r=0.01 =  0.963
NEC for r=0.01 class 1.0 = 0.054 +- 0.249 (in-sample avg dev_std = 0.333)
NEC for r=0.01 all KL = 0.101 +- 0.249 (in-sample avg dev_std = 0.333)
NEC for r=0.01 all L1 = 0.054 +- 0.142 (in-sample avg dev_std = 0.333)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.10067509025270759
len(reference) = 277
Effective ratio: 0.227 +- 0.219
Model Accuracy over intervened graphs for r=0.1 =  0.963
NEC for r=0.1 class 1.0 = 0.045 +- 0.230 (in-sample avg dev_std = 0.259)
NEC for r=0.1 all KL = 0.073 +- 0.230 (in-sample avg dev_std = 0.259)
NEC for r=0.1 all L1 = 0.045 +- 0.156 (in-sample avg dev_std = 0.259)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10105415162454874
len(reference) = 277
Effective ratio: 0.169 +- 0.141
Model Accuracy over intervened graphs for r=0.25 =  0.959
NEC for r=0.25 class 1.0 = 0.037 +- 0.203 (in-sample avg dev_std = 0.086)
NEC for r=0.25 all KL = 0.044 +- 0.203 (in-sample avg dev_std = 0.086)
NEC for r=0.25 all L1 = 0.037 +- 0.171 (in-sample avg dev_std = 0.086)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07420216606498195
len(reference) = 277
Effective ratio: 0.028 +- 0.049
Model Accuracy over intervened graphs for r=0.6 =  0.989
NEC for r=0.6 class 1.0 = 0.009 +- 0.103 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.011 +- 0.103 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.009 +- 0.089 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.86
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.01276746031746032
len(reference) = 2520
Effective ratio: 0.134 +- 0.040
Model Accuracy over intervened graphs for r=0.01 =  0.859
NEC for r=0.01 class 1.0 = 0.002 +- 0.048 (in-sample avg dev_std = 0.058)
NEC for r=0.01 all KL = 0.003 +- 0.048 (in-sample avg dev_std = 0.058)
NEC for r=0.01 all L1 = 0.002 +- 0.028 (in-sample avg dev_std = 0.058)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01265595238095238
len(reference) = 2520
Effective ratio: 0.027 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.86
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.86
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.012505952380952383
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.25 =  0.86
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.86
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.992
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11139789303079414
len(reference) = 2468
Effective ratio: 0.316 +- 0.408
Model Accuracy over intervened graphs for r=0.01 =  0.96
NEC for r=0.01 class 1.0 = 0.061 +- 0.259 (in-sample avg dev_std = 0.331)
NEC for r=0.01 all KL = 0.108 +- 0.259 (in-sample avg dev_std = 0.331)
NEC for r=0.01 all L1 = 0.061 +- 0.160 (in-sample avg dev_std = 0.331)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11123662884927069
len(reference) = 2468
Effective ratio: 0.256 +- 0.369
Model Accuracy over intervened graphs for r=0.1 =  0.965
NEC for r=0.1 class 1.0 = 0.05 +- 0.237 (in-sample avg dev_std = 0.274)
NEC for r=0.1 all KL = 0.084 +- 0.237 (in-sample avg dev_std = 0.274)
NEC for r=0.1 all L1 = 0.05 +- 0.157 (in-sample avg dev_std = 0.274)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.992
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10948217179902756
len(reference) = 2468
Effective ratio: 0.207 +- 0.319
Model Accuracy over intervened graphs for r=0.25 =  0.973
NEC for r=0.25 class 1.0 = 0.036 +- 0.201 (in-sample avg dev_std = 0.198)
NEC for r=0.25 all KL = 0.055 +- 0.201 (in-sample avg dev_std = 0.198)
NEC for r=0.25 all L1 = 0.036 +- 0.144 (in-sample avg dev_std = 0.198)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.992
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0885996758508914
len(reference) = 2468
Effective ratio: 0.094 +- 0.212
Model Accuracy over intervened graphs for r=0.6 =  0.977
NEC for r=0.6 class 1.0 = 0.024 +- 0.163 (in-sample avg dev_std = 0.075)
NEC for r=0.6 all KL = 0.029 +- 0.163 (in-sample avg dev_std = 0.075)
NEC for r=0.6 all L1 = 0.024 +- 0.136 (in-sample avg dev_std = 0.075)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 20:59:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 08:59:24 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 08:59:24 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 08:59:24 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 08:59:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:59:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:59:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:59:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 08:59:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 08:59:24 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 08:59:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.093
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.089
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.070
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.070
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.011
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.011
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.112
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.112
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.098
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.049


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09340794223826715
len(reference) = 271
Effective ratio: 0.315 +- 0.189
Model Accuracy over intervened graphs for r=0.01 =  0.879
SUFF_SIMPLE for r=0.01 class 1.0 = 0.841 +- 0.333 (in-sample avg dev_std = 0.492)
SUFF_SIMPLE for r=0.01 all KL = 0.75 +- 0.333 (in-sample avg dev_std = 0.492)
SUFF_SIMPLE for r=0.01 all L1 = 0.841 +- 0.230 (in-sample avg dev_std = 0.492)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08869314079422382
len(reference) = 277
Effective ratio: 0.168 +- 0.136
Model Accuracy over intervened graphs for r=0.1 =  0.86
SUFF_SIMPLE for r=0.1 class 1.0 = 0.82 +- 0.341 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.1 all KL = 0.72 +- 0.341 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.1 all L1 = 0.82 +- 0.243 (in-sample avg dev_std = 0.499)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.06991696750902528
len(reference) = 277
Effective ratio: 0.027 +- 0.051
Model Accuracy over intervened graphs for r=0.25 =  0.865
SUFF_SIMPLE for r=0.25 class 1.0 = 0.815 +- 0.344 (in-sample avg dev_std = 0.560)
SUFF_SIMPLE for r=0.25 all KL = 0.699 +- 0.344 (in-sample avg dev_std = 0.560)
SUFF_SIMPLE for r=0.25 all L1 = 0.815 +- 0.227 (in-sample avg dev_std = 0.560)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07038628158844765
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.858
SUFF_SIMPLE for r=0.6 class 1.0 = 0.804 +- 0.345 (in-sample avg dev_std = 0.579)
SUFF_SIMPLE for r=0.6 all KL = 0.683 +- 0.345 (in-sample avg dev_std = 0.579)
SUFF_SIMPLE for r=0.6 all L1 = 0.804 +- 0.231 (in-sample avg dev_std = 0.579)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.762
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012090873015873017
len(reference) = 2520
Effective ratio: 0.106 +- 0.032
Model Accuracy over intervened graphs for r=0.01 =  0.36
SUFF_SIMPLE for r=0.01 class 1.0 = 0.491 +- 0.351 (in-sample avg dev_std = 0.782)
SUFF_SIMPLE for r=0.01 all KL = 0.353 +- 0.351 (in-sample avg dev_std = 0.782)
SUFF_SIMPLE for r=0.01 all L1 = 0.491 +- 0.229 (in-sample avg dev_std = 0.782)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011874999999999998
len(reference) = 2520
Effective ratio: 0.024 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.361
SUFF_SIMPLE for r=0.1 class 1.0 = 0.491 +- 0.352 (in-sample avg dev_std = 0.784)
SUFF_SIMPLE for r=0.1 all KL = 0.352 +- 0.352 (in-sample avg dev_std = 0.784)
SUFF_SIMPLE for r=0.1 all L1 = 0.491 +- 0.228 (in-sample avg dev_std = 0.784)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.762
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.010976190476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.25 =  0.362
SUFF_SIMPLE for r=0.25 class 1.0 = 0.494 +- 0.350 (in-sample avg dev_std = 0.777)
SUFF_SIMPLE for r=0.25 all KL = 0.355 +- 0.350 (in-sample avg dev_std = 0.777)
SUFF_SIMPLE for r=0.25 all L1 = 0.494 +- 0.229 (in-sample avg dev_std = 0.777)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.010976190476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.358
SUFF_SIMPLE for r=0.6 class 1.0 = 0.489 +- 0.351 (in-sample avg dev_std = 0.783)
SUFF_SIMPLE for r=0.6 all KL = 0.351 +- 0.351 (in-sample avg dev_std = 0.783)
SUFF_SIMPLE for r=0.6 all L1 = 0.489 +- 0.228 (in-sample avg dev_std = 0.783)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11205429497568882
len(reference) = 2062
Effective ratio: 0.268 +- 0.372
Model Accuracy over intervened graphs for r=0.01 =  0.955
SUFF_SIMPLE for r=0.01 class 1.0 = 0.942 +- 0.231 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.01 all KL = 0.906 +- 0.231 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.01 all L1 = 0.942 +- 0.157 (in-sample avg dev_std = 0.287)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.995
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11165883306320908
len(reference) = 2210
Effective ratio: 0.209 +- 0.326
Model Accuracy over intervened graphs for r=0.1 =  0.945
SUFF_SIMPLE for r=0.1 class 1.0 = 0.934 +- 0.246 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.1 all KL = 0.899 +- 0.246 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.1 all L1 = 0.934 +- 0.176 (in-sample avg dev_std = 0.279)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.986
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09752836304700162
len(reference) = 2328
Effective ratio: 0.120 +- 0.274
Model Accuracy over intervened graphs for r=0.25 =  0.934
SUFF_SIMPLE for r=0.25 class 1.0 = 0.914 +- 0.276 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.25 all KL = 0.869 +- 0.276 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.25 all L1 = 0.914 +- 0.196 (in-sample avg dev_std = 0.328)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.977
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.048913695299837925
len(reference) = 2468
Effective ratio: 0.027 +- 0.043
Model Accuracy over intervened graphs for r=0.6 =  0.939
SUFF_SIMPLE for r=0.6 class 1.0 = 0.898 +- 0.297 (in-sample avg dev_std = 0.397)
SUFF_SIMPLE for r=0.6 all KL = 0.839 +- 0.297 (in-sample avg dev_std = 0.397)
SUFF_SIMPLE for r=0.6 all L1 = 0.898 +- 0.202 (in-sample avg dev_std = 0.397)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09340794223826715
len(reference) = 277
Effective ratio: 0.315 +- 0.189
Model Accuracy over intervened graphs for r=0.01 =  0.943
NEC for r=0.01 class 1.0 = 0.069 +- 0.262 (in-sample avg dev_std = 0.307)
NEC for r=0.01 all KL = 0.102 +- 0.262 (in-sample avg dev_std = 0.307)
NEC for r=0.01 all L1 = 0.069 +- 0.187 (in-sample avg dev_std = 0.307)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08869314079422382
len(reference) = 277
Effective ratio: 0.168 +- 0.136
Model Accuracy over intervened graphs for r=0.1 =  0.97
NEC for r=0.1 class 1.0 = 0.035 +- 0.190 (in-sample avg dev_std = 0.187)
NEC for r=0.1 all KL = 0.048 +- 0.190 (in-sample avg dev_std = 0.187)
NEC for r=0.1 all L1 = 0.035 +- 0.144 (in-sample avg dev_std = 0.187)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.06991696750902528
len(reference) = 277
Effective ratio: 0.027 +- 0.051
Model Accuracy over intervened graphs for r=0.25 =  0.996
NEC for r=0.25 class 1.0 = 0.003 +- 0.059 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.004 +- 0.059 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.003 +- 0.052 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07038628158844765
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.762
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012090873015873017
len(reference) = 2520
Effective ratio: 0.106 +- 0.032
Model Accuracy over intervened graphs for r=0.01 =  0.451
NEC for r=0.01 class 1.0 = 0.34 +- 0.420 (in-sample avg dev_std = 0.352)
NEC for r=0.01 all KL = 0.376 +- 0.420 (in-sample avg dev_std = 0.352)
NEC for r=0.01 all L1 = 0.34 +- 0.345 (in-sample avg dev_std = 0.352)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011874999999999998
len(reference) = 2520
Effective ratio: 0.024 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.742
NEC for r=0.1 class 1.0 = 0.027 +- 0.127 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.022 +- 0.127 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.027 +- 0.117 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.762
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.010976190476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.25 =  0.761
NEC for r=0.25 class 1.0 = 0.001 +- 0.014 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.014 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.001 +- 0.017 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.010976190476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.761
NEC for r=0.6 class 1.0 = 0.001 +- 0.014 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.014 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.001 +- 0.017 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.977
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11205429497568882
len(reference) = 2468
Effective ratio: 0.268 +- 0.372
Model Accuracy over intervened graphs for r=0.01 =  0.961
NEC for r=0.01 class 1.0 = 0.066 +- 0.253 (in-sample avg dev_std = 0.275)
NEC for r=0.01 all KL = 0.096 +- 0.253 (in-sample avg dev_std = 0.275)
NEC for r=0.01 all L1 = 0.066 +- 0.187 (in-sample avg dev_std = 0.275)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11165883306320908
len(reference) = 2468
Effective ratio: 0.209 +- 0.326
Model Accuracy over intervened graphs for r=0.1 =  0.968
NEC for r=0.1 class 1.0 = 0.052 +- 0.225 (in-sample avg dev_std = 0.196)
NEC for r=0.1 all KL = 0.068 +- 0.225 (in-sample avg dev_std = 0.196)
NEC for r=0.1 all L1 = 0.052 +- 0.178 (in-sample avg dev_std = 0.196)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.977
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09752836304700162
len(reference) = 2468
Effective ratio: 0.120 +- 0.274
Model Accuracy over intervened graphs for r=0.25 =  0.974
NEC for r=0.25 class 1.0 = 0.039 +- 0.197 (in-sample avg dev_std = 0.148)
NEC for r=0.25 all KL = 0.049 +- 0.197 (in-sample avg dev_std = 0.148)
NEC for r=0.25 all L1 = 0.039 +- 0.162 (in-sample avg dev_std = 0.148)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.977
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.048913695299837925
len(reference) = 2468
Effective ratio: 0.027 +- 0.043
Model Accuracy over intervened graphs for r=0.6 =  0.97
NEC for r=0.6 class 1.0 = 0.02 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.021 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.02 +- 0.120 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 21:04:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 09:04:53 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 09:04:53 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 09:04:53 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 09:04:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:04:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:04:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:04:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:04:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:04:53 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 09:04:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.090
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.089
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.085
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.061
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.013
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.013
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.111
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.110
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.109
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.087


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09029241877256318
len(reference) = 274
Effective ratio: 0.230 +- 0.170
Model Accuracy over intervened graphs for r=0.01 =  0.982
SUFF_SIMPLE for r=0.01 class 1.0 = 0.979 +- 0.163 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.01 all KL = 0.96 +- 0.163 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.01 all L1 = 0.979 +- 0.103 (in-sample avg dev_std = 0.163)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08892057761732852
len(reference) = 277
Effective ratio: 0.166 +- 0.130
Model Accuracy over intervened graphs for r=0.1 =  0.978
SUFF_SIMPLE for r=0.1 class 1.0 = 0.97 +- 0.193 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.1 all KL = 0.942 +- 0.193 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.1 all L1 = 0.97 +- 0.114 (in-sample avg dev_std = 0.205)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08524548736462094
len(reference) = 277
Effective ratio: 0.128 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.975
SUFF_SIMPLE for r=0.25 class 1.0 = 0.97 +- 0.193 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.25 all KL = 0.948 +- 0.193 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.25 all L1 = 0.97 +- 0.127 (in-sample avg dev_std = 0.184)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.06067148014440432
len(reference) = 277
Effective ratio: 0.024 +- 0.030
Model Accuracy over intervened graphs for r=0.6 =  0.965
SUFF_SIMPLE for r=0.6 class 1.0 = 0.951 +- 0.255 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.6 all KL = 0.908 +- 0.255 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.6 all L1 = 0.951 +- 0.146 (in-sample avg dev_std = 0.296)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.891
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012509126984126985
len(reference) = 2520
Effective ratio: 0.049 +- 0.015
Model Accuracy over intervened graphs for r=0.01 =  0.884
SUFF_SIMPLE for r=0.01 class 1.0 = 0.989 +- 0.109 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.01 all KL = 0.977 +- 0.109 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.01 all L1 = 0.989 +- 0.048 (in-sample avg dev_std = 0.142)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012418650793650794
len(reference) = 2520
Effective ratio: 0.026 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.883
SUFF_SIMPLE for r=0.1 class 1.0 = 0.988 +- 0.111 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.1 all KL = 0.976 +- 0.111 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.1 all L1 = 0.988 +- 0.050 (in-sample avg dev_std = 0.145)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.891
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.012612301587301587
len(reference) = 2520
Effective ratio: 0.019 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.884
SUFF_SIMPLE for r=0.25 class 1.0 = 0.988 +- 0.110 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.25 all KL = 0.976 +- 0.110 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.25 all L1 = 0.988 +- 0.048 (in-sample avg dev_std = 0.146)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.012826587301587302
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.883
SUFF_SIMPLE for r=0.6 class 1.0 = 0.988 +- 0.113 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.6 all KL = 0.975 +- 0.113 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.6 all L1 = 0.988 +- 0.048 (in-sample avg dev_std = 0.148)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11105186385737438
len(reference) = 2110
Effective ratio: 0.250 +- 0.354
Model Accuracy over intervened graphs for r=0.01 =  0.979
SUFF_SIMPLE for r=0.01 class 1.0 = 0.967 +- 0.204 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.01 all KL = 0.926 +- 0.204 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.01 all L1 = 0.967 +- 0.097 (in-sample avg dev_std = 0.253)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11046555915721233
len(reference) = 2246
Effective ratio: 0.203 +- 0.307
Model Accuracy over intervened graphs for r=0.1 =  0.98
SUFF_SIMPLE for r=0.1 class 1.0 = 0.968 +- 0.203 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.1 all KL = 0.927 +- 0.203 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.1 all L1 = 0.968 +- 0.095 (in-sample avg dev_std = 0.252)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10862682333873583
len(reference) = 2345
Effective ratio: 0.167 +- 0.275
Model Accuracy over intervened graphs for r=0.25 =  0.976
SUFF_SIMPLE for r=0.25 class 1.0 = 0.965 +- 0.211 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.25 all KL = 0.922 +- 0.211 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.25 all L1 = 0.965 +- 0.107 (in-sample avg dev_std = 0.254)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08661021069692058
len(reference) = 2442
Effective ratio: 0.068 +- 0.176
Model Accuracy over intervened graphs for r=0.6 =  0.954
SUFF_SIMPLE for r=0.6 class 1.0 = 0.937 +- 0.275 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.6 all KL = 0.877 +- 0.275 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.6 all L1 = 0.937 +- 0.158 (in-sample avg dev_std = 0.331)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09029241877256318
len(reference) = 277
Effective ratio: 0.230 +- 0.170
Model Accuracy over intervened graphs for r=0.01 =  0.994
NEC for r=0.01 class 1.0 = 0.008 +- 0.103 (in-sample avg dev_std = 0.101)
NEC for r=0.01 all KL = 0.015 +- 0.103 (in-sample avg dev_std = 0.101)
NEC for r=0.01 all L1 = 0.008 +- 0.062 (in-sample avg dev_std = 0.101)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08892057761732852
len(reference) = 277
Effective ratio: 0.166 +- 0.130
Model Accuracy over intervened graphs for r=0.1 =  0.996
NEC for r=0.1 class 1.0 = 0.003 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.004 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.003 +- 0.052 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08524548736462094
len(reference) = 277
Effective ratio: 0.128 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  1.0
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.06067148014440432
len(reference) = 277
Effective ratio: 0.024 +- 0.030
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.891
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012509126984126985
len(reference) = 2520
Effective ratio: 0.049 +- 0.015
Model Accuracy over intervened graphs for r=0.01 =  0.889
NEC for r=0.01 class 1.0 = 0.001 +- 0.036 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.001 +- 0.036 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.001 +- 0.033 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012418650793650794
len(reference) = 2520
Effective ratio: 0.026 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.89
NEC for r=0.1 class 1.0 = 0.0 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.017 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.891
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.012612301587301587
len(reference) = 2520
Effective ratio: 0.019 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.891
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.012826587301587302
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.891
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11105186385737438
len(reference) = 2468
Effective ratio: 0.250 +- 0.354
Model Accuracy over intervened graphs for r=0.01 =  0.974
NEC for r=0.01 class 1.0 = 0.034 +- 0.214 (in-sample avg dev_std = 0.233)
NEC for r=0.01 all KL = 0.066 +- 0.214 (in-sample avg dev_std = 0.233)
NEC for r=0.01 all L1 = 0.034 +- 0.124 (in-sample avg dev_std = 0.233)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11046555915721233
len(reference) = 2468
Effective ratio: 0.203 +- 0.307
Model Accuracy over intervened graphs for r=0.1 =  0.98
NEC for r=0.1 class 1.0 = 0.025 +- 0.183 (in-sample avg dev_std = 0.189)
NEC for r=0.1 all KL = 0.045 +- 0.183 (in-sample avg dev_std = 0.189)
NEC for r=0.1 all L1 = 0.025 +- 0.112 (in-sample avg dev_std = 0.189)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10862682333873583
len(reference) = 2468
Effective ratio: 0.167 +- 0.275
Model Accuracy over intervened graphs for r=0.25 =  0.982
NEC for r=0.25 class 1.0 = 0.02 +- 0.163 (in-sample avg dev_std = 0.150)
NEC for r=0.25 all KL = 0.033 +- 0.163 (in-sample avg dev_std = 0.150)
NEC for r=0.25 all L1 = 0.02 +- 0.109 (in-sample avg dev_std = 0.150)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08661021069692058
len(reference) = 2468
Effective ratio: 0.068 +- 0.176
Model Accuracy over intervened graphs for r=0.6 =  0.992
NEC for r=0.6 class 1.0 = 0.008 +- 0.100 (in-sample avg dev_std = 0.060)
NEC for r=0.6 all KL = 0.011 +- 0.100 (in-sample avg dev_std = 0.060)
NEC for r=0.6 all L1 = 0.008 +- 0.079 (in-sample avg dev_std = 0.060)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 21:09:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 09:09:35 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 09:09:35 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 09:09:35 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 09:09:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:09:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:09:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:09:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:09:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:09:35 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 09:09:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.091
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.088
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.084
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.014
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.014
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.113
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.113
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.111
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.089


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09149458483754512
len(reference) = 242
Effective ratio: 0.514 +- 0.279
Model Accuracy over intervened graphs for r=0.01 =  0.985
SUFF_SIMPLE for r=0.01 class 1.0 = 0.974 +- 0.183 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.01 all KL = 0.945 +- 0.183 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.01 all L1 = 0.974 +- 0.091 (in-sample avg dev_std = 0.227)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08826353790613718
len(reference) = 270
Effective ratio: 0.212 +- 0.208
Model Accuracy over intervened graphs for r=0.1 =  0.927
SUFF_SIMPLE for r=0.1 class 1.0 = 0.911 +- 0.307 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.1 all KL = 0.845 +- 0.307 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.1 all L1 = 0.911 +- 0.201 (in-sample avg dev_std = 0.349)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08374368231046933
len(reference) = 275
Effective ratio: 0.126 +- 0.139
Model Accuracy over intervened graphs for r=0.25 =  0.91
SUFF_SIMPLE for r=0.25 class 1.0 = 0.892 +- 0.329 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.25 all KL = 0.814 +- 0.329 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.25 all L1 = 0.892 +- 0.221 (in-sample avg dev_std = 0.369)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03984476534296029
len(reference) = 277
Effective ratio: 0.027 +- 0.049
Model Accuracy over intervened graphs for r=0.6 =  0.915
SUFF_SIMPLE for r=0.6 class 1.0 = 0.89 +- 0.339 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.6 all KL = 0.804 +- 0.339 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.6 all L1 = 0.89 +- 0.212 (in-sample avg dev_std = 0.425)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.94
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013517857142857142
len(reference) = 2520
Effective ratio: 0.109 +- 0.034
Model Accuracy over intervened graphs for r=0.01 =  0.723
SUFF_SIMPLE for r=0.01 class 1.0 = 0.698 +- 0.351 (in-sample avg dev_std = 0.733)
SUFF_SIMPLE for r=0.01 all KL = 0.508 +- 0.351 (in-sample avg dev_std = 0.733)
SUFF_SIMPLE for r=0.01 all L1 = 0.698 +- 0.214 (in-sample avg dev_std = 0.733)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013257936507936507
len(reference) = 2520
Effective ratio: 0.026 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.727
SUFF_SIMPLE for r=0.1 class 1.0 = 0.701 +- 0.348 (in-sample avg dev_std = 0.730)
SUFF_SIMPLE for r=0.1 all KL = 0.51 +- 0.348 (in-sample avg dev_std = 0.730)
SUFF_SIMPLE for r=0.1 all L1 = 0.701 +- 0.209 (in-sample avg dev_std = 0.730)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.94
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01353968253968254
len(reference) = 2520
Effective ratio: 0.016 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.731
SUFF_SIMPLE for r=0.25 class 1.0 = 0.706 +- 0.347 (in-sample avg dev_std = 0.724)
SUFF_SIMPLE for r=0.25 all KL = 0.516 +- 0.347 (in-sample avg dev_std = 0.724)
SUFF_SIMPLE for r=0.25 all L1 = 0.706 +- 0.210 (in-sample avg dev_std = 0.724)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.012710714285714285
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.722
SUFF_SIMPLE for r=0.6 class 1.0 = 0.693 +- 0.346 (in-sample avg dev_std = 0.741)
SUFF_SIMPLE for r=0.6 all KL = 0.497 +- 0.346 (in-sample avg dev_std = 0.741)
SUFF_SIMPLE for r=0.6 all L1 = 0.693 +- 0.209 (in-sample avg dev_std = 0.741)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11274513776337115
len(reference) = 1915
Effective ratio: 0.310 +- 0.406
Model Accuracy over intervened graphs for r=0.01 =  0.971
SUFF_SIMPLE for r=0.01 class 1.0 = 0.961 +- 0.222 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.01 all KL = 0.927 +- 0.222 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.01 all L1 = 0.961 +- 0.132 (in-sample avg dev_std = 0.261)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11258589951377634
len(reference) = 2066
Effective ratio: 0.250 +- 0.370
Model Accuracy over intervened graphs for r=0.1 =  0.957
SUFF_SIMPLE for r=0.1 class 1.0 = 0.947 +- 0.251 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.1 all KL = 0.907 +- 0.251 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.1 all L1 = 0.947 +- 0.161 (in-sample avg dev_std = 0.275)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.992
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.1108776337115073
len(reference) = 2190
Effective ratio: 0.199 +- 0.331
Model Accuracy over intervened graphs for r=0.25 =  0.957
SUFF_SIMPLE for r=0.25 class 1.0 = 0.946 +- 0.252 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.25 all KL = 0.904 +- 0.252 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.25 all L1 = 0.946 +- 0.161 (in-sample avg dev_std = 0.281)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.982
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08873298217179902
len(reference) = 2444
Effective ratio: 0.086 +- 0.197
Model Accuracy over intervened graphs for r=0.6 =  0.942
SUFF_SIMPLE for r=0.6 class 1.0 = 0.926 +- 0.290 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.6 all KL = 0.876 +- 0.290 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.6 all L1 = 0.926 +- 0.194 (in-sample avg dev_std = 0.310)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09149458483754512
len(reference) = 277
Effective ratio: 0.514 +- 0.279
Model Accuracy over intervened graphs for r=0.01 =  0.966
NEC for r=0.01 class 1.0 = 0.046 +- 0.237 (in-sample avg dev_std = 0.282)
NEC for r=0.01 all KL = 0.082 +- 0.237 (in-sample avg dev_std = 0.282)
NEC for r=0.01 all L1 = 0.046 +- 0.146 (in-sample avg dev_std = 0.282)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08826353790613718
len(reference) = 277
Effective ratio: 0.212 +- 0.208
Model Accuracy over intervened graphs for r=0.1 =  0.958
NEC for r=0.1 class 1.0 = 0.048 +- 0.236 (in-sample avg dev_std = 0.232)
NEC for r=0.1 all KL = 0.078 +- 0.236 (in-sample avg dev_std = 0.232)
NEC for r=0.1 all L1 = 0.048 +- 0.165 (in-sample avg dev_std = 0.232)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08374368231046933
len(reference) = 277
Effective ratio: 0.126 +- 0.139
Model Accuracy over intervened graphs for r=0.25 =  0.988
NEC for r=0.25 class 1.0 = 0.012 +- 0.121 (in-sample avg dev_std = 0.092)
NEC for r=0.25 all KL = 0.018 +- 0.121 (in-sample avg dev_std = 0.092)
NEC for r=0.25 all L1 = 0.012 +- 0.093 (in-sample avg dev_std = 0.092)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03984476534296029
len(reference) = 277
Effective ratio: 0.027 +- 0.049
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.94
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013517857142857142
len(reference) = 2520
Effective ratio: 0.109 +- 0.034
Model Accuracy over intervened graphs for r=0.01 =  0.907
NEC for r=0.01 class 1.0 = 0.038 +- 0.203 (in-sample avg dev_std = 0.220)
NEC for r=0.01 all KL = 0.057 +- 0.203 (in-sample avg dev_std = 0.220)
NEC for r=0.01 all L1 = 0.038 +- 0.142 (in-sample avg dev_std = 0.220)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013257936507936507
len(reference) = 2520
Effective ratio: 0.026 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.938
NEC for r=0.1 class 1.0 = 0.001 +- 0.034 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.001 +- 0.034 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.001 +- 0.029 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.94
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01353968253968254
len(reference) = 2520
Effective ratio: 0.016 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.939
NEC for r=0.25 class 1.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.014 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.012710714285714285
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.939
NEC for r=0.6 class 1.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.014 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.982
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11274513776337115
len(reference) = 2468
Effective ratio: 0.310 +- 0.406
Model Accuracy over intervened graphs for r=0.01 =  0.959
NEC for r=0.01 class 1.0 = 0.07 +- 0.288 (in-sample avg dev_std = 0.348)
NEC for r=0.01 all KL = 0.128 +- 0.288 (in-sample avg dev_std = 0.348)
NEC for r=0.01 all L1 = 0.07 +- 0.174 (in-sample avg dev_std = 0.348)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11258589951377634
len(reference) = 2468
Effective ratio: 0.250 +- 0.370
Model Accuracy over intervened graphs for r=0.1 =  0.964
NEC for r=0.1 class 1.0 = 0.056 +- 0.257 (in-sample avg dev_std = 0.273)
NEC for r=0.1 all KL = 0.094 +- 0.257 (in-sample avg dev_std = 0.273)
NEC for r=0.1 all L1 = 0.056 +- 0.172 (in-sample avg dev_std = 0.273)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.982
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.1108776337115073
len(reference) = 2468
Effective ratio: 0.199 +- 0.331
Model Accuracy over intervened graphs for r=0.25 =  0.968
NEC for r=0.25 class 1.0 = 0.047 +- 0.234 (in-sample avg dev_std = 0.219)
NEC for r=0.25 all KL = 0.072 +- 0.234 (in-sample avg dev_std = 0.219)
NEC for r=0.25 all L1 = 0.047 +- 0.168 (in-sample avg dev_std = 0.219)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.982
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08873298217179902
len(reference) = 2468
Effective ratio: 0.086 +- 0.197
Model Accuracy over intervened graphs for r=0.6 =  0.977
NEC for r=0.6 class 1.0 = 0.025 +- 0.167 (in-sample avg dev_std = 0.069)
NEC for r=0.6 all KL = 0.03 +- 0.167 (in-sample avg dev_std = 0.069)
NEC for r=0.6 all L1 = 0.025 +- 0.139 (in-sample avg dev_std = 0.069)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 21:14:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 09:14:56 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 09:14:56 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 09:14:56 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 09:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:14:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:14:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:14:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:14:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 09:14:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.094
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.092
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.090
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.055
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.014
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.014
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.014
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.112
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.112
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.110
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.089


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09387725631768952
len(reference) = 257
Effective ratio: 0.371 +- 0.272
Model Accuracy over intervened graphs for r=0.01 =  0.739
SUFF_SIMPLE for r=0.01 class 1.0 = 0.7 +- 0.435 (in-sample avg dev_std = 0.629)
SUFF_SIMPLE for r=0.01 all KL = 0.535 +- 0.435 (in-sample avg dev_std = 0.629)
SUFF_SIMPLE for r=0.01 all L1 = 0.7 +- 0.318 (in-sample avg dev_std = 0.629)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.09160288808664259
len(reference) = 276
Effective ratio: 0.156 +- 0.151
Model Accuracy over intervened graphs for r=0.1 =  0.685
SUFF_SIMPLE for r=0.1 class 1.0 = 0.642 +- 0.449 (in-sample avg dev_std = 0.681)
SUFF_SIMPLE for r=0.1 all KL = 0.464 +- 0.449 (in-sample avg dev_std = 0.681)
SUFF_SIMPLE for r=0.1 all L1 = 0.642 +- 0.330 (in-sample avg dev_std = 0.681)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09044404332129963
len(reference) = 277
Effective ratio: 0.139 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.682
SUFF_SIMPLE for r=0.25 class 1.0 = 0.633 +- 0.421 (in-sample avg dev_std = 0.698)
SUFF_SIMPLE for r=0.25 all KL = 0.432 +- 0.421 (in-sample avg dev_std = 0.698)
SUFF_SIMPLE for r=0.25 all L1 = 0.633 +- 0.314 (in-sample avg dev_std = 0.698)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.054642599277978335
len(reference) = 277
Effective ratio: 0.023 +- 0.035
Model Accuracy over intervened graphs for r=0.6 =  0.688
SUFF_SIMPLE for r=0.6 class 1.0 = 0.624 +- 0.406 (in-sample avg dev_std = 0.751)
SUFF_SIMPLE for r=0.6 all KL = 0.405 +- 0.406 (in-sample avg dev_std = 0.751)
SUFF_SIMPLE for r=0.6 all L1 = 0.624 +- 0.300 (in-sample avg dev_std = 0.751)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013948015873015874
len(reference) = 2520
Effective ratio: 0.048 +- 0.016
Model Accuracy over intervened graphs for r=0.01 =  0.638
SUFF_SIMPLE for r=0.01 class 1.0 = 0.549 +- 0.308 (in-sample avg dev_std = 0.860)
SUFF_SIMPLE for r=0.01 all KL = 0.314 +- 0.308 (in-sample avg dev_std = 0.860)
SUFF_SIMPLE for r=0.01 all L1 = 0.549 +- 0.226 (in-sample avg dev_std = 0.860)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014033730158730159
len(reference) = 2520
Effective ratio: 0.024 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.632
SUFF_SIMPLE for r=0.1 class 1.0 = 0.546 +- 0.312 (in-sample avg dev_std = 0.857)
SUFF_SIMPLE for r=0.1 all KL = 0.317 +- 0.312 (in-sample avg dev_std = 0.857)
SUFF_SIMPLE for r=0.1 all L1 = 0.546 +- 0.230 (in-sample avg dev_std = 0.857)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013994444444444443
len(reference) = 2520
Effective ratio: 0.023 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.632
SUFF_SIMPLE for r=0.25 class 1.0 = 0.545 +- 0.315 (in-sample avg dev_std = 0.858)
SUFF_SIMPLE for r=0.25 all KL = 0.315 +- 0.315 (in-sample avg dev_std = 0.858)
SUFF_SIMPLE for r=0.25 all L1 = 0.545 +- 0.231 (in-sample avg dev_std = 0.858)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.014190476190476193
len(reference) = 2520
Effective ratio: 0.003 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.638
SUFF_SIMPLE for r=0.6 class 1.0 = 0.552 +- 0.318 (in-sample avg dev_std = 0.855)
SUFF_SIMPLE for r=0.6 all KL = 0.324 +- 0.318 (in-sample avg dev_std = 0.855)
SUFF_SIMPLE for r=0.6 all L1 = 0.552 +- 0.232 (in-sample avg dev_std = 0.855)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.997
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.1123982982171799
len(reference) = 1988
Effective ratio: 0.284 +- 0.395
Model Accuracy over intervened graphs for r=0.01 =  0.853
SUFF_SIMPLE for r=0.01 class 1.0 = 0.841 +- 0.390 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.01 all KL = 0.762 +- 0.390 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.01 all L1 = 0.841 +- 0.286 (in-sample avg dev_std = 0.413)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.111652755267423
len(reference) = 2182
Effective ratio: 0.210 +- 0.336
Model Accuracy over intervened graphs for r=0.1 =  0.861
SUFF_SIMPLE for r=0.1 class 1.0 = 0.847 +- 0.384 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.1 all KL = 0.772 +- 0.384 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.1 all L1 = 0.847 +- 0.280 (in-sample avg dev_std = 0.411)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.967
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10954862236628848
len(reference) = 2368
Effective ratio: 0.167 +- 0.270
Model Accuracy over intervened graphs for r=0.25 =  0.858
SUFF_SIMPLE for r=0.25 class 1.0 = 0.84 +- 0.388 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.25 all KL = 0.767 +- 0.388 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.25 all L1 = 0.84 +- 0.290 (in-sample avg dev_std = 0.393)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.966
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08894327390599675
len(reference) = 2442
Effective ratio: 0.083 +- 0.187
Model Accuracy over intervened graphs for r=0.6 =  0.828
SUFF_SIMPLE for r=0.6 class 1.0 = 0.811 +- 0.409 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.6 all KL = 0.716 +- 0.409 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.6 all L1 = 0.811 +- 0.300 (in-sample avg dev_std = 0.455)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09387725631768952
len(reference) = 277
Effective ratio: 0.371 +- 0.272
Model Accuracy over intervened graphs for r=0.01 =  0.84
NEC for r=0.01 class 1.0 = 0.195 +- 0.422 (in-sample avg dev_std = 0.548)
NEC for r=0.01 all KL = 0.311 +- 0.422 (in-sample avg dev_std = 0.548)
NEC for r=0.01 all L1 = 0.195 +- 0.284 (in-sample avg dev_std = 0.548)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.09160288808664259
len(reference) = 277
Effective ratio: 0.156 +- 0.151
Model Accuracy over intervened graphs for r=0.1 =  0.886
NEC for r=0.1 class 1.0 = 0.105 +- 0.330 (in-sample avg dev_std = 0.190)
NEC for r=0.1 all KL = 0.132 +- 0.330 (in-sample avg dev_std = 0.190)
NEC for r=0.1 all L1 = 0.105 +- 0.271 (in-sample avg dev_std = 0.190)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09044404332129963
len(reference) = 277
Effective ratio: 0.139 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.894
NEC for r=0.25 class 1.0 = 0.096 +- 0.316 (in-sample avg dev_std = 0.141)
NEC for r=0.25 all KL = 0.117 +- 0.316 (in-sample avg dev_std = 0.141)
NEC for r=0.25 all L1 = 0.096 +- 0.265 (in-sample avg dev_std = 0.141)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.054642599277978335
len(reference) = 277
Effective ratio: 0.023 +- 0.035
Model Accuracy over intervened graphs for r=0.6 =  0.982
NEC for r=0.6 class 1.0 = 0.016 +- 0.133 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.018 +- 0.133 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.016 +- 0.115 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013948015873015874
len(reference) = 2520
Effective ratio: 0.048 +- 0.016
Model Accuracy over intervened graphs for r=0.01 =  0.978
NEC for r=0.01 class 1.0 = 0.019 +- 0.144 (in-sample avg dev_std = 0.021)
NEC for r=0.01 all KL = 0.022 +- 0.144 (in-sample avg dev_std = 0.021)
NEC for r=0.01 all L1 = 0.019 +- 0.125 (in-sample avg dev_std = 0.021)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014033730158730159
len(reference) = 2520
Effective ratio: 0.024 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.998
NEC for r=0.1 class 1.0 = 0.002 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.002 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.002 +- 0.038 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013994444444444443
len(reference) = 2520
Effective ratio: 0.023 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.998
NEC for r=0.25 class 1.0 = 0.001 +- 0.040 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.002 +- 0.040 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.001 +- 0.034 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.014190476190476193
len(reference) = 2520
Effective ratio: 0.003 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.966
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.1123982982171799
len(reference) = 2468
Effective ratio: 0.284 +- 0.395
Model Accuracy over intervened graphs for r=0.01 =  0.878
NEC for r=0.01 class 1.0 = 0.145 +- 0.384 (in-sample avg dev_std = 0.437)
NEC for r=0.01 all KL = 0.215 +- 0.384 (in-sample avg dev_std = 0.437)
NEC for r=0.01 all L1 = 0.145 +- 0.272 (in-sample avg dev_std = 0.437)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.966
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.111652755267423
len(reference) = 2468
Effective ratio: 0.210 +- 0.336
Model Accuracy over intervened graphs for r=0.1 =  0.893
NEC for r=0.1 class 1.0 = 0.112 +- 0.344 (in-sample avg dev_std = 0.315)
NEC for r=0.1 all KL = 0.155 +- 0.344 (in-sample avg dev_std = 0.315)
NEC for r=0.1 all L1 = 0.112 +- 0.260 (in-sample avg dev_std = 0.315)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.966
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10954862236628848
len(reference) = 2468
Effective ratio: 0.167 +- 0.270
Model Accuracy over intervened graphs for r=0.25 =  0.899
NEC for r=0.25 class 1.0 = 0.095 +- 0.317 (in-sample avg dev_std = 0.207)
NEC for r=0.25 all KL = 0.123 +- 0.317 (in-sample avg dev_std = 0.207)
NEC for r=0.25 all L1 = 0.095 +- 0.255 (in-sample avg dev_std = 0.207)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.966
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08894327390599675
len(reference) = 2468
Effective ratio: 0.083 +- 0.187
Model Accuracy over intervened graphs for r=0.6 =  0.935
NEC for r=0.6 class 1.0 = 0.047 +- 0.227 (in-sample avg dev_std = 0.105)
NEC for r=0.6 all KL = 0.058 +- 0.227 (in-sample avg dev_std = 0.105)
NEC for r=0.6 all L1 = 0.047 +- 0.189 (in-sample avg dev_std = 0.105)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 21:20:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 09:20:07 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 09:20:07 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 09:20:07 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 09:20:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:20:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:20:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:20:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:20:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:20:07 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 09:20:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.101
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.100
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.099
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.057
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.013
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.013
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.113
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.113
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.112
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.099


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10103971119133574
len(reference) = 242
Effective ratio: 0.641 +- 0.222
Model Accuracy over intervened graphs for r=0.01 =  0.854
SUFF_SIMPLE for r=0.01 class 1.0 = 0.825 +- 0.379 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.01 all KL = 0.735 +- 0.379 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.01 all L1 = 0.825 +- 0.271 (in-sample avg dev_std = 0.496)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.10011913357400722
len(reference) = 269
Effective ratio: 0.241 +- 0.207
Model Accuracy over intervened graphs for r=0.1 =  0.818
SUFF_SIMPLE for r=0.1 class 1.0 = 0.773 +- 0.381 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.1 all KL = 0.64 +- 0.381 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.1 all L1 = 0.773 +- 0.271 (in-sample avg dev_std = 0.582)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.0986101083032491
len(reference) = 276
Effective ratio: 0.152 +- 0.141
Model Accuracy over intervened graphs for r=0.25 =  0.837
SUFF_SIMPLE for r=0.25 class 1.0 = 0.788 +- 0.377 (in-sample avg dev_std = 0.588)
SUFF_SIMPLE for r=0.25 all KL = 0.656 +- 0.377 (in-sample avg dev_std = 0.588)
SUFF_SIMPLE for r=0.25 all L1 = 0.788 +- 0.259 (in-sample avg dev_std = 0.588)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05745487364620938
len(reference) = 277
Effective ratio: 0.030 +- 0.056
Model Accuracy over intervened graphs for r=0.6 =  0.822
SUFF_SIMPLE for r=0.6 class 1.0 = 0.762 +- 0.376 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.6 all KL = 0.604 +- 0.376 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.6 all L1 = 0.762 +- 0.252 (in-sample avg dev_std = 0.648)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.638
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013122619047619048
len(reference) = 2520
Effective ratio: 0.286 +- 0.071
Model Accuracy over intervened graphs for r=0.01 =  0.203
SUFF_SIMPLE for r=0.01 class 1.0 = 0.528 +- 0.430 (in-sample avg dev_std = 0.672)
SUFF_SIMPLE for r=0.01 all KL = 0.403 +- 0.430 (in-sample avg dev_std = 0.672)
SUFF_SIMPLE for r=0.01 all L1 = 0.528 +- 0.340 (in-sample avg dev_std = 0.672)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013186507936507936
len(reference) = 2520
Effective ratio: 0.043 +- 0.013
Model Accuracy over intervened graphs for r=0.1 =  0.206
SUFF_SIMPLE for r=0.1 class 1.0 = 0.528 +- 0.430 (in-sample avg dev_std = 0.681)
SUFF_SIMPLE for r=0.1 all KL = 0.402 +- 0.430 (in-sample avg dev_std = 0.681)
SUFF_SIMPLE for r=0.1 all L1 = 0.528 +- 0.339 (in-sample avg dev_std = 0.681)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.638
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013166666666666669
len(reference) = 2520
Effective ratio: 0.022 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.209
SUFF_SIMPLE for r=0.25 class 1.0 = 0.528 +- 0.429 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.25 all KL = 0.399 +- 0.429 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.25 all L1 = 0.528 +- 0.337 (in-sample avg dev_std = 0.687)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.638
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.011692857142857142
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.206
SUFF_SIMPLE for r=0.6 class 1.0 = 0.527 +- 0.428 (in-sample avg dev_std = 0.681)
SUFF_SIMPLE for r=0.6 all KL = 0.4 +- 0.428 (in-sample avg dev_std = 0.681)
SUFF_SIMPLE for r=0.6 all L1 = 0.527 +- 0.337 (in-sample avg dev_std = 0.681)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11334238249594814
len(reference) = 1901
Effective ratio: 0.323 +- 0.412
Model Accuracy over intervened graphs for r=0.01 =  0.951
SUFF_SIMPLE for r=0.01 class 1.0 = 0.938 +- 0.254 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.01 all KL = 0.899 +- 0.254 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.01 all L1 = 0.938 +- 0.170 (in-sample avg dev_std = 0.309)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1131114262560778
len(reference) = 2053
Effective ratio: 0.258 +- 0.374
Model Accuracy over intervened graphs for r=0.1 =  0.934
SUFF_SIMPLE for r=0.1 class 1.0 = 0.921 +- 0.284 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.1 all KL = 0.877 +- 0.284 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.1 all L1 = 0.921 +- 0.197 (in-sample avg dev_std = 0.329)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.998
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11242260940032416
len(reference) = 2177
Effective ratio: 0.209 +- 0.336
Model Accuracy over intervened graphs for r=0.25 =  0.932
SUFF_SIMPLE for r=0.25 class 1.0 = 0.919 +- 0.286 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.25 all KL = 0.872 +- 0.286 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.25 all L1 = 0.919 +- 0.199 (in-sample avg dev_std = 0.330)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.09925688816855754
len(reference) = 2376
Effective ratio: 0.115 +- 0.257
Model Accuracy over intervened graphs for r=0.6 =  0.926
SUFF_SIMPLE for r=0.6 class 1.0 = 0.908 +- 0.302 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.6 all KL = 0.856 +- 0.302 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.6 all L1 = 0.908 +- 0.212 (in-sample avg dev_std = 0.349)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10103971119133574
len(reference) = 277
Effective ratio: 0.641 +- 0.222
Model Accuracy over intervened graphs for r=0.01 =  0.929
NEC for r=0.01 class 1.0 = 0.1 +- 0.300 (in-sample avg dev_std = 0.430)
NEC for r=0.01 all KL = 0.172 +- 0.300 (in-sample avg dev_std = 0.430)
NEC for r=0.01 all L1 = 0.1 +- 0.188 (in-sample avg dev_std = 0.430)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.10011913357400722
len(reference) = 277
Effective ratio: 0.241 +- 0.207
Model Accuracy over intervened graphs for r=0.1 =  0.949
NEC for r=0.1 class 1.0 = 0.065 +- 0.266 (in-sample avg dev_std = 0.315)
NEC for r=0.1 all KL = 0.101 +- 0.266 (in-sample avg dev_std = 0.315)
NEC for r=0.1 all L1 = 0.065 +- 0.181 (in-sample avg dev_std = 0.315)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.0986101083032491
len(reference) = 277
Effective ratio: 0.152 +- 0.141
Model Accuracy over intervened graphs for r=0.25 =  0.953
NEC for r=0.25 class 1.0 = 0.045 +- 0.220 (in-sample avg dev_std = 0.144)
NEC for r=0.25 all KL = 0.056 +- 0.220 (in-sample avg dev_std = 0.144)
NEC for r=0.25 all L1 = 0.045 +- 0.180 (in-sample avg dev_std = 0.144)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05745487364620938
len(reference) = 277
Effective ratio: 0.030 +- 0.056
Model Accuracy over intervened graphs for r=0.6 =  0.993
NEC for r=0.6 class 1.0 = 0.006 +- 0.084 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.007 +- 0.084 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.006 +- 0.073 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.638
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013122619047619048
len(reference) = 2520
Effective ratio: 0.286 +- 0.071
Model Accuracy over intervened graphs for r=0.01 =  0.243
NEC for r=0.01 class 1.0 = 0.417 +- 0.440 (in-sample avg dev_std = 0.584)
NEC for r=0.01 all KL = 0.522 +- 0.440 (in-sample avg dev_std = 0.584)
NEC for r=0.01 all L1 = 0.417 +- 0.353 (in-sample avg dev_std = 0.584)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013186507936507936
len(reference) = 2520
Effective ratio: 0.043 +- 0.013
Model Accuracy over intervened graphs for r=0.1 =  0.471
NEC for r=0.1 class 1.0 = 0.153 +- 0.361 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.169 +- 0.361 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.153 +- 0.317 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.638
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013166666666666669
len(reference) = 2520
Effective ratio: 0.022 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.578
NEC for r=0.25 class 1.0 = 0.059 +- 0.232 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.064 +- 0.232 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.059 +- 0.207 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.638
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.011692857142857142
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.633
NEC for r=0.6 class 1.0 = 0.008 +- 0.067 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.007 +- 0.067 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.008 +- 0.068 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.987
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11334238249594814
len(reference) = 2468
Effective ratio: 0.323 +- 0.412
Model Accuracy over intervened graphs for r=0.01 =  0.938
NEC for r=0.01 class 1.0 = 0.09 +- 0.300 (in-sample avg dev_std = 0.382)
NEC for r=0.01 all KL = 0.147 +- 0.300 (in-sample avg dev_std = 0.382)
NEC for r=0.01 all L1 = 0.09 +- 0.199 (in-sample avg dev_std = 0.382)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1131114262560778
len(reference) = 2468
Effective ratio: 0.258 +- 0.374
Model Accuracy over intervened graphs for r=0.1 =  0.958
NEC for r=0.1 class 1.0 = 0.059 +- 0.250 (in-sample avg dev_std = 0.284)
NEC for r=0.1 all KL = 0.094 +- 0.250 (in-sample avg dev_std = 0.284)
NEC for r=0.1 all L1 = 0.059 +- 0.173 (in-sample avg dev_std = 0.284)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.987
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11242260940032416
len(reference) = 2468
Effective ratio: 0.209 +- 0.336
Model Accuracy over intervened graphs for r=0.25 =  0.967
NEC for r=0.25 class 1.0 = 0.045 +- 0.220 (in-sample avg dev_std = 0.219)
NEC for r=0.25 all KL = 0.066 +- 0.220 (in-sample avg dev_std = 0.219)
NEC for r=0.25 all L1 = 0.045 +- 0.161 (in-sample avg dev_std = 0.219)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.09925688816855754
len(reference) = 2468
Effective ratio: 0.115 +- 0.257
Model Accuracy over intervened graphs for r=0.6 =  0.973
NEC for r=0.6 class 1.0 = 0.027 +- 0.173 (in-sample avg dev_std = 0.121)
NEC for r=0.6 all KL = 0.036 +- 0.173 (in-sample avg dev_std = 0.121)
NEC for r=0.6 all L1 = 0.027 +- 0.138 (in-sample avg dev_std = 0.121)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 21:25:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 09:25:23 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 09:25:23 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 09:25:23 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 09:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:25:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:25:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:25:23 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 09:25:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.099
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.099
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.099
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.071
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.014
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.014
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.011
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.111
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.111
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.111
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.092


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09894945848375451
len(reference) = 276
Effective ratio: 0.201 +- 0.146
Model Accuracy over intervened graphs for r=0.01 =  0.899
SUFF_SIMPLE for r=0.01 class 1.0 = 0.869 +- 0.320 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.01 all KL = 0.786 +- 0.320 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.01 all L1 = 0.869 +- 0.217 (in-sample avg dev_std = 0.445)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.09866425992779786
len(reference) = 276
Effective ratio: 0.167 +- 0.135
Model Accuracy over intervened graphs for r=0.1 =  0.901
SUFF_SIMPLE for r=0.1 class 1.0 = 0.875 +- 0.320 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 all KL = 0.799 +- 0.320 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 all L1 = 0.875 +- 0.221 (in-sample avg dev_std = 0.425)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09904693140794224
len(reference) = 276
Effective ratio: 0.164 +- 0.135
Model Accuracy over intervened graphs for r=0.25 =  0.895
SUFF_SIMPLE for r=0.25 class 1.0 = 0.866 +- 0.321 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.25 all KL = 0.783 +- 0.321 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.25 all L1 = 0.866 +- 0.221 (in-sample avg dev_std = 0.441)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07073285198555956
len(reference) = 276
Effective ratio: 0.030 +- 0.072
Model Accuracy over intervened graphs for r=0.6 =  0.858
SUFF_SIMPLE for r=0.6 class 1.0 = 0.814 +- 0.358 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.6 all KL = 0.698 +- 0.358 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.6 all L1 = 0.814 +- 0.246 (in-sample avg dev_std = 0.551)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.731
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013592063492063494
len(reference) = 2520
Effective ratio: 0.034 +- 0.009
Model Accuracy over intervened graphs for r=0.01 =  0.697
SUFF_SIMPLE for r=0.01 class 1.0 = 0.94 +- 0.201 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.01 all KL = 0.897 +- 0.201 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.01 all L1 = 0.94 +- 0.106 (in-sample avg dev_std = 0.327)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01363015873015873
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.696
SUFF_SIMPLE for r=0.1 class 1.0 = 0.939 +- 0.201 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.1 all KL = 0.895 +- 0.201 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.1 all L1 = 0.939 +- 0.106 (in-sample avg dev_std = 0.330)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.731
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013629365079365081
len(reference) = 2520
Effective ratio: 0.024 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.695
SUFF_SIMPLE for r=0.25 class 1.0 = 0.937 +- 0.204 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.25 all KL = 0.893 +- 0.204 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.25 all L1 = 0.937 +- 0.109 (in-sample avg dev_std = 0.334)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.731
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.011222222222222222
len(reference) = 2520
Effective ratio: 0.004 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.694
SUFF_SIMPLE for r=0.6 class 1.0 = 0.936 +- 0.208 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.6 all KL = 0.89 +- 0.208 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.6 all L1 = 0.936 +- 0.110 (in-sample avg dev_std = 0.338)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11124230145867099
len(reference) = 2213
Effective ratio: 0.225 +- 0.330
Model Accuracy over intervened graphs for r=0.01 =  0.866
SUFF_SIMPLE for r=0.01 class 1.0 = 0.809 +- 0.331 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.01 all KL = 0.674 +- 0.331 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.01 all L1 = 0.809 +- 0.214 (in-sample avg dev_std = 0.591)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11107009724473257
len(reference) = 2306
Effective ratio: 0.193 +- 0.293
Model Accuracy over intervened graphs for r=0.1 =  0.862
SUFF_SIMPLE for r=0.1 class 1.0 = 0.808 +- 0.334 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.1 all KL = 0.673 +- 0.334 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.1 all L1 = 0.808 +- 0.220 (in-sample avg dev_std = 0.583)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11074149108589952
len(reference) = 2334
Effective ratio: 0.185 +- 0.283
Model Accuracy over intervened graphs for r=0.25 =  0.861
SUFF_SIMPLE for r=0.25 class 1.0 = 0.808 +- 0.338 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.25 all KL = 0.676 +- 0.338 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.25 all L1 = 0.808 +- 0.223 (in-sample avg dev_std = 0.581)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0918820907617504
len(reference) = 2379
Effective ratio: 0.097 +- 0.217
Model Accuracy over intervened graphs for r=0.6 =  0.766
SUFF_SIMPLE for r=0.6 class 1.0 = 0.718 +- 0.371 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.6 all KL = 0.567 +- 0.371 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.6 all L1 = 0.718 +- 0.283 (in-sample avg dev_std = 0.616)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09894945848375451
len(reference) = 277
Effective ratio: 0.201 +- 0.146
Model Accuracy over intervened graphs for r=0.01 =  0.944
NEC for r=0.01 class 1.0 = 0.059 +- 0.252 (in-sample avg dev_std = 0.227)
NEC for r=0.01 all KL = 0.078 +- 0.252 (in-sample avg dev_std = 0.227)
NEC for r=0.01 all L1 = 0.059 +- 0.196 (in-sample avg dev_std = 0.227)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.09866425992779786
len(reference) = 277
Effective ratio: 0.167 +- 0.135
Model Accuracy over intervened graphs for r=0.1 =  0.951
NEC for r=0.1 class 1.0 = 0.048 +- 0.230 (in-sample avg dev_std = 0.174)
NEC for r=0.1 all KL = 0.06 +- 0.230 (in-sample avg dev_std = 0.174)
NEC for r=0.1 all L1 = 0.048 +- 0.187 (in-sample avg dev_std = 0.174)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09904693140794224
len(reference) = 277
Effective ratio: 0.164 +- 0.135
Model Accuracy over intervened graphs for r=0.25 =  0.955
NEC for r=0.25 class 1.0 = 0.043 +- 0.221 (in-sample avg dev_std = 0.162)
NEC for r=0.25 all KL = 0.053 +- 0.221 (in-sample avg dev_std = 0.162)
NEC for r=0.25 all L1 = 0.043 +- 0.181 (in-sample avg dev_std = 0.162)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07073285198555956
len(reference) = 277
Effective ratio: 0.030 +- 0.072
Model Accuracy over intervened graphs for r=0.6 =  0.995
NEC for r=0.6 class 1.0 = 0.005 +- 0.073 (in-sample avg dev_std = 0.053)
NEC for r=0.6 all KL = 0.006 +- 0.073 (in-sample avg dev_std = 0.053)
NEC for r=0.6 all L1 = 0.005 +- 0.057 (in-sample avg dev_std = 0.053)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.731
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013592063492063494
len(reference) = 2520
Effective ratio: 0.034 +- 0.009
Model Accuracy over intervened graphs for r=0.01 =  0.725
NEC for r=0.01 class 1.0 = 0.005 +- 0.070 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.005 +- 0.070 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.005 +- 0.062 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01363015873015873
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.729
NEC for r=0.1 class 1.0 = 0.002 +- 0.040 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.002 +- 0.040 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.002 +- 0.035 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.731
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013629365079365081
len(reference) = 2520
Effective ratio: 0.024 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.729
NEC for r=0.25 class 1.0 = 0.002 +- 0.040 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.002 +- 0.040 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.002 +- 0.035 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.731
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.011222222222222222
len(reference) = 2520
Effective ratio: 0.004 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.73
NEC for r=0.6 class 1.0 = 0.0 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.017 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11124230145867099
len(reference) = 2468
Effective ratio: 0.225 +- 0.330
Model Accuracy over intervened graphs for r=0.01 =  0.866
NEC for r=0.01 class 1.0 = 0.131 +- 0.360 (in-sample avg dev_std = 0.294)
NEC for r=0.01 all KL = 0.165 +- 0.360 (in-sample avg dev_std = 0.294)
NEC for r=0.01 all L1 = 0.131 +- 0.290 (in-sample avg dev_std = 0.294)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11107009724473257
len(reference) = 2468
Effective ratio: 0.193 +- 0.293
Model Accuracy over intervened graphs for r=0.1 =  0.888
NEC for r=0.1 class 1.0 = 0.108 +- 0.331 (in-sample avg dev_std = 0.242)
NEC for r=0.1 all KL = 0.133 +- 0.331 (in-sample avg dev_std = 0.242)
NEC for r=0.1 all L1 = 0.108 +- 0.270 (in-sample avg dev_std = 0.242)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11074149108589952
len(reference) = 2468
Effective ratio: 0.185 +- 0.283
Model Accuracy over intervened graphs for r=0.25 =  0.894
NEC for r=0.25 class 1.0 = 0.102 +- 0.323 (in-sample avg dev_std = 0.230)
NEC for r=0.25 all KL = 0.126 +- 0.323 (in-sample avg dev_std = 0.230)
NEC for r=0.25 all L1 = 0.102 +- 0.263 (in-sample avg dev_std = 0.230)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0918820907617504
len(reference) = 2468
Effective ratio: 0.097 +- 0.217
Model Accuracy over intervened graphs for r=0.6 =  0.943
NEC for r=0.6 class 1.0 = 0.055 +- 0.247 (in-sample avg dev_std = 0.187)
NEC for r=0.6 all KL = 0.069 +- 0.247 (in-sample avg dev_std = 0.187)
NEC for r=0.6 all L1 = 0.055 +- 0.199 (in-sample avg dev_std = 0.187)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 21:30:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 09:30:46 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 09:30:46 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 09:30:46 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 09:30:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:30:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:30:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:30:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:30:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:30:46 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 09:30:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.094
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.093
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.091
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.013
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.014
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.112
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.111
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.110
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.091


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.0944115523465704
len(reference) = 264
Effective ratio: 0.404 +- 0.220
Model Accuracy over intervened graphs for r=0.01 =  0.62
SUFF_SIMPLE for r=0.01 class 1.0 = 0.533 +- 0.317 (in-sample avg dev_std = 0.796)
SUFF_SIMPLE for r=0.01 all KL = 0.236 +- 0.317 (in-sample avg dev_std = 0.796)
SUFF_SIMPLE for r=0.01 all L1 = 0.533 +- 0.259 (in-sample avg dev_std = 0.796)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0932129963898917
len(reference) = 275
Effective ratio: 0.179 +- 0.154
Model Accuracy over intervened graphs for r=0.1 =  0.596
SUFF_SIMPLE for r=0.1 class 1.0 = 0.511 +- 0.299 (in-sample avg dev_std = 0.819)
SUFF_SIMPLE for r=0.1 all KL = 0.21 +- 0.299 (in-sample avg dev_std = 0.819)
SUFF_SIMPLE for r=0.1 all L1 = 0.511 +- 0.254 (in-sample avg dev_std = 0.819)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09055595667870037
len(reference) = 277
Effective ratio: 0.153 +- 0.129
Model Accuracy over intervened graphs for r=0.25 =  0.583
SUFF_SIMPLE for r=0.25 class 1.0 = 0.494 +- 0.281 (in-sample avg dev_std = 0.829)
SUFF_SIMPLE for r=0.25 all KL = 0.19 +- 0.281 (in-sample avg dev_std = 0.829)
SUFF_SIMPLE for r=0.25 all L1 = 0.494 +- 0.246 (in-sample avg dev_std = 0.829)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05894945848375451
len(reference) = 277
Effective ratio: 0.026 +- 0.040
Model Accuracy over intervened graphs for r=0.6 =  0.563
SUFF_SIMPLE for r=0.6 class 1.0 = 0.472 +- 0.234 (in-sample avg dev_std = 0.866)
SUFF_SIMPLE for r=0.6 all KL = 0.153 +- 0.234 (in-sample avg dev_std = 0.866)
SUFF_SIMPLE for r=0.6 all L1 = 0.472 +- 0.224 (in-sample avg dev_std = 0.866)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.768
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013351587301587302
len(reference) = 2520
Effective ratio: 0.266 +- 0.077
Model Accuracy over intervened graphs for r=0.01 =  0.061
SUFF_SIMPLE for r=0.01 class 1.0 = 0.317 +- 0.341 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.01 all KL = 0.246 +- 0.341 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.01 all L1 = 0.317 +- 0.268 (in-sample avg dev_std = 0.422)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013426190476190477
len(reference) = 2520
Effective ratio: 0.028 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.062
SUFF_SIMPLE for r=0.1 class 1.0 = 0.316 +- 0.340 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 all KL = 0.245 +- 0.340 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 all L1 = 0.316 +- 0.267 (in-sample avg dev_std = 0.425)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.768
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013577380952380954
len(reference) = 2520
Effective ratio: 0.020 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.061
SUFF_SIMPLE for r=0.25 class 1.0 = 0.316 +- 0.340 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.25 all KL = 0.245 +- 0.340 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.25 all L1 = 0.316 +- 0.267 (in-sample avg dev_std = 0.424)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.768
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013490873015873015
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.059
SUFF_SIMPLE for r=0.6 class 1.0 = 0.316 +- 0.342 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.6 all KL = 0.246 +- 0.342 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.6 all L1 = 0.316 +- 0.269 (in-sample avg dev_std = 0.416)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.995
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11166410048622366
len(reference) = 2011
Effective ratio: 0.279 +- 0.384
Model Accuracy over intervened graphs for r=0.01 =  0.74
SUFF_SIMPLE for r=0.01 class 1.0 = 0.678 +- 0.390 (in-sample avg dev_std = 0.695)
SUFF_SIMPLE for r=0.01 all KL = 0.429 +- 0.390 (in-sample avg dev_std = 0.695)
SUFF_SIMPLE for r=0.01 all L1 = 0.678 +- 0.277 (in-sample avg dev_std = 0.695)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11124189627228523
len(reference) = 2156
Effective ratio: 0.225 +- 0.344
Model Accuracy over intervened graphs for r=0.1 =  0.699
SUFF_SIMPLE for r=0.1 class 1.0 = 0.648 +- 0.384 (in-sample avg dev_std = 0.690)
SUFF_SIMPLE for r=0.1 all KL = 0.399 +- 0.384 (in-sample avg dev_std = 0.690)
SUFF_SIMPLE for r=0.1 all L1 = 0.648 +- 0.289 (in-sample avg dev_std = 0.690)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.978
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11018962722852511
len(reference) = 2257
Effective ratio: 0.189 +- 0.306
Model Accuracy over intervened graphs for r=0.25 =  0.698
SUFF_SIMPLE for r=0.25 class 1.0 = 0.652 +- 0.402 (in-sample avg dev_std = 0.666)
SUFF_SIMPLE for r=0.25 all KL = 0.421 +- 0.402 (in-sample avg dev_std = 0.666)
SUFF_SIMPLE for r=0.25 all L1 = 0.652 +- 0.302 (in-sample avg dev_std = 0.666)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.966
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.09117949756888169
len(reference) = 2374
Effective ratio: 0.102 +- 0.247
Model Accuracy over intervened graphs for r=0.6 =  0.638
SUFF_SIMPLE for r=0.6 class 1.0 = 0.607 +- 0.386 (in-sample avg dev_std = 0.693)
SUFF_SIMPLE for r=0.6 all KL = 0.364 +- 0.386 (in-sample avg dev_std = 0.693)
SUFF_SIMPLE for r=0.6 all L1 = 0.607 +- 0.303 (in-sample avg dev_std = 0.693)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.0944115523465704
len(reference) = 277
Effective ratio: 0.404 +- 0.220
Model Accuracy over intervened graphs for r=0.01 =  0.831
NEC for r=0.01 class 1.0 = 0.221 +- 0.409 (in-sample avg dev_std = 0.583)
NEC for r=0.01 all KL = 0.4 +- 0.409 (in-sample avg dev_std = 0.583)
NEC for r=0.01 all L1 = 0.221 +- 0.264 (in-sample avg dev_std = 0.583)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0932129963898917
len(reference) = 277
Effective ratio: 0.179 +- 0.154
Model Accuracy over intervened graphs for r=0.1 =  0.849
NEC for r=0.1 class 1.0 = 0.17 +- 0.408 (in-sample avg dev_std = 0.411)
NEC for r=0.1 all KL = 0.245 +- 0.408 (in-sample avg dev_std = 0.411)
NEC for r=0.1 all L1 = 0.17 +- 0.297 (in-sample avg dev_std = 0.411)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09055595667870037
len(reference) = 277
Effective ratio: 0.153 +- 0.129
Model Accuracy over intervened graphs for r=0.25 =  0.863
NEC for r=0.25 class 1.0 = 0.141 +- 0.375 (in-sample avg dev_std = 0.310)
NEC for r=0.25 all KL = 0.195 +- 0.375 (in-sample avg dev_std = 0.310)
NEC for r=0.25 all L1 = 0.141 +- 0.287 (in-sample avg dev_std = 0.310)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05894945848375451
len(reference) = 277
Effective ratio: 0.026 +- 0.040
Model Accuracy over intervened graphs for r=0.6 =  0.989
NEC for r=0.6 class 1.0 = 0.009 +- 0.104 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.011 +- 0.104 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.009 +- 0.090 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.768
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013351587301587302
len(reference) = 2520
Effective ratio: 0.266 +- 0.077
Model Accuracy over intervened graphs for r=0.01 =  0.139
NEC for r=0.01 class 1.0 = 0.64 +- 0.342 (in-sample avg dev_std = 0.513)
NEC for r=0.01 all KL = 0.729 +- 0.342 (in-sample avg dev_std = 0.513)
NEC for r=0.01 all L1 = 0.64 +- 0.271 (in-sample avg dev_std = 0.513)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013426190476190477
len(reference) = 2520
Effective ratio: 0.028 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.529
NEC for r=0.1 class 1.0 = 0.296 +- 0.351 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.281 +- 0.351 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.296 +- 0.320 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.768
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013577380952380954
len(reference) = 2520
Effective ratio: 0.020 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.603
NEC for r=0.25 class 1.0 = 0.229 +- 0.298 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.195 +- 0.298 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.229 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.768
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013490873015873015
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.751
NEC for r=0.6 class 1.0 = 0.038 +- 0.067 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.012 +- 0.067 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.038 +- 0.093 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.947
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11166410048622366
len(reference) = 2468
Effective ratio: 0.279 +- 0.384
Model Accuracy over intervened graphs for r=0.01 =  0.756
NEC for r=0.01 class 1.0 = 0.212 +- 0.429 (in-sample avg dev_std = 0.361)
NEC for r=0.01 all KL = 0.269 +- 0.429 (in-sample avg dev_std = 0.361)
NEC for r=0.01 all L1 = 0.212 +- 0.346 (in-sample avg dev_std = 0.361)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.947
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11124189627228523
len(reference) = 2468
Effective ratio: 0.225 +- 0.344
Model Accuracy over intervened graphs for r=0.1 =  0.794
NEC for r=0.1 class 1.0 = 0.173 +- 0.396 (in-sample avg dev_std = 0.283)
NEC for r=0.1 all KL = 0.214 +- 0.396 (in-sample avg dev_std = 0.283)
NEC for r=0.1 all L1 = 0.173 +- 0.326 (in-sample avg dev_std = 0.283)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.947
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11018962722852511
len(reference) = 2468
Effective ratio: 0.189 +- 0.306
Model Accuracy over intervened graphs for r=0.25 =  0.826
NEC for r=0.25 class 1.0 = 0.147 +- 0.370 (in-sample avg dev_std = 0.233)
NEC for r=0.25 all KL = 0.178 +- 0.370 (in-sample avg dev_std = 0.233)
NEC for r=0.25 all L1 = 0.147 +- 0.308 (in-sample avg dev_std = 0.233)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.947
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.09117949756888169
len(reference) = 2468
Effective ratio: 0.102 +- 0.247
Model Accuracy over intervened graphs for r=0.6 =  0.894
NEC for r=0.6 class 1.0 = 0.081 +- 0.284 (in-sample avg dev_std = 0.178)
NEC for r=0.6 all KL = 0.098 +- 0.284 (in-sample avg dev_std = 0.178)
NEC for r=0.6 all L1 = 0.081 +- 0.236 (in-sample avg dev_std = 0.178)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.985, 0.984, 0.964, 0.947], 'all_L1': [0.994, 0.99, 0.981, 0.972]}), defaultdict(<class 'list'>, {'all_KL': [0.907, 0.839, 0.83, 0.805], 'all_L1': [0.953, 0.91, 0.908, 0.902]}), defaultdict(<class 'list'>, {'all_KL': [0.941, 0.892, 0.883, 0.851], 'all_L1': [0.965, 0.933, 0.928, 0.916]}), defaultdict(<class 'list'>, {'all_KL': [0.75, 0.72, 0.699, 0.683], 'all_L1': [0.841, 0.82, 0.815, 0.804]}), defaultdict(<class 'list'>, {'all_KL': [0.96, 0.942, 0.948, 0.908], 'all_L1': [0.979, 0.97, 0.97, 0.951]}), defaultdict(<class 'list'>, {'all_KL': [0.945, 0.845, 0.814, 0.804], 'all_L1': [0.974, 0.911, 0.892, 0.89]}), defaultdict(<class 'list'>, {'all_KL': [0.535, 0.464, 0.432, 0.405], 'all_L1': [0.7, 0.642, 0.633, 0.624]}), defaultdict(<class 'list'>, {'all_KL': [0.735, 0.64, 0.656, 0.604], 'all_L1': [0.825, 0.773, 0.788, 0.762]}), defaultdict(<class 'list'>, {'all_KL': [0.786, 0.799, 0.783, 0.698], 'all_L1': [0.869, 0.875, 0.866, 0.814]}), defaultdict(<class 'list'>, {'all_KL': [0.236, 0.21, 0.19, 0.153], 'all_L1': [0.533, 0.511, 0.494, 0.472]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.013, 0.007, 0.0, 0.0], 'all_L1': [0.008, 0.006, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.118, 0.063, 0.014, 0.004], 'all_L1': [0.062, 0.036, 0.012, 0.003]}), defaultdict(<class 'list'>, {'all_KL': [0.101, 0.073, 0.044, 0.011], 'all_L1': [0.054, 0.045, 0.037, 0.009]}), defaultdict(<class 'list'>, {'all_KL': [0.102, 0.048, 0.004, 0.0], 'all_L1': [0.069, 0.035, 0.003, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.015, 0.004, 0.0, 0.0], 'all_L1': [0.008, 0.003, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.082, 0.078, 0.018, 0.0], 'all_L1': [0.046, 0.048, 0.012, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.311, 0.132, 0.117, 0.018], 'all_L1': [0.195, 0.105, 0.096, 0.016]}), defaultdict(<class 'list'>, {'all_KL': [0.172, 0.101, 0.056, 0.007], 'all_L1': [0.1, 0.065, 0.045, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.078, 0.06, 0.053, 0.006], 'all_L1': [0.059, 0.048, 0.043, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.4, 0.245, 0.195, 0.011], 'all_L1': [0.221, 0.17, 0.141, 0.009]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.999, 1.0, 1.0, 0.999], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.824, 0.817, 0.819, 0.81], 'all_L1': [0.92, 0.916, 0.917, 0.913]}), defaultdict(<class 'list'>, {'all_KL': [0.989, 0.988, 0.989, 0.992], 'all_L1': [0.995, 0.994, 0.994, 0.996]}), defaultdict(<class 'list'>, {'all_KL': [0.353, 0.352, 0.355, 0.351], 'all_L1': [0.491, 0.491, 0.494, 0.489]}), defaultdict(<class 'list'>, {'all_KL': [0.977, 0.976, 0.976, 0.975], 'all_L1': [0.989, 0.988, 0.988, 0.988]}), defaultdict(<class 'list'>, {'all_KL': [0.508, 0.51, 0.516, 0.497], 'all_L1': [0.698, 0.701, 0.706, 0.693]}), defaultdict(<class 'list'>, {'all_KL': [0.314, 0.317, 0.315, 0.324], 'all_L1': [0.549, 0.546, 0.545, 0.552]}), defaultdict(<class 'list'>, {'all_KL': [0.403, 0.402, 0.399, 0.4], 'all_L1': [0.528, 0.528, 0.528, 0.527]}), defaultdict(<class 'list'>, {'all_KL': [0.897, 0.895, 0.893, 0.89], 'all_L1': [0.94, 0.939, 0.937, 0.936]}), defaultdict(<class 'list'>, {'all_KL': [0.246, 0.245, 0.245, 0.246], 'all_L1': [0.317, 0.316, 0.316, 0.316]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.0, 0.0], 'all_L1': [0.0, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.028, 0.0, 0.0, 0.0], 'all_L1': [0.017, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.003, 0.0, 0.0, 0.0], 'all_L1': [0.002, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.376, 0.022, 0.0, 0.0], 'all_L1': [0.34, 0.027, 0.001, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.001, 0.0, 0.0, 0.0], 'all_L1': [0.001, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.057, 0.001, 0.0, 0.0], 'all_L1': [0.038, 0.001, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.022, 0.002, 0.002, 0.0], 'all_L1': [0.019, 0.002, 0.001, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.522, 0.169, 0.064, 0.007], 'all_L1': [0.417, 0.153, 0.059, 0.008]}), defaultdict(<class 'list'>, {'all_KL': [0.005, 0.002, 0.002, 0.0], 'all_L1': [0.005, 0.002, 0.002, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.729, 0.281, 0.195, 0.012], 'all_L1': [0.64, 0.296, 0.229, 0.038]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.963, 0.964, 0.94, 0.918], 'all_L1': [0.985, 0.985, 0.97, 0.96]}), defaultdict(<class 'list'>, {'all_KL': [0.92, 0.912, 0.907, 0.88], 'all_L1': [0.96, 0.955, 0.95, 0.938]}), defaultdict(<class 'list'>, {'all_KL': [0.925, 0.923, 0.914, 0.893], 'all_L1': [0.958, 0.956, 0.948, 0.934]}), defaultdict(<class 'list'>, {'all_KL': [0.906, 0.899, 0.869, 0.839], 'all_L1': [0.942, 0.934, 0.914, 0.898]}), defaultdict(<class 'list'>, {'all_KL': [0.926, 0.927, 0.922, 0.877], 'all_L1': [0.967, 0.968, 0.965, 0.937]}), defaultdict(<class 'list'>, {'all_KL': [0.927, 0.907, 0.904, 0.876], 'all_L1': [0.961, 0.947, 0.946, 0.926]}), defaultdict(<class 'list'>, {'all_KL': [0.762, 0.772, 0.767, 0.716], 'all_L1': [0.841, 0.847, 0.84, 0.811]}), defaultdict(<class 'list'>, {'all_KL': [0.899, 0.877, 0.872, 0.856], 'all_L1': [0.938, 0.921, 0.919, 0.908]}), defaultdict(<class 'list'>, {'all_KL': [0.674, 0.673, 0.676, 0.567], 'all_L1': [0.809, 0.808, 0.808, 0.718]}), defaultdict(<class 'list'>, {'all_KL': [0.429, 0.399, 0.421, 0.364], 'all_L1': [0.678, 0.648, 0.652, 0.607]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.033, 0.015, 0.003, 0.0], 'all_L1': [0.016, 0.008, 0.002, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.107, 0.08, 0.051, 0.013], 'all_L1': [0.054, 0.042, 0.031, 0.011]}), defaultdict(<class 'list'>, {'all_KL': [0.108, 0.084, 0.055, 0.029], 'all_L1': [0.061, 0.05, 0.036, 0.024]}), defaultdict(<class 'list'>, {'all_KL': [0.096, 0.068, 0.049, 0.021], 'all_L1': [0.066, 0.052, 0.039, 0.02]}), defaultdict(<class 'list'>, {'all_KL': [0.066, 0.045, 0.033, 0.011], 'all_L1': [0.034, 0.025, 0.02, 0.008]}), defaultdict(<class 'list'>, {'all_KL': [0.128, 0.094, 0.072, 0.03], 'all_L1': [0.07, 0.056, 0.047, 0.025]}), defaultdict(<class 'list'>, {'all_KL': [0.215, 0.155, 0.123, 0.058], 'all_L1': [0.145, 0.112, 0.095, 0.047]}), defaultdict(<class 'list'>, {'all_KL': [0.147, 0.094, 0.066, 0.036], 'all_L1': [0.09, 0.059, 0.045, 0.027]}), defaultdict(<class 'list'>, {'all_KL': [0.165, 0.133, 0.126, 0.069], 'all_L1': [0.131, 0.108, 0.102, 0.055]}), defaultdict(<class 'list'>, {'all_KL': [0.269, 0.214, 0.178, 0.098], 'all_L1': [0.212, 0.173, 0.147, 0.081]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.863 +- 0.141, 0.834 +- 0.145, 0.828 +- 0.147, 0.811 +- 0.149
suff_simple class all_KL  =  0.778 +- 0.224, 0.734 +- 0.227, 0.720 +- 0.231, 0.686 +- 0.233
suff_simple_acc_int  =  0.890 +- 0.118, 0.862 +- 0.123, 0.860 +- 0.123, 0.852 +- 0.126
nec class all_L1  =  0.082 +- 0.068, 0.056 +- 0.047, 0.039 +- 0.044, 0.005 +- 0.005
nec class all_KL  =  0.139 +- 0.118, 0.081 +- 0.066, 0.050 +- 0.059, 0.006 +- 0.006
nec_acc_int  =  0.936 +- 0.054, 0.949 +- 0.044, 0.959 +- 0.044, 0.994 +- 0.006

Eval split val
suff_simple class all_L1  =  0.743 +- 0.243, 0.742 +- 0.243, 0.743 +- 0.243, 0.741 +- 0.243
suff_simple class all_KL  =  0.651 +- 0.297, 0.650 +- 0.296, 0.651 +- 0.296, 0.648 +- 0.295
suff_simple_acc_int  =  0.637 +- 0.308, 0.637 +- 0.307, 0.638 +- 0.307, 0.636 +- 0.307
nec class all_L1  =  0.148 +- 0.220, 0.048 +- 0.094, 0.029 +- 0.069, 0.005 +- 0.011
nec class all_KL  =  0.174 +- 0.254, 0.048 +- 0.092, 0.026 +- 0.059, 0.002 +- 0.004
nec_acc_int  =  0.718 +- 0.306, 0.816 +- 0.184, 0.836 +- 0.152, 0.856 +- 0.125

Eval split test
suff_simple class all_L1  =  0.904 +- 0.093, 0.897 +- 0.098, 0.891 +- 0.095, 0.864 +- 0.110
suff_simple class all_KL  =  0.833 +- 0.159, 0.825 +- 0.164, 0.819 +- 0.154, 0.779 +- 0.171
suff_simple_acc_int  =  0.925 +- 0.076, 0.916 +- 0.084, 0.911 +- 0.082, 0.887 +- 0.104
nec class all_L1  =  0.088 +- 0.056, 0.069 +- 0.046, 0.056 +- 0.042, 0.030 +- 0.023
nec class all_KL  =  0.133 +- 0.066, 0.098 +- 0.054, 0.076 +- 0.049, 0.036 +- 0.029
nec_acc_int  =  0.924 +- 0.068, 0.937 +- 0.058, 0.946 +- 0.052, 0.965 +- 0.030


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.473 +- 0.039, 0.445 +- 0.051, 0.433 +- 0.054, 0.408 +- 0.073
Faith. Armon (L1)= 		  =  0.137 +- 0.097, 0.098 +- 0.071, 0.068 +- 0.071, 0.009 +- 0.010
Faith. GMean (L1)= 	  =  0.233 +- 0.087, 0.188 +- 0.070, 0.133 +- 0.091, 0.044 +- 0.038
Faith. Aritm (KL)= 		  =  0.459 +- 0.059, 0.407 +- 0.083, 0.385 +- 0.088, 0.346 +- 0.115
Faith. Armon (KL)= 		  =  0.189 +- 0.109, 0.122 +- 0.069, 0.073 +- 0.068, 0.011 +- 0.011
Faith. GMean (KL)= 	  =  0.274 +- 0.089, 0.202 +- 0.068, 0.129 +- 0.082, 0.041 +- 0.036

Eval split val
Faith. Aritm (L1)= 		  =  0.445 +- 0.067, 0.395 +- 0.093, 0.386 +- 0.102, 0.373 +- 0.118
Faith. Armon (L1)= 		  =  0.145 +- 0.189, 0.060 +- 0.108, 0.038 +- 0.082, 0.009 +- 0.020
Faith. GMean (L1)= 	  =  0.186 +- 0.174, 0.081 +- 0.112, 0.053 +- 0.088, 0.020 +- 0.036
Faith. Aritm (KL)= 		  =  0.413 +- 0.104, 0.349 +- 0.126, 0.338 +- 0.134, 0.325 +- 0.147
Faith. Armon (KL)= 		  =  0.140 +- 0.171, 0.055 +- 0.098, 0.034 +- 0.069, 0.004 +- 0.008
Faith. GMean (KL)= 	  =  0.180 +- 0.163, 0.070 +- 0.099, 0.045 +- 0.075, 0.011 +- 0.021

Eval split test
Faith. Aritm (L1)= 		  =  0.496 +- 0.021, 0.483 +- 0.027, 0.474 +- 0.028, 0.447 +- 0.044
Faith. Armon (L1)= 		  =  0.153 +- 0.084, 0.122 +- 0.073, 0.101 +- 0.069, 0.056 +- 0.041
Faith. GMean (L1)= 	  =  0.263 +- 0.073, 0.229 +- 0.069, 0.202 +- 0.075, 0.140 +- 0.061
Faith. Aritm (KL)= 		  =  0.483 +- 0.053, 0.462 +- 0.059, 0.447 +- 0.055, 0.408 +- 0.072
Faith. Armon (KL)= 		  =  0.215 +- 0.081, 0.164 +- 0.072, 0.129 +- 0.071, 0.066 +- 0.046
Faith. GMean (KL)= 	  =  0.314 +- 0.060, 0.264 +- 0.059, 0.224 +- 0.069, 0.143 +- 0.059
Computed for split load_split = id



Completed in  0:52:04.238871  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN TopoFeature/basis/no_shift NEC_ALPHA 0.05 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 21:36:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 09:36:12 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 09:36:12 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 09:36:12 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 09:36:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:36:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:36:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:36:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:36:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:36:12 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 09:36:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.509
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.771
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.685
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.656
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.070
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.848
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.766
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.710
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.229
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.705
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.663
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.604


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.509173285198556
len(reference) = 277
Effective ratio: 0.257 +- 0.142
Model Accuracy over intervened graphs for r=0.5 =  0.352
SUFF_SIMPLE for r=0.5 class 1.0 = 0.38 +- 0.306 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.5 all KL = 0.123 +- 0.306 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.5 all L1 = 0.38 +- 0.300 (in-sample avg dev_std = 0.556)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.770898916967509
len(reference) = 277
Effective ratio: 0.063 +- 0.051
Model Accuracy over intervened graphs for r=0.8 =  0.517
SUFF_SIMPLE for r=0.8 class 1.0 = 0.402 +- 0.321 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.8 all KL = 0.134 +- 0.321 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.8 all L1 = 0.402 +- 0.287 (in-sample avg dev_std = 0.556)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6848158844765344
len(reference) = 277
Effective ratio: 0.057 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.504
SUFF_SIMPLE for r=0.9 class 1.0 = 0.389 +- 0.269 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.9 all KL = 0.094 +- 0.269 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.9 all L1 = 0.389 +- 0.266 (in-sample avg dev_std = 0.578)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6561841155234657
len(reference) = 277
Effective ratio: 0.051 +- 0.038
Model Accuracy over intervened graphs for r=0.95 =  0.455
SUFF_SIMPLE for r=0.95 class 1.0 = 0.378 +- 0.280 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.95 all KL = 0.103 +- 0.280 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.95 all L1 = 0.378 +- 0.280 (in-sample avg dev_std = 0.558)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.458
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07047936507936509
len(reference) = 2520
Effective ratio: 0.370 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.023
SUFF_SIMPLE for r=0.5 class 1.0 = 0.564 +- 0.455 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.5 all KL = 0.522 +- 0.455 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.5 all L1 = 0.564 +- 0.393 (in-sample avg dev_std = 0.201)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8475571428571429
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.024
SUFF_SIMPLE for r=0.8 class 1.0 = 0.558 +- 0.455 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.8 all KL = 0.513 +- 0.455 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.8 all L1 = 0.558 +- 0.392 (in-sample avg dev_std = 0.213)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.458
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7663146825396826
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.022
SUFF_SIMPLE for r=0.9 class 1.0 = 0.558 +- 0.455 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.9 all KL = 0.513 +- 0.455 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.9 all L1 = 0.558 +- 0.392 (in-sample avg dev_std = 0.206)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.458
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7103154761904762
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.022
SUFF_SIMPLE for r=0.95 class 1.0 = 0.559 +- 0.455 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.95 all KL = 0.514 +- 0.455 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.95 all L1 = 0.559 +- 0.392 (in-sample avg dev_std = 0.207)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.777
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.22853241491085902
len(reference) = 2461
Effective ratio: 0.423 +- 0.152
Model Accuracy over intervened graphs for r=0.5 =  0.486
SUFF_SIMPLE for r=0.5 class 1.0 = 0.554 +- 0.453 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.5 all KL = 0.461 +- 0.453 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.5 all L1 = 0.554 +- 0.380 (in-sample avg dev_std = 0.251)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.778
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7053063209076176
len(reference) = 2468
Effective ratio: 0.072 +- 0.116
Model Accuracy over intervened graphs for r=0.8 =  0.686
SUFF_SIMPLE for r=0.8 class 1.0 = 0.577 +- 0.440 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.8 all KL = 0.408 +- 0.440 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.8 all L1 = 0.577 +- 0.325 (in-sample avg dev_std = 0.367)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.778
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6630097244732577
len(reference) = 2468
Effective ratio: 0.054 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.657
SUFF_SIMPLE for r=0.9 class 1.0 = 0.577 +- 0.441 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.9 all KL = 0.411 +- 0.441 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.9 all L1 = 0.577 +- 0.329 (in-sample avg dev_std = 0.377)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.778
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6043982982171799
len(reference) = 2468
Effective ratio: 0.046 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.624
SUFF_SIMPLE for r=0.95 class 1.0 = 0.574 +- 0.442 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.95 all KL = 0.414 +- 0.442 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.95 all L1 = 0.574 +- 0.336 (in-sample avg dev_std = 0.382)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.509173285198556
len(reference) = 277
Effective ratio: 0.257 +- 0.142
Model Accuracy over intervened graphs for r=0.5 =  0.208
NEC for r=0.5 class 1.0 = 0.742 +- 0.153 (in-sample avg dev_std = 0.474)
NEC for r=0.5 all KL = 0.966 +- 0.153 (in-sample avg dev_std = 0.474)
NEC for r=0.5 all L1 = 0.742 +- 0.210 (in-sample avg dev_std = 0.474)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.770898916967509
len(reference) = 277
Effective ratio: 0.063 +- 0.051
Model Accuracy over intervened graphs for r=0.8 =  0.007
NEC for r=0.8 class 1.0 = 0.854 +- 0.084 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.993 +- 0.084 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.854 +- 0.074 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6848158844765344
len(reference) = 277
Effective ratio: 0.057 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.018
NEC for r=0.9 class 1.0 = 0.845 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.982 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.845 +- 0.115 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6561841155234657
len(reference) = 277
Effective ratio: 0.051 +- 0.038
Model Accuracy over intervened graphs for r=0.95 =  0.076
NEC for r=0.95 class 1.0 = 0.796 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.926 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.796 +- 0.226 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.458
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07047936507936509
len(reference) = 2520
Effective ratio: 0.370 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.089
NEC for r=0.5 class 1.0 = 0.426 +- 0.437 (in-sample avg dev_std = 0.357)
NEC for r=0.5 all KL = 0.493 +- 0.437 (in-sample avg dev_std = 0.357)
NEC for r=0.5 all L1 = 0.426 +- 0.369 (in-sample avg dev_std = 0.357)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8475571428571429
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.428 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.459 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.428 +- 0.400 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.458
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7663146825396826
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.428 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.459 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.428 +- 0.400 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.458
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7103154761904762
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.428 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.459 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.428 +- 0.400 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.778
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.22853241491085902
len(reference) = 2468
Effective ratio: 0.423 +- 0.152
Model Accuracy over intervened graphs for r=0.5 =  0.28
NEC for r=0.5 class 1.0 = 0.625 +- 0.315 (in-sample avg dev_std = 0.465)
NEC for r=0.5 all KL = 0.798 +- 0.315 (in-sample avg dev_std = 0.465)
NEC for r=0.5 all L1 = 0.625 +- 0.285 (in-sample avg dev_std = 0.465)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.778
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7053063209076176
len(reference) = 2468
Effective ratio: 0.072 +- 0.116
Model Accuracy over intervened graphs for r=0.8 =  0.087
NEC for r=0.8 class 1.0 = 0.662 +- 0.390 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.766 +- 0.390 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.662 +- 0.331 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.778
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6630097244732577
len(reference) = 2468
Effective ratio: 0.054 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.094
NEC for r=0.9 class 1.0 = 0.64 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.736 +- 0.412 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.64 +- 0.350 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.778
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6043982982171799
len(reference) = 2468
Effective ratio: 0.046 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.118
NEC for r=0.95 class 1.0 = 0.618 +- 0.426 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.71 +- 0.426 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.618 +- 0.363 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 21:41:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 09:41:33 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 09:41:33 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 09:41:33 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 09:41:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:41:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:41:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:41:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:41:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:41:33 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 09:41:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 76 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.469
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.940
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.813
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.705
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.072
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.947
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.916
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.879
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.246
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.777
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.718
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.637


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.4693032490974729
len(reference) = 277
Effective ratio: 0.273 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.4
SUFF_SIMPLE for r=0.5 class 1.0 = 0.424 +- 0.388 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.5 all KL = 0.217 +- 0.388 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.5 all L1 = 0.424 +- 0.344 (in-sample avg dev_std = 0.514)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9399350180505416
len(reference) = 277
Effective ratio: 0.087 +- 0.071
Model Accuracy over intervened graphs for r=0.8 =  0.398
SUFF_SIMPLE for r=0.8 class 1.0 = 0.421 +- 0.372 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.8 all KL = 0.199 +- 0.372 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.8 all L1 = 0.421 +- 0.337 (in-sample avg dev_std = 0.535)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8125631768953069
len(reference) = 277
Effective ratio: 0.069 +- 0.050
Model Accuracy over intervened graphs for r=0.9 =  0.394
SUFF_SIMPLE for r=0.9 class 1.0 = 0.414 +- 0.360 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.9 all KL = 0.187 +- 0.360 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.9 all L1 = 0.414 +- 0.327 (in-sample avg dev_std = 0.553)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7045126353790613
len(reference) = 277
Effective ratio: 0.059 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.403
SUFF_SIMPLE for r=0.95 class 1.0 = 0.418 +- 0.359 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.95 all KL = 0.188 +- 0.359 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.95 all L1 = 0.418 +- 0.326 (in-sample avg dev_std = 0.574)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.788
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07225436507936507
len(reference) = 2520
Effective ratio: 0.350 +- 0.107
Model Accuracy over intervened graphs for r=0.5 =  0.04
SUFF_SIMPLE for r=0.5 class 1.0 = 0.31 +- 0.355 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.5 all KL = 0.239 +- 0.355 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.5 all L1 = 0.31 +- 0.288 (in-sample avg dev_std = 0.227)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9467277777777777
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.042
SUFF_SIMPLE for r=0.8 class 1.0 = 0.305 +- 0.350 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.8 all KL = 0.233 +- 0.350 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.8 all L1 = 0.305 +- 0.283 (in-sample avg dev_std = 0.251)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.788
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.916395238095238
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.04
SUFF_SIMPLE for r=0.9 class 1.0 = 0.306 +- 0.352 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.9 all KL = 0.234 +- 0.352 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.9 all L1 = 0.306 +- 0.284 (in-sample avg dev_std = 0.247)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.788
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8785488095238096
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.04
SUFF_SIMPLE for r=0.95 class 1.0 = 0.304 +- 0.349 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.95 all KL = 0.232 +- 0.349 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.95 all L1 = 0.304 +- 0.282 (in-sample avg dev_std = 0.254)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.734
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2458427876823339
len(reference) = 2467
Effective ratio: 0.356 +- 0.141
Model Accuracy over intervened graphs for r=0.5 =  0.463
SUFF_SIMPLE for r=0.5 class 1.0 = 0.513 +- 0.433 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.5 all KL = 0.424 +- 0.433 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.5 all L1 = 0.513 +- 0.362 (in-sample avg dev_std = 0.318)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.735
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7774262560777958
len(reference) = 2468
Effective ratio: 0.080 +- 0.113
Model Accuracy over intervened graphs for r=0.8 =  0.439
SUFF_SIMPLE for r=0.8 class 1.0 = 0.494 +- 0.420 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.8 all KL = 0.391 +- 0.420 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.8 all L1 = 0.494 +- 0.346 (in-sample avg dev_std = 0.382)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7183829011345219
len(reference) = 2468
Effective ratio: 0.061 +- 0.086
Model Accuracy over intervened graphs for r=0.9 =  0.43
SUFF_SIMPLE for r=0.9 class 1.0 = 0.504 +- 0.419 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.9 all KL = 0.399 +- 0.419 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.9 all L1 = 0.504 +- 0.346 (in-sample avg dev_std = 0.394)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.735
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6367119124797408
len(reference) = 2468
Effective ratio: 0.047 +- 0.063
Model Accuracy over intervened graphs for r=0.95 =  0.414
SUFF_SIMPLE for r=0.95 class 1.0 = 0.517 +- 0.422 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.95 all KL = 0.416 +- 0.422 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.95 all L1 = 0.517 +- 0.349 (in-sample avg dev_std = 0.392)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.4693032490974729
len(reference) = 277
Effective ratio: 0.273 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.208
NEC for r=0.5 class 1.0 = 0.751 +- 0.110 (in-sample avg dev_std = 0.511)
NEC for r=0.5 all KL = 0.978 +- 0.110 (in-sample avg dev_std = 0.511)
NEC for r=0.5 all L1 = 0.751 +- 0.186 (in-sample avg dev_std = 0.511)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9399350180505416
len(reference) = 277
Effective ratio: 0.087 +- 0.071
Model Accuracy over intervened graphs for r=0.8 =  0.004
NEC for r=0.8 class 1.0 = 0.858 +- 0.037 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.998 +- 0.037 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.858 +- 0.049 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8125631768953069
len(reference) = 277
Effective ratio: 0.069 +- 0.050
Model Accuracy over intervened graphs for r=0.9 =  0.025
NEC for r=0.9 class 1.0 = 0.843 +- 0.109 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.987 +- 0.109 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.843 +- 0.106 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7045126353790613
len(reference) = 277
Effective ratio: 0.059 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.047
NEC for r=0.95 class 1.0 = 0.824 +- 0.195 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.96 +- 0.195 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.824 +- 0.170 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.788
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07225436507936507
len(reference) = 2520
Effective ratio: 0.350 +- 0.107
Model Accuracy over intervened graphs for r=0.5 =  0.219
NEC for r=0.5 class 1.0 = 0.603 +- 0.355 (in-sample avg dev_std = 0.466)
NEC for r=0.5 all KL = 0.704 +- 0.355 (in-sample avg dev_std = 0.466)
NEC for r=0.5 all L1 = 0.603 +- 0.292 (in-sample avg dev_std = 0.466)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9467277777777777
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.707 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.772 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.707 +- 0.285 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.788
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.916395238095238
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.707 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.772 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.707 +- 0.284 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.788
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8785488095238096
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.001
NEC for r=0.95 class 1.0 = 0.707 +- 0.354 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.771 +- 0.354 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.707 +- 0.285 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.735
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2458427876823339
len(reference) = 2468
Effective ratio: 0.356 +- 0.141
Model Accuracy over intervened graphs for r=0.5 =  0.166
NEC for r=0.5 class 1.0 = 0.623 +- 0.370 (in-sample avg dev_std = 0.404)
NEC for r=0.5 all KL = 0.734 +- 0.370 (in-sample avg dev_std = 0.404)
NEC for r=0.5 all L1 = 0.623 +- 0.306 (in-sample avg dev_std = 0.404)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.735
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7774262560777958
len(reference) = 2468
Effective ratio: 0.080 +- 0.113
Model Accuracy over intervened graphs for r=0.8 =  0.084
NEC for r=0.8 class 1.0 = 0.614 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.7 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.614 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7183829011345219
len(reference) = 2468
Effective ratio: 0.061 +- 0.086
Model Accuracy over intervened graphs for r=0.9 =  0.096
NEC for r=0.9 class 1.0 = 0.597 +- 0.428 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.678 +- 0.428 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.597 +- 0.363 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.735
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6367119124797408
len(reference) = 2468
Effective ratio: 0.047 +- 0.063
Model Accuracy over intervened graphs for r=0.95 =  0.114
NEC for r=0.95 class 1.0 = 0.576 +- 0.439 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.649 +- 0.439 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.576 +- 0.374 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 21:46:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 09:46:22 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 09:46:22 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 09:46:22 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 09:46:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:46:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:46:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:46:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:46:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:46:22 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 09:46:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.597
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.888
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.801
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.682
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.104
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.937
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.907
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.863
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.245
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.748
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.746
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.664


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5966462093862817
len(reference) = 277
Effective ratio: 0.214 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.373
SUFF_SIMPLE for r=0.5 class 1.0 = 0.391 +- 0.311 (in-sample avg dev_std = 0.579)
SUFF_SIMPLE for r=0.5 all KL = 0.126 +- 0.311 (in-sample avg dev_std = 0.579)
SUFF_SIMPLE for r=0.5 all L1 = 0.391 +- 0.310 (in-sample avg dev_std = 0.579)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8880902527075812
len(reference) = 277
Effective ratio: 0.075 +- 0.052
Model Accuracy over intervened graphs for r=0.8 =  0.415
SUFF_SIMPLE for r=0.8 class 1.0 = 0.435 +- 0.367 (in-sample avg dev_std = 0.534)
SUFF_SIMPLE for r=0.8 all KL = 0.186 +- 0.367 (in-sample avg dev_std = 0.534)
SUFF_SIMPLE for r=0.8 all L1 = 0.435 +- 0.342 (in-sample avg dev_std = 0.534)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8011263537906137
len(reference) = 277
Effective ratio: 0.066 +- 0.046
Model Accuracy over intervened graphs for r=0.9 =  0.412
SUFF_SIMPLE for r=0.9 class 1.0 = 0.429 +- 0.373 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.9 all KL = 0.188 +- 0.373 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.9 all L1 = 0.429 +- 0.338 (in-sample avg dev_std = 0.553)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6816606498194946
len(reference) = 277
Effective ratio: 0.056 +- 0.041
Model Accuracy over intervened graphs for r=0.95 =  0.413
SUFF_SIMPLE for r=0.95 class 1.0 = 0.425 +- 0.356 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.95 all KL = 0.17 +- 0.356 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.95 all L1 = 0.425 +- 0.331 (in-sample avg dev_std = 0.571)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.874
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.1041420634920635
len(reference) = 2520
Effective ratio: 0.262 +- 0.115
Model Accuracy over intervened graphs for r=0.5 =  0.02
SUFF_SIMPLE for r=0.5 class 1.0 = 0.24 +- 0.305 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.5 all KL = 0.13 +- 0.305 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.5 all L1 = 0.24 +- 0.249 (in-sample avg dev_std = 0.219)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9371210317460318
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.047
SUFF_SIMPLE for r=0.8 class 1.0 = 0.255 +- 0.312 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.8 all KL = 0.139 +- 0.312 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.8 all L1 = 0.255 +- 0.259 (in-sample avg dev_std = 0.274)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9074825396825396
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.046
SUFF_SIMPLE for r=0.9 class 1.0 = 0.255 +- 0.314 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.9 all KL = 0.14 +- 0.314 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.9 all L1 = 0.255 +- 0.259 (in-sample avg dev_std = 0.277)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.874
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8634924603174604
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.048
SUFF_SIMPLE for r=0.95 class 1.0 = 0.256 +- 0.312 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.95 all KL = 0.139 +- 0.312 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.95 all L1 = 0.256 +- 0.259 (in-sample avg dev_std = 0.278)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.741
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.24458306320907616
len(reference) = 2465
Effective ratio: 0.407 +- 0.140
Model Accuracy over intervened graphs for r=0.5 =  0.444
SUFF_SIMPLE for r=0.5 class 1.0 = 0.462 +- 0.422 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.5 all KL = 0.371 +- 0.422 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.5 all L1 = 0.462 +- 0.354 (in-sample avg dev_std = 0.298)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.741
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7477086709886548
len(reference) = 2468
Effective ratio: 0.079 +- 0.110
Model Accuracy over intervened graphs for r=0.8 =  0.466
SUFF_SIMPLE for r=0.8 class 1.0 = 0.495 +- 0.419 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.8 all KL = 0.399 +- 0.419 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.8 all L1 = 0.495 +- 0.349 (in-sample avg dev_std = 0.343)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7464862236628849
len(reference) = 2468
Effective ratio: 0.062 +- 0.092
Model Accuracy over intervened graphs for r=0.9 =  0.466
SUFF_SIMPLE for r=0.9 class 1.0 = 0.501 +- 0.422 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.9 all KL = 0.407 +- 0.422 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.9 all L1 = 0.501 +- 0.351 (in-sample avg dev_std = 0.355)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.741
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6643585899513776
len(reference) = 2468
Effective ratio: 0.050 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.465
SUFF_SIMPLE for r=0.95 class 1.0 = 0.515 +- 0.424 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.95 all KL = 0.423 +- 0.424 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.95 all L1 = 0.515 +- 0.354 (in-sample avg dev_std = 0.347)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5966462093862817
len(reference) = 277
Effective ratio: 0.214 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.202
NEC for r=0.5 class 1.0 = 0.73 +- 0.182 (in-sample avg dev_std = 0.418)
NEC for r=0.5 all KL = 0.952 +- 0.182 (in-sample avg dev_std = 0.418)
NEC for r=0.5 all L1 = 0.73 +- 0.240 (in-sample avg dev_std = 0.418)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8880902527075812
len(reference) = 277
Effective ratio: 0.075 +- 0.052
Model Accuracy over intervened graphs for r=0.8 =  0.094
NEC for r=0.8 class 1.0 = 0.797 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.958 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.797 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8011263537906137
len(reference) = 277
Effective ratio: 0.066 +- 0.046
Model Accuracy over intervened graphs for r=0.9 =  0.159
NEC for r=0.9 class 1.0 = 0.757 +- 0.202 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.942 +- 0.202 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.757 +- 0.238 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6816606498194946
len(reference) = 277
Effective ratio: 0.056 +- 0.041
Model Accuracy over intervened graphs for r=0.95 =  0.191
NEC for r=0.95 class 1.0 = 0.727 +- 0.267 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.908 +- 0.267 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.727 +- 0.274 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.874
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.1041420634920635
len(reference) = 2520
Effective ratio: 0.262 +- 0.115
Model Accuracy over intervened graphs for r=0.5 =  0.172
NEC for r=0.5 class 1.0 = 0.661 +- 0.363 (in-sample avg dev_std = 0.332)
NEC for r=0.5 all KL = 0.79 +- 0.363 (in-sample avg dev_std = 0.332)
NEC for r=0.5 all L1 = 0.661 +- 0.315 (in-sample avg dev_std = 0.332)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9371210317460318
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.769 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.872 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.769 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9074825396825396
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.001
NEC for r=0.9 class 1.0 = 0.769 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.872 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.769 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.874
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8634924603174604
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.005
NEC for r=0.95 class 1.0 = 0.769 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.872 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.769 +- 0.247 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.741
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.24458306320907616
len(reference) = 2468
Effective ratio: 0.407 +- 0.140
Model Accuracy over intervened graphs for r=0.5 =  0.184
NEC for r=0.5 class 1.0 = 0.59 +- 0.378 (in-sample avg dev_std = 0.429)
NEC for r=0.5 all KL = 0.698 +- 0.378 (in-sample avg dev_std = 0.429)
NEC for r=0.5 all L1 = 0.59 +- 0.315 (in-sample avg dev_std = 0.429)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.741
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7477086709886548
len(reference) = 2468
Effective ratio: 0.079 +- 0.110
Model Accuracy over intervened graphs for r=0.8 =  0.098
NEC for r=0.8 class 1.0 = 0.586 +- 0.426 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.664 +- 0.426 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.586 +- 0.366 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7464862236628849
len(reference) = 2468
Effective ratio: 0.062 +- 0.092
Model Accuracy over intervened graphs for r=0.9 =  0.123
NEC for r=0.9 class 1.0 = 0.564 +- 0.435 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.639 +- 0.435 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.564 +- 0.374 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.741
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6643585899513776
len(reference) = 2468
Effective ratio: 0.050 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.139
NEC for r=0.95 class 1.0 = 0.55 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.623 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.55 +- 0.379 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 21:51:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 09:51:58 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 09:51:58 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 09:51:58 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 09:51:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:51:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:51:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:51:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:51:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:51:58 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 09:51:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.503
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.943
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.866
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.799
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.107
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.903
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.954
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.968
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.286
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.848
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.820
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.770


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5026534296028882
len(reference) = 277
Effective ratio: 0.266 +- 0.142
Model Accuracy over intervened graphs for r=0.5 =  0.296
SUFF_SIMPLE for r=0.5 class 1.0 = 0.299 +- 0.111 (in-sample avg dev_std = 0.647)
SUFF_SIMPLE for r=0.5 all KL = 0.027 +- 0.111 (in-sample avg dev_std = 0.647)
SUFF_SIMPLE for r=0.5 all L1 = 0.299 +- 0.204 (in-sample avg dev_std = 0.647)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9430361010830325
len(reference) = 277
Effective ratio: 0.091 +- 0.074
Model Accuracy over intervened graphs for r=0.8 =  0.28
SUFF_SIMPLE for r=0.8 class 1.0 = 0.289 +- 0.116 (in-sample avg dev_std = 0.647)
SUFF_SIMPLE for r=0.8 all KL = 0.024 +- 0.116 (in-sample avg dev_std = 0.647)
SUFF_SIMPLE for r=0.8 all L1 = 0.289 +- 0.200 (in-sample avg dev_std = 0.647)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8663501805054151
len(reference) = 277
Effective ratio: 0.076 +- 0.055
Model Accuracy over intervened graphs for r=0.9 =  0.277
SUFF_SIMPLE for r=0.9 class 1.0 = 0.285 +- 0.125 (in-sample avg dev_std = 0.651)
SUFF_SIMPLE for r=0.9 all KL = 0.026 +- 0.125 (in-sample avg dev_std = 0.651)
SUFF_SIMPLE for r=0.9 all L1 = 0.285 +- 0.195 (in-sample avg dev_std = 0.651)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7991516245487365
len(reference) = 277
Effective ratio: 0.068 +- 0.050
Model Accuracy over intervened graphs for r=0.95 =  0.269
SUFF_SIMPLE for r=0.95 class 1.0 = 0.282 +- 0.070 (in-sample avg dev_std = 0.631)
SUFF_SIMPLE for r=0.95 all KL = 0.015 +- 0.070 (in-sample avg dev_std = 0.631)
SUFF_SIMPLE for r=0.95 all L1 = 0.282 +- 0.190 (in-sample avg dev_std = 0.631)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.775
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10677738095238096
len(reference) = 2520
Effective ratio: 0.225 +- 0.066
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.302 +- 0.368 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.5 all KL = 0.232 +- 0.368 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.5 all L1 = 0.302 +- 0.299 (in-sample avg dev_std = 0.014)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9031869047619048
len(reference) = 2520
Effective ratio: 0.015 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.302 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.232 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.302 +- 0.299 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9540456349206348
len(reference) = 2520
Effective ratio: 0.014 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.0
SUFF_SIMPLE for r=0.9 class 1.0 = 0.302 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.232 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.302 +- 0.299 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.775
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9678015873015874
len(reference) = 2520
Effective ratio: 0.013 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.0
SUFF_SIMPLE for r=0.95 class 1.0 = 0.302 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.95 all KL = 0.232 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.95 all L1 = 0.302 +- 0.299 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.845
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2860761750405187
len(reference) = 2468
Effective ratio: 0.316 +- 0.177
Model Accuracy over intervened graphs for r=0.5 =  0.501
SUFF_SIMPLE for r=0.5 class 1.0 = 0.58 +- 0.458 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.5 all KL = 0.512 +- 0.458 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.5 all L1 = 0.58 +- 0.380 (in-sample avg dev_std = 0.232)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.845
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8476004862236628
len(reference) = 2468
Effective ratio: 0.088 +- 0.121
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 1.0 = 0.586 +- 0.456 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.8 all KL = 0.519 +- 0.456 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.8 all L1 = 0.586 +- 0.378 (in-sample avg dev_std = 0.262)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.819965964343598
len(reference) = 2468
Effective ratio: 0.063 +- 0.074
Model Accuracy over intervened graphs for r=0.9 =  0.495
SUFF_SIMPLE for r=0.9 class 1.0 = 0.593 +- 0.454 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.9 all KL = 0.528 +- 0.454 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.9 all L1 = 0.593 +- 0.379 (in-sample avg dev_std = 0.269)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.845
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7702868719611021
len(reference) = 2468
Effective ratio: 0.052 +- 0.056
Model Accuracy over intervened graphs for r=0.95 =  0.49
SUFF_SIMPLE for r=0.95 class 1.0 = 0.589 +- 0.449 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.95 all KL = 0.52 +- 0.449 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.95 all L1 = 0.589 +- 0.376 (in-sample avg dev_std = 0.281)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5026534296028882
len(reference) = 277
Effective ratio: 0.266 +- 0.142
Model Accuracy over intervened graphs for r=0.5 =  0.131
NEC for r=0.5 class 1.0 = 0.8 +- 0.094 (in-sample avg dev_std = 0.446)
NEC for r=0.5 all KL = 0.988 +- 0.094 (in-sample avg dev_std = 0.446)
NEC for r=0.5 all L1 = 0.8 +- 0.134 (in-sample avg dev_std = 0.446)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9430361010830325
len(reference) = 277
Effective ratio: 0.091 +- 0.074
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.863 +- 0.003 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.863 +- 0.011 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8663501805054151
len(reference) = 277
Effective ratio: 0.076 +- 0.055
Model Accuracy over intervened graphs for r=0.9 =  0.004
NEC for r=0.9 class 1.0 = 0.859 +- 0.059 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.996 +- 0.059 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.859 +- 0.051 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7991516245487365
len(reference) = 277
Effective ratio: 0.068 +- 0.050
Model Accuracy over intervened graphs for r=0.95 =  0.011
NEC for r=0.95 class 1.0 = 0.854 +- 0.090 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.991 +- 0.090 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.854 +- 0.080 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.775
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10677738095238096
len(reference) = 2520
Effective ratio: 0.225 +- 0.066
Model Accuracy over intervened graphs for r=0.5 =  0.011
NEC for r=0.5 class 1.0 = 0.692 +- 0.368 (in-sample avg dev_std = 0.088)
NEC for r=0.5 all KL = 0.764 +- 0.368 (in-sample avg dev_std = 0.088)
NEC for r=0.5 all L1 = 0.692 +- 0.300 (in-sample avg dev_std = 0.088)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9031869047619048
len(reference) = 2520
Effective ratio: 0.015 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.698 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.768 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.698 +- 0.299 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9540456349206348
len(reference) = 2520
Effective ratio: 0.014 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.698 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.768 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.698 +- 0.299 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.775
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9678015873015874
len(reference) = 2520
Effective ratio: 0.013 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.698 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.768 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.698 +- 0.298 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.845
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2860761750405187
len(reference) = 2468
Effective ratio: 0.316 +- 0.177
Model Accuracy over intervened graphs for r=0.5 =  0.084
NEC for r=0.5 class 1.0 = 0.703 +- 0.335 (in-sample avg dev_std = 0.336)
NEC for r=0.5 all KL = 0.818 +- 0.335 (in-sample avg dev_std = 0.336)
NEC for r=0.5 all L1 = 0.703 +- 0.277 (in-sample avg dev_std = 0.336)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.845
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8476004862236628
len(reference) = 2468
Effective ratio: 0.088 +- 0.121
Model Accuracy over intervened graphs for r=0.8 =  0.025
NEC for r=0.8 class 1.0 = 0.731 +- 0.336 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.833 +- 0.336 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.731 +- 0.279 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.819965964343598
len(reference) = 2468
Effective ratio: 0.063 +- 0.074
Model Accuracy over intervened graphs for r=0.9 =  0.044
NEC for r=0.9 class 1.0 = 0.721 +- 0.345 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.823 +- 0.345 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.721 +- 0.288 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.845
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7702868719611021
len(reference) = 2468
Effective ratio: 0.052 +- 0.056
Model Accuracy over intervened graphs for r=0.95 =  0.066
NEC for r=0.95 class 1.0 = 0.707 +- 0.355 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.808 +- 0.355 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.707 +- 0.300 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 21:57:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 09:57:10 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 09:57:10 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 09:57:10 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 09:57:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:57:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:57:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:57:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 09:57:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 09:57:10 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 09:57:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.757
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.738
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.693
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.670
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.103
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.870
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.801
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.738
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.310
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.722
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.674
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.633


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.7566606498194945
len(reference) = 277
Effective ratio: 0.159 +- 0.127
Model Accuracy over intervened graphs for r=0.5 =  0.405
SUFF_SIMPLE for r=0.5 class 1.0 = 0.426 +- 0.364 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.5 all KL = 0.188 +- 0.364 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.5 all L1 = 0.426 +- 0.330 (in-sample avg dev_std = 0.551)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7381480144404332
len(reference) = 277
Effective ratio: 0.059 +- 0.047
Model Accuracy over intervened graphs for r=0.8 =  0.403
SUFF_SIMPLE for r=0.8 class 1.0 = 0.428 +- 0.380 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.8 all KL = 0.202 +- 0.380 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.8 all L1 = 0.428 +- 0.332 (in-sample avg dev_std = 0.558)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6927833935018051
len(reference) = 277
Effective ratio: 0.054 +- 0.041
Model Accuracy over intervened graphs for r=0.9 =  0.389
SUFF_SIMPLE for r=0.9 class 1.0 = 0.407 +- 0.336 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.9 all KL = 0.158 +- 0.336 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.9 all L1 = 0.407 +- 0.312 (in-sample avg dev_std = 0.582)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6701805054151624
len(reference) = 277
Effective ratio: 0.050 +- 0.033
Model Accuracy over intervened graphs for r=0.95 =  0.43
SUFF_SIMPLE for r=0.95 class 1.0 = 0.429 +- 0.335 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.95 all KL = 0.162 +- 0.335 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.95 all L1 = 0.429 +- 0.310 (in-sample avg dev_std = 0.608)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.497
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10276190476190478
len(reference) = 2520
Effective ratio: 0.259 +- 0.117
Model Accuracy over intervened graphs for r=0.5 =  0.043
SUFF_SIMPLE for r=0.5 class 1.0 = 0.517 +- 0.439 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.5 all KL = 0.47 +- 0.439 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.5 all L1 = 0.517 +- 0.375 (in-sample avg dev_std = 0.279)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8695309523809523
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.054
SUFF_SIMPLE for r=0.8 class 1.0 = 0.506 +- 0.434 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.8 all KL = 0.452 +- 0.434 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.8 all L1 = 0.506 +- 0.369 (in-sample avg dev_std = 0.315)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.497
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8009753968253969
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.055
SUFF_SIMPLE for r=0.9 class 1.0 = 0.504 +- 0.435 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.9 all KL = 0.451 +- 0.435 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.9 all L1 = 0.504 +- 0.369 (in-sample avg dev_std = 0.318)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.497
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7382642857142857
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.051
SUFF_SIMPLE for r=0.95 class 1.0 = 0.505 +- 0.436 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.95 all KL = 0.453 +- 0.436 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.95 all L1 = 0.505 +- 0.371 (in-sample avg dev_std = 0.303)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.746
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.31009724473257694
len(reference) = 2461
Effective ratio: 0.372 +- 0.231
Model Accuracy over intervened graphs for r=0.5 =  0.503
SUFF_SIMPLE for r=0.5 class 1.0 = 0.48 +- 0.432 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.5 all KL = 0.388 +- 0.432 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.5 all L1 = 0.48 +- 0.352 (in-sample avg dev_std = 0.296)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.745
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7224136952998379
len(reference) = 2468
Effective ratio: 0.070 +- 0.111
Model Accuracy over intervened graphs for r=0.8 =  0.52
SUFF_SIMPLE for r=0.8 class 1.0 = 0.467 +- 0.415 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.8 all KL = 0.347 +- 0.415 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.8 all L1 = 0.467 +- 0.327 (in-sample avg dev_std = 0.394)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6738727714748785
len(reference) = 2468
Effective ratio: 0.054 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.526
SUFF_SIMPLE for r=0.9 class 1.0 = 0.474 +- 0.414 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.9 all KL = 0.345 +- 0.414 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.9 all L1 = 0.474 +- 0.324 (in-sample avg dev_std = 0.431)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.745
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6332378444084279
len(reference) = 2468
Effective ratio: 0.046 +- 0.072
Model Accuracy over intervened graphs for r=0.95 =  0.525
SUFF_SIMPLE for r=0.95 class 1.0 = 0.482 +- 0.415 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.95 all KL = 0.352 +- 0.415 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.95 all L1 = 0.482 +- 0.323 (in-sample avg dev_std = 0.451)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.7566606498194945
len(reference) = 277
Effective ratio: 0.159 +- 0.127
Model Accuracy over intervened graphs for r=0.5 =  0.122
NEC for r=0.5 class 1.0 = 0.782 +- 0.183 (in-sample avg dev_std = 0.287)
NEC for r=0.5 all KL = 0.954 +- 0.183 (in-sample avg dev_std = 0.287)
NEC for r=0.5 all L1 = 0.782 +- 0.205 (in-sample avg dev_std = 0.287)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7381480144404332
len(reference) = 277
Effective ratio: 0.059 +- 0.047
Model Accuracy over intervened graphs for r=0.8 =  0.007
NEC for r=0.8 class 1.0 = 0.855 +- 0.085 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.993 +- 0.085 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.855 +- 0.074 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6927833935018051
len(reference) = 277
Effective ratio: 0.054 +- 0.041
Model Accuracy over intervened graphs for r=0.9 =  0.032
NEC for r=0.9 class 1.0 = 0.835 +- 0.177 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.968 +- 0.177 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.835 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6701805054151624
len(reference) = 277
Effective ratio: 0.050 +- 0.033
Model Accuracy over intervened graphs for r=0.95 =  0.072
NEC for r=0.95 class 1.0 = 0.803 +- 0.245 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.933 +- 0.245 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.803 +- 0.216 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.497
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10276190476190478
len(reference) = 2520
Effective ratio: 0.259 +- 0.117
Model Accuracy over intervened graphs for r=0.5 =  0.202
NEC for r=0.5 class 1.0 = 0.457 +- 0.421 (in-sample avg dev_std = 0.355)
NEC for r=0.5 all KL = 0.517 +- 0.421 (in-sample avg dev_std = 0.355)
NEC for r=0.5 all L1 = 0.457 +- 0.355 (in-sample avg dev_std = 0.355)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8695309523809523
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.468 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.497 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.468 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.497
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8009753968253969
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.468 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.497 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.468 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.497
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7382642857142857
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.468 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.497 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.468 +- 0.390 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.745
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.31009724473257694
len(reference) = 2468
Effective ratio: 0.372 +- 0.231
Model Accuracy over intervened graphs for r=0.5 =  0.258
NEC for r=0.5 class 1.0 = 0.616 +- 0.329 (in-sample avg dev_std = 0.465)
NEC for r=0.5 all KL = 0.753 +- 0.329 (in-sample avg dev_std = 0.465)
NEC for r=0.5 all L1 = 0.616 +- 0.281 (in-sample avg dev_std = 0.465)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.745
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7224136952998379
len(reference) = 2468
Effective ratio: 0.070 +- 0.111
Model Accuracy over intervened graphs for r=0.8 =  0.092
NEC for r=0.8 class 1.0 = 0.614 +- 0.414 (in-sample avg dev_std = 0.035)
NEC for r=0.8 all KL = 0.696 +- 0.414 (in-sample avg dev_std = 0.035)
NEC for r=0.8 all L1 = 0.614 +- 0.352 (in-sample avg dev_std = 0.035)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6738727714748785
len(reference) = 2468
Effective ratio: 0.054 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.099
NEC for r=0.9 class 1.0 = 0.592 +- 0.430 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.664 +- 0.430 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.592 +- 0.367 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.745
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6332378444084279
len(reference) = 2468
Effective ratio: 0.046 +- 0.072
Model Accuracy over intervened graphs for r=0.95 =  0.115
NEC for r=0.95 class 1.0 = 0.578 +- 0.438 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.645 +- 0.438 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.578 +- 0.374 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 22:02:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 10:02:21 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 10:02:21 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 10:02:21 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 10:02:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:02:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:02:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:02:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:02:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:02:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 10:02:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.533
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.951
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.896
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.806
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.105
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.943
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.946
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.924
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.230
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.847
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.836
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.782


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.532841155234657
len(reference) = 277
Effective ratio: 0.237 +- 0.120
Model Accuracy over intervened graphs for r=0.5 =  0.376
SUFF_SIMPLE for r=0.5 class 1.0 = 0.374 +- 0.235 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.5 all KL = 0.101 +- 0.235 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.5 all L1 = 0.374 +- 0.274 (in-sample avg dev_std = 0.582)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9512635379061372
len(reference) = 277
Effective ratio: 0.087 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.359
SUFF_SIMPLE for r=0.8 class 1.0 = 0.361 +- 0.223 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.8 all KL = 0.095 +- 0.223 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.8 all L1 = 0.361 +- 0.271 (in-sample avg dev_std = 0.577)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.895779783393502
len(reference) = 277
Effective ratio: 0.077 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.356
SUFF_SIMPLE for r=0.9 class 1.0 = 0.365 +- 0.244 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.9 all KL = 0.102 +- 0.244 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.9 all L1 = 0.365 +- 0.276 (in-sample avg dev_std = 0.566)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8060361010830325
len(reference) = 277
Effective ratio: 0.068 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.342
SUFF_SIMPLE for r=0.95 class 1.0 = 0.352 +- 0.234 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.95 all KL = 0.098 +- 0.234 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.95 all L1 = 0.352 +- 0.273 (in-sample avg dev_std = 0.564)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.362
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10485793650793651
len(reference) = 2520
Effective ratio: 0.333 +- 0.178
Model Accuracy over intervened graphs for r=0.5 =  0.001
SUFF_SIMPLE for r=0.5 class 1.0 = 0.648 +- 0.433 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.5 all KL = 0.634 +- 0.433 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.5 all L1 = 0.648 +- 0.385 (in-sample avg dev_std = 0.039)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9433142857142858
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.648 +- 0.433 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all KL = 0.635 +- 0.433 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all L1 = 0.648 +- 0.385 (in-sample avg dev_std = 0.031)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.362
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9455095238095239
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
SUFF_SIMPLE for r=0.9 class 1.0 = 0.649 +- 0.433 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.9 all KL = 0.635 +- 0.433 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.9 all L1 = 0.649 +- 0.385 (in-sample avg dev_std = 0.022)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.362
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9239833333333334
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.0
SUFF_SIMPLE for r=0.95 class 1.0 = 0.648 +- 0.433 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.95 all KL = 0.634 +- 0.433 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.95 all L1 = 0.648 +- 0.385 (in-sample avg dev_std = 0.037)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.562
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.22969854132901132
len(reference) = 2464
Effective ratio: 0.481 +- 0.158
Model Accuracy over intervened graphs for r=0.5 =  0.427
SUFF_SIMPLE for r=0.5 class 1.0 = 0.396 +- 0.373 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.5 all KL = 0.282 +- 0.373 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.5 all L1 = 0.396 +- 0.318 (in-sample avg dev_std = 0.297)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8466000810372772
len(reference) = 2468
Effective ratio: 0.088 +- 0.122
Model Accuracy over intervened graphs for r=0.8 =  0.376
SUFF_SIMPLE for r=0.8 class 1.0 = 0.444 +- 0.385 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.8 all KL = 0.33 +- 0.385 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.8 all L1 = 0.444 +- 0.328 (in-sample avg dev_std = 0.330)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.562
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8357747163695299
len(reference) = 2468
Effective ratio: 0.063 +- 0.078
Model Accuracy over intervened graphs for r=0.9 =  0.376
SUFF_SIMPLE for r=0.9 class 1.0 = 0.434 +- 0.371 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.9 all KL = 0.301 +- 0.371 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.9 all L1 = 0.434 +- 0.316 (in-sample avg dev_std = 0.381)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.562
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7820020259319288
len(reference) = 2468
Effective ratio: 0.052 +- 0.060
Model Accuracy over intervened graphs for r=0.95 =  0.366
SUFF_SIMPLE for r=0.95 class 1.0 = 0.44 +- 0.374 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.95 all KL = 0.309 +- 0.374 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.95 all L1 = 0.44 +- 0.318 (in-sample avg dev_std = 0.389)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.532841155234657
len(reference) = 277
Effective ratio: 0.237 +- 0.120
Model Accuracy over intervened graphs for r=0.5 =  0.081
NEC for r=0.5 class 1.0 = 0.821 +- 0.105 (in-sample avg dev_std = 0.330)
NEC for r=0.5 all KL = 0.984 +- 0.105 (in-sample avg dev_std = 0.330)
NEC for r=0.5 all L1 = 0.821 +- 0.130 (in-sample avg dev_std = 0.330)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9512635379061372
len(reference) = 277
Effective ratio: 0.087 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.004
NEC for r=0.8 class 1.0 = 0.862 +- 0.011 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.999 +- 0.011 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.862 +- 0.021 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.895779783393502
len(reference) = 277
Effective ratio: 0.077 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.004
NEC for r=0.9 class 1.0 = 0.858 +- 0.052 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.997 +- 0.052 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.858 +- 0.050 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8060361010830325
len(reference) = 277
Effective ratio: 0.068 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.018
NEC for r=0.95 class 1.0 = 0.846 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.983 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.846 +- 0.110 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.362
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10485793650793651
len(reference) = 2520
Effective ratio: 0.333 +- 0.178
Model Accuracy over intervened graphs for r=0.5 =  0.009
NEC for r=0.5 class 1.0 = 0.352 +- 0.429 (in-sample avg dev_std = 0.101)
NEC for r=0.5 all KL = 0.369 +- 0.429 (in-sample avg dev_std = 0.101)
NEC for r=0.5 all L1 = 0.352 +- 0.382 (in-sample avg dev_std = 0.101)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9433142857142858
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.351 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.364 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.351 +- 0.385 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.362
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9455095238095239
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.351 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.364 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.351 +- 0.385 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.362
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9239833333333334
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.351 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.364 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.351 +- 0.385 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.562
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.22969854132901132
len(reference) = 2468
Effective ratio: 0.481 +- 0.158
Model Accuracy over intervened graphs for r=0.5 =  0.073
NEC for r=0.5 class 1.0 = 0.496 +- 0.426 (in-sample avg dev_std = 0.272)
NEC for r=0.5 all KL = 0.574 +- 0.426 (in-sample avg dev_std = 0.272)
NEC for r=0.5 all L1 = 0.496 +- 0.368 (in-sample avg dev_std = 0.272)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8466000810372772
len(reference) = 2468
Effective ratio: 0.088 +- 0.122
Model Accuracy over intervened graphs for r=0.8 =  0.054
NEC for r=0.8 class 1.0 = 0.489 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.546 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.489 +- 0.388 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.562
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8357747163695299
len(reference) = 2468
Effective ratio: 0.063 +- 0.078
Model Accuracy over intervened graphs for r=0.9 =  0.067
NEC for r=0.9 class 1.0 = 0.476 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.533 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.476 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.562
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7820020259319288
len(reference) = 2468
Effective ratio: 0.052 +- 0.060
Model Accuracy over intervened graphs for r=0.95 =  0.075
NEC for r=0.95 class 1.0 = 0.468 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.521 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.468 +- 0.392 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 22:07:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 10:07:53 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 10:07:53 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 10:07:53 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 10:07:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:07:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:07:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:07:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:07:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:07:53 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 10:07:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.424
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.715
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.699
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.640
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.105
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.844
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.748
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.686
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.263
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.694
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.630
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.596


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.424158844765343
len(reference) = 277
Effective ratio: 0.273 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.425
SUFF_SIMPLE for r=0.5 class 1.0 = 0.41 +- 0.299 (in-sample avg dev_std = 0.594)
SUFF_SIMPLE for r=0.5 all KL = 0.132 +- 0.299 (in-sample avg dev_std = 0.594)
SUFF_SIMPLE for r=0.5 all L1 = 0.41 +- 0.303 (in-sample avg dev_std = 0.594)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7153212996389892
len(reference) = 277
Effective ratio: 0.059 +- 0.051
Model Accuracy over intervened graphs for r=0.8 =  0.581
SUFF_SIMPLE for r=0.8 class 1.0 = 0.548 +- 0.353 (in-sample avg dev_std = 0.572)
SUFF_SIMPLE for r=0.8 all KL = 0.244 +- 0.353 (in-sample avg dev_std = 0.572)
SUFF_SIMPLE for r=0.8 all L1 = 0.548 +- 0.332 (in-sample avg dev_std = 0.572)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6993032490974729
len(reference) = 277
Effective ratio: 0.055 +- 0.045
Model Accuracy over intervened graphs for r=0.9 =  0.579
SUFF_SIMPLE for r=0.9 class 1.0 = 0.535 +- 0.350 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.9 all KL = 0.232 +- 0.350 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.9 all L1 = 0.535 +- 0.327 (in-sample avg dev_std = 0.606)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6397472924187725
len(reference) = 277
Effective ratio: 0.046 +- 0.031
Model Accuracy over intervened graphs for r=0.95 =  0.521
SUFF_SIMPLE for r=0.95 class 1.0 = 0.492 +- 0.370 (in-sample avg dev_std = 0.607)
SUFF_SIMPLE for r=0.95 all KL = 0.218 +- 0.370 (in-sample avg dev_std = 0.607)
SUFF_SIMPLE for r=0.95 all L1 = 0.492 +- 0.329 (in-sample avg dev_std = 0.607)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.637
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10522261904761906
len(reference) = 2520
Effective ratio: 0.245 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.068
SUFF_SIMPLE for r=0.5 class 1.0 = 0.413 +- 0.417 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.5 all KL = 0.347 +- 0.417 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.5 all L1 = 0.413 +- 0.346 (in-sample avg dev_std = 0.328)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8442154761904761
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.069
SUFF_SIMPLE for r=0.8 class 1.0 = 0.404 +- 0.409 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.8 all KL = 0.333 +- 0.409 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.8 all L1 = 0.404 +- 0.338 (in-sample avg dev_std = 0.358)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.747843253968254
len(reference) = 2520
Effective ratio: 0.009 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.065
SUFF_SIMPLE for r=0.9 class 1.0 = 0.405 +- 0.411 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.9 all KL = 0.335 +- 0.411 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.9 all L1 = 0.405 +- 0.341 (in-sample avg dev_std = 0.336)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.637
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6862718253968254
len(reference) = 2520
Effective ratio: 0.008 +- 0.001
Model Accuracy over intervened graphs for r=0.95 =  0.06
SUFF_SIMPLE for r=0.95 class 1.0 = 0.402 +- 0.411 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.95 all KL = 0.333 +- 0.411 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.95 all L1 = 0.402 +- 0.341 (in-sample avg dev_std = 0.322)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.796
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2632455429497569
len(reference) = 2466
Effective ratio: 0.367 +- 0.204
Model Accuracy over intervened graphs for r=0.5 =  0.527
SUFF_SIMPLE for r=0.5 class 1.0 = 0.53 +- 0.438 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.5 all KL = 0.422 +- 0.438 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.5 all L1 = 0.53 +- 0.364 (in-sample avg dev_std = 0.324)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6935741491085899
len(reference) = 2468
Effective ratio: 0.067 +- 0.113
Model Accuracy over intervened graphs for r=0.8 =  0.735
SUFF_SIMPLE for r=0.8 class 1.0 = 0.677 +- 0.390 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.8 all KL = 0.481 +- 0.390 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.8 all L1 = 0.677 +- 0.308 (in-sample avg dev_std = 0.408)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6301106158833063
len(reference) = 2468
Effective ratio: 0.054 +- 0.090
Model Accuracy over intervened graphs for r=0.9 =  0.715
SUFF_SIMPLE for r=0.9 class 1.0 = 0.669 +- 0.393 (in-sample avg dev_std = 0.412)
SUFF_SIMPLE for r=0.9 all KL = 0.48 +- 0.393 (in-sample avg dev_std = 0.412)
SUFF_SIMPLE for r=0.9 all L1 = 0.669 +- 0.312 (in-sample avg dev_std = 0.412)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.796
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.5956073743922203
len(reference) = 2468
Effective ratio: 0.046 +- 0.076
Model Accuracy over intervened graphs for r=0.95 =  0.697
SUFF_SIMPLE for r=0.95 class 1.0 = 0.649 +- 0.398 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.95 all KL = 0.464 +- 0.398 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.95 all L1 = 0.649 +- 0.319 (in-sample avg dev_std = 0.425)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.424158844765343
len(reference) = 277
Effective ratio: 0.273 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.371
NEC for r=0.5 class 1.0 = 0.618 +- 0.264 (in-sample avg dev_std = 0.528)
NEC for r=0.5 all KL = 0.896 +- 0.264 (in-sample avg dev_std = 0.528)
NEC for r=0.5 all L1 = 0.618 +- 0.293 (in-sample avg dev_std = 0.528)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7153212996389892
len(reference) = 277
Effective ratio: 0.059 +- 0.051
Model Accuracy over intervened graphs for r=0.8 =  0.022
NEC for r=0.8 class 1.0 = 0.847 +- 0.084 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.993 +- 0.084 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.847 +- 0.085 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6993032490974729
len(reference) = 277
Effective ratio: 0.055 +- 0.045
Model Accuracy over intervened graphs for r=0.9 =  0.04
NEC for r=0.9 class 1.0 = 0.829 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.97 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.829 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6397472924187725
len(reference) = 277
Effective ratio: 0.046 +- 0.031
Model Accuracy over intervened graphs for r=0.95 =  0.137
NEC for r=0.95 class 1.0 = 0.745 +- 0.319 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.878 +- 0.319 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.745 +- 0.285 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.637
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10522261904761906
len(reference) = 2520
Effective ratio: 0.245 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.282
NEC for r=0.5 class 1.0 = 0.502 +- 0.395 (in-sample avg dev_std = 0.383)
NEC for r=0.5 all KL = 0.594 +- 0.395 (in-sample avg dev_std = 0.383)
NEC for r=0.5 all L1 = 0.502 +- 0.334 (in-sample avg dev_std = 0.383)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8442154761904761
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.586 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.636 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.586 +- 0.364 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.747843253968254
len(reference) = 2520
Effective ratio: 0.009 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.586 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.636 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.586 +- 0.364 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.637
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6862718253968254
len(reference) = 2520
Effective ratio: 0.008 +- 0.001
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.586 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.636 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.586 +- 0.364 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.796
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2632455429497569
len(reference) = 2468
Effective ratio: 0.367 +- 0.204
Model Accuracy over intervened graphs for r=0.5 =  0.292
NEC for r=0.5 class 1.0 = 0.647 +- 0.322 (in-sample avg dev_std = 0.448)
NEC for r=0.5 all KL = 0.796 +- 0.322 (in-sample avg dev_std = 0.448)
NEC for r=0.5 all L1 = 0.647 +- 0.282 (in-sample avg dev_std = 0.448)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6935741491085899
len(reference) = 2468
Effective ratio: 0.067 +- 0.113
Model Accuracy over intervened graphs for r=0.8 =  0.098
NEC for r=0.8 class 1.0 = 0.681 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.779 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.681 +- 0.320 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6301106158833063
len(reference) = 2468
Effective ratio: 0.054 +- 0.090
Model Accuracy over intervened graphs for r=0.9 =  0.111
NEC for r=0.9 class 1.0 = 0.66 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.752 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.66 +- 0.337 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.796
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.5956073743922203
len(reference) = 2468
Effective ratio: 0.046 +- 0.076
Model Accuracy over intervened graphs for r=0.95 =  0.13
NEC for r=0.95 class 1.0 = 0.636 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.723 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.636 +- 0.354 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 22:13:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 10:13:30 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 10:13:30 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 10:13:30 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 10:13:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:13:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:13:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:13:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:13:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:13:30 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 10:13:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.650
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.771
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.680
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.649
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.061
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.847
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.753
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.658
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.266
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.645
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.605
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.569


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.6496931407942238
len(reference) = 277
Effective ratio: 0.189 +- 0.124
Model Accuracy over intervened graphs for r=0.5 =  0.304
SUFF_SIMPLE for r=0.5 class 1.0 = 0.322 +- 0.231 (in-sample avg dev_std = 0.594)
SUFF_SIMPLE for r=0.5 all KL = 0.072 +- 0.231 (in-sample avg dev_std = 0.594)
SUFF_SIMPLE for r=0.5 all L1 = 0.322 +- 0.256 (in-sample avg dev_std = 0.594)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.770725631768953
len(reference) = 277
Effective ratio: 0.063 +- 0.052
Model Accuracy over intervened graphs for r=0.8 =  0.285
SUFF_SIMPLE for r=0.8 class 1.0 = 0.306 +- 0.190 (in-sample avg dev_std = 0.598)
SUFF_SIMPLE for r=0.8 all KL = 0.05 +- 0.190 (in-sample avg dev_std = 0.598)
SUFF_SIMPLE for r=0.8 all L1 = 0.306 +- 0.236 (in-sample avg dev_std = 0.598)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6800794223826715
len(reference) = 277
Effective ratio: 0.057 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.272
SUFF_SIMPLE for r=0.9 class 1.0 = 0.297 +- 0.178 (in-sample avg dev_std = 0.603)
SUFF_SIMPLE for r=0.9 all KL = 0.046 +- 0.178 (in-sample avg dev_std = 0.603)
SUFF_SIMPLE for r=0.9 all L1 = 0.297 +- 0.233 (in-sample avg dev_std = 0.603)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6492238267148015
len(reference) = 277
Effective ratio: 0.053 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.27
SUFF_SIMPLE for r=0.95 class 1.0 = 0.286 +- 0.130 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.95 all KL = 0.031 +- 0.130 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.95 all L1 = 0.286 +- 0.213 (in-sample avg dev_std = 0.618)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.588
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.06138650793650794
len(reference) = 2520
Effective ratio: 0.437 +- 0.156
Model Accuracy over intervened graphs for r=0.5 =  0.003
SUFF_SIMPLE for r=0.5 class 1.0 = 0.467 +- 0.454 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.5 all KL = 0.417 +- 0.454 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.5 all L1 = 0.467 +- 0.389 (in-sample avg dev_std = 0.069)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8469876984126985
len(reference) = 2520
Effective ratio: 0.010 +- 0.004
Model Accuracy over intervened graphs for r=0.8 =  0.005
SUFF_SIMPLE for r=0.8 class 1.0 = 0.466 +- 0.452 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.8 all KL = 0.415 +- 0.452 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.8 all L1 = 0.466 +- 0.388 (in-sample avg dev_std = 0.104)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.588
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7529039682539682
len(reference) = 2520
Effective ratio: 0.009 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.005
SUFF_SIMPLE for r=0.9 class 1.0 = 0.466 +- 0.453 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.9 all KL = 0.416 +- 0.453 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.9 all L1 = 0.466 +- 0.388 (in-sample avg dev_std = 0.101)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.588
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6583392857142857
len(reference) = 2520
Effective ratio: 0.008 +- 0.004
Model Accuracy over intervened graphs for r=0.95 =  0.005
SUFF_SIMPLE for r=0.95 class 1.0 = 0.465 +- 0.452 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.95 all KL = 0.414 +- 0.452 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.95 all L1 = 0.465 +- 0.387 (in-sample avg dev_std = 0.101)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.762
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.26644854132901136
len(reference) = 2468
Effective ratio: 0.365 +- 0.169
Model Accuracy over intervened graphs for r=0.5 =  0.449
SUFF_SIMPLE for r=0.5 class 1.0 = 0.521 +- 0.437 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.5 all KL = 0.401 +- 0.437 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.5 all L1 = 0.521 +- 0.367 (in-sample avg dev_std = 0.337)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6445927876823339
len(reference) = 2468
Effective ratio: 0.074 +- 0.117
Model Accuracy over intervened graphs for r=0.8 =  0.439
SUFF_SIMPLE for r=0.8 class 1.0 = 0.522 +- 0.434 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.8 all KL = 0.399 +- 0.434 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.8 all L1 = 0.522 +- 0.362 (in-sample avg dev_std = 0.383)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6052491896272286
len(reference) = 2468
Effective ratio: 0.055 +- 0.088
Model Accuracy over intervened graphs for r=0.9 =  0.437
SUFF_SIMPLE for r=0.9 class 1.0 = 0.528 +- 0.437 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.9 all KL = 0.411 +- 0.437 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.9 all L1 = 0.528 +- 0.366 (in-sample avg dev_std = 0.379)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.762
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.5686551863857374
len(reference) = 2468
Effective ratio: 0.044 +- 0.061
Model Accuracy over intervened graphs for r=0.95 =  0.432
SUFF_SIMPLE for r=0.95 class 1.0 = 0.534 +- 0.440 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.95 all KL = 0.416 +- 0.440 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.95 all L1 = 0.534 +- 0.368 (in-sample avg dev_std = 0.379)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.6496931407942238
len(reference) = 277
Effective ratio: 0.189 +- 0.124
Model Accuracy over intervened graphs for r=0.5 =  0.061
NEC for r=0.5 class 1.0 = 0.832 +- 0.067 (in-sample avg dev_std = 0.304)
NEC for r=0.5 all KL = 0.992 +- 0.067 (in-sample avg dev_std = 0.304)
NEC for r=0.5 all L1 = 0.832 +- 0.106 (in-sample avg dev_std = 0.304)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.770725631768953
len(reference) = 277
Effective ratio: 0.063 +- 0.052
Model Accuracy over intervened graphs for r=0.8 =  0.004
NEC for r=0.8 class 1.0 = 0.859 +- 0.056 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.997 +- 0.056 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.859 +- 0.045 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6800794223826715
len(reference) = 277
Effective ratio: 0.057 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.014
NEC for r=0.9 class 1.0 = 0.851 +- 0.116 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.986 +- 0.116 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.851 +- 0.099 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6492238267148015
len(reference) = 277
Effective ratio: 0.053 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.058
NEC for r=0.95 class 1.0 = 0.818 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.951 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.818 +- 0.186 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.588
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.06138650793650794
len(reference) = 2520
Effective ratio: 0.437 +- 0.156
Model Accuracy over intervened graphs for r=0.5 =  0.064
NEC for r=0.5 class 1.0 = 0.525 +- 0.436 (in-sample avg dev_std = 0.355)
NEC for r=0.5 all KL = 0.597 +- 0.436 (in-sample avg dev_std = 0.355)
NEC for r=0.5 all L1 = 0.525 +- 0.368 (in-sample avg dev_std = 0.355)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8469876984126985
len(reference) = 2520
Effective ratio: 0.010 +- 0.004
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.533 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.583 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.533 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.588
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7529039682539682
len(reference) = 2520
Effective ratio: 0.009 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.533 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.582 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.533 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.588
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6583392857142857
len(reference) = 2520
Effective ratio: 0.008 +- 0.004
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.533 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.582 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.533 +- 0.389 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.762
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.26644854132901136
len(reference) = 2468
Effective ratio: 0.365 +- 0.169
Model Accuracy over intervened graphs for r=0.5 =  0.136
NEC for r=0.5 class 1.0 = 0.644 +- 0.349 (in-sample avg dev_std = 0.456)
NEC for r=0.5 all KL = 0.783 +- 0.349 (in-sample avg dev_std = 0.456)
NEC for r=0.5 all L1 = 0.644 +- 0.297 (in-sample avg dev_std = 0.456)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6445927876823339
len(reference) = 2468
Effective ratio: 0.074 +- 0.117
Model Accuracy over intervened graphs for r=0.8 =  0.051
NEC for r=0.8 class 1.0 = 0.652 +- 0.399 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.751 +- 0.399 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.652 +- 0.340 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6052491896272286
len(reference) = 2468
Effective ratio: 0.055 +- 0.088
Model Accuracy over intervened graphs for r=0.9 =  0.066
NEC for r=0.9 class 1.0 = 0.64 +- 0.413 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.73 +- 0.413 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.64 +- 0.350 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.762
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.5686551863857374
len(reference) = 2468
Effective ratio: 0.044 +- 0.061
Model Accuracy over intervened graphs for r=0.95 =  0.088
NEC for r=0.95 class 1.0 = 0.623 +- 0.421 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.712 +- 0.421 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.623 +- 0.359 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 22:18:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 10:18:36 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 10:18:36 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 10:18:36 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 10:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:18:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:18:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:18:36 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 10:18:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.665
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.818
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.706
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.639
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.094
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.929
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.881
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.824
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.288
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.774
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.696
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.621


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.6653212996389892
len(reference) = 277
Effective ratio: 0.185 +- 0.130
Model Accuracy over intervened graphs for r=0.5 =  0.388
SUFF_SIMPLE for r=0.5 class 1.0 = 0.404 +- 0.340 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.5 all KL = 0.155 +- 0.340 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.5 all L1 = 0.404 +- 0.321 (in-sample avg dev_std = 0.568)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8176606498194946
len(reference) = 277
Effective ratio: 0.066 +- 0.049
Model Accuracy over intervened graphs for r=0.8 =  0.411
SUFF_SIMPLE for r=0.8 class 1.0 = 0.421 +- 0.355 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.8 all KL = 0.176 +- 0.355 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.8 all L1 = 0.421 +- 0.331 (in-sample avg dev_std = 0.568)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7056425992779783
len(reference) = 277
Effective ratio: 0.059 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.42
SUFF_SIMPLE for r=0.9 class 1.0 = 0.428 +- 0.349 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.9 all KL = 0.167 +- 0.349 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.9 all L1 = 0.428 +- 0.327 (in-sample avg dev_std = 0.573)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.639014440433213
len(reference) = 277
Effective ratio: 0.051 +- 0.037
Model Accuracy over intervened graphs for r=0.95 =  0.412
SUFF_SIMPLE for r=0.95 class 1.0 = 0.423 +- 0.342 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.95 all KL = 0.165 +- 0.342 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.95 all L1 = 0.423 +- 0.325 (in-sample avg dev_std = 0.570)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.782
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0940670634920635
len(reference) = 2520
Effective ratio: 0.315 +- 0.134
Model Accuracy over intervened graphs for r=0.5 =  0.03
SUFF_SIMPLE for r=0.5 class 1.0 = 0.315 +- 0.380 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.5 all KL = 0.226 +- 0.380 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.5 all L1 = 0.315 +- 0.317 (in-sample avg dev_std = 0.208)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9287698412698413
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.036
SUFF_SIMPLE for r=0.8 class 1.0 = 0.314 +- 0.376 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.8 all KL = 0.222 +- 0.376 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.8 all L1 = 0.314 +- 0.312 (in-sample avg dev_std = 0.254)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.782
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8814742063492061
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.033
SUFF_SIMPLE for r=0.9 class 1.0 = 0.314 +- 0.375 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.9 all KL = 0.222 +- 0.375 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.9 all L1 = 0.314 +- 0.312 (in-sample avg dev_std = 0.250)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.782
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8236523809523809
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.035
SUFF_SIMPLE for r=0.95 class 1.0 = 0.315 +- 0.377 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.95 all KL = 0.223 +- 0.377 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.95 all L1 = 0.315 +- 0.313 (in-sample avg dev_std = 0.250)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.81
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2883565640194489
len(reference) = 2468
Effective ratio: 0.344 +- 0.192
Model Accuracy over intervened graphs for r=0.5 =  0.498
SUFF_SIMPLE for r=0.5 class 1.0 = 0.515 +- 0.438 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.5 all KL = 0.418 +- 0.438 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.5 all L1 = 0.515 +- 0.360 (in-sample avg dev_std = 0.347)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.81
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7735948136142625
len(reference) = 2468
Effective ratio: 0.072 +- 0.111
Model Accuracy over intervened graphs for r=0.8 =  0.471
SUFF_SIMPLE for r=0.8 class 1.0 = 0.511 +- 0.426 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.8 all KL = 0.404 +- 0.426 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.8 all L1 = 0.511 +- 0.351 (in-sample avg dev_std = 0.399)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6957860615883306
len(reference) = 2468
Effective ratio: 0.056 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.469
SUFF_SIMPLE for r=0.9 class 1.0 = 0.523 +- 0.430 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.9 all KL = 0.419 +- 0.430 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.9 all L1 = 0.523 +- 0.352 (in-sample avg dev_std = 0.402)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.81
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6210311993517017
len(reference) = 2468
Effective ratio: 0.047 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.467
SUFF_SIMPLE for r=0.95 class 1.0 = 0.529 +- 0.430 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.95 all KL = 0.422 +- 0.430 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.95 all L1 = 0.529 +- 0.353 (in-sample avg dev_std = 0.403)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.6653212996389892
len(reference) = 277
Effective ratio: 0.185 +- 0.130
Model Accuracy over intervened graphs for r=0.5 =  0.11
NEC for r=0.5 class 1.0 = 0.797 +- 0.146 (in-sample avg dev_std = 0.294)
NEC for r=0.5 all KL = 0.972 +- 0.146 (in-sample avg dev_std = 0.294)
NEC for r=0.5 all L1 = 0.797 +- 0.180 (in-sample avg dev_std = 0.294)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8176606498194946
len(reference) = 277
Effective ratio: 0.066 +- 0.049
Model Accuracy over intervened graphs for r=0.8 =  0.022
NEC for r=0.8 class 1.0 = 0.848 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.998 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.848 +- 0.074 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7056425992779783
len(reference) = 277
Effective ratio: 0.059 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.04
NEC for r=0.9 class 1.0 = 0.832 +- 0.133 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.98 +- 0.133 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.832 +- 0.134 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.639014440433213
len(reference) = 277
Effective ratio: 0.051 +- 0.037
Model Accuracy over intervened graphs for r=0.95 =  0.087
NEC for r=0.95 class 1.0 = 0.793 +- 0.247 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.932 +- 0.247 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.793 +- 0.223 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.782
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0940670634920635
len(reference) = 2520
Effective ratio: 0.315 +- 0.134
Model Accuracy over intervened graphs for r=0.5 =  0.279
NEC for r=0.5 class 1.0 = 0.531 +- 0.405 (in-sample avg dev_std = 0.456)
NEC for r=0.5 all KL = 0.669 +- 0.405 (in-sample avg dev_std = 0.456)
NEC for r=0.5 all L1 = 0.531 +- 0.339 (in-sample avg dev_std = 0.456)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9287698412698413
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.694 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.777 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.694 +- 0.317 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.782
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8814742063492061
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.694 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.777 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.694 +- 0.317 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.782
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8236523809523809
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.001
NEC for r=0.95 class 1.0 = 0.693 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.776 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.693 +- 0.317 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.81
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2883565640194489
len(reference) = 2468
Effective ratio: 0.344 +- 0.192
Model Accuracy over intervened graphs for r=0.5 =  0.139
NEC for r=0.5 class 1.0 = 0.659 +- 0.350 (in-sample avg dev_std = 0.383)
NEC for r=0.5 all KL = 0.773 +- 0.350 (in-sample avg dev_std = 0.383)
NEC for r=0.5 all L1 = 0.659 +- 0.297 (in-sample avg dev_std = 0.383)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.81
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7735948136142625
len(reference) = 2468
Effective ratio: 0.072 +- 0.111
Model Accuracy over intervened graphs for r=0.8 =  0.072
NEC for r=0.8 class 1.0 = 0.664 +- 0.385 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.762 +- 0.385 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.664 +- 0.329 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6957860615883306
len(reference) = 2468
Effective ratio: 0.056 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.091
NEC for r=0.9 class 1.0 = 0.646 +- 0.401 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.739 +- 0.401 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.646 +- 0.342 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.81
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6210311993517017
len(reference) = 2468
Effective ratio: 0.047 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.113
NEC for r=0.95 class 1.0 = 0.626 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.713 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.626 +- 0.356 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 22:23:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 10:23:48 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 10:23:48 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 10:23:48 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 10:23:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:23:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:23:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:23:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:23:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:23:48 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 10:23:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.536
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.942
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.877
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.799
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.151
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.923
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.936
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.933
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.236
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.833
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.820
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.731


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5360938628158844
len(reference) = 277
Effective ratio: 0.241 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.315
SUFF_SIMPLE for r=0.5 class 1.0 = 0.336 +- 0.257 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.5 all KL = 0.087 +- 0.257 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.5 all L1 = 0.336 +- 0.281 (in-sample avg dev_std = 0.554)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.941797833935018
len(reference) = 277
Effective ratio: 0.089 +- 0.066
Model Accuracy over intervened graphs for r=0.8 =  0.352
SUFF_SIMPLE for r=0.8 class 1.0 = 0.361 +- 0.204 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.8 all KL = 0.066 +- 0.204 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.8 all L1 = 0.361 +- 0.276 (in-sample avg dev_std = 0.599)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8772490974729241
len(reference) = 277
Effective ratio: 0.075 +- 0.050
Model Accuracy over intervened graphs for r=0.9 =  0.338
SUFF_SIMPLE for r=0.9 class 1.0 = 0.347 +- 0.181 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.9 all KL = 0.053 +- 0.181 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.9 all L1 = 0.347 +- 0.266 (in-sample avg dev_std = 0.601)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7993682310469314
len(reference) = 277
Effective ratio: 0.065 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.335
SUFF_SIMPLE for r=0.95 class 1.0 = 0.348 +- 0.230 (in-sample avg dev_std = 0.598)
SUFF_SIMPLE for r=0.95 all KL = 0.075 +- 0.230 (in-sample avg dev_std = 0.598)
SUFF_SIMPLE for r=0.95 all L1 = 0.348 +- 0.274 (in-sample avg dev_std = 0.598)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.508
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.15098968253968256
len(reference) = 2520
Effective ratio: 0.197 +- 0.104
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.517 +- 0.440 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.5 all KL = 0.495 +- 0.440 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.5 all L1 = 0.517 +- 0.382 (in-sample avg dev_std = 0.001)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9233301587301586
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.517 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.495 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.517 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.508
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9362694444444446
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
SUFF_SIMPLE for r=0.9 class 1.0 = 0.517 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.495 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.517 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.508
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9327579365079364
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.0
SUFF_SIMPLE for r=0.95 class 1.0 = 0.517 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.95 all KL = 0.495 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.95 all L1 = 0.517 +- 0.382 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.913
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2356600486223663
len(reference) = 2468
Effective ratio: 0.439 +- 0.136
Model Accuracy over intervened graphs for r=0.5 =  0.577
SUFF_SIMPLE for r=0.5 class 1.0 = 0.61 +- 0.481 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.5 all KL = 0.526 +- 0.481 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.5 all L1 = 0.61 +- 0.406 (in-sample avg dev_std = 0.213)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.913
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8331892220421393
len(reference) = 2468
Effective ratio: 0.071 +- 0.085
Model Accuracy over intervened graphs for r=0.8 =  0.58
SUFF_SIMPLE for r=0.8 class 1.0 = 0.615 +- 0.480 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.8 all KL = 0.529 +- 0.480 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.8 all L1 = 0.615 +- 0.402 (in-sample avg dev_std = 0.268)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8197504051863859
len(reference) = 2468
Effective ratio: 0.056 +- 0.063
Model Accuracy over intervened graphs for r=0.9 =  0.577
SUFF_SIMPLE for r=0.9 class 1.0 = 0.615 +- 0.478 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.9 all KL = 0.524 +- 0.478 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.9 all L1 = 0.615 +- 0.400 (in-sample avg dev_std = 0.295)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.913
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7309874392220422
len(reference) = 2468
Effective ratio: 0.047 +- 0.051
Model Accuracy over intervened graphs for r=0.95 =  0.572
SUFF_SIMPLE for r=0.95 class 1.0 = 0.615 +- 0.473 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.95 all KL = 0.519 +- 0.473 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.95 all L1 = 0.615 +- 0.396 (in-sample avg dev_std = 0.313)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5360938628158844
len(reference) = 277
Effective ratio: 0.241 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.146
NEC for r=0.5 class 1.0 = 0.788 +- 0.138 (in-sample avg dev_std = 0.468)
NEC for r=0.5 all KL = 0.978 +- 0.138 (in-sample avg dev_std = 0.468)
NEC for r=0.5 all L1 = 0.788 +- 0.160 (in-sample avg dev_std = 0.468)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.941797833935018
len(reference) = 277
Effective ratio: 0.089 +- 0.066
Model Accuracy over intervened graphs for r=0.8 =  0.018
NEC for r=0.8 class 1.0 = 0.852 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.993 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.852 +- 0.082 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8772490974729241
len(reference) = 277
Effective ratio: 0.075 +- 0.050
Model Accuracy over intervened graphs for r=0.9 =  0.025
NEC for r=0.9 class 1.0 = 0.845 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.983 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.845 +- 0.118 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7993682310469314
len(reference) = 277
Effective ratio: 0.065 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.043
NEC for r=0.95 class 1.0 = 0.83 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.965 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.83 +- 0.163 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.508
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.15098968253968256
len(reference) = 2520
Effective ratio: 0.197 +- 0.104
Model Accuracy over intervened graphs for r=0.5 =  0.018
NEC for r=0.5 class 1.0 = 0.473 +- 0.438 (in-sample avg dev_std = 0.046)
NEC for r=0.5 all KL = 0.496 +- 0.438 (in-sample avg dev_std = 0.046)
NEC for r=0.5 all L1 = 0.473 +- 0.379 (in-sample avg dev_std = 0.046)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9233301587301586
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.483 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.505 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.483 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.508
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9362694444444446
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.483 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.505 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.483 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.508
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9327579365079364
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.483 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.505 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.483 +- 0.382 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.913
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2356600486223663
len(reference) = 2468
Effective ratio: 0.439 +- 0.136
Model Accuracy over intervened graphs for r=0.5 =  0.377
NEC for r=0.5 class 1.0 = 0.573 +- 0.339 (in-sample avg dev_std = 0.585)
NEC for r=0.5 all KL = 0.809 +- 0.339 (in-sample avg dev_std = 0.585)
NEC for r=0.5 all L1 = 0.573 +- 0.302 (in-sample avg dev_std = 0.585)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.913
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8331892220421393
len(reference) = 2468
Effective ratio: 0.071 +- 0.085
Model Accuracy over intervened graphs for r=0.8 =  0.12
NEC for r=0.8 class 1.0 = 0.716 +- 0.328 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.856 +- 0.328 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.716 +- 0.290 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8197504051863859
len(reference) = 2468
Effective ratio: 0.056 +- 0.063
Model Accuracy over intervened graphs for r=0.9 =  0.122
NEC for r=0.9 class 1.0 = 0.714 +- 0.334 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.851 +- 0.334 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.714 +- 0.294 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.913
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7309874392220422
len(reference) = 2468
Effective ratio: 0.047 +- 0.051
Model Accuracy over intervened graphs for r=0.95 =  0.129
NEC for r=0.95 class 1.0 = 0.705 +- 0.346 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.84 +- 0.346 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.705 +- 0.302 (in-sample avg dev_std = 0.000)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.123, 0.134, 0.094, 0.103], 'all_L1': [0.38, 0.402, 0.389, 0.378]}), defaultdict(<class 'list'>, {'all_KL': [0.217, 0.199, 0.187, 0.188], 'all_L1': [0.424, 0.421, 0.414, 0.418]}), defaultdict(<class 'list'>, {'all_KL': [0.126, 0.186, 0.188, 0.17], 'all_L1': [0.391, 0.435, 0.429, 0.425]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.024, 0.026, 0.015], 'all_L1': [0.299, 0.289, 0.285, 0.282]}), defaultdict(<class 'list'>, {'all_KL': [0.188, 0.202, 0.158, 0.162], 'all_L1': [0.426, 0.428, 0.407, 0.429]}), defaultdict(<class 'list'>, {'all_KL': [0.101, 0.095, 0.102, 0.098], 'all_L1': [0.374, 0.361, 0.365, 0.352]}), defaultdict(<class 'list'>, {'all_KL': [0.132, 0.244, 0.232, 0.218], 'all_L1': [0.41, 0.548, 0.535, 0.492]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.05, 0.046, 0.031], 'all_L1': [0.322, 0.306, 0.297, 0.286]}), defaultdict(<class 'list'>, {'all_KL': [0.155, 0.176, 0.167, 0.165], 'all_L1': [0.404, 0.421, 0.428, 0.423]}), defaultdict(<class 'list'>, {'all_KL': [0.087, 0.066, 0.053, 0.075], 'all_L1': [0.336, 0.361, 0.347, 0.348]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.966, 0.993, 0.982, 0.926], 'all_L1': [0.742, 0.854, 0.845, 0.796]}), defaultdict(<class 'list'>, {'all_KL': [0.978, 0.998, 0.987, 0.96], 'all_L1': [0.751, 0.858, 0.843, 0.824]}), defaultdict(<class 'list'>, {'all_KL': [0.952, 0.958, 0.942, 0.908], 'all_L1': [0.73, 0.797, 0.757, 0.727]}), defaultdict(<class 'list'>, {'all_KL': [0.988, 1.0, 0.996, 0.991], 'all_L1': [0.8, 0.863, 0.859, 0.854]}), defaultdict(<class 'list'>, {'all_KL': [0.954, 0.993, 0.968, 0.933], 'all_L1': [0.782, 0.855, 0.835, 0.803]}), defaultdict(<class 'list'>, {'all_KL': [0.984, 0.999, 0.997, 0.983], 'all_L1': [0.821, 0.862, 0.858, 0.846]}), defaultdict(<class 'list'>, {'all_KL': [0.896, 0.993, 0.97, 0.878], 'all_L1': [0.618, 0.847, 0.829, 0.745]}), defaultdict(<class 'list'>, {'all_KL': [0.992, 0.997, 0.986, 0.951], 'all_L1': [0.832, 0.859, 0.851, 0.818]}), defaultdict(<class 'list'>, {'all_KL': [0.972, 0.998, 0.98, 0.932], 'all_L1': [0.797, 0.848, 0.832, 0.793]}), defaultdict(<class 'list'>, {'all_KL': [0.978, 0.993, 0.983, 0.965], 'all_L1': [0.788, 0.852, 0.845, 0.83]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.522, 0.513, 0.513, 0.514], 'all_L1': [0.564, 0.558, 0.558, 0.559]}), defaultdict(<class 'list'>, {'all_KL': [0.239, 0.233, 0.234, 0.232], 'all_L1': [0.31, 0.305, 0.306, 0.304]}), defaultdict(<class 'list'>, {'all_KL': [0.13, 0.139, 0.14, 0.139], 'all_L1': [0.24, 0.255, 0.255, 0.256]}), defaultdict(<class 'list'>, {'all_KL': [0.232, 0.232, 0.232, 0.232], 'all_L1': [0.302, 0.302, 0.302, 0.302]}), defaultdict(<class 'list'>, {'all_KL': [0.47, 0.452, 0.451, 0.453], 'all_L1': [0.517, 0.506, 0.504, 0.505]}), defaultdict(<class 'list'>, {'all_KL': [0.634, 0.635, 0.635, 0.634], 'all_L1': [0.648, 0.648, 0.649, 0.648]}), defaultdict(<class 'list'>, {'all_KL': [0.347, 0.333, 0.335, 0.333], 'all_L1': [0.413, 0.404, 0.405, 0.402]}), defaultdict(<class 'list'>, {'all_KL': [0.417, 0.415, 0.416, 0.414], 'all_L1': [0.467, 0.466, 0.466, 0.465]}), defaultdict(<class 'list'>, {'all_KL': [0.226, 0.222, 0.222, 0.223], 'all_L1': [0.315, 0.314, 0.314, 0.315]}), defaultdict(<class 'list'>, {'all_KL': [0.495, 0.495, 0.495, 0.495], 'all_L1': [0.517, 0.517, 0.517, 0.517]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.493, 0.459, 0.459, 0.459], 'all_L1': [0.426, 0.428, 0.428, 0.428]}), defaultdict(<class 'list'>, {'all_KL': [0.704, 0.772, 0.772, 0.771], 'all_L1': [0.603, 0.707, 0.707, 0.707]}), defaultdict(<class 'list'>, {'all_KL': [0.79, 0.872, 0.872, 0.872], 'all_L1': [0.661, 0.769, 0.769, 0.769]}), defaultdict(<class 'list'>, {'all_KL': [0.764, 0.768, 0.768, 0.768], 'all_L1': [0.692, 0.698, 0.698, 0.698]}), defaultdict(<class 'list'>, {'all_KL': [0.517, 0.497, 0.497, 0.497], 'all_L1': [0.457, 0.468, 0.468, 0.468]}), defaultdict(<class 'list'>, {'all_KL': [0.369, 0.364, 0.364, 0.364], 'all_L1': [0.352, 0.351, 0.351, 0.351]}), defaultdict(<class 'list'>, {'all_KL': [0.594, 0.636, 0.636, 0.636], 'all_L1': [0.502, 0.586, 0.586, 0.586]}), defaultdict(<class 'list'>, {'all_KL': [0.597, 0.583, 0.582, 0.582], 'all_L1': [0.525, 0.533, 0.533, 0.533]}), defaultdict(<class 'list'>, {'all_KL': [0.669, 0.777, 0.777, 0.776], 'all_L1': [0.531, 0.694, 0.694, 0.693]}), defaultdict(<class 'list'>, {'all_KL': [0.496, 0.505, 0.505, 0.505], 'all_L1': [0.473, 0.483, 0.483, 0.483]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.461, 0.408, 0.411, 0.414], 'all_L1': [0.554, 0.577, 0.577, 0.574]}), defaultdict(<class 'list'>, {'all_KL': [0.424, 0.391, 0.399, 0.416], 'all_L1': [0.513, 0.494, 0.504, 0.517]}), defaultdict(<class 'list'>, {'all_KL': [0.371, 0.399, 0.407, 0.423], 'all_L1': [0.462, 0.495, 0.501, 0.515]}), defaultdict(<class 'list'>, {'all_KL': [0.512, 0.519, 0.528, 0.52], 'all_L1': [0.58, 0.586, 0.593, 0.589]}), defaultdict(<class 'list'>, {'all_KL': [0.388, 0.347, 0.345, 0.352], 'all_L1': [0.48, 0.467, 0.474, 0.482]}), defaultdict(<class 'list'>, {'all_KL': [0.282, 0.33, 0.301, 0.309], 'all_L1': [0.396, 0.444, 0.434, 0.44]}), defaultdict(<class 'list'>, {'all_KL': [0.422, 0.481, 0.48, 0.464], 'all_L1': [0.53, 0.677, 0.669, 0.649]}), defaultdict(<class 'list'>, {'all_KL': [0.401, 0.399, 0.411, 0.416], 'all_L1': [0.521, 0.522, 0.528, 0.534]}), defaultdict(<class 'list'>, {'all_KL': [0.418, 0.404, 0.419, 0.422], 'all_L1': [0.515, 0.511, 0.523, 0.529]}), defaultdict(<class 'list'>, {'all_KL': [0.526, 0.529, 0.524, 0.519], 'all_L1': [0.61, 0.615, 0.615, 0.615]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.798, 0.766, 0.736, 0.71], 'all_L1': [0.625, 0.662, 0.64, 0.618]}), defaultdict(<class 'list'>, {'all_KL': [0.734, 0.7, 0.678, 0.649], 'all_L1': [0.623, 0.614, 0.597, 0.576]}), defaultdict(<class 'list'>, {'all_KL': [0.698, 0.664, 0.639, 0.623], 'all_L1': [0.59, 0.586, 0.564, 0.55]}), defaultdict(<class 'list'>, {'all_KL': [0.818, 0.833, 0.823, 0.808], 'all_L1': [0.703, 0.731, 0.721, 0.707]}), defaultdict(<class 'list'>, {'all_KL': [0.753, 0.696, 0.664, 0.645], 'all_L1': [0.616, 0.614, 0.592, 0.578]}), defaultdict(<class 'list'>, {'all_KL': [0.574, 0.546, 0.533, 0.521], 'all_L1': [0.496, 0.489, 0.476, 0.468]}), defaultdict(<class 'list'>, {'all_KL': [0.796, 0.779, 0.752, 0.723], 'all_L1': [0.647, 0.681, 0.66, 0.636]}), defaultdict(<class 'list'>, {'all_KL': [0.783, 0.751, 0.73, 0.712], 'all_L1': [0.644, 0.652, 0.64, 0.623]}), defaultdict(<class 'list'>, {'all_KL': [0.773, 0.762, 0.739, 0.713], 'all_L1': [0.659, 0.664, 0.646, 0.626]}), defaultdict(<class 'list'>, {'all_KL': [0.809, 0.856, 0.851, 0.84], 'all_L1': [0.573, 0.716, 0.714, 0.705]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.377 +- 0.042, 0.397 +- 0.070, 0.390 +- 0.069, 0.383 +- 0.064
suff_simple class all_KL  =  0.123 +- 0.053, 0.138 +- 0.071, 0.125 +- 0.067, 0.122 +- 0.065
suff_simple_acc_int  =  0.363 +- 0.043, 0.400 +- 0.089, 0.394 +- 0.090, 0.385 +- 0.076
nec class all_L1  =  0.766 +- 0.059, 0.849 +- 0.018, 0.835 +- 0.028, 0.804 +- 0.039
nec class all_KL  =  0.966 +- 0.027, 0.992 +- 0.012, 0.979 +- 0.015, 0.943 +- 0.033
nec_acc_int  =  0.164 +- 0.085, 0.018 +- 0.026, 0.036 +- 0.043, 0.074 +- 0.052

Eval split val
suff_simple class all_L1  =  0.429 +- 0.127, 0.428 +- 0.125, 0.428 +- 0.125, 0.427 +- 0.125
suff_simple class all_KL  =  0.371 +- 0.154, 0.367 +- 0.151, 0.367 +- 0.151, 0.367 +- 0.151
suff_simple_acc_int  =  0.023 +- 0.022, 0.028 +- 0.024, 0.027 +- 0.023, 0.026 +- 0.022
nec class all_L1  =  0.522 +- 0.100, 0.572 +- 0.133, 0.572 +- 0.133, 0.572 +- 0.133
nec class all_KL  =  0.599 +- 0.127, 0.623 +- 0.160, 0.623 +- 0.160, 0.623 +- 0.159
nec_acc_int  =  0.135 +- 0.104, 0.000 +- 0.000, 0.000 +- 0.000, 0.001 +- 0.001

Eval split test
suff_simple class all_L1  =  0.516 +- 0.058, 0.539 +- 0.069, 0.542 +- 0.067, 0.544 +- 0.060
suff_simple class all_KL  =  0.420 +- 0.067, 0.421 +- 0.064, 0.422 +- 0.068, 0.425 +- 0.062
suff_simple_acc_int  =  0.487 +- 0.042, 0.521 +- 0.108, 0.515 +- 0.101, 0.505 +- 0.096
nec class all_L1  =  0.618 +- 0.053, 0.641 +- 0.066, 0.625 +- 0.069, 0.609 +- 0.067
nec class all_KL  =  0.754 +- 0.069, 0.735 +- 0.085, 0.714 +- 0.087, 0.694 +- 0.087
nec_acc_int  =  0.199 +- 0.094, 0.078 +- 0.026, 0.091 +- 0.024, 0.109 +- 0.023


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.571 +- 0.026, 0.623 +- 0.033, 0.613 +- 0.030, 0.593 +- 0.022
Faith. Armon (L1)= 		  =  0.502 +- 0.035, 0.537 +- 0.063, 0.527 +- 0.061, 0.514 +- 0.054
Faith. GMean (L1)= 	  =  0.535 +- 0.028, 0.578 +- 0.049, 0.568 +- 0.046, 0.552 +- 0.038
Faith. Aritm (KL)= 		  =  0.544 +- 0.026, 0.565 +- 0.034, 0.552 +- 0.030, 0.533 +- 0.024
Faith. Armon (KL)= 		  =  0.214 +- 0.083, 0.235 +- 0.112, 0.216 +- 0.106, 0.210 +- 0.104
Faith. GMean (KL)= 	  =  0.334 +- 0.079, 0.353 +- 0.107, 0.335 +- 0.101, 0.322 +- 0.102

Eval split val
Faith. Aritm (L1)= 		  =  0.476 +- 0.025, 0.500 +- 0.007, 0.500 +- 0.007, 0.499 +- 0.007
Faith. Armon (L1)= 		  =  0.445 +- 0.046, 0.456 +- 0.037, 0.457 +- 0.037, 0.456 +- 0.037
Faith. GMean (L1)= 	  =  0.460 +- 0.034, 0.477 +- 0.017, 0.477 +- 0.017, 0.477 +- 0.017
Faith. Aritm (KL)= 		  =  0.485 +- 0.020, 0.495 +- 0.009, 0.495 +- 0.010, 0.495 +- 0.009
Faith. Armon (KL)= 		  =  0.416 +- 0.089, 0.414 +- 0.081, 0.415 +- 0.080, 0.414 +- 0.081
Faith. GMean (KL)= 	  =  0.447 +- 0.058, 0.450 +- 0.045, 0.450 +- 0.045, 0.450 +- 0.045

Eval split test
Faith. Aritm (L1)= 		  =  0.567 +- 0.049, 0.590 +- 0.064, 0.583 +- 0.065, 0.577 +- 0.061
Faith. Armon (L1)= 		  =  0.561 +- 0.050, 0.585 +- 0.064, 0.580 +- 0.065, 0.574 +- 0.060
Faith. GMean (L1)= 	  =  0.564 +- 0.050, 0.587 +- 0.064, 0.582 +- 0.065, 0.575 +- 0.060
Faith. Aritm (KL)= 		  =  0.587 +- 0.066, 0.578 +- 0.072, 0.568 +- 0.076, 0.560 +- 0.073
Faith. Armon (KL)= 		  =  0.539 +- 0.071, 0.534 +- 0.072, 0.530 +- 0.077, 0.527 +- 0.072
Faith. GMean (KL)= 	  =  0.562 +- 0.068, 0.556 +- 0.072, 0.549 +- 0.076, 0.543 +- 0.072
Computed for split load_split = id



Completed in  0:53:08.223226  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.1

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 22:29:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 10:29:26 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 10:29:26 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 10:29:26 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 10:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:29:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:29:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:29:26 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 10:29:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.088
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.029
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.029
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.029
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.103
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.045
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.040
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.037


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08793862815884478
len(reference) = 277
Effective ratio: 0.266 +- 0.168
Model Accuracy over intervened graphs for r=0.5 =  0.495
SUFF_SIMPLE for r=0.5 class 1.0 = 0.468 +- 0.355 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.5 all KL = 0.185 +- 0.355 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.5 all L1 = 0.468 +- 0.315 (in-sample avg dev_std = 0.591)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02931046931407942
len(reference) = 277
Effective ratio: 0.023 +- 0.029
Model Accuracy over intervened graphs for r=0.8 =  0.38
SUFF_SIMPLE for r=0.8 class 1.0 = 0.379 +- 0.257 (in-sample avg dev_std = 0.628)
SUFF_SIMPLE for r=0.8 all KL = 0.09 +- 0.257 (in-sample avg dev_std = 0.628)
SUFF_SIMPLE for r=0.8 all L1 = 0.379 +- 0.277 (in-sample avg dev_std = 0.628)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.029270758122743684
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.369
SUFF_SIMPLE for r=0.9 class 1.0 = 0.369 +- 0.221 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.9 all KL = 0.075 +- 0.221 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.9 all L1 = 0.369 +- 0.268 (in-sample avg dev_std = 0.642)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.029270758122743684
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  0.362
SUFF_SIMPLE for r=0.95 class 1.0 = 0.362 +- 0.224 (in-sample avg dev_std = 0.644)
SUFF_SIMPLE for r=0.95 all KL = 0.071 +- 0.224 (in-sample avg dev_std = 0.644)
SUFF_SIMPLE for r=0.95 all L1 = 0.362 +- 0.265 (in-sample avg dev_std = 0.644)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.458
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012482539682539684
len(reference) = 2520
Effective ratio: 0.316 +- 0.146
Model Accuracy over intervened graphs for r=0.5 =  0.036
SUFF_SIMPLE for r=0.5 class 1.0 = 0.557 +- 0.455 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.5 all KL = 0.511 +- 0.455 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.5 all L1 = 0.557 +- 0.391 (in-sample avg dev_std = 0.236)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004179761904761905
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.034
SUFF_SIMPLE for r=0.8 class 1.0 = 0.556 +- 0.453 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.8 all KL = 0.506 +- 0.453 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.8 all L1 = 0.556 +- 0.389 (in-sample avg dev_std = 0.257)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.458
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004336507936507937
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.035
SUFF_SIMPLE for r=0.9 class 1.0 = 0.556 +- 0.453 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.9 all KL = 0.507 +- 0.453 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.9 all L1 = 0.556 +- 0.388 (in-sample avg dev_std = 0.257)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.458
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004336507936507937
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.035
SUFF_SIMPLE for r=0.95 class 1.0 = 0.556 +- 0.453 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.95 all KL = 0.507 +- 0.453 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.95 all L1 = 0.556 +- 0.388 (in-sample avg dev_std = 0.257)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.778
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10253808752025932
len(reference) = 2453
Effective ratio: 0.450 +- 0.196
Model Accuracy over intervened graphs for r=0.5 =  0.478
SUFF_SIMPLE for r=0.5 class 1.0 = 0.55 +- 0.406 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.5 all KL = 0.37 +- 0.406 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.5 all L1 = 0.55 +- 0.328 (in-sample avg dev_std = 0.498)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.778
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0451114262560778
len(reference) = 2468
Effective ratio: 0.035 +- 0.072
Model Accuracy over intervened graphs for r=0.8 =  0.37
SUFF_SIMPLE for r=0.8 class 1.0 = 0.459 +- 0.331 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.8 all KL = 0.242 +- 0.331 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.8 all L1 = 0.459 +- 0.291 (in-sample avg dev_std = 0.582)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.778
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03955145867098865
len(reference) = 2468
Effective ratio: 0.028 +- 0.056
Model Accuracy over intervened graphs for r=0.9 =  0.367
SUFF_SIMPLE for r=0.9 class 1.0 = 0.461 +- 0.334 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.9 all KL = 0.246 +- 0.334 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.9 all L1 = 0.461 +- 0.293 (in-sample avg dev_std = 0.581)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.778
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03711831442463533
len(reference) = 2468
Effective ratio: 0.026 +- 0.049
Model Accuracy over intervened graphs for r=0.95 =  0.368
SUFF_SIMPLE for r=0.95 class 1.0 = 0.462 +- 0.335 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.95 all KL = 0.246 +- 0.335 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.95 all L1 = 0.462 +- 0.292 (in-sample avg dev_std = 0.587)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08793862815884478
len(reference) = 277
Effective ratio: 0.266 +- 0.168
Model Accuracy over intervened graphs for r=0.5 =  0.759
NEC for r=0.5 class 1.0 = 0.256 +- 0.465 (in-sample avg dev_std = 0.352)
NEC for r=0.5 all KL = 0.39 +- 0.465 (in-sample avg dev_std = 0.352)
NEC for r=0.5 all L1 = 0.256 +- 0.344 (in-sample avg dev_std = 0.352)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02931046931407942
len(reference) = 277
Effective ratio: 0.023 +- 0.029
Model Accuracy over intervened graphs for r=0.8 =  0.993
NEC for r=0.8 class 1.0 = 0.006 +- 0.085 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.008 +- 0.085 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.006 +- 0.069 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.029270758122743684
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 1.0 = 0.003 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.005 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.003 +- 0.046 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.029270758122743684
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  0.996
NEC for r=0.95 class 1.0 = 0.003 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.005 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.003 +- 0.046 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.458
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012482539682539684
len(reference) = 2520
Effective ratio: 0.316 +- 0.146
Model Accuracy over intervened graphs for r=0.5 =  0.204
NEC for r=0.5 class 1.0 = 0.334 +- 0.426 (in-sample avg dev_std = 0.245)
NEC for r=0.5 all KL = 0.377 +- 0.426 (in-sample avg dev_std = 0.245)
NEC for r=0.5 all L1 = 0.334 +- 0.366 (in-sample avg dev_std = 0.245)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004179761904761905
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.455
NEC for r=0.8 class 1.0 = 0.029 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.011 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.029 +- 0.085 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.458
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004336507936507937
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.455
NEC for r=0.9 class 1.0 = 0.028 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.011 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.028 +- 0.085 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.458
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004336507936507937
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.455
NEC for r=0.95 class 1.0 = 0.028 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.011 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.028 +- 0.085 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.778
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10253808752025932
len(reference) = 2468
Effective ratio: 0.450 +- 0.196
Model Accuracy over intervened graphs for r=0.5 =  0.611
NEC for r=0.5 class 1.0 = 0.285 +- 0.418 (in-sample avg dev_std = 0.364)
NEC for r=0.5 all KL = 0.398 +- 0.418 (in-sample avg dev_std = 0.364)
NEC for r=0.5 all L1 = 0.285 +- 0.322 (in-sample avg dev_std = 0.364)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.778
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0451114262560778
len(reference) = 2468
Effective ratio: 0.035 +- 0.072
Model Accuracy over intervened graphs for r=0.8 =  0.765
NEC for r=0.8 class 1.0 = 0.048 +- 0.200 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.051 +- 0.200 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.048 +- 0.169 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.778
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03955145867098865
len(reference) = 2468
Effective ratio: 0.028 +- 0.056
Model Accuracy over intervened graphs for r=0.9 =  0.768
NEC for r=0.9 class 1.0 = 0.04 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.042 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.04 +- 0.154 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.778
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03711831442463533
len(reference) = 2468
Effective ratio: 0.026 +- 0.049
Model Accuracy over intervened graphs for r=0.95 =  0.769
NEC for r=0.95 class 1.0 = 0.04 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.042 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.04 +- 0.156 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 22:34:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 10:34:24 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 10:34:24 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 10:34:24 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 10:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:34:24 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 10:34:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 76 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.082
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.024
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.024
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.023
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.101
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.044
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.038
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.037


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08242960288808664
len(reference) = 277
Effective ratio: 0.296 +- 0.169
Model Accuracy over intervened graphs for r=0.5 =  0.548
SUFF_SIMPLE for r=0.5 class 1.0 = 0.511 +- 0.343 (in-sample avg dev_std = 0.575)
SUFF_SIMPLE for r=0.5 all KL = 0.212 +- 0.343 (in-sample avg dev_std = 0.575)
SUFF_SIMPLE for r=0.5 all L1 = 0.511 +- 0.312 (in-sample avg dev_std = 0.575)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02425992779783394
len(reference) = 277
Effective ratio: 0.026 +- 0.034
Model Accuracy over intervened graphs for r=0.8 =  0.453
SUFF_SIMPLE for r=0.8 class 1.0 = 0.435 +- 0.263 (in-sample avg dev_std = 0.631)
SUFF_SIMPLE for r=0.8 all KL = 0.127 +- 0.263 (in-sample avg dev_std = 0.631)
SUFF_SIMPLE for r=0.8 all L1 = 0.435 +- 0.282 (in-sample avg dev_std = 0.631)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.024220216606498198
len(reference) = 277
Effective ratio: 0.023 +- 0.029
Model Accuracy over intervened graphs for r=0.9 =  0.455
SUFF_SIMPLE for r=0.9 class 1.0 = 0.43 +- 0.269 (in-sample avg dev_std = 0.660)
SUFF_SIMPLE for r=0.9 all KL = 0.121 +- 0.269 (in-sample avg dev_std = 0.660)
SUFF_SIMPLE for r=0.9 all L1 = 0.43 +- 0.274 (in-sample avg dev_std = 0.660)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02327436823104693
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.95 =  0.466
SUFF_SIMPLE for r=0.95 class 1.0 = 0.438 +- 0.257 (in-sample avg dev_std = 0.668)
SUFF_SIMPLE for r=0.95 all KL = 0.12 +- 0.257 (in-sample avg dev_std = 0.668)
SUFF_SIMPLE for r=0.95 all L1 = 0.438 +- 0.272 (in-sample avg dev_std = 0.668)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.788
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012992063492063492
len(reference) = 2520
Effective ratio: 0.288 +- 0.095
Model Accuracy over intervened graphs for r=0.5 =  0.065
SUFF_SIMPLE for r=0.5 class 1.0 = 0.316 +- 0.353 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.5 all KL = 0.241 +- 0.353 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.5 all L1 = 0.316 +- 0.286 (in-sample avg dev_std = 0.297)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004023015873015873
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.065
SUFF_SIMPLE for r=0.8 class 1.0 = 0.315 +- 0.349 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.8 all KL = 0.238 +- 0.349 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.8 all L1 = 0.315 +- 0.282 (in-sample avg dev_std = 0.317)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.788
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.003926587301587302
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.062
SUFF_SIMPLE for r=0.9 class 1.0 = 0.311 +- 0.346 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.9 all KL = 0.234 +- 0.346 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.9 all L1 = 0.311 +- 0.280 (in-sample avg dev_std = 0.311)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.788
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.003926587301587302
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.062
SUFF_SIMPLE for r=0.95 class 1.0 = 0.311 +- 0.346 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.95 all KL = 0.234 +- 0.346 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.95 all L1 = 0.311 +- 0.280 (in-sample avg dev_std = 0.311)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.734
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10083022690437601
len(reference) = 2450
Effective ratio: 0.369 +- 0.188
Model Accuracy over intervened graphs for r=0.5 =  0.446
SUFF_SIMPLE for r=0.5 class 1.0 = 0.536 +- 0.399 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.5 all KL = 0.397 +- 0.399 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.5 all L1 = 0.536 +- 0.318 (in-sample avg dev_std = 0.525)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.735
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.044486223662884926
len(reference) = 2468
Effective ratio: 0.036 +- 0.070
Model Accuracy over intervened graphs for r=0.8 =  0.311
SUFF_SIMPLE for r=0.8 class 1.0 = 0.43 +- 0.329 (in-sample avg dev_std = 0.593)
SUFF_SIMPLE for r=0.8 all KL = 0.257 +- 0.329 (in-sample avg dev_std = 0.593)
SUFF_SIMPLE for r=0.8 all L1 = 0.43 +- 0.262 (in-sample avg dev_std = 0.593)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03843881685575364
len(reference) = 2468
Effective ratio: 0.027 +- 0.051
Model Accuracy over intervened graphs for r=0.9 =  0.313
SUFF_SIMPLE for r=0.9 class 1.0 = 0.43 +- 0.330 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.9 all KL = 0.257 +- 0.330 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.9 all L1 = 0.43 +- 0.262 (in-sample avg dev_std = 0.599)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.735
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.037037682333873584
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.95 =  0.304
SUFF_SIMPLE for r=0.95 class 1.0 = 0.425 +- 0.320 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.95 all KL = 0.249 +- 0.320 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.95 all L1 = 0.425 +- 0.257 (in-sample avg dev_std = 0.601)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08242960288808664
len(reference) = 277
Effective ratio: 0.296 +- 0.169
Model Accuracy over intervened graphs for r=0.5 =  0.787
NEC for r=0.5 class 1.0 = 0.226 +- 0.446 (in-sample avg dev_std = 0.338)
NEC for r=0.5 all KL = 0.341 +- 0.446 (in-sample avg dev_std = 0.338)
NEC for r=0.5 all L1 = 0.226 +- 0.333 (in-sample avg dev_std = 0.338)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02425992779783394
len(reference) = 277
Effective ratio: 0.026 +- 0.034
Model Accuracy over intervened graphs for r=0.8 =  0.996
NEC for r=0.8 class 1.0 = 0.004 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.005 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.004 +- 0.052 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.024220216606498198
len(reference) = 277
Effective ratio: 0.023 +- 0.029
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 1.0 = 0.004 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.005 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.004 +- 0.052 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02327436823104693
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.95 =  0.996
NEC for r=0.95 class 1.0 = 0.004 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.005 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.004 +- 0.052 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.788
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012992063492063492
len(reference) = 2520
Effective ratio: 0.288 +- 0.095
Model Accuracy over intervened graphs for r=0.5 =  0.279
NEC for r=0.5 class 1.0 = 0.535 +- 0.403 (in-sample avg dev_std = 0.353)
NEC for r=0.5 all KL = 0.606 +- 0.403 (in-sample avg dev_std = 0.353)
NEC for r=0.5 all L1 = 0.535 +- 0.338 (in-sample avg dev_std = 0.353)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004023015873015873
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.777
NEC for r=0.8 class 1.0 = 0.041 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.016 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.041 +- 0.104 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.788
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.003926587301587302
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.777
NEC for r=0.9 class 1.0 = 0.041 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.016 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.041 +- 0.104 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.788
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.003926587301587302
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.777
NEC for r=0.95 class 1.0 = 0.041 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.016 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.041 +- 0.104 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.735
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10083022690437601
len(reference) = 2468
Effective ratio: 0.369 +- 0.188
Model Accuracy over intervened graphs for r=0.5 =  0.543
NEC for r=0.5 class 1.0 = 0.329 +- 0.414 (in-sample avg dev_std = 0.343)
NEC for r=0.5 all KL = 0.405 +- 0.414 (in-sample avg dev_std = 0.343)
NEC for r=0.5 all L1 = 0.329 +- 0.330 (in-sample avg dev_std = 0.343)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.735
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.044486223662884926
len(reference) = 2468
Effective ratio: 0.036 +- 0.070
Model Accuracy over intervened graphs for r=0.8 =  0.729
NEC for r=0.8 class 1.0 = 0.04 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.042 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.04 +- 0.149 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03843881685575364
len(reference) = 2468
Effective ratio: 0.027 +- 0.051
Model Accuracy over intervened graphs for r=0.9 =  0.73
NEC for r=0.9 class 1.0 = 0.034 +- 0.161 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.034 +- 0.161 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.034 +- 0.135 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.735
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.037037682333873584
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.95 =  0.73
NEC for r=0.95 class 1.0 = 0.034 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.033 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.034 +- 0.136 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 22:39:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 10:39:39 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 10:39:39 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 10:39:39 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 10:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:39:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:39:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:39:39 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 10:39:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.086
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.039
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.039
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.040
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.044
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.038
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.036


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08564620938628159
len(reference) = 277
Effective ratio: 0.226 +- 0.133
Model Accuracy over intervened graphs for r=0.5 =  0.509
SUFF_SIMPLE for r=0.5 class 1.0 = 0.496 +- 0.333 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.5 all KL = 0.18 +- 0.333 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.5 all L1 = 0.496 +- 0.328 (in-sample avg dev_std = 0.562)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.038844765342960295
len(reference) = 277
Effective ratio: 0.023 +- 0.026
Model Accuracy over intervened graphs for r=0.8 =  0.49
SUFF_SIMPLE for r=0.8 class 1.0 = 0.477 +- 0.360 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.8 all KL = 0.195 +- 0.360 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.8 all L1 = 0.477 +- 0.332 (in-sample avg dev_std = 0.584)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03942960288808664
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.475
SUFF_SIMPLE for r=0.9 class 1.0 = 0.457 +- 0.313 (in-sample avg dev_std = 0.610)
SUFF_SIMPLE for r=0.9 all KL = 0.149 +- 0.313 (in-sample avg dev_std = 0.610)
SUFF_SIMPLE for r=0.9 all L1 = 0.457 +- 0.312 (in-sample avg dev_std = 0.610)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03974007220216606
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.95 =  0.473
SUFF_SIMPLE for r=0.95 class 1.0 = 0.455 +- 0.296 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.95 all KL = 0.136 +- 0.296 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.95 all L1 = 0.455 +- 0.310 (in-sample avg dev_std = 0.616)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.874
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012588888888888889
len(reference) = 2520
Effective ratio: 0.204 +- 0.118
Model Accuracy over intervened graphs for r=0.5 =  0.072
SUFF_SIMPLE for r=0.5 class 1.0 = 0.27 +- 0.321 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.5 all KL = 0.148 +- 0.321 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.5 all L1 = 0.27 +- 0.267 (in-sample avg dev_std = 0.336)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.071
SUFF_SIMPLE for r=0.8 class 1.0 = 0.268 +- 0.316 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.8 all KL = 0.144 +- 0.316 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.8 all L1 = 0.268 +- 0.263 (in-sample avg dev_std = 0.345)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.071
SUFF_SIMPLE for r=0.9 class 1.0 = 0.269 +- 0.322 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.9 all KL = 0.149 +- 0.322 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.9 all L1 = 0.269 +- 0.267 (in-sample avg dev_std = 0.331)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.874
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.071
SUFF_SIMPLE for r=0.95 class 1.0 = 0.269 +- 0.322 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.95 all KL = 0.149 +- 0.322 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.95 all L1 = 0.269 +- 0.267 (in-sample avg dev_std = 0.331)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.742
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10006361426256079
len(reference) = 2448
Effective ratio: 0.433 +- 0.174
Model Accuracy over intervened graphs for r=0.5 =  0.402
SUFF_SIMPLE for r=0.5 class 1.0 = 0.51 +- 0.396 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.5 all KL = 0.393 +- 0.396 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.5 all L1 = 0.51 +- 0.325 (in-sample avg dev_std = 0.473)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.741
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.044401539708265804
len(reference) = 2468
Effective ratio: 0.035 +- 0.067
Model Accuracy over intervened graphs for r=0.8 =  0.329
SUFF_SIMPLE for r=0.8 class 1.0 = 0.436 +- 0.336 (in-sample avg dev_std = 0.575)
SUFF_SIMPLE for r=0.8 all KL = 0.289 +- 0.336 (in-sample avg dev_std = 0.575)
SUFF_SIMPLE for r=0.8 all L1 = 0.436 +- 0.277 (in-sample avg dev_std = 0.575)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03819448946515397
len(reference) = 2468
Effective ratio: 0.028 +- 0.055
Model Accuracy over intervened graphs for r=0.9 =  0.327
SUFF_SIMPLE for r=0.9 class 1.0 = 0.437 +- 0.331 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.9 all KL = 0.285 +- 0.331 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.9 all L1 = 0.437 +- 0.274 (in-sample avg dev_std = 0.582)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.741
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.036159643435980555
len(reference) = 2468
Effective ratio: 0.026 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.327
SUFF_SIMPLE for r=0.95 class 1.0 = 0.436 +- 0.330 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.95 all KL = 0.283 +- 0.330 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.95 all L1 = 0.436 +- 0.273 (in-sample avg dev_std = 0.581)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08564620938628159
len(reference) = 277
Effective ratio: 0.226 +- 0.133
Model Accuracy over intervened graphs for r=0.5 =  0.809
NEC for r=0.5 class 1.0 = 0.19 +- 0.433 (in-sample avg dev_std = 0.270)
NEC for r=0.5 all KL = 0.291 +- 0.433 (in-sample avg dev_std = 0.270)
NEC for r=0.5 all L1 = 0.19 +- 0.319 (in-sample avg dev_std = 0.270)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.038844765342960295
len(reference) = 277
Effective ratio: 0.023 +- 0.026
Model Accuracy over intervened graphs for r=0.8 =  0.986
NEC for r=0.8 class 1.0 = 0.015 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.019 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.015 +- 0.106 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03942960288808664
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.986
NEC for r=0.9 class 1.0 = 0.015 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.02 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.015 +- 0.106 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03974007220216606
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.95 =  0.986
NEC for r=0.95 class 1.0 = 0.015 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.02 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.015 +- 0.106 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.874
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012588888888888889
len(reference) = 2520
Effective ratio: 0.204 +- 0.118
Model Accuracy over intervened graphs for r=0.5 =  0.386
NEC for r=0.5 class 1.0 = 0.46 +- 0.462 (in-sample avg dev_std = 0.152)
NEC for r=0.5 all KL = 0.554 +- 0.462 (in-sample avg dev_std = 0.152)
NEC for r=0.5 all L1 = 0.46 +- 0.396 (in-sample avg dev_std = 0.152)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.864
NEC for r=0.8 class 1.0 = 0.026 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.016 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.026 +- 0.097 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.864
NEC for r=0.9 class 1.0 = 0.025 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.016 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.025 +- 0.096 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.874
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.864
NEC for r=0.95 class 1.0 = 0.025 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.016 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.025 +- 0.096 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.741
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10006361426256079
len(reference) = 2468
Effective ratio: 0.433 +- 0.174
Model Accuracy over intervened graphs for r=0.5 =  0.572
NEC for r=0.5 class 1.0 = 0.311 +- 0.389 (in-sample avg dev_std = 0.370)
NEC for r=0.5 all KL = 0.379 +- 0.389 (in-sample avg dev_std = 0.370)
NEC for r=0.5 all L1 = 0.311 +- 0.318 (in-sample avg dev_std = 0.370)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.741
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.044401539708265804
len(reference) = 2468
Effective ratio: 0.035 +- 0.067
Model Accuracy over intervened graphs for r=0.8 =  0.722
NEC for r=0.8 class 1.0 = 0.05 +- 0.190 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.048 +- 0.190 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.05 +- 0.161 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03819448946515397
len(reference) = 2468
Effective ratio: 0.028 +- 0.055
Model Accuracy over intervened graphs for r=0.9 =  0.724
NEC for r=0.9 class 1.0 = 0.042 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.041 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.042 +- 0.150 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.741
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.036159643435980555
len(reference) = 2468
Effective ratio: 0.026 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.725
NEC for r=0.95 class 1.0 = 0.041 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.04 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.041 +- 0.149 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 22:45:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 10:45:16 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 10:45:16 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 10:45:16 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 10:45:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:45:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:45:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:45:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:45:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:45:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 10:45:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.085
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.028
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.025
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.025
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.049
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.039
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.038


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08533574007220215
len(reference) = 277
Effective ratio: 0.284 +- 0.166
Model Accuracy over intervened graphs for r=0.5 =  0.228
SUFF_SIMPLE for r=0.5 class 1.0 = 0.255 +- 0.148 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.5 all KL = 0.029 +- 0.148 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.5 all L1 = 0.255 +- 0.181 (in-sample avg dev_std = 0.571)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.027989169675090252
len(reference) = 277
Effective ratio: 0.026 +- 0.042
Model Accuracy over intervened graphs for r=0.8 =  0.175
SUFF_SIMPLE for r=0.8 class 1.0 = 0.219 +- 0.039 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.8 all KL = 0.005 +- 0.039 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.8 all L1 = 0.219 +- 0.127 (in-sample avg dev_std = 0.584)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.024624548736462092
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.184
SUFF_SIMPLE for r=0.9 class 1.0 = 0.222 +- 0.027 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.9 all KL = 0.003 +- 0.027 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.9 all L1 = 0.222 +- 0.120 (in-sample avg dev_std = 0.600)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.025379061371841153
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  0.182
SUFF_SIMPLE for r=0.95 class 1.0 = 0.217 +- 0.011 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.95 all KL = 0.002 +- 0.011 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.95 all L1 = 0.217 +- 0.112 (in-sample avg dev_std = 0.602)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.775
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012614682539682542
len(reference) = 2520
Effective ratio: 0.158 +- 0.057
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.302 +- 0.368 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.5 all KL = 0.232 +- 0.368 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.5 all L1 = 0.302 +- 0.299 (in-sample avg dev_std = 0.003)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.003830555555555555
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.302 +- 0.368 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 all KL = 0.232 +- 0.368 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 all L1 = 0.302 +- 0.299 (in-sample avg dev_std = 0.013)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0036873015873015867
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.0
SUFF_SIMPLE for r=0.9 class 1.0 = 0.302 +- 0.368 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.9 all KL = 0.232 +- 0.368 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.9 all L1 = 0.302 +- 0.299 (in-sample avg dev_std = 0.020)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.775
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0036873015873015867
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.0
SUFF_SIMPLE for r=0.95 class 1.0 = 0.302 +- 0.368 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.95 all KL = 0.232 +- 0.368 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.95 all L1 = 0.302 +- 0.299 (in-sample avg dev_std = 0.009)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.845
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09989019448946516
len(reference) = 2466
Effective ratio: 0.309 +- 0.216
Model Accuracy over intervened graphs for r=0.5 =  0.272
SUFF_SIMPLE for r=0.5 class 1.0 = 0.386 +- 0.338 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.5 all KL = 0.23 +- 0.338 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.5 all L1 = 0.386 +- 0.275 (in-sample avg dev_std = 0.573)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.845
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04850283630470016
len(reference) = 2468
Effective ratio: 0.038 +- 0.072
Model Accuracy over intervened graphs for r=0.8 =  0.24
SUFF_SIMPLE for r=0.8 class 1.0 = 0.359 +- 0.311 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.8 all KL = 0.199 +- 0.311 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.8 all L1 = 0.359 +- 0.253 (in-sample avg dev_std = 0.612)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03907779578606159
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.241
SUFF_SIMPLE for r=0.9 class 1.0 = 0.359 +- 0.308 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.9 all KL = 0.197 +- 0.308 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.9 all L1 = 0.359 +- 0.252 (in-sample avg dev_std = 0.613)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.845
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03779659643435981
len(reference) = 2468
Effective ratio: 0.025 +- 0.044
Model Accuracy over intervened graphs for r=0.95 =  0.241
SUFF_SIMPLE for r=0.95 class 1.0 = 0.36 +- 0.309 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.95 all KL = 0.198 +- 0.309 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.95 all L1 = 0.36 +- 0.252 (in-sample avg dev_std = 0.613)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08533574007220215
len(reference) = 277
Effective ratio: 0.284 +- 0.166
Model Accuracy over intervened graphs for r=0.5 =  0.623
NEC for r=0.5 class 1.0 = 0.376 +- 0.467 (in-sample avg dev_std = 0.379)
NEC for r=0.5 all KL = 0.537 +- 0.467 (in-sample avg dev_std = 0.379)
NEC for r=0.5 all L1 = 0.376 +- 0.374 (in-sample avg dev_std = 0.379)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.027989169675090252
len(reference) = 277
Effective ratio: 0.026 +- 0.042
Model Accuracy over intervened graphs for r=0.8 =  0.993
NEC for r=0.8 class 1.0 = 0.012 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.025 +- 0.131 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.012 +- 0.079 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.024624548736462092
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  1.0
NEC for r=0.9 class 1.0 = 0.005 +- 0.073 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.013 +- 0.073 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.005 +- 0.028 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.025379061371841153
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  1.0
NEC for r=0.95 class 1.0 = 0.005 +- 0.073 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.013 +- 0.073 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.005 +- 0.028 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.775
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012614682539682542
len(reference) = 2520
Effective ratio: 0.158 +- 0.057
Model Accuracy over intervened graphs for r=0.5 =  0.083
NEC for r=0.5 class 1.0 = 0.636 +- 0.395 (in-sample avg dev_std = 0.037)
NEC for r=0.5 all KL = 0.711 +- 0.395 (in-sample avg dev_std = 0.037)
NEC for r=0.5 all L1 = 0.636 +- 0.330 (in-sample avg dev_std = 0.037)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.003830555555555555
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.752
NEC for r=0.8 class 1.0 = 0.045 +- 0.102 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.022 +- 0.102 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.045 +- 0.120 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0036873015873015867
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.753
NEC for r=0.9 class 1.0 = 0.043 +- 0.098 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.021 +- 0.098 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.043 +- 0.117 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.775
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0036873015873015867
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.753
NEC for r=0.95 class 1.0 = 0.043 +- 0.098 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.021 +- 0.098 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.043 +- 0.117 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.845
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09989019448946516
len(reference) = 2468
Effective ratio: 0.309 +- 0.216
Model Accuracy over intervened graphs for r=0.5 =  0.523
NEC for r=0.5 class 1.0 = 0.357 +- 0.444 (in-sample avg dev_std = 0.291)
NEC for r=0.5 all KL = 0.433 +- 0.444 (in-sample avg dev_std = 0.291)
NEC for r=0.5 all L1 = 0.357 +- 0.362 (in-sample avg dev_std = 0.291)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.845
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04850283630470016
len(reference) = 2468
Effective ratio: 0.038 +- 0.072
Model Accuracy over intervened graphs for r=0.8 =  0.806
NEC for r=0.8 class 1.0 = 0.057 +- 0.226 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.067 +- 0.226 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.057 +- 0.184 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03907779578606159
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.819
NEC for r=0.9 class 1.0 = 0.044 +- 0.195 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.051 +- 0.195 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.044 +- 0.158 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.845
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03779659643435981
len(reference) = 2468
Effective ratio: 0.025 +- 0.044
Model Accuracy over intervened graphs for r=0.95 =  0.82
NEC for r=0.95 class 1.0 = 0.043 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.049 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.043 +- 0.156 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 22:50:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 10:50:18 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 10:50:18 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 10:50:18 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 10:50:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:50:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:50:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:50:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:50:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:50:18 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 10:50:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.024
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.025
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.025
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.098
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.043
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.037
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.036


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07673646209386281
len(reference) = 277
Effective ratio: 0.187 +- 0.136
Model Accuracy over intervened graphs for r=0.5 =  0.582
SUFF_SIMPLE for r=0.5 class 1.0 = 0.557 +- 0.412 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.5 all KL = 0.295 +- 0.412 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.5 all L1 = 0.557 +- 0.337 (in-sample avg dev_std = 0.611)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.024451263537906137
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.8 =  0.583
SUFF_SIMPLE for r=0.8 class 1.0 = 0.53 +- 0.350 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.8 all KL = 0.223 +- 0.350 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.8 all L1 = 0.53 +- 0.309 (in-sample avg dev_std = 0.674)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02471480144404332
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.9 =  0.591
SUFF_SIMPLE for r=0.9 class 1.0 = 0.53 +- 0.359 (in-sample avg dev_std = 0.679)
SUFF_SIMPLE for r=0.9 all KL = 0.231 +- 0.359 (in-sample avg dev_std = 0.679)
SUFF_SIMPLE for r=0.9 all L1 = 0.53 +- 0.308 (in-sample avg dev_std = 0.679)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02471480144404332
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.95 =  0.603
SUFF_SIMPLE for r=0.95 class 1.0 = 0.538 +- 0.362 (in-sample avg dev_std = 0.700)
SUFF_SIMPLE for r=0.95 all KL = 0.233 +- 0.362 (in-sample avg dev_std = 0.700)
SUFF_SIMPLE for r=0.95 all L1 = 0.538 +- 0.303 (in-sample avg dev_std = 0.700)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.497
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012023412698412698
len(reference) = 2519
Effective ratio: 0.207 +- 0.130
Model Accuracy over intervened graphs for r=0.5 =  0.086
SUFF_SIMPLE for r=0.5 class 1.0 = 0.505 +- 0.431 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.5 all KL = 0.448 +- 0.431 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.5 all L1 = 0.505 +- 0.365 (in-sample avg dev_std = 0.360)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004024603174603175
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.081
SUFF_SIMPLE for r=0.8 class 1.0 = 0.502 +- 0.430 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.8 all KL = 0.442 +- 0.430 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.8 all L1 = 0.502 +- 0.362 (in-sample avg dev_std = 0.389)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.497
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004051587301587301
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.081
SUFF_SIMPLE for r=0.9 class 1.0 = 0.503 +- 0.431 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.9 all KL = 0.444 +- 0.431 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.9 all L1 = 0.503 +- 0.363 (in-sample avg dev_std = 0.380)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.497
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004051587301587301
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.082
SUFF_SIMPLE for r=0.95 class 1.0 = 0.501 +- 0.431 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.95 all KL = 0.443 +- 0.431 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.95 all L1 = 0.501 +- 0.363 (in-sample avg dev_std = 0.379)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.754
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09792463533225283
len(reference) = 2428
Effective ratio: 0.385 +- 0.265
Model Accuracy over intervened graphs for r=0.5 =  0.467
SUFF_SIMPLE for r=0.5 class 1.0 = 0.531 +- 0.399 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.5 all KL = 0.405 +- 0.399 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.5 all L1 = 0.531 +- 0.319 (in-sample avg dev_std = 0.487)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.745
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04330794165316046
len(reference) = 2468
Effective ratio: 0.033 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.541
SUFF_SIMPLE for r=0.8 class 1.0 = 0.496 +- 0.312 (in-sample avg dev_std = 0.652)
SUFF_SIMPLE for r=0.8 all KL = 0.286 +- 0.312 (in-sample avg dev_std = 0.652)
SUFF_SIMPLE for r=0.8 all L1 = 0.496 +- 0.252 (in-sample avg dev_std = 0.652)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.037397487844408425
len(reference) = 2468
Effective ratio: 0.026 +- 0.051
Model Accuracy over intervened graphs for r=0.9 =  0.547
SUFF_SIMPLE for r=0.9 class 1.0 = 0.491 +- 0.300 (in-sample avg dev_std = 0.666)
SUFF_SIMPLE for r=0.9 all KL = 0.273 +- 0.300 (in-sample avg dev_std = 0.666)
SUFF_SIMPLE for r=0.9 all L1 = 0.491 +- 0.243 (in-sample avg dev_std = 0.666)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.745
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03567544570502431
len(reference) = 2468
Effective ratio: 0.025 +- 0.045
Model Accuracy over intervened graphs for r=0.95 =  0.548
SUFF_SIMPLE for r=0.95 class 1.0 = 0.49 +- 0.296 (in-sample avg dev_std = 0.668)
SUFF_SIMPLE for r=0.95 all KL = 0.271 +- 0.296 (in-sample avg dev_std = 0.668)
SUFF_SIMPLE for r=0.95 all L1 = 0.49 +- 0.242 (in-sample avg dev_std = 0.668)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07673646209386281
len(reference) = 277
Effective ratio: 0.187 +- 0.136
Model Accuracy over intervened graphs for r=0.5 =  0.871
NEC for r=0.5 class 1.0 = 0.136 +- 0.382 (in-sample avg dev_std = 0.215)
NEC for r=0.5 all KL = 0.201 +- 0.382 (in-sample avg dev_std = 0.215)
NEC for r=0.5 all L1 = 0.136 +- 0.282 (in-sample avg dev_std = 0.215)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.024451263537906137
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.8 =  0.996
NEC for r=0.8 class 1.0 = 0.005 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.008 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.005 +- 0.058 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02471480144404332
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 1.0 = 0.005 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.008 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.005 +- 0.058 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02471480144404332
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.95 =  0.996
NEC for r=0.95 class 1.0 = 0.005 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.008 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.005 +- 0.058 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.497
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012023412698412698
len(reference) = 2520
Effective ratio: 0.207 +- 0.130
Model Accuracy over intervened graphs for r=0.5 =  0.408
NEC for r=0.5 class 1.0 = 0.298 +- 0.396 (in-sample avg dev_std = 0.196)
NEC for r=0.5 all KL = 0.312 +- 0.396 (in-sample avg dev_std = 0.196)
NEC for r=0.5 all L1 = 0.298 +- 0.345 (in-sample avg dev_std = 0.196)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004024603174603175
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.493
NEC for r=0.8 class 1.0 = 0.034 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.013 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.034 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.497
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004051587301587301
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.493
NEC for r=0.9 class 1.0 = 0.034 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.012 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.034 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.497
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004051587301587301
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.493
NEC for r=0.95 class 1.0 = 0.034 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.012 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.034 +- 0.091 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.745
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09792463533225283
len(reference) = 2468
Effective ratio: 0.385 +- 0.265
Model Accuracy over intervened graphs for r=0.5 =  0.68
NEC for r=0.5 class 1.0 = 0.272 +- 0.398 (in-sample avg dev_std = 0.376)
NEC for r=0.5 all KL = 0.347 +- 0.398 (in-sample avg dev_std = 0.376)
NEC for r=0.5 all L1 = 0.272 +- 0.306 (in-sample avg dev_std = 0.376)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.745
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04330794165316046
len(reference) = 2468
Effective ratio: 0.033 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.738
NEC for r=0.8 class 1.0 = 0.043 +- 0.183 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.043 +- 0.183 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.043 +- 0.157 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.037397487844408425
len(reference) = 2468
Effective ratio: 0.026 +- 0.051
Model Accuracy over intervened graphs for r=0.9 =  0.736
NEC for r=0.9 class 1.0 = 0.04 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.04 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.04 +- 0.148 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.745
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03567544570502431
len(reference) = 2468
Effective ratio: 0.025 +- 0.045
Model Accuracy over intervened graphs for r=0.95 =  0.735
NEC for r=0.95 class 1.0 = 0.038 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.038 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.038 +- 0.145 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 22:55:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 10:55:24 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 10:55:24 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 10:55:24 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 10:55:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:55:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:55:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:55:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 10:55:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 10:55:24 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 10:55:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.079
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.029
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.021
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.021
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.003
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.003
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.003
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.099
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.043
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.034
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.031


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07925270758122743
len(reference) = 277
Effective ratio: 0.262 +- 0.148
Model Accuracy over intervened graphs for r=0.5 =  0.235
SUFF_SIMPLE for r=0.5 class 1.0 = 0.262 +- 0.158 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.5 all KL = 0.036 +- 0.158 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.5 all L1 = 0.262 +- 0.185 (in-sample avg dev_std = 0.592)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02926714801444043
len(reference) = 277
Effective ratio: 0.025 +- 0.034
Model Accuracy over intervened graphs for r=0.8 =  0.226
SUFF_SIMPLE for r=0.8 class 1.0 = 0.244 +- 0.044 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.8 all KL = 0.011 +- 0.044 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.8 all L1 = 0.244 +- 0.146 (in-sample avg dev_std = 0.618)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.021375451263537903
len(reference) = 277
Effective ratio: 0.022 +- 0.024
Model Accuracy over intervened graphs for r=0.9 =  0.219
SUFF_SIMPLE for r=0.9 class 1.0 = 0.242 +- 0.045 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.9 all KL = 0.01 +- 0.045 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.9 all L1 = 0.242 +- 0.142 (in-sample avg dev_std = 0.615)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.020916967509025268
len(reference) = 277
Effective ratio: 0.020 +- 0.018
Model Accuracy over intervened graphs for r=0.95 =  0.222
SUFF_SIMPLE for r=0.95 class 1.0 = 0.239 +- 0.046 (in-sample avg dev_std = 0.634)
SUFF_SIMPLE for r=0.95 all KL = 0.008 +- 0.046 (in-sample avg dev_std = 0.634)
SUFF_SIMPLE for r=0.95 all L1 = 0.239 +- 0.133 (in-sample avg dev_std = 0.634)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.362
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012303968253968255
len(reference) = 2519
Effective ratio: 0.282 +- 0.182
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.648 +- 0.433 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.5 all KL = 0.636 +- 0.433 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.5 all L1 = 0.648 +- 0.385 (in-sample avg dev_std = 0.005)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0033551587301587304
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.648 +- 0.432 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.8 all KL = 0.635 +- 0.432 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.8 all L1 = 0.648 +- 0.385 (in-sample avg dev_std = 0.032)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.362
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0029444444444444444
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.0
SUFF_SIMPLE for r=0.9 class 1.0 = 0.648 +- 0.433 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.9 all KL = 0.635 +- 0.433 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.9 all L1 = 0.648 +- 0.385 (in-sample avg dev_std = 0.034)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.362
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0029444444444444444
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.0
SUFF_SIMPLE for r=0.95 class 1.0 = 0.648 +- 0.433 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.95 all KL = 0.635 +- 0.433 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.95 all L1 = 0.648 +- 0.385 (in-sample avg dev_std = 0.034)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.562
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0994967585089141
len(reference) = 2457
Effective ratio: 0.526 +- 0.189
Model Accuracy over intervened graphs for r=0.5 =  0.199
SUFF_SIMPLE for r=0.5 class 1.0 = 0.518 +- 0.416 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.5 all KL = 0.428 +- 0.416 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.5 all L1 = 0.518 +- 0.354 (in-sample avg dev_std = 0.327)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04309805510534846
len(reference) = 2468
Effective ratio: 0.039 +- 0.074
Model Accuracy over intervened graphs for r=0.8 =  0.13
SUFF_SIMPLE for r=0.8 class 1.0 = 0.451 +- 0.367 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.8 all KL = 0.321 +- 0.367 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.8 all L1 = 0.451 +- 0.320 (in-sample avg dev_std = 0.467)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.562
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.033601296596434356
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.129
SUFF_SIMPLE for r=0.9 class 1.0 = 0.451 +- 0.366 (in-sample avg dev_std = 0.472)
SUFF_SIMPLE for r=0.9 all KL = 0.319 +- 0.366 (in-sample avg dev_std = 0.472)
SUFF_SIMPLE for r=0.9 all L1 = 0.451 +- 0.319 (in-sample avg dev_std = 0.472)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.562
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03141247974068071
len(reference) = 2468
Effective ratio: 0.024 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.134
SUFF_SIMPLE for r=0.95 class 1.0 = 0.451 +- 0.362 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.95 all KL = 0.317 +- 0.362 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.95 all L1 = 0.451 +- 0.317 (in-sample avg dev_std = 0.486)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07925270758122743
len(reference) = 277
Effective ratio: 0.262 +- 0.148
Model Accuracy over intervened graphs for r=0.5 =  0.67
NEC for r=0.5 class 1.0 = 0.34 +- 0.470 (in-sample avg dev_std = 0.328)
NEC for r=0.5 all KL = 0.489 +- 0.470 (in-sample avg dev_std = 0.328)
NEC for r=0.5 all L1 = 0.34 +- 0.369 (in-sample avg dev_std = 0.328)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02926714801444043
len(reference) = 277
Effective ratio: 0.025 +- 0.034
Model Accuracy over intervened graphs for r=0.8 =  0.989
NEC for r=0.8 class 1.0 = 0.014 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.022 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.014 +- 0.093 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.021375451263537903
len(reference) = 277
Effective ratio: 0.022 +- 0.024
Model Accuracy over intervened graphs for r=0.9 =  0.993
NEC for r=0.9 class 1.0 = 0.009 +- 0.102 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.016 +- 0.102 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.009 +- 0.070 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.020916967509025268
len(reference) = 277
Effective ratio: 0.020 +- 0.018
Model Accuracy over intervened graphs for r=0.95 =  0.993
NEC for r=0.95 class 1.0 = 0.009 +- 0.102 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.016 +- 0.102 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.009 +- 0.070 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.362
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012303968253968255
len(reference) = 2520
Effective ratio: 0.282 +- 0.182
Model Accuracy over intervened graphs for r=0.5 =  0.129
NEC for r=0.5 class 1.0 = 0.274 +- 0.382 (in-sample avg dev_std = 0.105)
NEC for r=0.5 all KL = 0.282 +- 0.382 (in-sample avg dev_std = 0.105)
NEC for r=0.5 all L1 = 0.274 +- 0.342 (in-sample avg dev_std = 0.105)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0033551587301587304
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.358
NEC for r=0.8 class 1.0 = 0.031 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.01 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.031 +- 0.086 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.362
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0029444444444444444
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.359
NEC for r=0.9 class 1.0 = 0.03 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.01 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.03 +- 0.086 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.362
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0029444444444444444
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.359
NEC for r=0.95 class 1.0 = 0.03 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.01 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.03 +- 0.086 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.562
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0994967585089141
len(reference) = 2468
Effective ratio: 0.526 +- 0.189
Model Accuracy over intervened graphs for r=0.5 =  0.303
NEC for r=0.5 class 1.0 = 0.399 +- 0.405 (in-sample avg dev_std = 0.382)
NEC for r=0.5 all KL = 0.481 +- 0.405 (in-sample avg dev_std = 0.382)
NEC for r=0.5 all L1 = 0.399 +- 0.340 (in-sample avg dev_std = 0.382)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04309805510534846
len(reference) = 2468
Effective ratio: 0.039 +- 0.074
Model Accuracy over intervened graphs for r=0.8 =  0.534
NEC for r=0.8 class 1.0 = 0.062 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.061 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.062 +- 0.181 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.562
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.033601296596434356
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.548
NEC for r=0.9 class 1.0 = 0.046 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.044 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.562
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03141247974068071
len(reference) = 2468
Effective ratio: 0.024 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.548
NEC for r=0.95 class 1.0 = 0.045 +- 0.173 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.042 +- 0.173 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.045 +- 0.149 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 23:01:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 11:01:02 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 11:01:02 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 11:01:02 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 11:01:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:01:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:01:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:01:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:01:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:01:02 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 11:01:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.081
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.028
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.029
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.029
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.005
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.005
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.005
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.042
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.038
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.037


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08138989169675091
len(reference) = 277
Effective ratio: 0.247 +- 0.131
Model Accuracy over intervened graphs for r=0.5 =  0.599
SUFF_SIMPLE for r=0.5 class 1.0 = 0.569 +- 0.420 (in-sample avg dev_std = 0.561)
SUFF_SIMPLE for r=0.5 all KL = 0.314 +- 0.420 (in-sample avg dev_std = 0.561)
SUFF_SIMPLE for r=0.5 all L1 = 0.569 +- 0.346 (in-sample avg dev_std = 0.561)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.028498194945848376
len(reference) = 277
Effective ratio: 0.022 +- 0.026
Model Accuracy over intervened graphs for r=0.8 =  0.524
SUFF_SIMPLE for r=0.8 class 1.0 = 0.498 +- 0.383 (in-sample avg dev_std = 0.629)
SUFF_SIMPLE for r=0.8 all KL = 0.221 +- 0.383 (in-sample avg dev_std = 0.629)
SUFF_SIMPLE for r=0.8 all L1 = 0.498 +- 0.327 (in-sample avg dev_std = 0.629)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02885559566787004
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.53
SUFF_SIMPLE for r=0.9 class 1.0 = 0.502 +- 0.381 (in-sample avg dev_std = 0.643)
SUFF_SIMPLE for r=0.9 all KL = 0.218 +- 0.381 (in-sample avg dev_std = 0.643)
SUFF_SIMPLE for r=0.9 all L1 = 0.502 +- 0.324 (in-sample avg dev_std = 0.643)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02885559566787004
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.95 =  0.53
SUFF_SIMPLE for r=0.95 class 1.0 = 0.502 +- 0.381 (in-sample avg dev_std = 0.643)
SUFF_SIMPLE for r=0.95 all KL = 0.218 +- 0.381 (in-sample avg dev_std = 0.643)
SUFF_SIMPLE for r=0.95 all L1 = 0.502 +- 0.324 (in-sample avg dev_std = 0.643)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.637
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012407539682539683
len(reference) = 2520
Effective ratio: 0.193 +- 0.126
Model Accuracy over intervened graphs for r=0.5 =  0.083
SUFF_SIMPLE for r=0.5 class 1.0 = 0.412 +- 0.413 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.5 all KL = 0.342 +- 0.413 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.5 all L1 = 0.412 +- 0.342 (in-sample avg dev_std = 0.359)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004638095238095238
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.083
SUFF_SIMPLE for r=0.8 class 1.0 = 0.408 +- 0.408 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.8 all KL = 0.333 +- 0.408 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.8 all L1 = 0.408 +- 0.336 (in-sample avg dev_std = 0.387)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004582936507936508
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.083
SUFF_SIMPLE for r=0.9 class 1.0 = 0.407 +- 0.407 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.9 all KL = 0.332 +- 0.407 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.9 all L1 = 0.407 +- 0.336 (in-sample avg dev_std = 0.383)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.637
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004582936507936508
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.083
SUFF_SIMPLE for r=0.95 class 1.0 = 0.407 +- 0.407 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.95 all KL = 0.332 +- 0.407 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.95 all L1 = 0.407 +- 0.336 (in-sample avg dev_std = 0.383)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.797
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09998946515397082
len(reference) = 2459
Effective ratio: 0.351 +- 0.245
Model Accuracy over intervened graphs for r=0.5 =  0.523
SUFF_SIMPLE for r=0.5 class 1.0 = 0.557 +- 0.398 (in-sample avg dev_std = 0.490)
SUFF_SIMPLE for r=0.5 all KL = 0.38 +- 0.398 (in-sample avg dev_std = 0.490)
SUFF_SIMPLE for r=0.5 all L1 = 0.557 +- 0.325 (in-sample avg dev_std = 0.490)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04160413290113452
len(reference) = 2468
Effective ratio: 0.032 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.478
SUFF_SIMPLE for r=0.8 class 1.0 = 0.483 +- 0.319 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.8 all KL = 0.256 +- 0.319 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.8 all L1 = 0.483 +- 0.267 (in-sample avg dev_std = 0.614)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03847406807131281
len(reference) = 2468
Effective ratio: 0.027 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.475
SUFF_SIMPLE for r=0.9 class 1.0 = 0.484 +- 0.318 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.9 all KL = 0.26 +- 0.318 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.9 all L1 = 0.484 +- 0.265 (in-sample avg dev_std = 0.614)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.796
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03702188006482982
len(reference) = 2468
Effective ratio: 0.025 +- 0.047
Model Accuracy over intervened graphs for r=0.95 =  0.478
SUFF_SIMPLE for r=0.95 class 1.0 = 0.482 +- 0.313 (in-sample avg dev_std = 0.619)
SUFF_SIMPLE for r=0.95 all KL = 0.255 +- 0.313 (in-sample avg dev_std = 0.619)
SUFF_SIMPLE for r=0.95 all L1 = 0.482 +- 0.262 (in-sample avg dev_std = 0.619)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08138989169675091
len(reference) = 277
Effective ratio: 0.247 +- 0.131
Model Accuracy over intervened graphs for r=0.5 =  0.846
NEC for r=0.5 class 1.0 = 0.171 +- 0.427 (in-sample avg dev_std = 0.341)
NEC for r=0.5 all KL = 0.282 +- 0.427 (in-sample avg dev_std = 0.341)
NEC for r=0.5 all L1 = 0.171 +- 0.296 (in-sample avg dev_std = 0.341)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.028498194945848376
len(reference) = 277
Effective ratio: 0.022 +- 0.026
Model Accuracy over intervened graphs for r=0.8 =  0.989
NEC for r=0.8 class 1.0 = 0.011 +- 0.117 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.015 +- 0.117 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.011 +- 0.093 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02885559566787004
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.989
NEC for r=0.9 class 1.0 = 0.011 +- 0.117 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.015 +- 0.117 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.011 +- 0.093 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02885559566787004
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.95 =  0.989
NEC for r=0.95 class 1.0 = 0.011 +- 0.117 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.015 +- 0.117 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.011 +- 0.093 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.637
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012407539682539683
len(reference) = 2520
Effective ratio: 0.193 +- 0.126
Model Accuracy over intervened graphs for r=0.5 =  0.529
NEC for r=0.5 class 1.0 = 0.278 +- 0.379 (in-sample avg dev_std = 0.228)
NEC for r=0.5 all KL = 0.303 +- 0.379 (in-sample avg dev_std = 0.228)
NEC for r=0.5 all L1 = 0.278 +- 0.328 (in-sample avg dev_std = 0.228)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004638095238095238
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.636
NEC for r=0.8 class 1.0 = 0.028 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.012 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.028 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004582936507936508
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.636
NEC for r=0.9 class 1.0 = 0.028 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.012 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.028 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.637
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004582936507936508
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.636
NEC for r=0.95 class 1.0 = 0.028 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.012 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.028 +- 0.091 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.796
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09998946515397082
len(reference) = 2468
Effective ratio: 0.351 +- 0.245
Model Accuracy over intervened graphs for r=0.5 =  0.702
NEC for r=0.5 class 1.0 = 0.238 +- 0.390 (in-sample avg dev_std = 0.310)
NEC for r=0.5 all KL = 0.302 +- 0.390 (in-sample avg dev_std = 0.310)
NEC for r=0.5 all L1 = 0.238 +- 0.310 (in-sample avg dev_std = 0.310)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04160413290113452
len(reference) = 2468
Effective ratio: 0.032 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.783
NEC for r=0.8 class 1.0 = 0.05 +- 0.205 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.052 +- 0.205 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.05 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03847406807131281
len(reference) = 2468
Effective ratio: 0.027 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.787
NEC for r=0.9 class 1.0 = 0.047 +- 0.198 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.048 +- 0.198 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.047 +- 0.170 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.796
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03702188006482982
len(reference) = 2468
Effective ratio: 0.025 +- 0.047
Model Accuracy over intervened graphs for r=0.95 =  0.787
NEC for r=0.95 class 1.0 = 0.047 +- 0.197 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.047 +- 0.197 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.047 +- 0.169 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 23:05:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 11:05:59 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 11:05:59 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 11:05:59 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 11:05:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:05:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:05:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:05:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:05:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:05:59 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 11:05:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.086
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.035
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.032
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.032
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.005
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.005
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.005
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.047
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.040
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.039


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08607581227436822
len(reference) = 277
Effective ratio: 0.210 +- 0.140
Model Accuracy over intervened graphs for r=0.5 =  0.255
SUFF_SIMPLE for r=0.5 class 1.0 = 0.271 +- 0.121 (in-sample avg dev_std = 0.622)
SUFF_SIMPLE for r=0.5 all KL = 0.023 +- 0.121 (in-sample avg dev_std = 0.622)
SUFF_SIMPLE for r=0.5 all L1 = 0.271 +- 0.188 (in-sample avg dev_std = 0.622)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03488447653429603
len(reference) = 277
Effective ratio: 0.023 +- 0.031
Model Accuracy over intervened graphs for r=0.8 =  0.222
SUFF_SIMPLE for r=0.8 class 1.0 = 0.248 +- 0.030 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.8 all KL = 0.005 +- 0.030 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.8 all L1 = 0.248 +- 0.145 (in-sample avg dev_std = 0.649)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03218772563176896
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.199
SUFF_SIMPLE for r=0.9 class 1.0 = 0.236 +- 0.059 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.9 all KL = 0.008 +- 0.059 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.9 all L1 = 0.236 +- 0.144 (in-sample avg dev_std = 0.602)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03218772563176896
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  0.199
SUFF_SIMPLE for r=0.95 class 1.0 = 0.236 +- 0.059 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.95 all KL = 0.008 +- 0.059 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.95 all L1 = 0.236 +- 0.144 (in-sample avg dev_std = 0.602)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.588
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.01276190476190476
len(reference) = 2520
Effective ratio: 0.394 +- 0.179
Model Accuracy over intervened graphs for r=0.5 =  0.007
SUFF_SIMPLE for r=0.5 class 1.0 = 0.466 +- 0.453 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.5 all KL = 0.416 +- 0.453 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.5 all L1 = 0.466 +- 0.388 (in-sample avg dev_std = 0.099)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004647619047619047
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.006
SUFF_SIMPLE for r=0.8 class 1.0 = 0.466 +- 0.452 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.8 all KL = 0.414 +- 0.452 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.8 all L1 = 0.466 +- 0.387 (in-sample avg dev_std = 0.117)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.588
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0046718253968253964
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.005
SUFF_SIMPLE for r=0.9 class 1.0 = 0.465 +- 0.451 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.9 all KL = 0.413 +- 0.451 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.9 all L1 = 0.465 +- 0.387 (in-sample avg dev_std = 0.110)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.588
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0046718253968253964
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.005
SUFF_SIMPLE for r=0.95 class 1.0 = 0.465 +- 0.451 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.95 all KL = 0.413 +- 0.451 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.95 all L1 = 0.465 +- 0.387 (in-sample avg dev_std = 0.110)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.762
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09982658022690438
len(reference) = 2466
Effective ratio: 0.360 +- 0.196
Model Accuracy over intervened graphs for r=0.5 =  0.303
SUFF_SIMPLE for r=0.5 class 1.0 = 0.424 +- 0.361 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.5 all KL = 0.246 +- 0.361 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.5 all L1 = 0.424 +- 0.301 (in-sample avg dev_std = 0.569)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04666369529983792
len(reference) = 2468
Effective ratio: 0.036 +- 0.073
Model Accuracy over intervened graphs for r=0.8 =  0.254
SUFF_SIMPLE for r=0.8 class 1.0 = 0.388 +- 0.318 (in-sample avg dev_std = 0.628)
SUFF_SIMPLE for r=0.8 all KL = 0.198 +- 0.318 (in-sample avg dev_std = 0.628)
SUFF_SIMPLE for r=0.8 all L1 = 0.388 +- 0.267 (in-sample avg dev_std = 0.628)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03987722852512156
len(reference) = 2468
Effective ratio: 0.027 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.252
SUFF_SIMPLE for r=0.9 class 1.0 = 0.385 +- 0.312 (in-sample avg dev_std = 0.631)
SUFF_SIMPLE for r=0.9 all KL = 0.193 +- 0.312 (in-sample avg dev_std = 0.631)
SUFF_SIMPLE for r=0.9 all L1 = 0.385 +- 0.264 (in-sample avg dev_std = 0.631)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.762
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.038538492706645056
len(reference) = 2468
Effective ratio: 0.025 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.257
SUFF_SIMPLE for r=0.95 class 1.0 = 0.388 +- 0.311 (in-sample avg dev_std = 0.631)
SUFF_SIMPLE for r=0.95 all KL = 0.195 +- 0.311 (in-sample avg dev_std = 0.631)
SUFF_SIMPLE for r=0.95 all L1 = 0.388 +- 0.266 (in-sample avg dev_std = 0.631)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08607581227436822
len(reference) = 277
Effective ratio: 0.210 +- 0.140
Model Accuracy over intervened graphs for r=0.5 =  0.69
NEC for r=0.5 class 1.0 = 0.286 +- 0.463 (in-sample avg dev_std = 0.176)
NEC for r=0.5 all KL = 0.389 +- 0.463 (in-sample avg dev_std = 0.176)
NEC for r=0.5 all L1 = 0.286 +- 0.379 (in-sample avg dev_std = 0.176)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03488447653429603
len(reference) = 277
Effective ratio: 0.023 +- 0.031
Model Accuracy over intervened graphs for r=0.8 =  0.986
NEC for r=0.8 class 1.0 = 0.018 +- 0.157 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.031 +- 0.157 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.018 +- 0.106 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03218772563176896
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.989
NEC for r=0.9 class 1.0 = 0.015 +- 0.142 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.025 +- 0.142 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.015 +- 0.097 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03218772563176896
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  0.989
NEC for r=0.95 class 1.0 = 0.015 +- 0.142 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.025 +- 0.142 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.015 +- 0.097 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.588
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.01276190476190476
len(reference) = 2520
Effective ratio: 0.394 +- 0.179
Model Accuracy over intervened graphs for r=0.5 =  0.204
NEC for r=0.5 class 1.0 = 0.433 +- 0.435 (in-sample avg dev_std = 0.370)
NEC for r=0.5 all KL = 0.504 +- 0.435 (in-sample avg dev_std = 0.370)
NEC for r=0.5 all L1 = 0.433 +- 0.367 (in-sample avg dev_std = 0.370)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004647619047619047
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.582
NEC for r=0.8 class 1.0 = 0.029 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.012 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.029 +- 0.090 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.588
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0046718253968253964
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.581
NEC for r=0.9 class 1.0 = 0.029 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.012 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.029 +- 0.089 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.588
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0046718253968253964
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.581
NEC for r=0.95 class 1.0 = 0.029 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.012 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.029 +- 0.089 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.762
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09982658022690438
len(reference) = 2468
Effective ratio: 0.360 +- 0.196
Model Accuracy over intervened graphs for r=0.5 =  0.515
NEC for r=0.5 class 1.0 = 0.344 +- 0.435 (in-sample avg dev_std = 0.390)
NEC for r=0.5 all KL = 0.444 +- 0.435 (in-sample avg dev_std = 0.390)
NEC for r=0.5 all L1 = 0.344 +- 0.350 (in-sample avg dev_std = 0.390)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04666369529983792
len(reference) = 2468
Effective ratio: 0.036 +- 0.073
Model Accuracy over intervened graphs for r=0.8 =  0.739
NEC for r=0.8 class 1.0 = 0.052 +- 0.207 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.057 +- 0.207 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.052 +- 0.170 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03987722852512156
len(reference) = 2468
Effective ratio: 0.027 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.747
NEC for r=0.9 class 1.0 = 0.044 +- 0.188 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.048 +- 0.188 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.044 +- 0.156 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.762
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.038538492706645056
len(reference) = 2468
Effective ratio: 0.025 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.748
NEC for r=0.95 class 1.0 = 0.044 +- 0.188 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.048 +- 0.188 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.044 +- 0.155 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 23:10:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 11:10:49 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 11:10:49 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 11:10:49 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 11:10:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:10:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:10:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:10:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:10:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:10:49 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 11:10:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.083
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.032
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.032
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.005
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.005
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.005
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.098
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.042
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.038
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.036


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08342960288808664
len(reference) = 277
Effective ratio: 0.198 +- 0.132
Model Accuracy over intervened graphs for r=0.5 =  0.483
SUFF_SIMPLE for r=0.5 class 1.0 = 0.462 +- 0.301 (in-sample avg dev_std = 0.610)
SUFF_SIMPLE for r=0.5 all KL = 0.146 +- 0.301 (in-sample avg dev_std = 0.610)
SUFF_SIMPLE for r=0.5 all L1 = 0.462 +- 0.304 (in-sample avg dev_std = 0.610)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03289530685920578
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.8 =  0.435
SUFF_SIMPLE for r=0.8 class 1.0 = 0.427 +- 0.273 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.8 all KL = 0.114 +- 0.273 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.8 all L1 = 0.427 +- 0.296 (in-sample avg dev_std = 0.611)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.032108303249097477
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.431
SUFF_SIMPLE for r=0.9 class 1.0 = 0.415 +- 0.252 (in-sample avg dev_std = 0.635)
SUFF_SIMPLE for r=0.9 all KL = 0.099 +- 0.252 (in-sample avg dev_std = 0.635)
SUFF_SIMPLE for r=0.9 all L1 = 0.415 +- 0.286 (in-sample avg dev_std = 0.635)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.032108303249097477
len(reference) = 277
Effective ratio: 0.021 +- 0.020
Model Accuracy over intervened graphs for r=0.95 =  0.423
SUFF_SIMPLE for r=0.95 class 1.0 = 0.41 +- 0.246 (in-sample avg dev_std = 0.635)
SUFF_SIMPLE for r=0.95 all KL = 0.094 +- 0.246 (in-sample avg dev_std = 0.635)
SUFF_SIMPLE for r=0.95 all L1 = 0.41 +- 0.282 (in-sample avg dev_std = 0.635)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.782
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012563095238095238
len(reference) = 2520
Effective ratio: 0.251 +- 0.141
Model Accuracy over intervened graphs for r=0.5 =  0.054
SUFF_SIMPLE for r=0.5 class 1.0 = 0.324 +- 0.380 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.5 all KL = 0.229 +- 0.380 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.5 all L1 = 0.324 +- 0.316 (in-sample avg dev_std = 0.292)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0049531746031746034
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.052
SUFF_SIMPLE for r=0.8 class 1.0 = 0.321 +- 0.375 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.8 all KL = 0.224 +- 0.375 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.8 all L1 = 0.321 +- 0.311 (in-sample avg dev_std = 0.310)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.782
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004774206349206349
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.052
SUFF_SIMPLE for r=0.9 class 1.0 = 0.321 +- 0.375 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.9 all KL = 0.224 +- 0.375 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.9 all L1 = 0.321 +- 0.311 (in-sample avg dev_std = 0.305)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.782
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004774206349206349
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.052
SUFF_SIMPLE for r=0.95 class 1.0 = 0.321 +- 0.375 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.95 all KL = 0.224 +- 0.375 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.95 all L1 = 0.321 +- 0.311 (in-sample avg dev_std = 0.305)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.812
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.098459886547812
len(reference) = 2458
Effective ratio: 0.336 +- 0.228
Model Accuracy over intervened graphs for r=0.5 =  0.41
SUFF_SIMPLE for r=0.5 class 1.0 = 0.474 +- 0.364 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.5 all KL = 0.309 +- 0.364 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.5 all L1 = 0.474 +- 0.296 (in-sample avg dev_std = 0.564)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.81
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.041549837925445705
len(reference) = 2468
Effective ratio: 0.032 +- 0.065
Model Accuracy over intervened graphs for r=0.8 =  0.327
SUFF_SIMPLE for r=0.8 class 1.0 = 0.423 +- 0.321 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.8 all KL = 0.248 +- 0.321 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.8 all L1 = 0.423 +- 0.267 (in-sample avg dev_std = 0.612)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.038261345218800646
len(reference) = 2468
Effective ratio: 0.027 +- 0.054
Model Accuracy over intervened graphs for r=0.9 =  0.323
SUFF_SIMPLE for r=0.9 class 1.0 = 0.42 +- 0.315 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.9 all KL = 0.244 +- 0.315 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.9 all L1 = 0.42 +- 0.265 (in-sample avg dev_std = 0.611)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.81
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.036215559157212314
len(reference) = 2468
Effective ratio: 0.026 +- 0.049
Model Accuracy over intervened graphs for r=0.95 =  0.323
SUFF_SIMPLE for r=0.95 class 1.0 = 0.42 +- 0.313 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.95 all KL = 0.241 +- 0.313 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.95 all L1 = 0.42 +- 0.263 (in-sample avg dev_std = 0.616)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08342960288808664
len(reference) = 277
Effective ratio: 0.198 +- 0.132
Model Accuracy over intervened graphs for r=0.5 =  0.835
NEC for r=0.5 class 1.0 = 0.162 +- 0.404 (in-sample avg dev_std = 0.179)
NEC for r=0.5 all KL = 0.225 +- 0.404 (in-sample avg dev_std = 0.179)
NEC for r=0.5 all L1 = 0.162 +- 0.316 (in-sample avg dev_std = 0.179)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03289530685920578
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.8 =  0.996
NEC for r=0.8 class 1.0 = 0.005 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.01 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.005 +- 0.059 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.032108303249097477
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 1.0 = 0.005 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.01 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.005 +- 0.059 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.032108303249097477
len(reference) = 277
Effective ratio: 0.021 +- 0.020
Model Accuracy over intervened graphs for r=0.95 =  0.996
NEC for r=0.95 class 1.0 = 0.005 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.01 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.005 +- 0.059 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.782
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012563095238095238
len(reference) = 2520
Effective ratio: 0.251 +- 0.141
Model Accuracy over intervened graphs for r=0.5 =  0.412
NEC for r=0.5 class 1.0 = 0.384 +- 0.450 (in-sample avg dev_std = 0.257)
NEC for r=0.5 all KL = 0.453 +- 0.450 (in-sample avg dev_std = 0.257)
NEC for r=0.5 all L1 = 0.384 +- 0.383 (in-sample avg dev_std = 0.257)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0049531746031746034
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.775
NEC for r=0.8 class 1.0 = 0.028 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.013 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.028 +- 0.095 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.782
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004774206349206349
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.775
NEC for r=0.9 class 1.0 = 0.027 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.013 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.027 +- 0.094 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.782
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004774206349206349
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.775
NEC for r=0.95 class 1.0 = 0.027 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.013 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.027 +- 0.094 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.81
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.098459886547812
len(reference) = 2468
Effective ratio: 0.336 +- 0.228
Model Accuracy over intervened graphs for r=0.5 =  0.613
NEC for r=0.5 class 1.0 = 0.286 +- 0.408 (in-sample avg dev_std = 0.320)
NEC for r=0.5 all KL = 0.352 +- 0.408 (in-sample avg dev_std = 0.320)
NEC for r=0.5 all L1 = 0.286 +- 0.330 (in-sample avg dev_std = 0.320)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.81
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.041549837925445705
len(reference) = 2468
Effective ratio: 0.032 +- 0.065
Model Accuracy over intervened graphs for r=0.8 =  0.798
NEC for r=0.8 class 1.0 = 0.038 +- 0.176 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.04 +- 0.176 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.038 +- 0.147 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.038261345218800646
len(reference) = 2468
Effective ratio: 0.027 +- 0.054
Model Accuracy over intervened graphs for r=0.9 =  0.8
NEC for r=0.9 class 1.0 = 0.035 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.037 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.035 +- 0.140 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.81
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.036215559157212314
len(reference) = 2468
Effective ratio: 0.026 +- 0.049
Model Accuracy over intervened graphs for r=0.95 =  0.8
NEC for r=0.95 class 1.0 = 0.035 +- 0.165 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.036 +- 0.165 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.035 +- 0.140 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 23:16:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 11:16:12 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 11:16:12 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 11:16:12 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 11:16:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:16:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:16:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:16:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:16:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:16:12 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 11:16:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.084
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.028
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.026
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.025
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.098
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.039
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.035
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.034


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08423104693140794
len(reference) = 277
Effective ratio: 0.259 +- 0.149
Model Accuracy over intervened graphs for r=0.5 =  0.303
SUFF_SIMPLE for r=0.5 class 1.0 = 0.309 +- 0.212 (in-sample avg dev_std = 0.625)
SUFF_SIMPLE for r=0.5 all KL = 0.056 +- 0.212 (in-sample avg dev_std = 0.625)
SUFF_SIMPLE for r=0.5 all L1 = 0.309 +- 0.237 (in-sample avg dev_std = 0.625)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.028335740072202166
len(reference) = 277
Effective ratio: 0.026 +- 0.036
Model Accuracy over intervened graphs for r=0.8 =  0.271
SUFF_SIMPLE for r=0.8 class 1.0 = 0.279 +- 0.131 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.8 all KL = 0.025 +- 0.131 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.8 all L1 = 0.279 +- 0.195 (in-sample avg dev_std = 0.670)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02587003610108303
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.272
SUFF_SIMPLE for r=0.9 class 1.0 = 0.272 +- 0.053 (in-sample avg dev_std = 0.701)
SUFF_SIMPLE for r=0.9 all KL = 0.008 +- 0.053 (in-sample avg dev_std = 0.701)
SUFF_SIMPLE for r=0.9 all L1 = 0.272 +- 0.166 (in-sample avg dev_std = 0.701)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.025129963898916967
len(reference) = 277
Effective ratio: 0.021 +- 0.021
Model Accuracy over intervened graphs for r=0.95 =  0.282
SUFF_SIMPLE for r=0.95 class 1.0 = 0.275 +- 0.085 (in-sample avg dev_std = 0.708)
SUFF_SIMPLE for r=0.95 all KL = 0.011 +- 0.085 (in-sample avg dev_std = 0.708)
SUFF_SIMPLE for r=0.95 all L1 = 0.275 +- 0.170 (in-sample avg dev_std = 0.708)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.508
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.01231031746031746
len(reference) = 2520
Effective ratio: 0.164 +- 0.102
Model Accuracy over intervened graphs for r=0.5 =  0.0
SUFF_SIMPLE for r=0.5 class 1.0 = 0.517 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all KL = 0.495 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.5 all L1 = 0.517 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0035619047619047622
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.517 +- 0.440 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.8 all KL = 0.495 +- 0.440 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.8 all L1 = 0.517 +- 0.382 (in-sample avg dev_std = 0.007)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.508
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0035043650793650793
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.0
SUFF_SIMPLE for r=0.9 class 1.0 = 0.517 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.495 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.517 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.508
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0035043650793650793
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.0
SUFF_SIMPLE for r=0.95 class 1.0 = 0.517 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.95 all KL = 0.495 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.95 all L1 = 0.517 +- 0.382 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.913
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09786912479740681
len(reference) = 2456
Effective ratio: 0.443 +- 0.150
Model Accuracy over intervened graphs for r=0.5 =  0.439
SUFF_SIMPLE for r=0.5 class 1.0 = 0.485 +- 0.401 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.5 all KL = 0.281 +- 0.401 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.5 all L1 = 0.485 +- 0.337 (in-sample avg dev_std = 0.533)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.913
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03915275526742301
len(reference) = 2468
Effective ratio: 0.031 +- 0.053
Model Accuracy over intervened graphs for r=0.8 =  0.395
SUFF_SIMPLE for r=0.8 class 1.0 = 0.418 +- 0.291 (in-sample avg dev_std = 0.700)
SUFF_SIMPLE for r=0.8 all KL = 0.148 +- 0.291 (in-sample avg dev_std = 0.700)
SUFF_SIMPLE for r=0.8 all L1 = 0.418 +- 0.268 (in-sample avg dev_std = 0.700)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0349339546191248
len(reference) = 2468
Effective ratio: 0.025 +- 0.046
Model Accuracy over intervened graphs for r=0.9 =  0.391
SUFF_SIMPLE for r=0.9 class 1.0 = 0.413 +- 0.286 (in-sample avg dev_std = 0.707)
SUFF_SIMPLE for r=0.9 all KL = 0.141 +- 0.286 (in-sample avg dev_std = 0.707)
SUFF_SIMPLE for r=0.9 all L1 = 0.413 +- 0.263 (in-sample avg dev_std = 0.707)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.913
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.034293760129659644
len(reference) = 2468
Effective ratio: 0.025 +- 0.044
Model Accuracy over intervened graphs for r=0.95 =  0.396
SUFF_SIMPLE for r=0.95 class 1.0 = 0.418 +- 0.287 (in-sample avg dev_std = 0.705)
SUFF_SIMPLE for r=0.95 all KL = 0.144 +- 0.287 (in-sample avg dev_std = 0.705)
SUFF_SIMPLE for r=0.95 all L1 = 0.418 +- 0.266 (in-sample avg dev_std = 0.705)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08423104693140794
len(reference) = 277
Effective ratio: 0.259 +- 0.149
Model Accuracy over intervened graphs for r=0.5 =  0.716
NEC for r=0.5 class 1.0 = 0.288 +- 0.474 (in-sample avg dev_std = 0.341)
NEC for r=0.5 all KL = 0.45 +- 0.474 (in-sample avg dev_std = 0.341)
NEC for r=0.5 all L1 = 0.288 +- 0.358 (in-sample avg dev_std = 0.341)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.028335740072202166
len(reference) = 277
Effective ratio: 0.026 +- 0.036
Model Accuracy over intervened graphs for r=0.8 =  0.993
NEC for r=0.8 class 1.0 = 0.008 +- 0.128 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.021 +- 0.128 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.008 +- 0.070 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02587003610108303
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 1.0 = 0.005 +- 0.110 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.015 +- 0.110 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.005 +- 0.055 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.025129963898916967
len(reference) = 277
Effective ratio: 0.021 +- 0.021
Model Accuracy over intervened graphs for r=0.95 =  0.996
NEC for r=0.95 class 1.0 = 0.005 +- 0.110 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.015 +- 0.110 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.005 +- 0.055 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.508
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.01231031746031746
len(reference) = 2520
Effective ratio: 0.164 +- 0.102
Model Accuracy over intervened graphs for r=0.5 =  0.139
NEC for r=0.5 class 1.0 = 0.383 +- 0.416 (in-sample avg dev_std = 0.017)
NEC for r=0.5 all KL = 0.396 +- 0.416 (in-sample avg dev_std = 0.017)
NEC for r=0.5 all L1 = 0.383 +- 0.366 (in-sample avg dev_std = 0.017)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0035619047619047622
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.482
NEC for r=0.8 class 1.0 = 0.044 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.019 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.044 +- 0.113 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.508
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0035043650793650793
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.482
NEC for r=0.9 class 1.0 = 0.043 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.018 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.043 +- 0.112 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.508
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0035043650793650793
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.482
NEC for r=0.95 class 1.0 = 0.043 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.018 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.043 +- 0.112 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.913
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09786912479740681
len(reference) = 2468
Effective ratio: 0.443 +- 0.150
Model Accuracy over intervened graphs for r=0.5 =  0.645
NEC for r=0.5 class 1.0 = 0.317 +- 0.443 (in-sample avg dev_std = 0.462)
NEC for r=0.5 all KL = 0.498 +- 0.443 (in-sample avg dev_std = 0.462)
NEC for r=0.5 all L1 = 0.317 +- 0.334 (in-sample avg dev_std = 0.462)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.913
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03915275526742301
len(reference) = 2468
Effective ratio: 0.031 +- 0.053
Model Accuracy over intervened graphs for r=0.8 =  0.904
NEC for r=0.8 class 1.0 = 0.037 +- 0.176 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.043 +- 0.176 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.037 +- 0.148 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0349339546191248
len(reference) = 2468
Effective ratio: 0.025 +- 0.046
Model Accuracy over intervened graphs for r=0.9 =  0.907
NEC for r=0.9 class 1.0 = 0.032 +- 0.162 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.036 +- 0.162 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.032 +- 0.138 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.913
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.034293760129659644
len(reference) = 2468
Effective ratio: 0.025 +- 0.044
Model Accuracy over intervened graphs for r=0.95 =  0.908
NEC for r=0.95 class 1.0 = 0.031 +- 0.159 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.035 +- 0.159 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.031 +- 0.136 (in-sample avg dev_std = 0.000)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.185, 0.09, 0.075, 0.071], 'all_L1': [0.468, 0.379, 0.369, 0.362]}), defaultdict(<class 'list'>, {'all_KL': [0.212, 0.127, 0.121, 0.12], 'all_L1': [0.511, 0.435, 0.43, 0.438]}), defaultdict(<class 'list'>, {'all_KL': [0.18, 0.195, 0.149, 0.136], 'all_L1': [0.496, 0.477, 0.457, 0.455]}), defaultdict(<class 'list'>, {'all_KL': [0.029, 0.005, 0.003, 0.002], 'all_L1': [0.255, 0.219, 0.222, 0.217]}), defaultdict(<class 'list'>, {'all_KL': [0.295, 0.223, 0.231, 0.233], 'all_L1': [0.557, 0.53, 0.53, 0.538]}), defaultdict(<class 'list'>, {'all_KL': [0.036, 0.011, 0.01, 0.008], 'all_L1': [0.262, 0.244, 0.242, 0.239]}), defaultdict(<class 'list'>, {'all_KL': [0.314, 0.221, 0.218, 0.218], 'all_L1': [0.569, 0.498, 0.502, 0.502]}), defaultdict(<class 'list'>, {'all_KL': [0.023, 0.005, 0.008, 0.008], 'all_L1': [0.271, 0.248, 0.236, 0.236]}), defaultdict(<class 'list'>, {'all_KL': [0.146, 0.114, 0.099, 0.094], 'all_L1': [0.462, 0.427, 0.415, 0.41]}), defaultdict(<class 'list'>, {'all_KL': [0.056, 0.025, 0.008, 0.011], 'all_L1': [0.309, 0.279, 0.272, 0.275]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.39, 0.008, 0.005, 0.005], 'all_L1': [0.256, 0.006, 0.003, 0.003]}), defaultdict(<class 'list'>, {'all_KL': [0.341, 0.005, 0.005, 0.005], 'all_L1': [0.226, 0.004, 0.004, 0.004]}), defaultdict(<class 'list'>, {'all_KL': [0.291, 0.019, 0.02, 0.02], 'all_L1': [0.19, 0.015, 0.015, 0.015]}), defaultdict(<class 'list'>, {'all_KL': [0.537, 0.025, 0.013, 0.013], 'all_L1': [0.376, 0.012, 0.005, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.201, 0.008, 0.008, 0.008], 'all_L1': [0.136, 0.005, 0.005, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.489, 0.022, 0.016, 0.016], 'all_L1': [0.34, 0.014, 0.009, 0.009]}), defaultdict(<class 'list'>, {'all_KL': [0.282, 0.015, 0.015, 0.015], 'all_L1': [0.171, 0.011, 0.011, 0.011]}), defaultdict(<class 'list'>, {'all_KL': [0.389, 0.031, 0.025, 0.025], 'all_L1': [0.286, 0.018, 0.015, 0.015]}), defaultdict(<class 'list'>, {'all_KL': [0.225, 0.01, 0.01, 0.01], 'all_L1': [0.162, 0.005, 0.005, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.45, 0.021, 0.015, 0.015], 'all_L1': [0.288, 0.008, 0.005, 0.005]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.511, 0.506, 0.507, 0.507], 'all_L1': [0.557, 0.556, 0.556, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.241, 0.238, 0.234, 0.234], 'all_L1': [0.316, 0.315, 0.311, 0.311]}), defaultdict(<class 'list'>, {'all_KL': [0.148, 0.144, 0.149, 0.149], 'all_L1': [0.27, 0.268, 0.269, 0.269]}), defaultdict(<class 'list'>, {'all_KL': [0.232, 0.232, 0.232, 0.232], 'all_L1': [0.302, 0.302, 0.302, 0.302]}), defaultdict(<class 'list'>, {'all_KL': [0.448, 0.442, 0.444, 0.443], 'all_L1': [0.505, 0.502, 0.503, 0.501]}), defaultdict(<class 'list'>, {'all_KL': [0.636, 0.635, 0.635, 0.635], 'all_L1': [0.648, 0.648, 0.648, 0.648]}), defaultdict(<class 'list'>, {'all_KL': [0.342, 0.333, 0.332, 0.332], 'all_L1': [0.412, 0.408, 0.407, 0.407]}), defaultdict(<class 'list'>, {'all_KL': [0.416, 0.414, 0.413, 0.413], 'all_L1': [0.466, 0.466, 0.465, 0.465]}), defaultdict(<class 'list'>, {'all_KL': [0.229, 0.224, 0.224, 0.224], 'all_L1': [0.324, 0.321, 0.321, 0.321]}), defaultdict(<class 'list'>, {'all_KL': [0.495, 0.495, 0.495, 0.495], 'all_L1': [0.517, 0.517, 0.517, 0.517]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.377, 0.011, 0.011, 0.011], 'all_L1': [0.334, 0.029, 0.028, 0.028]}), defaultdict(<class 'list'>, {'all_KL': [0.606, 0.016, 0.016, 0.016], 'all_L1': [0.535, 0.041, 0.041, 0.041]}), defaultdict(<class 'list'>, {'all_KL': [0.554, 0.016, 0.016, 0.016], 'all_L1': [0.46, 0.026, 0.025, 0.025]}), defaultdict(<class 'list'>, {'all_KL': [0.711, 0.022, 0.021, 0.021], 'all_L1': [0.636, 0.045, 0.043, 0.043]}), defaultdict(<class 'list'>, {'all_KL': [0.312, 0.013, 0.012, 0.012], 'all_L1': [0.298, 0.034, 0.034, 0.034]}), defaultdict(<class 'list'>, {'all_KL': [0.282, 0.01, 0.01, 0.01], 'all_L1': [0.274, 0.031, 0.03, 0.03]}), defaultdict(<class 'list'>, {'all_KL': [0.303, 0.012, 0.012, 0.012], 'all_L1': [0.278, 0.028, 0.028, 0.028]}), defaultdict(<class 'list'>, {'all_KL': [0.504, 0.012, 0.012, 0.012], 'all_L1': [0.433, 0.029, 0.029, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.453, 0.013, 0.013, 0.013], 'all_L1': [0.384, 0.028, 0.027, 0.027]}), defaultdict(<class 'list'>, {'all_KL': [0.396, 0.019, 0.018, 0.018], 'all_L1': [0.383, 0.044, 0.043, 0.043]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.37, 0.242, 0.246, 0.246], 'all_L1': [0.55, 0.459, 0.461, 0.462]}), defaultdict(<class 'list'>, {'all_KL': [0.397, 0.257, 0.257, 0.249], 'all_L1': [0.536, 0.43, 0.43, 0.425]}), defaultdict(<class 'list'>, {'all_KL': [0.393, 0.289, 0.285, 0.283], 'all_L1': [0.51, 0.436, 0.437, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.23, 0.199, 0.197, 0.198], 'all_L1': [0.386, 0.359, 0.359, 0.36]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.286, 0.273, 0.271], 'all_L1': [0.531, 0.496, 0.491, 0.49]}), defaultdict(<class 'list'>, {'all_KL': [0.428, 0.321, 0.319, 0.317], 'all_L1': [0.518, 0.451, 0.451, 0.451]}), defaultdict(<class 'list'>, {'all_KL': [0.38, 0.256, 0.26, 0.255], 'all_L1': [0.557, 0.483, 0.484, 0.482]}), defaultdict(<class 'list'>, {'all_KL': [0.246, 0.198, 0.193, 0.195], 'all_L1': [0.424, 0.388, 0.385, 0.388]}), defaultdict(<class 'list'>, {'all_KL': [0.309, 0.248, 0.244, 0.241], 'all_L1': [0.474, 0.423, 0.42, 0.42]}), defaultdict(<class 'list'>, {'all_KL': [0.281, 0.148, 0.141, 0.144], 'all_L1': [0.485, 0.418, 0.413, 0.418]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.398, 0.051, 0.042, 0.042], 'all_L1': [0.285, 0.048, 0.04, 0.04]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.042, 0.034, 0.033], 'all_L1': [0.329, 0.04, 0.034, 0.034]}), defaultdict(<class 'list'>, {'all_KL': [0.379, 0.048, 0.041, 0.04], 'all_L1': [0.311, 0.05, 0.042, 0.041]}), defaultdict(<class 'list'>, {'all_KL': [0.433, 0.067, 0.051, 0.049], 'all_L1': [0.357, 0.057, 0.044, 0.043]}), defaultdict(<class 'list'>, {'all_KL': [0.347, 0.043, 0.04, 0.038], 'all_L1': [0.272, 0.043, 0.04, 0.038]}), defaultdict(<class 'list'>, {'all_KL': [0.481, 0.061, 0.044, 0.042], 'all_L1': [0.399, 0.062, 0.046, 0.045]}), defaultdict(<class 'list'>, {'all_KL': [0.302, 0.052, 0.048, 0.047], 'all_L1': [0.238, 0.05, 0.047, 0.047]}), defaultdict(<class 'list'>, {'all_KL': [0.444, 0.057, 0.048, 0.048], 'all_L1': [0.344, 0.052, 0.044, 0.044]}), defaultdict(<class 'list'>, {'all_KL': [0.352, 0.04, 0.037, 0.036], 'all_L1': [0.286, 0.038, 0.035, 0.035]}), defaultdict(<class 'list'>, {'all_KL': [0.498, 0.043, 0.036, 0.035], 'all_L1': [0.317, 0.037, 0.032, 0.031]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.416 +- 0.121, 0.374 +- 0.111, 0.367 +- 0.110, 0.367 +- 0.113
suff_simple class all_KL  =  0.148 +- 0.103, 0.102 +- 0.084, 0.092 +- 0.083, 0.090 +- 0.082
suff_simple_acc_int  =  0.424 +- 0.143, 0.376 +- 0.136, 0.372 +- 0.139, 0.374 +- 0.140
nec class all_L1  =  0.243 +- 0.076, 0.010 +- 0.005, 0.008 +- 0.004, 0.008 +- 0.004
nec class all_KL  =  0.360 +- 0.106, 0.016 +- 0.008, 0.013 +- 0.006, 0.013 +- 0.006
nec_acc_int  =  0.760 +- 0.079, 0.992 +- 0.004, 0.994 +- 0.004, 0.994 +- 0.004

Eval split val
suff_simple class all_L1  =  0.432 +- 0.120, 0.430 +- 0.121, 0.430 +- 0.121, 0.430 +- 0.121
suff_simple class all_KL  =  0.370 +- 0.148, 0.366 +- 0.149, 0.366 +- 0.149, 0.366 +- 0.149
suff_simple_acc_int  =  0.040 +- 0.034, 0.039 +- 0.034, 0.039 +- 0.033, 0.039 +- 0.033
nec class all_L1  =  0.401 +- 0.112, 0.034 +- 0.007, 0.033 +- 0.007, 0.033 +- 0.007
nec class all_KL  =  0.450 +- 0.135, 0.014 +- 0.004, 0.014 +- 0.003, 0.014 +- 0.003
nec_acc_int  =  0.277 +- 0.141, 0.618 +- 0.161, 0.618 +- 0.161, 0.618 +- 0.161

Eval split test
suff_simple class all_L1  =  0.497 +- 0.053, 0.434 +- 0.039, 0.433 +- 0.039, 0.433 +- 0.038
suff_simple class all_KL  =  0.344 +- 0.068, 0.244 +- 0.048, 0.241 +- 0.049, 0.240 +- 0.047
suff_simple_acc_int  =  0.394 +- 0.098, 0.338 +- 0.112, 0.337 +- 0.113, 0.337 +- 0.113
nec class all_L1  =  0.314 +- 0.044, 0.048 +- 0.008, 0.040 +- 0.005, 0.040 +- 0.005
nec class all_KL  =  0.404 +- 0.059, 0.050 +- 0.009, 0.042 +- 0.005, 0.041 +- 0.005
nec_acc_int  =  0.571 +- 0.108, 0.752 +- 0.089, 0.757 +- 0.087, 0.757 +- 0.087


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.330 +- 0.031, 0.192 +- 0.054, 0.188 +- 0.055, 0.187 +- 0.056
Faith. Armon (L1)= 		  =  0.282 +- 0.032, 0.019 +- 0.009, 0.015 +- 0.008, 0.015 +- 0.008
Faith. GMean (L1)= 	  =  0.304 +- 0.024, 0.057 +- 0.013, 0.051 +- 0.016, 0.050 +- 0.016
Faith. Aritm (KL)= 		  =  0.254 +- 0.034, 0.059 +- 0.040, 0.053 +- 0.040, 0.052 +- 0.040
Faith. Armon (KL)= 		  =  0.171 +- 0.091, 0.018 +- 0.008, 0.016 +- 0.009, 0.015 +- 0.009
Faith. GMean (KL)= 	  =  0.200 +- 0.067, 0.031 +- 0.017, 0.027 +- 0.018, 0.027 +- 0.017

Eval split val
Faith. Aritm (L1)= 		  =  0.417 +- 0.044, 0.232 +- 0.060, 0.231 +- 0.060, 0.231 +- 0.060
Faith. Armon (L1)= 		  =  0.390 +- 0.038, 0.062 +- 0.011, 0.060 +- 0.011, 0.060 +- 0.011
Faith. GMean (L1)= 	  =  0.403 +- 0.040, 0.118 +- 0.019, 0.117 +- 0.019, 0.117 +- 0.019
Faith. Aritm (KL)= 		  =  0.410 +- 0.053, 0.190 +- 0.074, 0.190 +- 0.073, 0.190 +- 0.073
Faith. Armon (KL)= 		  =  0.364 +- 0.065, 0.027 +- 0.006, 0.027 +- 0.006, 0.027 +- 0.006
Faith. GMean (KL)= 	  =  0.386 +- 0.056, 0.070 +- 0.013, 0.069 +- 0.012, 0.069 +- 0.012

Eval split test
Faith. Aritm (L1)= 		  =  0.405 +- 0.025, 0.241 +- 0.019, 0.237 +- 0.020, 0.236 +- 0.020
Faith. Armon (L1)= 		  =  0.380 +- 0.030, 0.086 +- 0.012, 0.074 +- 0.008, 0.073 +- 0.008
Faith. GMean (L1)= 	  =  0.393 +- 0.026, 0.143 +- 0.012, 0.132 +- 0.011, 0.131 +- 0.011
Faith. Aritm (KL)= 		  =  0.374 +- 0.037, 0.147 +- 0.024, 0.142 +- 0.025, 0.140 +- 0.024
Faith. Armon (KL)= 		  =  0.364 +- 0.043, 0.083 +- 0.012, 0.071 +- 0.008, 0.069 +- 0.008
Faith. GMean (KL)= 	  =  0.369 +- 0.039, 0.110 +- 0.014, 0.100 +- 0.012, 0.098 +- 0.012
Computed for split load_split = id



Completed in  0:51:45.474791  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.1 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 23:21:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 11:21:16 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 11:21:16 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 11:21:16 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 11:21:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:21:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:21:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:21:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:21:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:21:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 11:21:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.978
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.965
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.800
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.303
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.964
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.954
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.803
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.312
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.929
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.915
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.741
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.343


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9783862815884475
len(reference) = 276
Effective ratio: 0.119 +- 0.111
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9649638989169675
len(reference) = 277
Effective ratio: 0.085 +- 0.079
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.799754512635379
len(reference) = 277
Effective ratio: 0.058 +- 0.052
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3028303249097473
len(reference) = 277
Effective ratio: 0.020 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9642238095238096
len(reference) = 2520
Effective ratio: 0.019 +- 0.005
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.953540873015873
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8033261904761905
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3124440476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9290684764991898
len(reference) = 2251
Effective ratio: 0.189 +- 0.322
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9152747163695298
len(reference) = 2337
Effective ratio: 0.138 +- 0.261
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.7412783630470016
len(reference) = 2394
Effective ratio: 0.104 +- 0.219
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.34304902755267425
len(reference) = 2468
Effective ratio: 0.023 +- 0.039
Model Accuracy over intervened graphs for r=0.6 =  0.995
SUFF_SIMPLE for r=0.6 class 1.0 = 0.994 +- 0.094 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.6 all KL = 0.989 +- 0.094 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.6 all L1 = 0.994 +- 0.056 (in-sample avg dev_std = 0.100)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9783862815884475
len(reference) = 277
Effective ratio: 0.119 +- 0.111
Model Accuracy over intervened graphs for r=0.01 =  0.003
NEC for r=0.01 class 1.0 = 0.862 +- 0.027 (in-sample avg dev_std = 0.042)
NEC for r=0.01 all KL = 0.997 +- 0.027 (in-sample avg dev_std = 0.042)
NEC for r=0.01 all L1 = 0.862 +- 0.039 (in-sample avg dev_std = 0.042)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9649638989169675
len(reference) = 277
Effective ratio: 0.085 +- 0.079
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.864 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.999 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.864 +- 0.001 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.799754512635379
len(reference) = 277
Effective ratio: 0.058 +- 0.052
Model Accuracy over intervened graphs for r=0.25 =  0.437
NEC for r=0.25 class 1.0 = 0.526 +- 0.447 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.643 +- 0.447 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.526 +- 0.381 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3028303249097473
len(reference) = 277
Effective ratio: 0.020 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.001 +- 0.024 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.002 +- 0.024 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.001 +- 0.013 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9642238095238096
len(reference) = 2520
Effective ratio: 0.019 +- 0.005
Model Accuracy over intervened graphs for r=0.01 =  0.0
NEC for r=0.01 class 1.0 = 0.852 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.962 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.852 +- 0.024 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.953540873015873
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.852 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.961 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.852 +- 0.024 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8033261904761905
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.25 =  0.42
NEC for r=0.25 class 1.0 = 0.52 +- 0.448 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.595 +- 0.448 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.52 +- 0.383 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3124440476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.996
NEC for r=0.6 class 1.0 = 0.006 +- 0.072 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.007 +- 0.072 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.006 +- 0.059 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9290684764991898
len(reference) = 2468
Effective ratio: 0.189 +- 0.322
Model Accuracy over intervened graphs for r=0.01 =  0.111
NEC for r=0.01 class 1.0 = 0.774 +- 0.271 (in-sample avg dev_std = 0.166)
NEC for r=0.01 all KL = 0.909 +- 0.271 (in-sample avg dev_std = 0.166)
NEC for r=0.01 all L1 = 0.774 +- 0.250 (in-sample avg dev_std = 0.166)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9152747163695298
len(reference) = 2468
Effective ratio: 0.138 +- 0.261
Model Accuracy over intervened graphs for r=0.1 =  0.064
NEC for r=0.1 class 1.0 = 0.811 +- 0.224 (in-sample avg dev_std = 0.100)
NEC for r=0.1 all KL = 0.942 +- 0.224 (in-sample avg dev_std = 0.100)
NEC for r=0.1 all L1 = 0.811 +- 0.201 (in-sample avg dev_std = 0.100)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.7412783630470016
len(reference) = 2468
Effective ratio: 0.104 +- 0.219
Model Accuracy over intervened graphs for r=0.25 =  0.444
NEC for r=0.25 class 1.0 = 0.49 +- 0.486 (in-sample avg dev_std = 0.063)
NEC for r=0.25 all KL = 0.575 +- 0.486 (in-sample avg dev_std = 0.063)
NEC for r=0.25 all L1 = 0.49 +- 0.419 (in-sample avg dev_std = 0.063)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.34304902755267425
len(reference) = 2468
Effective ratio: 0.023 +- 0.039
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.002 +- 0.031 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.002 +- 0.031 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.002 +- 0.019 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 23:26:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 11:26:02 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 11:26:02 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 11:26:02 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 11:26:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:26:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:26:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:26:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:26:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:26:02 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 11:26:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.801
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.942
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.957
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.910
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.833
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.980
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.984
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.937
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.906
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.915
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.897
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.881


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8012346570397112
len(reference) = 260
Effective ratio: 0.479 +- 0.270
Model Accuracy over intervened graphs for r=0.01 =  0.989
SUFF_SIMPLE for r=0.01 class 1.0 = 0.982 +- 0.160 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.01 all KL = 0.961 +- 0.160 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.01 all L1 = 0.982 +- 0.077 (in-sample avg dev_std = 0.194)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9422851985559568
len(reference) = 272
Effective ratio: 0.147 +- 0.172
Model Accuracy over intervened graphs for r=0.1 =  0.991
SUFF_SIMPLE for r=0.1 class 1.0 = 0.985 +- 0.143 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.1 all KL = 0.967 +- 0.143 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.1 all L1 = 0.985 +- 0.070 (in-sample avg dev_std = 0.171)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9570649819494583
len(reference) = 277
Effective ratio: 0.084 +- 0.081
Model Accuracy over intervened graphs for r=0.25 =  0.993
SUFF_SIMPLE for r=0.25 class 1.0 = 0.988 +- 0.129 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.25 all KL = 0.973 +- 0.129 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.25 all L1 = 0.988 +- 0.058 (in-sample avg dev_std = 0.155)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9102418772563177
len(reference) = 277
Effective ratio: 0.072 +- 0.055
Model Accuracy over intervened graphs for r=0.6 =  0.997
SUFF_SIMPLE for r=0.6 class 1.0 = 0.994 +- 0.092 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.6 all KL = 0.985 +- 0.092 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.6 all L1 = 0.994 +- 0.036 (in-sample avg dev_std = 0.112)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8328400793650794
len(reference) = 2520
Effective ratio: 0.091 +- 0.028
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9798198412698413
len(reference) = 2520
Effective ratio: 0.015 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.032 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.1 all KL = 0.998 +- 0.032 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.1 all L1 = 0.999 +- 0.012 (in-sample avg dev_std = 0.040)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9841551587301587
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 0.999 +- 0.028 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.25 all KL = 0.998 +- 0.028 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.25 all L1 = 0.999 +- 0.012 (in-sample avg dev_std = 0.037)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9368936507936507
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.999 +- 0.035 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.6 all KL = 0.998 +- 0.035 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.6 all L1 = 0.999 +- 0.015 (in-sample avg dev_std = 0.044)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9055555105348461
len(reference) = 2060
Effective ratio: 0.277 +- 0.393
Model Accuracy over intervened graphs for r=0.01 =  0.998
SUFF_SIMPLE for r=0.01 class 1.0 = 0.998 +- 0.055 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.01 all KL = 0.996 +- 0.055 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.01 all L1 = 0.998 +- 0.040 (in-sample avg dev_std = 0.040)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9151738249594813
len(reference) = 2209
Effective ratio: 0.210 +- 0.344
Model Accuracy over intervened graphs for r=0.1 =  0.997
SUFF_SIMPLE for r=0.1 class 1.0 = 0.998 +- 0.053 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.1 all KL = 0.996 +- 0.053 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.1 all L1 = 0.998 +- 0.039 (in-sample avg dev_std = 0.039)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.998
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8974448946515398
len(reference) = 2325
Effective ratio: 0.144 +- 0.277
Model Accuracy over intervened graphs for r=0.25 =  0.999
SUFF_SIMPLE for r=0.25 class 1.0 = 0.999 +- 0.042 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.25 all KL = 0.998 +- 0.042 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.25 all L1 = 0.999 +- 0.028 (in-sample avg dev_std = 0.036)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.998
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8807499999999999
len(reference) = 2457
Effective ratio: 0.089 +- 0.158
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.998 +- 0.048 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.6 all KL = 0.997 +- 0.048 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.6 all L1 = 0.998 +- 0.036 (in-sample avg dev_std = 0.032)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8012346570397112
len(reference) = 277
Effective ratio: 0.479 +- 0.270
Model Accuracy over intervened graphs for r=0.01 =  0.856
NEC for r=0.01 class 1.0 = 0.193 +- 0.386 (in-sample avg dev_std = 0.568)
NEC for r=0.01 all KL = 0.363 +- 0.386 (in-sample avg dev_std = 0.568)
NEC for r=0.01 all L1 = 0.193 +- 0.241 (in-sample avg dev_std = 0.568)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9422851985559568
len(reference) = 277
Effective ratio: 0.147 +- 0.172
Model Accuracy over intervened graphs for r=0.1 =  0.03
NEC for r=0.1 class 1.0 = 0.84 +- 0.140 (in-sample avg dev_std = 0.092)
NEC for r=0.1 all KL = 0.975 +- 0.140 (in-sample avg dev_std = 0.092)
NEC for r=0.1 all L1 = 0.84 +- 0.135 (in-sample avg dev_std = 0.092)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9570649819494583
len(reference) = 277
Effective ratio: 0.084 +- 0.081
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.864 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.999 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.864 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9102418772563177
len(reference) = 277
Effective ratio: 0.072 +- 0.055
Model Accuracy over intervened graphs for r=0.6 =  0.022
NEC for r=0.6 class 1.0 = 0.845 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.977 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.845 +- 0.124 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8328400793650794
len(reference) = 2520
Effective ratio: 0.091 +- 0.028
Model Accuracy over intervened graphs for r=0.01 =  0.038
NEC for r=0.01 class 1.0 = 0.831 +- 0.189 (in-sample avg dev_std = 0.021)
NEC for r=0.01 all KL = 0.958 +- 0.189 (in-sample avg dev_std = 0.021)
NEC for r=0.01 all L1 = 0.831 +- 0.164 (in-sample avg dev_std = 0.021)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9798198412698413
len(reference) = 2520
Effective ratio: 0.015 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.863 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.995 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.863 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9841551587301587
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.863 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.995 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.863 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9368936507936507
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.05
NEC for r=0.6 class 1.0 = 0.822 +- 0.205 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.949 +- 0.205 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.822 +- 0.179 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.998
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9055555105348461
len(reference) = 2468
Effective ratio: 0.277 +- 0.393
Model Accuracy over intervened graphs for r=0.01 =  0.177
NEC for r=0.01 class 1.0 = 0.731 +- 0.288 (in-sample avg dev_std = 0.302)
NEC for r=0.01 all KL = 0.882 +- 0.288 (in-sample avg dev_std = 0.302)
NEC for r=0.01 all L1 = 0.731 +- 0.280 (in-sample avg dev_std = 0.302)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9151738249594813
len(reference) = 2468
Effective ratio: 0.210 +- 0.344
Model Accuracy over intervened graphs for r=0.1 =  0.136
NEC for r=0.1 class 1.0 = 0.759 +- 0.263 (in-sample avg dev_std = 0.250)
NEC for r=0.1 all KL = 0.905 +- 0.263 (in-sample avg dev_std = 0.250)
NEC for r=0.1 all L1 = 0.759 +- 0.256 (in-sample avg dev_std = 0.250)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.998
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8974448946515398
len(reference) = 2468
Effective ratio: 0.144 +- 0.277
Model Accuracy over intervened graphs for r=0.25 =  0.085
NEC for r=0.25 class 1.0 = 0.797 +- 0.227 (in-sample avg dev_std = 0.173)
NEC for r=0.25 all KL = 0.935 +- 0.227 (in-sample avg dev_std = 0.173)
NEC for r=0.25 all L1 = 0.797 +- 0.216 (in-sample avg dev_std = 0.173)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.998
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8807499999999999
len(reference) = 2468
Effective ratio: 0.089 +- 0.158
Model Accuracy over intervened graphs for r=0.6 =  0.034
NEC for r=0.6 class 1.0 = 0.834 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.965 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.834 +- 0.155 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 23:31:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 11:31:12 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 11:31:12 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 11:31:12 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 11:31:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:31:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:31:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:31:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:31:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:31:12 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 11:31:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.787
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.901
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.981
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.944
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.783
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.930
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.983
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.980
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.900
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.906
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.911
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.894


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7870505415162454
len(reference) = 246
Effective ratio: 0.473 +- 0.268
Model Accuracy over intervened graphs for r=0.01 =  0.992
SUFF_SIMPLE for r=0.01 class 1.0 = 0.991 +- 0.103 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.01 all KL = 0.985 +- 0.103 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.01 all L1 = 0.991 +- 0.072 (in-sample avg dev_std = 0.103)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9009675090252709
len(reference) = 273
Effective ratio: 0.176 +- 0.193
Model Accuracy over intervened graphs for r=0.1 =  0.991
SUFF_SIMPLE for r=0.1 class 1.0 = 0.988 +- 0.121 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all KL = 0.979 +- 0.121 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all L1 = 0.988 +- 0.075 (in-sample avg dev_std = 0.138)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9813212996389893
len(reference) = 276
Effective ratio: 0.105 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.996
SUFF_SIMPLE for r=0.25 class 1.0 = 0.994 +- 0.083 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.25 all KL = 0.988 +- 0.083 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.25 all L1 = 0.994 +- 0.041 (in-sample avg dev_std = 0.111)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9436895306859208
len(reference) = 277
Effective ratio: 0.084 +- 0.069
Model Accuracy over intervened graphs for r=0.6 =  0.997
SUFF_SIMPLE for r=0.6 class 1.0 = 0.995 +- 0.075 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.6 all KL = 0.989 +- 0.075 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.6 all L1 = 0.995 +- 0.036 (in-sample avg dev_std = 0.103)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.86
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7825789682539683
len(reference) = 2520
Effective ratio: 0.100 +- 0.028
Model Accuracy over intervened graphs for r=0.01 =  0.86
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9304154761904762
len(reference) = 2520
Effective ratio: 0.019 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.86
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.86
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.983297619047619
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.86
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9803599206349206
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.86
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8995619935170177
len(reference) = 1932
Effective ratio: 0.289 +- 0.410
Model Accuracy over intervened graphs for r=0.01 =  0.996
SUFF_SIMPLE for r=0.01 class 1.0 = 0.996 +- 0.067 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.01 all KL = 0.995 +- 0.067 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.01 all L1 = 0.996 +- 0.051 (in-sample avg dev_std = 0.049)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9055405186385737
len(reference) = 2118
Effective ratio: 0.225 +- 0.362
Model Accuracy over intervened graphs for r=0.1 =  0.995
SUFF_SIMPLE for r=0.1 class 1.0 = 0.996 +- 0.065 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.1 all KL = 0.995 +- 0.065 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.1 all L1 = 0.996 +- 0.052 (in-sample avg dev_std = 0.040)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.995
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.910589546191248
len(reference) = 2293
Effective ratio: 0.172 +- 0.301
Model Accuracy over intervened graphs for r=0.25 =  0.997
SUFF_SIMPLE for r=0.25 class 1.0 = 0.996 +- 0.067 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.25 all KL = 0.995 +- 0.067 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.25 all L1 = 0.996 +- 0.053 (in-sample avg dev_std = 0.043)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.992
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8941519448946517
len(reference) = 2457
Effective ratio: 0.098 +- 0.166
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.992 +- 0.093 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.6 all KL = 0.99 +- 0.093 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.6 all L1 = 0.992 +- 0.078 (in-sample avg dev_std = 0.041)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7870505415162454
len(reference) = 277
Effective ratio: 0.473 +- 0.268
Model Accuracy over intervened graphs for r=0.01 =  0.826
NEC for r=0.01 class 1.0 = 0.23 +- 0.377 (in-sample avg dev_std = 0.619)
NEC for r=0.01 all KL = 0.394 +- 0.377 (in-sample avg dev_std = 0.619)
NEC for r=0.01 all L1 = 0.23 +- 0.254 (in-sample avg dev_std = 0.619)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9009675090252709
len(reference) = 277
Effective ratio: 0.176 +- 0.193
Model Accuracy over intervened graphs for r=0.1 =  0.02
NEC for r=0.1 class 1.0 = 0.849 +- 0.064 (in-sample avg dev_std = 0.131)
NEC for r=0.1 all KL = 0.986 +- 0.064 (in-sample avg dev_std = 0.131)
NEC for r=0.1 all L1 = 0.849 +- 0.088 (in-sample avg dev_std = 0.131)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9813212996389893
len(reference) = 277
Effective ratio: 0.105 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.003
NEC for r=0.25 class 1.0 = 0.861 +- 0.015 (in-sample avg dev_std = 0.055)
NEC for r=0.25 all KL = 0.995 +- 0.015 (in-sample avg dev_std = 0.055)
NEC for r=0.25 all L1 = 0.861 +- 0.028 (in-sample avg dev_std = 0.055)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9436895306859208
len(reference) = 277
Effective ratio: 0.084 +- 0.069
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.863 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.996 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.863 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.86
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7825789682539683
len(reference) = 2520
Effective ratio: 0.100 +- 0.028
Model Accuracy over intervened graphs for r=0.01 =  0.0
NEC for r=0.01 class 1.0 = 0.776 +- 0.280 (in-sample avg dev_std = 0.025)
NEC for r=0.01 all KL = 0.856 +- 0.280 (in-sample avg dev_std = 0.025)
NEC for r=0.01 all L1 = 0.776 +- 0.198 (in-sample avg dev_std = 0.025)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9304154761904762
len(reference) = 2520
Effective ratio: 0.019 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.776 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.856 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.776 +- 0.198 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.86
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.983297619047619
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.776 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.856 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.776 +- 0.198 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9803599206349206
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.776 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.856 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.776 +- 0.198 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.992
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8995619935170177
len(reference) = 2468
Effective ratio: 0.289 +- 0.410
Model Accuracy over intervened graphs for r=0.01 =  0.199
NEC for r=0.01 class 1.0 = 0.715 +- 0.299 (in-sample avg dev_std = 0.313)
NEC for r=0.01 all KL = 0.86 +- 0.299 (in-sample avg dev_std = 0.313)
NEC for r=0.01 all L1 = 0.715 +- 0.289 (in-sample avg dev_std = 0.313)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9055405186385737
len(reference) = 2468
Effective ratio: 0.225 +- 0.362
Model Accuracy over intervened graphs for r=0.1 =  0.136
NEC for r=0.1 class 1.0 = 0.762 +- 0.262 (in-sample avg dev_std = 0.250)
NEC for r=0.1 all KL = 0.901 +- 0.262 (in-sample avg dev_std = 0.250)
NEC for r=0.1 all L1 = 0.762 +- 0.252 (in-sample avg dev_std = 0.250)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.992
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.910589546191248
len(reference) = 2468
Effective ratio: 0.172 +- 0.301
Model Accuracy over intervened graphs for r=0.25 =  0.078
NEC for r=0.25 class 1.0 = 0.801 +- 0.221 (in-sample avg dev_std = 0.176)
NEC for r=0.25 all KL = 0.935 +- 0.221 (in-sample avg dev_std = 0.176)
NEC for r=0.25 all L1 = 0.801 +- 0.207 (in-sample avg dev_std = 0.176)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.992
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8941519448946517
len(reference) = 2468
Effective ratio: 0.098 +- 0.166
Model Accuracy over intervened graphs for r=0.6 =  0.009
NEC for r=0.6 class 1.0 = 0.848 +- 0.130 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.978 +- 0.130 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.848 +- 0.112 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 23:36:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 11:36:09 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 11:36:09 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 11:36:09 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 11:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:36:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:36:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:36:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 11:36:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.868
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.976
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.914
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.249
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.680
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.933
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.922
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.908
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.900
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.862
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.279


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8683935018050543
len(reference) = 273
Effective ratio: 0.229 +- 0.163
Model Accuracy over intervened graphs for r=0.01 =  0.892
SUFF_SIMPLE for r=0.01 class 1.0 = 0.85 +- 0.334 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.01 all KL = 0.753 +- 0.334 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.01 all L1 = 0.85 +- 0.219 (in-sample avg dev_std = 0.509)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9756967509025269
len(reference) = 277
Effective ratio: 0.103 +- 0.096
Model Accuracy over intervened graphs for r=0.1 =  0.891
SUFF_SIMPLE for r=0.1 class 1.0 = 0.841 +- 0.334 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.1 all KL = 0.73 +- 0.334 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.1 all L1 = 0.841 +- 0.208 (in-sample avg dev_std = 0.549)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9138483754512636
len(reference) = 277
Effective ratio: 0.083 +- 0.079
Model Accuracy over intervened graphs for r=0.25 =  0.895
SUFF_SIMPLE for r=0.25 class 1.0 = 0.846 +- 0.329 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.25 all KL = 0.741 +- 0.329 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.25 all L1 = 0.846 +- 0.207 (in-sample avg dev_std = 0.537)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2486462093862816
len(reference) = 277
Effective ratio: 0.020 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.899
SUFF_SIMPLE for r=0.6 class 1.0 = 0.852 +- 0.321 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.6 all KL = 0.748 +- 0.321 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.6 all L1 = 0.852 +- 0.198 (in-sample avg dev_std = 0.525)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.762
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.6796630952380952
len(reference) = 2520
Effective ratio: 0.082 +- 0.024
Model Accuracy over intervened graphs for r=0.01 =  0.753
SUFF_SIMPLE for r=0.01 class 1.0 = 0.977 +- 0.138 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.01 all KL = 0.963 +- 0.138 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.01 all L1 = 0.977 +- 0.082 (in-sample avg dev_std = 0.191)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9326305555555555
len(reference) = 2520
Effective ratio: 0.016 +- 0.004
Model Accuracy over intervened graphs for r=0.1 =  0.74
SUFF_SIMPLE for r=0.1 class 1.0 = 0.955 +- 0.193 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.1 all KL = 0.923 +- 0.193 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.1 all L1 = 0.955 +- 0.111 (in-sample avg dev_std = 0.283)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.762
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9220797619047617
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.74
SUFF_SIMPLE for r=0.25 class 1.0 = 0.955 +- 0.193 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.25 all KL = 0.923 +- 0.193 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.25 all L1 = 0.955 +- 0.110 (in-sample avg dev_std = 0.285)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2460301587301587
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.738
SUFF_SIMPLE for r=0.6 class 1.0 = 0.952 +- 0.199 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.6 all KL = 0.917 +- 0.199 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.6 all L1 = 0.952 +- 0.114 (in-sample avg dev_std = 0.296)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9083071312803889
len(reference) = 2091
Effective ratio: 0.232 +- 0.368
Model Accuracy over intervened graphs for r=0.01 =  0.979
SUFF_SIMPLE for r=0.01 class 1.0 = 0.975 +- 0.160 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.01 all KL = 0.964 +- 0.160 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.01 all L1 = 0.975 +- 0.117 (in-sample avg dev_std = 0.153)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.993
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8995255267423015
len(reference) = 2253
Effective ratio: 0.175 +- 0.309
Model Accuracy over intervened graphs for r=0.1 =  0.985
SUFF_SIMPLE for r=0.1 class 1.0 = 0.979 +- 0.143 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.1 all KL = 0.969 +- 0.143 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.1 all L1 = 0.979 +- 0.101 (in-sample avg dev_std = 0.155)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.982
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8620251215559157
len(reference) = 2381
Effective ratio: 0.134 +- 0.256
Model Accuracy over intervened graphs for r=0.25 =  0.991
SUFF_SIMPLE for r=0.25 class 1.0 = 0.979 +- 0.138 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.25 all KL = 0.972 +- 0.138 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.25 all L1 = 0.979 +- 0.109 (in-sample avg dev_std = 0.120)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.977
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.27854457050243114
len(reference) = 2468
Effective ratio: 0.023 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.987
SUFF_SIMPLE for r=0.6 class 1.0 = 0.958 +- 0.200 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.6 all KL = 0.941 +- 0.200 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.6 all L1 = 0.958 +- 0.149 (in-sample avg dev_std = 0.202)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8683935018050543
len(reference) = 277
Effective ratio: 0.229 +- 0.163
Model Accuracy over intervened graphs for r=0.01 =  0.199
NEC for r=0.01 class 1.0 = 0.734 +- 0.219 (in-sample avg dev_std = 0.476)
NEC for r=0.01 all KL = 0.89 +- 0.219 (in-sample avg dev_std = 0.476)
NEC for r=0.01 all L1 = 0.734 +- 0.229 (in-sample avg dev_std = 0.476)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9756967509025269
len(reference) = 277
Effective ratio: 0.103 +- 0.096
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.86 +- 0.009 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.989 +- 0.009 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.86 +- 0.002 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9138483754512636
len(reference) = 277
Effective ratio: 0.083 +- 0.079
Model Accuracy over intervened graphs for r=0.25 =  0.029
NEC for r=0.25 class 1.0 = 0.842 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.969 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.842 +- 0.101 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2486462093862816
len(reference) = 277
Effective ratio: 0.020 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.986
NEC for r=0.6 class 1.0 = 0.012 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.014 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.012 +- 0.102 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.762
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.6796630952380952
len(reference) = 2520
Effective ratio: 0.082 +- 0.024
Model Accuracy over intervened graphs for r=0.01 =  0.0
NEC for r=0.01 class 1.0 = 0.729 +- 0.326 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.78 +- 0.326 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.729 +- 0.221 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9326305555555555
len(reference) = 2520
Effective ratio: 0.016 +- 0.004
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.729 +- 0.326 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.78 +- 0.326 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.729 +- 0.221 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.762
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9220797619047617
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.729 +- 0.326 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.78 +- 0.326 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.729 +- 0.221 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2460301587301587
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.748
NEC for r=0.6 class 1.0 = 0.014 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.014 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.014 +- 0.101 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.977
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9083071312803889
len(reference) = 2468
Effective ratio: 0.232 +- 0.368
Model Accuracy over intervened graphs for r=0.01 =  0.143
NEC for r=0.01 class 1.0 = 0.763 +- 0.257 (in-sample avg dev_std = 0.255)
NEC for r=0.01 all KL = 0.893 +- 0.257 (in-sample avg dev_std = 0.255)
NEC for r=0.01 all L1 = 0.763 +- 0.243 (in-sample avg dev_std = 0.255)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8995255267423015
len(reference) = 2468
Effective ratio: 0.175 +- 0.309
Model Accuracy over intervened graphs for r=0.1 =  0.088
NEC for r=0.1 class 1.0 = 0.797 +- 0.220 (in-sample avg dev_std = 0.201)
NEC for r=0.1 all KL = 0.924 +- 0.220 (in-sample avg dev_std = 0.201)
NEC for r=0.1 all L1 = 0.797 +- 0.203 (in-sample avg dev_std = 0.201)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.977
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8620251215559157
len(reference) = 2468
Effective ratio: 0.134 +- 0.256
Model Accuracy over intervened graphs for r=0.25 =  0.073
NEC for r=0.25 class 1.0 = 0.801 +- 0.220 (in-sample avg dev_std = 0.163)
NEC for r=0.25 all KL = 0.925 +- 0.220 (in-sample avg dev_std = 0.163)
NEC for r=0.25 all L1 = 0.801 +- 0.196 (in-sample avg dev_std = 0.163)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.977
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.27854457050243114
len(reference) = 2468
Effective ratio: 0.023 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.878
NEC for r=0.6 class 1.0 = 0.107 +- 0.313 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.12 +- 0.313 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.107 +- 0.271 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 23:41:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 11:41:14 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 11:41:14 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 11:41:14 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 11:41:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:41:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:41:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:41:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:41:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:41:14 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 11:41:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.972
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.992
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.988
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.782
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.930
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.985
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.994
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.814
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.945
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.942
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.914
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.775


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.971956678700361
len(reference) = 275
Effective ratio: 0.153 +- 0.134
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9921046931407942
len(reference) = 277
Effective ratio: 0.095 +- 0.084
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9875992779783394
len(reference) = 277
Effective ratio: 0.089 +- 0.077
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7816353790613718
len(reference) = 277
Effective ratio: 0.060 +- 0.055
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.008 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.008 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.004 (in-sample avg dev_std = 0.007)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.891
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9297126984126985
len(reference) = 2520
Effective ratio: 0.035 +- 0.011
Model Accuracy over intervened graphs for r=0.01 =  0.891
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9846265873015873
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.891
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.891
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9937595238095238
len(reference) = 2520
Effective ratio: 0.013 +- 0.002
Model Accuracy over intervened graphs for r=0.25 =  0.891
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8141019841269842
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.891
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.001 (in-sample avg dev_std = 0.003)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9452820097244733
len(reference) = 2132
Effective ratio: 0.211 +- 0.349
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9417666126418153
len(reference) = 2279
Effective ratio: 0.162 +- 0.290
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9144080226904376
len(reference) = 2367
Effective ratio: 0.130 +- 0.242
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7754542139384117
len(reference) = 2457
Effective ratio: 0.087 +- 0.163
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.971956678700361
len(reference) = 277
Effective ratio: 0.153 +- 0.134
Model Accuracy over intervened graphs for r=0.01 =  0.016
NEC for r=0.01 class 1.0 = 0.853 +- 0.072 (in-sample avg dev_std = 0.132)
NEC for r=0.01 all KL = 0.991 +- 0.072 (in-sample avg dev_std = 0.132)
NEC for r=0.01 all L1 = 0.853 +- 0.080 (in-sample avg dev_std = 0.132)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9921046931407942
len(reference) = 277
Effective ratio: 0.095 +- 0.084
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.864 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.998 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.864 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9875992779783394
len(reference) = 277
Effective ratio: 0.089 +- 0.077
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.864 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.998 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.864 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7816353790613718
len(reference) = 277
Effective ratio: 0.060 +- 0.055
Model Accuracy over intervened graphs for r=0.6 =  0.444
NEC for r=0.6 class 1.0 = 0.487 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.571 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.487 +- 0.419 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.891
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9297126984126985
len(reference) = 2520
Effective ratio: 0.035 +- 0.011
Model Accuracy over intervened graphs for r=0.01 =  0.0
NEC for r=0.01 class 1.0 = 0.802 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.874 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.802 +- 0.124 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9846265873015873
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.802 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.874 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.802 +- 0.124 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.891
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9937595238095238
len(reference) = 2520
Effective ratio: 0.013 +- 0.002
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.802 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.874 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.802 +- 0.124 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8141019841269842
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.365
NEC for r=0.6 class 1.0 = 0.489 +- 0.451 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.525 +- 0.451 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.489 +- 0.383 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9452820097244733
len(reference) = 2468
Effective ratio: 0.211 +- 0.349
Model Accuracy over intervened graphs for r=0.01 =  0.128
NEC for r=0.01 class 1.0 = 0.764 +- 0.259 (in-sample avg dev_std = 0.235)
NEC for r=0.01 all KL = 0.909 +- 0.259 (in-sample avg dev_std = 0.235)
NEC for r=0.01 all L1 = 0.764 +- 0.252 (in-sample avg dev_std = 0.235)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9417666126418153
len(reference) = 2468
Effective ratio: 0.162 +- 0.290
Model Accuracy over intervened graphs for r=0.1 =  0.078
NEC for r=0.1 class 1.0 = 0.804 +- 0.200 (in-sample avg dev_std = 0.192)
NEC for r=0.1 all KL = 0.946 +- 0.200 (in-sample avg dev_std = 0.192)
NEC for r=0.1 all L1 = 0.804 +- 0.199 (in-sample avg dev_std = 0.192)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9144080226904376
len(reference) = 2468
Effective ratio: 0.130 +- 0.242
Model Accuracy over intervened graphs for r=0.25 =  0.048
NEC for r=0.25 class 1.0 = 0.826 +- 0.176 (in-sample avg dev_std = 0.130)
NEC for r=0.25 all KL = 0.962 +- 0.176 (in-sample avg dev_std = 0.130)
NEC for r=0.25 all L1 = 0.826 +- 0.166 (in-sample avg dev_std = 0.130)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7754542139384117
len(reference) = 2468
Effective ratio: 0.087 +- 0.163
Model Accuracy over intervened graphs for r=0.6 =  0.118
NEC for r=0.6 class 1.0 = 0.766 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.888 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.766 +- 0.267 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 23:46:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 11:46:21 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 11:46:21 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 11:46:21 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 11:46:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:46:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:46:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:46:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:46:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:46:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 11:46:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.805
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.919
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.981
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.790
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.783
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.934
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.976
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.816
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.891
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.894
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.894
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.842


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8053718411552346
len(reference) = 252
Effective ratio: 0.415 +- 0.281
Model Accuracy over intervened graphs for r=0.01 =  0.951
SUFF_SIMPLE for r=0.01 class 1.0 = 0.932 +- 0.276 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.01 all KL = 0.864 +- 0.276 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.01 all L1 = 0.932 +- 0.156 (in-sample avg dev_std = 0.339)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9186462093862816
len(reference) = 272
Effective ratio: 0.159 +- 0.187
Model Accuracy over intervened graphs for r=0.1 =  0.955
SUFF_SIMPLE for r=0.1 class 1.0 = 0.936 +- 0.267 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.1 all KL = 0.867 +- 0.267 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.1 all L1 = 0.936 +- 0.145 (in-sample avg dev_std = 0.331)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9812202166064982
len(reference) = 276
Effective ratio: 0.103 +- 0.116
Model Accuracy over intervened graphs for r=0.25 =  0.968
SUFF_SIMPLE for r=0.25 class 1.0 = 0.948 +- 0.251 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.25 all KL = 0.886 +- 0.251 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.25 all L1 = 0.948 +- 0.121 (in-sample avg dev_std = 0.331)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7898808664259929
len(reference) = 277
Effective ratio: 0.057 +- 0.051
Model Accuracy over intervened graphs for r=0.6 =  0.974
SUFF_SIMPLE for r=0.6 class 1.0 = 0.958 +- 0.227 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.6 all KL = 0.904 +- 0.227 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.6 all L1 = 0.958 +- 0.107 (in-sample avg dev_std = 0.300)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.94
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7831559523809524
len(reference) = 2520
Effective ratio: 0.080 +- 0.024
Model Accuracy over intervened graphs for r=0.01 =  0.932
SUFF_SIMPLE for r=0.01 class 1.0 = 0.986 +- 0.128 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.01 all KL = 0.971 +- 0.128 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.01 all L1 = 0.986 +- 0.057 (in-sample avg dev_std = 0.167)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9343480158730157
len(reference) = 2520
Effective ratio: 0.018 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.927
SUFF_SIMPLE for r=0.1 class 1.0 = 0.978 +- 0.158 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.1 all KL = 0.954 +- 0.158 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.1 all L1 = 0.978 +- 0.071 (in-sample avg dev_std = 0.211)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.94
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9764575396825398
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.925
SUFF_SIMPLE for r=0.25 class 1.0 = 0.975 +- 0.167 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.25 all KL = 0.947 +- 0.167 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.25 all L1 = 0.975 +- 0.075 (in-sample avg dev_std = 0.224)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8164583333333333
len(reference) = 2520
Effective ratio: 0.008 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.928
SUFF_SIMPLE for r=0.6 class 1.0 = 0.979 +- 0.152 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.6 all KL = 0.955 +- 0.152 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.6 all L1 = 0.979 +- 0.067 (in-sample avg dev_std = 0.204)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8909145056726094
len(reference) = 1937
Effective ratio: 0.282 +- 0.408
Model Accuracy over intervened graphs for r=0.01 =  0.985
SUFF_SIMPLE for r=0.01 class 1.0 = 0.982 +- 0.151 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.01 all KL = 0.969 +- 0.151 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.01 all L1 = 0.982 +- 0.099 (in-sample avg dev_std = 0.143)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8942106969205834
len(reference) = 2093
Effective ratio: 0.224 +- 0.366
Model Accuracy over intervened graphs for r=0.1 =  0.983
SUFF_SIMPLE for r=0.1 class 1.0 = 0.981 +- 0.154 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.1 all KL = 0.967 +- 0.154 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.1 all L1 = 0.981 +- 0.101 (in-sample avg dev_std = 0.152)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.991
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8938026742301458
len(reference) = 2208
Effective ratio: 0.179 +- 0.322
Model Accuracy over intervened graphs for r=0.25 =  0.987
SUFF_SIMPLE for r=0.25 class 1.0 = 0.985 +- 0.135 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.25 all KL = 0.976 +- 0.135 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.25 all L1 = 0.985 +- 0.095 (in-sample avg dev_std = 0.120)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.982
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8421628849270667
len(reference) = 2460
Effective ratio: 0.078 +- 0.144
Model Accuracy over intervened graphs for r=0.6 =  0.996
SUFF_SIMPLE for r=0.6 class 1.0 = 0.979 +- 0.158 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.6 all KL = 0.97 +- 0.158 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.6 all L1 = 0.979 +- 0.123 (in-sample avg dev_std = 0.107)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8053718411552346
len(reference) = 277
Effective ratio: 0.415 +- 0.281
Model Accuracy over intervened graphs for r=0.01 =  0.665
NEC for r=0.01 class 1.0 = 0.386 +- 0.377 (in-sample avg dev_std = 0.702)
NEC for r=0.01 all KL = 0.613 +- 0.377 (in-sample avg dev_std = 0.702)
NEC for r=0.01 all L1 = 0.386 +- 0.299 (in-sample avg dev_std = 0.702)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9186462093862816
len(reference) = 277
Effective ratio: 0.159 +- 0.187
Model Accuracy over intervened graphs for r=0.1 =  0.022
NEC for r=0.1 class 1.0 = 0.847 +- 0.092 (in-sample avg dev_std = 0.140)
NEC for r=0.1 all KL = 0.986 +- 0.092 (in-sample avg dev_std = 0.140)
NEC for r=0.1 all L1 = 0.847 +- 0.096 (in-sample avg dev_std = 0.140)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9812202166064982
len(reference) = 277
Effective ratio: 0.103 +- 0.116
Model Accuracy over intervened graphs for r=0.25 =  0.003
NEC for r=0.25 class 1.0 = 0.861 +- 0.014 (in-sample avg dev_std = 0.055)
NEC for r=0.25 all KL = 0.997 +- 0.014 (in-sample avg dev_std = 0.055)
NEC for r=0.25 all L1 = 0.861 +- 0.028 (in-sample avg dev_std = 0.055)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7898808664259929
len(reference) = 277
Effective ratio: 0.057 +- 0.051
Model Accuracy over intervened graphs for r=0.6 =  0.238
NEC for r=0.6 class 1.0 = 0.664 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.77 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.664 +- 0.358 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.94
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7831559523809524
len(reference) = 2520
Effective ratio: 0.080 +- 0.024
Model Accuracy over intervened graphs for r=0.01 =  0.0
NEC for r=0.01 class 1.0 = 0.824 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.907 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.824 +- 0.084 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9343480158730157
len(reference) = 2520
Effective ratio: 0.018 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.824 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.907 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.824 +- 0.084 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.94
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9764575396825398
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.824 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.907 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.824 +- 0.084 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8164583333333333
len(reference) = 2520
Effective ratio: 0.008 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.193
NEC for r=0.6 class 1.0 = 0.655 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.72 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.655 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.982
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8909145056726094
len(reference) = 2468
Effective ratio: 0.282 +- 0.408
Model Accuracy over intervened graphs for r=0.01 =  0.196
NEC for r=0.01 class 1.0 = 0.721 +- 0.295 (in-sample avg dev_std = 0.301)
NEC for r=0.01 all KL = 0.87 +- 0.295 (in-sample avg dev_std = 0.301)
NEC for r=0.01 all L1 = 0.721 +- 0.287 (in-sample avg dev_std = 0.301)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8942106969205834
len(reference) = 2468
Effective ratio: 0.224 +- 0.366
Model Accuracy over intervened graphs for r=0.1 =  0.144
NEC for r=0.1 class 1.0 = 0.76 +- 0.262 (in-sample avg dev_std = 0.261)
NEC for r=0.1 all KL = 0.904 +- 0.262 (in-sample avg dev_std = 0.261)
NEC for r=0.1 all L1 = 0.76 +- 0.253 (in-sample avg dev_std = 0.261)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.982
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8938026742301458
len(reference) = 2468
Effective ratio: 0.179 +- 0.322
Model Accuracy over intervened graphs for r=0.25 =  0.1
NEC for r=0.25 class 1.0 = 0.785 +- 0.243 (in-sample avg dev_std = 0.208)
NEC for r=0.25 all KL = 0.923 +- 0.243 (in-sample avg dev_std = 0.208)
NEC for r=0.25 all L1 = 0.785 +- 0.229 (in-sample avg dev_std = 0.208)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.982
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8421628849270667
len(reference) = 2468
Effective ratio: 0.078 +- 0.144
Model Accuracy over intervened graphs for r=0.6 =  0.141
NEC for r=0.6 class 1.0 = 0.727 +- 0.360 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.841 +- 0.360 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.727 +- 0.312 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 23:51:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 11:51:07 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 11:51:07 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 11:51:07 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 11:51:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:51:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:51:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:51:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:51:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:51:07 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 11:51:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.919
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.980
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.968
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.952
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.948
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.995
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.989
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.953
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.925
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.932
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.937
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.944


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9191913357400723
len(reference) = 261
Effective ratio: 0.297 +- 0.254
Model Accuracy over intervened graphs for r=0.01 =  0.811
SUFF_SIMPLE for r=0.01 class 1.0 = 0.766 +- 0.427 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.01 all KL = 0.616 +- 0.427 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.01 all L1 = 0.766 +- 0.288 (in-sample avg dev_std = 0.606)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9802851985559566
len(reference) = 276
Effective ratio: 0.103 +- 0.133
Model Accuracy over intervened graphs for r=0.1 =  0.854
SUFF_SIMPLE for r=0.1 class 1.0 = 0.806 +- 0.411 (in-sample avg dev_std = 0.596)
SUFF_SIMPLE for r=0.1 all KL = 0.661 +- 0.411 (in-sample avg dev_std = 0.596)
SUFF_SIMPLE for r=0.1 all L1 = 0.806 +- 0.257 (in-sample avg dev_std = 0.596)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9677581227436821
len(reference) = 277
Effective ratio: 0.075 +- 0.070
Model Accuracy over intervened graphs for r=0.25 =  0.834
SUFF_SIMPLE for r=0.25 class 1.0 = 0.789 +- 0.422 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.25 all KL = 0.649 +- 0.422 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.25 all L1 = 0.789 +- 0.277 (in-sample avg dev_std = 0.599)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9522021660649819
len(reference) = 277
Effective ratio: 0.070 +- 0.054
Model Accuracy over intervened graphs for r=0.6 =  0.85
SUFF_SIMPLE for r=0.6 class 1.0 = 0.803 +- 0.406 (in-sample avg dev_std = 0.589)
SUFF_SIMPLE for r=0.6 all KL = 0.659 +- 0.406 (in-sample avg dev_std = 0.589)
SUFF_SIMPLE for r=0.6 all L1 = 0.803 +- 0.260 (in-sample avg dev_std = 0.589)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9475535714285714
len(reference) = 2520
Effective ratio: 0.041 +- 0.014
Model Accuracy over intervened graphs for r=0.01 =  0.874
SUFF_SIMPLE for r=0.01 class 1.0 = 0.819 +- 0.354 (in-sample avg dev_std = 0.593)
SUFF_SIMPLE for r=0.01 all KL = 0.676 +- 0.354 (in-sample avg dev_std = 0.593)
SUFF_SIMPLE for r=0.01 all L1 = 0.819 +- 0.202 (in-sample avg dev_std = 0.593)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9951130952380952
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.848
SUFF_SIMPLE for r=0.1 class 1.0 = 0.785 +- 0.358 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.1 all KL = 0.621 +- 0.358 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.1 all L1 = 0.785 +- 0.213 (in-sample avg dev_std = 0.642)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9889357142857143
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.847
SUFF_SIMPLE for r=0.25 class 1.0 = 0.783 +- 0.358 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.25 all KL = 0.618 +- 0.358 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.25 all L1 = 0.783 +- 0.211 (in-sample avg dev_std = 0.646)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9528603174603175
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.841
SUFF_SIMPLE for r=0.6 class 1.0 = 0.775 +- 0.359 (in-sample avg dev_std = 0.660)
SUFF_SIMPLE for r=0.6 all KL = 0.6 +- 0.359 (in-sample avg dev_std = 0.660)
SUFF_SIMPLE for r=0.6 all L1 = 0.775 +- 0.211 (in-sample avg dev_std = 0.660)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.996
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9245494327390598
len(reference) = 2044
Effective ratio: 0.256 +- 0.389
Model Accuracy over intervened graphs for r=0.01 =  0.95
SUFF_SIMPLE for r=0.01 class 1.0 = 0.944 +- 0.261 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.01 all KL = 0.911 +- 0.261 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.01 all L1 = 0.944 +- 0.177 (in-sample avg dev_std = 0.269)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9322435170178283
len(reference) = 2238
Effective ratio: 0.180 +- 0.324
Model Accuracy over intervened graphs for r=0.1 =  0.959
SUFF_SIMPLE for r=0.1 class 1.0 = 0.933 +- 0.279 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.1 all KL = 0.902 +- 0.279 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.1 all L1 = 0.933 +- 0.201 (in-sample avg dev_std = 0.271)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.966
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9367629659643436
len(reference) = 2434
Effective ratio: 0.119 +- 0.225
Model Accuracy over intervened graphs for r=0.25 =  0.96
SUFF_SIMPLE for r=0.25 class 1.0 = 0.928 +- 0.289 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.25 all KL = 0.895 +- 0.289 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.25 all L1 = 0.928 +- 0.209 (in-sample avg dev_std = 0.278)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.966
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9444355753646678
len(reference) = 2458
Effective ratio: 0.086 +- 0.154
Model Accuracy over intervened graphs for r=0.6 =  0.963
SUFF_SIMPLE for r=0.6 class 1.0 = 0.924 +- 0.294 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.6 all KL = 0.891 +- 0.294 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.6 all L1 = 0.924 +- 0.216 (in-sample avg dev_std = 0.277)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9191913357400723
len(reference) = 277
Effective ratio: 0.297 +- 0.254
Model Accuracy over intervened graphs for r=0.01 =  0.148
NEC for r=0.01 class 1.0 = 0.792 +- 0.057 (in-sample avg dev_std = 0.572)
NEC for r=0.01 all KL = 0.978 +- 0.057 (in-sample avg dev_std = 0.572)
NEC for r=0.01 all L1 = 0.792 +- 0.126 (in-sample avg dev_std = 0.572)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9802851985559566
len(reference) = 277
Effective ratio: 0.103 +- 0.133
Model Accuracy over intervened graphs for r=0.1 =  0.005
NEC for r=0.1 class 1.0 = 0.86 +- 0.015 (in-sample avg dev_std = 0.095)
NEC for r=0.1 all KL = 0.997 +- 0.015 (in-sample avg dev_std = 0.095)
NEC for r=0.1 all L1 = 0.86 +- 0.032 (in-sample avg dev_std = 0.095)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9677581227436821
len(reference) = 277
Effective ratio: 0.075 +- 0.070
Model Accuracy over intervened graphs for r=0.25 =  0.004
NEC for r=0.25 class 1.0 = 0.86 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.994 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.86 +- 0.052 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9522021660649819
len(reference) = 277
Effective ratio: 0.070 +- 0.054
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.863 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.998 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.863 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9475535714285714
len(reference) = 2520
Effective ratio: 0.041 +- 0.014
Model Accuracy over intervened graphs for r=0.01 =  0.0
NEC for r=0.01 class 1.0 = 0.849 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.955 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.849 +- 0.031 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9951130952380952
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.849 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.955 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.849 +- 0.031 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9889357142857143
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.849 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.955 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.849 +- 0.031 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9528603174603175
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.849 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.955 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.849 +- 0.031 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.966
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9245494327390598
len(reference) = 2468
Effective ratio: 0.256 +- 0.389
Model Accuracy over intervened graphs for r=0.01 =  0.109
NEC for r=0.01 class 1.0 = 0.793 +- 0.157 (in-sample avg dev_std = 0.392)
NEC for r=0.01 all KL = 0.955 +- 0.157 (in-sample avg dev_std = 0.392)
NEC for r=0.01 all L1 = 0.793 +- 0.177 (in-sample avg dev_std = 0.392)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.966
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9322435170178283
len(reference) = 2468
Effective ratio: 0.180 +- 0.324
Model Accuracy over intervened graphs for r=0.1 =  0.084
NEC for r=0.1 class 1.0 = 0.795 +- 0.202 (in-sample avg dev_std = 0.304)
NEC for r=0.1 all KL = 0.943 +- 0.202 (in-sample avg dev_std = 0.304)
NEC for r=0.1 all L1 = 0.795 +- 0.197 (in-sample avg dev_std = 0.304)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.966
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9367629659643436
len(reference) = 2468
Effective ratio: 0.119 +- 0.225
Model Accuracy over intervened graphs for r=0.25 =  0.075
NEC for r=0.25 class 1.0 = 0.781 +- 0.285 (in-sample avg dev_std = 0.104)
NEC for r=0.25 all KL = 0.905 +- 0.285 (in-sample avg dev_std = 0.104)
NEC for r=0.25 all L1 = 0.781 +- 0.248 (in-sample avg dev_std = 0.104)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.966
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9444355753646678
len(reference) = 2468
Effective ratio: 0.086 +- 0.154
Model Accuracy over intervened graphs for r=0.6 =  0.007
NEC for r=0.6 class 1.0 = 0.829 +- 0.194 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.958 +- 0.194 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.829 +- 0.167 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Nov  2 23:56:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/02/2024 11:56:16 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/02/2024 11:56:16 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/02/2024 11:56:16 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/02/2024 11:56:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:56:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:56:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:56:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/02/2024 11:56:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/02/2024 11:56:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/02/2024 11:56:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.722
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.838
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.966
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.888
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.511
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.679
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.924
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.914
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.887
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.894
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.893
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.879


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7215162454873647
len(reference) = 252
Effective ratio: 0.516 +- 0.237
Model Accuracy over intervened graphs for r=0.01 =  0.933
SUFF_SIMPLE for r=0.01 class 1.0 = 0.917 +- 0.287 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.01 all KL = 0.866 +- 0.287 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.01 all L1 = 0.917 +- 0.194 (in-sample avg dev_std = 0.348)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8380541516245488
len(reference) = 272
Effective ratio: 0.196 +- 0.183
Model Accuracy over intervened graphs for r=0.1 =  0.947
SUFF_SIMPLE for r=0.1 class 1.0 = 0.928 +- 0.269 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.1 all KL = 0.879 +- 0.269 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.1 all L1 = 0.928 +- 0.173 (in-sample avg dev_std = 0.351)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9659061371841154
len(reference) = 276
Effective ratio: 0.108 +- 0.111
Model Accuracy over intervened graphs for r=0.25 =  0.952
SUFF_SIMPLE for r=0.25 class 1.0 = 0.928 +- 0.260 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.25 all KL = 0.868 +- 0.260 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.25 all L1 = 0.928 +- 0.153 (in-sample avg dev_std = 0.372)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8875487364620939
len(reference) = 277
Effective ratio: 0.072 +- 0.062
Model Accuracy over intervened graphs for r=0.6 =  0.938
SUFF_SIMPLE for r=0.6 class 1.0 = 0.911 +- 0.286 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.6 all KL = 0.844 +- 0.286 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.6 all L1 = 0.911 +- 0.177 (in-sample avg dev_std = 0.409)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.638
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.5114269841269842
len(reference) = 2520
Effective ratio: 0.203 +- 0.052
Model Accuracy over intervened graphs for r=0.01 =  0.675
SUFF_SIMPLE for r=0.01 class 1.0 = 0.956 +- 0.205 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.01 all KL = 0.946 +- 0.205 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.01 all L1 = 0.956 +- 0.173 (in-sample avg dev_std = 0.119)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6792698412698414
len(reference) = 2520
Effective ratio: 0.047 +- 0.015
Model Accuracy over intervened graphs for r=0.1 =  0.664
SUFF_SIMPLE for r=0.1 class 1.0 = 0.939 +- 0.231 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.1 all KL = 0.918 +- 0.231 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.1 all L1 = 0.939 +- 0.182 (in-sample avg dev_std = 0.225)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.638
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9241452380952381
len(reference) = 2520
Effective ratio: 0.016 +- 0.004
Model Accuracy over intervened graphs for r=0.25 =  0.65
SUFF_SIMPLE for r=0.25 class 1.0 = 0.923 +- 0.256 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.25 all KL = 0.89 +- 0.256 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.25 all L1 = 0.923 +- 0.191 (in-sample avg dev_std = 0.299)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.638
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9141051587301587
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.644
SUFF_SIMPLE for r=0.6 class 1.0 = 0.915 +- 0.265 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.6 all KL = 0.879 +- 0.265 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.6 all L1 = 0.915 +- 0.198 (in-sample avg dev_std = 0.321)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8865717179902756
len(reference) = 1932
Effective ratio: 0.295 +- 0.412
Model Accuracy over intervened graphs for r=0.01 =  0.987
SUFF_SIMPLE for r=0.01 class 1.0 = 0.987 +- 0.123 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.01 all KL = 0.979 +- 0.123 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.01 all L1 = 0.987 +- 0.090 (in-sample avg dev_std = 0.108)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8935611831442465
len(reference) = 2080
Effective ratio: 0.231 +- 0.371
Model Accuracy over intervened graphs for r=0.1 =  0.988
SUFF_SIMPLE for r=0.1 class 1.0 = 0.987 +- 0.118 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.1 all KL = 0.981 +- 0.118 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.1 all L1 = 0.987 +- 0.089 (in-sample avg dev_std = 0.102)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.997
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.893347244732577
len(reference) = 2199
Effective ratio: 0.186 +- 0.326
Model Accuracy over intervened graphs for r=0.25 =  0.987
SUFF_SIMPLE for r=0.25 class 1.0 = 0.986 +- 0.124 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.25 all KL = 0.977 +- 0.124 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.25 all L1 = 0.986 +- 0.081 (in-sample avg dev_std = 0.136)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8794254457050245
len(reference) = 2417
Effective ratio: 0.110 +- 0.216
Model Accuracy over intervened graphs for r=0.6 =  0.996
SUFF_SIMPLE for r=0.6 class 1.0 = 0.981 +- 0.144 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.6 all KL = 0.973 +- 0.144 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.6 all L1 = 0.981 +- 0.109 (in-sample avg dev_std = 0.123)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7215162454873647
len(reference) = 277
Effective ratio: 0.516 +- 0.237
Model Accuracy over intervened graphs for r=0.01 =  0.766
NEC for r=0.01 class 1.0 = 0.302 +- 0.350 (in-sample avg dev_std = 0.704)
NEC for r=0.01 all KL = 0.493 +- 0.350 (in-sample avg dev_std = 0.704)
NEC for r=0.01 all L1 = 0.302 +- 0.255 (in-sample avg dev_std = 0.704)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8380541516245488
len(reference) = 277
Effective ratio: 0.196 +- 0.183
Model Accuracy over intervened graphs for r=0.1 =  0.046
NEC for r=0.1 class 1.0 = 0.835 +- 0.080 (in-sample avg dev_std = 0.286)
NEC for r=0.1 all KL = 0.978 +- 0.080 (in-sample avg dev_std = 0.286)
NEC for r=0.1 all L1 = 0.835 +- 0.099 (in-sample avg dev_std = 0.286)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9659061371841154
len(reference) = 277
Effective ratio: 0.108 +- 0.111
Model Accuracy over intervened graphs for r=0.25 =  0.003
NEC for r=0.25 class 1.0 = 0.859 +- 0.018 (in-sample avg dev_std = 0.055)
NEC for r=0.25 all KL = 0.991 +- 0.018 (in-sample avg dev_std = 0.055)
NEC for r=0.25 all L1 = 0.859 +- 0.028 (in-sample avg dev_std = 0.055)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8875487364620939
len(reference) = 277
Effective ratio: 0.072 +- 0.062
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.86 +- 0.007 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.992 +- 0.007 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.86 +- 0.001 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.638
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.5114269841269842
len(reference) = 2520
Effective ratio: 0.203 +- 0.052
Model Accuracy over intervened graphs for r=0.01 =  0.098
NEC for r=0.01 class 1.0 = 0.542 +- 0.435 (in-sample avg dev_std = 0.467)
NEC for r=0.01 all KL = 0.637 +- 0.435 (in-sample avg dev_std = 0.467)
NEC for r=0.01 all L1 = 0.542 +- 0.359 (in-sample avg dev_std = 0.467)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6792698412698414
len(reference) = 2520
Effective ratio: 0.047 +- 0.015
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.569 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.636 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.569 +- 0.385 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.638
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9241452380952381
len(reference) = 2520
Effective ratio: 0.016 +- 0.004
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.569 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.636 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.569 +- 0.385 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.638
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9141051587301587
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.569 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.636 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.569 +- 0.385 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.987
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8865717179902756
len(reference) = 2468
Effective ratio: 0.295 +- 0.412
Model Accuracy over intervened graphs for r=0.01 =  0.204
NEC for r=0.01 class 1.0 = 0.71 +- 0.305 (in-sample avg dev_std = 0.302)
NEC for r=0.01 all KL = 0.849 +- 0.305 (in-sample avg dev_std = 0.302)
NEC for r=0.01 all L1 = 0.71 +- 0.292 (in-sample avg dev_std = 0.302)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8935611831442465
len(reference) = 2468
Effective ratio: 0.231 +- 0.371
Model Accuracy over intervened graphs for r=0.1 =  0.147
NEC for r=0.1 class 1.0 = 0.752 +- 0.272 (in-sample avg dev_std = 0.250)
NEC for r=0.1 all KL = 0.887 +- 0.272 (in-sample avg dev_std = 0.250)
NEC for r=0.1 all L1 = 0.752 +- 0.258 (in-sample avg dev_std = 0.250)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.987
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.893347244732577
len(reference) = 2468
Effective ratio: 0.186 +- 0.326
Model Accuracy over intervened graphs for r=0.25 =  0.105
NEC for r=0.25 class 1.0 = 0.783 +- 0.238 (in-sample avg dev_std = 0.206)
NEC for r=0.25 all KL = 0.916 +- 0.238 (in-sample avg dev_std = 0.206)
NEC for r=0.25 all L1 = 0.783 +- 0.225 (in-sample avg dev_std = 0.206)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8794254457050245
len(reference) = 2468
Effective ratio: 0.110 +- 0.216
Model Accuracy over intervened graphs for r=0.6 =  0.036
NEC for r=0.6 class 1.0 = 0.821 +- 0.187 (in-sample avg dev_std = 0.113)
NEC for r=0.6 all KL = 0.95 +- 0.187 (in-sample avg dev_std = 0.113)
NEC for r=0.6 all L1 = 0.821 +- 0.170 (in-sample avg dev_std = 0.113)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 00:01:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 12:01:20 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 12:01:20 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 12:01:20 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 12:01:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:01:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:01:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:01:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:01:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:01:20 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 12:01:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.984
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.990
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.987
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.974
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.978
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.994
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.993
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.984
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.955
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.954
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.954
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.941


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9839819494584837
len(reference) = 276
Effective ratio: 0.123 +- 0.102
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9896895306859206
len(reference) = 276
Effective ratio: 0.095 +- 0.095
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9865451263537907
len(reference) = 276
Effective ratio: 0.092 +- 0.095
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9738989169675092
len(reference) = 276
Effective ratio: 0.089 +- 0.090
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.731
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9777166666666667
len(reference) = 2520
Effective ratio: 0.022 +- 0.007
Model Accuracy over intervened graphs for r=0.01 =  0.731
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9936079365079364
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.731
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.731
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9926206349206349
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.73
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.005 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.005 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.009)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.731
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9842785714285712
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.73
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.012 (in-sample avg dev_std = 0.018)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.012 (in-sample avg dev_std = 0.018)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.006 (in-sample avg dev_std = 0.018)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.954978525121556
len(reference) = 2236
Effective ratio: 0.181 +- 0.312
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9542390599675851
len(reference) = 2336
Effective ratio: 0.142 +- 0.261
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9541871961102106
len(reference) = 2433
Effective ratio: 0.129 +- 0.234
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9410628038897891
len(reference) = 2443
Effective ratio: 0.121 +- 0.219
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9839819494584837
len(reference) = 277
Effective ratio: 0.123 +- 0.102
Model Accuracy over intervened graphs for r=0.01 =  0.003
NEC for r=0.01 class 1.0 = 0.859 +- 0.017 (in-sample avg dev_std = 0.055)
NEC for r=0.01 all KL = 0.989 +- 0.017 (in-sample avg dev_std = 0.055)
NEC for r=0.01 all L1 = 0.859 +- 0.028 (in-sample avg dev_std = 0.055)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9896895306859206
len(reference) = 277
Effective ratio: 0.095 +- 0.095
Model Accuracy over intervened graphs for r=0.1 =  0.002
NEC for r=0.1 class 1.0 = 0.86 +- 0.011 (in-sample avg dev_std = 0.060)
NEC for r=0.1 all KL = 0.99 +- 0.011 (in-sample avg dev_std = 0.060)
NEC for r=0.1 all L1 = 0.86 +- 0.021 (in-sample avg dev_std = 0.060)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9865451263537907
len(reference) = 277
Effective ratio: 0.092 +- 0.095
Model Accuracy over intervened graphs for r=0.25 =  0.002
NEC for r=0.25 class 1.0 = 0.86 +- 0.012 (in-sample avg dev_std = 0.059)
NEC for r=0.25 all KL = 0.99 +- 0.012 (in-sample avg dev_std = 0.059)
NEC for r=0.25 all L1 = 0.86 +- 0.021 (in-sample avg dev_std = 0.059)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9738989169675092
len(reference) = 277
Effective ratio: 0.089 +- 0.090
Model Accuracy over intervened graphs for r=0.6 =  0.001
NEC for r=0.6 class 1.0 = 0.86 +- 0.008 (in-sample avg dev_std = 0.060)
NEC for r=0.6 all KL = 0.99 +- 0.008 (in-sample avg dev_std = 0.060)
NEC for r=0.6 all L1 = 0.86 +- 0.010 (in-sample avg dev_std = 0.060)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.731
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9777166666666667
len(reference) = 2520
Effective ratio: 0.022 +- 0.007
Model Accuracy over intervened graphs for r=0.01 =  0.0
NEC for r=0.01 class 1.0 = 0.704 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.759 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.704 +- 0.259 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9936079365079364
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.704 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.759 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.704 +- 0.259 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.731
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9926206349206349
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.704 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.759 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.704 +- 0.259 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.731
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9842785714285712
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.704 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.759 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.704 +- 0.259 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.954978525121556
len(reference) = 2468
Effective ratio: 0.181 +- 0.312
Model Accuracy over intervened graphs for r=0.01 =  0.034
NEC for r=0.01 class 1.0 = 0.843 +- 0.067 (in-sample avg dev_std = 0.269)
NEC for r=0.01 all KL = 0.98 +- 0.067 (in-sample avg dev_std = 0.269)
NEC for r=0.01 all L1 = 0.843 +- 0.078 (in-sample avg dev_std = 0.269)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9542390599675851
len(reference) = 2468
Effective ratio: 0.142 +- 0.261
Model Accuracy over intervened graphs for r=0.1 =  0.021
NEC for r=0.1 class 1.0 = 0.85 +- 0.043 (in-sample avg dev_std = 0.208)
NEC for r=0.1 all KL = 0.984 +- 0.043 (in-sample avg dev_std = 0.208)
NEC for r=0.1 all L1 = 0.85 +- 0.060 (in-sample avg dev_std = 0.208)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9541871961102106
len(reference) = 2468
Effective ratio: 0.129 +- 0.234
Model Accuracy over intervened graphs for r=0.25 =  0.016
NEC for r=0.25 class 1.0 = 0.852 +- 0.066 (in-sample avg dev_std = 0.131)
NEC for r=0.25 all KL = 0.982 +- 0.066 (in-sample avg dev_std = 0.131)
NEC for r=0.25 all L1 = 0.852 +- 0.065 (in-sample avg dev_std = 0.131)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9410628038897891
len(reference) = 2468
Effective ratio: 0.121 +- 0.219
Model Accuracy over intervened graphs for r=0.6 =  0.021
NEC for r=0.6 class 1.0 = 0.848 +- 0.093 (in-sample avg dev_std = 0.117)
NEC for r=0.6 all KL = 0.977 +- 0.093 (in-sample avg dev_std = 0.117)
NEC for r=0.6 all L1 = 0.848 +- 0.086 (in-sample avg dev_std = 0.117)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 00:06:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 12:06:37 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 12:06:37 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 12:06:37 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 12:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:06:37 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 12:06:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.883
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.968
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.982
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.915
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.564
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.801
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.972
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.896
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.923
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.924
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.915
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.900


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.882667870036101
len(reference) = 268
Effective ratio: 0.309 +- 0.208
Model Accuracy over intervened graphs for r=0.01 =  0.458
SUFF_SIMPLE for r=0.01 class 1.0 = 0.443 +- 0.410 (in-sample avg dev_std = 0.712)
SUFF_SIMPLE for r=0.01 all KL = 0.253 +- 0.410 (in-sample avg dev_std = 0.712)
SUFF_SIMPLE for r=0.01 all L1 = 0.443 +- 0.331 (in-sample avg dev_std = 0.712)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.968173285198556
len(reference) = 276
Effective ratio: 0.116 +- 0.117
Model Accuracy over intervened graphs for r=0.1 =  0.462
SUFF_SIMPLE for r=0.1 class 1.0 = 0.427 +- 0.377 (in-sample avg dev_std = 0.792)
SUFF_SIMPLE for r=0.1 all KL = 0.209 +- 0.377 (in-sample avg dev_std = 0.792)
SUFF_SIMPLE for r=0.1 all L1 = 0.427 +- 0.301 (in-sample avg dev_std = 0.792)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9815234657039711
len(reference) = 277
Effective ratio: 0.092 +- 0.087
Model Accuracy over intervened graphs for r=0.25 =  0.503
SUFF_SIMPLE for r=0.25 class 1.0 = 0.455 +- 0.393 (in-sample avg dev_std = 0.804)
SUFF_SIMPLE for r=0.25 all KL = 0.235 +- 0.393 (in-sample avg dev_std = 0.804)
SUFF_SIMPLE for r=0.25 all L1 = 0.455 +- 0.306 (in-sample avg dev_std = 0.804)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9152202166064982
len(reference) = 277
Effective ratio: 0.078 +- 0.075
Model Accuracy over intervened graphs for r=0.6 =  0.515
SUFF_SIMPLE for r=0.6 class 1.0 = 0.463 +- 0.398 (in-sample avg dev_std = 0.818)
SUFF_SIMPLE for r=0.6 all KL = 0.24 +- 0.398 (in-sample avg dev_std = 0.818)
SUFF_SIMPLE for r=0.6 all L1 = 0.463 +- 0.304 (in-sample avg dev_std = 0.818)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.768
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.5641690476190476
len(reference) = 2520
Effective ratio: 0.193 +- 0.055
Model Accuracy over intervened graphs for r=0.01 =  0.218
SUFF_SIMPLE for r=0.01 class 1.0 = 0.371 +- 0.318 (in-sample avg dev_std = 0.626)
SUFF_SIMPLE for r=0.01 all KL = 0.267 +- 0.318 (in-sample avg dev_std = 0.626)
SUFF_SIMPLE for r=0.01 all L1 = 0.371 +- 0.249 (in-sample avg dev_std = 0.626)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8012515873015873
len(reference) = 2520
Effective ratio: 0.033 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.15
SUFF_SIMPLE for r=0.1 class 1.0 = 0.329 +- 0.302 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.1 all KL = 0.232 +- 0.302 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.1 all L1 = 0.329 +- 0.233 (in-sample avg dev_std = 0.600)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.768
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9720202380952381
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.118
SUFF_SIMPLE for r=0.25 class 1.0 = 0.326 +- 0.316 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.25 all KL = 0.237 +- 0.316 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.25 all L1 = 0.326 +- 0.246 (in-sample avg dev_std = 0.556)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.768
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.895943253968254
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.122
SUFF_SIMPLE for r=0.6 class 1.0 = 0.325 +- 0.312 (in-sample avg dev_std = 0.560)
SUFF_SIMPLE for r=0.6 all KL = 0.235 +- 0.312 (in-sample avg dev_std = 0.560)
SUFF_SIMPLE for r=0.6 all L1 = 0.325 +- 0.242 (in-sample avg dev_std = 0.560)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.994
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9226758508914099
len(reference) = 2033
Effective ratio: 0.248 +- 0.383
Model Accuracy over intervened graphs for r=0.01 =  0.83
SUFF_SIMPLE for r=0.01 class 1.0 = 0.819 +- 0.416 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.01 all KL = 0.741 +- 0.416 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.01 all L1 = 0.819 +- 0.308 (in-sample avg dev_std = 0.414)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.985
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9243221231766612
len(reference) = 2174
Effective ratio: 0.193 +- 0.335
Model Accuracy over intervened graphs for r=0.1 =  0.846
SUFF_SIMPLE for r=0.1 class 1.0 = 0.833 +- 0.405 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.1 all KL = 0.758 +- 0.405 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.1 all L1 = 0.833 +- 0.298 (in-sample avg dev_std = 0.391)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.975
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9154955429497568
len(reference) = 2297
Effective ratio: 0.154 +- 0.288
Model Accuracy over intervened graphs for r=0.25 =  0.862
SUFF_SIMPLE for r=0.25 class 1.0 = 0.856 +- 0.385 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.25 all KL = 0.79 +- 0.385 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.25 all L1 = 0.856 +- 0.278 (in-sample avg dev_std = 0.376)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.962
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8997536466774715
len(reference) = 2397
Effective ratio: 0.117 +- 0.228
Model Accuracy over intervened graphs for r=0.6 =  0.896
SUFF_SIMPLE for r=0.6 class 1.0 = 0.893 +- 0.349 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.6 all KL = 0.83 +- 0.349 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.6 all L1 = 0.893 +- 0.229 (in-sample avg dev_std = 0.374)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.882667870036101
len(reference) = 277
Effective ratio: 0.309 +- 0.208
Model Accuracy over intervened graphs for r=0.01 =  0.161
NEC for r=0.01 class 1.0 = 0.793 +- 0.064 (in-sample avg dev_std = 0.635)
NEC for r=0.01 all KL = 0.987 +- 0.064 (in-sample avg dev_std = 0.635)
NEC for r=0.01 all L1 = 0.793 +- 0.110 (in-sample avg dev_std = 0.635)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.968173285198556
len(reference) = 277
Effective ratio: 0.116 +- 0.117
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.864 +- 0.001 (in-sample avg dev_std = 0.042)
NEC for r=0.1 all KL = 0.999 +- 0.001 (in-sample avg dev_std = 0.042)
NEC for r=0.1 all L1 = 0.864 +- 0.002 (in-sample avg dev_std = 0.042)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9815234657039711
len(reference) = 277
Effective ratio: 0.092 +- 0.087
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.864 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.999 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.864 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9152202166064982
len(reference) = 277
Effective ratio: 0.078 +- 0.075
Model Accuracy over intervened graphs for r=0.6 =  0.065
NEC for r=0.6 class 1.0 = 0.808 +- 0.244 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.935 +- 0.244 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.808 +- 0.211 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.768
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.5641690476190476
len(reference) = 2520
Effective ratio: 0.193 +- 0.055
Model Accuracy over intervened graphs for r=0.01 =  0.014
NEC for r=0.01 class 1.0 = 0.701 +- 0.338 (in-sample avg dev_std = 0.167)
NEC for r=0.01 all KL = 0.762 +- 0.338 (in-sample avg dev_std = 0.167)
NEC for r=0.01 all L1 = 0.701 +- 0.272 (in-sample avg dev_std = 0.167)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8012515873015873
len(reference) = 2520
Effective ratio: 0.033 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.696 +- 0.356 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.75 +- 0.356 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.696 +- 0.285 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.768
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9720202380952381
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.696 +- 0.356 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.75 +- 0.356 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.696 +- 0.285 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.768
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.895943253968254
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.112
NEC for r=0.6 class 1.0 = 0.613 +- 0.408 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.655 +- 0.408 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.613 +- 0.338 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.947
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9226758508914099
len(reference) = 2468
Effective ratio: 0.248 +- 0.383
Model Accuracy over intervened graphs for r=0.01 =  0.031
NEC for r=0.01 class 1.0 = 0.824 +- 0.148 (in-sample avg dev_std = 0.289)
NEC for r=0.01 all KL = 0.966 +- 0.148 (in-sample avg dev_std = 0.289)
NEC for r=0.01 all L1 = 0.824 +- 0.144 (in-sample avg dev_std = 0.289)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.947
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9243221231766612
len(reference) = 2468
Effective ratio: 0.193 +- 0.335
Model Accuracy over intervened graphs for r=0.1 =  0.026
NEC for r=0.1 class 1.0 = 0.824 +- 0.162 (in-sample avg dev_std = 0.257)
NEC for r=0.1 all KL = 0.962 +- 0.162 (in-sample avg dev_std = 0.257)
NEC for r=0.1 all L1 = 0.824 +- 0.151 (in-sample avg dev_std = 0.257)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.947
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9154955429497568
len(reference) = 2468
Effective ratio: 0.154 +- 0.288
Model Accuracy over intervened graphs for r=0.25 =  0.017
NEC for r=0.25 class 1.0 = 0.827 +- 0.171 (in-sample avg dev_std = 0.205)
NEC for r=0.25 all KL = 0.961 +- 0.171 (in-sample avg dev_std = 0.205)
NEC for r=0.25 all L1 = 0.827 +- 0.153 (in-sample avg dev_std = 0.205)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.947
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8997536466774715
len(reference) = 2468
Effective ratio: 0.117 +- 0.228
Model Accuracy over intervened graphs for r=0.6 =  0.031
NEC for r=0.6 class 1.0 = 0.813 +- 0.219 (in-sample avg dev_std = 0.149)
NEC for r=0.6 all KL = 0.941 +- 0.219 (in-sample avg dev_std = 0.149)
NEC for r=0.6 all L1 = 0.813 +- 0.190 (in-sample avg dev_std = 0.149)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.961, 0.967, 0.973, 0.985], 'all_L1': [0.982, 0.985, 0.988, 0.994]}), defaultdict(<class 'list'>, {'all_KL': [0.985, 0.979, 0.988, 0.989], 'all_L1': [0.991, 0.988, 0.994, 0.995]}), defaultdict(<class 'list'>, {'all_KL': [0.753, 0.73, 0.741, 0.748], 'all_L1': [0.85, 0.841, 0.846, 0.852]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.864, 0.867, 0.886, 0.904], 'all_L1': [0.932, 0.936, 0.948, 0.958]}), defaultdict(<class 'list'>, {'all_KL': [0.616, 0.661, 0.649, 0.659], 'all_L1': [0.766, 0.806, 0.789, 0.803]}), defaultdict(<class 'list'>, {'all_KL': [0.866, 0.879, 0.868, 0.844], 'all_L1': [0.917, 0.928, 0.928, 0.911]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.253, 0.209, 0.235, 0.24], 'all_L1': [0.443, 0.427, 0.455, 0.463]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.997, 0.999, 0.643, 0.002], 'all_L1': [0.862, 0.864, 0.526, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.363, 0.975, 0.999, 0.977], 'all_L1': [0.193, 0.84, 0.864, 0.845]}), defaultdict(<class 'list'>, {'all_KL': [0.394, 0.986, 0.995, 0.996], 'all_L1': [0.23, 0.849, 0.861, 0.863]}), defaultdict(<class 'list'>, {'all_KL': [0.89, 0.989, 0.969, 0.014], 'all_L1': [0.734, 0.86, 0.842, 0.012]}), defaultdict(<class 'list'>, {'all_KL': [0.991, 0.998, 0.998, 0.571], 'all_L1': [0.853, 0.864, 0.864, 0.487]}), defaultdict(<class 'list'>, {'all_KL': [0.613, 0.986, 0.997, 0.77], 'all_L1': [0.386, 0.847, 0.861, 0.664]}), defaultdict(<class 'list'>, {'all_KL': [0.978, 0.997, 0.994, 0.998], 'all_L1': [0.792, 0.86, 0.86, 0.863]}), defaultdict(<class 'list'>, {'all_KL': [0.493, 0.978, 0.991, 0.992], 'all_L1': [0.302, 0.835, 0.859, 0.86]}), defaultdict(<class 'list'>, {'all_KL': [0.989, 0.99, 0.99, 0.99], 'all_L1': [0.859, 0.86, 0.86, 0.86]}), defaultdict(<class 'list'>, {'all_KL': [0.987, 0.999, 0.999, 0.935], 'all_L1': [0.793, 0.864, 0.864, 0.808]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 0.998, 0.998, 0.998], 'all_L1': [1.0, 0.999, 0.999, 0.999]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.963, 0.923, 0.923, 0.917], 'all_L1': [0.977, 0.955, 0.955, 0.952]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.971, 0.954, 0.947, 0.955], 'all_L1': [0.986, 0.978, 0.975, 0.979]}), defaultdict(<class 'list'>, {'all_KL': [0.676, 0.621, 0.618, 0.6], 'all_L1': [0.819, 0.785, 0.783, 0.775]}), defaultdict(<class 'list'>, {'all_KL': [0.946, 0.918, 0.89, 0.879], 'all_L1': [0.956, 0.939, 0.923, 0.915]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.267, 0.232, 0.237, 0.235], 'all_L1': [0.371, 0.329, 0.326, 0.325]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.962, 0.961, 0.595, 0.007], 'all_L1': [0.852, 0.852, 0.52, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.958, 0.995, 0.995, 0.949], 'all_L1': [0.831, 0.863, 0.863, 0.822]}), defaultdict(<class 'list'>, {'all_KL': [0.856, 0.856, 0.856, 0.856], 'all_L1': [0.776, 0.776, 0.776, 0.776]}), defaultdict(<class 'list'>, {'all_KL': [0.78, 0.78, 0.78, 0.014], 'all_L1': [0.729, 0.729, 0.729, 0.014]}), defaultdict(<class 'list'>, {'all_KL': [0.874, 0.874, 0.874, 0.525], 'all_L1': [0.802, 0.802, 0.802, 0.489]}), defaultdict(<class 'list'>, {'all_KL': [0.907, 0.907, 0.907, 0.72], 'all_L1': [0.824, 0.824, 0.824, 0.655]}), defaultdict(<class 'list'>, {'all_KL': [0.955, 0.955, 0.955, 0.955], 'all_L1': [0.849, 0.849, 0.849, 0.849]}), defaultdict(<class 'list'>, {'all_KL': [0.637, 0.636, 0.636, 0.636], 'all_L1': [0.542, 0.569, 0.569, 0.569]}), defaultdict(<class 'list'>, {'all_KL': [0.759, 0.759, 0.759, 0.759], 'all_L1': [0.704, 0.704, 0.704, 0.704]}), defaultdict(<class 'list'>, {'all_KL': [0.762, 0.75, 0.75, 0.655], 'all_L1': [0.701, 0.696, 0.696, 0.613]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 0.989], 'all_L1': [1.0, 1.0, 1.0, 0.994]}), defaultdict(<class 'list'>, {'all_KL': [0.996, 0.996, 0.998, 0.997], 'all_L1': [0.998, 0.998, 0.999, 0.998]}), defaultdict(<class 'list'>, {'all_KL': [0.995, 0.995, 0.995, 0.99], 'all_L1': [0.996, 0.996, 0.996, 0.992]}), defaultdict(<class 'list'>, {'all_KL': [0.964, 0.969, 0.972, 0.941], 'all_L1': [0.975, 0.979, 0.979, 0.958]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.969, 0.967, 0.976, 0.97], 'all_L1': [0.982, 0.981, 0.985, 0.979]}), defaultdict(<class 'list'>, {'all_KL': [0.911, 0.902, 0.895, 0.891], 'all_L1': [0.944, 0.933, 0.928, 0.924]}), defaultdict(<class 'list'>, {'all_KL': [0.979, 0.981, 0.977, 0.973], 'all_L1': [0.987, 0.987, 0.986, 0.981]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.741, 0.758, 0.79, 0.83], 'all_L1': [0.819, 0.833, 0.856, 0.893]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.909, 0.942, 0.575, 0.002], 'all_L1': [0.774, 0.811, 0.49, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.882, 0.905, 0.935, 0.965], 'all_L1': [0.731, 0.759, 0.797, 0.834]}), defaultdict(<class 'list'>, {'all_KL': [0.86, 0.901, 0.935, 0.978], 'all_L1': [0.715, 0.762, 0.801, 0.848]}), defaultdict(<class 'list'>, {'all_KL': [0.893, 0.924, 0.925, 0.12], 'all_L1': [0.763, 0.797, 0.801, 0.107]}), defaultdict(<class 'list'>, {'all_KL': [0.909, 0.946, 0.962, 0.888], 'all_L1': [0.764, 0.804, 0.826, 0.766]}), defaultdict(<class 'list'>, {'all_KL': [0.87, 0.904, 0.923, 0.841], 'all_L1': [0.721, 0.76, 0.785, 0.727]}), defaultdict(<class 'list'>, {'all_KL': [0.955, 0.943, 0.905, 0.958], 'all_L1': [0.793, 0.795, 0.781, 0.829]}), defaultdict(<class 'list'>, {'all_KL': [0.849, 0.887, 0.916, 0.95], 'all_L1': [0.71, 0.752, 0.783, 0.821]}), defaultdict(<class 'list'>, {'all_KL': [0.98, 0.984, 0.982, 0.977], 'all_L1': [0.843, 0.85, 0.852, 0.848]}), defaultdict(<class 'list'>, {'all_KL': [0.966, 0.962, 0.961, 0.941], 'all_L1': [0.824, 0.824, 0.827, 0.813]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.888 +- 0.166, 0.891 +- 0.168, 0.895 +- 0.162, 0.898 +- 0.159
suff_simple class all_KL  =  0.830 +- 0.227, 0.829 +- 0.236, 0.834 +- 0.230, 0.837 +- 0.229
suff_simple_acc_int  =  0.903 +- 0.159, 0.909 +- 0.157, 0.914 +- 0.147, 0.917 +- 0.143
nec class all_L1  =  0.600 +- 0.270, 0.854 +- 0.010, 0.826 +- 0.100, 0.626 +- 0.330
nec class all_KL  =  0.770 +- 0.257, 0.990 +- 0.008, 0.957 +- 0.105, 0.725 +- 0.381
nec_acc_int  =  0.364 +- 0.347, 0.013 +- 0.015, 0.048 +- 0.130, 0.276 +- 0.383

Eval split val
suff_simple class all_L1  =  0.911 +- 0.188, 0.899 +- 0.200, 0.896 +- 0.200, 0.895 +- 0.201
suff_simple class all_KL  =  0.882 +- 0.226, 0.865 +- 0.238, 0.861 +- 0.236, 0.858 +- 0.238
suff_simple_acc_int  =  0.793 +- 0.218, 0.781 +- 0.236, 0.776 +- 0.245, 0.775 +- 0.244
nec class all_L1  =  0.761 +- 0.091, 0.766 +- 0.088, 0.733 +- 0.109, 0.550 +- 0.290
nec class all_KL  =  0.845 +- 0.103, 0.847 +- 0.108, 0.811 +- 0.124, 0.608 +- 0.325
nec_acc_int  =  0.015 +- 0.030, 0.000 +- 0.000, 0.042 +- 0.126, 0.246 +- 0.336

Eval split test
suff_simple class all_L1  =  0.970 +- 0.053, 0.971 +- 0.050, 0.973 +- 0.044, 0.972 +- 0.035
suff_simple class all_KL  =  0.956 +- 0.076, 0.957 +- 0.072, 0.960 +- 0.064, 0.958 +- 0.053
suff_simple_acc_int  =  0.973 +- 0.050, 0.975 +- 0.045, 0.978 +- 0.040, 0.983 +- 0.031
nec class all_L1  =  0.764 +- 0.044, 0.791 +- 0.031, 0.774 +- 0.097, 0.659 +- 0.306
nec class all_KL  =  0.907 +- 0.043, 0.930 +- 0.029, 0.902 +- 0.111, 0.762 +- 0.354
nec_acc_int  =  0.133 +- 0.061, 0.092 +- 0.045, 0.104 +- 0.117, 0.227 +- 0.359


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.744 +- 0.138, 0.873 +- 0.083, 0.860 +- 0.086, 0.762 +- 0.172
Faith. Armon (L1)= 		  =  0.660 +- 0.223, 0.862 +- 0.102, 0.844 +- 0.108, 0.653 +- 0.338
Faith. GMean (L1)= 	  =  0.698 +- 0.184, 0.867 +- 0.092, 0.852 +- 0.097, 0.673 +- 0.319
Faith. Aritm (KL)= 		  =  0.800 +- 0.141, 0.909 +- 0.116, 0.896 +- 0.115, 0.781 +- 0.207
Faith. Armon (KL)= 		  =  0.740 +- 0.202, 0.878 +- 0.189, 0.862 +- 0.180, 0.665 +- 0.367
Faith. GMean (KL)= 	  =  0.768 +- 0.173, 0.892 +- 0.157, 0.878 +- 0.150, 0.691 +- 0.342

Eval split val
Faith. Aritm (L1)= 		  =  0.836 +- 0.111, 0.832 +- 0.118, 0.815 +- 0.116, 0.722 +- 0.163
Faith. Armon (L1)= 		  =  0.816 +- 0.127, 0.813 +- 0.136, 0.788 +- 0.137, 0.602 +- 0.318
Faith. GMean (L1)= 	  =  0.826 +- 0.119, 0.822 +- 0.128, 0.801 +- 0.127, 0.630 +- 0.294
Faith. Aritm (KL)= 		  =  0.864 +- 0.131, 0.856 +- 0.140, 0.836 +- 0.135, 0.733 +- 0.184
Faith. Armon (KL)= 		  =  0.843 +- 0.165, 0.833 +- 0.179, 0.809 +- 0.172, 0.613 +- 0.338
Faith. GMean (KL)= 	  =  0.853 +- 0.149, 0.844 +- 0.161, 0.822 +- 0.154, 0.642 +- 0.310

Eval split test
Faith. Aritm (L1)= 		  =  0.867 +- 0.025, 0.881 +- 0.025, 0.874 +- 0.049, 0.816 +- 0.152
Faith. Armon (L1)= 		  =  0.853 +- 0.027, 0.871 +- 0.024, 0.857 +- 0.070, 0.726 +- 0.318
Faith. GMean (L1)= 	  =  0.860 +- 0.026, 0.876 +- 0.025, 0.865 +- 0.060, 0.746 +- 0.289
Faith. Aritm (KL)= 		  =  0.931 +- 0.033, 0.943 +- 0.034, 0.931 +- 0.058, 0.860 +- 0.177
Faith. Armon (KL)= 		  =  0.928 +- 0.037, 0.941 +- 0.037, 0.924 +- 0.074, 0.778 +- 0.340
Faith. GMean (KL)= 	  =  0.930 +- 0.035, 0.942 +- 0.036, 0.928 +- 0.066, 0.795 +- 0.311
Computed for split load_split = id



Completed in  0:50:26.940848  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN TopoFeature/basis/no_shift NEC_ALPHA 0.1

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 00:11:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 12:11:47 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 12:11:47 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 12:11:47 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 12:11:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:11:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:11:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:11:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:11:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:11:47 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 12:11:47 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.103
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.099
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.058
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.057
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.012
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.113
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.111
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.088
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10290252707581228
len(reference) = 276
Effective ratio: 0.196 +- 0.158
Model Accuracy over intervened graphs for r=0.01 =  0.995
SUFF_SIMPLE for r=0.01 class 1.0 = 0.994 +- 0.084 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.01 all KL = 0.99 +- 0.084 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.01 all L1 = 0.994 +- 0.057 (in-sample avg dev_std = 0.067)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0993971119133574
len(reference) = 277
Effective ratio: 0.118 +- 0.110
Model Accuracy over intervened graphs for r=0.1 =  0.989
SUFF_SIMPLE for r=0.1 class 1.0 = 0.99 +- 0.109 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.1 all KL = 0.987 +- 0.109 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.1 all L1 = 0.99 +- 0.089 (in-sample avg dev_std = 0.042)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.057844765342960285
len(reference) = 277
Effective ratio: 0.024 +- 0.030
Model Accuracy over intervened graphs for r=0.25 =  0.972
SUFF_SIMPLE for r=0.25 class 1.0 = 0.963 +- 0.226 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.25 all KL = 0.938 +- 0.226 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.25 all L1 = 0.963 +- 0.141 (in-sample avg dev_std = 0.254)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05655595667870036
len(reference) = 277
Effective ratio: 0.023 +- 0.022
Model Accuracy over intervened graphs for r=0.6 =  0.964
SUFF_SIMPLE for r=0.6 class 1.0 = 0.955 +- 0.245 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.6 all KL = 0.928 +- 0.245 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.6 all L1 = 0.955 +- 0.159 (in-sample avg dev_std = 0.273)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012415873015873016
len(reference) = 2520
Effective ratio: 0.029 +- 0.007
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012115873015873014
len(reference) = 2520
Effective ratio: 0.016 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.1126754457050243
len(reference) = 2192
Effective ratio: 0.230 +- 0.340
Model Accuracy over intervened graphs for r=0.01 =  0.985
SUFF_SIMPLE for r=0.01 class 1.0 = 0.973 +- 0.179 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.01 all KL = 0.934 +- 0.179 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.01 all L1 = 0.973 +- 0.074 (in-sample avg dev_std = 0.228)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11052674230145866
len(reference) = 2306
Effective ratio: 0.172 +- 0.287
Model Accuracy over intervened graphs for r=0.1 =  0.984
SUFF_SIMPLE for r=0.1 class 1.0 = 0.973 +- 0.178 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.1 all KL = 0.936 +- 0.178 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.1 all L1 = 0.973 +- 0.080 (in-sample avg dev_std = 0.222)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08777066450567261
len(reference) = 2384
Effective ratio: 0.082 +- 0.214
Model Accuracy over intervened graphs for r=0.25 =  0.966
SUFF_SIMPLE for r=0.25 class 1.0 = 0.95 +- 0.246 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.25 all KL = 0.896 +- 0.246 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.25 all L1 = 0.95 +- 0.133 (in-sample avg dev_std = 0.297)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05850202593192869
len(reference) = 2468
Effective ratio: 0.030 +- 0.050
Model Accuracy over intervened graphs for r=0.6 =  0.961
SUFF_SIMPLE for r=0.6 class 1.0 = 0.942 +- 0.266 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.6 all KL = 0.88 +- 0.266 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.6 all L1 = 0.942 +- 0.142 (in-sample avg dev_std = 0.328)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10290252707581228
len(reference) = 277
Effective ratio: 0.196 +- 0.158
Model Accuracy over intervened graphs for r=0.01 =  0.992
NEC for r=0.01 class 1.0 = 0.008 +- 0.098 (in-sample avg dev_std = 0.056)
NEC for r=0.01 all KL = 0.011 +- 0.098 (in-sample avg dev_std = 0.056)
NEC for r=0.01 all L1 = 0.008 +- 0.077 (in-sample avg dev_std = 0.056)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0993971119133574
len(reference) = 277
Effective ratio: 0.118 +- 0.110
Model Accuracy over intervened graphs for r=0.1 =  0.993
NEC for r=0.1 class 1.0 = 0.006 +- 0.085 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.007 +- 0.085 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.006 +- 0.073 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.057844765342960285
len(reference) = 277
Effective ratio: 0.024 +- 0.030
Model Accuracy over intervened graphs for r=0.25 =  1.0
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05655595667870036
len(reference) = 277
Effective ratio: 0.023 +- 0.022
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012415873015873016
len(reference) = 2520
Effective ratio: 0.029 +- 0.007
Model Accuracy over intervened graphs for r=0.01 =  1.0
NEC for r=0.01 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012115873015873014
len(reference) = 2520
Effective ratio: 0.016 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.25 =  1.0
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.1126754457050243
len(reference) = 2468
Effective ratio: 0.230 +- 0.340
Model Accuracy over intervened graphs for r=0.01 =  0.987
NEC for r=0.01 class 1.0 = 0.017 +- 0.156 (in-sample avg dev_std = 0.166)
NEC for r=0.01 all KL = 0.034 +- 0.156 (in-sample avg dev_std = 0.166)
NEC for r=0.01 all L1 = 0.017 +- 0.088 (in-sample avg dev_std = 0.166)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11052674230145866
len(reference) = 2468
Effective ratio: 0.172 +- 0.287
Model Accuracy over intervened graphs for r=0.1 =  0.994
NEC for r=0.1 class 1.0 = 0.008 +- 0.106 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all KL = 0.015 +- 0.106 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all L1 = 0.008 +- 0.061 (in-sample avg dev_std = 0.110)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08777066450567261
len(reference) = 2468
Effective ratio: 0.082 +- 0.214
Model Accuracy over intervened graphs for r=0.25 =  0.998
NEC for r=0.25 class 1.0 = 0.002 +- 0.051 (in-sample avg dev_std = 0.050)
NEC for r=0.25 all KL = 0.003 +- 0.051 (in-sample avg dev_std = 0.050)
NEC for r=0.25 all L1 = 0.002 +- 0.032 (in-sample avg dev_std = 0.050)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05850202593192869
len(reference) = 2468
Effective ratio: 0.030 +- 0.050
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 00:16:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 12:16:37 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 12:16:37 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 12:16:37 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 12:16:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:16:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:16:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:16:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:16:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:16:37 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 12:16:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.092
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.089
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.085
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.065
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.012
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.112
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.111
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.109
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.083


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.0916534296028881
len(reference) = 237
Effective ratio: 0.583 +- 0.272
Model Accuracy over intervened graphs for r=0.01 =  0.944
SUFF_SIMPLE for r=0.01 class 1.0 = 0.924 +- 0.302 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.01 all KL = 0.855 +- 0.302 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.01 all L1 = 0.924 +- 0.176 (in-sample avg dev_std = 0.369)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08918050541516247
len(reference) = 270
Effective ratio: 0.202 +- 0.193
Model Accuracy over intervened graphs for r=0.1 =  0.903
SUFF_SIMPLE for r=0.1 class 1.0 = 0.883 +- 0.344 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.1 all KL = 0.789 +- 0.344 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.1 all L1 = 0.883 +- 0.224 (in-sample avg dev_std = 0.393)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08541516245487363
len(reference) = 277
Effective ratio: 0.141 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.914
SUFF_SIMPLE for r=0.25 class 1.0 = 0.894 +- 0.332 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.25 all KL = 0.805 +- 0.332 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.25 all L1 = 0.894 +- 0.211 (in-sample avg dev_std = 0.381)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.06506859205776173
len(reference) = 277
Effective ratio: 0.024 +- 0.032
Model Accuracy over intervened graphs for r=0.6 =  0.917
SUFF_SIMPLE for r=0.6 class 1.0 = 0.879 +- 0.338 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.6 all KL = 0.75 +- 0.338 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.6 all L1 = 0.879 +- 0.190 (in-sample avg dev_std = 0.480)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012118650793650794
len(reference) = 2520
Effective ratio: 0.110 +- 0.037
Model Accuracy over intervened graphs for r=0.01 =  0.998
SUFF_SIMPLE for r=0.01 class 1.0 = 0.997 +- 0.062 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.01 all KL = 0.993 +- 0.062 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.01 all L1 = 0.997 +- 0.025 (in-sample avg dev_std = 0.081)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01192579365079365
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.999
SUFF_SIMPLE for r=0.1 class 1.0 = 0.997 +- 0.056 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.1 all KL = 0.994 +- 0.056 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.1 all L1 = 0.997 +- 0.024 (in-sample avg dev_std = 0.074)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01169484126984127
len(reference) = 2520
Effective ratio: 0.023 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.999
SUFF_SIMPLE for r=0.25 class 1.0 = 0.997 +- 0.058 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.25 all KL = 0.994 +- 0.058 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.25 all L1 = 0.997 +- 0.024 (in-sample avg dev_std = 0.075)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.010062301587301587
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.998
SUFF_SIMPLE for r=0.6 class 1.0 = 0.997 +- 0.063 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.6 all KL = 0.993 +- 0.063 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.6 all L1 = 0.997 +- 0.026 (in-sample avg dev_std = 0.082)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11172082658022689
len(reference) = 1975
Effective ratio: 0.312 +- 0.401
Model Accuracy over intervened graphs for r=0.01 =  0.958
SUFF_SIMPLE for r=0.01 class 1.0 = 0.94 +- 0.272 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.01 all KL = 0.877 +- 0.272 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.01 all L1 = 0.94 +- 0.149 (in-sample avg dev_std = 0.333)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11134481361426256
len(reference) = 2130
Effective ratio: 0.237 +- 0.354
Model Accuracy over intervened graphs for r=0.1 =  0.954
SUFF_SIMPLE for r=0.1 class 1.0 = 0.937 +- 0.275 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.1 all KL = 0.876 +- 0.275 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.1 all L1 = 0.937 +- 0.159 (in-sample avg dev_std = 0.326)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.999
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10893881685575364
len(reference) = 2296
Effective ratio: 0.176 +- 0.290
Model Accuracy over intervened graphs for r=0.25 =  0.953
SUFF_SIMPLE for r=0.25 class 1.0 = 0.939 +- 0.271 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.25 all KL = 0.884 +- 0.271 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.25 all L1 = 0.939 +- 0.164 (in-sample avg dev_std = 0.302)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.998
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0834035656401945
len(reference) = 2450
Effective ratio: 0.073 +- 0.171
Model Accuracy over intervened graphs for r=0.6 =  0.937
SUFF_SIMPLE for r=0.6 class 1.0 = 0.913 +- 0.316 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.6 all KL = 0.833 +- 0.316 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.6 all L1 = 0.913 +- 0.185 (in-sample avg dev_std = 0.388)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.0916534296028881
len(reference) = 277
Effective ratio: 0.583 +- 0.272
Model Accuracy over intervened graphs for r=0.01 =  0.927
NEC for r=0.01 class 1.0 = 0.105 +- 0.338 (in-sample avg dev_std = 0.447)
NEC for r=0.01 all KL = 0.206 +- 0.338 (in-sample avg dev_std = 0.447)
NEC for r=0.01 all L1 = 0.105 +- 0.192 (in-sample avg dev_std = 0.447)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08918050541516247
len(reference) = 277
Effective ratio: 0.202 +- 0.193
Model Accuracy over intervened graphs for r=0.1 =  0.961
NEC for r=0.1 class 1.0 = 0.038 +- 0.212 (in-sample avg dev_std = 0.138)
NEC for r=0.1 all KL = 0.051 +- 0.212 (in-sample avg dev_std = 0.138)
NEC for r=0.1 all L1 = 0.038 +- 0.165 (in-sample avg dev_std = 0.138)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08541516245487363
len(reference) = 277
Effective ratio: 0.141 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.986
NEC for r=0.25 class 1.0 = 0.012 +- 0.119 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.014 +- 0.119 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.012 +- 0.103 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.06506859205776173
len(reference) = 277
Effective ratio: 0.024 +- 0.032
Model Accuracy over intervened graphs for r=0.6 =  0.996
NEC for r=0.6 class 1.0 = 0.003 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.004 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.003 +- 0.052 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012118650793650794
len(reference) = 2520
Effective ratio: 0.110 +- 0.037
Model Accuracy over intervened graphs for r=0.01 =  0.976
NEC for r=0.01 class 1.0 = 0.022 +- 0.159 (in-sample avg dev_std = 0.051)
NEC for r=0.01 all KL = 0.027 +- 0.159 (in-sample avg dev_std = 0.051)
NEC for r=0.01 all L1 = 0.022 +- 0.133 (in-sample avg dev_std = 0.051)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01192579365079365
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01169484126984127
len(reference) = 2520
Effective ratio: 0.023 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  1.0
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.010062301587301587
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.998
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11172082658022689
len(reference) = 2468
Effective ratio: 0.312 +- 0.401
Model Accuracy over intervened graphs for r=0.01 =  0.958
NEC for r=0.01 class 1.0 = 0.056 +- 0.267 (in-sample avg dev_std = 0.300)
NEC for r=0.01 all KL = 0.106 +- 0.267 (in-sample avg dev_std = 0.300)
NEC for r=0.01 all L1 = 0.056 +- 0.159 (in-sample avg dev_std = 0.300)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11134481361426256
len(reference) = 2468
Effective ratio: 0.237 +- 0.354
Model Accuracy over intervened graphs for r=0.1 =  0.968
NEC for r=0.1 class 1.0 = 0.042 +- 0.235 (in-sample avg dev_std = 0.257)
NEC for r=0.1 all KL = 0.079 +- 0.235 (in-sample avg dev_std = 0.257)
NEC for r=0.1 all L1 = 0.042 +- 0.141 (in-sample avg dev_std = 0.257)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.998
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10893881685575364
len(reference) = 2468
Effective ratio: 0.176 +- 0.290
Model Accuracy over intervened graphs for r=0.25 =  0.974
NEC for r=0.25 class 1.0 = 0.031 +- 0.200 (in-sample avg dev_std = 0.187)
NEC for r=0.25 all KL = 0.051 +- 0.200 (in-sample avg dev_std = 0.187)
NEC for r=0.25 all L1 = 0.031 +- 0.135 (in-sample avg dev_std = 0.187)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.998
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0834035656401945
len(reference) = 2468
Effective ratio: 0.073 +- 0.171
Model Accuracy over intervened graphs for r=0.6 =  0.987
NEC for r=0.6 class 1.0 = 0.011 +- 0.113 (in-sample avg dev_std = 0.025)
NEC for r=0.6 all KL = 0.013 +- 0.113 (in-sample avg dev_std = 0.025)
NEC for r=0.6 all L1 = 0.011 +- 0.097 (in-sample avg dev_std = 0.025)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 00:22:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 12:22:10 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 12:22:10 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 12:22:10 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 12:22:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:22:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:22:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:22:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:22:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:22:10 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 12:22:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.101
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.101
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.101
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.074
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.013
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.013
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.111
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.111
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.109
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.089


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10113718411552347
len(reference) = 233
Effective ratio: 0.580 +- 0.257
Model Accuracy over intervened graphs for r=0.01 =  0.951
SUFF_SIMPLE for r=0.01 class 1.0 = 0.946 +- 0.245 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.01 all KL = 0.919 +- 0.245 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.01 all L1 = 0.946 +- 0.178 (in-sample avg dev_std = 0.237)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.10067509025270759
len(reference) = 271
Effective ratio: 0.227 +- 0.219
Model Accuracy over intervened graphs for r=0.1 =  0.928
SUFF_SIMPLE for r=0.1 class 1.0 = 0.917 +- 0.290 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.1 all KL = 0.867 +- 0.290 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.1 all L1 = 0.917 +- 0.206 (in-sample avg dev_std = 0.315)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10105415162454874
len(reference) = 276
Effective ratio: 0.169 +- 0.141
Model Accuracy over intervened graphs for r=0.25 =  0.925
SUFF_SIMPLE for r=0.25 class 1.0 = 0.908 +- 0.297 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.25 all KL = 0.843 +- 0.297 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.25 all L1 = 0.908 +- 0.200 (in-sample avg dev_std = 0.357)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07420216606498195
len(reference) = 277
Effective ratio: 0.028 +- 0.049
Model Accuracy over intervened graphs for r=0.6 =  0.934
SUFF_SIMPLE for r=0.6 class 1.0 = 0.905 +- 0.294 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.6 all KL = 0.823 +- 0.294 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.6 all L1 = 0.905 +- 0.178 (in-sample avg dev_std = 0.423)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.86
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.01276746031746032
len(reference) = 2520
Effective ratio: 0.134 +- 0.040
Model Accuracy over intervened graphs for r=0.01 =  0.86
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01265595238095238
len(reference) = 2520
Effective ratio: 0.027 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.86
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.86
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.012505952380952383
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.25 =  0.86
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.86
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11139789303079414
len(reference) = 1905
Effective ratio: 0.316 +- 0.408
Model Accuracy over intervened graphs for r=0.01 =  0.957
SUFF_SIMPLE for r=0.01 class 1.0 = 0.942 +- 0.247 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.01 all KL = 0.893 +- 0.247 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.01 all L1 = 0.942 +- 0.151 (in-sample avg dev_std = 0.317)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11123662884927069
len(reference) = 2077
Effective ratio: 0.256 +- 0.369
Model Accuracy over intervened graphs for r=0.1 =  0.956
SUFF_SIMPLE for r=0.1 class 1.0 = 0.943 +- 0.244 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.1 all KL = 0.899 +- 0.244 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.1 all L1 = 0.943 +- 0.155 (in-sample avg dev_std = 0.300)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.996
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10948217179902756
len(reference) = 2250
Effective ratio: 0.207 +- 0.319
Model Accuracy over intervened graphs for r=0.25 =  0.945
SUFF_SIMPLE for r=0.25 class 1.0 = 0.934 +- 0.260 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.25 all KL = 0.89 +- 0.260 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.25 all L1 = 0.934 +- 0.177 (in-sample avg dev_std = 0.297)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.992
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0885996758508914
len(reference) = 2435
Effective ratio: 0.094 +- 0.212
Model Accuracy over intervened graphs for r=0.6 =  0.935
SUFF_SIMPLE for r=0.6 class 1.0 = 0.916 +- 0.289 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.6 all KL = 0.858 +- 0.289 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.6 all L1 = 0.916 +- 0.194 (in-sample avg dev_std = 0.349)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10113718411552347
len(reference) = 277
Effective ratio: 0.580 +- 0.257
Model Accuracy over intervened graphs for r=0.01 =  0.915
NEC for r=0.01 class 1.0 = 0.115 +- 0.337 (in-sample avg dev_std = 0.456)
NEC for r=0.01 all KL = 0.197 +- 0.337 (in-sample avg dev_std = 0.456)
NEC for r=0.01 all L1 = 0.115 +- 0.212 (in-sample avg dev_std = 0.456)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.10067509025270759
len(reference) = 277
Effective ratio: 0.227 +- 0.219
Model Accuracy over intervened graphs for r=0.1 =  0.968
NEC for r=0.1 class 1.0 = 0.034 +- 0.198 (in-sample avg dev_std = 0.176)
NEC for r=0.1 all KL = 0.049 +- 0.198 (in-sample avg dev_std = 0.176)
NEC for r=0.1 all L1 = 0.034 +- 0.146 (in-sample avg dev_std = 0.176)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10105415162454874
len(reference) = 277
Effective ratio: 0.169 +- 0.141
Model Accuracy over intervened graphs for r=0.25 =  0.959
NEC for r=0.25 class 1.0 = 0.036 +- 0.201 (in-sample avg dev_std = 0.062)
NEC for r=0.25 all KL = 0.043 +- 0.201 (in-sample avg dev_std = 0.062)
NEC for r=0.25 all L1 = 0.036 +- 0.171 (in-sample avg dev_std = 0.062)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07420216606498195
len(reference) = 277
Effective ratio: 0.028 +- 0.049
Model Accuracy over intervened graphs for r=0.6 =  0.989
NEC for r=0.6 class 1.0 = 0.009 +- 0.103 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.011 +- 0.103 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.009 +- 0.089 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.86
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.01276746031746032
len(reference) = 2520
Effective ratio: 0.134 +- 0.040
Model Accuracy over intervened graphs for r=0.01 =  0.857
NEC for r=0.01 class 1.0 = 0.003 +- 0.059 (in-sample avg dev_std = 0.023)
NEC for r=0.01 all KL = 0.004 +- 0.059 (in-sample avg dev_std = 0.023)
NEC for r=0.01 all L1 = 0.003 +- 0.049 (in-sample avg dev_std = 0.023)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01265595238095238
len(reference) = 2520
Effective ratio: 0.027 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.86
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.86
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.012505952380952383
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.25 =  0.86
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.86
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.992
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11139789303079414
len(reference) = 2468
Effective ratio: 0.316 +- 0.408
Model Accuracy over intervened graphs for r=0.01 =  0.961
NEC for r=0.01 class 1.0 = 0.058 +- 0.252 (in-sample avg dev_std = 0.316)
NEC for r=0.01 all KL = 0.103 +- 0.252 (in-sample avg dev_std = 0.316)
NEC for r=0.01 all L1 = 0.058 +- 0.157 (in-sample avg dev_std = 0.316)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11123662884927069
len(reference) = 2468
Effective ratio: 0.256 +- 0.369
Model Accuracy over intervened graphs for r=0.1 =  0.965
NEC for r=0.1 class 1.0 = 0.049 +- 0.233 (in-sample avg dev_std = 0.267)
NEC for r=0.1 all KL = 0.082 +- 0.233 (in-sample avg dev_std = 0.267)
NEC for r=0.1 all L1 = 0.049 +- 0.155 (in-sample avg dev_std = 0.267)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.992
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10948217179902756
len(reference) = 2468
Effective ratio: 0.207 +- 0.319
Model Accuracy over intervened graphs for r=0.25 =  0.973
NEC for r=0.25 class 1.0 = 0.036 +- 0.202 (in-sample avg dev_std = 0.199)
NEC for r=0.25 all KL = 0.056 +- 0.202 (in-sample avg dev_std = 0.199)
NEC for r=0.25 all L1 = 0.036 +- 0.145 (in-sample avg dev_std = 0.199)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.992
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0885996758508914
len(reference) = 2468
Effective ratio: 0.094 +- 0.212
Model Accuracy over intervened graphs for r=0.6 =  0.977
NEC for r=0.6 class 1.0 = 0.024 +- 0.163 (in-sample avg dev_std = 0.075)
NEC for r=0.6 all KL = 0.029 +- 0.163 (in-sample avg dev_std = 0.075)
NEC for r=0.6 all L1 = 0.024 +- 0.136 (in-sample avg dev_std = 0.075)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 00:27:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 12:27:05 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 12:27:05 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 12:27:05 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 12:27:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:27:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:27:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:27:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:27:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:27:05 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 12:27:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.093
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.089
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.070
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.070
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.011
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.011
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.112
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.112
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.098
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.049


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09340794223826715
len(reference) = 271
Effective ratio: 0.315 +- 0.189
Model Accuracy over intervened graphs for r=0.01 =  0.828
SUFF_SIMPLE for r=0.01 class 1.0 = 0.78 +- 0.374 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.01 all KL = 0.661 +- 0.374 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.01 all L1 = 0.78 +- 0.264 (in-sample avg dev_std = 0.573)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08869314079422382
len(reference) = 277
Effective ratio: 0.168 +- 0.136
Model Accuracy over intervened graphs for r=0.1 =  0.797
SUFF_SIMPLE for r=0.1 class 1.0 = 0.752 +- 0.375 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.1 all KL = 0.621 +- 0.375 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.1 all L1 = 0.752 +- 0.275 (in-sample avg dev_std = 0.587)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.06991696750902528
len(reference) = 277
Effective ratio: 0.027 +- 0.051
Model Accuracy over intervened graphs for r=0.25 =  0.823
SUFF_SIMPLE for r=0.25 class 1.0 = 0.754 +- 0.356 (in-sample avg dev_std = 0.663)
SUFF_SIMPLE for r=0.25 all KL = 0.595 +- 0.356 (in-sample avg dev_std = 0.663)
SUFF_SIMPLE for r=0.25 all L1 = 0.754 +- 0.235 (in-sample avg dev_std = 0.663)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07038628158844765
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.84
SUFF_SIMPLE for r=0.6 class 1.0 = 0.776 +- 0.355 (in-sample avg dev_std = 0.627)
SUFF_SIMPLE for r=0.6 all KL = 0.634 +- 0.355 (in-sample avg dev_std = 0.627)
SUFF_SIMPLE for r=0.6 all L1 = 0.776 +- 0.238 (in-sample avg dev_std = 0.627)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.762
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012090873015873017
len(reference) = 2520
Effective ratio: 0.106 +- 0.032
Model Accuracy over intervened graphs for r=0.01 =  0.735
SUFF_SIMPLE for r=0.01 class 1.0 = 0.948 +- 0.207 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.01 all KL = 0.911 +- 0.207 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.01 all L1 = 0.948 +- 0.119 (in-sample avg dev_std = 0.308)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011874999999999998
len(reference) = 2520
Effective ratio: 0.024 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.735
SUFF_SIMPLE for r=0.1 class 1.0 = 0.948 +- 0.208 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.1 all KL = 0.912 +- 0.208 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.1 all L1 = 0.948 +- 0.121 (in-sample avg dev_std = 0.306)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.762
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.010976190476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.25 =  0.735
SUFF_SIMPLE for r=0.25 class 1.0 = 0.946 +- 0.212 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.25 all KL = 0.91 +- 0.212 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.25 all L1 = 0.946 +- 0.122 (in-sample avg dev_std = 0.311)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.010976190476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.735
SUFF_SIMPLE for r=0.6 class 1.0 = 0.947 +- 0.209 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.6 all KL = 0.91 +- 0.209 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.6 all L1 = 0.947 +- 0.119 (in-sample avg dev_std = 0.311)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11205429497568882
len(reference) = 2062
Effective ratio: 0.268 +- 0.372
Model Accuracy over intervened graphs for r=0.01 =  0.935
SUFF_SIMPLE for r=0.01 class 1.0 = 0.918 +- 0.269 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.01 all KL = 0.871 +- 0.269 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.01 all L1 = 0.918 +- 0.188 (in-sample avg dev_std = 0.334)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.995
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11165883306320908
len(reference) = 2210
Effective ratio: 0.209 +- 0.326
Model Accuracy over intervened graphs for r=0.1 =  0.928
SUFF_SIMPLE for r=0.1 class 1.0 = 0.911 +- 0.277 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 all KL = 0.863 +- 0.277 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 all L1 = 0.911 +- 0.197 (in-sample avg dev_std = 0.335)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.986
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09752836304700162
len(reference) = 2328
Effective ratio: 0.120 +- 0.274
Model Accuracy over intervened graphs for r=0.25 =  0.92
SUFF_SIMPLE for r=0.25 class 1.0 = 0.895 +- 0.298 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.25 all KL = 0.837 +- 0.298 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.25 all L1 = 0.895 +- 0.209 (in-sample avg dev_std = 0.381)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.977
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.048913695299837925
len(reference) = 2468
Effective ratio: 0.027 +- 0.043
Model Accuracy over intervened graphs for r=0.6 =  0.927
SUFF_SIMPLE for r=0.6 class 1.0 = 0.879 +- 0.312 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.6 all KL = 0.807 +- 0.312 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.6 all L1 = 0.879 +- 0.210 (in-sample avg dev_std = 0.443)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09340794223826715
len(reference) = 277
Effective ratio: 0.315 +- 0.189
Model Accuracy over intervened graphs for r=0.01 =  0.895
NEC for r=0.01 class 1.0 = 0.122 +- 0.316 (in-sample avg dev_std = 0.343)
NEC for r=0.01 all KL = 0.169 +- 0.316 (in-sample avg dev_std = 0.343)
NEC for r=0.01 all L1 = 0.122 +- 0.242 (in-sample avg dev_std = 0.343)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08869314079422382
len(reference) = 277
Effective ratio: 0.168 +- 0.136
Model Accuracy over intervened graphs for r=0.1 =  0.947
NEC for r=0.1 class 1.0 = 0.048 +- 0.225 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all KL = 0.056 +- 0.225 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all L1 = 0.048 +- 0.191 (in-sample avg dev_std = 0.061)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.06991696750902528
len(reference) = 277
Effective ratio: 0.027 +- 0.051
Model Accuracy over intervened graphs for r=0.25 =  0.996
NEC for r=0.25 class 1.0 = 0.003 +- 0.059 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.004 +- 0.059 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.003 +- 0.052 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07038628158844765
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.762
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012090873015873017
len(reference) = 2520
Effective ratio: 0.106 +- 0.032
Model Accuracy over intervened graphs for r=0.01 =  0.44
NEC for r=0.01 class 1.0 = 0.328 +- 0.428 (in-sample avg dev_std = 0.011)
NEC for r=0.01 all KL = 0.34 +- 0.428 (in-sample avg dev_std = 0.011)
NEC for r=0.01 all L1 = 0.328 +- 0.369 (in-sample avg dev_std = 0.011)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011874999999999998
len(reference) = 2520
Effective ratio: 0.024 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.742
NEC for r=0.1 class 1.0 = 0.027 +- 0.127 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.022 +- 0.127 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.027 +- 0.117 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.762
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.010976190476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.25 =  0.761
NEC for r=0.25 class 1.0 = 0.001 +- 0.014 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.014 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.001 +- 0.017 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.010976190476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.761
NEC for r=0.6 class 1.0 = 0.001 +- 0.014 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.014 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.001 +- 0.017 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.977
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11205429497568882
len(reference) = 2468
Effective ratio: 0.268 +- 0.372
Model Accuracy over intervened graphs for r=0.01 =  0.961
NEC for r=0.01 class 1.0 = 0.064 +- 0.249 (in-sample avg dev_std = 0.254)
NEC for r=0.01 all KL = 0.09 +- 0.249 (in-sample avg dev_std = 0.254)
NEC for r=0.01 all L1 = 0.064 +- 0.188 (in-sample avg dev_std = 0.254)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11165883306320908
len(reference) = 2468
Effective ratio: 0.209 +- 0.326
Model Accuracy over intervened graphs for r=0.1 =  0.967
NEC for r=0.1 class 1.0 = 0.052 +- 0.226 (in-sample avg dev_std = 0.195)
NEC for r=0.1 all KL = 0.068 +- 0.226 (in-sample avg dev_std = 0.195)
NEC for r=0.1 all L1 = 0.052 +- 0.179 (in-sample avg dev_std = 0.195)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.977
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09752836304700162
len(reference) = 2468
Effective ratio: 0.120 +- 0.274
Model Accuracy over intervened graphs for r=0.25 =  0.974
NEC for r=0.25 class 1.0 = 0.039 +- 0.197 (in-sample avg dev_std = 0.148)
NEC for r=0.25 all KL = 0.049 +- 0.197 (in-sample avg dev_std = 0.148)
NEC for r=0.25 all L1 = 0.039 +- 0.162 (in-sample avg dev_std = 0.148)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.977
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.048913695299837925
len(reference) = 2468
Effective ratio: 0.027 +- 0.043
Model Accuracy over intervened graphs for r=0.6 =  0.97
NEC for r=0.6 class 1.0 = 0.02 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.021 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.02 +- 0.120 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 00:32:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 12:32:04 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 12:32:04 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 12:32:04 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 12:32:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:32:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:32:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:32:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:32:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:32:04 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 12:32:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.090
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.089
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.085
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.061
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.013
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.013
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.111
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.110
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.109
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.087


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09029241877256318
len(reference) = 274
Effective ratio: 0.230 +- 0.170
Model Accuracy over intervened graphs for r=0.01 =  0.984
SUFF_SIMPLE for r=0.01 class 1.0 = 0.981 +- 0.152 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.01 all KL = 0.965 +- 0.152 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.01 all L1 = 0.981 +- 0.100 (in-sample avg dev_std = 0.142)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08892057761732852
len(reference) = 277
Effective ratio: 0.166 +- 0.130
Model Accuracy over intervened graphs for r=0.1 =  0.986
SUFF_SIMPLE for r=0.1 class 1.0 = 0.98 +- 0.150 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.1 all KL = 0.966 +- 0.150 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.1 all L1 = 0.98 +- 0.103 (in-sample avg dev_std = 0.117)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08524548736462094
len(reference) = 277
Effective ratio: 0.128 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.981
SUFF_SIMPLE for r=0.25 class 1.0 = 0.978 +- 0.161 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.25 all KL = 0.964 +- 0.161 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.25 all L1 = 0.978 +- 0.116 (in-sample avg dev_std = 0.116)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.06067148014440432
len(reference) = 277
Effective ratio: 0.024 +- 0.030
Model Accuracy over intervened graphs for r=0.6 =  0.948
SUFF_SIMPLE for r=0.6 class 1.0 = 0.932 +- 0.292 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.6 all KL = 0.879 +- 0.292 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.6 all L1 = 0.932 +- 0.179 (in-sample avg dev_std = 0.345)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.891
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012509126984126985
len(reference) = 2520
Effective ratio: 0.049 +- 0.015
Model Accuracy over intervened graphs for r=0.01 =  0.891
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.010 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.010 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.004 (in-sample avg dev_std = 0.013)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012418650793650794
len(reference) = 2520
Effective ratio: 0.026 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.891
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.001 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.001 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.001 (in-sample avg dev_std = 0.004)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.891
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.012612301587301587
len(reference) = 2520
Effective ratio: 0.019 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.891
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.011 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.011 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.005 (in-sample avg dev_std = 0.014)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.012826587301587302
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.891
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.012 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.012 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.005 (in-sample avg dev_std = 0.015)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11105186385737438
len(reference) = 2110
Effective ratio: 0.250 +- 0.354
Model Accuracy over intervened graphs for r=0.01 =  0.976
SUFF_SIMPLE for r=0.01 class 1.0 = 0.961 +- 0.220 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.01 all KL = 0.911 +- 0.220 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.01 all L1 = 0.961 +- 0.104 (in-sample avg dev_std = 0.281)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11046555915721233
len(reference) = 2246
Effective ratio: 0.203 +- 0.307
Model Accuracy over intervened graphs for r=0.1 =  0.974
SUFF_SIMPLE for r=0.1 class 1.0 = 0.959 +- 0.225 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.1 all KL = 0.909 +- 0.225 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.1 all L1 = 0.959 +- 0.108 (in-sample avg dev_std = 0.286)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10862682333873583
len(reference) = 2345
Effective ratio: 0.167 +- 0.275
Model Accuracy over intervened graphs for r=0.25 =  0.972
SUFF_SIMPLE for r=0.25 class 1.0 = 0.958 +- 0.225 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.25 all KL = 0.908 +- 0.225 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.25 all L1 = 0.958 +- 0.114 (in-sample avg dev_std = 0.280)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08661021069692058
len(reference) = 2442
Effective ratio: 0.068 +- 0.176
Model Accuracy over intervened graphs for r=0.6 =  0.94
SUFF_SIMPLE for r=0.6 class 1.0 = 0.917 +- 0.305 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.6 all KL = 0.838 +- 0.305 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.6 all L1 = 0.917 +- 0.177 (in-sample avg dev_std = 0.380)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09029241877256318
len(reference) = 277
Effective ratio: 0.230 +- 0.170
Model Accuracy over intervened graphs for r=0.01 =  0.995
NEC for r=0.01 class 1.0 = 0.005 +- 0.083 (in-sample avg dev_std = 0.070)
NEC for r=0.01 all KL = 0.009 +- 0.083 (in-sample avg dev_std = 0.070)
NEC for r=0.01 all L1 = 0.005 +- 0.058 (in-sample avg dev_std = 0.070)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08892057761732852
len(reference) = 277
Effective ratio: 0.166 +- 0.130
Model Accuracy over intervened graphs for r=0.1 =  0.996
NEC for r=0.1 class 1.0 = 0.003 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.004 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.003 +- 0.052 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08524548736462094
len(reference) = 277
Effective ratio: 0.128 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  1.0
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.06067148014440432
len(reference) = 277
Effective ratio: 0.024 +- 0.030
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.891
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012509126984126985
len(reference) = 2520
Effective ratio: 0.049 +- 0.015
Model Accuracy over intervened graphs for r=0.01 =  0.889
NEC for r=0.01 class 1.0 = 0.001 +- 0.036 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.001 +- 0.036 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.001 +- 0.033 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012418650793650794
len(reference) = 2520
Effective ratio: 0.026 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.89
NEC for r=0.1 class 1.0 = 0.0 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.017 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.891
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.012612301587301587
len(reference) = 2520
Effective ratio: 0.019 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.891
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.012826587301587302
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.891
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11105186385737438
len(reference) = 2468
Effective ratio: 0.250 +- 0.354
Model Accuracy over intervened graphs for r=0.01 =  0.973
NEC for r=0.01 class 1.0 = 0.036 +- 0.218 (in-sample avg dev_std = 0.238)
NEC for r=0.01 all KL = 0.069 +- 0.218 (in-sample avg dev_std = 0.238)
NEC for r=0.01 all L1 = 0.036 +- 0.127 (in-sample avg dev_std = 0.238)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11046555915721233
len(reference) = 2468
Effective ratio: 0.203 +- 0.307
Model Accuracy over intervened graphs for r=0.1 =  0.98
NEC for r=0.1 class 1.0 = 0.025 +- 0.184 (in-sample avg dev_std = 0.189)
NEC for r=0.1 all KL = 0.045 +- 0.184 (in-sample avg dev_std = 0.189)
NEC for r=0.1 all L1 = 0.025 +- 0.113 (in-sample avg dev_std = 0.189)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10862682333873583
len(reference) = 2468
Effective ratio: 0.167 +- 0.275
Model Accuracy over intervened graphs for r=0.25 =  0.982
NEC for r=0.25 class 1.0 = 0.02 +- 0.163 (in-sample avg dev_std = 0.150)
NEC for r=0.25 all KL = 0.033 +- 0.163 (in-sample avg dev_std = 0.150)
NEC for r=0.25 all L1 = 0.02 +- 0.109 (in-sample avg dev_std = 0.150)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08661021069692058
len(reference) = 2468
Effective ratio: 0.068 +- 0.176
Model Accuracy over intervened graphs for r=0.6 =  0.992
NEC for r=0.6 class 1.0 = 0.008 +- 0.100 (in-sample avg dev_std = 0.060)
NEC for r=0.6 all KL = 0.011 +- 0.100 (in-sample avg dev_std = 0.060)
NEC for r=0.6 all L1 = 0.008 +- 0.079 (in-sample avg dev_std = 0.060)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 00:37:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 12:37:36 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 12:37:36 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 12:37:36 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 12:37:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:37:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:37:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:37:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:37:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:37:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 12:37:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.091
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.088
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.084
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.014
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.014
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.113
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.113
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.111
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.089


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09149458483754512
len(reference) = 242
Effective ratio: 0.514 +- 0.279
Model Accuracy over intervened graphs for r=0.01 =  0.926
SUFF_SIMPLE for r=0.01 class 1.0 = 0.889 +- 0.329 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.01 all KL = 0.776 +- 0.329 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.01 all L1 = 0.889 +- 0.180 (in-sample avg dev_std = 0.463)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08826353790613718
len(reference) = 270
Effective ratio: 0.212 +- 0.208
Model Accuracy over intervened graphs for r=0.1 =  0.87
SUFF_SIMPLE for r=0.1 class 1.0 = 0.837 +- 0.371 (in-sample avg dev_std = 0.492)
SUFF_SIMPLE for r=0.1 all KL = 0.706 +- 0.371 (in-sample avg dev_std = 0.492)
SUFF_SIMPLE for r=0.1 all L1 = 0.837 +- 0.241 (in-sample avg dev_std = 0.492)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08374368231046933
len(reference) = 275
Effective ratio: 0.126 +- 0.139
Model Accuracy over intervened graphs for r=0.25 =  0.852
SUFF_SIMPLE for r=0.25 class 1.0 = 0.824 +- 0.372 (in-sample avg dev_std = 0.472)
SUFF_SIMPLE for r=0.25 all KL = 0.692 +- 0.372 (in-sample avg dev_std = 0.472)
SUFF_SIMPLE for r=0.25 all L1 = 0.824 +- 0.257 (in-sample avg dev_std = 0.472)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03984476534296029
len(reference) = 277
Effective ratio: 0.027 +- 0.049
Model Accuracy over intervened graphs for r=0.6 =  0.871
SUFF_SIMPLE for r=0.6 class 1.0 = 0.83 +- 0.381 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 all KL = 0.695 +- 0.381 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 all L1 = 0.83 +- 0.241 (in-sample avg dev_std = 0.536)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.94
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013517857142857142
len(reference) = 2520
Effective ratio: 0.109 +- 0.034
Model Accuracy over intervened graphs for r=0.01 =  0.92
SUFF_SIMPLE for r=0.01 class 1.0 = 0.966 +- 0.192 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.01 all KL = 0.929 +- 0.192 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.01 all L1 = 0.966 +- 0.089 (in-sample avg dev_std = 0.261)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013257936507936507
len(reference) = 2520
Effective ratio: 0.026 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.921
SUFF_SIMPLE for r=0.1 class 1.0 = 0.969 +- 0.185 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.1 all KL = 0.935 +- 0.185 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.1 all L1 = 0.969 +- 0.085 (in-sample avg dev_std = 0.249)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.94
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01353968253968254
len(reference) = 2520
Effective ratio: 0.016 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.921
SUFF_SIMPLE for r=0.25 class 1.0 = 0.968 +- 0.188 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.25 all KL = 0.934 +- 0.188 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.25 all L1 = 0.968 +- 0.088 (in-sample avg dev_std = 0.254)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.012710714285714285
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.919
SUFF_SIMPLE for r=0.6 class 1.0 = 0.965 +- 0.194 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.6 all KL = 0.927 +- 0.194 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.6 all L1 = 0.965 +- 0.089 (in-sample avg dev_std = 0.265)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11274513776337115
len(reference) = 1915
Effective ratio: 0.310 +- 0.406
Model Accuracy over intervened graphs for r=0.01 =  0.953
SUFF_SIMPLE for r=0.01 class 1.0 = 0.935 +- 0.276 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.01 all KL = 0.879 +- 0.276 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.01 all L1 = 0.935 +- 0.163 (in-sample avg dev_std = 0.338)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11258589951377634
len(reference) = 2066
Effective ratio: 0.250 +- 0.370
Model Accuracy over intervened graphs for r=0.1 =  0.942
SUFF_SIMPLE for r=0.1 class 1.0 = 0.929 +- 0.282 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.1 all KL = 0.875 +- 0.282 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.1 all L1 = 0.929 +- 0.183 (in-sample avg dev_std = 0.318)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.992
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.1108776337115073
len(reference) = 2190
Effective ratio: 0.199 +- 0.331
Model Accuracy over intervened graphs for r=0.25 =  0.934
SUFF_SIMPLE for r=0.25 class 1.0 = 0.918 +- 0.299 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.25 all KL = 0.859 +- 0.299 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.25 all L1 = 0.918 +- 0.195 (in-sample avg dev_std = 0.341)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.982
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08873298217179902
len(reference) = 2444
Effective ratio: 0.086 +- 0.197
Model Accuracy over intervened graphs for r=0.6 =  0.925
SUFF_SIMPLE for r=0.6 class 1.0 = 0.9 +- 0.324 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.6 all KL = 0.828 +- 0.324 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.6 all L1 = 0.9 +- 0.211 (in-sample avg dev_std = 0.379)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09149458483754512
len(reference) = 277
Effective ratio: 0.514 +- 0.279
Model Accuracy over intervened graphs for r=0.01 =  0.907
NEC for r=0.01 class 1.0 = 0.126 +- 0.363 (in-sample avg dev_std = 0.477)
NEC for r=0.01 all KL = 0.224 +- 0.363 (in-sample avg dev_std = 0.477)
NEC for r=0.01 all L1 = 0.126 +- 0.220 (in-sample avg dev_std = 0.477)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08826353790613718
len(reference) = 277
Effective ratio: 0.212 +- 0.208
Model Accuracy over intervened graphs for r=0.1 =  0.94
NEC for r=0.1 class 1.0 = 0.057 +- 0.248 (in-sample avg dev_std = 0.139)
NEC for r=0.1 all KL = 0.073 +- 0.248 (in-sample avg dev_std = 0.139)
NEC for r=0.1 all L1 = 0.057 +- 0.202 (in-sample avg dev_std = 0.139)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08374368231046933
len(reference) = 277
Effective ratio: 0.126 +- 0.139
Model Accuracy over intervened graphs for r=0.25 =  0.988
NEC for r=0.25 class 1.0 = 0.011 +- 0.113 (in-sample avg dev_std = 0.055)
NEC for r=0.25 all KL = 0.014 +- 0.113 (in-sample avg dev_std = 0.055)
NEC for r=0.25 all L1 = 0.011 +- 0.092 (in-sample avg dev_std = 0.055)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03984476534296029
len(reference) = 277
Effective ratio: 0.027 +- 0.049
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.94
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013517857142857142
len(reference) = 2520
Effective ratio: 0.109 +- 0.034
Model Accuracy over intervened graphs for r=0.01 =  0.855
NEC for r=0.01 class 1.0 = 0.076 +- 0.266 (in-sample avg dev_std = 0.034)
NEC for r=0.01 all KL = 0.083 +- 0.266 (in-sample avg dev_std = 0.034)
NEC for r=0.01 all L1 = 0.076 +- 0.236 (in-sample avg dev_std = 0.034)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013257936507936507
len(reference) = 2520
Effective ratio: 0.026 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.938
NEC for r=0.1 class 1.0 = 0.001 +- 0.034 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.001 +- 0.034 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.001 +- 0.029 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.94
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01353968253968254
len(reference) = 2520
Effective ratio: 0.016 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.939
NEC for r=0.25 class 1.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.014 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.012710714285714285
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.939
NEC for r=0.6 class 1.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.014 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.982
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11274513776337115
len(reference) = 2468
Effective ratio: 0.310 +- 0.406
Model Accuracy over intervened graphs for r=0.01 =  0.963
NEC for r=0.01 class 1.0 = 0.062 +- 0.271 (in-sample avg dev_std = 0.310)
NEC for r=0.01 all KL = 0.112 +- 0.271 (in-sample avg dev_std = 0.310)
NEC for r=0.01 all L1 = 0.062 +- 0.170 (in-sample avg dev_std = 0.310)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11258589951377634
len(reference) = 2468
Effective ratio: 0.250 +- 0.370
Model Accuracy over intervened graphs for r=0.1 =  0.966
NEC for r=0.1 class 1.0 = 0.055 +- 0.253 (in-sample avg dev_std = 0.266)
NEC for r=0.1 all KL = 0.091 +- 0.253 (in-sample avg dev_std = 0.266)
NEC for r=0.1 all L1 = 0.055 +- 0.170 (in-sample avg dev_std = 0.266)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.982
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.1108776337115073
len(reference) = 2468
Effective ratio: 0.199 +- 0.331
Model Accuracy over intervened graphs for r=0.25 =  0.968
NEC for r=0.25 class 1.0 = 0.046 +- 0.233 (in-sample avg dev_std = 0.217)
NEC for r=0.25 all KL = 0.071 +- 0.233 (in-sample avg dev_std = 0.217)
NEC for r=0.25 all L1 = 0.046 +- 0.168 (in-sample avg dev_std = 0.217)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.982
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08873298217179902
len(reference) = 2468
Effective ratio: 0.086 +- 0.197
Model Accuracy over intervened graphs for r=0.6 =  0.977
NEC for r=0.6 class 1.0 = 0.025 +- 0.167 (in-sample avg dev_std = 0.069)
NEC for r=0.6 all KL = 0.03 +- 0.167 (in-sample avg dev_std = 0.069)
NEC for r=0.6 all L1 = 0.025 +- 0.139 (in-sample avg dev_std = 0.069)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 00:42:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 12:42:33 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 12:42:33 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 12:42:33 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 12:42:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:42:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:42:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:42:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:42:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:42:33 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 12:42:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.094
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.092
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.090
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.055
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.014
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.014
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.014
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.112
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.112
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.110
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.089


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09387725631768952
len(reference) = 257
Effective ratio: 0.371 +- 0.272
Model Accuracy over intervened graphs for r=0.01 =  0.54
SUFF_SIMPLE for r=0.01 class 1.0 = 0.51 +- 0.396 (in-sample avg dev_std = 0.712)
SUFF_SIMPLE for r=0.01 all KL = 0.305 +- 0.396 (in-sample avg dev_std = 0.712)
SUFF_SIMPLE for r=0.01 all L1 = 0.51 +- 0.325 (in-sample avg dev_std = 0.712)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.09160288808664259
len(reference) = 276
Effective ratio: 0.156 +- 0.151
Model Accuracy over intervened graphs for r=0.1 =  0.572
SUFF_SIMPLE for r=0.1 class 1.0 = 0.519 +- 0.364 (in-sample avg dev_std = 0.778)
SUFF_SIMPLE for r=0.1 all KL = 0.282 +- 0.364 (in-sample avg dev_std = 0.778)
SUFF_SIMPLE for r=0.1 all L1 = 0.519 +- 0.296 (in-sample avg dev_std = 0.778)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09044404332129963
len(reference) = 277
Effective ratio: 0.139 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.572
SUFF_SIMPLE for r=0.25 class 1.0 = 0.522 +- 0.381 (in-sample avg dev_std = 0.767)
SUFF_SIMPLE for r=0.25 all KL = 0.299 +- 0.381 (in-sample avg dev_std = 0.767)
SUFF_SIMPLE for r=0.25 all L1 = 0.522 +- 0.308 (in-sample avg dev_std = 0.767)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.054642599277978335
len(reference) = 277
Effective ratio: 0.023 +- 0.035
Model Accuracy over intervened graphs for r=0.6 =  0.551
SUFF_SIMPLE for r=0.6 class 1.0 = 0.473 +- 0.259 (in-sample avg dev_std = 0.867)
SUFF_SIMPLE for r=0.6 all KL = 0.189 +- 0.259 (in-sample avg dev_std = 0.867)
SUFF_SIMPLE for r=0.6 all L1 = 0.473 +- 0.240 (in-sample avg dev_std = 0.867)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013948015873015874
len(reference) = 2520
Effective ratio: 0.048 +- 0.016
Model Accuracy over intervened graphs for r=0.01 =  0.715
SUFF_SIMPLE for r=0.01 class 1.0 = 0.629 +- 0.343 (in-sample avg dev_std = 0.808)
SUFF_SIMPLE for r=0.01 all KL = 0.412 +- 0.343 (in-sample avg dev_std = 0.808)
SUFF_SIMPLE for r=0.01 all L1 = 0.629 +- 0.230 (in-sample avg dev_std = 0.808)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014033730158730159
len(reference) = 2520
Effective ratio: 0.024 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.709
SUFF_SIMPLE for r=0.1 class 1.0 = 0.623 +- 0.343 (in-sample avg dev_std = 0.815)
SUFF_SIMPLE for r=0.1 all KL = 0.404 +- 0.343 (in-sample avg dev_std = 0.815)
SUFF_SIMPLE for r=0.1 all L1 = 0.623 +- 0.232 (in-sample avg dev_std = 0.815)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013994444444444443
len(reference) = 2520
Effective ratio: 0.023 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.714
SUFF_SIMPLE for r=0.25 class 1.0 = 0.626 +- 0.338 (in-sample avg dev_std = 0.812)
SUFF_SIMPLE for r=0.25 all KL = 0.406 +- 0.338 (in-sample avg dev_std = 0.812)
SUFF_SIMPLE for r=0.25 all L1 = 0.626 +- 0.228 (in-sample avg dev_std = 0.812)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.014190476190476193
len(reference) = 2520
Effective ratio: 0.003 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.715
SUFF_SIMPLE for r=0.6 class 1.0 = 0.627 +- 0.341 (in-sample avg dev_std = 0.812)
SUFF_SIMPLE for r=0.6 all KL = 0.407 +- 0.341 (in-sample avg dev_std = 0.812)
SUFF_SIMPLE for r=0.6 all L1 = 0.627 +- 0.229 (in-sample avg dev_std = 0.812)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.997
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.1123982982171799
len(reference) = 1988
Effective ratio: 0.284 +- 0.395
Model Accuracy over intervened graphs for r=0.01 =  0.815
SUFF_SIMPLE for r=0.01 class 1.0 = 0.803 +- 0.410 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.01 all KL = 0.709 +- 0.410 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.01 all L1 = 0.803 +- 0.309 (in-sample avg dev_std = 0.442)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.111652755267423
len(reference) = 2182
Effective ratio: 0.210 +- 0.336
Model Accuracy over intervened graphs for r=0.1 =  0.83
SUFF_SIMPLE for r=0.1 class 1.0 = 0.817 +- 0.403 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.1 all KL = 0.731 +- 0.403 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.1 all L1 = 0.817 +- 0.301 (in-sample avg dev_std = 0.431)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.967
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10954862236628848
len(reference) = 2368
Effective ratio: 0.167 +- 0.270
Model Accuracy over intervened graphs for r=0.25 =  0.828
SUFF_SIMPLE for r=0.25 class 1.0 = 0.811 +- 0.407 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.25 all KL = 0.729 +- 0.407 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.25 all L1 = 0.811 +- 0.310 (in-sample avg dev_std = 0.415)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.966
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08894327390599675
len(reference) = 2442
Effective ratio: 0.083 +- 0.187
Model Accuracy over intervened graphs for r=0.6 =  0.779
SUFF_SIMPLE for r=0.6 class 1.0 = 0.756 +- 0.427 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.6 all KL = 0.628 +- 0.427 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.6 all L1 = 0.756 +- 0.317 (in-sample avg dev_std = 0.521)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09387725631768952
len(reference) = 277
Effective ratio: 0.371 +- 0.272
Model Accuracy over intervened graphs for r=0.01 =  0.678
NEC for r=0.01 class 1.0 = 0.338 +- 0.469 (in-sample avg dev_std = 0.580)
NEC for r=0.01 all KL = 0.468 +- 0.469 (in-sample avg dev_std = 0.580)
NEC for r=0.01 all L1 = 0.338 +- 0.361 (in-sample avg dev_std = 0.580)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.09160288808664259
len(reference) = 277
Effective ratio: 0.156 +- 0.151
Model Accuracy over intervened graphs for r=0.1 =  0.872
NEC for r=0.1 class 1.0 = 0.113 +- 0.337 (in-sample avg dev_std = 0.112)
NEC for r=0.1 all KL = 0.134 +- 0.337 (in-sample avg dev_std = 0.112)
NEC for r=0.1 all L1 = 0.113 +- 0.287 (in-sample avg dev_std = 0.112)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09044404332129963
len(reference) = 277
Effective ratio: 0.139 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.877
NEC for r=0.25 class 1.0 = 0.106 +- 0.328 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.123 +- 0.328 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.106 +- 0.284 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.054642599277978335
len(reference) = 277
Effective ratio: 0.023 +- 0.035
Model Accuracy over intervened graphs for r=0.6 =  0.982
NEC for r=0.6 class 1.0 = 0.016 +- 0.133 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.018 +- 0.133 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.016 +- 0.115 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013948015873015874
len(reference) = 2520
Effective ratio: 0.048 +- 0.016
Model Accuracy over intervened graphs for r=0.01 =  0.978
NEC for r=0.01 class 1.0 = 0.019 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.022 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.019 +- 0.125 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014033730158730159
len(reference) = 2520
Effective ratio: 0.024 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.998
NEC for r=0.1 class 1.0 = 0.002 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.002 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.002 +- 0.038 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013994444444444443
len(reference) = 2520
Effective ratio: 0.023 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.998
NEC for r=0.25 class 1.0 = 0.001 +- 0.040 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.002 +- 0.040 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.001 +- 0.034 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.014190476190476193
len(reference) = 2520
Effective ratio: 0.003 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.966
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.1123982982171799
len(reference) = 2468
Effective ratio: 0.284 +- 0.395
Model Accuracy over intervened graphs for r=0.01 =  0.876
NEC for r=0.01 class 1.0 = 0.139 +- 0.378 (in-sample avg dev_std = 0.411)
NEC for r=0.01 all KL = 0.202 +- 0.378 (in-sample avg dev_std = 0.411)
NEC for r=0.01 all L1 = 0.139 +- 0.272 (in-sample avg dev_std = 0.411)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.966
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.111652755267423
len(reference) = 2468
Effective ratio: 0.210 +- 0.336
Model Accuracy over intervened graphs for r=0.1 =  0.893
NEC for r=0.1 class 1.0 = 0.111 +- 0.343 (in-sample avg dev_std = 0.313)
NEC for r=0.1 all KL = 0.154 +- 0.343 (in-sample avg dev_std = 0.313)
NEC for r=0.1 all L1 = 0.111 +- 0.260 (in-sample avg dev_std = 0.313)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.966
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10954862236628848
len(reference) = 2468
Effective ratio: 0.167 +- 0.270
Model Accuracy over intervened graphs for r=0.25 =  0.899
NEC for r=0.25 class 1.0 = 0.095 +- 0.317 (in-sample avg dev_std = 0.207)
NEC for r=0.25 all KL = 0.123 +- 0.317 (in-sample avg dev_std = 0.207)
NEC for r=0.25 all L1 = 0.095 +- 0.255 (in-sample avg dev_std = 0.207)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.966
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08894327390599675
len(reference) = 2468
Effective ratio: 0.083 +- 0.187
Model Accuracy over intervened graphs for r=0.6 =  0.935
NEC for r=0.6 class 1.0 = 0.047 +- 0.227 (in-sample avg dev_std = 0.105)
NEC for r=0.6 all KL = 0.058 +- 0.227 (in-sample avg dev_std = 0.105)
NEC for r=0.6 all L1 = 0.047 +- 0.189 (in-sample avg dev_std = 0.105)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 00:47:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 12:47:52 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 12:47:52 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 12:47:52 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 12:47:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:47:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:47:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:47:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:47:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:47:52 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 12:47:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.101
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.100
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.099
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.057
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.013
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.013
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.113
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.113
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.112
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.099


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10103971119133574
len(reference) = 242
Effective ratio: 0.641 +- 0.222
Model Accuracy over intervened graphs for r=0.01 =  0.772
SUFF_SIMPLE for r=0.01 class 1.0 = 0.744 +- 0.420 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.01 all KL = 0.631 +- 0.420 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.01 all L1 = 0.744 +- 0.317 (in-sample avg dev_std = 0.557)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.10011913357400722
len(reference) = 269
Effective ratio: 0.241 +- 0.207
Model Accuracy over intervened graphs for r=0.1 =  0.764
SUFF_SIMPLE for r=0.1 class 1.0 = 0.711 +- 0.402 (in-sample avg dev_std = 0.658)
SUFF_SIMPLE for r=0.1 all KL = 0.554 +- 0.402 (in-sample avg dev_std = 0.658)
SUFF_SIMPLE for r=0.1 all L1 = 0.711 +- 0.288 (in-sample avg dev_std = 0.658)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.0986101083032491
len(reference) = 276
Effective ratio: 0.152 +- 0.141
Model Accuracy over intervened graphs for r=0.25 =  0.79
SUFF_SIMPLE for r=0.25 class 1.0 = 0.737 +- 0.387 (in-sample avg dev_std = 0.637)
SUFF_SIMPLE for r=0.25 all KL = 0.583 +- 0.387 (in-sample avg dev_std = 0.637)
SUFF_SIMPLE for r=0.25 all L1 = 0.737 +- 0.275 (in-sample avg dev_std = 0.637)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05745487364620938
len(reference) = 277
Effective ratio: 0.030 +- 0.056
Model Accuracy over intervened graphs for r=0.6 =  0.783
SUFF_SIMPLE for r=0.6 class 1.0 = 0.713 +- 0.378 (in-sample avg dev_std = 0.710)
SUFF_SIMPLE for r=0.6 all KL = 0.529 +- 0.378 (in-sample avg dev_std = 0.710)
SUFF_SIMPLE for r=0.6 all L1 = 0.713 +- 0.257 (in-sample avg dev_std = 0.710)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.638
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013122619047619048
len(reference) = 2520
Effective ratio: 0.286 +- 0.071
Model Accuracy over intervened graphs for r=0.01 =  0.619
SUFF_SIMPLE for r=0.01 class 1.0 = 0.885 +- 0.303 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.01 all KL = 0.832 +- 0.303 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.01 all L1 = 0.885 +- 0.219 (in-sample avg dev_std = 0.403)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013186507936507936
len(reference) = 2520
Effective ratio: 0.043 +- 0.013
Model Accuracy over intervened graphs for r=0.1 =  0.617
SUFF_SIMPLE for r=0.1 class 1.0 = 0.883 +- 0.299 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.1 all KL = 0.826 +- 0.299 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.1 all L1 = 0.883 +- 0.215 (in-sample avg dev_std = 0.416)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.638
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013166666666666669
len(reference) = 2520
Effective ratio: 0.022 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.618
SUFF_SIMPLE for r=0.25 class 1.0 = 0.883 +- 0.301 (in-sample avg dev_std = 0.412)
SUFF_SIMPLE for r=0.25 all KL = 0.828 +- 0.301 (in-sample avg dev_std = 0.412)
SUFF_SIMPLE for r=0.25 all L1 = 0.883 +- 0.217 (in-sample avg dev_std = 0.412)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.638
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.011692857142857142
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.615
SUFF_SIMPLE for r=0.6 class 1.0 = 0.879 +- 0.306 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.6 all KL = 0.822 +- 0.306 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.6 all L1 = 0.879 +- 0.219 (in-sample avg dev_std = 0.422)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11334238249594814
len(reference) = 1901
Effective ratio: 0.323 +- 0.412
Model Accuracy over intervened graphs for r=0.01 =  0.919
SUFF_SIMPLE for r=0.01 class 1.0 = 0.901 +- 0.308 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.01 all KL = 0.843 +- 0.308 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.01 all L1 = 0.901 +- 0.213 (in-sample avg dev_std = 0.383)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1131114262560778
len(reference) = 2053
Effective ratio: 0.258 +- 0.374
Model Accuracy over intervened graphs for r=0.1 =  0.907
SUFF_SIMPLE for r=0.1 class 1.0 = 0.894 +- 0.319 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.1 all KL = 0.841 +- 0.319 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.1 all L1 = 0.894 +- 0.232 (in-sample avg dev_std = 0.362)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.998
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11242260940032416
len(reference) = 2177
Effective ratio: 0.209 +- 0.336
Model Accuracy over intervened graphs for r=0.25 =  0.91
SUFF_SIMPLE for r=0.25 class 1.0 = 0.895 +- 0.317 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.25 all KL = 0.841 +- 0.317 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.25 all L1 = 0.895 +- 0.227 (in-sample avg dev_std = 0.367)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.09925688816855754
len(reference) = 2376
Effective ratio: 0.115 +- 0.257
Model Accuracy over intervened graphs for r=0.6 =  0.911
SUFF_SIMPLE for r=0.6 class 1.0 = 0.888 +- 0.322 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.6 all KL = 0.825 +- 0.322 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.6 all L1 = 0.888 +- 0.226 (in-sample avg dev_std = 0.394)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10103971119133574
len(reference) = 277
Effective ratio: 0.641 +- 0.222
Model Accuracy over intervened graphs for r=0.01 =  0.829
NEC for r=0.01 class 1.0 = 0.229 +- 0.382 (in-sample avg dev_std = 0.640)
NEC for r=0.01 all KL = 0.38 +- 0.382 (in-sample avg dev_std = 0.640)
NEC for r=0.01 all L1 = 0.229 +- 0.252 (in-sample avg dev_std = 0.640)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.10011913357400722
len(reference) = 277
Effective ratio: 0.241 +- 0.207
Model Accuracy over intervened graphs for r=0.1 =  0.898
NEC for r=0.1 class 1.0 = 0.097 +- 0.312 (in-sample avg dev_std = 0.203)
NEC for r=0.1 all KL = 0.122 +- 0.312 (in-sample avg dev_std = 0.203)
NEC for r=0.1 all L1 = 0.097 +- 0.255 (in-sample avg dev_std = 0.203)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.0986101083032491
len(reference) = 277
Effective ratio: 0.152 +- 0.141
Model Accuracy over intervened graphs for r=0.25 =  0.953
NEC for r=0.25 class 1.0 = 0.041 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.047 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.041 +- 0.182 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05745487364620938
len(reference) = 277
Effective ratio: 0.030 +- 0.056
Model Accuracy over intervened graphs for r=0.6 =  0.993
NEC for r=0.6 class 1.0 = 0.006 +- 0.084 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.007 +- 0.084 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.006 +- 0.073 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.638
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013122619047619048
len(reference) = 2520
Effective ratio: 0.286 +- 0.071
Model Accuracy over intervened graphs for r=0.01 =  0.212
NEC for r=0.01 class 1.0 = 0.43 +- 0.452 (in-sample avg dev_std = 0.490)
NEC for r=0.01 all KL = 0.521 +- 0.452 (in-sample avg dev_std = 0.490)
NEC for r=0.01 all L1 = 0.43 +- 0.375 (in-sample avg dev_std = 0.490)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013186507936507936
len(reference) = 2520
Effective ratio: 0.043 +- 0.013
Model Accuracy over intervened graphs for r=0.1 =  0.471
NEC for r=0.1 class 1.0 = 0.153 +- 0.361 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.169 +- 0.361 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.153 +- 0.317 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.638
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013166666666666669
len(reference) = 2520
Effective ratio: 0.022 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.578
NEC for r=0.25 class 1.0 = 0.059 +- 0.232 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.064 +- 0.232 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.059 +- 0.207 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.638
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.011692857142857142
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.633
NEC for r=0.6 class 1.0 = 0.008 +- 0.067 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.007 +- 0.067 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.008 +- 0.068 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.987
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11334238249594814
len(reference) = 2468
Effective ratio: 0.323 +- 0.412
Model Accuracy over intervened graphs for r=0.01 =  0.944
NEC for r=0.01 class 1.0 = 0.077 +- 0.280 (in-sample avg dev_std = 0.324)
NEC for r=0.01 all KL = 0.124 +- 0.280 (in-sample avg dev_std = 0.324)
NEC for r=0.01 all L1 = 0.077 +- 0.193 (in-sample avg dev_std = 0.324)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1131114262560778
len(reference) = 2468
Effective ratio: 0.258 +- 0.374
Model Accuracy over intervened graphs for r=0.1 =  0.96
NEC for r=0.1 class 1.0 = 0.056 +- 0.242 (in-sample avg dev_std = 0.258)
NEC for r=0.1 all KL = 0.086 +- 0.242 (in-sample avg dev_std = 0.258)
NEC for r=0.1 all L1 = 0.056 +- 0.173 (in-sample avg dev_std = 0.258)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.987
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11242260940032416
len(reference) = 2468
Effective ratio: 0.209 +- 0.336
Model Accuracy over intervened graphs for r=0.25 =  0.967
NEC for r=0.25 class 1.0 = 0.044 +- 0.219 (in-sample avg dev_std = 0.212)
NEC for r=0.25 all KL = 0.065 +- 0.219 (in-sample avg dev_std = 0.212)
NEC for r=0.25 all L1 = 0.044 +- 0.162 (in-sample avg dev_std = 0.212)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.09925688816855754
len(reference) = 2468
Effective ratio: 0.115 +- 0.257
Model Accuracy over intervened graphs for r=0.6 =  0.973
NEC for r=0.6 class 1.0 = 0.027 +- 0.173 (in-sample avg dev_std = 0.121)
NEC for r=0.6 all KL = 0.036 +- 0.173 (in-sample avg dev_std = 0.121)
NEC for r=0.6 all L1 = 0.027 +- 0.138 (in-sample avg dev_std = 0.121)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 00:53:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 12:53:46 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 12:53:46 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 12:53:46 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 12:53:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:53:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:53:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:53:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:53:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:53:46 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 12:53:46 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.099
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.099
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.099
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.071
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.014
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.014
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.011
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.111
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.111
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.111
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.092


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09894945848375451
len(reference) = 276
Effective ratio: 0.201 +- 0.146
Model Accuracy over intervened graphs for r=0.01 =  0.871
SUFF_SIMPLE for r=0.01 class 1.0 = 0.838 +- 0.338 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.01 all KL = 0.745 +- 0.338 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.01 all L1 = 0.838 +- 0.239 (in-sample avg dev_std = 0.467)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.09866425992779786
len(reference) = 276
Effective ratio: 0.167 +- 0.135
Model Accuracy over intervened graphs for r=0.1 =  0.873
SUFF_SIMPLE for r=0.1 class 1.0 = 0.832 +- 0.330 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.1 all KL = 0.728 +- 0.330 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.1 all L1 = 0.832 +- 0.230 (in-sample avg dev_std = 0.486)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09904693140794224
len(reference) = 276
Effective ratio: 0.164 +- 0.135
Model Accuracy over intervened graphs for r=0.25 =  0.861
SUFF_SIMPLE for r=0.25 class 1.0 = 0.822 +- 0.340 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.25 all KL = 0.717 +- 0.340 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.25 all L1 = 0.822 +- 0.240 (in-sample avg dev_std = 0.495)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07073285198555956
len(reference) = 276
Effective ratio: 0.030 +- 0.072
Model Accuracy over intervened graphs for r=0.6 =  0.772
SUFF_SIMPLE for r=0.6 class 1.0 = 0.737 +- 0.377 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.6 all KL = 0.605 +- 0.377 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.6 all L1 = 0.737 +- 0.295 (in-sample avg dev_std = 0.556)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.731
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013592063492063494
len(reference) = 2520
Effective ratio: 0.034 +- 0.009
Model Accuracy over intervened graphs for r=0.01 =  0.723
SUFF_SIMPLE for r=0.01 class 1.0 = 0.986 +- 0.107 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.01 all KL = 0.974 +- 0.107 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.01 all L1 = 0.986 +- 0.053 (in-sample avg dev_std = 0.165)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01363015873015873
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.722
SUFF_SIMPLE for r=0.1 class 1.0 = 0.985 +- 0.110 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.1 all KL = 0.972 +- 0.110 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.1 all L1 = 0.985 +- 0.055 (in-sample avg dev_std = 0.172)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.731
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013629365079365081
len(reference) = 2520
Effective ratio: 0.024 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.722
SUFF_SIMPLE for r=0.25 class 1.0 = 0.984 +- 0.113 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.25 all KL = 0.969 +- 0.113 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.25 all L1 = 0.984 +- 0.056 (in-sample avg dev_std = 0.176)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.731
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.011222222222222222
len(reference) = 2520
Effective ratio: 0.004 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.723
SUFF_SIMPLE for r=0.6 class 1.0 = 0.986 +- 0.106 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.6 all KL = 0.973 +- 0.106 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.6 all L1 = 0.986 +- 0.053 (in-sample avg dev_std = 0.165)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11124230145867099
len(reference) = 2213
Effective ratio: 0.225 +- 0.330
Model Accuracy over intervened graphs for r=0.01 =  0.812
SUFF_SIMPLE for r=0.01 class 1.0 = 0.75 +- 0.366 (in-sample avg dev_std = 0.654)
SUFF_SIMPLE for r=0.01 all KL = 0.599 +- 0.366 (in-sample avg dev_std = 0.654)
SUFF_SIMPLE for r=0.01 all L1 = 0.75 +- 0.252 (in-sample avg dev_std = 0.654)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11107009724473257
len(reference) = 2306
Effective ratio: 0.193 +- 0.293
Model Accuracy over intervened graphs for r=0.1 =  0.811
SUFF_SIMPLE for r=0.1 class 1.0 = 0.753 +- 0.372 (in-sample avg dev_std = 0.636)
SUFF_SIMPLE for r=0.1 all KL = 0.61 +- 0.372 (in-sample avg dev_std = 0.636)
SUFF_SIMPLE for r=0.1 all L1 = 0.753 +- 0.259 (in-sample avg dev_std = 0.636)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11074149108589952
len(reference) = 2334
Effective ratio: 0.185 +- 0.283
Model Accuracy over intervened graphs for r=0.25 =  0.807
SUFF_SIMPLE for r=0.25 class 1.0 = 0.749 +- 0.372 (in-sample avg dev_std = 0.641)
SUFF_SIMPLE for r=0.25 all KL = 0.602 +- 0.372 (in-sample avg dev_std = 0.641)
SUFF_SIMPLE for r=0.25 all L1 = 0.749 +- 0.259 (in-sample avg dev_std = 0.641)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0918820907617504
len(reference) = 2379
Effective ratio: 0.097 +- 0.217
Model Accuracy over intervened graphs for r=0.6 =  0.643
SUFF_SIMPLE for r=0.6 class 1.0 = 0.595 +- 0.368 (in-sample avg dev_std = 0.701)
SUFF_SIMPLE for r=0.6 all KL = 0.414 +- 0.368 (in-sample avg dev_std = 0.701)
SUFF_SIMPLE for r=0.6 all L1 = 0.595 +- 0.301 (in-sample avg dev_std = 0.701)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09894945848375451
len(reference) = 277
Effective ratio: 0.201 +- 0.146
Model Accuracy over intervened graphs for r=0.01 =  0.926
NEC for r=0.01 class 1.0 = 0.066 +- 0.261 (in-sample avg dev_std = 0.061)
NEC for r=0.01 all KL = 0.076 +- 0.261 (in-sample avg dev_std = 0.061)
NEC for r=0.01 all L1 = 0.066 +- 0.224 (in-sample avg dev_std = 0.061)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.09866425992779786
len(reference) = 277
Effective ratio: 0.167 +- 0.135
Model Accuracy over intervened graphs for r=0.1 =  0.945
NEC for r=0.1 class 1.0 = 0.048 +- 0.226 (in-sample avg dev_std = 0.042)
NEC for r=0.1 all KL = 0.056 +- 0.226 (in-sample avg dev_std = 0.042)
NEC for r=0.1 all L1 = 0.048 +- 0.196 (in-sample avg dev_std = 0.042)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09904693140794224
len(reference) = 277
Effective ratio: 0.164 +- 0.135
Model Accuracy over intervened graphs for r=0.25 =  0.954
NEC for r=0.25 class 1.0 = 0.041 +- 0.209 (in-sample avg dev_std = 0.060)
NEC for r=0.25 all KL = 0.047 +- 0.209 (in-sample avg dev_std = 0.060)
NEC for r=0.25 all L1 = 0.041 +- 0.180 (in-sample avg dev_std = 0.060)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07073285198555956
len(reference) = 277
Effective ratio: 0.030 +- 0.072
Model Accuracy over intervened graphs for r=0.6 =  0.995
NEC for r=0.6 class 1.0 = 0.005 +- 0.073 (in-sample avg dev_std = 0.053)
NEC for r=0.6 all KL = 0.006 +- 0.073 (in-sample avg dev_std = 0.053)
NEC for r=0.6 all L1 = 0.005 +- 0.057 (in-sample avg dev_std = 0.053)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.731
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013592063492063494
len(reference) = 2520
Effective ratio: 0.034 +- 0.009
Model Accuracy over intervened graphs for r=0.01 =  0.725
NEC for r=0.01 class 1.0 = 0.005 +- 0.070 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.005 +- 0.070 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.005 +- 0.062 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01363015873015873
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.729
NEC for r=0.1 class 1.0 = 0.002 +- 0.040 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.002 +- 0.040 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.002 +- 0.035 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.731
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013629365079365081
len(reference) = 2520
Effective ratio: 0.024 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.729
NEC for r=0.25 class 1.0 = 0.002 +- 0.040 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.002 +- 0.040 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.002 +- 0.035 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.731
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.011222222222222222
len(reference) = 2520
Effective ratio: 0.004 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.73
NEC for r=0.6 class 1.0 = 0.0 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.017 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11124230145867099
len(reference) = 2468
Effective ratio: 0.225 +- 0.330
Model Accuracy over intervened graphs for r=0.01 =  0.861
NEC for r=0.01 class 1.0 = 0.134 +- 0.363 (in-sample avg dev_std = 0.289)
NEC for r=0.01 all KL = 0.167 +- 0.363 (in-sample avg dev_std = 0.289)
NEC for r=0.01 all L1 = 0.134 +- 0.295 (in-sample avg dev_std = 0.289)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11107009724473257
len(reference) = 2468
Effective ratio: 0.193 +- 0.293
Model Accuracy over intervened graphs for r=0.1 =  0.888
NEC for r=0.1 class 1.0 = 0.108 +- 0.331 (in-sample avg dev_std = 0.242)
NEC for r=0.1 all KL = 0.133 +- 0.331 (in-sample avg dev_std = 0.242)
NEC for r=0.1 all L1 = 0.108 +- 0.270 (in-sample avg dev_std = 0.242)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11074149108589952
len(reference) = 2468
Effective ratio: 0.185 +- 0.283
Model Accuracy over intervened graphs for r=0.25 =  0.894
NEC for r=0.25 class 1.0 = 0.102 +- 0.323 (in-sample avg dev_std = 0.230)
NEC for r=0.25 all KL = 0.126 +- 0.323 (in-sample avg dev_std = 0.230)
NEC for r=0.25 all L1 = 0.102 +- 0.263 (in-sample avg dev_std = 0.230)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0918820907617504
len(reference) = 2468
Effective ratio: 0.097 +- 0.217
Model Accuracy over intervened graphs for r=0.6 =  0.943
NEC for r=0.6 class 1.0 = 0.055 +- 0.247 (in-sample avg dev_std = 0.187)
NEC for r=0.6 all KL = 0.069 +- 0.247 (in-sample avg dev_std = 0.187)
NEC for r=0.6 all L1 = 0.055 +- 0.199 (in-sample avg dev_std = 0.187)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 00:58:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 12:58:44 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 12:58:44 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 12:58:44 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 12:58:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:58:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:58:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:58:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 12:58:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 12:58:44 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 12:58:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.094
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.093
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.091
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.013
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.014
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.112
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.111
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.110
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.091


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.0944115523465704
len(reference) = 264
Effective ratio: 0.404 +- 0.220
Model Accuracy over intervened graphs for r=0.01 =  0.353
SUFF_SIMPLE for r=0.01 class 1.0 = 0.347 +- 0.336 (in-sample avg dev_std = 0.704)
SUFF_SIMPLE for r=0.01 all KL = 0.151 +- 0.336 (in-sample avg dev_std = 0.704)
SUFF_SIMPLE for r=0.01 all L1 = 0.347 +- 0.280 (in-sample avg dev_std = 0.704)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0932129963898917
len(reference) = 275
Effective ratio: 0.179 +- 0.154
Model Accuracy over intervened graphs for r=0.1 =  0.363
SUFF_SIMPLE for r=0.1 class 1.0 = 0.343 +- 0.298 (in-sample avg dev_std = 0.777)
SUFF_SIMPLE for r=0.1 all KL = 0.123 +- 0.298 (in-sample avg dev_std = 0.777)
SUFF_SIMPLE for r=0.1 all L1 = 0.343 +- 0.254 (in-sample avg dev_std = 0.777)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09055595667870037
len(reference) = 277
Effective ratio: 0.153 +- 0.129
Model Accuracy over intervened graphs for r=0.25 =  0.329
SUFF_SIMPLE for r=0.25 class 1.0 = 0.315 +- 0.277 (in-sample avg dev_std = 0.776)
SUFF_SIMPLE for r=0.25 all KL = 0.102 +- 0.277 (in-sample avg dev_std = 0.776)
SUFF_SIMPLE for r=0.25 all L1 = 0.315 +- 0.236 (in-sample avg dev_std = 0.776)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05894945848375451
len(reference) = 277
Effective ratio: 0.026 +- 0.040
Model Accuracy over intervened graphs for r=0.6 =  0.278
SUFF_SIMPLE for r=0.6 class 1.0 = 0.259 +- 0.093 (in-sample avg dev_std = 0.825)
SUFF_SIMPLE for r=0.6 all KL = 0.024 +- 0.093 (in-sample avg dev_std = 0.825)
SUFF_SIMPLE for r=0.6 all L1 = 0.259 +- 0.128 (in-sample avg dev_std = 0.825)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.768
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013351587301587302
len(reference) = 2520
Effective ratio: 0.266 +- 0.077
Model Accuracy over intervened graphs for r=0.01 =  0.1
SUFF_SIMPLE for r=0.01 class 1.0 = 0.323 +- 0.326 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.01 all KL = 0.241 +- 0.326 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.01 all L1 = 0.323 +- 0.254 (in-sample avg dev_std = 0.514)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013426190476190477
len(reference) = 2520
Effective ratio: 0.028 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.098
SUFF_SIMPLE for r=0.1 class 1.0 = 0.323 +- 0.326 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.1 all KL = 0.24 +- 0.326 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.1 all L1 = 0.323 +- 0.254 (in-sample avg dev_std = 0.521)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.768
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013577380952380954
len(reference) = 2520
Effective ratio: 0.020 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.098
SUFF_SIMPLE for r=0.25 class 1.0 = 0.321 +- 0.321 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.25 all KL = 0.237 +- 0.321 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.25 all L1 = 0.321 +- 0.251 (in-sample avg dev_std = 0.516)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.768
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013490873015873015
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.101
SUFF_SIMPLE for r=0.6 class 1.0 = 0.321 +- 0.322 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.6 all KL = 0.238 +- 0.322 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.6 all L1 = 0.321 +- 0.251 (in-sample avg dev_std = 0.518)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.995
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11166410048622366
len(reference) = 2011
Effective ratio: 0.279 +- 0.384
Model Accuracy over intervened graphs for r=0.01 =  0.591
SUFF_SIMPLE for r=0.01 class 1.0 = 0.537 +- 0.348 (in-sample avg dev_std = 0.756)
SUFF_SIMPLE for r=0.01 all KL = 0.268 +- 0.348 (in-sample avg dev_std = 0.756)
SUFF_SIMPLE for r=0.01 all L1 = 0.537 +- 0.287 (in-sample avg dev_std = 0.756)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11124189627228523
len(reference) = 2156
Effective ratio: 0.225 +- 0.344
Model Accuracy over intervened graphs for r=0.1 =  0.552
SUFF_SIMPLE for r=0.1 class 1.0 = 0.517 +- 0.346 (in-sample avg dev_std = 0.725)
SUFF_SIMPLE for r=0.1 all KL = 0.259 +- 0.346 (in-sample avg dev_std = 0.725)
SUFF_SIMPLE for r=0.1 all L1 = 0.517 +- 0.297 (in-sample avg dev_std = 0.725)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.978
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11018962722852511
len(reference) = 2257
Effective ratio: 0.189 +- 0.306
Model Accuracy over intervened graphs for r=0.25 =  0.541
SUFF_SIMPLE for r=0.25 class 1.0 = 0.509 +- 0.354 (in-sample avg dev_std = 0.709)
SUFF_SIMPLE for r=0.25 all KL = 0.262 +- 0.354 (in-sample avg dev_std = 0.709)
SUFF_SIMPLE for r=0.25 all L1 = 0.509 +- 0.303 (in-sample avg dev_std = 0.709)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.966
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.09117949756888169
len(reference) = 2374
Effective ratio: 0.102 +- 0.247
Model Accuracy over intervened graphs for r=0.6 =  0.485
SUFF_SIMPLE for r=0.6 class 1.0 = 0.467 +- 0.318 (in-sample avg dev_std = 0.745)
SUFF_SIMPLE for r=0.6 all KL = 0.211 +- 0.318 (in-sample avg dev_std = 0.745)
SUFF_SIMPLE for r=0.6 all L1 = 0.467 +- 0.286 (in-sample avg dev_std = 0.745)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.0944115523465704
len(reference) = 277
Effective ratio: 0.404 +- 0.220
Model Accuracy over intervened graphs for r=0.01 =  0.619
NEC for r=0.01 class 1.0 = 0.419 +- 0.434 (in-sample avg dev_std = 0.660)
NEC for r=0.01 all KL = 0.615 +- 0.434 (in-sample avg dev_std = 0.660)
NEC for r=0.01 all L1 = 0.419 +- 0.336 (in-sample avg dev_std = 0.660)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0932129963898917
len(reference) = 277
Effective ratio: 0.179 +- 0.154
Model Accuracy over intervened graphs for r=0.1 =  0.81
NEC for r=0.1 class 1.0 = 0.176 +- 0.398 (in-sample avg dev_std = 0.070)
NEC for r=0.1 all KL = 0.211 +- 0.398 (in-sample avg dev_std = 0.070)
NEC for r=0.1 all L1 = 0.176 +- 0.337 (in-sample avg dev_std = 0.070)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09055595667870037
len(reference) = 277
Effective ratio: 0.153 +- 0.129
Model Accuracy over intervened graphs for r=0.25 =  0.838
NEC for r=0.25 class 1.0 = 0.147 +- 0.372 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.175 +- 0.372 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.147 +- 0.316 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05894945848375451
len(reference) = 277
Effective ratio: 0.026 +- 0.040
Model Accuracy over intervened graphs for r=0.6 =  0.989
NEC for r=0.6 class 1.0 = 0.009 +- 0.104 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.011 +- 0.104 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.009 +- 0.090 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.768
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013351587301587302
len(reference) = 2520
Effective ratio: 0.266 +- 0.077
Model Accuracy over intervened graphs for r=0.01 =  0.071
NEC for r=0.01 class 1.0 = 0.661 +- 0.364 (in-sample avg dev_std = 0.267)
NEC for r=0.01 all KL = 0.721 +- 0.364 (in-sample avg dev_std = 0.267)
NEC for r=0.01 all L1 = 0.661 +- 0.298 (in-sample avg dev_std = 0.267)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013426190476190477
len(reference) = 2520
Effective ratio: 0.028 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.529
NEC for r=0.1 class 1.0 = 0.296 +- 0.351 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.281 +- 0.351 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.296 +- 0.320 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.768
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013577380952380954
len(reference) = 2520
Effective ratio: 0.020 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.603
NEC for r=0.25 class 1.0 = 0.229 +- 0.298 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.195 +- 0.298 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.229 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.768
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013490873015873015
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.751
NEC for r=0.6 class 1.0 = 0.038 +- 0.067 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.012 +- 0.067 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.038 +- 0.093 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.947
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11166410048622366
len(reference) = 2468
Effective ratio: 0.279 +- 0.384
Model Accuracy over intervened graphs for r=0.01 =  0.745
NEC for r=0.01 class 1.0 = 0.211 +- 0.425 (in-sample avg dev_std = 0.291)
NEC for r=0.01 all KL = 0.257 +- 0.425 (in-sample avg dev_std = 0.291)
NEC for r=0.01 all L1 = 0.211 +- 0.354 (in-sample avg dev_std = 0.291)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.947
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11124189627228523
len(reference) = 2468
Effective ratio: 0.225 +- 0.344
Model Accuracy over intervened graphs for r=0.1 =  0.793
NEC for r=0.1 class 1.0 = 0.171 +- 0.394 (in-sample avg dev_std = 0.269)
NEC for r=0.1 all KL = 0.21 +- 0.394 (in-sample avg dev_std = 0.269)
NEC for r=0.1 all L1 = 0.171 +- 0.326 (in-sample avg dev_std = 0.269)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.947
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11018962722852511
len(reference) = 2468
Effective ratio: 0.189 +- 0.306
Model Accuracy over intervened graphs for r=0.25 =  0.826
NEC for r=0.25 class 1.0 = 0.147 +- 0.370 (in-sample avg dev_std = 0.233)
NEC for r=0.25 all KL = 0.178 +- 0.370 (in-sample avg dev_std = 0.233)
NEC for r=0.25 all L1 = 0.147 +- 0.308 (in-sample avg dev_std = 0.233)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.947
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.09117949756888169
len(reference) = 2468
Effective ratio: 0.102 +- 0.247
Model Accuracy over intervened graphs for r=0.6 =  0.894
NEC for r=0.6 class 1.0 = 0.081 +- 0.284 (in-sample avg dev_std = 0.178)
NEC for r=0.6 all KL = 0.098 +- 0.284 (in-sample avg dev_std = 0.178)
NEC for r=0.6 all L1 = 0.081 +- 0.236 (in-sample avg dev_std = 0.178)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.99, 0.987, 0.938, 0.928], 'all_L1': [0.994, 0.99, 0.963, 0.955]}), defaultdict(<class 'list'>, {'all_KL': [0.855, 0.789, 0.805, 0.75], 'all_L1': [0.924, 0.883, 0.894, 0.879]}), defaultdict(<class 'list'>, {'all_KL': [0.919, 0.867, 0.843, 0.823], 'all_L1': [0.946, 0.917, 0.908, 0.905]}), defaultdict(<class 'list'>, {'all_KL': [0.661, 0.621, 0.595, 0.634], 'all_L1': [0.78, 0.752, 0.754, 0.776]}), defaultdict(<class 'list'>, {'all_KL': [0.965, 0.966, 0.964, 0.879], 'all_L1': [0.981, 0.98, 0.978, 0.932]}), defaultdict(<class 'list'>, {'all_KL': [0.776, 0.706, 0.692, 0.695], 'all_L1': [0.889, 0.837, 0.824, 0.83]}), defaultdict(<class 'list'>, {'all_KL': [0.305, 0.282, 0.299, 0.189], 'all_L1': [0.51, 0.519, 0.522, 0.473]}), defaultdict(<class 'list'>, {'all_KL': [0.631, 0.554, 0.583, 0.529], 'all_L1': [0.744, 0.711, 0.737, 0.713]}), defaultdict(<class 'list'>, {'all_KL': [0.745, 0.728, 0.717, 0.605], 'all_L1': [0.838, 0.832, 0.822, 0.737]}), defaultdict(<class 'list'>, {'all_KL': [0.151, 0.123, 0.102, 0.024], 'all_L1': [0.347, 0.343, 0.315, 0.259]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.011, 0.007, 0.0, 0.0], 'all_L1': [0.008, 0.006, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.206, 0.051, 0.014, 0.004], 'all_L1': [0.105, 0.038, 0.012, 0.003]}), defaultdict(<class 'list'>, {'all_KL': [0.197, 0.049, 0.043, 0.011], 'all_L1': [0.115, 0.034, 0.036, 0.009]}), defaultdict(<class 'list'>, {'all_KL': [0.169, 0.056, 0.004, 0.0], 'all_L1': [0.122, 0.048, 0.003, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.009, 0.004, 0.0, 0.0], 'all_L1': [0.005, 0.003, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.224, 0.073, 0.014, 0.0], 'all_L1': [0.126, 0.057, 0.011, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.468, 0.134, 0.123, 0.018], 'all_L1': [0.338, 0.113, 0.106, 0.016]}), defaultdict(<class 'list'>, {'all_KL': [0.38, 0.122, 0.047, 0.007], 'all_L1': [0.229, 0.097, 0.041, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.076, 0.056, 0.047, 0.006], 'all_L1': [0.066, 0.048, 0.041, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.615, 0.211, 0.175, 0.011], 'all_L1': [0.419, 0.176, 0.147, 0.009]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.993, 0.994, 0.994, 0.993], 'all_L1': [0.997, 0.997, 0.997, 0.997]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.911, 0.912, 0.91, 0.91], 'all_L1': [0.948, 0.948, 0.946, 0.947]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.929, 0.935, 0.934, 0.927], 'all_L1': [0.966, 0.969, 0.968, 0.965]}), defaultdict(<class 'list'>, {'all_KL': [0.412, 0.404, 0.406, 0.407], 'all_L1': [0.629, 0.623, 0.626, 0.627]}), defaultdict(<class 'list'>, {'all_KL': [0.832, 0.826, 0.828, 0.822], 'all_L1': [0.885, 0.883, 0.883, 0.879]}), defaultdict(<class 'list'>, {'all_KL': [0.974, 0.972, 0.969, 0.973], 'all_L1': [0.986, 0.985, 0.984, 0.986]}), defaultdict(<class 'list'>, {'all_KL': [0.241, 0.24, 0.237, 0.238], 'all_L1': [0.323, 0.323, 0.321, 0.321]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.0, 0.0], 'all_L1': [0.0, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.0, 0.0, 0.0], 'all_L1': [0.022, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.0, 0.0, 0.0], 'all_L1': [0.003, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.34, 0.022, 0.0, 0.0], 'all_L1': [0.328, 0.027, 0.001, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.001, 0.0, 0.0, 0.0], 'all_L1': [0.001, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.083, 0.001, 0.0, 0.0], 'all_L1': [0.076, 0.001, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.022, 0.002, 0.002, 0.0], 'all_L1': [0.019, 0.002, 0.001, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.521, 0.169, 0.064, 0.007], 'all_L1': [0.43, 0.153, 0.059, 0.008]}), defaultdict(<class 'list'>, {'all_KL': [0.005, 0.002, 0.002, 0.0], 'all_L1': [0.005, 0.002, 0.002, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.721, 0.281, 0.195, 0.012], 'all_L1': [0.661, 0.296, 0.229, 0.038]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.934, 0.936, 0.896, 0.88], 'all_L1': [0.973, 0.973, 0.95, 0.942]}), defaultdict(<class 'list'>, {'all_KL': [0.877, 0.876, 0.884, 0.833], 'all_L1': [0.94, 0.937, 0.939, 0.913]}), defaultdict(<class 'list'>, {'all_KL': [0.893, 0.899, 0.89, 0.858], 'all_L1': [0.942, 0.943, 0.934, 0.916]}), defaultdict(<class 'list'>, {'all_KL': [0.871, 0.863, 0.837, 0.807], 'all_L1': [0.918, 0.911, 0.895, 0.879]}), defaultdict(<class 'list'>, {'all_KL': [0.911, 0.909, 0.908, 0.838], 'all_L1': [0.961, 0.959, 0.958, 0.917]}), defaultdict(<class 'list'>, {'all_KL': [0.879, 0.875, 0.859, 0.828], 'all_L1': [0.935, 0.929, 0.918, 0.9]}), defaultdict(<class 'list'>, {'all_KL': [0.709, 0.731, 0.729, 0.628], 'all_L1': [0.803, 0.817, 0.811, 0.756]}), defaultdict(<class 'list'>, {'all_KL': [0.843, 0.841, 0.841, 0.825], 'all_L1': [0.901, 0.894, 0.895, 0.888]}), defaultdict(<class 'list'>, {'all_KL': [0.599, 0.61, 0.602, 0.414], 'all_L1': [0.75, 0.753, 0.749, 0.595]}), defaultdict(<class 'list'>, {'all_KL': [0.268, 0.259, 0.262, 0.211], 'all_L1': [0.537, 0.517, 0.509, 0.467]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.034, 0.015, 0.003, 0.0], 'all_L1': [0.017, 0.008, 0.002, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.106, 0.079, 0.051, 0.013], 'all_L1': [0.056, 0.042, 0.031, 0.011]}), defaultdict(<class 'list'>, {'all_KL': [0.103, 0.082, 0.056, 0.029], 'all_L1': [0.058, 0.049, 0.036, 0.024]}), defaultdict(<class 'list'>, {'all_KL': [0.09, 0.068, 0.049, 0.021], 'all_L1': [0.064, 0.052, 0.039, 0.02]}), defaultdict(<class 'list'>, {'all_KL': [0.069, 0.045, 0.033, 0.011], 'all_L1': [0.036, 0.025, 0.02, 0.008]}), defaultdict(<class 'list'>, {'all_KL': [0.112, 0.091, 0.071, 0.03], 'all_L1': [0.062, 0.055, 0.046, 0.025]}), defaultdict(<class 'list'>, {'all_KL': [0.202, 0.154, 0.123, 0.058], 'all_L1': [0.139, 0.111, 0.095, 0.047]}), defaultdict(<class 'list'>, {'all_KL': [0.124, 0.086, 0.065, 0.036], 'all_L1': [0.077, 0.056, 0.044, 0.027]}), defaultdict(<class 'list'>, {'all_KL': [0.167, 0.133, 0.126, 0.069], 'all_L1': [0.134, 0.108, 0.102, 0.055]}), defaultdict(<class 'list'>, {'all_KL': [0.257, 0.21, 0.178, 0.098], 'all_L1': [0.211, 0.171, 0.147, 0.081]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.795 +- 0.202, 0.776 +- 0.196, 0.772 +- 0.198, 0.746 +- 0.210
suff_simple class all_KL  =  0.700 +- 0.264, 0.662 +- 0.267, 0.654 +- 0.261, 0.606 +- 0.278
suff_simple_acc_int  =  0.816 +- 0.201, 0.804 +- 0.187, 0.802 +- 0.193, 0.786 +- 0.205
nec class all_L1  =  0.153 +- 0.129, 0.062 +- 0.050, 0.040 +- 0.047, 0.005 +- 0.005
nec class all_KL  =  0.236 +- 0.188, 0.076 +- 0.060, 0.047 +- 0.055, 0.006 +- 0.006
nec_acc_int  =  0.868 +- 0.119, 0.933 +- 0.055, 0.955 +- 0.053, 0.994 +- 0.006

Eval split val
suff_simple class all_L1  =  0.873 +- 0.213, 0.873 +- 0.214, 0.872 +- 0.214, 0.872 +- 0.213
suff_simple class all_KL  =  0.829 +- 0.259, 0.828 +- 0.261, 0.828 +- 0.261, 0.827 +- 0.261
suff_simple_acc_int  =  0.756 +- 0.250, 0.755 +- 0.251, 0.756 +- 0.251, 0.756 +- 0.250
nec class all_L1  =  0.154 +- 0.223, 0.048 +- 0.094, 0.029 +- 0.069, 0.005 +- 0.011
nec class all_KL  =  0.172 +- 0.249, 0.048 +- 0.092, 0.026 +- 0.059, 0.002 +- 0.004
nec_acc_int  =  0.700 +- 0.321, 0.816 +- 0.184, 0.836 +- 0.152, 0.856 +- 0.125

Eval split test
suff_simple class all_L1  =  0.866 +- 0.129, 0.863 +- 0.132, 0.856 +- 0.132, 0.817 +- 0.154
suff_simple class all_KL  =  0.778 +- 0.196, 0.780 +- 0.197, 0.771 +- 0.192, 0.712 +- 0.215
suff_simple_acc_int  =  0.890 +- 0.116, 0.884 +- 0.123, 0.877 +- 0.124, 0.844 +- 0.152
nec class all_L1  =  0.085 +- 0.056, 0.068 +- 0.046, 0.056 +- 0.042, 0.030 +- 0.023
nec class all_KL  =  0.126 +- 0.062, 0.096 +- 0.053, 0.075 +- 0.049, 0.036 +- 0.029
nec_acc_int  =  0.923 +- 0.071, 0.937 +- 0.058, 0.946 +- 0.052, 0.965 +- 0.030


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.474 +- 0.044, 0.419 +- 0.074, 0.406 +- 0.078, 0.375 +- 0.103
Faith. Armon (L1)= 		  =  0.211 +- 0.132, 0.103 +- 0.070, 0.065 +- 0.068, 0.009 +- 0.010
Faith. GMean (L1)= 	  =  0.289 +- 0.116, 0.185 +- 0.066, 0.123 +- 0.082, 0.040 +- 0.035
Faith. Aritm (KL)= 		  =  0.468 +- 0.060, 0.369 +- 0.105, 0.350 +- 0.106, 0.306 +- 0.137
Faith. Armon (KL)= 		  =  0.254 +- 0.143, 0.109 +- 0.060, 0.062 +- 0.056, 0.010 +- 0.011
Faith. GMean (KL)= 	  =  0.320 +- 0.129, 0.178 +- 0.058, 0.112 +- 0.071, 0.035 +- 0.033

Eval split val
Faith. Aritm (L1)= 		  =  0.514 +- 0.086, 0.460 +- 0.075, 0.451 +- 0.079, 0.438 +- 0.102
Faith. Armon (L1)= 		  =  0.174 +- 0.219, 0.063 +- 0.112, 0.039 +- 0.083, 0.009 +- 0.020
Faith. GMean (L1)= 	  =  0.232 +- 0.220, 0.095 +- 0.131, 0.060 +- 0.097, 0.023 +- 0.039
Faith. Aritm (KL)= 		  =  0.501 +- 0.113, 0.438 +- 0.105, 0.427 +- 0.110, 0.414 +- 0.129
Faith. Armon (KL)= 		  =  0.176 +- 0.224, 0.059 +- 0.106, 0.034 +- 0.070, 0.004 +- 0.008
Faith. GMean (KL)= 	  =  0.233 +- 0.223, 0.088 +- 0.124, 0.052 +- 0.087, 0.013 +- 0.026

Eval split test
Faith. Aritm (L1)= 		  =  0.476 +- 0.038, 0.465 +- 0.045, 0.456 +- 0.046, 0.424 +- 0.066
Faith. Armon (L1)= 		  =  0.146 +- 0.079, 0.119 +- 0.070, 0.100 +- 0.066, 0.055 +- 0.040
Faith. GMean (L1)= 	  =  0.251 +- 0.062, 0.221 +- 0.062, 0.195 +- 0.068, 0.134 +- 0.056
Faith. Aritm (KL)= 		  =  0.452 +- 0.071, 0.438 +- 0.075, 0.423 +- 0.074, 0.374 +- 0.094
Faith. Armon (KL)= 		  =  0.198 +- 0.068, 0.156 +- 0.064, 0.125 +- 0.065, 0.063 +- 0.042
Faith. GMean (KL)= 	  =  0.291 +- 0.050, 0.250 +- 0.055, 0.213 +- 0.064, 0.132 +- 0.052
Computed for split load_split = id



Completed in  0:52:22.281129  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN TopoFeature/basis/no_shift NEC_ALPHA 0.1 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 01:04:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 01:04:17 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 01:04:17 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 01:04:17 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 01:04:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:04:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:04:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:04:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:04:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:04:17 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 01:04:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.509
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.771
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.685
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.656
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.070
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.848
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.766
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.710
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.229
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.705
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.663
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.604


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.509173285198556
len(reference) = 277
Effective ratio: 0.257 +- 0.142
Model Accuracy over intervened graphs for r=0.5 =  0.958
SUFF_SIMPLE for r=0.5 class 1.0 = 0.943 +- 0.316 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.5 all KL = 0.864 +- 0.316 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.5 all L1 = 0.943 +- 0.157 (in-sample avg dev_std = 0.300)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.770898916967509
len(reference) = 277
Effective ratio: 0.063 +- 0.051
Model Accuracy over intervened graphs for r=0.8 =  0.967
SUFF_SIMPLE for r=0.8 class 1.0 = 0.949 +- 0.311 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.8 all KL = 0.869 +- 0.311 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.8 all L1 = 0.949 +- 0.137 (in-sample avg dev_std = 0.301)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6848158844765344
len(reference) = 277
Effective ratio: 0.057 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.966
SUFF_SIMPLE for r=0.9 class 1.0 = 0.95 +- 0.304 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.9 all KL = 0.881 +- 0.304 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.9 all L1 = 0.95 +- 0.143 (in-sample avg dev_std = 0.300)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6561841155234657
len(reference) = 277
Effective ratio: 0.051 +- 0.038
Model Accuracy over intervened graphs for r=0.95 =  0.974
SUFF_SIMPLE for r=0.95 class 1.0 = 0.957 +- 0.292 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.95 all KL = 0.882 +- 0.292 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.95 all L1 = 0.957 +- 0.119 (in-sample avg dev_std = 0.279)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.458
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07047896825396825
len(reference) = 2520
Effective ratio: 0.370 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.421
SUFF_SIMPLE for r=0.5 class 1.0 = 0.833 +- 0.263 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.5 all KL = 0.812 +- 0.263 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.5 all L1 = 0.833 +- 0.222 (in-sample avg dev_std = 0.335)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8475571428571429
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.435
SUFF_SIMPLE for r=0.8 class 1.0 = 0.837 +- 0.251 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.8 all KL = 0.816 +- 0.251 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.8 all L1 = 0.837 +- 0.212 (in-sample avg dev_std = 0.339)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.458
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7663146825396826
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.431
SUFF_SIMPLE for r=0.9 class 1.0 = 0.834 +- 0.251 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.9 all KL = 0.81 +- 0.251 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.9 all L1 = 0.834 +- 0.212 (in-sample avg dev_std = 0.347)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.458
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7103154761904762
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.43
SUFF_SIMPLE for r=0.95 class 1.0 = 0.835 +- 0.254 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.95 all KL = 0.81 +- 0.254 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.95 all L1 = 0.835 +- 0.212 (in-sample avg dev_std = 0.341)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.777
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.22853241491085902
len(reference) = 2461
Effective ratio: 0.423 +- 0.152
Model Accuracy over intervened graphs for r=0.5 =  0.697
SUFF_SIMPLE for r=0.5 class 1.0 = 0.834 +- 0.377 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.5 all KL = 0.792 +- 0.377 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.5 all L1 = 0.834 +- 0.287 (in-sample avg dev_std = 0.241)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.778
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7053063209076176
len(reference) = 2468
Effective ratio: 0.072 +- 0.116
Model Accuracy over intervened graphs for r=0.8 =  0.701
SUFF_SIMPLE for r=0.8 class 1.0 = 0.845 +- 0.371 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.8 all KL = 0.794 +- 0.371 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.8 all L1 = 0.845 +- 0.271 (in-sample avg dev_std = 0.284)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.778
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6630097244732577
len(reference) = 2468
Effective ratio: 0.054 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.683
SUFF_SIMPLE for r=0.9 class 1.0 = 0.842 +- 0.376 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.9 all KL = 0.779 +- 0.376 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.9 all L1 = 0.842 +- 0.268 (in-sample avg dev_std = 0.315)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.778
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6043982982171799
len(reference) = 2468
Effective ratio: 0.046 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.684
SUFF_SIMPLE for r=0.95 class 1.0 = 0.847 +- 0.367 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.95 all KL = 0.789 +- 0.367 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.95 all L1 = 0.847 +- 0.263 (in-sample avg dev_std = 0.324)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.509173285198556
len(reference) = 277
Effective ratio: 0.257 +- 0.142
Model Accuracy over intervened graphs for r=0.5 =  0.985
NEC for r=0.5 class 1.0 = 0.033 +- 0.249 (in-sample avg dev_std = 0.189)
NEC for r=0.5 all KL = 0.118 +- 0.249 (in-sample avg dev_std = 0.189)
NEC for r=0.5 all L1 = 0.033 +- 0.083 (in-sample avg dev_std = 0.189)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.770898916967509
len(reference) = 277
Effective ratio: 0.063 +- 0.051
Model Accuracy over intervened graphs for r=0.8 =  0.963
NEC for r=0.8 class 1.0 = 0.07 +- 0.317 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all KL = 0.207 +- 0.317 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all L1 = 0.07 +- 0.142 (in-sample avg dev_std = 0.244)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6848158844765344
len(reference) = 277
Effective ratio: 0.057 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.958
NEC for r=0.9 class 1.0 = 0.078 +- 0.328 (in-sample avg dev_std = 0.260)
NEC for r=0.9 all KL = 0.231 +- 0.328 (in-sample avg dev_std = 0.260)
NEC for r=0.9 all L1 = 0.078 +- 0.147 (in-sample avg dev_std = 0.260)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6561841155234657
len(reference) = 277
Effective ratio: 0.051 +- 0.038
Model Accuracy over intervened graphs for r=0.95 =  0.949
NEC for r=0.95 class 1.0 = 0.085 +- 0.339 (in-sample avg dev_std = 0.272)
NEC for r=0.95 all KL = 0.23 +- 0.339 (in-sample avg dev_std = 0.272)
NEC for r=0.95 all L1 = 0.085 +- 0.163 (in-sample avg dev_std = 0.272)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.458
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07047896825396825
len(reference) = 2520
Effective ratio: 0.370 +- 0.137
Model Accuracy over intervened graphs for r=0.5 =  0.385
NEC for r=0.5 class 1.0 = 0.206 +- 0.332 (in-sample avg dev_std = 0.476)
NEC for r=0.5 all KL = 0.292 +- 0.332 (in-sample avg dev_std = 0.476)
NEC for r=0.5 all L1 = 0.206 +- 0.211 (in-sample avg dev_std = 0.476)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8475571428571429
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.428 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.459 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.428 +- 0.400 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.458
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7663146825396826
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.428 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.459 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.428 +- 0.400 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.458
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7103154761904762
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.428 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.459 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.428 +- 0.400 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.778
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.22853241491085902
len(reference) = 2468
Effective ratio: 0.423 +- 0.152
Model Accuracy over intervened graphs for r=0.5 =  0.708
NEC for r=0.5 class 1.0 = 0.181 +- 0.379 (in-sample avg dev_std = 0.426)
NEC for r=0.5 all KL = 0.362 +- 0.379 (in-sample avg dev_std = 0.426)
NEC for r=0.5 all L1 = 0.181 +- 0.220 (in-sample avg dev_std = 0.426)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.778
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7053063209076176
len(reference) = 2468
Effective ratio: 0.072 +- 0.116
Model Accuracy over intervened graphs for r=0.8 =  0.119
NEC for r=0.8 class 1.0 = 0.64 +- 0.387 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all KL = 0.754 +- 0.387 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all L1 = 0.64 +- 0.333 (in-sample avg dev_std = 0.204)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.778
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6630097244732577
len(reference) = 2468
Effective ratio: 0.054 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.099
NEC for r=0.9 class 1.0 = 0.637 +- 0.412 (in-sample avg dev_std = 0.031)
NEC for r=0.9 all KL = 0.734 +- 0.412 (in-sample avg dev_std = 0.031)
NEC for r=0.9 all L1 = 0.637 +- 0.350 (in-sample avg dev_std = 0.031)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.778
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6043982982171799
len(reference) = 2468
Effective ratio: 0.046 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.119
NEC for r=0.95 class 1.0 = 0.618 +- 0.426 (in-sample avg dev_std = 0.006)
NEC for r=0.95 all KL = 0.71 +- 0.426 (in-sample avg dev_std = 0.006)
NEC for r=0.95 all L1 = 0.618 +- 0.363 (in-sample avg dev_std = 0.006)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 01:10:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 01:10:20 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 01:10:20 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 01:10:20 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 01:10:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:10:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:10:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:10:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:10:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:10:20 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 01:10:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 76 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.469
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.940
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.813
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.705
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.072
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.947
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.916
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.879
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.246
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.777
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.718
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.637


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.4693032490974729
len(reference) = 277
Effective ratio: 0.273 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.968
SUFF_SIMPLE for r=0.5 class 1.0 = 0.958 +- 0.267 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.5 all KL = 0.906 +- 0.267 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.5 all L1 = 0.958 +- 0.136 (in-sample avg dev_std = 0.255)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9399350180505416
len(reference) = 277
Effective ratio: 0.087 +- 0.071
Model Accuracy over intervened graphs for r=0.8 =  0.975
SUFF_SIMPLE for r=0.8 class 1.0 = 0.963 +- 0.272 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.8 all KL = 0.9 +- 0.272 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.8 all L1 = 0.963 +- 0.113 (in-sample avg dev_std = 0.258)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8125631768953069
len(reference) = 277
Effective ratio: 0.069 +- 0.050
Model Accuracy over intervened graphs for r=0.9 =  0.981
SUFF_SIMPLE for r=0.9 class 1.0 = 0.97 +- 0.244 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.9 all KL = 0.921 +- 0.244 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.9 all L1 = 0.97 +- 0.102 (in-sample avg dev_std = 0.226)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7045126353790613
len(reference) = 277
Effective ratio: 0.059 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.981
SUFF_SIMPLE for r=0.95 class 1.0 = 0.971 +- 0.248 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.95 all KL = 0.917 +- 0.248 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.95 all L1 = 0.971 +- 0.098 (in-sample avg dev_std = 0.228)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.788
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07225436507936507
len(reference) = 2520
Effective ratio: 0.350 +- 0.107
Model Accuracy over intervened graphs for r=0.5 =  0.683
SUFF_SIMPLE for r=0.5 class 1.0 = 0.782 +- 0.262 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.5 all KL = 0.771 +- 0.262 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.5 all L1 = 0.782 +- 0.227 (in-sample avg dev_std = 0.375)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9467277777777777
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.712
SUFF_SIMPLE for r=0.8 class 1.0 = 0.799 +- 0.233 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.8 all KL = 0.797 +- 0.233 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.8 all L1 = 0.799 +- 0.210 (in-sample avg dev_std = 0.360)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.788
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.916395238095238
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.706
SUFF_SIMPLE for r=0.9 class 1.0 = 0.794 +- 0.239 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.9 all KL = 0.789 +- 0.239 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.9 all L1 = 0.794 +- 0.216 (in-sample avg dev_std = 0.368)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.788
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8785488095238096
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.708
SUFF_SIMPLE for r=0.95 class 1.0 = 0.793 +- 0.240 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.95 all KL = 0.787 +- 0.240 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.95 all L1 = 0.793 +- 0.215 (in-sample avg dev_std = 0.369)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.734
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2458427876823339
len(reference) = 2467
Effective ratio: 0.356 +- 0.141
Model Accuracy over intervened graphs for r=0.5 =  0.675
SUFF_SIMPLE for r=0.5 class 1.0 = 0.803 +- 0.393 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.5 all KL = 0.754 +- 0.393 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.5 all L1 = 0.803 +- 0.299 (in-sample avg dev_std = 0.279)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.735
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7774262560777958
len(reference) = 2468
Effective ratio: 0.080 +- 0.113
Model Accuracy over intervened graphs for r=0.8 =  0.678
SUFF_SIMPLE for r=0.8 class 1.0 = 0.818 +- 0.383 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.8 all KL = 0.76 +- 0.383 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.8 all L1 = 0.818 +- 0.279 (in-sample avg dev_std = 0.322)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7183829011345219
len(reference) = 2468
Effective ratio: 0.061 +- 0.086
Model Accuracy over intervened graphs for r=0.9 =  0.675
SUFF_SIMPLE for r=0.9 class 1.0 = 0.833 +- 0.373 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.9 all KL = 0.777 +- 0.373 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.9 all L1 = 0.833 +- 0.265 (in-sample avg dev_std = 0.334)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.735
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6367119124797408
len(reference) = 2468
Effective ratio: 0.047 +- 0.063
Model Accuracy over intervened graphs for r=0.95 =  0.663
SUFF_SIMPLE for r=0.95 class 1.0 = 0.842 +- 0.364 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.95 all KL = 0.787 +- 0.364 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.95 all L1 = 0.842 +- 0.252 (in-sample avg dev_std = 0.343)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.4693032490974729
len(reference) = 277
Effective ratio: 0.273 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.992
NEC for r=0.5 class 1.0 = 0.023 +- 0.168 (in-sample avg dev_std = 0.150)
NEC for r=0.5 all KL = 0.063 +- 0.168 (in-sample avg dev_std = 0.150)
NEC for r=0.5 all L1 = 0.023 +- 0.071 (in-sample avg dev_std = 0.150)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9399350180505416
len(reference) = 277
Effective ratio: 0.087 +- 0.071
Model Accuracy over intervened graphs for r=0.8 =  0.972
NEC for r=0.8 class 1.0 = 0.062 +- 0.261 (in-sample avg dev_std = 0.220)
NEC for r=0.8 all KL = 0.152 +- 0.261 (in-sample avg dev_std = 0.220)
NEC for r=0.8 all L1 = 0.062 +- 0.133 (in-sample avg dev_std = 0.220)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8125631768953069
len(reference) = 277
Effective ratio: 0.069 +- 0.050
Model Accuracy over intervened graphs for r=0.9 =  0.971
NEC for r=0.9 class 1.0 = 0.069 +- 0.273 (in-sample avg dev_std = 0.205)
NEC for r=0.9 all KL = 0.167 +- 0.273 (in-sample avg dev_std = 0.205)
NEC for r=0.9 all L1 = 0.069 +- 0.144 (in-sample avg dev_std = 0.205)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7045126353790613
len(reference) = 277
Effective ratio: 0.059 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.96
NEC for r=0.95 class 1.0 = 0.079 +- 0.289 (in-sample avg dev_std = 0.222)
NEC for r=0.95 all KL = 0.176 +- 0.289 (in-sample avg dev_std = 0.222)
NEC for r=0.95 all L1 = 0.079 +- 0.167 (in-sample avg dev_std = 0.222)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.788
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07225436507936507
len(reference) = 2520
Effective ratio: 0.350 +- 0.107
Model Accuracy over intervened graphs for r=0.5 =  0.656
NEC for r=0.5 class 1.0 = 0.275 +- 0.299 (in-sample avg dev_std = 0.560)
NEC for r=0.5 all KL = 0.384 +- 0.299 (in-sample avg dev_std = 0.560)
NEC for r=0.5 all L1 = 0.275 +- 0.188 (in-sample avg dev_std = 0.560)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9467277777777777
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.707 +- 0.353 (in-sample avg dev_std = 0.012)
NEC for r=0.8 all KL = 0.772 +- 0.353 (in-sample avg dev_std = 0.012)
NEC for r=0.8 all L1 = 0.707 +- 0.285 (in-sample avg dev_std = 0.012)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.788
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.916395238095238
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.707 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.772 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.707 +- 0.284 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.788
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8785488095238096
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.001
NEC for r=0.95 class 1.0 = 0.707 +- 0.354 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.771 +- 0.354 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.707 +- 0.285 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.735
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2458427876823339
len(reference) = 2468
Effective ratio: 0.356 +- 0.141
Model Accuracy over intervened graphs for r=0.5 =  0.609
NEC for r=0.5 class 1.0 = 0.234 +- 0.385 (in-sample avg dev_std = 0.539)
NEC for r=0.5 all KL = 0.415 +- 0.385 (in-sample avg dev_std = 0.539)
NEC for r=0.5 all L1 = 0.234 +- 0.224 (in-sample avg dev_std = 0.539)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.735
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7774262560777958
len(reference) = 2468
Effective ratio: 0.080 +- 0.113
Model Accuracy over intervened graphs for r=0.8 =  0.093
NEC for r=0.8 class 1.0 = 0.607 +- 0.416 (in-sample avg dev_std = 0.174)
NEC for r=0.8 all KL = 0.701 +- 0.416 (in-sample avg dev_std = 0.174)
NEC for r=0.8 all L1 = 0.607 +- 0.350 (in-sample avg dev_std = 0.174)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7183829011345219
len(reference) = 2468
Effective ratio: 0.061 +- 0.086
Model Accuracy over intervened graphs for r=0.9 =  0.098
NEC for r=0.9 class 1.0 = 0.596 +- 0.429 (in-sample avg dev_std = 0.099)
NEC for r=0.9 all KL = 0.679 +- 0.429 (in-sample avg dev_std = 0.099)
NEC for r=0.9 all L1 = 0.596 +- 0.362 (in-sample avg dev_std = 0.099)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.735
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6367119124797408
len(reference) = 2468
Effective ratio: 0.047 +- 0.063
Model Accuracy over intervened graphs for r=0.95 =  0.115
NEC for r=0.95 class 1.0 = 0.575 +- 0.439 (in-sample avg dev_std = 0.060)
NEC for r=0.95 all KL = 0.649 +- 0.439 (in-sample avg dev_std = 0.060)
NEC for r=0.95 all L1 = 0.575 +- 0.374 (in-sample avg dev_std = 0.060)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 01:15:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 01:15:12 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 01:15:12 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 01:15:12 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 01:15:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:15:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:15:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:15:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:15:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:15:12 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 01:15:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.597
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.888
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.801
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.682
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.104
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.937
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.907
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.863
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.245
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.748
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.746
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.664


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5966462093862817
len(reference) = 277
Effective ratio: 0.214 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.975
SUFF_SIMPLE for r=0.5 class 1.0 = 0.963 +- 0.264 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.5 all KL = 0.912 +- 0.264 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.5 all L1 = 0.963 +- 0.127 (in-sample avg dev_std = 0.237)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8880902527075812
len(reference) = 277
Effective ratio: 0.075 +- 0.052
Model Accuracy over intervened graphs for r=0.8 =  0.976
SUFF_SIMPLE for r=0.8 class 1.0 = 0.964 +- 0.266 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.8 all KL = 0.908 +- 0.266 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.8 all L1 = 0.964 +- 0.117 (in-sample avg dev_std = 0.242)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8011263537906137
len(reference) = 277
Effective ratio: 0.066 +- 0.046
Model Accuracy over intervened graphs for r=0.9 =  0.979
SUFF_SIMPLE for r=0.9 class 1.0 = 0.97 +- 0.245 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.9 all KL = 0.925 +- 0.245 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.9 all L1 = 0.97 +- 0.115 (in-sample avg dev_std = 0.220)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6816606498194946
len(reference) = 277
Effective ratio: 0.056 +- 0.041
Model Accuracy over intervened graphs for r=0.95 =  0.982
SUFF_SIMPLE for r=0.95 class 1.0 = 0.971 +- 0.243 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.95 all KL = 0.919 +- 0.243 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.95 all L1 = 0.971 +- 0.099 (in-sample avg dev_std = 0.222)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.874
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10414166666666667
len(reference) = 2520
Effective ratio: 0.262 +- 0.115
Model Accuracy over intervened graphs for r=0.5 =  0.758
SUFF_SIMPLE for r=0.5 class 1.0 = 0.835 +- 0.354 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.5 all KL = 0.745 +- 0.354 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.5 all L1 = 0.835 +- 0.250 (in-sample avg dev_std = 0.362)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9371210317460318
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.781
SUFF_SIMPLE for r=0.8 class 1.0 = 0.849 +- 0.332 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.8 all KL = 0.768 +- 0.332 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.8 all L1 = 0.849 +- 0.231 (in-sample avg dev_std = 0.363)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9074825396825396
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.78
SUFF_SIMPLE for r=0.9 class 1.0 = 0.848 +- 0.334 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.9 all KL = 0.77 +- 0.334 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.9 all L1 = 0.848 +- 0.235 (in-sample avg dev_std = 0.360)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.874
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8634924603174604
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.774
SUFF_SIMPLE for r=0.95 class 1.0 = 0.845 +- 0.340 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.95 all KL = 0.761 +- 0.340 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.95 all L1 = 0.845 +- 0.236 (in-sample avg dev_std = 0.371)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.741
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.24458306320907616
len(reference) = 2465
Effective ratio: 0.407 +- 0.140
Model Accuracy over intervened graphs for r=0.5 =  0.687
SUFF_SIMPLE for r=0.5 class 1.0 = 0.803 +- 0.381 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.5 all KL = 0.771 +- 0.381 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.5 all L1 = 0.803 +- 0.296 (in-sample avg dev_std = 0.257)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.741
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7477086709886548
len(reference) = 2468
Effective ratio: 0.079 +- 0.110
Model Accuracy over intervened graphs for r=0.8 =  0.675
SUFF_SIMPLE for r=0.8 class 1.0 = 0.823 +- 0.374 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.8 all KL = 0.783 +- 0.374 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.8 all L1 = 0.823 +- 0.277 (in-sample avg dev_std = 0.280)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7464862236628849
len(reference) = 2468
Effective ratio: 0.062 +- 0.092
Model Accuracy over intervened graphs for r=0.9 =  0.677
SUFF_SIMPLE for r=0.9 class 1.0 = 0.831 +- 0.362 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.9 all KL = 0.794 +- 0.362 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.9 all L1 = 0.831 +- 0.269 (in-sample avg dev_std = 0.289)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.741
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6643585899513776
len(reference) = 2468
Effective ratio: 0.050 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.672
SUFF_SIMPLE for r=0.95 class 1.0 = 0.836 +- 0.358 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.95 all KL = 0.798 +- 0.358 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.95 all L1 = 0.836 +- 0.263 (in-sample avg dev_std = 0.294)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5966462093862817
len(reference) = 277
Effective ratio: 0.214 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.998
NEC for r=0.5 class 1.0 = 0.01 +- 0.125 (in-sample avg dev_std = 0.086)
NEC for r=0.5 all KL = 0.033 +- 0.125 (in-sample avg dev_std = 0.086)
NEC for r=0.5 all L1 = 0.01 +- 0.042 (in-sample avg dev_std = 0.086)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8880902527075812
len(reference) = 277
Effective ratio: 0.075 +- 0.052
Model Accuracy over intervened graphs for r=0.8 =  0.991
NEC for r=0.8 class 1.0 = 0.022 +- 0.185 (in-sample avg dev_std = 0.126)
NEC for r=0.8 all KL = 0.061 +- 0.185 (in-sample avg dev_std = 0.126)
NEC for r=0.8 all L1 = 0.022 +- 0.084 (in-sample avg dev_std = 0.126)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8011263537906137
len(reference) = 277
Effective ratio: 0.066 +- 0.046
Model Accuracy over intervened graphs for r=0.9 =  0.994
NEC for r=0.9 class 1.0 = 0.019 +- 0.166 (in-sample avg dev_std = 0.105)
NEC for r=0.9 all KL = 0.053 +- 0.166 (in-sample avg dev_std = 0.105)
NEC for r=0.9 all L1 = 0.019 +- 0.077 (in-sample avg dev_std = 0.105)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6816606498194946
len(reference) = 277
Effective ratio: 0.056 +- 0.041
Model Accuracy over intervened graphs for r=0.95 =  0.996
NEC for r=0.95 class 1.0 = 0.02 +- 0.172 (in-sample avg dev_std = 0.093)
NEC for r=0.95 all KL = 0.06 +- 0.172 (in-sample avg dev_std = 0.093)
NEC for r=0.95 all L1 = 0.02 +- 0.072 (in-sample avg dev_std = 0.093)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.874
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10414166666666667
len(reference) = 2520
Effective ratio: 0.262 +- 0.115
Model Accuracy over intervened graphs for r=0.5 =  0.746
NEC for r=0.5 class 1.0 = 0.241 +- 0.391 (in-sample avg dev_std = 0.594)
NEC for r=0.5 all KL = 0.508 +- 0.391 (in-sample avg dev_std = 0.594)
NEC for r=0.5 all L1 = 0.241 +- 0.202 (in-sample avg dev_std = 0.594)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9371210317460318
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.769 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.872 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.769 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9074825396825396
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.001
NEC for r=0.9 class 1.0 = 0.769 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.872 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.769 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.874
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8634924603174604
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.005
NEC for r=0.95 class 1.0 = 0.769 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.872 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.769 +- 0.247 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.741
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.24458306320907616
len(reference) = 2468
Effective ratio: 0.407 +- 0.140
Model Accuracy over intervened graphs for r=0.5 =  0.596
NEC for r=0.5 class 1.0 = 0.23 +- 0.398 (in-sample avg dev_std = 0.502)
NEC for r=0.5 all KL = 0.365 +- 0.398 (in-sample avg dev_std = 0.502)
NEC for r=0.5 all L1 = 0.23 +- 0.247 (in-sample avg dev_std = 0.502)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.741
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7477086709886548
len(reference) = 2468
Effective ratio: 0.079 +- 0.110
Model Accuracy over intervened graphs for r=0.8 =  0.126
NEC for r=0.8 class 1.0 = 0.578 +- 0.422 (in-sample avg dev_std = 0.255)
NEC for r=0.8 all KL = 0.666 +- 0.422 (in-sample avg dev_std = 0.255)
NEC for r=0.8 all L1 = 0.578 +- 0.358 (in-sample avg dev_std = 0.255)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7464862236628849
len(reference) = 2468
Effective ratio: 0.062 +- 0.092
Model Accuracy over intervened graphs for r=0.9 =  0.123
NEC for r=0.9 class 1.0 = 0.565 +- 0.435 (in-sample avg dev_std = 0.093)
NEC for r=0.9 all KL = 0.643 +- 0.435 (in-sample avg dev_std = 0.093)
NEC for r=0.9 all L1 = 0.565 +- 0.373 (in-sample avg dev_std = 0.093)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.741
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6643585899513776
len(reference) = 2468
Effective ratio: 0.050 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.137
NEC for r=0.95 class 1.0 = 0.552 +- 0.441 (in-sample avg dev_std = 0.065)
NEC for r=0.95 all KL = 0.625 +- 0.441 (in-sample avg dev_std = 0.065)
NEC for r=0.95 all L1 = 0.552 +- 0.379 (in-sample avg dev_std = 0.065)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 01:20:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 01:20:29 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 01:20:29 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 01:20:29 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 01:20:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:20:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:20:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:20:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:20:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:20:29 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 01:20:29 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.503
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.943
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.866
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.799
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.107
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.903
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.954
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.968
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.286
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.848
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.820
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.770


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5026534296028882
len(reference) = 277
Effective ratio: 0.266 +- 0.142
Model Accuracy over intervened graphs for r=0.5 =  0.98
SUFF_SIMPLE for r=0.5 class 1.0 = 0.973 +- 0.210 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.5 all KL = 0.945 +- 0.210 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.5 all L1 = 0.973 +- 0.116 (in-sample avg dev_std = 0.191)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9430361010830325
len(reference) = 277
Effective ratio: 0.091 +- 0.074
Model Accuracy over intervened graphs for r=0.8 =  0.984
SUFF_SIMPLE for r=0.8 class 1.0 = 0.976 +- 0.202 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 all KL = 0.948 +- 0.202 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 all L1 = 0.976 +- 0.105 (in-sample avg dev_std = 0.189)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8663501805054151
len(reference) = 277
Effective ratio: 0.076 +- 0.055
Model Accuracy over intervened graphs for r=0.9 =  0.984
SUFF_SIMPLE for r=0.9 class 1.0 = 0.978 +- 0.195 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.9 all KL = 0.953 +- 0.195 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.9 all L1 = 0.978 +- 0.102 (in-sample avg dev_std = 0.181)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7991516245487365
len(reference) = 277
Effective ratio: 0.068 +- 0.050
Model Accuracy over intervened graphs for r=0.95 =  0.983
SUFF_SIMPLE for r=0.95 class 1.0 = 0.976 +- 0.199 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.95 all KL = 0.951 +- 0.199 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.95 all L1 = 0.976 +- 0.108 (in-sample avg dev_std = 0.179)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.775
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10677738095238096
len(reference) = 2520
Effective ratio: 0.225 +- 0.066
Model Accuracy over intervened graphs for r=0.5 =  0.519
SUFF_SIMPLE for r=0.5 class 1.0 = 0.649 +- 0.343 (in-sample avg dev_std = 0.513)
SUFF_SIMPLE for r=0.5 all KL = 0.512 +- 0.343 (in-sample avg dev_std = 0.513)
SUFF_SIMPLE for r=0.5 all L1 = 0.649 +- 0.260 (in-sample avg dev_std = 0.513)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9031869047619048
len(reference) = 2520
Effective ratio: 0.015 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.539
SUFF_SIMPLE for r=0.8 class 1.0 = 0.666 +- 0.333 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.8 all KL = 0.537 +- 0.333 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.8 all L1 = 0.666 +- 0.254 (in-sample avg dev_std = 0.506)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9540456349206348
len(reference) = 2520
Effective ratio: 0.014 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.539
SUFF_SIMPLE for r=0.9 class 1.0 = 0.665 +- 0.337 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.9 all KL = 0.539 +- 0.337 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.9 all L1 = 0.665 +- 0.255 (in-sample avg dev_std = 0.506)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.775
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9678015873015874
len(reference) = 2520
Effective ratio: 0.013 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.535
SUFF_SIMPLE for r=0.95 class 1.0 = 0.664 +- 0.335 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.95 all KL = 0.534 +- 0.335 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.95 all L1 = 0.664 +- 0.255 (in-sample avg dev_std = 0.508)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.845
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2860761750405187
len(reference) = 2468
Effective ratio: 0.316 +- 0.177
Model Accuracy over intervened graphs for r=0.5 =  0.744
SUFF_SIMPLE for r=0.5 class 1.0 = 0.849 +- 0.367 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.5 all KL = 0.807 +- 0.367 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.5 all L1 = 0.849 +- 0.278 (in-sample avg dev_std = 0.217)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.845
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8476004862236628
len(reference) = 2468
Effective ratio: 0.088 +- 0.121
Model Accuracy over intervened graphs for r=0.8 =  0.75
SUFF_SIMPLE for r=0.8 class 1.0 = 0.861 +- 0.351 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.8 all KL = 0.823 +- 0.351 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.8 all L1 = 0.861 +- 0.263 (in-sample avg dev_std = 0.241)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.819965964343598
len(reference) = 2468
Effective ratio: 0.063 +- 0.074
Model Accuracy over intervened graphs for r=0.9 =  0.749
SUFF_SIMPLE for r=0.9 class 1.0 = 0.868 +- 0.345 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.9 all KL = 0.829 +- 0.345 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.9 all L1 = 0.868 +- 0.256 (in-sample avg dev_std = 0.253)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.845
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7702868719611021
len(reference) = 2468
Effective ratio: 0.052 +- 0.056
Model Accuracy over intervened graphs for r=0.95 =  0.75
SUFF_SIMPLE for r=0.95 class 1.0 = 0.868 +- 0.338 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.95 all KL = 0.832 +- 0.338 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.95 all L1 = 0.868 +- 0.255 (in-sample avg dev_std = 0.255)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5026534296028882
len(reference) = 277
Effective ratio: 0.266 +- 0.142
Model Accuracy over intervened graphs for r=0.5 =  0.992
NEC for r=0.5 class 1.0 = 0.032 +- 0.212 (in-sample avg dev_std = 0.154)
NEC for r=0.5 all KL = 0.112 +- 0.212 (in-sample avg dev_std = 0.154)
NEC for r=0.5 all L1 = 0.032 +- 0.067 (in-sample avg dev_std = 0.154)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9430361010830325
len(reference) = 277
Effective ratio: 0.091 +- 0.074
Model Accuracy over intervened graphs for r=0.8 =  0.972
NEC for r=0.8 class 1.0 = 0.083 +- 0.298 (in-sample avg dev_std = 0.245)
NEC for r=0.8 all KL = 0.227 +- 0.298 (in-sample avg dev_std = 0.245)
NEC for r=0.8 all L1 = 0.083 +- 0.139 (in-sample avg dev_std = 0.245)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8663501805054151
len(reference) = 277
Effective ratio: 0.076 +- 0.055
Model Accuracy over intervened graphs for r=0.9 =  0.971
NEC for r=0.9 class 1.0 = 0.09 +- 0.305 (in-sample avg dev_std = 0.246)
NEC for r=0.9 all KL = 0.255 +- 0.305 (in-sample avg dev_std = 0.246)
NEC for r=0.9 all L1 = 0.09 +- 0.138 (in-sample avg dev_std = 0.246)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7991516245487365
len(reference) = 277
Effective ratio: 0.068 +- 0.050
Model Accuracy over intervened graphs for r=0.95 =  0.967
NEC for r=0.95 class 1.0 = 0.102 +- 0.313 (in-sample avg dev_std = 0.255)
NEC for r=0.95 all KL = 0.275 +- 0.313 (in-sample avg dev_std = 0.255)
NEC for r=0.95 all L1 = 0.102 +- 0.152 (in-sample avg dev_std = 0.255)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.775
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10677738095238096
len(reference) = 2520
Effective ratio: 0.225 +- 0.066
Model Accuracy over intervened graphs for r=0.5 =  0.529
NEC for r=0.5 class 1.0 = 0.37 +- 0.339 (in-sample avg dev_std = 0.667)
NEC for r=0.5 all KL = 0.554 +- 0.339 (in-sample avg dev_std = 0.667)
NEC for r=0.5 all L1 = 0.37 +- 0.219 (in-sample avg dev_std = 0.667)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9031869047619048
len(reference) = 2520
Effective ratio: 0.015 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.698 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.768 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.698 +- 0.299 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9540456349206348
len(reference) = 2520
Effective ratio: 0.014 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.698 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.768 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.698 +- 0.299 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.775
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9678015873015874
len(reference) = 2520
Effective ratio: 0.013 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.698 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.768 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.698 +- 0.298 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.845
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2860761750405187
len(reference) = 2468
Effective ratio: 0.316 +- 0.177
Model Accuracy over intervened graphs for r=0.5 =  0.609
NEC for r=0.5 class 1.0 = 0.335 +- 0.377 (in-sample avg dev_std = 0.647)
NEC for r=0.5 all KL = 0.561 +- 0.377 (in-sample avg dev_std = 0.647)
NEC for r=0.5 all L1 = 0.335 +- 0.245 (in-sample avg dev_std = 0.647)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.845
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8476004862236628
len(reference) = 2468
Effective ratio: 0.088 +- 0.121
Model Accuracy over intervened graphs for r=0.8 =  0.033
NEC for r=0.8 class 1.0 = 0.73 +- 0.336 (in-sample avg dev_std = 0.179)
NEC for r=0.8 all KL = 0.835 +- 0.336 (in-sample avg dev_std = 0.179)
NEC for r=0.8 all L1 = 0.73 +- 0.276 (in-sample avg dev_std = 0.179)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.819965964343598
len(reference) = 2468
Effective ratio: 0.063 +- 0.074
Model Accuracy over intervened graphs for r=0.9 =  0.046
NEC for r=0.9 class 1.0 = 0.722 +- 0.343 (in-sample avg dev_std = 0.136)
NEC for r=0.9 all KL = 0.825 +- 0.343 (in-sample avg dev_std = 0.136)
NEC for r=0.9 all L1 = 0.722 +- 0.285 (in-sample avg dev_std = 0.136)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.845
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7702868719611021
len(reference) = 2468
Effective ratio: 0.052 +- 0.056
Model Accuracy over intervened graphs for r=0.95 =  0.068
NEC for r=0.95 class 1.0 = 0.708 +- 0.354 (in-sample avg dev_std = 0.109)
NEC for r=0.95 all KL = 0.81 +- 0.354 (in-sample avg dev_std = 0.109)
NEC for r=0.95 all L1 = 0.708 +- 0.298 (in-sample avg dev_std = 0.109)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 01:26:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 01:26:30 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 01:26:30 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 01:26:30 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 01:26:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:26:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:26:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:26:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:26:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:26:30 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 01:26:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.757
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.738
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.693
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.670
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.103
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.870
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.801
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.738
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.310
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.722
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.674
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.633


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.7566606498194945
len(reference) = 277
Effective ratio: 0.159 +- 0.127
Model Accuracy over intervened graphs for r=0.5 =  0.972
SUFF_SIMPLE for r=0.5 class 1.0 = 0.959 +- 0.269 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.5 all KL = 0.902 +- 0.269 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.5 all L1 = 0.959 +- 0.127 (in-sample avg dev_std = 0.261)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7381480144404332
len(reference) = 277
Effective ratio: 0.059 +- 0.047
Model Accuracy over intervened graphs for r=0.8 =  0.981
SUFF_SIMPLE for r=0.8 class 1.0 = 0.972 +- 0.214 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.8 all KL = 0.932 +- 0.214 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.8 all L1 = 0.972 +- 0.108 (in-sample avg dev_std = 0.199)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6927833935018051
len(reference) = 277
Effective ratio: 0.054 +- 0.041
Model Accuracy over intervened graphs for r=0.9 =  0.983
SUFF_SIMPLE for r=0.9 class 1.0 = 0.974 +- 0.219 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.9 all KL = 0.932 +- 0.219 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.9 all L1 = 0.974 +- 0.094 (in-sample avg dev_std = 0.219)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6701805054151624
len(reference) = 277
Effective ratio: 0.050 +- 0.033
Model Accuracy over intervened graphs for r=0.95 =  0.978
SUFF_SIMPLE for r=0.95 class 1.0 = 0.965 +- 0.259 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.95 all KL = 0.907 +- 0.259 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.95 all L1 = 0.965 +- 0.108 (in-sample avg dev_std = 0.255)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.497
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10276190476190478
len(reference) = 2520
Effective ratio: 0.259 +- 0.117
Model Accuracy over intervened graphs for r=0.5 =  0.512
SUFF_SIMPLE for r=0.5 class 1.0 = 0.825 +- 0.237 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.5 all KL = 0.827 +- 0.237 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.5 all L1 = 0.825 +- 0.218 (in-sample avg dev_std = 0.319)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8695309523809523
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.524
SUFF_SIMPLE for r=0.8 class 1.0 = 0.824 +- 0.236 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.8 all KL = 0.826 +- 0.236 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.8 all L1 = 0.824 +- 0.217 (in-sample avg dev_std = 0.318)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.497
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8009753968253969
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.52
SUFF_SIMPLE for r=0.9 class 1.0 = 0.821 +- 0.239 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.9 all KL = 0.82 +- 0.239 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.9 all L1 = 0.821 +- 0.218 (in-sample avg dev_std = 0.324)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.497
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7382642857142857
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.521
SUFF_SIMPLE for r=0.95 class 1.0 = 0.821 +- 0.237 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.95 all KL = 0.822 +- 0.237 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.95 all L1 = 0.821 +- 0.218 (in-sample avg dev_std = 0.320)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.746
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.31009724473257694
len(reference) = 2461
Effective ratio: 0.372 +- 0.231
Model Accuracy over intervened graphs for r=0.5 =  0.703
SUFF_SIMPLE for r=0.5 class 1.0 = 0.796 +- 0.394 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.5 all KL = 0.759 +- 0.394 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.5 all L1 = 0.796 +- 0.310 (in-sample avg dev_std = 0.254)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.745
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7224136952998379
len(reference) = 2468
Effective ratio: 0.070 +- 0.111
Model Accuracy over intervened graphs for r=0.8 =  0.717
SUFF_SIMPLE for r=0.8 class 1.0 = 0.808 +- 0.392 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.8 all KL = 0.75 +- 0.392 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.8 all L1 = 0.808 +- 0.286 (in-sample avg dev_std = 0.353)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6738727714748785
len(reference) = 2468
Effective ratio: 0.054 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.71
SUFF_SIMPLE for r=0.9 class 1.0 = 0.816 +- 0.387 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.9 all KL = 0.755 +- 0.387 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.9 all L1 = 0.816 +- 0.276 (in-sample avg dev_std = 0.367)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.745
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6332378444084279
len(reference) = 2468
Effective ratio: 0.046 +- 0.072
Model Accuracy over intervened graphs for r=0.95 =  0.704
SUFF_SIMPLE for r=0.95 class 1.0 = 0.822 +- 0.382 (in-sample avg dev_std = 0.378)
SUFF_SIMPLE for r=0.95 all KL = 0.759 +- 0.382 (in-sample avg dev_std = 0.378)
SUFF_SIMPLE for r=0.95 all L1 = 0.822 +- 0.269 (in-sample avg dev_std = 0.378)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.7566606498194945
len(reference) = 277
Effective ratio: 0.159 +- 0.127
Model Accuracy over intervened graphs for r=0.5 =  0.984
NEC for r=0.5 class 1.0 = 0.042 +- 0.249 (in-sample avg dev_std = 0.222)
NEC for r=0.5 all KL = 0.14 +- 0.249 (in-sample avg dev_std = 0.222)
NEC for r=0.5 all L1 = 0.042 +- 0.084 (in-sample avg dev_std = 0.222)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7381480144404332
len(reference) = 277
Effective ratio: 0.059 +- 0.047
Model Accuracy over intervened graphs for r=0.8 =  0.97
NEC for r=0.8 class 1.0 = 0.075 +- 0.303 (in-sample avg dev_std = 0.257)
NEC for r=0.8 all KL = 0.205 +- 0.303 (in-sample avg dev_std = 0.257)
NEC for r=0.8 all L1 = 0.075 +- 0.139 (in-sample avg dev_std = 0.257)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6927833935018051
len(reference) = 277
Effective ratio: 0.054 +- 0.041
Model Accuracy over intervened graphs for r=0.9 =  0.972
NEC for r=0.9 class 1.0 = 0.075 +- 0.304 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all KL = 0.211 +- 0.304 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all L1 = 0.075 +- 0.136 (in-sample avg dev_std = 0.255)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6701805054151624
len(reference) = 277
Effective ratio: 0.050 +- 0.033
Model Accuracy over intervened graphs for r=0.95 =  0.961
NEC for r=0.95 class 1.0 = 0.091 +- 0.327 (in-sample avg dev_std = 0.271)
NEC for r=0.95 all KL = 0.231 +- 0.327 (in-sample avg dev_std = 0.271)
NEC for r=0.95 all L1 = 0.091 +- 0.159 (in-sample avg dev_std = 0.271)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.497
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10276190476190478
len(reference) = 2520
Effective ratio: 0.259 +- 0.117
Model Accuracy over intervened graphs for r=0.5 =  0.419
NEC for r=0.5 class 1.0 = 0.256 +- 0.326 (in-sample avg dev_std = 0.521)
NEC for r=0.5 all KL = 0.333 +- 0.326 (in-sample avg dev_std = 0.521)
NEC for r=0.5 all L1 = 0.256 +- 0.222 (in-sample avg dev_std = 0.521)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8695309523809523
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.468 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.497 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.468 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.497
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8009753968253969
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.468 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.497 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.468 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.497
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7382642857142857
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.468 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.497 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.468 +- 0.390 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.745
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.31009724473257694
len(reference) = 2468
Effective ratio: 0.372 +- 0.231
Model Accuracy over intervened graphs for r=0.5 =  0.609
NEC for r=0.5 class 1.0 = 0.25 +- 0.391 (in-sample avg dev_std = 0.530)
NEC for r=0.5 all KL = 0.431 +- 0.391 (in-sample avg dev_std = 0.530)
NEC for r=0.5 all L1 = 0.25 +- 0.234 (in-sample avg dev_std = 0.530)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.745
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7224136952998379
len(reference) = 2468
Effective ratio: 0.070 +- 0.111
Model Accuracy over intervened graphs for r=0.8 =  0.094
NEC for r=0.8 class 1.0 = 0.605 +- 0.417 (in-sample avg dev_std = 0.100)
NEC for r=0.8 all KL = 0.686 +- 0.417 (in-sample avg dev_std = 0.100)
NEC for r=0.8 all L1 = 0.605 +- 0.354 (in-sample avg dev_std = 0.100)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6738727714748785
len(reference) = 2468
Effective ratio: 0.054 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.099
NEC for r=0.9 class 1.0 = 0.591 +- 0.430 (in-sample avg dev_std = 0.032)
NEC for r=0.9 all KL = 0.663 +- 0.430 (in-sample avg dev_std = 0.032)
NEC for r=0.9 all L1 = 0.591 +- 0.367 (in-sample avg dev_std = 0.032)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.745
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6332378444084279
len(reference) = 2468
Effective ratio: 0.046 +- 0.072
Model Accuracy over intervened graphs for r=0.95 =  0.114
NEC for r=0.95 class 1.0 = 0.578 +- 0.437 (in-sample avg dev_std = 0.005)
NEC for r=0.95 all KL = 0.645 +- 0.437 (in-sample avg dev_std = 0.005)
NEC for r=0.95 all L1 = 0.578 +- 0.374 (in-sample avg dev_std = 0.005)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 01:31:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 01:31:24 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 01:31:24 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 01:31:24 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 01:31:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:31:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:31:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:31:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:31:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:31:24 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 01:31:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.533
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.951
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.896
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.806
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.105
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.943
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.946
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.924
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.230
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.847
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.836
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.782


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.532841155234657
len(reference) = 277
Effective ratio: 0.237 +- 0.120
Model Accuracy over intervened graphs for r=0.5 =  0.976
SUFF_SIMPLE for r=0.5 class 1.0 = 0.969 +- 0.217 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.5 all KL = 0.937 +- 0.217 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.5 all L1 = 0.969 +- 0.127 (in-sample avg dev_std = 0.191)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9512635379061372
len(reference) = 277
Effective ratio: 0.087 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.986
SUFF_SIMPLE for r=0.8 class 1.0 = 0.979 +- 0.194 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.8 all KL = 0.951 +- 0.194 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.8 all L1 = 0.979 +- 0.091 (in-sample avg dev_std = 0.187)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.895779783393502
len(reference) = 277
Effective ratio: 0.077 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.987
SUFF_SIMPLE for r=0.9 class 1.0 = 0.979 +- 0.182 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 all KL = 0.953 +- 0.182 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 all L1 = 0.979 +- 0.091 (in-sample avg dev_std = 0.171)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8060361010830325
len(reference) = 277
Effective ratio: 0.068 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.989
SUFF_SIMPLE for r=0.95 class 1.0 = 0.98 +- 0.185 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.95 all KL = 0.949 +- 0.185 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.95 all L1 = 0.98 +- 0.082 (in-sample avg dev_std = 0.168)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.362
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10485793650793651
len(reference) = 2520
Effective ratio: 0.333 +- 0.178
Model Accuracy over intervened graphs for r=0.5 =  0.282
SUFF_SIMPLE for r=0.5 class 1.0 = 0.83 +- 0.227 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.5 all KL = 0.835 +- 0.227 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.5 all L1 = 0.83 +- 0.212 (in-sample avg dev_std = 0.303)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9433142857142858
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.3
SUFF_SIMPLE for r=0.8 class 1.0 = 0.832 +- 0.217 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.8 all KL = 0.838 +- 0.217 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.8 all L1 = 0.832 +- 0.203 (in-sample avg dev_std = 0.312)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.362
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9455095238095239
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.303
SUFF_SIMPLE for r=0.9 class 1.0 = 0.833 +- 0.214 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.9 all KL = 0.84 +- 0.214 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.9 all L1 = 0.833 +- 0.203 (in-sample avg dev_std = 0.308)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.362
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9239833333333334
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.302
SUFF_SIMPLE for r=0.95 class 1.0 = 0.83 +- 0.220 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.95 all KL = 0.833 +- 0.220 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.95 all L1 = 0.83 +- 0.203 (in-sample avg dev_std = 0.319)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.562
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.22969854132901132
len(reference) = 2464
Effective ratio: 0.481 +- 0.158
Model Accuracy over intervened graphs for r=0.5 =  0.525
SUFF_SIMPLE for r=0.5 class 1.0 = 0.79 +- 0.369 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.5 all KL = 0.768 +- 0.369 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.5 all L1 = 0.79 +- 0.294 (in-sample avg dev_std = 0.241)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8466000810372772
len(reference) = 2468
Effective ratio: 0.088 +- 0.122
Model Accuracy over intervened graphs for r=0.8 =  0.519
SUFF_SIMPLE for r=0.8 class 1.0 = 0.814 +- 0.359 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.8 all KL = 0.781 +- 0.359 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.8 all L1 = 0.814 +- 0.274 (in-sample avg dev_std = 0.278)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.562
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8357747163695299
len(reference) = 2468
Effective ratio: 0.063 +- 0.078
Model Accuracy over intervened graphs for r=0.9 =  0.506
SUFF_SIMPLE for r=0.9 class 1.0 = 0.818 +- 0.351 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.9 all KL = 0.781 +- 0.351 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.9 all L1 = 0.818 +- 0.263 (in-sample avg dev_std = 0.309)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.562
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7820020259319288
len(reference) = 2468
Effective ratio: 0.052 +- 0.060
Model Accuracy over intervened graphs for r=0.95 =  0.501
SUFF_SIMPLE for r=0.95 class 1.0 = 0.822 +- 0.344 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.95 all KL = 0.785 +- 0.344 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.95 all L1 = 0.822 +- 0.258 (in-sample avg dev_std = 0.308)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.532841155234657
len(reference) = 277
Effective ratio: 0.237 +- 0.120
Model Accuracy over intervened graphs for r=0.5 =  0.936
NEC for r=0.5 class 1.0 = 0.119 +- 0.341 (in-sample avg dev_std = 0.388)
NEC for r=0.5 all KL = 0.336 +- 0.341 (in-sample avg dev_std = 0.388)
NEC for r=0.5 all L1 = 0.119 +- 0.147 (in-sample avg dev_std = 0.388)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9512635379061372
len(reference) = 277
Effective ratio: 0.087 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.839
NEC for r=0.8 class 1.0 = 0.263 +- 0.374 (in-sample avg dev_std = 0.479)
NEC for r=0.8 all KL = 0.57 +- 0.374 (in-sample avg dev_std = 0.479)
NEC for r=0.8 all L1 = 0.263 +- 0.235 (in-sample avg dev_std = 0.479)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.895779783393502
len(reference) = 277
Effective ratio: 0.077 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.835
NEC for r=0.9 class 1.0 = 0.267 +- 0.367 (in-sample avg dev_std = 0.459)
NEC for r=0.9 all KL = 0.578 +- 0.367 (in-sample avg dev_std = 0.459)
NEC for r=0.9 all L1 = 0.267 +- 0.235 (in-sample avg dev_std = 0.459)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8060361010830325
len(reference) = 277
Effective ratio: 0.068 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.809
NEC for r=0.95 class 1.0 = 0.29 +- 0.364 (in-sample avg dev_std = 0.447)
NEC for r=0.95 all KL = 0.599 +- 0.364 (in-sample avg dev_std = 0.447)
NEC for r=0.95 all L1 = 0.29 +- 0.252 (in-sample avg dev_std = 0.447)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.362
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10485793650793651
len(reference) = 2520
Effective ratio: 0.333 +- 0.178
Model Accuracy over intervened graphs for r=0.5 =  0.217
NEC for r=0.5 class 1.0 = 0.254 +- 0.360 (in-sample avg dev_std = 0.495)
NEC for r=0.5 all KL = 0.293 +- 0.360 (in-sample avg dev_std = 0.495)
NEC for r=0.5 all L1 = 0.254 +- 0.273 (in-sample avg dev_std = 0.495)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9433142857142858
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.351 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.364 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.351 +- 0.385 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.362
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9455095238095239
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.351 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.364 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.351 +- 0.385 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.362
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9239833333333334
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.351 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.364 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.351 +- 0.385 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.562
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.22969854132901132
len(reference) = 2468
Effective ratio: 0.481 +- 0.158
Model Accuracy over intervened graphs for r=0.5 =  0.366
NEC for r=0.5 class 1.0 = 0.283 +- 0.411 (in-sample avg dev_std = 0.555)
NEC for r=0.5 all KL = 0.408 +- 0.411 (in-sample avg dev_std = 0.555)
NEC for r=0.5 all L1 = 0.283 +- 0.277 (in-sample avg dev_std = 0.555)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8466000810372772
len(reference) = 2468
Effective ratio: 0.088 +- 0.122
Model Accuracy over intervened graphs for r=0.8 =  0.06
NEC for r=0.8 class 1.0 = 0.489 +- 0.455 (in-sample avg dev_std = 0.173)
NEC for r=0.8 all KL = 0.55 +- 0.455 (in-sample avg dev_std = 0.173)
NEC for r=0.8 all L1 = 0.489 +- 0.385 (in-sample avg dev_std = 0.173)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.562
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8357747163695299
len(reference) = 2468
Effective ratio: 0.063 +- 0.078
Model Accuracy over intervened graphs for r=0.9 =  0.069
NEC for r=0.9 class 1.0 = 0.478 +- 0.455 (in-sample avg dev_std = 0.129)
NEC for r=0.9 all KL = 0.535 +- 0.455 (in-sample avg dev_std = 0.129)
NEC for r=0.9 all L1 = 0.478 +- 0.388 (in-sample avg dev_std = 0.129)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.562
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7820020259319288
len(reference) = 2468
Effective ratio: 0.052 +- 0.060
Model Accuracy over intervened graphs for r=0.95 =  0.075
NEC for r=0.95 class 1.0 = 0.469 +- 0.455 (in-sample avg dev_std = 0.088)
NEC for r=0.95 all KL = 0.522 +- 0.455 (in-sample avg dev_std = 0.088)
NEC for r=0.95 all L1 = 0.469 +- 0.391 (in-sample avg dev_std = 0.088)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 01:36:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 01:36:56 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 01:36:56 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 01:36:56 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 01:36:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:36:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:36:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:36:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:36:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:36:56 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 01:36:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.424
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.715
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.699
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.640
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.105
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.844
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.748
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.686
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.263
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.694
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.630
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.596


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.424158844765343
len(reference) = 277
Effective ratio: 0.273 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.952
SUFF_SIMPLE for r=0.5 class 1.0 = 0.938 +- 0.329 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.5 all KL = 0.856 +- 0.329 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.5 all L1 = 0.938 +- 0.167 (in-sample avg dev_std = 0.310)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7153212996389892
len(reference) = 277
Effective ratio: 0.059 +- 0.051
Model Accuracy over intervened graphs for r=0.8 =  0.97
SUFF_SIMPLE for r=0.8 class 1.0 = 0.955 +- 0.295 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.8 all KL = 0.88 +- 0.295 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.8 all L1 = 0.955 +- 0.130 (in-sample avg dev_std = 0.275)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6993032490974729
len(reference) = 277
Effective ratio: 0.055 +- 0.045
Model Accuracy over intervened graphs for r=0.9 =  0.956
SUFF_SIMPLE for r=0.9 class 1.0 = 0.938 +- 0.336 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.9 all KL = 0.843 +- 0.336 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.9 all L1 = 0.938 +- 0.154 (in-sample avg dev_std = 0.326)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6397472924187725
len(reference) = 277
Effective ratio: 0.046 +- 0.031
Model Accuracy over intervened graphs for r=0.95 =  0.976
SUFF_SIMPLE for r=0.95 class 1.0 = 0.963 +- 0.279 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.95 all KL = 0.896 +- 0.279 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.95 all L1 = 0.963 +- 0.113 (in-sample avg dev_std = 0.254)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.637
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10522261904761906
len(reference) = 2520
Effective ratio: 0.245 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.645
SUFF_SIMPLE for r=0.5 class 1.0 = 0.863 +- 0.196 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.5 all KL = 0.877 +- 0.196 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.5 all L1 = 0.863 +- 0.187 (in-sample avg dev_std = 0.274)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8442154761904761
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.655
SUFF_SIMPLE for r=0.8 class 1.0 = 0.859 +- 0.192 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.8 all KL = 0.871 +- 0.192 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.8 all L1 = 0.859 +- 0.186 (in-sample avg dev_std = 0.284)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.747843253968254
len(reference) = 2520
Effective ratio: 0.009 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.653
SUFF_SIMPLE for r=0.9 class 1.0 = 0.855 +- 0.196 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.9 all KL = 0.864 +- 0.196 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.9 all L1 = 0.855 +- 0.186 (in-sample avg dev_std = 0.289)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.637
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6862718253968254
len(reference) = 2520
Effective ratio: 0.008 +- 0.001
Model Accuracy over intervened graphs for r=0.95 =  0.654
SUFF_SIMPLE for r=0.95 class 1.0 = 0.853 +- 0.199 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.95 all KL = 0.861 +- 0.199 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.95 all L1 = 0.853 +- 0.187 (in-sample avg dev_std = 0.296)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.796
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.26324756888168555
len(reference) = 2466
Effective ratio: 0.367 +- 0.204
Model Accuracy over intervened graphs for r=0.5 =  0.736
SUFF_SIMPLE for r=0.5 class 1.0 = 0.823 +- 0.378 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.5 all KL = 0.773 +- 0.378 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.5 all L1 = 0.823 +- 0.283 (in-sample avg dev_std = 0.276)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6935741491085899
len(reference) = 2468
Effective ratio: 0.067 +- 0.113
Model Accuracy over intervened graphs for r=0.8 =  0.735
SUFF_SIMPLE for r=0.8 class 1.0 = 0.83 +- 0.377 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.8 all KL = 0.77 +- 0.377 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.8 all L1 = 0.83 +- 0.267 (in-sample avg dev_std = 0.341)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6301106158833063
len(reference) = 2468
Effective ratio: 0.054 +- 0.090
Model Accuracy over intervened graphs for r=0.9 =  0.726
SUFF_SIMPLE for r=0.9 class 1.0 = 0.833 +- 0.373 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.9 all KL = 0.779 +- 0.373 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.9 all L1 = 0.833 +- 0.263 (in-sample avg dev_std = 0.353)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.796
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.5956073743922203
len(reference) = 2468
Effective ratio: 0.046 +- 0.076
Model Accuracy over intervened graphs for r=0.95 =  0.733
SUFF_SIMPLE for r=0.95 class 1.0 = 0.835 +- 0.375 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.95 all KL = 0.774 +- 0.375 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.95 all L1 = 0.835 +- 0.257 (in-sample avg dev_std = 0.368)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.424158844765343
len(reference) = 277
Effective ratio: 0.273 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.981
NEC for r=0.5 class 1.0 = 0.034 +- 0.252 (in-sample avg dev_std = 0.229)
NEC for r=0.5 all KL = 0.109 +- 0.252 (in-sample avg dev_std = 0.229)
NEC for r=0.5 all L1 = 0.034 +- 0.093 (in-sample avg dev_std = 0.229)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7153212996389892
len(reference) = 277
Effective ratio: 0.059 +- 0.051
Model Accuracy over intervened graphs for r=0.8 =  0.952
NEC for r=0.8 class 1.0 = 0.084 +- 0.350 (in-sample avg dev_std = 0.300)
NEC for r=0.8 all KL = 0.228 +- 0.350 (in-sample avg dev_std = 0.300)
NEC for r=0.8 all L1 = 0.084 +- 0.156 (in-sample avg dev_std = 0.300)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6993032490974729
len(reference) = 277
Effective ratio: 0.055 +- 0.045
Model Accuracy over intervened graphs for r=0.9 =  0.947
NEC for r=0.9 class 1.0 = 0.088 +- 0.351 (in-sample avg dev_std = 0.299)
NEC for r=0.9 all KL = 0.234 +- 0.351 (in-sample avg dev_std = 0.299)
NEC for r=0.9 all L1 = 0.088 +- 0.165 (in-sample avg dev_std = 0.299)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6397472924187725
len(reference) = 277
Effective ratio: 0.046 +- 0.031
Model Accuracy over intervened graphs for r=0.95 =  0.935
NEC for r=0.95 class 1.0 = 0.095 +- 0.355 (in-sample avg dev_std = 0.274)
NEC for r=0.95 all KL = 0.236 +- 0.355 (in-sample avg dev_std = 0.274)
NEC for r=0.95 all L1 = 0.095 +- 0.184 (in-sample avg dev_std = 0.274)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.637
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10522261904761906
len(reference) = 2520
Effective ratio: 0.245 +- 0.119
Model Accuracy over intervened graphs for r=0.5 =  0.539
NEC for r=0.5 class 1.0 = 0.267 +- 0.343 (in-sample avg dev_std = 0.556)
NEC for r=0.5 all KL = 0.392 +- 0.343 (in-sample avg dev_std = 0.556)
NEC for r=0.5 all L1 = 0.267 +- 0.208 (in-sample avg dev_std = 0.556)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8442154761904761
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.586 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.636 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.586 +- 0.364 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.747843253968254
len(reference) = 2520
Effective ratio: 0.009 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.586 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.636 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.586 +- 0.364 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.637
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6862718253968254
len(reference) = 2520
Effective ratio: 0.008 +- 0.001
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.586 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.636 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.586 +- 0.364 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.796
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.26324756888168555
len(reference) = 2468
Effective ratio: 0.367 +- 0.204
Model Accuracy over intervened graphs for r=0.5 =  0.739
NEC for r=0.5 class 1.0 = 0.193 +- 0.383 (in-sample avg dev_std = 0.463)
NEC for r=0.5 all KL = 0.372 +- 0.383 (in-sample avg dev_std = 0.463)
NEC for r=0.5 all L1 = 0.193 +- 0.222 (in-sample avg dev_std = 0.463)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6935741491085899
len(reference) = 2468
Effective ratio: 0.067 +- 0.113
Model Accuracy over intervened graphs for r=0.8 =  0.092
NEC for r=0.8 class 1.0 = 0.677 +- 0.382 (in-sample avg dev_std = 0.075)
NEC for r=0.8 all KL = 0.776 +- 0.382 (in-sample avg dev_std = 0.075)
NEC for r=0.8 all L1 = 0.677 +- 0.322 (in-sample avg dev_std = 0.075)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6301106158833063
len(reference) = 2468
Effective ratio: 0.054 +- 0.090
Model Accuracy over intervened graphs for r=0.9 =  0.109
NEC for r=0.9 class 1.0 = 0.659 +- 0.401 (in-sample avg dev_std = 0.043)
NEC for r=0.9 all KL = 0.751 +- 0.401 (in-sample avg dev_std = 0.043)
NEC for r=0.9 all L1 = 0.659 +- 0.338 (in-sample avg dev_std = 0.043)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.796
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.5956073743922203
len(reference) = 2468
Effective ratio: 0.046 +- 0.076
Model Accuracy over intervened graphs for r=0.95 =  0.13
NEC for r=0.95 class 1.0 = 0.636 +- 0.417 (in-sample avg dev_std = 0.002)
NEC for r=0.95 all KL = 0.722 +- 0.417 (in-sample avg dev_std = 0.002)
NEC for r=0.95 all L1 = 0.636 +- 0.354 (in-sample avg dev_std = 0.002)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 01:43:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 01:43:00 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 01:43:00 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 01:43:00 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 01:43:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:43:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:43:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:43:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:43:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:43:00 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 01:43:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.650
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.771
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.680
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.649
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.061
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.847
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.753
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.658
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.266
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.645
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.605
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.569


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.6496931407942238
len(reference) = 277
Effective ratio: 0.189 +- 0.124
Model Accuracy over intervened graphs for r=0.5 =  0.968
SUFF_SIMPLE for r=0.5 class 1.0 = 0.957 +- 0.272 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.5 all KL = 0.905 +- 0.272 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.5 all L1 = 0.957 +- 0.142 (in-sample avg dev_std = 0.250)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.770725631768953
len(reference) = 277
Effective ratio: 0.063 +- 0.052
Model Accuracy over intervened graphs for r=0.8 =  0.972
SUFF_SIMPLE for r=0.8 class 1.0 = 0.959 +- 0.276 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.8 all KL = 0.902 +- 0.276 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.8 all L1 = 0.959 +- 0.128 (in-sample avg dev_std = 0.267)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6800794223826715
len(reference) = 277
Effective ratio: 0.057 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.977
SUFF_SIMPLE for r=0.9 class 1.0 = 0.966 +- 0.255 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.9 all KL = 0.914 +- 0.255 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.9 all L1 = 0.966 +- 0.117 (in-sample avg dev_std = 0.239)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6492238267148015
len(reference) = 277
Effective ratio: 0.053 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.975
SUFF_SIMPLE for r=0.95 class 1.0 = 0.962 +- 0.272 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.95 all KL = 0.899 +- 0.272 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.95 all L1 = 0.962 +- 0.117 (in-sample avg dev_std = 0.256)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.588
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.06138531746031745
len(reference) = 2520
Effective ratio: 0.437 +- 0.156
Model Accuracy over intervened graphs for r=0.5 =  0.617
SUFF_SIMPLE for r=0.5 class 1.0 = 0.847 +- 0.234 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.5 all KL = 0.835 +- 0.234 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.5 all L1 = 0.847 +- 0.204 (in-sample avg dev_std = 0.315)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8469876984126985
len(reference) = 2520
Effective ratio: 0.010 +- 0.004
Model Accuracy over intervened graphs for r=0.8 =  0.61
SUFF_SIMPLE for r=0.8 class 1.0 = 0.843 +- 0.235 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.8 all KL = 0.828 +- 0.235 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.8 all L1 = 0.843 +- 0.202 (in-sample avg dev_std = 0.333)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.588
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7529039682539682
len(reference) = 2520
Effective ratio: 0.009 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.608
SUFF_SIMPLE for r=0.9 class 1.0 = 0.843 +- 0.234 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.9 all KL = 0.825 +- 0.234 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.9 all L1 = 0.843 +- 0.201 (in-sample avg dev_std = 0.333)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.588
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6583392857142857
len(reference) = 2520
Effective ratio: 0.008 +- 0.004
Model Accuracy over intervened graphs for r=0.95 =  0.609
SUFF_SIMPLE for r=0.95 class 1.0 = 0.839 +- 0.234 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.95 all KL = 0.818 +- 0.234 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.95 all L1 = 0.839 +- 0.202 (in-sample avg dev_std = 0.339)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.762
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.26644854132901136
len(reference) = 2468
Effective ratio: 0.365 +- 0.169
Model Accuracy over intervened graphs for r=0.5 =  0.668
SUFF_SIMPLE for r=0.5 class 1.0 = 0.829 +- 0.372 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.5 all KL = 0.783 +- 0.372 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.5 all L1 = 0.829 +- 0.283 (in-sample avg dev_std = 0.262)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6445927876823339
len(reference) = 2468
Effective ratio: 0.074 +- 0.117
Model Accuracy over intervened graphs for r=0.8 =  0.666
SUFF_SIMPLE for r=0.8 class 1.0 = 0.838 +- 0.368 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.8 all KL = 0.784 +- 0.368 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.8 all L1 = 0.838 +- 0.272 (in-sample avg dev_std = 0.290)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6052491896272286
len(reference) = 2468
Effective ratio: 0.055 +- 0.088
Model Accuracy over intervened graphs for r=0.9 =  0.667
SUFF_SIMPLE for r=0.9 class 1.0 = 0.843 +- 0.364 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.9 all KL = 0.793 +- 0.364 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.9 all L1 = 0.843 +- 0.268 (in-sample avg dev_std = 0.299)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.762
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.5686551863857374
len(reference) = 2468
Effective ratio: 0.044 +- 0.061
Model Accuracy over intervened graphs for r=0.95 =  0.666
SUFF_SIMPLE for r=0.95 class 1.0 = 0.853 +- 0.360 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.95 all KL = 0.802 +- 0.360 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.95 all L1 = 0.853 +- 0.262 (in-sample avg dev_std = 0.297)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.6496931407942238
len(reference) = 277
Effective ratio: 0.189 +- 0.124
Model Accuracy over intervened graphs for r=0.5 =  0.955
NEC for r=0.5 class 1.0 = 0.091 +- 0.334 (in-sample avg dev_std = 0.338)
NEC for r=0.5 all KL = 0.293 +- 0.334 (in-sample avg dev_std = 0.338)
NEC for r=0.5 all L1 = 0.091 +- 0.130 (in-sample avg dev_std = 0.338)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.770725631768953
len(reference) = 277
Effective ratio: 0.063 +- 0.052
Model Accuracy over intervened graphs for r=0.8 =  0.87
NEC for r=0.8 class 1.0 = 0.209 +- 0.394 (in-sample avg dev_std = 0.409)
NEC for r=0.8 all KL = 0.483 +- 0.394 (in-sample avg dev_std = 0.409)
NEC for r=0.8 all L1 = 0.209 +- 0.238 (in-sample avg dev_std = 0.409)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6800794223826715
len(reference) = 277
Effective ratio: 0.057 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.872
NEC for r=0.9 class 1.0 = 0.21 +- 0.394 (in-sample avg dev_std = 0.388)
NEC for r=0.9 all KL = 0.49 +- 0.394 (in-sample avg dev_std = 0.388)
NEC for r=0.9 all L1 = 0.21 +- 0.239 (in-sample avg dev_std = 0.388)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6492238267148015
len(reference) = 277
Effective ratio: 0.053 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.866
NEC for r=0.95 class 1.0 = 0.224 +- 0.399 (in-sample avg dev_std = 0.412)
NEC for r=0.95 all KL = 0.513 +- 0.399 (in-sample avg dev_std = 0.412)
NEC for r=0.95 all L1 = 0.224 +- 0.243 (in-sample avg dev_std = 0.412)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.588
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.06138531746031745
len(reference) = 2520
Effective ratio: 0.437 +- 0.156
Model Accuracy over intervened graphs for r=0.5 =  0.495
NEC for r=0.5 class 1.0 = 0.236 +- 0.357 (in-sample avg dev_std = 0.552)
NEC for r=0.5 all KL = 0.356 +- 0.357 (in-sample avg dev_std = 0.552)
NEC for r=0.5 all L1 = 0.236 +- 0.207 (in-sample avg dev_std = 0.552)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8469876984126985
len(reference) = 2520
Effective ratio: 0.010 +- 0.004
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.533 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.583 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.533 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.588
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7529039682539682
len(reference) = 2520
Effective ratio: 0.009 +- 0.004
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.533 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.582 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.533 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.588
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6583392857142857
len(reference) = 2520
Effective ratio: 0.008 +- 0.004
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.533 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.582 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.533 +- 0.389 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.762
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.26644854132901136
len(reference) = 2468
Effective ratio: 0.365 +- 0.169
Model Accuracy over intervened graphs for r=0.5 =  0.555
NEC for r=0.5 class 1.0 = 0.303 +- 0.416 (in-sample avg dev_std = 0.622)
NEC for r=0.5 all KL = 0.528 +- 0.416 (in-sample avg dev_std = 0.622)
NEC for r=0.5 all L1 = 0.303 +- 0.261 (in-sample avg dev_std = 0.622)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6445927876823339
len(reference) = 2468
Effective ratio: 0.074 +- 0.117
Model Accuracy over intervened graphs for r=0.8 =  0.056
NEC for r=0.8 class 1.0 = 0.654 +- 0.395 (in-sample avg dev_std = 0.118)
NEC for r=0.8 all KL = 0.755 +- 0.395 (in-sample avg dev_std = 0.118)
NEC for r=0.8 all L1 = 0.654 +- 0.336 (in-sample avg dev_std = 0.118)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6052491896272286
len(reference) = 2468
Effective ratio: 0.055 +- 0.088
Model Accuracy over intervened graphs for r=0.9 =  0.066
NEC for r=0.9 class 1.0 = 0.64 +- 0.413 (in-sample avg dev_std = 0.035)
NEC for r=0.9 all KL = 0.731 +- 0.413 (in-sample avg dev_std = 0.035)
NEC for r=0.9 all L1 = 0.64 +- 0.350 (in-sample avg dev_std = 0.035)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.762
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.5686551863857374
len(reference) = 2468
Effective ratio: 0.044 +- 0.061
Model Accuracy over intervened graphs for r=0.95 =  0.088
NEC for r=0.95 class 1.0 = 0.623 +- 0.421 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.712 +- 0.421 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.623 +- 0.359 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 01:48:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 01:48:04 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 01:48:04 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 01:48:04 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 01:48:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:48:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:48:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:48:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:48:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:48:04 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 01:48:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.665
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.818
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.706
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.639
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.094
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.929
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.881
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.824
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.288
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.774
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.696
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.621


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.6653212996389892
len(reference) = 277
Effective ratio: 0.185 +- 0.130
Model Accuracy over intervened graphs for r=0.5 =  0.964
SUFF_SIMPLE for r=0.5 class 1.0 = 0.951 +- 0.296 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.5 all KL = 0.888 +- 0.296 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.5 all L1 = 0.951 +- 0.150 (in-sample avg dev_std = 0.277)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8176606498194946
len(reference) = 277
Effective ratio: 0.066 +- 0.049
Model Accuracy over intervened graphs for r=0.8 =  0.981
SUFF_SIMPLE for r=0.8 class 1.0 = 0.971 +- 0.235 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.8 all KL = 0.932 +- 0.235 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.8 all L1 = 0.971 +- 0.112 (in-sample avg dev_std = 0.226)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7056425992779783
len(reference) = 277
Effective ratio: 0.059 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.978
SUFF_SIMPLE for r=0.9 class 1.0 = 0.97 +- 0.244 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.9 all KL = 0.927 +- 0.244 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.9 all L1 = 0.97 +- 0.115 (in-sample avg dev_std = 0.221)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.639014440433213
len(reference) = 277
Effective ratio: 0.051 +- 0.037
Model Accuracy over intervened graphs for r=0.95 =  0.98
SUFF_SIMPLE for r=0.95 class 1.0 = 0.969 +- 0.246 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.95 all KL = 0.918 +- 0.246 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.95 all L1 = 0.969 +- 0.106 (in-sample avg dev_std = 0.238)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.782
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0940670634920635
len(reference) = 2520
Effective ratio: 0.315 +- 0.134
Model Accuracy over intervened graphs for r=0.5 =  0.7
SUFF_SIMPLE for r=0.5 class 1.0 = 0.844 +- 0.293 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.5 all KL = 0.799 +- 0.293 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.5 all L1 = 0.844 +- 0.225 (in-sample avg dev_std = 0.353)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9287698412698413
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.725
SUFF_SIMPLE for r=0.8 class 1.0 = 0.862 +- 0.260 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.8 all KL = 0.83 +- 0.260 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.8 all L1 = 0.862 +- 0.206 (in-sample avg dev_std = 0.332)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.782
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8814742063492061
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.724
SUFF_SIMPLE for r=0.9 class 1.0 = 0.859 +- 0.265 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.9 all KL = 0.823 +- 0.265 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.9 all L1 = 0.859 +- 0.207 (in-sample avg dev_std = 0.339)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.782
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8236523809523809
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.723
SUFF_SIMPLE for r=0.95 class 1.0 = 0.857 +- 0.272 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.95 all KL = 0.821 +- 0.272 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.95 all L1 = 0.857 +- 0.211 (in-sample avg dev_std = 0.340)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.81
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2883565640194489
len(reference) = 2468
Effective ratio: 0.344 +- 0.192
Model Accuracy over intervened graphs for r=0.5 =  0.725
SUFF_SIMPLE for r=0.5 class 1.0 = 0.825 +- 0.378 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.5 all KL = 0.775 +- 0.378 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.5 all L1 = 0.825 +- 0.288 (in-sample avg dev_std = 0.268)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.81
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7735948136142625
len(reference) = 2468
Effective ratio: 0.072 +- 0.111
Model Accuracy over intervened graphs for r=0.8 =  0.726
SUFF_SIMPLE for r=0.8 class 1.0 = 0.843 +- 0.364 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.8 all KL = 0.788 +- 0.364 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.8 all L1 = 0.843 +- 0.262 (in-sample avg dev_std = 0.303)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6957860615883306
len(reference) = 2468
Effective ratio: 0.056 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.721
SUFF_SIMPLE for r=0.9 class 1.0 = 0.844 +- 0.362 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.9 all KL = 0.788 +- 0.362 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.9 all L1 = 0.844 +- 0.259 (in-sample avg dev_std = 0.318)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.81
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6210311993517017
len(reference) = 2468
Effective ratio: 0.047 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.722
SUFF_SIMPLE for r=0.95 class 1.0 = 0.848 +- 0.358 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.95 all KL = 0.793 +- 0.358 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.95 all L1 = 0.848 +- 0.255 (in-sample avg dev_std = 0.318)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.6653212996389892
len(reference) = 277
Effective ratio: 0.185 +- 0.130
Model Accuracy over intervened graphs for r=0.5 =  0.984
NEC for r=0.5 class 1.0 = 0.031 +- 0.230 (in-sample avg dev_std = 0.195)
NEC for r=0.5 all KL = 0.096 +- 0.230 (in-sample avg dev_std = 0.195)
NEC for r=0.5 all L1 = 0.031 +- 0.087 (in-sample avg dev_std = 0.195)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8176606498194946
len(reference) = 277
Effective ratio: 0.066 +- 0.049
Model Accuracy over intervened graphs for r=0.8 =  0.972
NEC for r=0.8 class 1.0 = 0.052 +- 0.276 (in-sample avg dev_std = 0.228)
NEC for r=0.8 all KL = 0.144 +- 0.276 (in-sample avg dev_std = 0.228)
NEC for r=0.8 all L1 = 0.052 +- 0.127 (in-sample avg dev_std = 0.228)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.7056425992779783
len(reference) = 277
Effective ratio: 0.059 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.971
NEC for r=0.9 class 1.0 = 0.06 +- 0.299 (in-sample avg dev_std = 0.243)
NEC for r=0.9 all KL = 0.164 +- 0.299 (in-sample avg dev_std = 0.243)
NEC for r=0.9 all L1 = 0.06 +- 0.137 (in-sample avg dev_std = 0.243)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.639014440433213
len(reference) = 277
Effective ratio: 0.051 +- 0.037
Model Accuracy over intervened graphs for r=0.95 =  0.958
NEC for r=0.95 class 1.0 = 0.067 +- 0.304 (in-sample avg dev_std = 0.225)
NEC for r=0.95 all KL = 0.169 +- 0.304 (in-sample avg dev_std = 0.225)
NEC for r=0.95 all L1 = 0.067 +- 0.161 (in-sample avg dev_std = 0.225)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.782
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0940670634920635
len(reference) = 2520
Effective ratio: 0.315 +- 0.134
Model Accuracy over intervened graphs for r=0.5 =  0.672
NEC for r=0.5 class 1.0 = 0.22 +- 0.366 (in-sample avg dev_std = 0.545)
NEC for r=0.5 all KL = 0.4 +- 0.366 (in-sample avg dev_std = 0.545)
NEC for r=0.5 all L1 = 0.22 +- 0.198 (in-sample avg dev_std = 0.545)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9287698412698413
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.694 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.777 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.694 +- 0.317 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.782
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8814742063492061
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.694 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.777 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.694 +- 0.317 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.782
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.8236523809523809
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.001
NEC for r=0.95 class 1.0 = 0.693 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.776 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.693 +- 0.317 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.81
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2883565640194489
len(reference) = 2468
Effective ratio: 0.344 +- 0.192
Model Accuracy over intervened graphs for r=0.5 =  0.613
NEC for r=0.5 class 1.0 = 0.284 +- 0.402 (in-sample avg dev_std = 0.588)
NEC for r=0.5 all KL = 0.48 +- 0.402 (in-sample avg dev_std = 0.588)
NEC for r=0.5 all L1 = 0.284 +- 0.254 (in-sample avg dev_std = 0.588)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.81
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7735948136142625
len(reference) = 2468
Effective ratio: 0.072 +- 0.111
Model Accuracy over intervened graphs for r=0.8 =  0.073
NEC for r=0.8 class 1.0 = 0.664 +- 0.384 (in-sample avg dev_std = 0.092)
NEC for r=0.8 all KL = 0.764 +- 0.384 (in-sample avg dev_std = 0.092)
NEC for r=0.8 all L1 = 0.664 +- 0.328 (in-sample avg dev_std = 0.092)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.6957860615883306
len(reference) = 2468
Effective ratio: 0.056 +- 0.087
Model Accuracy over intervened graphs for r=0.9 =  0.091
NEC for r=0.9 class 1.0 = 0.646 +- 0.401 (in-sample avg dev_std = 0.029)
NEC for r=0.9 all KL = 0.74 +- 0.401 (in-sample avg dev_std = 0.029)
NEC for r=0.9 all L1 = 0.646 +- 0.342 (in-sample avg dev_std = 0.029)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.81
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.6210311993517017
len(reference) = 2468
Effective ratio: 0.047 +- 0.075
Model Accuracy over intervened graphs for r=0.95 =  0.113
NEC for r=0.95 class 1.0 = 0.626 +- 0.416 (in-sample avg dev_std = 0.003)
NEC for r=0.95 all KL = 0.713 +- 0.416 (in-sample avg dev_std = 0.003)
NEC for r=0.95 all L1 = 0.626 +- 0.356 (in-sample avg dev_std = 0.003)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 01:53:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 01:53:25 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 01:53:25 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 01:53:25 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 01:53:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:53:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:53:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:53:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:53:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:53:25 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 01:53:25 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.536
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.942
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.877
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.799
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.151
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.923
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.936
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.933
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.236
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.833
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.820
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.731


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5360938628158844
len(reference) = 277
Effective ratio: 0.241 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.978
SUFF_SIMPLE for r=0.5 class 1.0 = 0.97 +- 0.237 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.5 all KL = 0.934 +- 0.237 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.5 all L1 = 0.97 +- 0.121 (in-sample avg dev_std = 0.221)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.941797833935018
len(reference) = 277
Effective ratio: 0.089 +- 0.066
Model Accuracy over intervened graphs for r=0.8 =  0.987
SUFF_SIMPLE for r=0.8 class 1.0 = 0.979 +- 0.225 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 all KL = 0.941 +- 0.225 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 all L1 = 0.979 +- 0.087 (in-sample avg dev_std = 0.189)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8772490974729241
len(reference) = 277
Effective ratio: 0.075 +- 0.050
Model Accuracy over intervened graphs for r=0.9 =  0.987
SUFF_SIMPLE for r=0.9 class 1.0 = 0.979 +- 0.223 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.9 all KL = 0.941 +- 0.223 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.9 all L1 = 0.979 +- 0.088 (in-sample avg dev_std = 0.194)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7993682310469314
len(reference) = 277
Effective ratio: 0.065 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.985
SUFF_SIMPLE for r=0.95 class 1.0 = 0.977 +- 0.234 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.95 all KL = 0.936 +- 0.234 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.95 all L1 = 0.977 +- 0.094 (in-sample avg dev_std = 0.207)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.508
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.15099007936507935
len(reference) = 2520
Effective ratio: 0.197 +- 0.104
Model Accuracy over intervened graphs for r=0.5 =  0.279
SUFF_SIMPLE for r=0.5 class 1.0 = 0.697 +- 0.335 (in-sample avg dev_std = 0.396)
SUFF_SIMPLE for r=0.5 all KL = 0.662 +- 0.335 (in-sample avg dev_std = 0.396)
SUFF_SIMPLE for r=0.5 all L1 = 0.697 +- 0.282 (in-sample avg dev_std = 0.396)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9233301587301586
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.292
SUFF_SIMPLE for r=0.8 class 1.0 = 0.707 +- 0.323 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.8 all KL = 0.675 +- 0.323 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.8 all L1 = 0.707 +- 0.275 (in-sample avg dev_std = 0.394)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.508
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9362694444444446
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.295
SUFF_SIMPLE for r=0.9 class 1.0 = 0.708 +- 0.322 (in-sample avg dev_std = 0.398)
SUFF_SIMPLE for r=0.9 all KL = 0.676 +- 0.322 (in-sample avg dev_std = 0.398)
SUFF_SIMPLE for r=0.9 all L1 = 0.708 +- 0.273 (in-sample avg dev_std = 0.398)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.508
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9327579365079364
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.298
SUFF_SIMPLE for r=0.95 class 1.0 = 0.709 +- 0.320 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.95 all KL = 0.677 +- 0.320 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.95 all L1 = 0.709 +- 0.273 (in-sample avg dev_std = 0.399)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.913
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2356600486223663
len(reference) = 2468
Effective ratio: 0.439 +- 0.136
Model Accuracy over intervened graphs for r=0.5 =  0.854
SUFF_SIMPLE for r=0.5 class 1.0 = 0.865 +- 0.366 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.5 all KL = 0.82 +- 0.366 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.5 all L1 = 0.865 +- 0.283 (in-sample avg dev_std = 0.221)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.913
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8331892220421393
len(reference) = 2468
Effective ratio: 0.071 +- 0.085
Model Accuracy over intervened graphs for r=0.8 =  0.848
SUFF_SIMPLE for r=0.8 class 1.0 = 0.872 +- 0.362 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.8 all KL = 0.822 +- 0.362 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.8 all L1 = 0.872 +- 0.270 (in-sample avg dev_std = 0.283)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8197504051863859
len(reference) = 2468
Effective ratio: 0.056 +- 0.063
Model Accuracy over intervened graphs for r=0.9 =  0.848
SUFF_SIMPLE for r=0.9 class 1.0 = 0.876 +- 0.358 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.9 all KL = 0.824 +- 0.358 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.9 all L1 = 0.876 +- 0.263 (in-sample avg dev_std = 0.300)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.913
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7309874392220422
len(reference) = 2468
Effective ratio: 0.047 +- 0.051
Model Accuracy over intervened graphs for r=0.95 =  0.847
SUFF_SIMPLE for r=0.95 class 1.0 = 0.88 +- 0.351 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.95 all KL = 0.83 +- 0.351 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.95 all L1 = 0.88 +- 0.257 (in-sample avg dev_std = 0.299)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.5360938628158844
len(reference) = 277
Effective ratio: 0.241 +- 0.125
Model Accuracy over intervened graphs for r=0.5 =  0.977
NEC for r=0.5 class 1.0 = 0.049 +- 0.313 (in-sample avg dev_std = 0.256)
NEC for r=0.5 all KL = 0.174 +- 0.313 (in-sample avg dev_std = 0.256)
NEC for r=0.5 all L1 = 0.049 +- 0.110 (in-sample avg dev_std = 0.256)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.941797833935018
len(reference) = 277
Effective ratio: 0.089 +- 0.066
Model Accuracy over intervened graphs for r=0.8 =  0.953
NEC for r=0.8 class 1.0 = 0.091 +- 0.367 (in-sample avg dev_std = 0.332)
NEC for r=0.8 all KL = 0.267 +- 0.367 (in-sample avg dev_std = 0.332)
NEC for r=0.8 all L1 = 0.091 +- 0.165 (in-sample avg dev_std = 0.332)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8772490974729241
len(reference) = 277
Effective ratio: 0.075 +- 0.050
Model Accuracy over intervened graphs for r=0.9 =  0.943
NEC for r=0.9 class 1.0 = 0.106 +- 0.376 (in-sample avg dev_std = 0.329)
NEC for r=0.9 all KL = 0.29 +- 0.376 (in-sample avg dev_std = 0.329)
NEC for r=0.9 all L1 = 0.106 +- 0.187 (in-sample avg dev_std = 0.329)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7993682310469314
len(reference) = 277
Effective ratio: 0.065 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.931
NEC for r=0.95 class 1.0 = 0.121 +- 0.394 (in-sample avg dev_std = 0.355)
NEC for r=0.95 all KL = 0.31 +- 0.394 (in-sample avg dev_std = 0.355)
NEC for r=0.95 all L1 = 0.121 +- 0.203 (in-sample avg dev_std = 0.355)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.508
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.15099007936507935
len(reference) = 2520
Effective ratio: 0.197 +- 0.104
Model Accuracy over intervened graphs for r=0.5 =  0.23
NEC for r=0.5 class 1.0 = 0.369 +- 0.390 (in-sample avg dev_std = 0.558)
NEC for r=0.5 all KL = 0.43 +- 0.390 (in-sample avg dev_std = 0.558)
NEC for r=0.5 all L1 = 0.369 +- 0.295 (in-sample avg dev_std = 0.558)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9233301587301586
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.483 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.505 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.483 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.508
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.9362694444444446
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.9 =  0.0
NEC for r=0.9 class 1.0 = 0.483 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.505 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.483 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.508
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.9327579365079364
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.95 =  0.0
NEC for r=0.95 class 1.0 = 0.483 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.505 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.483 +- 0.382 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.913
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.2356600486223663
len(reference) = 2468
Effective ratio: 0.439 +- 0.136
Model Accuracy over intervened graphs for r=0.5 =  0.76
NEC for r=0.5 class 1.0 = 0.221 +- 0.430 (in-sample avg dev_std = 0.512)
NEC for r=0.5 all KL = 0.435 +- 0.430 (in-sample avg dev_std = 0.512)
NEC for r=0.5 all L1 = 0.221 +- 0.267 (in-sample avg dev_std = 0.512)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.913
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8331892220421393
len(reference) = 2468
Effective ratio: 0.071 +- 0.085
Model Accuracy over intervened graphs for r=0.8 =  0.119
NEC for r=0.8 class 1.0 = 0.734 +- 0.308 (in-sample avg dev_std = 0.330)
NEC for r=0.8 all KL = 0.878 +- 0.308 (in-sample avg dev_std = 0.330)
NEC for r=0.8 all L1 = 0.734 +- 0.264 (in-sample avg dev_std = 0.330)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.8197504051863859
len(reference) = 2468
Effective ratio: 0.056 +- 0.063
Model Accuracy over intervened graphs for r=0.9 =  0.101
NEC for r=0.9 class 1.0 = 0.734 +- 0.326 (in-sample avg dev_std = 0.198)
NEC for r=0.9 all KL = 0.863 +- 0.326 (in-sample avg dev_std = 0.198)
NEC for r=0.9 all L1 = 0.734 +- 0.280 (in-sample avg dev_std = 0.198)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.913
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.7309874392220422
len(reference) = 2468
Effective ratio: 0.047 +- 0.051
Model Accuracy over intervened graphs for r=0.95 =  0.112
NEC for r=0.95 class 1.0 = 0.722 +- 0.343 (in-sample avg dev_std = 0.168)
NEC for r=0.95 all KL = 0.846 +- 0.343 (in-sample avg dev_std = 0.168)
NEC for r=0.95 all L1 = 0.722 +- 0.295 (in-sample avg dev_std = 0.168)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.864, 0.869, 0.881, 0.882], 'all_L1': [0.943, 0.949, 0.95, 0.957]}), defaultdict(<class 'list'>, {'all_KL': [0.906, 0.9, 0.921, 0.917], 'all_L1': [0.958, 0.963, 0.97, 0.971]}), defaultdict(<class 'list'>, {'all_KL': [0.912, 0.908, 0.925, 0.919], 'all_L1': [0.963, 0.964, 0.97, 0.971]}), defaultdict(<class 'list'>, {'all_KL': [0.945, 0.948, 0.953, 0.951], 'all_L1': [0.973, 0.976, 0.978, 0.976]}), defaultdict(<class 'list'>, {'all_KL': [0.902, 0.932, 0.932, 0.907], 'all_L1': [0.959, 0.972, 0.974, 0.965]}), defaultdict(<class 'list'>, {'all_KL': [0.937, 0.951, 0.953, 0.949], 'all_L1': [0.969, 0.979, 0.979, 0.98]}), defaultdict(<class 'list'>, {'all_KL': [0.856, 0.88, 0.843, 0.896], 'all_L1': [0.938, 0.955, 0.938, 0.963]}), defaultdict(<class 'list'>, {'all_KL': [0.905, 0.902, 0.914, 0.899], 'all_L1': [0.957, 0.959, 0.966, 0.962]}), defaultdict(<class 'list'>, {'all_KL': [0.888, 0.932, 0.927, 0.918], 'all_L1': [0.951, 0.971, 0.97, 0.969]}), defaultdict(<class 'list'>, {'all_KL': [0.934, 0.941, 0.941, 0.936], 'all_L1': [0.97, 0.979, 0.979, 0.977]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.118, 0.207, 0.231, 0.23], 'all_L1': [0.033, 0.07, 0.078, 0.085]}), defaultdict(<class 'list'>, {'all_KL': [0.063, 0.152, 0.167, 0.176], 'all_L1': [0.023, 0.062, 0.069, 0.079]}), defaultdict(<class 'list'>, {'all_KL': [0.033, 0.061, 0.053, 0.06], 'all_L1': [0.01, 0.022, 0.019, 0.02]}), defaultdict(<class 'list'>, {'all_KL': [0.112, 0.227, 0.255, 0.275], 'all_L1': [0.032, 0.083, 0.09, 0.102]}), defaultdict(<class 'list'>, {'all_KL': [0.14, 0.205, 0.211, 0.231], 'all_L1': [0.042, 0.075, 0.075, 0.091]}), defaultdict(<class 'list'>, {'all_KL': [0.336, 0.57, 0.578, 0.599], 'all_L1': [0.119, 0.263, 0.267, 0.29]}), defaultdict(<class 'list'>, {'all_KL': [0.109, 0.228, 0.234, 0.236], 'all_L1': [0.034, 0.084, 0.088, 0.095]}), defaultdict(<class 'list'>, {'all_KL': [0.293, 0.483, 0.49, 0.513], 'all_L1': [0.091, 0.209, 0.21, 0.224]}), defaultdict(<class 'list'>, {'all_KL': [0.096, 0.144, 0.164, 0.169], 'all_L1': [0.031, 0.052, 0.06, 0.067]}), defaultdict(<class 'list'>, {'all_KL': [0.174, 0.267, 0.29, 0.31], 'all_L1': [0.049, 0.091, 0.106, 0.121]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.812, 0.816, 0.81, 0.81], 'all_L1': [0.833, 0.837, 0.834, 0.835]}), defaultdict(<class 'list'>, {'all_KL': [0.771, 0.797, 0.789, 0.787], 'all_L1': [0.782, 0.799, 0.794, 0.793]}), defaultdict(<class 'list'>, {'all_KL': [0.745, 0.768, 0.77, 0.761], 'all_L1': [0.835, 0.849, 0.848, 0.845]}), defaultdict(<class 'list'>, {'all_KL': [0.512, 0.537, 0.539, 0.534], 'all_L1': [0.649, 0.666, 0.665, 0.664]}), defaultdict(<class 'list'>, {'all_KL': [0.827, 0.826, 0.82, 0.822], 'all_L1': [0.825, 0.824, 0.821, 0.821]}), defaultdict(<class 'list'>, {'all_KL': [0.835, 0.838, 0.84, 0.833], 'all_L1': [0.83, 0.832, 0.833, 0.83]}), defaultdict(<class 'list'>, {'all_KL': [0.877, 0.871, 0.864, 0.861], 'all_L1': [0.863, 0.859, 0.855, 0.853]}), defaultdict(<class 'list'>, {'all_KL': [0.835, 0.828, 0.825, 0.818], 'all_L1': [0.847, 0.843, 0.843, 0.839]}), defaultdict(<class 'list'>, {'all_KL': [0.799, 0.83, 0.823, 0.821], 'all_L1': [0.844, 0.862, 0.859, 0.857]}), defaultdict(<class 'list'>, {'all_KL': [0.662, 0.675, 0.676, 0.677], 'all_L1': [0.697, 0.707, 0.708, 0.709]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.292, 0.459, 0.459, 0.459], 'all_L1': [0.206, 0.428, 0.428, 0.428]}), defaultdict(<class 'list'>, {'all_KL': [0.384, 0.772, 0.772, 0.771], 'all_L1': [0.275, 0.707, 0.707, 0.707]}), defaultdict(<class 'list'>, {'all_KL': [0.508, 0.872, 0.872, 0.872], 'all_L1': [0.241, 0.769, 0.769, 0.769]}), defaultdict(<class 'list'>, {'all_KL': [0.554, 0.768, 0.768, 0.768], 'all_L1': [0.37, 0.698, 0.698, 0.698]}), defaultdict(<class 'list'>, {'all_KL': [0.333, 0.497, 0.497, 0.497], 'all_L1': [0.256, 0.468, 0.468, 0.468]}), defaultdict(<class 'list'>, {'all_KL': [0.293, 0.364, 0.364, 0.364], 'all_L1': [0.254, 0.351, 0.351, 0.351]}), defaultdict(<class 'list'>, {'all_KL': [0.392, 0.636, 0.636, 0.636], 'all_L1': [0.267, 0.586, 0.586, 0.586]}), defaultdict(<class 'list'>, {'all_KL': [0.356, 0.583, 0.582, 0.582], 'all_L1': [0.236, 0.533, 0.533, 0.533]}), defaultdict(<class 'list'>, {'all_KL': [0.4, 0.777, 0.777, 0.776], 'all_L1': [0.22, 0.694, 0.694, 0.693]}), defaultdict(<class 'list'>, {'all_KL': [0.43, 0.505, 0.505, 0.505], 'all_L1': [0.369, 0.483, 0.483, 0.483]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.792, 0.794, 0.779, 0.789], 'all_L1': [0.834, 0.845, 0.842, 0.847]}), defaultdict(<class 'list'>, {'all_KL': [0.754, 0.76, 0.777, 0.787], 'all_L1': [0.803, 0.818, 0.833, 0.842]}), defaultdict(<class 'list'>, {'all_KL': [0.771, 0.783, 0.794, 0.798], 'all_L1': [0.803, 0.823, 0.831, 0.836]}), defaultdict(<class 'list'>, {'all_KL': [0.807, 0.823, 0.829, 0.832], 'all_L1': [0.849, 0.861, 0.868, 0.868]}), defaultdict(<class 'list'>, {'all_KL': [0.759, 0.75, 0.755, 0.759], 'all_L1': [0.796, 0.808, 0.816, 0.822]}), defaultdict(<class 'list'>, {'all_KL': [0.768, 0.781, 0.781, 0.785], 'all_L1': [0.79, 0.814, 0.818, 0.822]}), defaultdict(<class 'list'>, {'all_KL': [0.773, 0.77, 0.779, 0.774], 'all_L1': [0.823, 0.83, 0.833, 0.835]}), defaultdict(<class 'list'>, {'all_KL': [0.783, 0.784, 0.793, 0.802], 'all_L1': [0.829, 0.838, 0.843, 0.853]}), defaultdict(<class 'list'>, {'all_KL': [0.775, 0.788, 0.788, 0.793], 'all_L1': [0.825, 0.843, 0.844, 0.848]}), defaultdict(<class 'list'>, {'all_KL': [0.82, 0.822, 0.824, 0.83], 'all_L1': [0.865, 0.872, 0.876, 0.88]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.362, 0.754, 0.734, 0.71], 'all_L1': [0.181, 0.64, 0.637, 0.618]}), defaultdict(<class 'list'>, {'all_KL': [0.415, 0.701, 0.679, 0.649], 'all_L1': [0.234, 0.607, 0.596, 0.575]}), defaultdict(<class 'list'>, {'all_KL': [0.365, 0.666, 0.643, 0.625], 'all_L1': [0.23, 0.578, 0.565, 0.552]}), defaultdict(<class 'list'>, {'all_KL': [0.561, 0.835, 0.825, 0.81], 'all_L1': [0.335, 0.73, 0.722, 0.708]}), defaultdict(<class 'list'>, {'all_KL': [0.431, 0.686, 0.663, 0.645], 'all_L1': [0.25, 0.605, 0.591, 0.578]}), defaultdict(<class 'list'>, {'all_KL': [0.408, 0.55, 0.535, 0.522], 'all_L1': [0.283, 0.489, 0.478, 0.469]}), defaultdict(<class 'list'>, {'all_KL': [0.372, 0.776, 0.751, 0.722], 'all_L1': [0.193, 0.677, 0.659, 0.636]}), defaultdict(<class 'list'>, {'all_KL': [0.528, 0.755, 0.731, 0.712], 'all_L1': [0.303, 0.654, 0.64, 0.623]}), defaultdict(<class 'list'>, {'all_KL': [0.48, 0.764, 0.74, 0.713], 'all_L1': [0.284, 0.664, 0.646, 0.626]}), defaultdict(<class 'list'>, {'all_KL': [0.435, 0.878, 0.863, 0.846], 'all_L1': [0.221, 0.734, 0.734, 0.722]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.958 +- 0.011, 0.967 +- 0.010, 0.967 +- 0.013, 0.969 +- 0.007
suff_simple class all_KL  =  0.905 +- 0.028, 0.916 +- 0.027, 0.919 +- 0.032, 0.917 +- 0.022
suff_simple_acc_int  =  0.969 +- 0.009, 0.978 +- 0.007, 0.978 +- 0.009, 0.980 +- 0.004
nec class all_L1  =  0.046 +- 0.032, 0.101 +- 0.071, 0.106 +- 0.071, 0.117 +- 0.076
nec class all_KL  =  0.147 +- 0.092, 0.254 +- 0.148, 0.267 +- 0.148, 0.280 +- 0.153
nec_acc_int  =  0.978 +- 0.018, 0.945 +- 0.047, 0.943 +- 0.048, 0.933 +- 0.052

Eval split val
suff_simple class all_L1  =  0.801 +- 0.068, 0.808 +- 0.064, 0.806 +- 0.063, 0.805 +- 0.062
suff_simple class all_KL  =  0.768 +- 0.102, 0.779 +- 0.095, 0.776 +- 0.093, 0.772 +- 0.093
suff_simple_acc_int  =  0.542 +- 0.161, 0.557 +- 0.164, 0.556 +- 0.162, 0.555 +- 0.161
nec class all_L1  =  0.269 +- 0.054, 0.572 +- 0.133, 0.572 +- 0.133, 0.572 +- 0.133
nec class all_KL  =  0.394 +- 0.081, 0.623 +- 0.160, 0.623 +- 0.160, 0.623 +- 0.159
nec_acc_int  =  0.489 +- 0.170, 0.000 +- 0.000, 0.000 +- 0.000, 0.001 +- 0.001

Eval split test
suff_simple class all_L1  =  0.822 +- 0.023, 0.835 +- 0.020, 0.840 +- 0.018, 0.845 +- 0.018
suff_simple class all_KL  =  0.780 +- 0.020, 0.786 +- 0.022, 0.790 +- 0.021, 0.795 +- 0.021
suff_simple_acc_int  =  0.701 +- 0.077, 0.701 +- 0.079, 0.696 +- 0.081, 0.694 +- 0.083
nec class all_L1  =  0.251 +- 0.047, 0.638 +- 0.069, 0.627 +- 0.071, 0.611 +- 0.070
nec class all_KL  =  0.436 +- 0.065, 0.737 +- 0.087, 0.716 +- 0.088, 0.695 +- 0.088
nec_acc_int  =  0.616 +- 0.105, 0.087 +- 0.029, 0.090 +- 0.022, 0.107 +- 0.022


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.502 +- 0.018, 0.534 +- 0.037, 0.537 +- 0.037, 0.543 +- 0.039
Faith. Armon (L1)= 		  =  0.087 +- 0.055, 0.176 +- 0.108, 0.184 +- 0.108, 0.202 +- 0.112
Faith. GMean (L1)= 	  =  0.200 +- 0.067, 0.296 +- 0.100, 0.305 +- 0.101, 0.321 +- 0.104
Faith. Aritm (KL)= 		  =  0.526 +- 0.052, 0.585 +- 0.079, 0.593 +- 0.079, 0.599 +- 0.080
Faith. Armon (KL)= 		  =  0.243 +- 0.128, 0.378 +- 0.168, 0.394 +- 0.169, 0.408 +- 0.170
Faith. GMean (KL)= 	  =  0.349 +- 0.112, 0.464 +- 0.137, 0.477 +- 0.139, 0.488 +- 0.139

Eval split val
Faith. Aritm (L1)= 		  =  0.535 +- 0.014, 0.690 +- 0.071, 0.689 +- 0.071, 0.688 +- 0.070
Faith. Armon (L1)= 		  =  0.397 +- 0.046, 0.659 +- 0.096, 0.658 +- 0.095, 0.658 +- 0.095
Faith. GMean (L1)= 	  =  0.460 +- 0.026, 0.674 +- 0.083, 0.673 +- 0.083, 0.672 +- 0.083
Faith. Aritm (KL)= 		  =  0.581 +- 0.032, 0.701 +- 0.080, 0.699 +- 0.080, 0.698 +- 0.079
Faith. Armon (KL)= 		  =  0.508 +- 0.050, 0.675 +- 0.101, 0.674 +- 0.100, 0.672 +- 0.099
Faith. GMean (KL)= 	  =  0.543 +- 0.037, 0.688 +- 0.091, 0.686 +- 0.090, 0.685 +- 0.089

Eval split test
Faith. Aritm (L1)= 		  =  0.537 +- 0.026, 0.736 +- 0.043, 0.734 +- 0.044, 0.728 +- 0.043
Faith. Armon (L1)= 		  =  0.383 +- 0.055, 0.722 +- 0.052, 0.716 +- 0.054, 0.707 +- 0.053
Faith. GMean (L1)= 	  =  0.452 +- 0.043, 0.729 +- 0.048, 0.725 +- 0.049, 0.718 +- 0.048
Faith. Aritm (KL)= 		  =  0.608 +- 0.037, 0.761 +- 0.051, 0.753 +- 0.052, 0.745 +- 0.052
Faith. Armon (KL)= 		  =  0.557 +- 0.054, 0.758 +- 0.056, 0.749 +- 0.057, 0.740 +- 0.058
Faith. GMean (KL)= 	  =  0.582 +- 0.046, 0.760 +- 0.053, 0.751 +- 0.054, 0.742 +- 0.055
Computed for split load_split = id



Completed in  0:54:54.411696  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 01:59:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 01:59:15 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 01:59:15 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 01:59:15 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 01:59:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:59:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:59:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:59:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 01:59:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 01:59:15 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 01:59:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.088
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.029
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.029
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.029
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.103
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.045
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.040
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.037


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08793862815884478
len(reference) = 277
Effective ratio: 0.266 +- 0.168
Model Accuracy over intervened graphs for r=0.5 =  0.959
SUFF_SIMPLE for r=0.5 class 1.0 = 0.936 +- 0.337 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.5 all KL = 0.817 +- 0.337 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.5 all L1 = 0.936 +- 0.141 (in-sample avg dev_std = 0.317)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02931046931407942
len(reference) = 277
Effective ratio: 0.023 +- 0.029
Model Accuracy over intervened graphs for r=0.8 =  0.966
SUFF_SIMPLE for r=0.8 class 1.0 = 0.94 +- 0.334 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.8 all KL = 0.813 +- 0.334 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.8 all L1 = 0.94 +- 0.122 (in-sample avg dev_std = 0.316)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.029270758122743684
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.964
SUFF_SIMPLE for r=0.9 class 1.0 = 0.94 +- 0.330 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.9 all KL = 0.809 +- 0.330 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.9 all L1 = 0.94 +- 0.119 (in-sample avg dev_std = 0.317)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.029270758122743684
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  0.962
SUFF_SIMPLE for r=0.95 class 1.0 = 0.938 +- 0.334 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.95 all KL = 0.807 +- 0.334 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.95 all L1 = 0.938 +- 0.125 (in-sample avg dev_std = 0.317)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.458
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012482539682539684
len(reference) = 2520
Effective ratio: 0.316 +- 0.146
Model Accuracy over intervened graphs for r=0.5 =  0.394
SUFF_SIMPLE for r=0.5 class 1.0 = 0.795 +- 0.310 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.5 all KL = 0.724 +- 0.310 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.5 all L1 = 0.795 +- 0.227 (in-sample avg dev_std = 0.432)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004179761904761905
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.395
SUFF_SIMPLE for r=0.8 class 1.0 = 0.789 +- 0.316 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.8 all KL = 0.713 +- 0.316 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.8 all L1 = 0.789 +- 0.226 (in-sample avg dev_std = 0.449)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.458
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004336507936507937
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.396
SUFF_SIMPLE for r=0.9 class 1.0 = 0.793 +- 0.309 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.9 all KL = 0.722 +- 0.309 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.9 all L1 = 0.793 +- 0.226 (in-sample avg dev_std = 0.433)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.458
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004336507936507937
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.396
SUFF_SIMPLE for r=0.95 class 1.0 = 0.793 +- 0.309 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.95 all KL = 0.722 +- 0.309 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.95 all L1 = 0.793 +- 0.226 (in-sample avg dev_std = 0.433)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.778
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10253808752025932
len(reference) = 2453
Effective ratio: 0.450 +- 0.196
Model Accuracy over intervened graphs for r=0.5 =  0.698
SUFF_SIMPLE for r=0.5 class 1.0 = 0.844 +- 0.361 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.5 all KL = 0.731 +- 0.361 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.5 all L1 = 0.844 +- 0.234 (in-sample avg dev_std = 0.345)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.778
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0451114262560778
len(reference) = 2468
Effective ratio: 0.035 +- 0.072
Model Accuracy over intervened graphs for r=0.8 =  0.669
SUFF_SIMPLE for r=0.8 class 1.0 = 0.822 +- 0.379 (in-sample avg dev_std = 0.398)
SUFF_SIMPLE for r=0.8 all KL = 0.693 +- 0.379 (in-sample avg dev_std = 0.398)
SUFF_SIMPLE for r=0.8 all L1 = 0.822 +- 0.249 (in-sample avg dev_std = 0.398)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.778
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03955145867098865
len(reference) = 2468
Effective ratio: 0.028 +- 0.056
Model Accuracy over intervened graphs for r=0.9 =  0.671
SUFF_SIMPLE for r=0.9 class 1.0 = 0.825 +- 0.375 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.9 all KL = 0.7 +- 0.375 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.9 all L1 = 0.825 +- 0.246 (in-sample avg dev_std = 0.395)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.778
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03711831442463533
len(reference) = 2468
Effective ratio: 0.026 +- 0.049
Model Accuracy over intervened graphs for r=0.95 =  0.668
SUFF_SIMPLE for r=0.95 class 1.0 = 0.822 +- 0.377 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.95 all KL = 0.696 +- 0.377 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.95 all L1 = 0.822 +- 0.248 (in-sample avg dev_std = 0.400)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08793862815884478
len(reference) = 277
Effective ratio: 0.266 +- 0.168
Model Accuracy over intervened graphs for r=0.5 =  0.995
NEC for r=0.5 class 1.0 = 0.012 +- 0.167 (in-sample avg dev_std = 0.139)
NEC for r=0.5 all KL = 0.042 +- 0.167 (in-sample avg dev_std = 0.139)
NEC for r=0.5 all L1 = 0.012 +- 0.049 (in-sample avg dev_std = 0.139)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02931046931407942
len(reference) = 277
Effective ratio: 0.023 +- 0.029
Model Accuracy over intervened graphs for r=0.8 =  1.0
NEC for r=0.8 class 1.0 = 0.001 +- 0.040 (in-sample avg dev_std = 0.022)
NEC for r=0.8 all KL = 0.004 +- 0.040 (in-sample avg dev_std = 0.022)
NEC for r=0.8 all L1 = 0.001 +- 0.015 (in-sample avg dev_std = 0.022)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.029270758122743684
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  1.0
NEC for r=0.9 class 1.0 = 0.001 +- 0.040 (in-sample avg dev_std = 0.022)
NEC for r=0.9 all KL = 0.003 +- 0.040 (in-sample avg dev_std = 0.022)
NEC for r=0.9 all L1 = 0.001 +- 0.015 (in-sample avg dev_std = 0.022)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.029270758122743684
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  1.0
NEC for r=0.95 class 1.0 = 0.002 +- 0.046 (in-sample avg dev_std = 0.023)
NEC for r=0.95 all KL = 0.004 +- 0.046 (in-sample avg dev_std = 0.023)
NEC for r=0.95 all L1 = 0.002 +- 0.019 (in-sample avg dev_std = 0.023)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.458
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012482539682539684
len(reference) = 2520
Effective ratio: 0.316 +- 0.146
Model Accuracy over intervened graphs for r=0.5 =  0.434
NEC for r=0.5 class 1.0 = 0.13 +- 0.223 (in-sample avg dev_std = 0.317)
NEC for r=0.5 all KL = 0.139 +- 0.223 (in-sample avg dev_std = 0.317)
NEC for r=0.5 all L1 = 0.13 +- 0.177 (in-sample avg dev_std = 0.317)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004179761904761905
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.455
NEC for r=0.8 class 1.0 = 0.029 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.011 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.029 +- 0.085 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.458
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004336507936507937
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.455
NEC for r=0.9 class 1.0 = 0.028 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.011 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.028 +- 0.085 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.458
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004336507936507937
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.455
NEC for r=0.95 class 1.0 = 0.028 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.011 +- 0.066 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.028 +- 0.085 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.778
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10253808752025932
len(reference) = 2468
Effective ratio: 0.450 +- 0.196
Model Accuracy over intervened graphs for r=0.5 =  0.72
NEC for r=0.5 class 1.0 = 0.114 +- 0.333 (in-sample avg dev_std = 0.335)
NEC for r=0.5 all KL = 0.189 +- 0.333 (in-sample avg dev_std = 0.335)
NEC for r=0.5 all L1 = 0.114 +- 0.208 (in-sample avg dev_std = 0.335)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.778
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0451114262560778
len(reference) = 2468
Effective ratio: 0.035 +- 0.072
Model Accuracy over intervened graphs for r=0.8 =  0.765
NEC for r=0.8 class 1.0 = 0.048 +- 0.199 (in-sample avg dev_std = 0.032)
NEC for r=0.8 all KL = 0.051 +- 0.199 (in-sample avg dev_std = 0.032)
NEC for r=0.8 all L1 = 0.048 +- 0.168 (in-sample avg dev_std = 0.032)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.778
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03955145867098865
len(reference) = 2468
Effective ratio: 0.028 +- 0.056
Model Accuracy over intervened graphs for r=0.9 =  0.768
NEC for r=0.9 class 1.0 = 0.04 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.042 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.04 +- 0.154 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.778
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03711831442463533
len(reference) = 2468
Effective ratio: 0.026 +- 0.049
Model Accuracy over intervened graphs for r=0.95 =  0.769
NEC for r=0.95 class 1.0 = 0.04 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.042 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.04 +- 0.156 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 02:04:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 02:04:20 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 02:04:20 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 02:04:20 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 02:04:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:04:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:04:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:04:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:04:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:04:20 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 02:04:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 76 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.082
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.024
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.024
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.023
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.101
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.044
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.038
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.037


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08242960288808664
len(reference) = 277
Effective ratio: 0.296 +- 0.169
Model Accuracy over intervened graphs for r=0.5 =  0.977
SUFF_SIMPLE for r=0.5 class 1.0 = 0.956 +- 0.271 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.5 all KL = 0.868 +- 0.271 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.5 all L1 = 0.956 +- 0.100 (in-sample avg dev_std = 0.264)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02425992779783394
len(reference) = 277
Effective ratio: 0.026 +- 0.034
Model Accuracy over intervened graphs for r=0.8 =  0.972
SUFF_SIMPLE for r=0.8 class 1.0 = 0.945 +- 0.298 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.8 all KL = 0.837 +- 0.298 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.8 all L1 = 0.945 +- 0.109 (in-sample avg dev_std = 0.297)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.024220216606498198
len(reference) = 277
Effective ratio: 0.023 +- 0.029
Model Accuracy over intervened graphs for r=0.9 =  0.968
SUFF_SIMPLE for r=0.9 class 1.0 = 0.94 +- 0.307 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.9 all KL = 0.826 +- 0.307 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.9 all L1 = 0.94 +- 0.116 (in-sample avg dev_std = 0.312)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02327436823104693
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.95 =  0.974
SUFF_SIMPLE for r=0.95 class 1.0 = 0.951 +- 0.284 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.95 all KL = 0.854 +- 0.284 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.95 all L1 = 0.951 +- 0.109 (in-sample avg dev_std = 0.277)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.788
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012992063492063492
len(reference) = 2520
Effective ratio: 0.288 +- 0.095
Model Accuracy over intervened graphs for r=0.5 =  0.644
SUFF_SIMPLE for r=0.5 class 1.0 = 0.719 +- 0.290 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.5 all KL = 0.638 +- 0.290 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.5 all L1 = 0.719 +- 0.220 (in-sample avg dev_std = 0.512)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004023015873015873
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.642
SUFF_SIMPLE for r=0.8 class 1.0 = 0.72 +- 0.288 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.8 all KL = 0.636 +- 0.288 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.8 all L1 = 0.72 +- 0.216 (in-sample avg dev_std = 0.510)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.788
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.003926587301587302
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.647
SUFF_SIMPLE for r=0.9 class 1.0 = 0.722 +- 0.284 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.9 all KL = 0.638 +- 0.284 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.9 all L1 = 0.722 +- 0.216 (in-sample avg dev_std = 0.506)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.788
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.003926587301587302
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.647
SUFF_SIMPLE for r=0.95 class 1.0 = 0.722 +- 0.284 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.95 all KL = 0.638 +- 0.284 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.95 all L1 = 0.722 +- 0.216 (in-sample avg dev_std = 0.506)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.734
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10083022690437601
len(reference) = 2450
Effective ratio: 0.369 +- 0.188
Model Accuracy over intervened graphs for r=0.5 =  0.676
SUFF_SIMPLE for r=0.5 class 1.0 = 0.83 +- 0.340 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.5 all KL = 0.728 +- 0.340 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.5 all L1 = 0.83 +- 0.217 (in-sample avg dev_std = 0.394)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.735
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.044486223662884926
len(reference) = 2468
Effective ratio: 0.036 +- 0.070
Model Accuracy over intervened graphs for r=0.8 =  0.633
SUFF_SIMPLE for r=0.8 class 1.0 = 0.792 +- 0.371 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.8 all KL = 0.66 +- 0.371 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.8 all L1 = 0.792 +- 0.233 (in-sample avg dev_std = 0.457)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03843881685575364
len(reference) = 2468
Effective ratio: 0.027 +- 0.051
Model Accuracy over intervened graphs for r=0.9 =  0.631
SUFF_SIMPLE for r=0.9 class 1.0 = 0.795 +- 0.366 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.9 all KL = 0.671 +- 0.366 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.9 all L1 = 0.795 +- 0.235 (in-sample avg dev_std = 0.450)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.735
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.037037682333873584
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.95 =  0.634
SUFF_SIMPLE for r=0.95 class 1.0 = 0.792 +- 0.367 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.95 all KL = 0.662 +- 0.367 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.95 all L1 = 0.792 +- 0.232 (in-sample avg dev_std = 0.457)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08242960288808664
len(reference) = 277
Effective ratio: 0.296 +- 0.169
Model Accuracy over intervened graphs for r=0.5 =  0.994
NEC for r=0.5 class 1.0 = 0.012 +- 0.145 (in-sample avg dev_std = 0.137)
NEC for r=0.5 all KL = 0.036 +- 0.145 (in-sample avg dev_std = 0.137)
NEC for r=0.5 all L1 = 0.012 +- 0.056 (in-sample avg dev_std = 0.137)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02425992779783394
len(reference) = 277
Effective ratio: 0.026 +- 0.034
Model Accuracy over intervened graphs for r=0.8 =  0.996
NEC for r=0.8 class 1.0 = 0.004 +- 0.065 (in-sample avg dev_std = 0.013)
NEC for r=0.8 all KL = 0.006 +- 0.065 (in-sample avg dev_std = 0.013)
NEC for r=0.8 all L1 = 0.004 +- 0.052 (in-sample avg dev_std = 0.013)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.024220216606498198
len(reference) = 277
Effective ratio: 0.023 +- 0.029
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 1.0 = 0.004 +- 0.065 (in-sample avg dev_std = 0.013)
NEC for r=0.9 all KL = 0.006 +- 0.065 (in-sample avg dev_std = 0.013)
NEC for r=0.9 all L1 = 0.004 +- 0.052 (in-sample avg dev_std = 0.013)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02327436823104693
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.95 =  0.996
NEC for r=0.95 class 1.0 = 0.004 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.005 +- 0.061 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.004 +- 0.052 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.788
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012992063492063492
len(reference) = 2520
Effective ratio: 0.288 +- 0.095
Model Accuracy over intervened graphs for r=0.5 =  0.721
NEC for r=0.5 class 1.0 = 0.178 +- 0.236 (in-sample avg dev_std = 0.383)
NEC for r=0.5 all KL = 0.194 +- 0.236 (in-sample avg dev_std = 0.383)
NEC for r=0.5 all L1 = 0.178 +- 0.179 (in-sample avg dev_std = 0.383)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004023015873015873
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.777
NEC for r=0.8 class 1.0 = 0.041 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.016 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.041 +- 0.104 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.788
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.003926587301587302
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.777
NEC for r=0.9 class 1.0 = 0.041 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.016 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.041 +- 0.104 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.788
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.003926587301587302
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.777
NEC for r=0.95 class 1.0 = 0.041 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.016 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.041 +- 0.104 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.735
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10083022690437601
len(reference) = 2468
Effective ratio: 0.369 +- 0.188
Model Accuracy over intervened graphs for r=0.5 =  0.686
NEC for r=0.5 class 1.0 = 0.127 +- 0.328 (in-sample avg dev_std = 0.370)
NEC for r=0.5 all KL = 0.207 +- 0.328 (in-sample avg dev_std = 0.370)
NEC for r=0.5 all L1 = 0.127 +- 0.196 (in-sample avg dev_std = 0.370)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.735
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.044486223662884926
len(reference) = 2468
Effective ratio: 0.036 +- 0.070
Model Accuracy over intervened graphs for r=0.8 =  0.729
NEC for r=0.8 class 1.0 = 0.04 +- 0.181 (in-sample avg dev_std = 0.014)
NEC for r=0.8 all KL = 0.042 +- 0.181 (in-sample avg dev_std = 0.014)
NEC for r=0.8 all L1 = 0.04 +- 0.149 (in-sample avg dev_std = 0.014)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.735
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03843881685575364
len(reference) = 2468
Effective ratio: 0.027 +- 0.051
Model Accuracy over intervened graphs for r=0.9 =  0.73
NEC for r=0.9 class 1.0 = 0.034 +- 0.161 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.034 +- 0.161 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.034 +- 0.135 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.735
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.037037682333873584
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.95 =  0.73
NEC for r=0.95 class 1.0 = 0.034 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.033 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.034 +- 0.136 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 02:10:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 02:10:07 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 02:10:07 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 02:10:07 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 02:10:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:10:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:10:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:10:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:10:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:10:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 02:10:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.086
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.039
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.039
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.040
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.044
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.038
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.036


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08564620938628159
len(reference) = 277
Effective ratio: 0.226 +- 0.133
Model Accuracy over intervened graphs for r=0.5 =  0.978
SUFF_SIMPLE for r=0.5 class 1.0 = 0.963 +- 0.265 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.5 all KL = 0.892 +- 0.265 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.5 all L1 = 0.963 +- 0.106 (in-sample avg dev_std = 0.229)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.038844765342960295
len(reference) = 277
Effective ratio: 0.023 +- 0.026
Model Accuracy over intervened graphs for r=0.8 =  0.978
SUFF_SIMPLE for r=0.8 class 1.0 = 0.962 +- 0.273 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.8 all KL = 0.89 +- 0.273 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.8 all L1 = 0.962 +- 0.107 (in-sample avg dev_std = 0.256)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03942960288808664
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.972
SUFF_SIMPLE for r=0.9 class 1.0 = 0.953 +- 0.305 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.9 all KL = 0.857 +- 0.305 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.9 all L1 = 0.953 +- 0.114 (in-sample avg dev_std = 0.291)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03974007220216606
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.95 =  0.975
SUFF_SIMPLE for r=0.95 class 1.0 = 0.958 +- 0.285 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.95 all KL = 0.88 +- 0.285 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.95 all L1 = 0.958 +- 0.114 (in-sample avg dev_std = 0.276)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.874
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012588888888888889
len(reference) = 2520
Effective ratio: 0.204 +- 0.118
Model Accuracy over intervened graphs for r=0.5 =  0.739
SUFF_SIMPLE for r=0.5 class 1.0 = 0.789 +- 0.387 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.5 all KL = 0.597 +- 0.387 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.5 all L1 = 0.789 +- 0.239 (in-sample avg dev_std = 0.485)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.737
SUFF_SIMPLE for r=0.8 class 1.0 = 0.787 +- 0.386 (in-sample avg dev_std = 0.490)
SUFF_SIMPLE for r=0.8 all KL = 0.588 +- 0.386 (in-sample avg dev_std = 0.490)
SUFF_SIMPLE for r=0.8 all L1 = 0.787 +- 0.238 (in-sample avg dev_std = 0.490)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.737
SUFF_SIMPLE for r=0.9 class 1.0 = 0.787 +- 0.387 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.9 all KL = 0.597 +- 0.387 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.9 all L1 = 0.787 +- 0.241 (in-sample avg dev_std = 0.485)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.874
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.737
SUFF_SIMPLE for r=0.95 class 1.0 = 0.787 +- 0.387 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.95 all KL = 0.597 +- 0.387 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.95 all L1 = 0.787 +- 0.241 (in-sample avg dev_std = 0.485)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.742
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10006361426256079
len(reference) = 2448
Effective ratio: 0.433 +- 0.174
Model Accuracy over intervened graphs for r=0.5 =  0.667
SUFF_SIMPLE for r=0.5 class 1.0 = 0.821 +- 0.347 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.5 all KL = 0.734 +- 0.347 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.5 all L1 = 0.821 +- 0.227 (in-sample avg dev_std = 0.375)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.741
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.044401539708265804
len(reference) = 2468
Effective ratio: 0.035 +- 0.067
Model Accuracy over intervened graphs for r=0.8 =  0.65
SUFF_SIMPLE for r=0.8 class 1.0 = 0.808 +- 0.358 (in-sample avg dev_std = 0.401)
SUFF_SIMPLE for r=0.8 all KL = 0.719 +- 0.358 (in-sample avg dev_std = 0.401)
SUFF_SIMPLE for r=0.8 all L1 = 0.808 +- 0.242 (in-sample avg dev_std = 0.401)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03819448946515397
len(reference) = 2468
Effective ratio: 0.028 +- 0.055
Model Accuracy over intervened graphs for r=0.9 =  0.644
SUFF_SIMPLE for r=0.9 class 1.0 = 0.802 +- 0.359 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.9 all KL = 0.705 +- 0.359 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.9 all L1 = 0.802 +- 0.239 (in-sample avg dev_std = 0.416)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.741
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.036159643435980555
len(reference) = 2468
Effective ratio: 0.026 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.641
SUFF_SIMPLE for r=0.95 class 1.0 = 0.799 +- 0.360 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.95 all KL = 0.702 +- 0.360 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.95 all L1 = 0.799 +- 0.242 (in-sample avg dev_std = 0.416)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08564620938628159
len(reference) = 277
Effective ratio: 0.226 +- 0.133
Model Accuracy over intervened graphs for r=0.5 =  0.993
NEC for r=0.5 class 1.0 = 0.011 +- 0.150 (in-sample avg dev_std = 0.143)
NEC for r=0.5 all KL = 0.031 +- 0.150 (in-sample avg dev_std = 0.143)
NEC for r=0.5 all L1 = 0.011 +- 0.060 (in-sample avg dev_std = 0.143)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.038844765342960295
len(reference) = 277
Effective ratio: 0.023 +- 0.026
Model Accuracy over intervened graphs for r=0.8 =  0.989
NEC for r=0.8 class 1.0 = 0.012 +- 0.119 (in-sample avg dev_std = 0.010)
NEC for r=0.8 all KL = 0.017 +- 0.119 (in-sample avg dev_std = 0.010)
NEC for r=0.8 all L1 = 0.012 +- 0.093 (in-sample avg dev_std = 0.010)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03942960288808664
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.989
NEC for r=0.9 class 1.0 = 0.013 +- 0.122 (in-sample avg dev_std = 0.010)
NEC for r=0.9 all KL = 0.018 +- 0.122 (in-sample avg dev_std = 0.010)
NEC for r=0.9 all L1 = 0.013 +- 0.094 (in-sample avg dev_std = 0.010)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03974007220216606
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.95 =  0.989
NEC for r=0.95 class 1.0 = 0.012 +- 0.121 (in-sample avg dev_std = 0.011)
NEC for r=0.95 all KL = 0.018 +- 0.121 (in-sample avg dev_std = 0.011)
NEC for r=0.95 all L1 = 0.012 +- 0.093 (in-sample avg dev_std = 0.011)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.874
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012588888888888889
len(reference) = 2520
Effective ratio: 0.204 +- 0.118
Model Accuracy over intervened graphs for r=0.5 =  0.812
NEC for r=0.5 class 1.0 = 0.117 +- 0.295 (in-sample avg dev_std = 0.345)
NEC for r=0.5 all KL = 0.186 +- 0.295 (in-sample avg dev_std = 0.345)
NEC for r=0.5 all L1 = 0.117 +- 0.186 (in-sample avg dev_std = 0.345)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.864
NEC for r=0.8 class 1.0 = 0.026 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.016 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.026 +- 0.097 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.864
NEC for r=0.9 class 1.0 = 0.025 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.016 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.025 +- 0.096 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.874
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0037079365079365077
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.864
NEC for r=0.95 class 1.0 = 0.025 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.016 +- 0.095 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.025 +- 0.096 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.741
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.10006361426256079
len(reference) = 2468
Effective ratio: 0.433 +- 0.174
Model Accuracy over intervened graphs for r=0.5 =  0.688
NEC for r=0.5 class 1.0 = 0.129 +- 0.322 (in-sample avg dev_std = 0.335)
NEC for r=0.5 all KL = 0.183 +- 0.322 (in-sample avg dev_std = 0.335)
NEC for r=0.5 all L1 = 0.129 +- 0.210 (in-sample avg dev_std = 0.335)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.741
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.044401539708265804
len(reference) = 2468
Effective ratio: 0.035 +- 0.067
Model Accuracy over intervened graphs for r=0.8 =  0.722
NEC for r=0.8 class 1.0 = 0.05 +- 0.191 (in-sample avg dev_std = 0.025)
NEC for r=0.8 all KL = 0.048 +- 0.191 (in-sample avg dev_std = 0.025)
NEC for r=0.8 all L1 = 0.05 +- 0.162 (in-sample avg dev_std = 0.025)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03819448946515397
len(reference) = 2468
Effective ratio: 0.028 +- 0.055
Model Accuracy over intervened graphs for r=0.9 =  0.724
NEC for r=0.9 class 1.0 = 0.042 +- 0.178 (in-sample avg dev_std = 0.008)
NEC for r=0.9 all KL = 0.041 +- 0.178 (in-sample avg dev_std = 0.008)
NEC for r=0.9 all L1 = 0.042 +- 0.150 (in-sample avg dev_std = 0.008)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.741
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.036159643435980555
len(reference) = 2468
Effective ratio: 0.026 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.725
NEC for r=0.95 class 1.0 = 0.041 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.04 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.041 +- 0.149 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 02:15:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 02:15:58 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 02:15:58 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 02:15:58 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 02:15:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:15:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:15:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:15:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:15:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:15:58 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 02:15:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.085
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.028
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.025
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.025
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.049
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.039
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.038


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08533574007220215
len(reference) = 277
Effective ratio: 0.284 +- 0.166
Model Accuracy over intervened graphs for r=0.5 =  0.964
SUFF_SIMPLE for r=0.5 class 1.0 = 0.937 +- 0.312 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.5 all KL = 0.816 +- 0.312 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.5 all L1 = 0.937 +- 0.130 (in-sample avg dev_std = 0.297)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.027989169675090252
len(reference) = 277
Effective ratio: 0.026 +- 0.042
Model Accuracy over intervened graphs for r=0.8 =  0.969
SUFF_SIMPLE for r=0.8 class 1.0 = 0.942 +- 0.308 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.8 all KL = 0.824 +- 0.308 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.8 all L1 = 0.942 +- 0.118 (in-sample avg dev_std = 0.294)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.024624548736462092
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.969
SUFF_SIMPLE for r=0.9 class 1.0 = 0.944 +- 0.302 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.9 all KL = 0.835 +- 0.302 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.9 all L1 = 0.944 +- 0.121 (in-sample avg dev_std = 0.289)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.025379061371841153
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  0.965
SUFF_SIMPLE for r=0.95 class 1.0 = 0.936 +- 0.314 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.95 all KL = 0.815 +- 0.314 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.95 all L1 = 0.936 +- 0.131 (in-sample avg dev_std = 0.302)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.775
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012614682539682542
len(reference) = 2520
Effective ratio: 0.158 +- 0.057
Model Accuracy over intervened graphs for r=0.5 =  0.479
SUFF_SIMPLE for r=0.5 class 1.0 = 0.599 +- 0.345 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.5 all KL = 0.425 +- 0.345 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.5 all L1 = 0.599 +- 0.250 (in-sample avg dev_std = 0.600)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.003830555555555555
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.479
SUFF_SIMPLE for r=0.8 class 1.0 = 0.598 +- 0.342 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.8 all KL = 0.419 +- 0.342 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.8 all L1 = 0.598 +- 0.248 (in-sample avg dev_std = 0.600)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0036873015873015867
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.477
SUFF_SIMPLE for r=0.9 class 1.0 = 0.6 +- 0.343 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.9 all KL = 0.426 +- 0.343 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.9 all L1 = 0.6 +- 0.251 (in-sample avg dev_std = 0.599)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.775
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0036873015873015867
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.477
SUFF_SIMPLE for r=0.95 class 1.0 = 0.598 +- 0.344 (in-sample avg dev_std = 0.603)
SUFF_SIMPLE for r=0.95 all KL = 0.422 +- 0.344 (in-sample avg dev_std = 0.603)
SUFF_SIMPLE for r=0.95 all L1 = 0.598 +- 0.250 (in-sample avg dev_std = 0.603)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.845
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09989019448946516
len(reference) = 2466
Effective ratio: 0.309 +- 0.216
Model Accuracy over intervened graphs for r=0.5 =  0.701
SUFF_SIMPLE for r=0.5 class 1.0 = 0.787 +- 0.372 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.5 all KL = 0.641 +- 0.372 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.5 all L1 = 0.787 +- 0.244 (in-sample avg dev_std = 0.450)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.845
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04850283630470016
len(reference) = 2468
Effective ratio: 0.038 +- 0.072
Model Accuracy over intervened graphs for r=0.8 =  0.686
SUFF_SIMPLE for r=0.8 class 1.0 = 0.774 +- 0.383 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.8 all KL = 0.622 +- 0.383 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.8 all L1 = 0.774 +- 0.256 (in-sample avg dev_std = 0.469)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03907779578606159
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.686
SUFF_SIMPLE for r=0.9 class 1.0 = 0.777 +- 0.378 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.9 all KL = 0.624 +- 0.378 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.9 all L1 = 0.777 +- 0.252 (in-sample avg dev_std = 0.470)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.845
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03779659643435981
len(reference) = 2468
Effective ratio: 0.025 +- 0.044
Model Accuracy over intervened graphs for r=0.95 =  0.685
SUFF_SIMPLE for r=0.95 class 1.0 = 0.774 +- 0.382 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.95 all KL = 0.615 +- 0.382 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.95 all L1 = 0.774 +- 0.253 (in-sample avg dev_std = 0.474)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08533574007220215
len(reference) = 277
Effective ratio: 0.284 +- 0.166
Model Accuracy over intervened graphs for r=0.5 =  0.996
NEC for r=0.5 class 1.0 = 0.011 +- 0.120 (in-sample avg dev_std = 0.108)
NEC for r=0.5 all KL = 0.032 +- 0.120 (in-sample avg dev_std = 0.108)
NEC for r=0.5 all L1 = 0.011 +- 0.052 (in-sample avg dev_std = 0.108)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.027989169675090252
len(reference) = 277
Effective ratio: 0.026 +- 0.042
Model Accuracy over intervened graphs for r=0.8 =  1.0
NEC for r=0.8 class 1.0 = 0.004 +- 0.069 (in-sample avg dev_std = 0.011)
NEC for r=0.8 all KL = 0.012 +- 0.069 (in-sample avg dev_std = 0.011)
NEC for r=0.8 all L1 = 0.004 +- 0.024 (in-sample avg dev_std = 0.011)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.024624548736462092
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  1.0
NEC for r=0.9 class 1.0 = 0.005 +- 0.073 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.013 +- 0.073 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.005 +- 0.028 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.025379061371841153
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  1.0
NEC for r=0.95 class 1.0 = 0.005 +- 0.073 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.013 +- 0.073 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.005 +- 0.028 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.775
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012614682539682542
len(reference) = 2520
Effective ratio: 0.158 +- 0.057
Model Accuracy over intervened graphs for r=0.5 =  0.645
NEC for r=0.5 class 1.0 = 0.223 +- 0.297 (in-sample avg dev_std = 0.439)
NEC for r=0.5 all KL = 0.281 +- 0.297 (in-sample avg dev_std = 0.439)
NEC for r=0.5 all L1 = 0.223 +- 0.216 (in-sample avg dev_std = 0.439)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.003830555555555555
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.752
NEC for r=0.8 class 1.0 = 0.045 +- 0.102 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.022 +- 0.102 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.045 +- 0.120 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0036873015873015867
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.753
NEC for r=0.9 class 1.0 = 0.043 +- 0.098 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.021 +- 0.098 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.043 +- 0.117 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.775
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0036873015873015867
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.753
NEC for r=0.95 class 1.0 = 0.043 +- 0.098 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.021 +- 0.098 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.043 +- 0.117 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.845
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09989019448946516
len(reference) = 2468
Effective ratio: 0.309 +- 0.216
Model Accuracy over intervened graphs for r=0.5 =  0.753
NEC for r=0.5 class 1.0 = 0.142 +- 0.352 (in-sample avg dev_std = 0.371)
NEC for r=0.5 all KL = 0.238 +- 0.352 (in-sample avg dev_std = 0.371)
NEC for r=0.5 all L1 = 0.142 +- 0.223 (in-sample avg dev_std = 0.371)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.845
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04850283630470016
len(reference) = 2468
Effective ratio: 0.038 +- 0.072
Model Accuracy over intervened graphs for r=0.8 =  0.806
NEC for r=0.8 class 1.0 = 0.057 +- 0.225 (in-sample avg dev_std = 0.029)
NEC for r=0.8 all KL = 0.067 +- 0.225 (in-sample avg dev_std = 0.029)
NEC for r=0.8 all L1 = 0.057 +- 0.183 (in-sample avg dev_std = 0.029)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03907779578606159
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.819
NEC for r=0.9 class 1.0 = 0.044 +- 0.195 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.051 +- 0.195 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.044 +- 0.158 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.845
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03779659643435981
len(reference) = 2468
Effective ratio: 0.025 +- 0.044
Model Accuracy over intervened graphs for r=0.95 =  0.82
NEC for r=0.95 class 1.0 = 0.043 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.049 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.043 +- 0.156 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 02:20:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 02:20:47 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 02:20:47 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 02:20:47 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 02:20:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:20:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:20:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:20:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:20:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:20:47 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 02:20:47 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.024
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.025
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.025
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.098
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.043
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.037
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.036


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07673646209386281
len(reference) = 277
Effective ratio: 0.187 +- 0.136
Model Accuracy over intervened graphs for r=0.5 =  0.978
SUFF_SIMPLE for r=0.5 class 1.0 = 0.962 +- 0.252 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.5 all KL = 0.892 +- 0.252 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.5 all L1 = 0.962 +- 0.104 (in-sample avg dev_std = 0.246)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.024451263537906137
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.8 =  0.978
SUFF_SIMPLE for r=0.8 class 1.0 = 0.962 +- 0.253 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.8 all KL = 0.893 +- 0.253 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.8 all L1 = 0.962 +- 0.104 (in-sample avg dev_std = 0.247)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02471480144404332
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.9 =  0.977
SUFF_SIMPLE for r=0.9 class 1.0 = 0.956 +- 0.277 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.9 all KL = 0.866 +- 0.277 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.9 all L1 = 0.956 +- 0.100 (in-sample avg dev_std = 0.276)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02471480144404332
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.95 =  0.976
SUFF_SIMPLE for r=0.95 class 1.0 = 0.959 +- 0.260 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.95 all KL = 0.887 +- 0.260 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.95 all L1 = 0.959 +- 0.109 (in-sample avg dev_std = 0.266)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.497
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012023412698412698
len(reference) = 2519
Effective ratio: 0.207 +- 0.130
Model Accuracy over intervened graphs for r=0.5 =  0.483
SUFF_SIMPLE for r=0.5 class 1.0 = 0.784 +- 0.276 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.5 all KL = 0.74 +- 0.276 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.5 all L1 = 0.784 +- 0.220 (in-sample avg dev_std = 0.422)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004024603174603175
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.483
SUFF_SIMPLE for r=0.8 class 1.0 = 0.777 +- 0.284 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.8 all KL = 0.727 +- 0.284 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.8 all L1 = 0.777 +- 0.222 (in-sample avg dev_std = 0.435)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.497
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004051587301587301
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.483
SUFF_SIMPLE for r=0.9 class 1.0 = 0.779 +- 0.281 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.9 all KL = 0.732 +- 0.281 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.9 all L1 = 0.779 +- 0.223 (in-sample avg dev_std = 0.432)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.497
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004051587301587301
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.483
SUFF_SIMPLE for r=0.95 class 1.0 = 0.78 +- 0.280 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.95 all KL = 0.735 +- 0.280 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.95 all L1 = 0.78 +- 0.223 (in-sample avg dev_std = 0.425)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.754
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09792463533225283
len(reference) = 2428
Effective ratio: 0.385 +- 0.265
Model Accuracy over intervened graphs for r=0.5 =  0.692
SUFF_SIMPLE for r=0.5 class 1.0 = 0.837 +- 0.340 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.5 all KL = 0.754 +- 0.340 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.5 all L1 = 0.837 +- 0.227 (in-sample avg dev_std = 0.364)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.745
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04330794165316046
len(reference) = 2468
Effective ratio: 0.033 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.686
SUFF_SIMPLE for r=0.8 class 1.0 = 0.809 +- 0.362 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.8 all KL = 0.702 +- 0.362 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.8 all L1 = 0.809 +- 0.236 (in-sample avg dev_std = 0.437)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.037397487844408425
len(reference) = 2468
Effective ratio: 0.026 +- 0.051
Model Accuracy over intervened graphs for r=0.9 =  0.689
SUFF_SIMPLE for r=0.9 class 1.0 = 0.803 +- 0.367 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.9 all KL = 0.688 +- 0.367 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.9 all L1 = 0.803 +- 0.236 (in-sample avg dev_std = 0.449)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.745
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03567544570502431
len(reference) = 2468
Effective ratio: 0.025 +- 0.045
Model Accuracy over intervened graphs for r=0.95 =  0.69
SUFF_SIMPLE for r=0.95 class 1.0 = 0.799 +- 0.370 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.95 all KL = 0.671 +- 0.370 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.95 all L1 = 0.799 +- 0.231 (in-sample avg dev_std = 0.464)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07673646209386281
len(reference) = 277
Effective ratio: 0.187 +- 0.136
Model Accuracy over intervened graphs for r=0.5 =  0.994
NEC for r=0.5 class 1.0 = 0.011 +- 0.144 (in-sample avg dev_std = 0.139)
NEC for r=0.5 all KL = 0.034 +- 0.144 (in-sample avg dev_std = 0.139)
NEC for r=0.5 all L1 = 0.011 +- 0.048 (in-sample avg dev_std = 0.139)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.024451263537906137
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.8 =  0.996
NEC for r=0.8 class 1.0 = 0.005 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.008 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.005 +- 0.058 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02471480144404332
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 1.0 = 0.005 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.008 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.005 +- 0.058 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02471480144404332
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.95 =  0.996
NEC for r=0.95 class 1.0 = 0.005 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.008 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.005 +- 0.058 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.497
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012023412698412698
len(reference) = 2520
Effective ratio: 0.207 +- 0.130
Model Accuracy over intervened graphs for r=0.5 =  0.493
NEC for r=0.5 class 1.0 = 0.141 +- 0.205 (in-sample avg dev_std = 0.301)
NEC for r=0.5 all KL = 0.13 +- 0.205 (in-sample avg dev_std = 0.301)
NEC for r=0.5 all L1 = 0.141 +- 0.179 (in-sample avg dev_std = 0.301)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004024603174603175
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.493
NEC for r=0.8 class 1.0 = 0.034 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.013 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.034 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.497
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004051587301587301
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.493
NEC for r=0.9 class 1.0 = 0.034 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.012 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.034 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.497
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004051587301587301
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.493
NEC for r=0.95 class 1.0 = 0.034 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.012 +- 0.074 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.034 +- 0.091 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.745
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09792463533225283
len(reference) = 2468
Effective ratio: 0.385 +- 0.265
Model Accuracy over intervened graphs for r=0.5 =  0.706
NEC for r=0.5 class 1.0 = 0.126 +- 0.328 (in-sample avg dev_std = 0.355)
NEC for r=0.5 all KL = 0.184 +- 0.328 (in-sample avg dev_std = 0.355)
NEC for r=0.5 all L1 = 0.126 +- 0.212 (in-sample avg dev_std = 0.355)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.745
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04330794165316046
len(reference) = 2468
Effective ratio: 0.033 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.738
NEC for r=0.8 class 1.0 = 0.043 +- 0.181 (in-sample avg dev_std = 0.026)
NEC for r=0.8 all KL = 0.043 +- 0.181 (in-sample avg dev_std = 0.026)
NEC for r=0.8 all L1 = 0.043 +- 0.155 (in-sample avg dev_std = 0.026)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.037397487844408425
len(reference) = 2468
Effective ratio: 0.026 +- 0.051
Model Accuracy over intervened graphs for r=0.9 =  0.736
NEC for r=0.9 class 1.0 = 0.04 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.04 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.04 +- 0.148 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.745
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03567544570502431
len(reference) = 2468
Effective ratio: 0.025 +- 0.045
Model Accuracy over intervened graphs for r=0.95 =  0.735
NEC for r=0.95 class 1.0 = 0.038 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.038 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.038 +- 0.145 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 02:25:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 02:25:59 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 02:25:59 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 02:25:59 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 02:25:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:25:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:25:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:25:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:25:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:25:59 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 02:25:59 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.079
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.029
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.021
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.021
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.003
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.003
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.003
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.099
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.043
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.034
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.031


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07925270758122743
len(reference) = 277
Effective ratio: 0.262 +- 0.148
Model Accuracy over intervened graphs for r=0.5 =  0.957
SUFF_SIMPLE for r=0.5 class 1.0 = 0.919 +- 0.320 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.5 all KL = 0.77 +- 0.320 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.5 all L1 = 0.919 +- 0.140 (in-sample avg dev_std = 0.327)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02926714801444043
len(reference) = 277
Effective ratio: 0.025 +- 0.034
Model Accuracy over intervened graphs for r=0.8 =  0.959
SUFF_SIMPLE for r=0.8 class 1.0 = 0.923 +- 0.313 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.8 all KL = 0.778 +- 0.313 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.8 all L1 = 0.923 +- 0.131 (in-sample avg dev_std = 0.333)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.021375451263537903
len(reference) = 277
Effective ratio: 0.022 +- 0.024
Model Accuracy over intervened graphs for r=0.9 =  0.949
SUFF_SIMPLE for r=0.9 class 1.0 = 0.907 +- 0.341 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.9 all KL = 0.731 +- 0.341 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.9 all L1 = 0.907 +- 0.139 (in-sample avg dev_std = 0.382)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.020916967509025268
len(reference) = 277
Effective ratio: 0.020 +- 0.018
Model Accuracy over intervened graphs for r=0.95 =  0.949
SUFF_SIMPLE for r=0.95 class 1.0 = 0.907 +- 0.333 (in-sample avg dev_std = 0.378)
SUFF_SIMPLE for r=0.95 all KL = 0.728 +- 0.333 (in-sample avg dev_std = 0.378)
SUFF_SIMPLE for r=0.95 all L1 = 0.907 +- 0.134 (in-sample avg dev_std = 0.378)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.362
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012303968253968255
len(reference) = 2519
Effective ratio: 0.282 +- 0.182
Model Accuracy over intervened graphs for r=0.5 =  0.258
SUFF_SIMPLE for r=0.5 class 1.0 = 0.786 +- 0.297 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.5 all KL = 0.754 +- 0.297 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.5 all L1 = 0.786 +- 0.233 (in-sample avg dev_std = 0.421)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0033551587301587304
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.261
SUFF_SIMPLE for r=0.8 class 1.0 = 0.787 +- 0.293 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.8 all KL = 0.756 +- 0.293 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.8 all L1 = 0.787 +- 0.230 (in-sample avg dev_std = 0.418)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.362
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0029444444444444444
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.258
SUFF_SIMPLE for r=0.9 class 1.0 = 0.787 +- 0.295 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.9 all KL = 0.757 +- 0.295 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.9 all L1 = 0.787 +- 0.231 (in-sample avg dev_std = 0.418)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.362
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0029444444444444444
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.258
SUFF_SIMPLE for r=0.95 class 1.0 = 0.787 +- 0.295 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.95 all KL = 0.757 +- 0.295 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.95 all L1 = 0.787 +- 0.231 (in-sample avg dev_std = 0.418)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.562
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0994967585089141
len(reference) = 2457
Effective ratio: 0.526 +- 0.189
Model Accuracy over intervened graphs for r=0.5 =  0.448
SUFF_SIMPLE for r=0.5 class 1.0 = 0.768 +- 0.366 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.5 all KL = 0.675 +- 0.366 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.5 all L1 = 0.768 +- 0.249 (in-sample avg dev_std = 0.446)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04309805510534846
len(reference) = 2468
Effective ratio: 0.039 +- 0.074
Model Accuracy over intervened graphs for r=0.8 =  0.421
SUFF_SIMPLE for r=0.8 class 1.0 = 0.739 +- 0.375 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.8 all KL = 0.628 +- 0.375 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.8 all L1 = 0.739 +- 0.257 (in-sample avg dev_std = 0.496)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.562
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.033601296596434356
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.419
SUFF_SIMPLE for r=0.9 class 1.0 = 0.738 +- 0.376 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.9 all KL = 0.623 +- 0.376 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.9 all L1 = 0.738 +- 0.255 (in-sample avg dev_std = 0.506)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.562
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03141247974068071
len(reference) = 2468
Effective ratio: 0.024 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.421
SUFF_SIMPLE for r=0.95 class 1.0 = 0.74 +- 0.375 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.95 all KL = 0.625 +- 0.375 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.95 all L1 = 0.74 +- 0.254 (in-sample avg dev_std = 0.500)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.07925270758122743
len(reference) = 277
Effective ratio: 0.262 +- 0.148
Model Accuracy over intervened graphs for r=0.5 =  0.993
NEC for r=0.5 class 1.0 = 0.016 +- 0.149 (in-sample avg dev_std = 0.139)
NEC for r=0.5 all KL = 0.053 +- 0.149 (in-sample avg dev_std = 0.139)
NEC for r=0.5 all L1 = 0.016 +- 0.048 (in-sample avg dev_std = 0.139)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02926714801444043
len(reference) = 277
Effective ratio: 0.025 +- 0.034
Model Accuracy over intervened graphs for r=0.8 =  0.995
NEC for r=0.8 class 1.0 = 0.01 +- 0.108 (in-sample avg dev_std = 0.016)
NEC for r=0.8 all KL = 0.019 +- 0.108 (in-sample avg dev_std = 0.016)
NEC for r=0.8 all L1 = 0.01 +- 0.069 (in-sample avg dev_std = 0.016)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.021375451263537903
len(reference) = 277
Effective ratio: 0.022 +- 0.024
Model Accuracy over intervened graphs for r=0.9 =  0.993
NEC for r=0.9 class 1.0 = 0.009 +- 0.102 (in-sample avg dev_std = 0.001)
NEC for r=0.9 all KL = 0.016 +- 0.102 (in-sample avg dev_std = 0.001)
NEC for r=0.9 all L1 = 0.009 +- 0.070 (in-sample avg dev_std = 0.001)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.020916967509025268
len(reference) = 277
Effective ratio: 0.020 +- 0.018
Model Accuracy over intervened graphs for r=0.95 =  0.993
NEC for r=0.95 class 1.0 = 0.009 +- 0.102 (in-sample avg dev_std = 0.001)
NEC for r=0.95 all KL = 0.015 +- 0.102 (in-sample avg dev_std = 0.001)
NEC for r=0.95 all L1 = 0.009 +- 0.070 (in-sample avg dev_std = 0.001)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.362
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012303968253968255
len(reference) = 2520
Effective ratio: 0.282 +- 0.182
Model Accuracy over intervened graphs for r=0.5 =  0.319
NEC for r=0.5 class 1.0 = 0.129 +- 0.209 (in-sample avg dev_std = 0.301)
NEC for r=0.5 all KL = 0.114 +- 0.209 (in-sample avg dev_std = 0.301)
NEC for r=0.5 all L1 = 0.129 +- 0.177 (in-sample avg dev_std = 0.301)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0033551587301587304
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.358
NEC for r=0.8 class 1.0 = 0.031 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.01 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.031 +- 0.086 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.362
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0029444444444444444
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.359
NEC for r=0.9 class 1.0 = 0.03 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.01 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.03 +- 0.086 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.362
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0029444444444444444
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.359
NEC for r=0.95 class 1.0 = 0.03 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.01 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.03 +- 0.086 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.562
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.0994967585089141
len(reference) = 2468
Effective ratio: 0.526 +- 0.189
Model Accuracy over intervened graphs for r=0.5 =  0.487
NEC for r=0.5 class 1.0 = 0.164 +- 0.342 (in-sample avg dev_std = 0.392)
NEC for r=0.5 all KL = 0.234 +- 0.342 (in-sample avg dev_std = 0.392)
NEC for r=0.5 all L1 = 0.164 +- 0.224 (in-sample avg dev_std = 0.392)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04309805510534846
len(reference) = 2468
Effective ratio: 0.039 +- 0.074
Model Accuracy over intervened graphs for r=0.8 =  0.535
NEC for r=0.8 class 1.0 = 0.061 +- 0.211 (in-sample avg dev_std = 0.013)
NEC for r=0.8 all KL = 0.06 +- 0.211 (in-sample avg dev_std = 0.013)
NEC for r=0.8 all L1 = 0.061 +- 0.180 (in-sample avg dev_std = 0.013)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.562
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.033601296596434356
len(reference) = 2468
Effective ratio: 0.026 +- 0.047
Model Accuracy over intervened graphs for r=0.9 =  0.548
NEC for r=0.9 class 1.0 = 0.046 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.044 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.562
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03141247974068071
len(reference) = 2468
Effective ratio: 0.024 +- 0.042
Model Accuracy over intervened graphs for r=0.95 =  0.548
NEC for r=0.95 class 1.0 = 0.045 +- 0.173 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.042 +- 0.173 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.045 +- 0.149 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 02:31:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 02:31:52 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 02:31:52 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 02:31:52 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 02:31:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:31:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:31:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:31:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:31:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:31:52 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 02:31:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.081
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.028
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.029
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.029
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.005
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.005
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.005
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.042
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.038
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.037


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08138989169675091
len(reference) = 277
Effective ratio: 0.247 +- 0.131
Model Accuracy over intervened graphs for r=0.5 =  0.959
SUFF_SIMPLE for r=0.5 class 1.0 = 0.937 +- 0.333 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.5 all KL = 0.822 +- 0.333 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.5 all L1 = 0.937 +- 0.143 (in-sample avg dev_std = 0.322)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.028498194945848376
len(reference) = 277
Effective ratio: 0.022 +- 0.026
Model Accuracy over intervened graphs for r=0.8 =  0.972
SUFF_SIMPLE for r=0.8 class 1.0 = 0.949 +- 0.309 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.8 all KL = 0.836 +- 0.309 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.8 all L1 = 0.949 +- 0.114 (in-sample avg dev_std = 0.299)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02885559566787004
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.97
SUFF_SIMPLE for r=0.9 class 1.0 = 0.947 +- 0.321 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.9 all KL = 0.825 +- 0.321 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.9 all L1 = 0.947 +- 0.110 (in-sample avg dev_std = 0.306)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02885559566787004
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.95 =  0.97
SUFF_SIMPLE for r=0.95 class 1.0 = 0.947 +- 0.321 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.95 all KL = 0.825 +- 0.321 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.95 all L1 = 0.947 +- 0.110 (in-sample avg dev_std = 0.306)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.637
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012407539682539683
len(reference) = 2520
Effective ratio: 0.193 +- 0.126
Model Accuracy over intervened graphs for r=0.5 =  0.609
SUFF_SIMPLE for r=0.5 class 1.0 = 0.802 +- 0.277 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.5 all KL = 0.743 +- 0.277 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.5 all L1 = 0.802 +- 0.196 (in-sample avg dev_std = 0.425)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004638095238095238
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.611
SUFF_SIMPLE for r=0.8 class 1.0 = 0.799 +- 0.274 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.8 all KL = 0.733 +- 0.274 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.8 all L1 = 0.799 +- 0.194 (in-sample avg dev_std = 0.434)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004582936507936508
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.609
SUFF_SIMPLE for r=0.9 class 1.0 = 0.803 +- 0.273 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.9 all KL = 0.743 +- 0.273 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.9 all L1 = 0.803 +- 0.194 (in-sample avg dev_std = 0.427)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.637
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004582936507936508
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.609
SUFF_SIMPLE for r=0.95 class 1.0 = 0.803 +- 0.273 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.95 all KL = 0.743 +- 0.273 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.95 all L1 = 0.803 +- 0.194 (in-sample avg dev_std = 0.427)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.797
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09998946515397082
len(reference) = 2459
Effective ratio: 0.351 +- 0.245
Model Accuracy over intervened graphs for r=0.5 =  0.728
SUFF_SIMPLE for r=0.5 class 1.0 = 0.833 +- 0.364 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.5 all KL = 0.736 +- 0.364 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.5 all L1 = 0.833 +- 0.247 (in-sample avg dev_std = 0.359)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04160413290113452
len(reference) = 2468
Effective ratio: 0.032 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.727
SUFF_SIMPLE for r=0.8 class 1.0 = 0.817 +- 0.375 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.8 all KL = 0.699 +- 0.375 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.8 all L1 = 0.817 +- 0.237 (in-sample avg dev_std = 0.431)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03847406807131281
len(reference) = 2468
Effective ratio: 0.027 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.725
SUFF_SIMPLE for r=0.9 class 1.0 = 0.811 +- 0.376 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.9 all KL = 0.686 +- 0.376 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.9 all L1 = 0.811 +- 0.236 (in-sample avg dev_std = 0.448)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.796
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03702188006482982
len(reference) = 2468
Effective ratio: 0.025 +- 0.047
Model Accuracy over intervened graphs for r=0.95 =  0.726
SUFF_SIMPLE for r=0.95 class 1.0 = 0.812 +- 0.375 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.95 all KL = 0.686 +- 0.375 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.95 all L1 = 0.812 +- 0.234 (in-sample avg dev_std = 0.444)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08138989169675091
len(reference) = 277
Effective ratio: 0.247 +- 0.131
Model Accuracy over intervened graphs for r=0.5 =  0.991
NEC for r=0.5 class 1.0 = 0.017 +- 0.187 (in-sample avg dev_std = 0.166)
NEC for r=0.5 all KL = 0.054 +- 0.187 (in-sample avg dev_std = 0.166)
NEC for r=0.5 all L1 = 0.017 +- 0.062 (in-sample avg dev_std = 0.166)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.028498194945848376
len(reference) = 277
Effective ratio: 0.022 +- 0.026
Model Accuracy over intervened graphs for r=0.8 =  0.991
NEC for r=0.8 class 1.0 = 0.01 +- 0.115 (in-sample avg dev_std = 0.095)
NEC for r=0.8 all KL = 0.015 +- 0.115 (in-sample avg dev_std = 0.095)
NEC for r=0.8 all L1 = 0.01 +- 0.081 (in-sample avg dev_std = 0.095)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02885559566787004
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.991
NEC for r=0.9 class 1.0 = 0.01 +- 0.117 (in-sample avg dev_std = 0.097)
NEC for r=0.9 all KL = 0.015 +- 0.117 (in-sample avg dev_std = 0.097)
NEC for r=0.9 all L1 = 0.01 +- 0.083 (in-sample avg dev_std = 0.097)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.02885559566787004
len(reference) = 277
Effective ratio: 0.021 +- 0.025
Model Accuracy over intervened graphs for r=0.95 =  0.991
NEC for r=0.95 class 1.0 = 0.01 +- 0.117 (in-sample avg dev_std = 0.097)
NEC for r=0.95 all KL = 0.015 +- 0.117 (in-sample avg dev_std = 0.097)
NEC for r=0.95 all L1 = 0.01 +- 0.083 (in-sample avg dev_std = 0.097)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.637
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012407539682539683
len(reference) = 2520
Effective ratio: 0.193 +- 0.126
Model Accuracy over intervened graphs for r=0.5 =  0.625
NEC for r=0.5 class 1.0 = 0.121 +- 0.210 (in-sample avg dev_std = 0.304)
NEC for r=0.5 all KL = 0.121 +- 0.210 (in-sample avg dev_std = 0.304)
NEC for r=0.5 all L1 = 0.121 +- 0.158 (in-sample avg dev_std = 0.304)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004638095238095238
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.636
NEC for r=0.8 class 1.0 = 0.028 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.012 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.028 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004582936507936508
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.636
NEC for r=0.9 class 1.0 = 0.028 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.012 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.028 +- 0.091 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.637
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004582936507936508
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.636
NEC for r=0.95 class 1.0 = 0.028 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.012 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.028 +- 0.091 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.796
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09998946515397082
len(reference) = 2468
Effective ratio: 0.351 +- 0.245
Model Accuracy over intervened graphs for r=0.5 =  0.759
NEC for r=0.5 class 1.0 = 0.117 +- 0.332 (in-sample avg dev_std = 0.349)
NEC for r=0.5 all KL = 0.184 +- 0.332 (in-sample avg dev_std = 0.349)
NEC for r=0.5 all L1 = 0.117 +- 0.205 (in-sample avg dev_std = 0.349)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04160413290113452
len(reference) = 2468
Effective ratio: 0.032 +- 0.068
Model Accuracy over intervened graphs for r=0.8 =  0.784
NEC for r=0.8 class 1.0 = 0.05 +- 0.207 (in-sample avg dev_std = 0.024)
NEC for r=0.8 all KL = 0.052 +- 0.207 (in-sample avg dev_std = 0.024)
NEC for r=0.8 all L1 = 0.05 +- 0.175 (in-sample avg dev_std = 0.024)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03847406807131281
len(reference) = 2468
Effective ratio: 0.027 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.787
NEC for r=0.9 class 1.0 = 0.047 +- 0.198 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.048 +- 0.198 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.047 +- 0.170 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.796
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03702188006482982
len(reference) = 2468
Effective ratio: 0.025 +- 0.047
Model Accuracy over intervened graphs for r=0.95 =  0.787
NEC for r=0.95 class 1.0 = 0.047 +- 0.197 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.047 +- 0.197 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.047 +- 0.169 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 02:36:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 02:36:35 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 02:36:35 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 02:36:35 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 02:36:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:36:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:36:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:36:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:36:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:36:35 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 02:36:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.086
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.035
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.032
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.032
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.005
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.005
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.005
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.047
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.040
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.039


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08607581227436822
len(reference) = 277
Effective ratio: 0.210 +- 0.140
Model Accuracy over intervened graphs for r=0.5 =  0.959
SUFF_SIMPLE for r=0.5 class 1.0 = 0.93 +- 0.331 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.5 all KL = 0.791 +- 0.331 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.5 all L1 = 0.93 +- 0.139 (in-sample avg dev_std = 0.324)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03488447653429603
len(reference) = 277
Effective ratio: 0.023 +- 0.031
Model Accuracy over intervened graphs for r=0.8 =  0.957
SUFF_SIMPLE for r=0.8 class 1.0 = 0.929 +- 0.339 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.8 all KL = 0.785 +- 0.339 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.8 all L1 = 0.929 +- 0.135 (in-sample avg dev_std = 0.339)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03218772563176896
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.951
SUFF_SIMPLE for r=0.9 class 1.0 = 0.918 +- 0.345 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.9 all KL = 0.749 +- 0.345 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.9 all L1 = 0.918 +- 0.143 (in-sample avg dev_std = 0.359)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03218772563176896
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  0.951
SUFF_SIMPLE for r=0.95 class 1.0 = 0.918 +- 0.345 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.95 all KL = 0.749 +- 0.345 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.95 all L1 = 0.918 +- 0.143 (in-sample avg dev_std = 0.359)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.588
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.01276190476190476
len(reference) = 2520
Effective ratio: 0.394 +- 0.179
Model Accuracy over intervened graphs for r=0.5 =  0.543
SUFF_SIMPLE for r=0.5 class 1.0 = 0.766 +- 0.319 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.5 all KL = 0.652 +- 0.319 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.5 all L1 = 0.766 +- 0.207 (in-sample avg dev_std = 0.515)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004647619047619047
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.544
SUFF_SIMPLE for r=0.8 class 1.0 = 0.768 +- 0.314 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.8 all KL = 0.654 +- 0.314 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.8 all L1 = 0.768 +- 0.205 (in-sample avg dev_std = 0.511)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.588
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0046718253968253964
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.542
SUFF_SIMPLE for r=0.9 class 1.0 = 0.765 +- 0.315 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.9 all KL = 0.65 +- 0.315 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.9 all L1 = 0.765 +- 0.208 (in-sample avg dev_std = 0.516)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.588
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0046718253968253964
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.542
SUFF_SIMPLE for r=0.95 class 1.0 = 0.765 +- 0.315 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.95 all KL = 0.65 +- 0.315 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.95 all L1 = 0.765 +- 0.208 (in-sample avg dev_std = 0.516)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.762
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09982658022690438
len(reference) = 2466
Effective ratio: 0.360 +- 0.196
Model Accuracy over intervened graphs for r=0.5 =  0.642
SUFF_SIMPLE for r=0.5 class 1.0 = 0.79 +- 0.385 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.5 all KL = 0.634 +- 0.385 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.5 all L1 = 0.79 +- 0.247 (in-sample avg dev_std = 0.456)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04666369529983792
len(reference) = 2468
Effective ratio: 0.036 +- 0.073
Model Accuracy over intervened graphs for r=0.8 =  0.613
SUFF_SIMPLE for r=0.8 class 1.0 = 0.765 +- 0.392 (in-sample avg dev_std = 0.497)
SUFF_SIMPLE for r=0.8 all KL = 0.593 +- 0.392 (in-sample avg dev_std = 0.497)
SUFF_SIMPLE for r=0.8 all L1 = 0.765 +- 0.256 (in-sample avg dev_std = 0.497)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03987722852512156
len(reference) = 2468
Effective ratio: 0.027 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.613
SUFF_SIMPLE for r=0.9 class 1.0 = 0.77 +- 0.389 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.9 all KL = 0.598 +- 0.389 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.9 all L1 = 0.77 +- 0.255 (in-sample avg dev_std = 0.491)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.762
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.038538492706645056
len(reference) = 2468
Effective ratio: 0.025 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.616
SUFF_SIMPLE for r=0.95 class 1.0 = 0.772 +- 0.390 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.95 all KL = 0.603 +- 0.390 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.95 all L1 = 0.772 +- 0.256 (in-sample avg dev_std = 0.486)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08607581227436822
len(reference) = 277
Effective ratio: 0.210 +- 0.140
Model Accuracy over intervened graphs for r=0.5 =  0.991
NEC for r=0.5 class 1.0 = 0.018 +- 0.182 (in-sample avg dev_std = 0.170)
NEC for r=0.5 all KL = 0.058 +- 0.182 (in-sample avg dev_std = 0.170)
NEC for r=0.5 all L1 = 0.018 +- 0.060 (in-sample avg dev_std = 0.170)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03488447653429603
len(reference) = 277
Effective ratio: 0.023 +- 0.031
Model Accuracy over intervened graphs for r=0.8 =  0.989
NEC for r=0.8 class 1.0 = 0.015 +- 0.142 (in-sample avg dev_std = 0.001)
NEC for r=0.8 all KL = 0.025 +- 0.142 (in-sample avg dev_std = 0.001)
NEC for r=0.8 all L1 = 0.015 +- 0.097 (in-sample avg dev_std = 0.001)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03218772563176896
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.989
NEC for r=0.9 class 1.0 = 0.015 +- 0.142 (in-sample avg dev_std = 0.001)
NEC for r=0.9 all KL = 0.025 +- 0.142 (in-sample avg dev_std = 0.001)
NEC for r=0.9 all L1 = 0.015 +- 0.097 (in-sample avg dev_std = 0.001)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.03218772563176896
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.95 =  0.989
NEC for r=0.95 class 1.0 = 0.015 +- 0.142 (in-sample avg dev_std = 0.001)
NEC for r=0.95 all KL = 0.025 +- 0.142 (in-sample avg dev_std = 0.001)
NEC for r=0.95 all L1 = 0.015 +- 0.097 (in-sample avg dev_std = 0.001)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.588
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.01276190476190476
len(reference) = 2520
Effective ratio: 0.394 +- 0.179
Model Accuracy over intervened graphs for r=0.5 =  0.566
NEC for r=0.5 class 1.0 = 0.144 +- 0.263 (in-sample avg dev_std = 0.376)
NEC for r=0.5 all KL = 0.178 +- 0.263 (in-sample avg dev_std = 0.376)
NEC for r=0.5 all L1 = 0.144 +- 0.174 (in-sample avg dev_std = 0.376)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.004647619047619047
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.582
NEC for r=0.8 class 1.0 = 0.029 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.012 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.029 +- 0.090 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.588
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0046718253968253964
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.581
NEC for r=0.9 class 1.0 = 0.029 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.012 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.029 +- 0.089 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.588
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0046718253968253964
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.581
NEC for r=0.95 class 1.0 = 0.029 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.012 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.029 +- 0.089 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.762
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09982658022690438
len(reference) = 2468
Effective ratio: 0.360 +- 0.196
Model Accuracy over intervened graphs for r=0.5 =  0.678
NEC for r=0.5 class 1.0 = 0.146 +- 0.363 (in-sample avg dev_std = 0.393)
NEC for r=0.5 all KL = 0.248 +- 0.363 (in-sample avg dev_std = 0.393)
NEC for r=0.5 all L1 = 0.146 +- 0.224 (in-sample avg dev_std = 0.393)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.04666369529983792
len(reference) = 2468
Effective ratio: 0.036 +- 0.073
Model Accuracy over intervened graphs for r=0.8 =  0.739
NEC for r=0.8 class 1.0 = 0.052 +- 0.207 (in-sample avg dev_std = 0.019)
NEC for r=0.8 all KL = 0.058 +- 0.207 (in-sample avg dev_std = 0.019)
NEC for r=0.8 all L1 = 0.052 +- 0.170 (in-sample avg dev_std = 0.019)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.03987722852512156
len(reference) = 2468
Effective ratio: 0.027 +- 0.053
Model Accuracy over intervened graphs for r=0.9 =  0.747
NEC for r=0.9 class 1.0 = 0.044 +- 0.188 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.048 +- 0.188 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.044 +- 0.156 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.762
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.038538492706645056
len(reference) = 2468
Effective ratio: 0.025 +- 0.048
Model Accuracy over intervened graphs for r=0.95 =  0.748
NEC for r=0.95 class 1.0 = 0.044 +- 0.188 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.048 +- 0.188 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.044 +- 0.155 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 02:42:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 02:42:04 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 02:42:04 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 02:42:04 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 02:42:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:42:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:42:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:42:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:42:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:42:04 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 02:42:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.083
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.032
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.032
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.005
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.005
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.005
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.098
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.042
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.038
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.036


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08342960288808664
len(reference) = 277
Effective ratio: 0.198 +- 0.132
Model Accuracy over intervened graphs for r=0.5 =  0.975
SUFF_SIMPLE for r=0.5 class 1.0 = 0.955 +- 0.294 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.5 all KL = 0.86 +- 0.294 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.5 all L1 = 0.955 +- 0.108 (in-sample avg dev_std = 0.280)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03289530685920578
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.8 =  0.962
SUFF_SIMPLE for r=0.8 class 1.0 = 0.934 +- 0.341 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.8 all KL = 0.802 +- 0.341 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.8 all L1 = 0.934 +- 0.129 (in-sample avg dev_std = 0.346)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.032108303249097477
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.967
SUFF_SIMPLE for r=0.9 class 1.0 = 0.945 +- 0.317 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.9 all KL = 0.838 +- 0.317 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.9 all L1 = 0.945 +- 0.122 (in-sample avg dev_std = 0.319)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.032108303249097477
len(reference) = 277
Effective ratio: 0.021 +- 0.020
Model Accuracy over intervened graphs for r=0.95 =  0.963
SUFF_SIMPLE for r=0.95 class 1.0 = 0.938 +- 0.334 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.95 all KL = 0.814 +- 0.334 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.95 all L1 = 0.938 +- 0.129 (in-sample avg dev_std = 0.335)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.782
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012563095238095238
len(reference) = 2520
Effective ratio: 0.251 +- 0.141
Model Accuracy over intervened graphs for r=0.5 =  0.676
SUFF_SIMPLE for r=0.5 class 1.0 = 0.8 +- 0.337 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.5 all KL = 0.677 +- 0.337 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.5 all L1 = 0.8 +- 0.221 (in-sample avg dev_std = 0.466)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0049531746031746034
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.677
SUFF_SIMPLE for r=0.8 class 1.0 = 0.796 +- 0.337 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.8 all KL = 0.665 +- 0.337 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.8 all L1 = 0.796 +- 0.219 (in-sample avg dev_std = 0.477)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.782
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004774206349206349
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.683
SUFF_SIMPLE for r=0.9 class 1.0 = 0.805 +- 0.332 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.9 all KL = 0.686 +- 0.332 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.9 all L1 = 0.805 +- 0.218 (in-sample avg dev_std = 0.460)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.782
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004774206349206349
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.683
SUFF_SIMPLE for r=0.95 class 1.0 = 0.805 +- 0.332 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.95 all KL = 0.686 +- 0.332 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.95 all L1 = 0.805 +- 0.218 (in-sample avg dev_std = 0.460)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.812
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.098459886547812
len(reference) = 2458
Effective ratio: 0.336 +- 0.228
Model Accuracy over intervened graphs for r=0.5 =  0.725
SUFF_SIMPLE for r=0.5 class 1.0 = 0.824 +- 0.358 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.5 all KL = 0.707 +- 0.358 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.5 all L1 = 0.824 +- 0.229 (in-sample avg dev_std = 0.404)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.81
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.041549837925445705
len(reference) = 2468
Effective ratio: 0.032 +- 0.065
Model Accuracy over intervened graphs for r=0.8 =  0.691
SUFF_SIMPLE for r=0.8 class 1.0 = 0.806 +- 0.369 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.8 all KL = 0.676 +- 0.369 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.8 all L1 = 0.806 +- 0.239 (in-sample avg dev_std = 0.441)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.038261345218800646
len(reference) = 2468
Effective ratio: 0.027 +- 0.054
Model Accuracy over intervened graphs for r=0.9 =  0.687
SUFF_SIMPLE for r=0.9 class 1.0 = 0.799 +- 0.371 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.9 all KL = 0.665 +- 0.371 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.9 all L1 = 0.799 +- 0.241 (in-sample avg dev_std = 0.453)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.81
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.036215559157212314
len(reference) = 2468
Effective ratio: 0.026 +- 0.049
Model Accuracy over intervened graphs for r=0.95 =  0.689
SUFF_SIMPLE for r=0.95 class 1.0 = 0.805 +- 0.371 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.95 all KL = 0.678 +- 0.371 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.95 all L1 = 0.805 +- 0.243 (in-sample avg dev_std = 0.435)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08342960288808664
len(reference) = 277
Effective ratio: 0.198 +- 0.132
Model Accuracy over intervened graphs for r=0.5 =  0.993
NEC for r=0.5 class 1.0 = 0.012 +- 0.157 (in-sample avg dev_std = 0.142)
NEC for r=0.5 all KL = 0.034 +- 0.157 (in-sample avg dev_std = 0.142)
NEC for r=0.5 all L1 = 0.012 +- 0.061 (in-sample avg dev_std = 0.142)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03289530685920578
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.8 =  0.996
NEC for r=0.8 class 1.0 = 0.005 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.01 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.005 +- 0.059 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.032108303249097477
len(reference) = 277
Effective ratio: 0.021 +- 0.022
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 1.0 = 0.005 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.01 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.005 +- 0.059 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.032108303249097477
len(reference) = 277
Effective ratio: 0.021 +- 0.020
Model Accuracy over intervened graphs for r=0.95 =  0.996
NEC for r=0.95 class 1.0 = 0.005 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.01 +- 0.088 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.005 +- 0.059 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.782
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.012563095238095238
len(reference) = 2520
Effective ratio: 0.251 +- 0.141
Model Accuracy over intervened graphs for r=0.5 =  0.737
NEC for r=0.5 class 1.0 = 0.12 +- 0.255 (in-sample avg dev_std = 0.339)
NEC for r=0.5 all KL = 0.159 +- 0.255 (in-sample avg dev_std = 0.339)
NEC for r=0.5 all L1 = 0.12 +- 0.172 (in-sample avg dev_std = 0.339)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0049531746031746034
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.775
NEC for r=0.8 class 1.0 = 0.028 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.013 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.028 +- 0.095 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.782
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.004774206349206349
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.775
NEC for r=0.9 class 1.0 = 0.027 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.013 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.027 +- 0.094 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.782
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.004774206349206349
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.775
NEC for r=0.95 class 1.0 = 0.027 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.013 +- 0.082 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.027 +- 0.094 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.81
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.098459886547812
len(reference) = 2468
Effective ratio: 0.336 +- 0.228
Model Accuracy over intervened graphs for r=0.5 =  0.744
NEC for r=0.5 class 1.0 = 0.123 +- 0.331 (in-sample avg dev_std = 0.354)
NEC for r=0.5 all KL = 0.192 +- 0.331 (in-sample avg dev_std = 0.354)
NEC for r=0.5 all L1 = 0.123 +- 0.211 (in-sample avg dev_std = 0.354)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.81
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.041549837925445705
len(reference) = 2468
Effective ratio: 0.032 +- 0.065
Model Accuracy over intervened graphs for r=0.8 =  0.798
NEC for r=0.8 class 1.0 = 0.039 +- 0.178 (in-sample avg dev_std = 0.024)
NEC for r=0.8 all KL = 0.041 +- 0.178 (in-sample avg dev_std = 0.024)
NEC for r=0.8 all L1 = 0.039 +- 0.148 (in-sample avg dev_std = 0.024)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.038261345218800646
len(reference) = 2468
Effective ratio: 0.027 +- 0.054
Model Accuracy over intervened graphs for r=0.9 =  0.8
NEC for r=0.9 class 1.0 = 0.035 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.037 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.035 +- 0.140 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.81
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.036215559157212314
len(reference) = 2468
Effective ratio: 0.026 +- 0.049
Model Accuracy over intervened graphs for r=0.95 =  0.8
NEC for r=0.95 class 1.0 = 0.035 +- 0.165 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.036 +- 0.165 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.035 +- 0.140 (in-sample avg dev_std = 0.000)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 02:48:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 02:48:14 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 02:48:14 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 02:48:14 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 02:48:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:48:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:48:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:48:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:48:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:48:14 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 02:48:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.084
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.028
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.026
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.025
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.004
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.004
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.004
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.5 = 0.000
WIoU for r=0.5 = 0.098
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.039
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.035
F1 for r=0.95 = 0.000
WIoU for r=0.95 = 0.034


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08423104693140794
len(reference) = 277
Effective ratio: 0.259 +- 0.149
Model Accuracy over intervened graphs for r=0.5 =  0.971
SUFF_SIMPLE for r=0.5 class 1.0 = 0.946 +- 0.348 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.5 all KL = 0.806 +- 0.348 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.5 all L1 = 0.946 +- 0.119 (in-sample avg dev_std = 0.299)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.028335740072202166
len(reference) = 277
Effective ratio: 0.026 +- 0.036
Model Accuracy over intervened graphs for r=0.8 =  0.964
SUFF_SIMPLE for r=0.8 class 1.0 = 0.94 +- 0.367 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.8 all KL = 0.788 +- 0.367 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.8 all L1 = 0.94 +- 0.124 (in-sample avg dev_std = 0.323)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02587003610108303
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.972
SUFF_SIMPLE for r=0.9 class 1.0 = 0.946 +- 0.350 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.9 all KL = 0.805 +- 0.350 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.9 all L1 = 0.946 +- 0.114 (in-sample avg dev_std = 0.295)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.025129963898916967
len(reference) = 277
Effective ratio: 0.021 +- 0.021
Model Accuracy over intervened graphs for r=0.95 =  0.97
SUFF_SIMPLE for r=0.95 class 1.0 = 0.948 +- 0.351 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.95 all KL = 0.813 +- 0.351 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.95 all L1 = 0.948 +- 0.116 (in-sample avg dev_std = 0.297)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.508
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.01231031746031746
len(reference) = 2520
Effective ratio: 0.164 +- 0.102
Model Accuracy over intervened graphs for r=0.5 =  0.255
SUFF_SIMPLE for r=0.5 class 1.0 = 0.669 +- 0.359 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.5 all KL = 0.609 +- 0.359 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.5 all L1 = 0.669 +- 0.285 (in-sample avg dev_std = 0.463)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0035619047619047622
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.256
SUFF_SIMPLE for r=0.8 class 1.0 = 0.666 +- 0.360 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.8 all KL = 0.607 +- 0.360 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.8 all L1 = 0.666 +- 0.286 (in-sample avg dev_std = 0.465)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.508
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0035043650793650793
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.255
SUFF_SIMPLE for r=0.9 class 1.0 = 0.665 +- 0.361 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.9 all KL = 0.604 +- 0.361 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.9 all L1 = 0.665 +- 0.285 (in-sample avg dev_std = 0.468)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.508
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0035043650793650793
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.259
SUFF_SIMPLE for r=0.95 class 1.0 = 0.668 +- 0.359 (in-sample avg dev_std = 0.471)
SUFF_SIMPLE for r=0.95 all KL = 0.608 +- 0.359 (in-sample avg dev_std = 0.471)
SUFF_SIMPLE for r=0.95 all L1 = 0.668 +- 0.283 (in-sample avg dev_std = 0.471)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.913
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09786912479740681
len(reference) = 2456
Effective ratio: 0.443 +- 0.150
Model Accuracy over intervened graphs for r=0.5 =  0.82
SUFF_SIMPLE for r=0.5 class 1.0 = 0.846 +- 0.396 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.5 all KL = 0.681 +- 0.396 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.5 all L1 = 0.846 +- 0.236 (in-sample avg dev_std = 0.390)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.913
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03915275526742301
len(reference) = 2468
Effective ratio: 0.031 +- 0.053
Model Accuracy over intervened graphs for r=0.8 =  0.796
SUFF_SIMPLE for r=0.8 class 1.0 = 0.823 +- 0.409 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.8 all KL = 0.636 +- 0.409 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.8 all L1 = 0.823 +- 0.247 (in-sample avg dev_std = 0.454)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0349339546191248
len(reference) = 2468
Effective ratio: 0.025 +- 0.046
Model Accuracy over intervened graphs for r=0.9 =  0.792
SUFF_SIMPLE for r=0.9 class 1.0 = 0.82 +- 0.411 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.9 all KL = 0.628 +- 0.411 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.9 all L1 = 0.82 +- 0.249 (in-sample avg dev_std = 0.449)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.913
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.034293760129659644
len(reference) = 2468
Effective ratio: 0.025 +- 0.044
Model Accuracy over intervened graphs for r=0.95 =  0.795
SUFF_SIMPLE for r=0.95 class 1.0 = 0.825 +- 0.407 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.95 all KL = 0.64 +- 0.407 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.95 all L1 = 0.825 +- 0.249 (in-sample avg dev_std = 0.444)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  1.0
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.08423104693140794
len(reference) = 277
Effective ratio: 0.259 +- 0.149
Model Accuracy over intervened graphs for r=0.5 =  0.991
NEC for r=0.5 class 1.0 = 0.017 +- 0.200 (in-sample avg dev_std = 0.167)
NEC for r=0.5 all KL = 0.059 +- 0.200 (in-sample avg dev_std = 0.167)
NEC for r=0.5 all L1 = 0.017 +- 0.072 (in-sample avg dev_std = 0.167)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.028335740072202166
len(reference) = 277
Effective ratio: 0.026 +- 0.036
Model Accuracy over intervened graphs for r=0.8 =  0.995
NEC for r=0.8 class 1.0 = 0.007 +- 0.125 (in-sample avg dev_std = 0.046)
NEC for r=0.8 all KL = 0.019 +- 0.125 (in-sample avg dev_std = 0.046)
NEC for r=0.8 all L1 = 0.007 +- 0.063 (in-sample avg dev_std = 0.046)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.02587003610108303
len(reference) = 277
Effective ratio: 0.022 +- 0.025
Model Accuracy over intervened graphs for r=0.9 =  0.996
NEC for r=0.9 class 1.0 = 0.006 +- 0.111 (in-sample avg dev_std = 0.002)
NEC for r=0.9 all KL = 0.016 +- 0.111 (in-sample avg dev_std = 0.002)
NEC for r=0.9 all L1 = 0.006 +- 0.055 (in-sample avg dev_std = 0.002)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  1.0
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.025129963898916967
len(reference) = 277
Effective ratio: 0.021 +- 0.021
Model Accuracy over intervened graphs for r=0.95 =  0.996
NEC for r=0.95 class 1.0 = 0.006 +- 0.110 (in-sample avg dev_std = 0.002)
NEC for r=0.95 all KL = 0.016 +- 0.110 (in-sample avg dev_std = 0.002)
NEC for r=0.95 all L1 = 0.006 +- 0.055 (in-sample avg dev_std = 0.002)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.508
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.01231031746031746
len(reference) = 2520
Effective ratio: 0.164 +- 0.102
Model Accuracy over intervened graphs for r=0.5 =  0.378
NEC for r=0.5 class 1.0 = 0.206 +- 0.264 (in-sample avg dev_std = 0.357)
NEC for r=0.5 all KL = 0.201 +- 0.264 (in-sample avg dev_std = 0.357)
NEC for r=0.5 all L1 = 0.206 +- 0.225 (in-sample avg dev_std = 0.357)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0035619047619047622
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.8 =  0.482
NEC for r=0.8 class 1.0 = 0.044 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.019 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.044 +- 0.113 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.508
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0035043650793650793
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.482
NEC for r=0.9 class 1.0 = 0.043 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.018 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.043 +- 0.112 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.508
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.0035043650793650793
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.95 =  0.482
NEC for r=0.95 class 1.0 = 0.043 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.018 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.043 +- 0.112 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.5



Model Accuracy of binarized graphs for r=0.5 =  0.913
Model XAI F1 of binarized graphs for r=0.5 =  0.0
Model XAI WIoU of binarized graphs for r=0.5 =  0.09786912479740681
len(reference) = 2468
Effective ratio: 0.443 +- 0.150
Model Accuracy over intervened graphs for r=0.5 =  0.851
NEC for r=0.5 class 1.0 = 0.111 +- 0.361 (in-sample avg dev_std = 0.350)
NEC for r=0.5 all KL = 0.217 +- 0.361 (in-sample avg dev_std = 0.350)
NEC for r=0.5 all L1 = 0.111 +- 0.211 (in-sample avg dev_std = 0.350)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.913
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03915275526742301
len(reference) = 2468
Effective ratio: 0.031 +- 0.053
Model Accuracy over intervened graphs for r=0.8 =  0.904
NEC for r=0.8 class 1.0 = 0.037 +- 0.176 (in-sample avg dev_std = 0.001)
NEC for r=0.8 all KL = 0.043 +- 0.176 (in-sample avg dev_std = 0.001)
NEC for r=0.8 all L1 = 0.037 +- 0.148 (in-sample avg dev_std = 0.001)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.0349339546191248
len(reference) = 2468
Effective ratio: 0.025 +- 0.046
Model Accuracy over intervened graphs for r=0.9 =  0.907
NEC for r=0.9 class 1.0 = 0.032 +- 0.162 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all KL = 0.036 +- 0.162 (in-sample avg dev_std = 0.000)
NEC for r=0.9 all L1 = 0.032 +- 0.138 (in-sample avg dev_std = 0.000)


ratio=0.95



Model Accuracy of binarized graphs for r=0.95 =  0.913
Model XAI F1 of binarized graphs for r=0.95 =  0.0
Model XAI WIoU of binarized graphs for r=0.95 =  0.034293760129659644
len(reference) = 2468
Effective ratio: 0.025 +- 0.044
Model Accuracy over intervened graphs for r=0.95 =  0.908
NEC for r=0.95 class 1.0 = 0.031 +- 0.159 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all KL = 0.035 +- 0.159 (in-sample avg dev_std = 0.000)
NEC for r=0.95 all L1 = 0.031 +- 0.136 (in-sample avg dev_std = 0.000)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.817, 0.813, 0.809, 0.807], 'all_L1': [0.936, 0.94, 0.94, 0.938]}), defaultdict(<class 'list'>, {'all_KL': [0.868, 0.837, 0.826, 0.854], 'all_L1': [0.956, 0.945, 0.94, 0.951]}), defaultdict(<class 'list'>, {'all_KL': [0.892, 0.89, 0.857, 0.88], 'all_L1': [0.963, 0.962, 0.953, 0.958]}), defaultdict(<class 'list'>, {'all_KL': [0.816, 0.824, 0.835, 0.815], 'all_L1': [0.937, 0.942, 0.944, 0.936]}), defaultdict(<class 'list'>, {'all_KL': [0.892, 0.893, 0.866, 0.887], 'all_L1': [0.962, 0.962, 0.956, 0.959]}), defaultdict(<class 'list'>, {'all_KL': [0.77, 0.778, 0.731, 0.728], 'all_L1': [0.919, 0.923, 0.907, 0.907]}), defaultdict(<class 'list'>, {'all_KL': [0.822, 0.836, 0.825, 0.825], 'all_L1': [0.937, 0.949, 0.947, 0.947]}), defaultdict(<class 'list'>, {'all_KL': [0.791, 0.785, 0.749, 0.749], 'all_L1': [0.93, 0.929, 0.918, 0.918]}), defaultdict(<class 'list'>, {'all_KL': [0.86, 0.802, 0.838, 0.814], 'all_L1': [0.955, 0.934, 0.945, 0.938]}), defaultdict(<class 'list'>, {'all_KL': [0.806, 0.788, 0.805, 0.813], 'all_L1': [0.946, 0.94, 0.946, 0.948]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.042, 0.004, 0.003, 0.004], 'all_L1': [0.012, 0.001, 0.001, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.036, 0.006, 0.006, 0.005], 'all_L1': [0.012, 0.004, 0.004, 0.004]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.017, 0.018, 0.018], 'all_L1': [0.011, 0.012, 0.013, 0.012]}), defaultdict(<class 'list'>, {'all_KL': [0.032, 0.012, 0.013, 0.013], 'all_L1': [0.011, 0.004, 0.005, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.034, 0.008, 0.008, 0.008], 'all_L1': [0.011, 0.005, 0.005, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.053, 0.019, 0.016, 0.015], 'all_L1': [0.016, 0.01, 0.009, 0.009]}), defaultdict(<class 'list'>, {'all_KL': [0.054, 0.015, 0.015, 0.015], 'all_L1': [0.017, 0.01, 0.01, 0.01]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.025, 0.025, 0.025], 'all_L1': [0.018, 0.015, 0.015, 0.015]}), defaultdict(<class 'list'>, {'all_KL': [0.034, 0.01, 0.01, 0.01], 'all_L1': [0.012, 0.005, 0.005, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.059, 0.019, 0.016, 0.016], 'all_L1': [0.017, 0.007, 0.006, 0.006]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.724, 0.713, 0.722, 0.722], 'all_L1': [0.795, 0.789, 0.793, 0.793]}), defaultdict(<class 'list'>, {'all_KL': [0.638, 0.636, 0.638, 0.638], 'all_L1': [0.719, 0.72, 0.722, 0.722]}), defaultdict(<class 'list'>, {'all_KL': [0.597, 0.588, 0.597, 0.597], 'all_L1': [0.789, 0.787, 0.787, 0.787]}), defaultdict(<class 'list'>, {'all_KL': [0.425, 0.419, 0.426, 0.422], 'all_L1': [0.599, 0.598, 0.6, 0.598]}), defaultdict(<class 'list'>, {'all_KL': [0.74, 0.727, 0.732, 0.735], 'all_L1': [0.784, 0.777, 0.779, 0.78]}), defaultdict(<class 'list'>, {'all_KL': [0.754, 0.756, 0.757, 0.757], 'all_L1': [0.786, 0.787, 0.787, 0.787]}), defaultdict(<class 'list'>, {'all_KL': [0.743, 0.733, 0.743, 0.743], 'all_L1': [0.802, 0.799, 0.803, 0.803]}), defaultdict(<class 'list'>, {'all_KL': [0.652, 0.654, 0.65, 0.65], 'all_L1': [0.766, 0.768, 0.765, 0.765]}), defaultdict(<class 'list'>, {'all_KL': [0.677, 0.665, 0.686, 0.686], 'all_L1': [0.8, 0.796, 0.805, 0.805]}), defaultdict(<class 'list'>, {'all_KL': [0.609, 0.607, 0.604, 0.608], 'all_L1': [0.669, 0.666, 0.665, 0.668]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.139, 0.011, 0.011, 0.011], 'all_L1': [0.13, 0.029, 0.028, 0.028]}), defaultdict(<class 'list'>, {'all_KL': [0.194, 0.016, 0.016, 0.016], 'all_L1': [0.178, 0.041, 0.041, 0.041]}), defaultdict(<class 'list'>, {'all_KL': [0.186, 0.016, 0.016, 0.016], 'all_L1': [0.117, 0.026, 0.025, 0.025]}), defaultdict(<class 'list'>, {'all_KL': [0.281, 0.022, 0.021, 0.021], 'all_L1': [0.223, 0.045, 0.043, 0.043]}), defaultdict(<class 'list'>, {'all_KL': [0.13, 0.013, 0.012, 0.012], 'all_L1': [0.141, 0.034, 0.034, 0.034]}), defaultdict(<class 'list'>, {'all_KL': [0.114, 0.01, 0.01, 0.01], 'all_L1': [0.129, 0.031, 0.03, 0.03]}), defaultdict(<class 'list'>, {'all_KL': [0.121, 0.012, 0.012, 0.012], 'all_L1': [0.121, 0.028, 0.028, 0.028]}), defaultdict(<class 'list'>, {'all_KL': [0.178, 0.012, 0.012, 0.012], 'all_L1': [0.144, 0.029, 0.029, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.159, 0.013, 0.013, 0.013], 'all_L1': [0.12, 0.028, 0.027, 0.027]}), defaultdict(<class 'list'>, {'all_KL': [0.201, 0.019, 0.018, 0.018], 'all_L1': [0.206, 0.044, 0.043, 0.043]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.731, 0.693, 0.7, 0.696], 'all_L1': [0.844, 0.822, 0.825, 0.822]}), defaultdict(<class 'list'>, {'all_KL': [0.728, 0.66, 0.671, 0.662], 'all_L1': [0.83, 0.792, 0.795, 0.792]}), defaultdict(<class 'list'>, {'all_KL': [0.734, 0.719, 0.705, 0.702], 'all_L1': [0.821, 0.808, 0.802, 0.799]}), defaultdict(<class 'list'>, {'all_KL': [0.641, 0.622, 0.624, 0.615], 'all_L1': [0.787, 0.774, 0.777, 0.774]}), defaultdict(<class 'list'>, {'all_KL': [0.754, 0.702, 0.688, 0.671], 'all_L1': [0.837, 0.809, 0.803, 0.799]}), defaultdict(<class 'list'>, {'all_KL': [0.675, 0.628, 0.623, 0.625], 'all_L1': [0.768, 0.739, 0.738, 0.74]}), defaultdict(<class 'list'>, {'all_KL': [0.736, 0.699, 0.686, 0.686], 'all_L1': [0.833, 0.817, 0.811, 0.812]}), defaultdict(<class 'list'>, {'all_KL': [0.634, 0.593, 0.598, 0.603], 'all_L1': [0.79, 0.765, 0.77, 0.772]}), defaultdict(<class 'list'>, {'all_KL': [0.707, 0.676, 0.665, 0.678], 'all_L1': [0.824, 0.806, 0.799, 0.805]}), defaultdict(<class 'list'>, {'all_KL': [0.681, 0.636, 0.628, 0.64], 'all_L1': [0.846, 0.823, 0.82, 0.825]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.189, 0.051, 0.042, 0.042], 'all_L1': [0.114, 0.048, 0.04, 0.04]}), defaultdict(<class 'list'>, {'all_KL': [0.207, 0.042, 0.034, 0.033], 'all_L1': [0.127, 0.04, 0.034, 0.034]}), defaultdict(<class 'list'>, {'all_KL': [0.183, 0.048, 0.041, 0.04], 'all_L1': [0.129, 0.05, 0.042, 0.041]}), defaultdict(<class 'list'>, {'all_KL': [0.238, 0.067, 0.051, 0.049], 'all_L1': [0.142, 0.057, 0.044, 0.043]}), defaultdict(<class 'list'>, {'all_KL': [0.184, 0.043, 0.04, 0.038], 'all_L1': [0.126, 0.043, 0.04, 0.038]}), defaultdict(<class 'list'>, {'all_KL': [0.234, 0.06, 0.044, 0.042], 'all_L1': [0.164, 0.061, 0.046, 0.045]}), defaultdict(<class 'list'>, {'all_KL': [0.184, 0.052, 0.048, 0.047], 'all_L1': [0.117, 0.05, 0.047, 0.047]}), defaultdict(<class 'list'>, {'all_KL': [0.248, 0.058, 0.048, 0.048], 'all_L1': [0.146, 0.052, 0.044, 0.044]}), defaultdict(<class 'list'>, {'all_KL': [0.192, 0.041, 0.037, 0.036], 'all_L1': [0.123, 0.039, 0.035, 0.035]}), defaultdict(<class 'list'>, {'all_KL': [0.217, 0.043, 0.036, 0.035], 'all_L1': [0.111, 0.037, 0.032, 0.031]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.944 +- 0.014, 0.943 +- 0.012, 0.940 +- 0.015, 0.940 +- 0.016
suff_simple class all_KL  =  0.833 +- 0.040, 0.825 +- 0.039, 0.814 +- 0.041, 0.817 +- 0.048
suff_simple_acc_int  =  0.968 +- 0.008, 0.968 +- 0.007, 0.966 +- 0.008, 0.966 +- 0.009
nec class all_L1  =  0.014 +- 0.003, 0.007 +- 0.004, 0.007 +- 0.004, 0.007 +- 0.004
nec class all_KL  =  0.043 +- 0.011, 0.014 +- 0.006, 0.013 +- 0.006, 0.013 +- 0.006
nec_acc_int  =  0.993 +- 0.002, 0.995 +- 0.004, 0.995 +- 0.004, 0.995 +- 0.004

Eval split val
suff_simple class all_L1  =  0.751 +- 0.065, 0.749 +- 0.064, 0.751 +- 0.065, 0.751 +- 0.065
suff_simple class all_KL  =  0.656 +- 0.094, 0.650 +- 0.094, 0.656 +- 0.094, 0.656 +- 0.095
suff_simple_acc_int  =  0.508 +- 0.159, 0.508 +- 0.158, 0.509 +- 0.160, 0.509 +- 0.159
nec class all_L1  =  0.151 +- 0.036, 0.034 +- 0.007, 0.033 +- 0.007, 0.033 +- 0.007
nec class all_KL  =  0.170 +- 0.047, 0.014 +- 0.004, 0.014 +- 0.003, 0.014 +- 0.003
nec_acc_int  =  0.573 +- 0.156, 0.618 +- 0.161, 0.618 +- 0.161, 0.618 +- 0.161

Eval split test
suff_simple class all_L1  =  0.818 +- 0.025, 0.795 +- 0.026, 0.794 +- 0.025, 0.794 +- 0.025
suff_simple class all_KL  =  0.702 +- 0.040, 0.663 +- 0.039, 0.659 +- 0.036, 0.658 +- 0.033
suff_simple_acc_int  =  0.680 +- 0.090, 0.657 +- 0.092, 0.656 +- 0.092, 0.657 +- 0.092
nec class all_L1  =  0.130 +- 0.016, 0.048 +- 0.008, 0.040 +- 0.005, 0.040 +- 0.005
nec class all_KL  =  0.208 +- 0.024, 0.051 +- 0.008, 0.042 +- 0.005, 0.041 +- 0.005
nec_acc_int  =  0.707 +- 0.088, 0.752 +- 0.089, 0.757 +- 0.087, 0.757 +- 0.087


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.479 +- 0.006, 0.475 +- 0.006, 0.473 +- 0.007, 0.474 +- 0.008
Faith. Armon (L1)= 		  =  0.027 +- 0.005, 0.014 +- 0.008, 0.014 +- 0.008, 0.014 +- 0.008
Faith. GMean (L1)= 	  =  0.113 +- 0.011, 0.079 +- 0.025, 0.079 +- 0.024, 0.080 +- 0.022
Faith. Aritm (KL)= 		  =  0.438 +- 0.016, 0.419 +- 0.018, 0.414 +- 0.019, 0.415 +- 0.023
Faith. Armon (KL)= 		  =  0.082 +- 0.019, 0.026 +- 0.012, 0.025 +- 0.012, 0.025 +- 0.012
Faith. GMean (KL)= 	  =  0.188 +- 0.020, 0.102 +- 0.025, 0.099 +- 0.025, 0.099 +- 0.024

Eval split val
Faith. Aritm (L1)= 		  =  0.451 +- 0.015, 0.391 +- 0.029, 0.392 +- 0.029, 0.392 +- 0.030
Faith. Armon (L1)= 		  =  0.247 +- 0.043, 0.064 +- 0.012, 0.063 +- 0.012, 0.063 +- 0.012
Faith. GMean (L1)= 	  =  0.332 +- 0.023, 0.157 +- 0.010, 0.155 +- 0.010, 0.155 +- 0.010
Faith. Aritm (KL)= 		  =  0.413 +- 0.024, 0.332 +- 0.045, 0.335 +- 0.045, 0.335 +- 0.046
Faith. Armon (KL)= 		  =  0.262 +- 0.044, 0.028 +- 0.007, 0.028 +- 0.006, 0.028 +- 0.006
Faith. GMean (KL)= 	  =  0.327 +- 0.020, 0.095 +- 0.006, 0.094 +- 0.005, 0.094 +- 0.005

Eval split test
Faith. Aritm (L1)= 		  =  0.474 +- 0.006, 0.422 +- 0.011, 0.417 +- 0.011, 0.417 +- 0.011
Faith. Armon (L1)= 		  =  0.224 +- 0.022, 0.090 +- 0.013, 0.077 +- 0.009, 0.076 +- 0.009
Faith. GMean (L1)= 	  =  0.325 +- 0.014, 0.194 +- 0.013, 0.179 +- 0.010, 0.177 +- 0.010
Faith. Aritm (KL)= 		  =  0.455 +- 0.010, 0.357 +- 0.018, 0.350 +- 0.017, 0.349 +- 0.016
Faith. Armon (KL)= 		  =  0.319 +- 0.024, 0.094 +- 0.014, 0.079 +- 0.009, 0.077 +- 0.009
Faith. GMean (KL)= 	  =  0.380 +- 0.012, 0.182 +- 0.013, 0.166 +- 0.010, 0.164 +- 0.010
Computed for split load_split = id



Completed in  0:54:04.479926  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.01 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 02:53:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 02:53:24 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 02:53:24 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 02:53:24 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 02:53:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:53:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:53:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:53:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:53:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:53:24 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 02:53:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.978
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.965
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.800
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.303
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.964
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.954
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.803
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.312
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.929
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.915
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.741
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.343


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9783862815884475
len(reference) = 276
Effective ratio: 0.119 +- 0.111
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9649638989169675
len(reference) = 277
Effective ratio: 0.085 +- 0.079
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.799754512635379
len(reference) = 277
Effective ratio: 0.058 +- 0.052
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3028303249097473
len(reference) = 277
Effective ratio: 0.020 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9642238095238096
len(reference) = 2520
Effective ratio: 0.019 +- 0.005
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.001 (in-sample avg dev_std = 0.001)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.953540873015873
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.001 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8033261904761905
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.002 (in-sample avg dev_std = 0.001)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3124440476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.002 (in-sample avg dev_std = 0.001)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9290684764991898
len(reference) = 2251
Effective ratio: 0.189 +- 0.322
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9152747163695298
len(reference) = 2337
Effective ratio: 0.138 +- 0.261
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.7412783630470016
len(reference) = 2394
Effective ratio: 0.104 +- 0.219
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.34304902755267425
len(reference) = 2468
Effective ratio: 0.023 +- 0.039
Model Accuracy over intervened graphs for r=0.6 =  0.998
SUFF_SIMPLE for r=0.6 class 1.0 = 0.997 +- 0.070 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.6 all KL = 0.994 +- 0.070 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.6 all L1 = 0.997 +- 0.035 (in-sample avg dev_std = 0.080)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9783862815884475
len(reference) = 277
Effective ratio: 0.119 +- 0.111
Model Accuracy over intervened graphs for r=0.01 =  1.0
NEC for r=0.01 class 1.0 = 0.0 +- 0.004 (in-sample avg dev_std = 0.005)
NEC for r=0.01 all KL = 0.0 +- 0.004 (in-sample avg dev_std = 0.005)
NEC for r=0.01 all L1 = 0.0 +- 0.002 (in-sample avg dev_std = 0.005)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9649638989169675
len(reference) = 277
Effective ratio: 0.085 +- 0.079
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 1.0 = 0.001 +- 0.016 (in-sample avg dev_std = 0.008)
NEC for r=0.1 all KL = 0.001 +- 0.016 (in-sample avg dev_std = 0.008)
NEC for r=0.1 all L1 = 0.001 +- 0.009 (in-sample avg dev_std = 0.008)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.799754512635379
len(reference) = 277
Effective ratio: 0.058 +- 0.052
Model Accuracy over intervened graphs for r=0.25 =  1.0
NEC for r=0.25 class 1.0 = 0.001 +- 0.024 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.002 +- 0.024 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.001 +- 0.013 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3028303249097473
len(reference) = 277
Effective ratio: 0.020 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.001 +- 0.024 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.002 +- 0.024 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.001 +- 0.013 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9642238095238096
len(reference) = 2520
Effective ratio: 0.019 +- 0.005
Model Accuracy over intervened graphs for r=0.01 =  0.225
NEC for r=0.01 class 1.0 = 0.713 +- 0.231 (in-sample avg dev_std = 0.521)
NEC for r=0.01 all KL = 0.869 +- 0.231 (in-sample avg dev_std = 0.521)
NEC for r=0.01 all L1 = 0.713 +- 0.232 (in-sample avg dev_std = 0.521)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.953540873015873
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.852 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.961 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.852 +- 0.024 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8033261904761905
len(reference) = 2520
Effective ratio: 0.008 +- 0.002
Model Accuracy over intervened graphs for r=0.25 =  0.42
NEC for r=0.25 class 1.0 = 0.52 +- 0.448 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.595 +- 0.448 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.52 +- 0.383 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3124440476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.996
NEC for r=0.6 class 1.0 = 0.006 +- 0.072 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.007 +- 0.072 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.006 +- 0.059 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9290684764991898
len(reference) = 2468
Effective ratio: 0.189 +- 0.322
Model Accuracy over intervened graphs for r=0.01 =  0.46
NEC for r=0.01 class 1.0 = 0.531 +- 0.407 (in-sample avg dev_std = 0.583)
NEC for r=0.01 all KL = 0.717 +- 0.407 (in-sample avg dev_std = 0.583)
NEC for r=0.01 all L1 = 0.531 +- 0.347 (in-sample avg dev_std = 0.583)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9152747163695298
len(reference) = 2468
Effective ratio: 0.138 +- 0.261
Model Accuracy over intervened graphs for r=0.1 =  0.244
NEC for r=0.1 class 1.0 = 0.672 +- 0.377 (in-sample avg dev_std = 0.291)
NEC for r=0.1 all KL = 0.806 +- 0.377 (in-sample avg dev_std = 0.291)
NEC for r=0.1 all L1 = 0.672 +- 0.335 (in-sample avg dev_std = 0.291)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.7412783630470016
len(reference) = 2468
Effective ratio: 0.104 +- 0.219
Model Accuracy over intervened graphs for r=0.25 =  0.477
NEC for r=0.25 class 1.0 = 0.46 +- 0.490 (in-sample avg dev_std = 0.057)
NEC for r=0.25 all KL = 0.539 +- 0.490 (in-sample avg dev_std = 0.057)
NEC for r=0.25 all L1 = 0.46 +- 0.422 (in-sample avg dev_std = 0.057)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.34304902755267425
len(reference) = 2468
Effective ratio: 0.023 +- 0.039
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.002 +- 0.031 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.002 +- 0.031 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.002 +- 0.019 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 02:58:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 02:58:28 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 02:58:28 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 02:58:28 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 02:58:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:58:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:58:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:58:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 02:58:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 02:58:28 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 02:58:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.801
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.942
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.957
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.910
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.833
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.980
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.984
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.937
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.906
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.915
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.897
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.881


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8012346570397112
len(reference) = 260
Effective ratio: 0.479 +- 0.270
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9422851985559568
len(reference) = 272
Effective ratio: 0.147 +- 0.172
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9570649819494583
len(reference) = 277
Effective ratio: 0.084 +- 0.081
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9102418772563177
len(reference) = 277
Effective ratio: 0.072 +- 0.055
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8328400793650794
len(reference) = 2520
Effective ratio: 0.091 +- 0.028
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9798198412698413
len(reference) = 2520
Effective ratio: 0.015 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9841551587301587
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9368936507936507
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9055555105348461
len(reference) = 2060
Effective ratio: 0.277 +- 0.393
Model Accuracy over intervened graphs for r=0.01 =  0.999
SUFF_SIMPLE for r=0.01 class 1.0 = 0.999 +- 0.042 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.01 all KL = 0.998 +- 0.042 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.01 all L1 = 0.999 +- 0.032 (in-sample avg dev_std = 0.032)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9151738249594813
len(reference) = 2209
Effective ratio: 0.210 +- 0.344
Model Accuracy over intervened graphs for r=0.1 =  0.996
SUFF_SIMPLE for r=0.1 class 1.0 = 0.996 +- 0.071 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.1 all KL = 0.994 +- 0.071 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.1 all L1 = 0.996 +- 0.047 (in-sample avg dev_std = 0.069)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.998
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8974448946515398
len(reference) = 2325
Effective ratio: 0.144 +- 0.277
Model Accuracy over intervened graphs for r=0.25 =  0.998
SUFF_SIMPLE for r=0.25 class 1.0 = 0.998 +- 0.054 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.25 all KL = 0.996 +- 0.054 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.25 all L1 = 0.998 +- 0.034 (in-sample avg dev_std = 0.056)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.998
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8807499999999999
len(reference) = 2457
Effective ratio: 0.089 +- 0.158
Model Accuracy over intervened graphs for r=0.6 =  0.999
SUFF_SIMPLE for r=0.6 class 1.0 = 0.998 +- 0.057 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.6 all KL = 0.996 +- 0.057 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.6 all L1 = 0.998 +- 0.040 (in-sample avg dev_std = 0.049)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8012346570397112
len(reference) = 277
Effective ratio: 0.479 +- 0.270
Model Accuracy over intervened graphs for r=0.01 =  0.992
NEC for r=0.01 class 1.0 = 0.013 +- 0.138 (in-sample avg dev_std = 0.170)
NEC for r=0.01 all KL = 0.031 +- 0.138 (in-sample avg dev_std = 0.170)
NEC for r=0.01 all L1 = 0.013 +- 0.059 (in-sample avg dev_std = 0.170)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9422851985559568
len(reference) = 277
Effective ratio: 0.147 +- 0.172
Model Accuracy over intervened graphs for r=0.1 =  0.978
NEC for r=0.1 class 1.0 = 0.034 +- 0.221 (in-sample avg dev_std = 0.273)
NEC for r=0.1 all KL = 0.075 +- 0.221 (in-sample avg dev_std = 0.273)
NEC for r=0.1 all L1 = 0.034 +- 0.106 (in-sample avg dev_std = 0.273)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9570649819494583
len(reference) = 277
Effective ratio: 0.084 +- 0.081
Model Accuracy over intervened graphs for r=0.25 =  0.953
NEC for r=0.25 class 1.0 = 0.065 +- 0.298 (in-sample avg dev_std = 0.359)
NEC for r=0.25 all KL = 0.115 +- 0.298 (in-sample avg dev_std = 0.359)
NEC for r=0.25 all L1 = 0.065 +- 0.173 (in-sample avg dev_std = 0.359)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9102418772563177
len(reference) = 277
Effective ratio: 0.072 +- 0.055
Model Accuracy over intervened graphs for r=0.6 =  0.952
NEC for r=0.6 class 1.0 = 0.066 +- 0.298 (in-sample avg dev_std = 0.355)
NEC for r=0.6 all KL = 0.119 +- 0.298 (in-sample avg dev_std = 0.355)
NEC for r=0.6 all L1 = 0.066 +- 0.173 (in-sample avg dev_std = 0.355)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8328400793650794
len(reference) = 2520
Effective ratio: 0.091 +- 0.028
Model Accuracy over intervened graphs for r=0.01 =  0.991
NEC for r=0.01 class 1.0 = 0.015 +- 0.137 (in-sample avg dev_std = 0.178)
NEC for r=0.01 all KL = 0.034 +- 0.137 (in-sample avg dev_std = 0.178)
NEC for r=0.01 all L1 = 0.015 +- 0.061 (in-sample avg dev_std = 0.178)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9798198412698413
len(reference) = 2520
Effective ratio: 0.015 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.027
NEC for r=0.1 class 1.0 = 0.847 +- 0.070 (in-sample avg dev_std = 0.194)
NEC for r=0.1 all KL = 0.986 +- 0.070 (in-sample avg dev_std = 0.194)
NEC for r=0.1 all L1 = 0.847 +- 0.088 (in-sample avg dev_std = 0.194)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9841551587301587
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.863 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.995 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.863 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9368936507936507
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.05
NEC for r=0.6 class 1.0 = 0.822 +- 0.205 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.949 +- 0.205 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.822 +- 0.179 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.998
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9055555105348461
len(reference) = 2468
Effective ratio: 0.277 +- 0.393
Model Accuracy over intervened graphs for r=0.01 =  0.747
NEC for r=0.01 class 1.0 = 0.337 +- 0.410 (in-sample avg dev_std = 0.792)
NEC for r=0.01 all KL = 0.582 +- 0.410 (in-sample avg dev_std = 0.792)
NEC for r=0.01 all L1 = 0.337 +- 0.267 (in-sample avg dev_std = 0.792)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9151738249594813
len(reference) = 2468
Effective ratio: 0.210 +- 0.344
Model Accuracy over intervened graphs for r=0.1 =  0.606
NEC for r=0.1 class 1.0 = 0.445 +- 0.389 (in-sample avg dev_std = 0.741)
NEC for r=0.1 all KL = 0.683 +- 0.389 (in-sample avg dev_std = 0.741)
NEC for r=0.1 all L1 = 0.445 +- 0.305 (in-sample avg dev_std = 0.741)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.998
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8974448946515398
len(reference) = 2468
Effective ratio: 0.144 +- 0.277
Model Accuracy over intervened graphs for r=0.25 =  0.27
NEC for r=0.25 class 1.0 = 0.662 +- 0.359 (in-sample avg dev_std = 0.393)
NEC for r=0.25 all KL = 0.815 +- 0.359 (in-sample avg dev_std = 0.393)
NEC for r=0.25 all L1 = 0.662 +- 0.326 (in-sample avg dev_std = 0.393)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.998
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8807499999999999
len(reference) = 2468
Effective ratio: 0.089 +- 0.158
Model Accuracy over intervened graphs for r=0.6 =  0.142
NEC for r=0.6 class 1.0 = 0.745 +- 0.334 (in-sample avg dev_std = 0.131)
NEC for r=0.6 all KL = 0.867 +- 0.334 (in-sample avg dev_std = 0.131)
NEC for r=0.6 all L1 = 0.745 +- 0.291 (in-sample avg dev_std = 0.131)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 03:04:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 03:04:01 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 03:04:01 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 03:04:01 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 03:04:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:04:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:04:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:04:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:04:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:04:01 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 03:04:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.787
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.901
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.981
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.944
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.783
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.930
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.983
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.980
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.900
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.906
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.911
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.894


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7870505415162454
len(reference) = 246
Effective ratio: 0.473 +- 0.268
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9009675090252709
len(reference) = 273
Effective ratio: 0.176 +- 0.193
Model Accuracy over intervened graphs for r=0.1 =  0.999
SUFF_SIMPLE for r=0.1 class 1.0 = 0.998 +- 0.045 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.1 all KL = 0.997 +- 0.045 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.1 all L1 = 0.998 +- 0.024 (in-sample avg dev_std = 0.056)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9813212996389893
len(reference) = 276
Effective ratio: 0.105 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9436895306859208
len(reference) = 277
Effective ratio: 0.084 +- 0.069
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.86
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7825789682539683
len(reference) = 2520
Effective ratio: 0.100 +- 0.028
Model Accuracy over intervened graphs for r=0.01 =  0.86
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9304154761904762
len(reference) = 2520
Effective ratio: 0.019 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.86
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.86
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.983297619047619
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.86
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.980359523809524
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.86
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8995619935170177
len(reference) = 1932
Effective ratio: 0.289 +- 0.410
Model Accuracy over intervened graphs for r=0.01 =  0.998
SUFF_SIMPLE for r=0.01 class 1.0 = 0.998 +- 0.045 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.01 all KL = 0.998 +- 0.045 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.01 all L1 = 0.998 +- 0.038 (in-sample avg dev_std = 0.021)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9055405186385737
len(reference) = 2118
Effective ratio: 0.225 +- 0.362
Model Accuracy over intervened graphs for r=0.1 =  0.993
SUFF_SIMPLE for r=0.1 class 1.0 = 0.993 +- 0.095 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.1 all KL = 0.99 +- 0.095 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.1 all L1 = 0.993 +- 0.068 (in-sample avg dev_std = 0.090)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.995
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.910589546191248
len(reference) = 2293
Effective ratio: 0.172 +- 0.301
Model Accuracy over intervened graphs for r=0.25 =  0.994
SUFF_SIMPLE for r=0.25 class 1.0 = 0.992 +- 0.102 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.25 all KL = 0.988 +- 0.102 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.25 all L1 = 0.992 +- 0.073 (in-sample avg dev_std = 0.097)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.992
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8941519448946517
len(reference) = 2457
Effective ratio: 0.098 +- 0.166
Model Accuracy over intervened graphs for r=0.6 =  0.997
SUFF_SIMPLE for r=0.6 class 1.0 = 0.99 +- 0.110 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.6 all KL = 0.986 +- 0.110 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.6 all L1 = 0.99 +- 0.085 (in-sample avg dev_std = 0.090)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7870505415162454
len(reference) = 277
Effective ratio: 0.473 +- 0.268
Model Accuracy over intervened graphs for r=0.01 =  0.991
NEC for r=0.01 class 1.0 = 0.014 +- 0.130 (in-sample avg dev_std = 0.178)
NEC for r=0.01 all KL = 0.03 +- 0.130 (in-sample avg dev_std = 0.178)
NEC for r=0.01 all L1 = 0.014 +- 0.063 (in-sample avg dev_std = 0.178)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9009675090252709
len(reference) = 277
Effective ratio: 0.176 +- 0.193
Model Accuracy over intervened graphs for r=0.1 =  0.991
NEC for r=0.1 class 1.0 = 0.014 +- 0.129 (in-sample avg dev_std = 0.177)
NEC for r=0.1 all KL = 0.03 +- 0.129 (in-sample avg dev_std = 0.177)
NEC for r=0.1 all L1 = 0.014 +- 0.063 (in-sample avg dev_std = 0.177)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9813212996389893
len(reference) = 277
Effective ratio: 0.105 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.979
NEC for r=0.25 class 1.0 = 0.033 +- 0.197 (in-sample avg dev_std = 0.266)
NEC for r=0.25 all KL = 0.065 +- 0.197 (in-sample avg dev_std = 0.266)
NEC for r=0.25 all L1 = 0.033 +- 0.103 (in-sample avg dev_std = 0.266)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9436895306859208
len(reference) = 277
Effective ratio: 0.084 +- 0.069
Model Accuracy over intervened graphs for r=0.6 =  0.959
NEC for r=0.6 class 1.0 = 0.056 +- 0.264 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all KL = 0.094 +- 0.264 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all L1 = 0.056 +- 0.163 (in-sample avg dev_std = 0.330)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.86
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7825789682539683
len(reference) = 2520
Effective ratio: 0.100 +- 0.028
Model Accuracy over intervened graphs for r=0.01 =  0.857
NEC for r=0.01 class 1.0 = 0.005 +- 0.070 (in-sample avg dev_std = 0.102)
NEC for r=0.01 all KL = 0.01 +- 0.070 (in-sample avg dev_std = 0.102)
NEC for r=0.01 all L1 = 0.005 +- 0.036 (in-sample avg dev_std = 0.102)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9304154761904762
len(reference) = 2520
Effective ratio: 0.019 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.252
NEC for r=0.1 class 1.0 = 0.593 +- 0.366 (in-sample avg dev_std = 0.467)
NEC for r=0.1 all KL = 0.708 +- 0.366 (in-sample avg dev_std = 0.467)
NEC for r=0.1 all L1 = 0.593 +- 0.313 (in-sample avg dev_std = 0.467)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.86
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.983297619047619
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.776 +- 0.280 (in-sample avg dev_std = 0.020)
NEC for r=0.25 all KL = 0.856 +- 0.280 (in-sample avg dev_std = 0.020)
NEC for r=0.25 all L1 = 0.776 +- 0.198 (in-sample avg dev_std = 0.020)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.980359523809524
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.776 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.856 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.776 +- 0.198 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.992
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8995619935170177
len(reference) = 2468
Effective ratio: 0.289 +- 0.410
Model Accuracy over intervened graphs for r=0.01 =  0.732
NEC for r=0.01 class 1.0 = 0.351 +- 0.401 (in-sample avg dev_std = 0.792)
NEC for r=0.01 all KL = 0.562 +- 0.401 (in-sample avg dev_std = 0.792)
NEC for r=0.01 all L1 = 0.351 +- 0.275 (in-sample avg dev_std = 0.792)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9055405186385737
len(reference) = 2468
Effective ratio: 0.225 +- 0.362
Model Accuracy over intervened graphs for r=0.1 =  0.578
NEC for r=0.1 class 1.0 = 0.452 +- 0.399 (in-sample avg dev_std = 0.676)
NEC for r=0.1 all KL = 0.641 +- 0.399 (in-sample avg dev_std = 0.676)
NEC for r=0.1 all L1 = 0.452 +- 0.327 (in-sample avg dev_std = 0.676)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.992
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.910589546191248
len(reference) = 2468
Effective ratio: 0.172 +- 0.301
Model Accuracy over intervened graphs for r=0.25 =  0.433
NEC for r=0.25 class 1.0 = 0.553 +- 0.385 (in-sample avg dev_std = 0.577)
NEC for r=0.25 all KL = 0.725 +- 0.385 (in-sample avg dev_std = 0.577)
NEC for r=0.25 all L1 = 0.553 +- 0.338 (in-sample avg dev_std = 0.577)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.992
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8941519448946517
len(reference) = 2468
Effective ratio: 0.098 +- 0.166
Model Accuracy over intervened graphs for r=0.6 =  0.215
NEC for r=0.6 class 1.0 = 0.693 +- 0.351 (in-sample avg dev_std = 0.345)
NEC for r=0.6 all KL = 0.829 +- 0.351 (in-sample avg dev_std = 0.345)
NEC for r=0.6 all L1 = 0.693 +- 0.313 (in-sample avg dev_std = 0.345)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 03:08:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 03:08:36 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 03:08:36 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 03:08:36 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 03:08:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:08:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:08:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:08:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:08:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:08:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 03:08:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.868
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.976
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.914
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.249
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.680
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.933
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.922
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.908
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.900
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.862
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.279


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8683935018050543
len(reference) = 273
Effective ratio: 0.229 +- 0.163
Model Accuracy over intervened graphs for r=0.01 =  0.993
SUFF_SIMPLE for r=0.01 class 1.0 = 0.991 +- 0.093 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.01 all KL = 0.988 +- 0.093 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.01 all L1 = 0.991 +- 0.070 (in-sample avg dev_std = 0.095)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9756967509025269
len(reference) = 277
Effective ratio: 0.103 +- 0.096
Model Accuracy over intervened graphs for r=0.1 =  0.991
SUFF_SIMPLE for r=0.1 class 1.0 = 0.988 +- 0.114 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.1 all KL = 0.983 +- 0.114 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.1 all L1 = 0.988 +- 0.082 (in-sample avg dev_std = 0.118)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9138483754512636
len(reference) = 277
Effective ratio: 0.083 +- 0.079
Model Accuracy over intervened graphs for r=0.25 =  0.993
SUFF_SIMPLE for r=0.25 class 1.0 = 0.99 +- 0.097 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.25 all KL = 0.983 +- 0.097 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.25 all L1 = 0.99 +- 0.059 (in-sample avg dev_std = 0.136)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2486462093862816
len(reference) = 277
Effective ratio: 0.020 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.99
SUFF_SIMPLE for r=0.6 class 1.0 = 0.985 +- 0.125 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 all KL = 0.974 +- 0.125 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 all L1 = 0.985 +- 0.077 (in-sample avg dev_std = 0.169)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.762
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.6796630952380952
len(reference) = 2520
Effective ratio: 0.082 +- 0.024
Model Accuracy over intervened graphs for r=0.01 =  0.686
SUFF_SIMPLE for r=0.01 class 1.0 = 0.893 +- 0.260 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.01 all KL = 0.872 +- 0.260 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.01 all L1 = 0.893 +- 0.195 (in-sample avg dev_std = 0.310)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9326305555555555
len(reference) = 2520
Effective ratio: 0.016 +- 0.004
Model Accuracy over intervened graphs for r=0.1 =  0.694
SUFF_SIMPLE for r=0.1 class 1.0 = 0.9 +- 0.249 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.1 all KL = 0.882 +- 0.249 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.1 all L1 = 0.9 +- 0.187 (in-sample avg dev_std = 0.298)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.762
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9220797619047617
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.694
SUFF_SIMPLE for r=0.25 class 1.0 = 0.901 +- 0.247 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.25 all KL = 0.88 +- 0.247 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.25 all L1 = 0.901 +- 0.183 (in-sample avg dev_std = 0.309)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2460301587301587
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.696
SUFF_SIMPLE for r=0.6 class 1.0 = 0.903 +- 0.247 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.6 all KL = 0.884 +- 0.247 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.6 all L1 = 0.903 +- 0.184 (in-sample avg dev_std = 0.302)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9083071312803889
len(reference) = 2091
Effective ratio: 0.232 +- 0.368
Model Accuracy over intervened graphs for r=0.01 =  0.98
SUFF_SIMPLE for r=0.01 class 1.0 = 0.976 +- 0.161 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.01 all KL = 0.965 +- 0.161 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.01 all L1 = 0.976 +- 0.118 (in-sample avg dev_std = 0.159)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.993
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8995255267423015
len(reference) = 2253
Effective ratio: 0.175 +- 0.309
Model Accuracy over intervened graphs for r=0.1 =  0.981
SUFF_SIMPLE for r=0.1 class 1.0 = 0.975 +- 0.160 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.1 all KL = 0.964 +- 0.160 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.1 all L1 = 0.975 +- 0.113 (in-sample avg dev_std = 0.174)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.982
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8620251215559157
len(reference) = 2381
Effective ratio: 0.134 +- 0.256
Model Accuracy over intervened graphs for r=0.25 =  0.981
SUFF_SIMPLE for r=0.25 class 1.0 = 0.97 +- 0.171 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.25 all KL = 0.958 +- 0.171 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.25 all L1 = 0.97 +- 0.125 (in-sample avg dev_std = 0.180)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.977
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.27854457050243114
len(reference) = 2468
Effective ratio: 0.023 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.976
SUFF_SIMPLE for r=0.6 class 1.0 = 0.952 +- 0.219 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.6 all KL = 0.929 +- 0.219 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.6 all L1 = 0.952 +- 0.155 (in-sample avg dev_std = 0.254)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8683935018050543
len(reference) = 277
Effective ratio: 0.229 +- 0.163
Model Accuracy over intervened graphs for r=0.01 =  0.998
NEC for r=0.01 class 1.0 = 0.003 +- 0.062 (in-sample avg dev_std = 0.084)
NEC for r=0.01 all KL = 0.006 +- 0.062 (in-sample avg dev_std = 0.084)
NEC for r=0.01 all L1 = 0.003 +- 0.036 (in-sample avg dev_std = 0.084)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9756967509025269
len(reference) = 277
Effective ratio: 0.103 +- 0.096
Model Accuracy over intervened graphs for r=0.1 =  0.995
NEC for r=0.1 class 1.0 = 0.008 +- 0.096 (in-sample avg dev_std = 0.124)
NEC for r=0.1 all KL = 0.013 +- 0.096 (in-sample avg dev_std = 0.124)
NEC for r=0.1 all L1 = 0.008 +- 0.058 (in-sample avg dev_std = 0.124)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9138483754512636
len(reference) = 277
Effective ratio: 0.083 +- 0.079
Model Accuracy over intervened graphs for r=0.25 =  0.998
NEC for r=0.25 class 1.0 = 0.004 +- 0.061 (in-sample avg dev_std = 0.085)
NEC for r=0.25 all KL = 0.006 +- 0.061 (in-sample avg dev_std = 0.085)
NEC for r=0.25 all L1 = 0.004 +- 0.034 (in-sample avg dev_std = 0.085)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2486462093862816
len(reference) = 277
Effective ratio: 0.020 +- 0.017
Model Accuracy over intervened graphs for r=0.6 =  0.986
NEC for r=0.6 class 1.0 = 0.012 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.014 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.012 +- 0.102 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.762
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.6796630952380952
len(reference) = 2520
Effective ratio: 0.082 +- 0.024
Model Accuracy over intervened graphs for r=0.01 =  0.725
NEC for r=0.01 class 1.0 = 0.064 +- 0.197 (in-sample avg dev_std = 0.309)
NEC for r=0.01 all KL = 0.095 +- 0.197 (in-sample avg dev_std = 0.309)
NEC for r=0.01 all L1 = 0.064 +- 0.120 (in-sample avg dev_std = 0.309)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9326305555555555
len(reference) = 2520
Effective ratio: 0.016 +- 0.004
Model Accuracy over intervened graphs for r=0.1 =  0.021
NEC for r=0.1 class 1.0 = 0.717 +- 0.328 (in-sample avg dev_std = 0.191)
NEC for r=0.1 all KL = 0.773 +- 0.328 (in-sample avg dev_std = 0.191)
NEC for r=0.1 all L1 = 0.717 +- 0.225 (in-sample avg dev_std = 0.191)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.762
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9220797619047617
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.729 +- 0.326 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.78 +- 0.326 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.729 +- 0.221 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2460301587301587
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.748
NEC for r=0.6 class 1.0 = 0.014 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.014 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.014 +- 0.101 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.977
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9083071312803889
len(reference) = 2468
Effective ratio: 0.232 +- 0.368
Model Accuracy over intervened graphs for r=0.01 =  0.656
NEC for r=0.01 class 1.0 = 0.425 +- 0.349 (in-sample avg dev_std = 0.813)
NEC for r=0.01 all KL = 0.625 +- 0.349 (in-sample avg dev_std = 0.813)
NEC for r=0.01 all L1 = 0.425 +- 0.266 (in-sample avg dev_std = 0.813)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8995255267423015
len(reference) = 2468
Effective ratio: 0.175 +- 0.309
Model Accuracy over intervened graphs for r=0.1 =  0.397
NEC for r=0.1 class 1.0 = 0.594 +- 0.329 (in-sample avg dev_std = 0.615)
NEC for r=0.1 all KL = 0.763 +- 0.329 (in-sample avg dev_std = 0.615)
NEC for r=0.1 all L1 = 0.594 +- 0.301 (in-sample avg dev_std = 0.615)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.977
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8620251215559157
len(reference) = 2468
Effective ratio: 0.134 +- 0.256
Model Accuracy over intervened graphs for r=0.25 =  0.207
NEC for r=0.25 class 1.0 = 0.71 +- 0.312 (in-sample avg dev_std = 0.343)
NEC for r=0.25 all KL = 0.841 +- 0.312 (in-sample avg dev_std = 0.343)
NEC for r=0.25 all L1 = 0.71 +- 0.284 (in-sample avg dev_std = 0.343)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.977
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.27854457050243114
len(reference) = 2468
Effective ratio: 0.023 +- 0.038
Model Accuracy over intervened graphs for r=0.6 =  0.878
NEC for r=0.6 class 1.0 = 0.107 +- 0.313 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.12 +- 0.313 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.107 +- 0.271 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 03:13:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 03:13:53 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 03:13:53 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 03:13:53 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 03:13:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:13:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:13:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:13:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:13:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:13:53 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 03:13:53 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.972
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.992
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.988
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.782
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.930
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.985
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.994
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.814
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.945
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.942
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.914
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.775


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.971956678700361
len(reference) = 275
Effective ratio: 0.153 +- 0.134
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9921046931407942
len(reference) = 277
Effective ratio: 0.095 +- 0.084
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9875992779783394
len(reference) = 277
Effective ratio: 0.089 +- 0.077
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7816353790613718
len(reference) = 277
Effective ratio: 0.060 +- 0.055
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.891
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9297126984126985
len(reference) = 2520
Effective ratio: 0.035 +- 0.011
Model Accuracy over intervened graphs for r=0.01 =  0.891
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.001 (in-sample avg dev_std = 0.001)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9846265873015873
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.891
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.001 (in-sample avg dev_std = 0.001)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.891
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9937595238095238
len(reference) = 2520
Effective ratio: 0.013 +- 0.002
Model Accuracy over intervened graphs for r=0.25 =  0.891
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.001 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.001 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.001 (in-sample avg dev_std = 0.001)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8141019841269842
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.891
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.001 (in-sample avg dev_std = 0.002)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9452820097244733
len(reference) = 2132
Effective ratio: 0.211 +- 0.349
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9417666126418153
len(reference) = 2279
Effective ratio: 0.162 +- 0.290
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9144080226904376
len(reference) = 2367
Effective ratio: 0.130 +- 0.242
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7754542139384117
len(reference) = 2457
Effective ratio: 0.087 +- 0.163
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.971956678700361
len(reference) = 277
Effective ratio: 0.153 +- 0.134
Model Accuracy over intervened graphs for r=0.01 =  0.976
NEC for r=0.01 class 1.0 = 0.037 +- 0.227 (in-sample avg dev_std = 0.277)
NEC for r=0.01 all KL = 0.076 +- 0.227 (in-sample avg dev_std = 0.277)
NEC for r=0.01 all L1 = 0.037 +- 0.116 (in-sample avg dev_std = 0.277)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9921046931407942
len(reference) = 277
Effective ratio: 0.095 +- 0.084
Model Accuracy over intervened graphs for r=0.1 =  0.962
NEC for r=0.1 class 1.0 = 0.052 +- 0.270 (in-sample avg dev_std = 0.319)
NEC for r=0.1 all KL = 0.093 +- 0.270 (in-sample avg dev_std = 0.319)
NEC for r=0.1 all L1 = 0.052 +- 0.157 (in-sample avg dev_std = 0.319)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9875992779783394
len(reference) = 277
Effective ratio: 0.089 +- 0.077
Model Accuracy over intervened graphs for r=0.25 =  0.959
NEC for r=0.25 class 1.0 = 0.057 +- 0.280 (in-sample avg dev_std = 0.334)
NEC for r=0.25 all KL = 0.101 +- 0.280 (in-sample avg dev_std = 0.334)
NEC for r=0.25 all L1 = 0.057 +- 0.163 (in-sample avg dev_std = 0.334)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7816353790613718
len(reference) = 277
Effective ratio: 0.060 +- 0.055
Model Accuracy over intervened graphs for r=0.6 =  0.923
NEC for r=0.6 class 1.0 = 0.079 +- 0.303 (in-sample avg dev_std = 0.251)
NEC for r=0.6 all KL = 0.112 +- 0.303 (in-sample avg dev_std = 0.251)
NEC for r=0.6 all L1 = 0.079 +- 0.225 (in-sample avg dev_std = 0.251)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.891
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9297126984126985
len(reference) = 2520
Effective ratio: 0.035 +- 0.011
Model Accuracy over intervened graphs for r=0.01 =  0.745
NEC for r=0.01 class 1.0 = 0.183 +- 0.369 (in-sample avg dev_std = 0.511)
NEC for r=0.01 all KL = 0.29 +- 0.369 (in-sample avg dev_std = 0.511)
NEC for r=0.01 all L1 = 0.183 +- 0.243 (in-sample avg dev_std = 0.511)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9846265873015873
len(reference) = 2520
Effective ratio: 0.014 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.007
NEC for r=0.1 class 1.0 = 0.798 +- 0.225 (in-sample avg dev_std = 0.107)
NEC for r=0.1 all KL = 0.872 +- 0.225 (in-sample avg dev_std = 0.107)
NEC for r=0.1 all L1 = 0.798 +- 0.131 (in-sample avg dev_std = 0.107)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.891
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9937595238095238
len(reference) = 2520
Effective ratio: 0.013 +- 0.002
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.802 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.874 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.802 +- 0.124 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8141019841269842
len(reference) = 2520
Effective ratio: 0.009 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.365
NEC for r=0.6 class 1.0 = 0.489 +- 0.451 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.525 +- 0.451 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.489 +- 0.383 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9452820097244733
len(reference) = 2468
Effective ratio: 0.211 +- 0.349
Model Accuracy over intervened graphs for r=0.01 =  0.703
NEC for r=0.01 class 1.0 = 0.387 +- 0.385 (in-sample avg dev_std = 0.832)
NEC for r=0.01 all KL = 0.651 +- 0.385 (in-sample avg dev_std = 0.832)
NEC for r=0.01 all L1 = 0.387 +- 0.263 (in-sample avg dev_std = 0.832)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9417666126418153
len(reference) = 2468
Effective ratio: 0.162 +- 0.290
Model Accuracy over intervened graphs for r=0.1 =  0.533
NEC for r=0.1 class 1.0 = 0.508 +- 0.357 (in-sample avg dev_std = 0.744)
NEC for r=0.1 all KL = 0.748 +- 0.357 (in-sample avg dev_std = 0.744)
NEC for r=0.1 all L1 = 0.508 +- 0.298 (in-sample avg dev_std = 0.744)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9144080226904376
len(reference) = 2468
Effective ratio: 0.130 +- 0.242
Model Accuracy over intervened graphs for r=0.25 =  0.334
NEC for r=0.25 class 1.0 = 0.632 +- 0.338 (in-sample avg dev_std = 0.543)
NEC for r=0.25 all KL = 0.818 +- 0.338 (in-sample avg dev_std = 0.543)
NEC for r=0.25 all L1 = 0.632 +- 0.311 (in-sample avg dev_std = 0.543)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7754542139384117
len(reference) = 2468
Effective ratio: 0.087 +- 0.163
Model Accuracy over intervened graphs for r=0.6 =  0.199
NEC for r=0.6 class 1.0 = 0.698 +- 0.384 (in-sample avg dev_std = 0.066)
NEC for r=0.6 all KL = 0.81 +- 0.384 (in-sample avg dev_std = 0.066)
NEC for r=0.6 all L1 = 0.698 +- 0.334 (in-sample avg dev_std = 0.066)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 03:19:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 03:19:42 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 03:19:42 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 03:19:42 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 03:19:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:19:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:19:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:19:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:19:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:19:42 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 03:19:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.805
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.919
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.981
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.790
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.783
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.934
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.976
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.816
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.891
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.894
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.894
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.842


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8053718411552346
len(reference) = 252
Effective ratio: 0.415 +- 0.281
Model Accuracy over intervened graphs for r=0.01 =  0.999
SUFF_SIMPLE for r=0.01 class 1.0 = 0.997 +- 0.067 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.01 all KL = 0.994 +- 0.067 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.01 all L1 = 0.997 +- 0.032 (in-sample avg dev_std = 0.073)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9186462093862816
len(reference) = 272
Effective ratio: 0.159 +- 0.187
Model Accuracy over intervened graphs for r=0.1 =  0.993
SUFF_SIMPLE for r=0.1 class 1.0 = 0.991 +- 0.105 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.1 all KL = 0.987 +- 0.105 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.1 all L1 = 0.991 +- 0.075 (in-sample avg dev_std = 0.113)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9812202166064982
len(reference) = 276
Effective ratio: 0.103 +- 0.116
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 0.999 +- 0.031 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.25 all KL = 0.998 +- 0.031 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.25 all L1 = 0.999 +- 0.013 (in-sample avg dev_std = 0.042)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7898808664259929
len(reference) = 277
Effective ratio: 0.057 +- 0.051
Model Accuracy over intervened graphs for r=0.6 =  0.997
SUFF_SIMPLE for r=0.6 class 1.0 = 0.995 +- 0.080 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.6 all KL = 0.99 +- 0.080 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.6 all L1 = 0.995 +- 0.043 (in-sample avg dev_std = 0.097)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.94
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7831559523809524
len(reference) = 2520
Effective ratio: 0.080 +- 0.024
Model Accuracy over intervened graphs for r=0.01 =  0.937
SUFF_SIMPLE for r=0.01 class 1.0 = 0.997 +- 0.061 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.01 all KL = 0.995 +- 0.061 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.01 all L1 = 0.997 +- 0.044 (in-sample avg dev_std = 0.064)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9343480158730157
len(reference) = 2520
Effective ratio: 0.018 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.937
SUFF_SIMPLE for r=0.1 class 1.0 = 0.997 +- 0.054 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.1 all KL = 0.996 +- 0.054 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.1 all L1 = 0.997 +- 0.037 (in-sample avg dev_std = 0.060)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.94
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9764575396825398
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.937
SUFF_SIMPLE for r=0.25 class 1.0 = 0.996 +- 0.062 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.25 all KL = 0.995 +- 0.062 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.25 all L1 = 0.996 +- 0.044 (in-sample avg dev_std = 0.066)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8164583333333333
len(reference) = 2520
Effective ratio: 0.008 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.938
SUFF_SIMPLE for r=0.6 class 1.0 = 0.997 +- 0.056 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.6 all KL = 0.996 +- 0.056 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.6 all L1 = 0.997 +- 0.038 (in-sample avg dev_std = 0.062)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8909145056726094
len(reference) = 1937
Effective ratio: 0.282 +- 0.408
Model Accuracy over intervened graphs for r=0.01 =  0.995
SUFF_SIMPLE for r=0.01 class 1.0 = 0.995 +- 0.078 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.01 all KL = 0.993 +- 0.078 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.01 all L1 = 0.995 +- 0.057 (in-sample avg dev_std = 0.065)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8942106969205834
len(reference) = 2093
Effective ratio: 0.224 +- 0.366
Model Accuracy over intervened graphs for r=0.1 =  0.983
SUFF_SIMPLE for r=0.1 class 1.0 = 0.982 +- 0.152 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.1 all KL = 0.972 +- 0.152 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.1 all L1 = 0.982 +- 0.107 (in-sample avg dev_std = 0.143)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.991
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8938026742301458
len(reference) = 2208
Effective ratio: 0.179 +- 0.322
Model Accuracy over intervened graphs for r=0.25 =  0.98
SUFF_SIMPLE for r=0.25 class 1.0 = 0.977 +- 0.170 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.25 all KL = 0.963 +- 0.170 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.25 all L1 = 0.977 +- 0.113 (in-sample avg dev_std = 0.174)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.982
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8421628849270667
len(reference) = 2460
Effective ratio: 0.078 +- 0.144
Model Accuracy over intervened graphs for r=0.6 =  0.989
SUFF_SIMPLE for r=0.6 class 1.0 = 0.974 +- 0.179 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.6 all KL = 0.96 +- 0.179 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.6 all L1 = 0.974 +- 0.129 (in-sample avg dev_std = 0.167)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8053718411552346
len(reference) = 277
Effective ratio: 0.415 +- 0.281
Model Accuracy over intervened graphs for r=0.01 =  1.0
NEC for r=0.01 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9186462093862816
len(reference) = 277
Effective ratio: 0.159 +- 0.187
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9812202166064982
len(reference) = 277
Effective ratio: 0.103 +- 0.116
Model Accuracy over intervened graphs for r=0.25 =  1.0
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7898808664259929
len(reference) = 277
Effective ratio: 0.057 +- 0.051
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.94
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7831559523809524
len(reference) = 2520
Effective ratio: 0.080 +- 0.024
Model Accuracy over intervened graphs for r=0.01 =  0.927
NEC for r=0.01 class 1.0 = 0.02 +- 0.145 (in-sample avg dev_std = 0.202)
NEC for r=0.01 all KL = 0.041 +- 0.145 (in-sample avg dev_std = 0.202)
NEC for r=0.01 all L1 = 0.02 +- 0.071 (in-sample avg dev_std = 0.202)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9343480158730157
len(reference) = 2520
Effective ratio: 0.018 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.157
NEC for r=0.1 class 1.0 = 0.722 +- 0.253 (in-sample avg dev_std = 0.441)
NEC for r=0.1 all KL = 0.84 +- 0.253 (in-sample avg dev_std = 0.441)
NEC for r=0.1 all L1 = 0.722 +- 0.215 (in-sample avg dev_std = 0.441)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.94
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9764575396825398
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.824 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.907 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.824 +- 0.084 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8164583333333333
len(reference) = 2520
Effective ratio: 0.008 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.193
NEC for r=0.6 class 1.0 = 0.655 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.72 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.655 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.982
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8909145056726094
len(reference) = 2468
Effective ratio: 0.282 +- 0.408
Model Accuracy over intervened graphs for r=0.01 =  0.707
NEC for r=0.01 class 1.0 = 0.378 +- 0.391 (in-sample avg dev_std = 0.809)
NEC for r=0.01 all KL = 0.619 +- 0.391 (in-sample avg dev_std = 0.809)
NEC for r=0.01 all L1 = 0.378 +- 0.270 (in-sample avg dev_std = 0.809)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8942106969205834
len(reference) = 2468
Effective ratio: 0.224 +- 0.366
Model Accuracy over intervened graphs for r=0.1 =  0.481
NEC for r=0.1 class 1.0 = 0.528 +- 0.376 (in-sample avg dev_std = 0.640)
NEC for r=0.1 all KL = 0.728 +- 0.376 (in-sample avg dev_std = 0.640)
NEC for r=0.1 all L1 = 0.528 +- 0.326 (in-sample avg dev_std = 0.640)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.982
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.8938026742301458
len(reference) = 2468
Effective ratio: 0.179 +- 0.322
Model Accuracy over intervened graphs for r=0.25 =  0.314
NEC for r=0.25 class 1.0 = 0.64 +- 0.348 (in-sample avg dev_std = 0.485)
NEC for r=0.25 all KL = 0.808 +- 0.348 (in-sample avg dev_std = 0.485)
NEC for r=0.25 all L1 = 0.64 +- 0.319 (in-sample avg dev_std = 0.485)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.982
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8421628849270667
len(reference) = 2468
Effective ratio: 0.078 +- 0.144
Model Accuracy over intervened graphs for r=0.6 =  0.159
NEC for r=0.6 class 1.0 = 0.714 +- 0.374 (in-sample avg dev_std = 0.014)
NEC for r=0.6 all KL = 0.826 +- 0.374 (in-sample avg dev_std = 0.014)
NEC for r=0.6 all L1 = 0.714 +- 0.324 (in-sample avg dev_std = 0.014)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 03:24:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 03:24:13 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 03:24:13 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 03:24:13 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 03:24:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:24:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:24:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:24:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:24:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:24:13 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 03:24:13 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.919
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.980
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.968
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.952
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.948
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.995
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.989
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.953
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.925
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.932
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.937
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.944


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9191913357400723
len(reference) = 261
Effective ratio: 0.297 +- 0.254
Model Accuracy over intervened graphs for r=0.01 =  0.986
SUFF_SIMPLE for r=0.01 class 1.0 = 0.985 +- 0.142 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.01 all KL = 0.976 +- 0.142 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.01 all L1 = 0.985 +- 0.098 (in-sample avg dev_std = 0.126)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9802851985559566
len(reference) = 276
Effective ratio: 0.103 +- 0.133
Model Accuracy over intervened graphs for r=0.1 =  0.992
SUFF_SIMPLE for r=0.1 class 1.0 = 0.988 +- 0.128 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.1 all KL = 0.977 +- 0.128 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.1 all L1 = 0.988 +- 0.071 (in-sample avg dev_std = 0.155)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9677581227436821
len(reference) = 277
Effective ratio: 0.075 +- 0.070
Model Accuracy over intervened graphs for r=0.25 =  0.992
SUFF_SIMPLE for r=0.25 class 1.0 = 0.988 +- 0.123 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.25 all KL = 0.977 +- 0.123 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.25 all L1 = 0.988 +- 0.070 (in-sample avg dev_std = 0.150)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9522021660649819
len(reference) = 277
Effective ratio: 0.070 +- 0.054
Model Accuracy over intervened graphs for r=0.6 =  0.995
SUFF_SIMPLE for r=0.6 class 1.0 = 0.991 +- 0.105 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.6 all KL = 0.982 +- 0.105 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.6 all L1 = 0.991 +- 0.054 (in-sample avg dev_std = 0.131)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9475535714285714
len(reference) = 2520
Effective ratio: 0.041 +- 0.014
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 0.999 +- 0.033 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.01 all KL = 0.998 +- 0.033 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.01 all L1 = 0.999 +- 0.014 (in-sample avg dev_std = 0.042)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9951130952380952
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.999
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.039 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.1 all KL = 0.997 +- 0.039 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.1 all L1 = 0.999 +- 0.016 (in-sample avg dev_std = 0.050)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9889357142857143
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 0.999 +- 0.024 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.25 all KL = 0.999 +- 0.024 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.25 all L1 = 0.999 +- 0.012 (in-sample avg dev_std = 0.034)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9528603174603175
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 0.999 +- 0.028 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.6 all KL = 0.999 +- 0.028 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.6 all L1 = 0.999 +- 0.013 (in-sample avg dev_std = 0.034)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.996
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9245494327390598
len(reference) = 2044
Effective ratio: 0.256 +- 0.389
Model Accuracy over intervened graphs for r=0.01 =  0.967
SUFF_SIMPLE for r=0.01 class 1.0 = 0.968 +- 0.196 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.01 all KL = 0.957 +- 0.196 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.01 all L1 = 0.968 +- 0.149 (in-sample avg dev_std = 0.156)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9322435170178283
len(reference) = 2238
Effective ratio: 0.180 +- 0.324
Model Accuracy over intervened graphs for r=0.1 =  0.971
SUFF_SIMPLE for r=0.1 class 1.0 = 0.956 +- 0.230 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.1 all KL = 0.935 +- 0.230 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.1 all L1 = 0.956 +- 0.166 (in-sample avg dev_std = 0.220)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.966
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9367629659643436
len(reference) = 2434
Effective ratio: 0.119 +- 0.225
Model Accuracy over intervened graphs for r=0.25 =  0.971
SUFF_SIMPLE for r=0.25 class 1.0 = 0.954 +- 0.234 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.25 all KL = 0.932 +- 0.234 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.25 all L1 = 0.954 +- 0.169 (in-sample avg dev_std = 0.231)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.966
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9444355753646678
len(reference) = 2458
Effective ratio: 0.086 +- 0.154
Model Accuracy over intervened graphs for r=0.6 =  0.977
SUFF_SIMPLE for r=0.6 class 1.0 = 0.952 +- 0.237 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.6 all KL = 0.931 +- 0.237 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.6 all L1 = 0.952 +- 0.176 (in-sample avg dev_std = 0.222)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9191913357400723
len(reference) = 277
Effective ratio: 0.297 +- 0.254
Model Accuracy over intervened graphs for r=0.01 =  0.986
NEC for r=0.01 class 1.0 = 0.022 +- 0.174 (in-sample avg dev_std = 0.212)
NEC for r=0.01 all KL = 0.046 +- 0.174 (in-sample avg dev_std = 0.212)
NEC for r=0.01 all L1 = 0.022 +- 0.086 (in-sample avg dev_std = 0.212)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9802851985559566
len(reference) = 277
Effective ratio: 0.103 +- 0.133
Model Accuracy over intervened graphs for r=0.1 =  0.963
NEC for r=0.1 class 1.0 = 0.053 +- 0.258 (in-sample avg dev_std = 0.315)
NEC for r=0.1 all KL = 0.099 +- 0.258 (in-sample avg dev_std = 0.315)
NEC for r=0.1 all L1 = 0.053 +- 0.148 (in-sample avg dev_std = 0.315)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9677581227436821
len(reference) = 277
Effective ratio: 0.075 +- 0.070
Model Accuracy over intervened graphs for r=0.25 =  0.93
NEC for r=0.25 class 1.0 = 0.088 +- 0.324 (in-sample avg dev_std = 0.360)
NEC for r=0.25 all KL = 0.143 +- 0.324 (in-sample avg dev_std = 0.360)
NEC for r=0.25 all L1 = 0.088 +- 0.209 (in-sample avg dev_std = 0.360)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9522021660649819
len(reference) = 277
Effective ratio: 0.070 +- 0.054
Model Accuracy over intervened graphs for r=0.6 =  0.929
NEC for r=0.6 class 1.0 = 0.086 +- 0.320 (in-sample avg dev_std = 0.348)
NEC for r=0.6 all KL = 0.141 +- 0.320 (in-sample avg dev_std = 0.348)
NEC for r=0.6 all L1 = 0.086 +- 0.209 (in-sample avg dev_std = 0.348)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9475535714285714
len(reference) = 2520
Effective ratio: 0.041 +- 0.014
Model Accuracy over intervened graphs for r=0.01 =  0.818
NEC for r=0.01 class 1.0 = 0.239 +- 0.365 (in-sample avg dev_std = 0.637)
NEC for r=0.01 all KL = 0.39 +- 0.365 (in-sample avg dev_std = 0.637)
NEC for r=0.01 all L1 = 0.239 +- 0.242 (in-sample avg dev_std = 0.637)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9951130952380952
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.849 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.955 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.849 +- 0.031 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9889357142857143
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.849 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.955 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.849 +- 0.031 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9528603174603175
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.849 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.955 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.849 +- 0.031 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.966
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9245494327390598
len(reference) = 2468
Effective ratio: 0.256 +- 0.389
Model Accuracy over intervened graphs for r=0.01 =  0.464
NEC for r=0.01 class 1.0 = 0.556 +- 0.321 (in-sample avg dev_std = 0.716)
NEC for r=0.01 all KL = 0.788 +- 0.321 (in-sample avg dev_std = 0.716)
NEC for r=0.01 all L1 = 0.556 +- 0.291 (in-sample avg dev_std = 0.716)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.966
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9322435170178283
len(reference) = 2468
Effective ratio: 0.180 +- 0.324
Model Accuracy over intervened graphs for r=0.1 =  0.211
NEC for r=0.1 class 1.0 = 0.711 +- 0.279 (in-sample avg dev_std = 0.453)
NEC for r=0.1 all KL = 0.879 +- 0.279 (in-sample avg dev_std = 0.453)
NEC for r=0.1 all L1 = 0.711 +- 0.271 (in-sample avg dev_std = 0.453)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.966
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9367629659643436
len(reference) = 2468
Effective ratio: 0.119 +- 0.225
Model Accuracy over intervened graphs for r=0.25 =  0.131
NEC for r=0.25 class 1.0 = 0.745 +- 0.296 (in-sample avg dev_std = 0.293)
NEC for r=0.25 all KL = 0.885 +- 0.296 (in-sample avg dev_std = 0.293)
NEC for r=0.25 all L1 = 0.745 +- 0.270 (in-sample avg dev_std = 0.293)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.966
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9444355753646678
len(reference) = 2468
Effective ratio: 0.086 +- 0.154
Model Accuracy over intervened graphs for r=0.6 =  0.052
NEC for r=0.6 class 1.0 = 0.792 +- 0.268 (in-sample avg dev_std = 0.098)
NEC for r=0.6 all KL = 0.917 +- 0.268 (in-sample avg dev_std = 0.098)
NEC for r=0.6 all L1 = 0.792 +- 0.233 (in-sample avg dev_std = 0.098)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 03:29:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 03:29:20 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 03:29:20 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 03:29:20 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 03:29:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:29:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:29:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:29:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:29:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:29:20 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 03:29:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.722
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.838
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.966
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.888
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.511
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.679
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.924
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.914
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.887
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.894
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.893
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.879


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7215162454873647
len(reference) = 252
Effective ratio: 0.516 +- 0.237
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 0.999 +- 0.030 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.01 all KL = 0.998 +- 0.030 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.01 all L1 = 0.999 +- 0.014 (in-sample avg dev_std = 0.044)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8380541516245488
len(reference) = 272
Effective ratio: 0.196 +- 0.183
Model Accuracy over intervened graphs for r=0.1 =  0.991
SUFF_SIMPLE for r=0.1 class 1.0 = 0.989 +- 0.116 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.1 all KL = 0.982 +- 0.116 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.1 all L1 = 0.989 +- 0.078 (in-sample avg dev_std = 0.127)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9659061371841154
len(reference) = 276
Effective ratio: 0.108 +- 0.111
Model Accuracy over intervened graphs for r=0.25 =  0.996
SUFF_SIMPLE for r=0.25 class 1.0 = 0.994 +- 0.085 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.25 all KL = 0.99 +- 0.085 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.25 all L1 = 0.994 +- 0.046 (in-sample avg dev_std = 0.109)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8875487364620939
len(reference) = 277
Effective ratio: 0.072 +- 0.062
Model Accuracy over intervened graphs for r=0.6 =  0.997
SUFF_SIMPLE for r=0.6 class 1.0 = 0.995 +- 0.078 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.6 all KL = 0.99 +- 0.078 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.6 all L1 = 0.995 +- 0.040 (in-sample avg dev_std = 0.106)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.638
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.5114269841269842
len(reference) = 2520
Effective ratio: 0.203 +- 0.052
Model Accuracy over intervened graphs for r=0.01 =  0.481
SUFF_SIMPLE for r=0.01 class 1.0 = 0.826 +- 0.371 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.01 all KL = 0.779 +- 0.371 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.01 all L1 = 0.826 +- 0.296 (in-sample avg dev_std = 0.386)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6792698412698414
len(reference) = 2520
Effective ratio: 0.047 +- 0.015
Model Accuracy over intervened graphs for r=0.1 =  0.506
SUFF_SIMPLE for r=0.1 class 1.0 = 0.849 +- 0.350 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.1 all KL = 0.805 +- 0.350 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.1 all L1 = 0.849 +- 0.276 (in-sample avg dev_std = 0.382)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.638
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9241452380952381
len(reference) = 2520
Effective ratio: 0.016 +- 0.004
Model Accuracy over intervened graphs for r=0.25 =  0.516
SUFF_SIMPLE for r=0.25 class 1.0 = 0.859 +- 0.342 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.25 all KL = 0.817 +- 0.342 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.25 all L1 = 0.859 +- 0.268 (in-sample avg dev_std = 0.375)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.638
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9141051587301587
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.52
SUFF_SIMPLE for r=0.6 class 1.0 = 0.861 +- 0.339 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.6 all KL = 0.819 +- 0.339 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.6 all L1 = 0.861 +- 0.265 (in-sample avg dev_std = 0.373)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8865717179902756
len(reference) = 1932
Effective ratio: 0.295 +- 0.412
Model Accuracy over intervened graphs for r=0.01 =  0.997
SUFF_SIMPLE for r=0.01 class 1.0 = 0.997 +- 0.066 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.01 all KL = 0.995 +- 0.066 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.01 all L1 = 0.997 +- 0.045 (in-sample avg dev_std = 0.069)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8935611831442465
len(reference) = 2080
Effective ratio: 0.231 +- 0.371
Model Accuracy over intervened graphs for r=0.1 =  0.988
SUFF_SIMPLE for r=0.1 class 1.0 = 0.986 +- 0.126 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.1 all KL = 0.98 +- 0.126 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.1 all L1 = 0.986 +- 0.093 (in-sample avg dev_std = 0.120)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.997
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.893347244732577
len(reference) = 2199
Effective ratio: 0.186 +- 0.326
Model Accuracy over intervened graphs for r=0.25 =  0.987
SUFF_SIMPLE for r=0.25 class 1.0 = 0.986 +- 0.128 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.25 all KL = 0.977 +- 0.128 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.25 all L1 = 0.986 +- 0.084 (in-sample avg dev_std = 0.143)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8794254457050245
len(reference) = 2417
Effective ratio: 0.110 +- 0.216
Model Accuracy over intervened graphs for r=0.6 =  0.992
SUFF_SIMPLE for r=0.6 class 1.0 = 0.979 +- 0.155 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.6 all KL = 0.968 +- 0.155 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.6 all L1 = 0.979 +- 0.114 (in-sample avg dev_std = 0.148)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.7215162454873647
len(reference) = 277
Effective ratio: 0.516 +- 0.237
Model Accuracy over intervened graphs for r=0.01 =  0.999
NEC for r=0.01 class 1.0 = 0.002 +- 0.051 (in-sample avg dev_std = 0.061)
NEC for r=0.01 all KL = 0.003 +- 0.051 (in-sample avg dev_std = 0.061)
NEC for r=0.01 all L1 = 0.002 +- 0.031 (in-sample avg dev_std = 0.061)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8380541516245488
len(reference) = 277
Effective ratio: 0.196 +- 0.183
Model Accuracy over intervened graphs for r=0.1 =  0.997
NEC for r=0.1 class 1.0 = 0.004 +- 0.065 (in-sample avg dev_std = 0.085)
NEC for r=0.1 all KL = 0.006 +- 0.065 (in-sample avg dev_std = 0.085)
NEC for r=0.1 all L1 = 0.004 +- 0.037 (in-sample avg dev_std = 0.085)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9659061371841154
len(reference) = 277
Effective ratio: 0.108 +- 0.111
Model Accuracy over intervened graphs for r=0.25 =  0.995
NEC for r=0.25 class 1.0 = 0.007 +- 0.088 (in-sample avg dev_std = 0.116)
NEC for r=0.25 all KL = 0.012 +- 0.088 (in-sample avg dev_std = 0.116)
NEC for r=0.25 all L1 = 0.007 +- 0.051 (in-sample avg dev_std = 0.116)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8875487364620939
len(reference) = 277
Effective ratio: 0.072 +- 0.062
Model Accuracy over intervened graphs for r=0.6 =  0.988
NEC for r=0.6 class 1.0 = 0.013 +- 0.121 (in-sample avg dev_std = 0.131)
NEC for r=0.6 all KL = 0.018 +- 0.121 (in-sample avg dev_std = 0.131)
NEC for r=0.6 all L1 = 0.013 +- 0.087 (in-sample avg dev_std = 0.131)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.638
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.5114269841269842
len(reference) = 2520
Effective ratio: 0.203 +- 0.052
Model Accuracy over intervened graphs for r=0.01 =  0.58
NEC for r=0.01 class 1.0 = 0.093 +- 0.268 (in-sample avg dev_std = 0.400)
NEC for r=0.01 all KL = 0.146 +- 0.268 (in-sample avg dev_std = 0.400)
NEC for r=0.01 all L1 = 0.093 +- 0.176 (in-sample avg dev_std = 0.400)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6792698412698414
len(reference) = 2520
Effective ratio: 0.047 +- 0.015
Model Accuracy over intervened graphs for r=0.1 =  0.394
NEC for r=0.1 class 1.0 = 0.319 +- 0.396 (in-sample avg dev_std = 0.682)
NEC for r=0.1 all KL = 0.452 +- 0.396 (in-sample avg dev_std = 0.682)
NEC for r=0.1 all L1 = 0.319 +- 0.290 (in-sample avg dev_std = 0.682)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.638
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9241452380952381
len(reference) = 2520
Effective ratio: 0.016 +- 0.004
Model Accuracy over intervened graphs for r=0.25 =  0.001
NEC for r=0.25 class 1.0 = 0.569 +- 0.455 (in-sample avg dev_std = 0.051)
NEC for r=0.25 all KL = 0.636 +- 0.455 (in-sample avg dev_std = 0.051)
NEC for r=0.25 all L1 = 0.569 +- 0.385 (in-sample avg dev_std = 0.051)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.638
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9141051587301587
len(reference) = 2520
Effective ratio: 0.011 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.569 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.636 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.569 +- 0.385 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.987
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.8865717179902756
len(reference) = 2468
Effective ratio: 0.295 +- 0.412
Model Accuracy over intervened graphs for r=0.01 =  0.714
NEC for r=0.01 class 1.0 = 0.367 +- 0.371 (in-sample avg dev_std = 0.805)
NEC for r=0.01 all KL = 0.572 +- 0.371 (in-sample avg dev_std = 0.805)
NEC for r=0.01 all L1 = 0.367 +- 0.263 (in-sample avg dev_std = 0.805)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8935611831442465
len(reference) = 2468
Effective ratio: 0.231 +- 0.371
Model Accuracy over intervened graphs for r=0.1 =  0.511
NEC for r=0.1 class 1.0 = 0.509 +- 0.355 (in-sample avg dev_std = 0.683)
NEC for r=0.1 all KL = 0.7 +- 0.355 (in-sample avg dev_std = 0.683)
NEC for r=0.1 all L1 = 0.509 +- 0.310 (in-sample avg dev_std = 0.683)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.987
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.893347244732577
len(reference) = 2468
Effective ratio: 0.186 +- 0.326
Model Accuracy over intervened graphs for r=0.25 =  0.338
NEC for r=0.25 class 1.0 = 0.625 +- 0.329 (in-sample avg dev_std = 0.547)
NEC for r=0.25 all KL = 0.793 +- 0.329 (in-sample avg dev_std = 0.547)
NEC for r=0.25 all L1 = 0.625 +- 0.307 (in-sample avg dev_std = 0.547)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8794254457050245
len(reference) = 2468
Effective ratio: 0.110 +- 0.216
Model Accuracy over intervened graphs for r=0.6 =  0.114
NEC for r=0.6 class 1.0 = 0.759 +- 0.296 (in-sample avg dev_std = 0.187)
NEC for r=0.6 all KL = 0.884 +- 0.296 (in-sample avg dev_std = 0.187)
NEC for r=0.6 all L1 = 0.759 +- 0.264 (in-sample avg dev_std = 0.187)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 03:34:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 03:34:52 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 03:34:52 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 03:34:52 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 03:34:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:34:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:34:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:34:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:34:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:34:52 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 03:34:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.984
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.990
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.987
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.974
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.978
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.994
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.993
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.984
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.955
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.954
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.954
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.941


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9839819494584837
len(reference) = 276
Effective ratio: 0.123 +- 0.102
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9896895306859206
len(reference) = 276
Effective ratio: 0.095 +- 0.095
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9865451263537907
len(reference) = 276
Effective ratio: 0.092 +- 0.095
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9738989169675092
len(reference) = 276
Effective ratio: 0.089 +- 0.090
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.731
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9777166666666667
len(reference) = 2520
Effective ratio: 0.022 +- 0.007
Model Accuracy over intervened graphs for r=0.01 =  0.731
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9936079365079364
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.731
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.731
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9926206349206349
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.731
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.731
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9842785714285712
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.731
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.954978525121556
len(reference) = 2236
Effective ratio: 0.181 +- 0.312
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9542390599675851
len(reference) = 2336
Effective ratio: 0.142 +- 0.261
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9541871961102106
len(reference) = 2433
Effective ratio: 0.129 +- 0.234
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9410628038897891
len(reference) = 2443
Effective ratio: 0.121 +- 0.219
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9839819494584837
len(reference) = 277
Effective ratio: 0.123 +- 0.102
Model Accuracy over intervened graphs for r=0.01 =  0.954
NEC for r=0.01 class 1.0 = 0.071 +- 0.263 (in-sample avg dev_std = 0.386)
NEC for r=0.01 all KL = 0.129 +- 0.263 (in-sample avg dev_std = 0.386)
NEC for r=0.01 all L1 = 0.071 +- 0.150 (in-sample avg dev_std = 0.386)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9896895306859206
len(reference) = 277
Effective ratio: 0.095 +- 0.095
Model Accuracy over intervened graphs for r=0.1 =  0.921
NEC for r=0.1 class 1.0 = 0.109 +- 0.325 (in-sample avg dev_std = 0.455)
NEC for r=0.1 all KL = 0.178 +- 0.325 (in-sample avg dev_std = 0.455)
NEC for r=0.1 all L1 = 0.109 +- 0.208 (in-sample avg dev_std = 0.455)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9865451263537907
len(reference) = 277
Effective ratio: 0.092 +- 0.095
Model Accuracy over intervened graphs for r=0.25 =  0.927
NEC for r=0.25 class 1.0 = 0.105 +- 0.317 (in-sample avg dev_std = 0.456)
NEC for r=0.25 all KL = 0.176 +- 0.317 (in-sample avg dev_std = 0.456)
NEC for r=0.25 all L1 = 0.105 +- 0.196 (in-sample avg dev_std = 0.456)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9738989169675092
len(reference) = 277
Effective ratio: 0.089 +- 0.090
Model Accuracy over intervened graphs for r=0.6 =  0.916
NEC for r=0.6 class 1.0 = 0.116 +- 0.332 (in-sample avg dev_std = 0.472)
NEC for r=0.6 all KL = 0.19 +- 0.332 (in-sample avg dev_std = 0.472)
NEC for r=0.6 all L1 = 0.116 +- 0.212 (in-sample avg dev_std = 0.472)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.731
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9777166666666667
len(reference) = 2520
Effective ratio: 0.022 +- 0.007
Model Accuracy over intervened graphs for r=0.01 =  0.098
NEC for r=0.01 class 1.0 = 0.647 +- 0.364 (in-sample avg dev_std = 0.462)
NEC for r=0.01 all KL = 0.73 +- 0.364 (in-sample avg dev_std = 0.462)
NEC for r=0.01 all L1 = 0.647 +- 0.269 (in-sample avg dev_std = 0.462)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9936079365079364
len(reference) = 2520
Effective ratio: 0.013 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.704 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.759 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.704 +- 0.259 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.731
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9926206349206349
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.704 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.759 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.704 +- 0.259 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.731
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9842785714285712
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.0
NEC for r=0.6 class 1.0 = 0.704 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.759 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.704 +- 0.259 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.954978525121556
len(reference) = 2468
Effective ratio: 0.181 +- 0.312
Model Accuracy over intervened graphs for r=0.01 =  0.183
NEC for r=0.01 class 1.0 = 0.731 +- 0.284 (in-sample avg dev_std = 0.371)
NEC for r=0.01 all KL = 0.87 +- 0.284 (in-sample avg dev_std = 0.371)
NEC for r=0.01 all L1 = 0.731 +- 0.267 (in-sample avg dev_std = 0.371)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9542390599675851
len(reference) = 2468
Effective ratio: 0.142 +- 0.261
Model Accuracy over intervened graphs for r=0.1 =  0.112
NEC for r=0.1 class 1.0 = 0.785 +- 0.211 (in-sample avg dev_std = 0.327)
NEC for r=0.1 all KL = 0.924 +- 0.211 (in-sample avg dev_std = 0.327)
NEC for r=0.1 all L1 = 0.785 +- 0.205 (in-sample avg dev_std = 0.327)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9541871961102106
len(reference) = 2468
Effective ratio: 0.129 +- 0.234
Model Accuracy over intervened graphs for r=0.25 =  0.084
NEC for r=0.25 class 1.0 = 0.806 +- 0.174 (in-sample avg dev_std = 0.301)
NEC for r=0.25 all KL = 0.944 +- 0.174 (in-sample avg dev_std = 0.301)
NEC for r=0.25 all L1 = 0.806 +- 0.173 (in-sample avg dev_std = 0.301)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9410628038897891
len(reference) = 2468
Effective ratio: 0.121 +- 0.219
Model Accuracy over intervened graphs for r=0.6 =  0.075
NEC for r=0.6 class 1.0 = 0.811 +- 0.169 (in-sample avg dev_std = 0.275)
NEC for r=0.6 all KL = 0.948 +- 0.169 (in-sample avg dev_std = 0.275)
NEC for r=0.6 all L1 = 0.811 +- 0.167 (in-sample avg dev_std = 0.275)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 03:39:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 03:39:45 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 03:39:45 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 03:39:45 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 03:39:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:39:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:39:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:39:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:39:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:39:45 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 03:39:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.883
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.968
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.982
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.915
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.564
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.801
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.972
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.896
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.923
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.924
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.915
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.900


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.882667870036101
len(reference) = 268
Effective ratio: 0.309 +- 0.208
Model Accuracy over intervened graphs for r=0.01 =  0.991
SUFF_SIMPLE for r=0.01 class 1.0 = 0.985 +- 0.146 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.01 all KL = 0.964 +- 0.146 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.01 all L1 = 0.985 +- 0.063 (in-sample avg dev_std = 0.169)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.968173285198556
len(reference) = 276
Effective ratio: 0.116 +- 0.117
Model Accuracy over intervened graphs for r=0.1 =  0.986
SUFF_SIMPLE for r=0.1 class 1.0 = 0.976 +- 0.179 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.1 all KL = 0.943 +- 0.179 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.1 all L1 = 0.976 +- 0.076 (in-sample avg dev_std = 0.215)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9815234657039711
len(reference) = 277
Effective ratio: 0.092 +- 0.087
Model Accuracy over intervened graphs for r=0.25 =  0.983
SUFF_SIMPLE for r=0.25 class 1.0 = 0.972 +- 0.193 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.25 all KL = 0.934 +- 0.193 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.25 all L1 = 0.972 +- 0.088 (in-sample avg dev_std = 0.231)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9152202166064982
len(reference) = 277
Effective ratio: 0.078 +- 0.075
Model Accuracy over intervened graphs for r=0.6 =  0.99
SUFF_SIMPLE for r=0.6 class 1.0 = 0.982 +- 0.159 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.6 all KL = 0.957 +- 0.159 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.6 all L1 = 0.982 +- 0.069 (in-sample avg dev_std = 0.188)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.768
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.5641690476190476
len(reference) = 2520
Effective ratio: 0.193 +- 0.055
Model Accuracy over intervened graphs for r=0.01 =  0.366
SUFF_SIMPLE for r=0.01 class 1.0 = 0.55 +- 0.356 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.01 all KL = 0.462 +- 0.356 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.01 all L1 = 0.55 +- 0.294 (in-sample avg dev_std = 0.435)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8012515873015873
len(reference) = 2520
Effective ratio: 0.033 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.366
SUFF_SIMPLE for r=0.1 class 1.0 = 0.547 +- 0.353 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.1 all KL = 0.456 +- 0.353 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.1 all L1 = 0.547 +- 0.292 (in-sample avg dev_std = 0.447)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.768
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9720202380952381
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.377
SUFF_SIMPLE for r=0.25 class 1.0 = 0.555 +- 0.350 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.25 all KL = 0.463 +- 0.350 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.25 all L1 = 0.555 +- 0.289 (in-sample avg dev_std = 0.461)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.768
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.895943253968254
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.388
SUFF_SIMPLE for r=0.6 class 1.0 = 0.557 +- 0.349 (in-sample avg dev_std = 0.478)
SUFF_SIMPLE for r=0.6 all KL = 0.464 +- 0.349 (in-sample avg dev_std = 0.478)
SUFF_SIMPLE for r=0.6 all L1 = 0.557 +- 0.285 (in-sample avg dev_std = 0.478)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.994
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9226758508914099
len(reference) = 2033
Effective ratio: 0.248 +- 0.383
Model Accuracy over intervened graphs for r=0.01 =  0.962
SUFF_SIMPLE for r=0.01 class 1.0 = 0.961 +- 0.217 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.01 all KL = 0.941 +- 0.217 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.01 all L1 = 0.961 +- 0.155 (in-sample avg dev_std = 0.188)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.985
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9243221231766612
len(reference) = 2174
Effective ratio: 0.193 +- 0.335
Model Accuracy over intervened graphs for r=0.1 =  0.934
SUFF_SIMPLE for r=0.1 class 1.0 = 0.927 +- 0.291 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.1 all KL = 0.888 +- 0.291 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.1 all L1 = 0.927 +- 0.203 (in-sample avg dev_std = 0.285)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.975
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9154955429497568
len(reference) = 2297
Effective ratio: 0.154 +- 0.288
Model Accuracy over intervened graphs for r=0.25 =  0.922
SUFF_SIMPLE for r=0.25 class 1.0 = 0.915 +- 0.312 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.25 all KL = 0.872 +- 0.312 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.25 all L1 = 0.915 +- 0.219 (in-sample avg dev_std = 0.307)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.962
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8997536466774715
len(reference) = 2397
Effective ratio: 0.117 +- 0.228
Model Accuracy over intervened graphs for r=0.6 =  0.918
SUFF_SIMPLE for r=0.6 class 1.0 = 0.917 +- 0.309 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.6 all KL = 0.87 +- 0.309 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.6 all L1 = 0.917 +- 0.208 (in-sample avg dev_std = 0.326)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.882667870036101
len(reference) = 277
Effective ratio: 0.309 +- 0.208
Model Accuracy over intervened graphs for r=0.01 =  0.969
NEC for r=0.01 class 1.0 = 0.049 +- 0.268 (in-sample avg dev_std = 0.325)
NEC for r=0.01 all KL = 0.111 +- 0.268 (in-sample avg dev_std = 0.325)
NEC for r=0.01 all L1 = 0.049 +- 0.124 (in-sample avg dev_std = 0.325)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.968173285198556
len(reference) = 277
Effective ratio: 0.116 +- 0.117
Model Accuracy over intervened graphs for r=0.1 =  0.936
NEC for r=0.1 class 1.0 = 0.097 +- 0.349 (in-sample avg dev_std = 0.450)
NEC for r=0.1 all KL = 0.205 +- 0.349 (in-sample avg dev_std = 0.450)
NEC for r=0.1 all L1 = 0.097 +- 0.176 (in-sample avg dev_std = 0.450)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9815234657039711
len(reference) = 277
Effective ratio: 0.092 +- 0.087
Model Accuracy over intervened graphs for r=0.25 =  0.916
NEC for r=0.25 class 1.0 = 0.123 +- 0.377 (in-sample avg dev_std = 0.497)
NEC for r=0.25 all KL = 0.242 +- 0.377 (in-sample avg dev_std = 0.497)
NEC for r=0.25 all L1 = 0.123 +- 0.205 (in-sample avg dev_std = 0.497)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.9152202166064982
len(reference) = 277
Effective ratio: 0.078 +- 0.075
Model Accuracy over intervened graphs for r=0.6 =  0.892
NEC for r=0.6 class 1.0 = 0.15 +- 0.405 (in-sample avg dev_std = 0.538)
NEC for r=0.6 all KL = 0.278 +- 0.405 (in-sample avg dev_std = 0.538)
NEC for r=0.6 all L1 = 0.15 +- 0.233 (in-sample avg dev_std = 0.538)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.768
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.5641690476190476
len(reference) = 2520
Effective ratio: 0.193 +- 0.055
Model Accuracy over intervened graphs for r=0.01 =  0.622
NEC for r=0.01 class 1.0 = 0.324 +- 0.286 (in-sample avg dev_std = 0.581)
NEC for r=0.01 all KL = 0.413 +- 0.286 (in-sample avg dev_std = 0.581)
NEC for r=0.01 all L1 = 0.324 +- 0.209 (in-sample avg dev_std = 0.581)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8012515873015873
len(reference) = 2520
Effective ratio: 0.033 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.289
NEC for r=0.1 class 1.0 = 0.672 +- 0.244 (in-sample avg dev_std = 0.671)
NEC for r=0.1 all KL = 0.787 +- 0.244 (in-sample avg dev_std = 0.671)
NEC for r=0.1 all L1 = 0.672 +- 0.178 (in-sample avg dev_std = 0.671)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.768
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9720202380952381
len(reference) = 2520
Effective ratio: 0.012 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.0
NEC for r=0.25 class 1.0 = 0.696 +- 0.356 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.75 +- 0.356 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.696 +- 0.285 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.768
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.895943253968254
len(reference) = 2520
Effective ratio: 0.010 +- 0.003
Model Accuracy over intervened graphs for r=0.6 =  0.112
NEC for r=0.6 class 1.0 = 0.613 +- 0.408 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.655 +- 0.408 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.613 +- 0.338 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.947
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.9226758508914099
len(reference) = 2468
Effective ratio: 0.248 +- 0.383
Model Accuracy over intervened graphs for r=0.01 =  0.188
NEC for r=0.01 class 1.0 = 0.739 +- 0.201 (in-sample avg dev_std = 0.497)
NEC for r=0.01 all KL = 0.923 +- 0.201 (in-sample avg dev_std = 0.497)
NEC for r=0.01 all L1 = 0.739 +- 0.223 (in-sample avg dev_std = 0.497)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.947
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9243221231766612
len(reference) = 2468
Effective ratio: 0.193 +- 0.335
Model Accuracy over intervened graphs for r=0.1 =  0.127
NEC for r=0.1 class 1.0 = 0.783 +- 0.141 (in-sample avg dev_std = 0.444)
NEC for r=0.1 all KL = 0.955 +- 0.141 (in-sample avg dev_std = 0.444)
NEC for r=0.1 all L1 = 0.783 +- 0.174 (in-sample avg dev_std = 0.444)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.947
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.9154955429497568
len(reference) = 2468
Effective ratio: 0.154 +- 0.288
Model Accuracy over intervened graphs for r=0.25 =  0.083
NEC for r=0.25 class 1.0 = 0.81 +- 0.114 (in-sample avg dev_std = 0.384)
NEC for r=0.25 all KL = 0.969 +- 0.114 (in-sample avg dev_std = 0.384)
NEC for r=0.25 all L1 = 0.81 +- 0.142 (in-sample avg dev_std = 0.384)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.947
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.8997536466774715
len(reference) = 2468
Effective ratio: 0.117 +- 0.228
Model Accuracy over intervened graphs for r=0.6 =  0.066
NEC for r=0.6 class 1.0 = 0.808 +- 0.180 (in-sample avg dev_std = 0.302)
NEC for r=0.6 all KL = 0.952 +- 0.180 (in-sample avg dev_std = 0.302)
NEC for r=0.6 all L1 = 0.808 +- 0.172 (in-sample avg dev_std = 0.302)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 0.997, 1.0, 1.0], 'all_L1': [1.0, 0.998, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.988, 0.983, 0.983, 0.974], 'all_L1': [0.991, 0.988, 0.99, 0.985]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.994, 0.987, 0.998, 0.99], 'all_L1': [0.997, 0.991, 0.999, 0.995]}), defaultdict(<class 'list'>, {'all_KL': [0.976, 0.977, 0.977, 0.982], 'all_L1': [0.985, 0.988, 0.988, 0.991]}), defaultdict(<class 'list'>, {'all_KL': [0.998, 0.982, 0.99, 0.99], 'all_L1': [0.999, 0.989, 0.994, 0.995]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.964, 0.943, 0.934, 0.957], 'all_L1': [0.985, 0.976, 0.972, 0.982]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.0, 0.001, 0.002, 0.002], 'all_L1': [0.0, 0.001, 0.001, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.075, 0.115, 0.119], 'all_L1': [0.013, 0.034, 0.065, 0.066]}), defaultdict(<class 'list'>, {'all_KL': [0.03, 0.03, 0.065, 0.094], 'all_L1': [0.014, 0.014, 0.033, 0.056]}), defaultdict(<class 'list'>, {'all_KL': [0.006, 0.013, 0.006, 0.014], 'all_L1': [0.003, 0.008, 0.004, 0.012]}), defaultdict(<class 'list'>, {'all_KL': [0.076, 0.093, 0.101, 0.112], 'all_L1': [0.037, 0.052, 0.057, 0.079]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.0, 0.0], 'all_L1': [0.0, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.046, 0.099, 0.143, 0.141], 'all_L1': [0.022, 0.053, 0.088, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.003, 0.006, 0.012, 0.018], 'all_L1': [0.002, 0.004, 0.007, 0.013]}), defaultdict(<class 'list'>, {'all_KL': [0.129, 0.178, 0.176, 0.19], 'all_L1': [0.071, 0.109, 0.105, 0.116]}), defaultdict(<class 'list'>, {'all_KL': [0.111, 0.205, 0.242, 0.278], 'all_L1': [0.049, 0.097, 0.123, 0.15]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.872, 0.882, 0.88, 0.884], 'all_L1': [0.893, 0.9, 0.901, 0.903]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.995, 0.996, 0.995, 0.996], 'all_L1': [0.997, 0.997, 0.996, 0.997]}), defaultdict(<class 'list'>, {'all_KL': [0.998, 0.997, 0.999, 0.999], 'all_L1': [0.999, 0.999, 0.999, 0.999]}), defaultdict(<class 'list'>, {'all_KL': [0.779, 0.805, 0.817, 0.819], 'all_L1': [0.826, 0.849, 0.859, 0.861]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.462, 0.456, 0.463, 0.464], 'all_L1': [0.55, 0.547, 0.555, 0.557]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.869, 0.961, 0.595, 0.007], 'all_L1': [0.713, 0.852, 0.52, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.034, 0.986, 0.995, 0.949], 'all_L1': [0.015, 0.847, 0.863, 0.822]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.708, 0.856, 0.856], 'all_L1': [0.005, 0.593, 0.776, 0.776]}), defaultdict(<class 'list'>, {'all_KL': [0.095, 0.773, 0.78, 0.014], 'all_L1': [0.064, 0.717, 0.729, 0.014]}), defaultdict(<class 'list'>, {'all_KL': [0.29, 0.872, 0.874, 0.525], 'all_L1': [0.183, 0.798, 0.802, 0.489]}), defaultdict(<class 'list'>, {'all_KL': [0.041, 0.84, 0.907, 0.72], 'all_L1': [0.02, 0.722, 0.824, 0.655]}), defaultdict(<class 'list'>, {'all_KL': [0.39, 0.955, 0.955, 0.955], 'all_L1': [0.239, 0.849, 0.849, 0.849]}), defaultdict(<class 'list'>, {'all_KL': [0.146, 0.452, 0.636, 0.636], 'all_L1': [0.093, 0.319, 0.569, 0.569]}), defaultdict(<class 'list'>, {'all_KL': [0.73, 0.759, 0.759, 0.759], 'all_L1': [0.647, 0.704, 0.704, 0.704]}), defaultdict(<class 'list'>, {'all_KL': [0.413, 0.787, 0.75, 0.655], 'all_L1': [0.324, 0.672, 0.696, 0.613]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 0.994], 'all_L1': [1.0, 1.0, 1.0, 0.997]}), defaultdict(<class 'list'>, {'all_KL': [0.998, 0.994, 0.996, 0.996], 'all_L1': [0.999, 0.996, 0.998, 0.998]}), defaultdict(<class 'list'>, {'all_KL': [0.998, 0.99, 0.988, 0.986], 'all_L1': [0.998, 0.993, 0.992, 0.99]}), defaultdict(<class 'list'>, {'all_KL': [0.965, 0.964, 0.958, 0.929], 'all_L1': [0.976, 0.975, 0.97, 0.952]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.993, 0.972, 0.963, 0.96], 'all_L1': [0.995, 0.982, 0.977, 0.974]}), defaultdict(<class 'list'>, {'all_KL': [0.957, 0.935, 0.932, 0.931], 'all_L1': [0.968, 0.956, 0.954, 0.952]}), defaultdict(<class 'list'>, {'all_KL': [0.995, 0.98, 0.977, 0.968], 'all_L1': [0.997, 0.986, 0.986, 0.979]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.941, 0.888, 0.872, 0.87], 'all_L1': [0.961, 0.927, 0.915, 0.917]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.717, 0.806, 0.539, 0.002], 'all_L1': [0.531, 0.672, 0.46, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.582, 0.683, 0.815, 0.867], 'all_L1': [0.337, 0.445, 0.662, 0.745]}), defaultdict(<class 'list'>, {'all_KL': [0.562, 0.641, 0.725, 0.829], 'all_L1': [0.351, 0.452, 0.553, 0.693]}), defaultdict(<class 'list'>, {'all_KL': [0.625, 0.763, 0.841, 0.12], 'all_L1': [0.425, 0.594, 0.71, 0.107]}), defaultdict(<class 'list'>, {'all_KL': [0.651, 0.748, 0.818, 0.81], 'all_L1': [0.387, 0.508, 0.632, 0.698]}), defaultdict(<class 'list'>, {'all_KL': [0.619, 0.728, 0.808, 0.826], 'all_L1': [0.378, 0.528, 0.64, 0.714]}), defaultdict(<class 'list'>, {'all_KL': [0.788, 0.879, 0.885, 0.917], 'all_L1': [0.556, 0.711, 0.745, 0.792]}), defaultdict(<class 'list'>, {'all_KL': [0.572, 0.7, 0.793, 0.884], 'all_L1': [0.367, 0.509, 0.625, 0.759]}), defaultdict(<class 'list'>, {'all_KL': [0.87, 0.924, 0.944, 0.948], 'all_L1': [0.731, 0.785, 0.806, 0.811]}), defaultdict(<class 'list'>, {'all_KL': [0.923, 0.955, 0.969, 0.952], 'all_L1': [0.739, 0.783, 0.81, 0.808]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.996 +- 0.006, 0.993 +- 0.008, 0.994 +- 0.009, 0.995 +- 0.006
suff_simple class all_KL  =  0.992 +- 0.012, 0.987 +- 0.017, 0.988 +- 0.020, 0.989 +- 0.014
suff_simple_acc_int  =  0.997 +- 0.005, 0.995 +- 0.005, 0.996 +- 0.005, 0.997 +- 0.004
nec class all_L1  =  0.021 +- 0.023, 0.037 +- 0.038, 0.048 +- 0.044, 0.058 +- 0.049
nec class all_KL  =  0.043 +- 0.045, 0.070 +- 0.071, 0.086 +- 0.080, 0.097 +- 0.087
nec_acc_int  =  0.987 +- 0.015, 0.974 +- 0.027, 0.966 +- 0.031, 0.954 +- 0.036

Eval split val
suff_simple class all_L1  =  0.927 +- 0.138, 0.929 +- 0.137, 0.931 +- 0.134, 0.932 +- 0.134
suff_simple class all_KL  =  0.911 +- 0.166, 0.914 +- 0.165, 0.915 +- 0.163, 0.916 +- 0.162
suff_simple_acc_int  =  0.795 +- 0.214, 0.798 +- 0.210, 0.800 +- 0.206, 0.802 +- 0.204
nec class all_L1  =  0.230 +- 0.246, 0.707 +- 0.153, 0.733 +- 0.109, 0.550 +- 0.290
nec class all_KL  =  0.302 +- 0.286, 0.809 +- 0.149, 0.811 +- 0.124, 0.608 +- 0.325
nec_acc_int  =  0.659 +- 0.277, 0.115 +- 0.140, 0.042 +- 0.126, 0.246 +- 0.336

Eval split test
suff_simple class all_L1  =  0.989 +- 0.014, 0.982 +- 0.022, 0.979 +- 0.026, 0.976 +- 0.026
suff_simple class all_KL  =  0.985 +- 0.021, 0.972 +- 0.034, 0.969 +- 0.039, 0.963 +- 0.040
suff_simple_acc_int  =  0.990 +- 0.014, 0.985 +- 0.019, 0.983 +- 0.023, 0.985 +- 0.024
nec class all_L1  =  0.480 +- 0.145, 0.599 +- 0.124, 0.664 +- 0.104, 0.613 +- 0.283
nec class all_KL  =  0.691 +- 0.122, 0.783 +- 0.100, 0.814 +- 0.114, 0.716 +- 0.332
nec_acc_int  =  0.555 +- 0.210, 0.380 +- 0.180, 0.267 +- 0.132, 0.290 +- 0.330


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.508 +- 0.011, 0.515 +- 0.019, 0.521 +- 0.020, 0.526 +- 0.024
Faith. Armon (L1)= 		  =  0.040 +- 0.043, 0.069 +- 0.069, 0.089 +- 0.079, 0.105 +- 0.086
Faith. GMean (L1)= 	  =  0.116 +- 0.087, 0.158 +- 0.109, 0.182 +- 0.122, 0.205 +- 0.125
Faith. Aritm (KL)= 		  =  0.518 +- 0.021, 0.528 +- 0.033, 0.537 +- 0.035, 0.543 +- 0.041
Faith. Armon (KL)= 		  =  0.079 +- 0.080, 0.123 +- 0.118, 0.148 +- 0.131, 0.165 +- 0.139
Faith. GMean (KL)= 	  =  0.165 +- 0.124, 0.215 +- 0.150, 0.241 +- 0.162, 0.260 +- 0.166

Eval split val
Faith. Aritm (L1)= 		  =  0.578 +- 0.141, 0.818 +- 0.119, 0.832 +- 0.097, 0.741 +- 0.163
Faith. Armon (L1)= 		  =  0.309 +- 0.285, 0.792 +- 0.144, 0.813 +- 0.106, 0.628 +- 0.321
Faith. GMean (L1)= 	  =  0.384 +- 0.257, 0.805 +- 0.132, 0.822 +- 0.102, 0.653 +- 0.297
Faith. Aritm (KL)= 		  =  0.606 +- 0.166, 0.861 +- 0.129, 0.863 +- 0.118, 0.762 +- 0.187
Faith. Armon (KL)= 		  =  0.380 +- 0.306, 0.846 +- 0.146, 0.850 +- 0.129, 0.656 +- 0.343
Faith. GMean (KL)= 	  =  0.450 +- 0.270, 0.854 +- 0.138, 0.857 +- 0.123, 0.679 +- 0.316

Eval split test
Faith. Aritm (L1)= 		  =  0.735 +- 0.069, 0.790 +- 0.057, 0.822 +- 0.046, 0.794 +- 0.141
Faith. Armon (L1)= 		  =  0.634 +- 0.122, 0.735 +- 0.091, 0.786 +- 0.072, 0.699 +- 0.304
Faith. GMean (L1)= 	  =  0.682 +- 0.097, 0.762 +- 0.074, 0.803 +- 0.059, 0.722 +- 0.277
Faith. Aritm (KL)= 		  =  0.838 +- 0.056, 0.878 +- 0.043, 0.891 +- 0.049, 0.839 +- 0.166
Faith. Armon (KL)= 		  =  0.805 +- 0.077, 0.862 +- 0.054, 0.878 +- 0.068, 0.756 +- 0.328
Faith. GMean (KL)= 	  =  0.821 +- 0.067, 0.870 +- 0.048, 0.884 +- 0.059, 0.774 +- 0.300
Computed for split load_split = id



Completed in  0:51:37.521611  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN TopoFeature/basis/no_shift NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 03:45:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 03:45:07 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 03:45:07 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 03:45:07 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 03:45:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:45:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:45:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:45:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:45:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:45:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 03:45:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.103
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.099
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.058
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.057
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.012
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.113
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.111
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.088
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10290252707581228
len(reference) = 276
Effective ratio: 0.196 +- 0.158
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 0.999 +- 0.036 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.01 all KL = 0.998 +- 0.036 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.01 all L1 = 0.999 +- 0.013 (in-sample avg dev_std = 0.042)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0993971119133574
len(reference) = 277
Effective ratio: 0.118 +- 0.110
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.035 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.1 all KL = 0.998 +- 0.035 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.1 all L1 = 0.999 +- 0.013 (in-sample avg dev_std = 0.042)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.057844765342960285
len(reference) = 277
Effective ratio: 0.024 +- 0.030
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05655595667870036
len(reference) = 277
Effective ratio: 0.023 +- 0.022
Model Accuracy over intervened graphs for r=0.6 =  0.999
SUFF_SIMPLE for r=0.6 class 1.0 = 0.998 +- 0.058 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.6 all KL = 0.995 +- 0.058 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.6 all L1 = 0.998 +- 0.025 (in-sample avg dev_std = 0.064)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012415873015873016
len(reference) = 2520
Effective ratio: 0.029 +- 0.007
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.012 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.01 all KL = 0.999 +- 0.012 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.009 (in-sample avg dev_std = 0.023)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012115873015873014
len(reference) = 2520
Effective ratio: 0.016 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.014 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.1 all KL = 0.999 +- 0.014 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.006 (in-sample avg dev_std = 0.019)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.25 =  1.0
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.009 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.009 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.005 (in-sample avg dev_std = 0.014)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  1.0
SUFF_SIMPLE for r=0.6 class 1.0 = 1.0 +- 0.011 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.6 all KL = 1.0 +- 0.011 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.6 all L1 = 1.0 +- 0.007 (in-sample avg dev_std = 0.020)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.1126754457050243
len(reference) = 2192
Effective ratio: 0.230 +- 0.340
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 0.999 +- 0.032 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.01 all KL = 0.998 +- 0.032 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.01 all L1 = 0.999 +- 0.012 (in-sample avg dev_std = 0.039)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11052674230145866
len(reference) = 2306
Effective ratio: 0.172 +- 0.287
Model Accuracy over intervened graphs for r=0.1 =  0.999
SUFF_SIMPLE for r=0.1 class 1.0 = 0.998 +- 0.045 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.1 all KL = 0.997 +- 0.045 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.1 all L1 = 0.998 +- 0.028 (in-sample avg dev_std = 0.041)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08777066450567261
len(reference) = 2384
Effective ratio: 0.082 +- 0.214
Model Accuracy over intervened graphs for r=0.25 =  0.996
SUFF_SIMPLE for r=0.25 class 1.0 = 0.994 +- 0.089 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.25 all KL = 0.989 +- 0.089 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.25 all L1 = 0.994 +- 0.053 (in-sample avg dev_std = 0.094)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05850202593192869
len(reference) = 2468
Effective ratio: 0.030 +- 0.050
Model Accuracy over intervened graphs for r=0.6 =  0.994
SUFF_SIMPLE for r=0.6 class 1.0 = 0.992 +- 0.110 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.6 all KL = 0.984 +- 0.110 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.6 all L1 = 0.992 +- 0.061 (in-sample avg dev_std = 0.122)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10290252707581228
len(reference) = 277
Effective ratio: 0.196 +- 0.158
Model Accuracy over intervened graphs for r=0.01 =  1.0
NEC for r=0.01 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0993971119133574
len(reference) = 277
Effective ratio: 0.118 +- 0.110
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.057844765342960285
len(reference) = 277
Effective ratio: 0.024 +- 0.030
Model Accuracy over intervened graphs for r=0.25 =  1.0
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05655595667870036
len(reference) = 277
Effective ratio: 0.023 +- 0.022
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012415873015873016
len(reference) = 2520
Effective ratio: 0.029 +- 0.007
Model Accuracy over intervened graphs for r=0.01 =  1.0
NEC for r=0.01 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012115873015873014
len(reference) = 2520
Effective ratio: 0.016 +- 0.003
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.25 =  1.0
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.1126754457050243
len(reference) = 2468
Effective ratio: 0.230 +- 0.340
Model Accuracy over intervened graphs for r=0.01 =  0.999
NEC for r=0.01 class 1.0 = 0.002 +- 0.060 (in-sample avg dev_std = 0.070)
NEC for r=0.01 all KL = 0.005 +- 0.060 (in-sample avg dev_std = 0.070)
NEC for r=0.01 all L1 = 0.002 +- 0.028 (in-sample avg dev_std = 0.070)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11052674230145866
len(reference) = 2468
Effective ratio: 0.172 +- 0.287
Model Accuracy over intervened graphs for r=0.1 =  0.998
NEC for r=0.1 class 1.0 = 0.003 +- 0.066 (in-sample avg dev_std = 0.071)
NEC for r=0.1 all KL = 0.006 +- 0.066 (in-sample avg dev_std = 0.071)
NEC for r=0.1 all L1 = 0.003 +- 0.035 (in-sample avg dev_std = 0.071)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08777066450567261
len(reference) = 2468
Effective ratio: 0.082 +- 0.214
Model Accuracy over intervened graphs for r=0.25 =  1.0
NEC for r=0.25 class 1.0 = 0.001 +- 0.030 (in-sample avg dev_std = 0.033)
NEC for r=0.25 all KL = 0.001 +- 0.030 (in-sample avg dev_std = 0.033)
NEC for r=0.25 all L1 = 0.001 +- 0.015 (in-sample avg dev_std = 0.033)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05850202593192869
len(reference) = 2468
Effective ratio: 0.030 +- 0.050
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 03:50:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 03:50:22 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 03:50:22 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 03:50:22 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 03:50:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:50:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:50:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:50:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:50:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:50:22 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 03:50:22 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.092
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.089
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.085
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.065
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.012
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.112
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.111
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.109
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.083


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.0916534296028881
len(reference) = 237
Effective ratio: 0.583 +- 0.272
Model Accuracy over intervened graphs for r=0.01 =  0.996
SUFF_SIMPLE for r=0.01 class 1.0 = 0.994 +- 0.097 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.01 all KL = 0.986 +- 0.097 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.01 all L1 = 0.994 +- 0.043 (in-sample avg dev_std = 0.116)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08918050541516247
len(reference) = 270
Effective ratio: 0.202 +- 0.193
Model Accuracy over intervened graphs for r=0.1 =  0.993
SUFF_SIMPLE for r=0.1 class 1.0 = 0.988 +- 0.134 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.1 all KL = 0.971 +- 0.134 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.1 all L1 = 0.988 +- 0.061 (in-sample avg dev_std = 0.164)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08541516245487363
len(reference) = 277
Effective ratio: 0.141 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.991
SUFF_SIMPLE for r=0.25 class 1.0 = 0.986 +- 0.144 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.25 all KL = 0.967 +- 0.144 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.25 all L1 = 0.986 +- 0.065 (in-sample avg dev_std = 0.176)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.06506859205776173
len(reference) = 277
Effective ratio: 0.024 +- 0.032
Model Accuracy over intervened graphs for r=0.6 =  0.987
SUFF_SIMPLE for r=0.6 class 1.0 = 0.98 +- 0.171 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.6 all KL = 0.955 +- 0.171 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.6 all L1 = 0.98 +- 0.081 (in-sample avg dev_std = 0.209)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012118650793650794
len(reference) = 2520
Effective ratio: 0.110 +- 0.037
Model Accuracy over intervened graphs for r=0.01 =  0.999
SUFF_SIMPLE for r=0.01 class 1.0 = 0.998 +- 0.054 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.01 all KL = 0.995 +- 0.054 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.01 all L1 = 0.998 +- 0.025 (in-sample avg dev_std = 0.068)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01192579365079365
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.999
SUFF_SIMPLE for r=0.1 class 1.0 = 0.998 +- 0.050 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.1 all KL = 0.995 +- 0.050 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.1 all L1 = 0.998 +- 0.022 (in-sample avg dev_std = 0.065)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01169484126984127
len(reference) = 2520
Effective ratio: 0.023 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.999
SUFF_SIMPLE for r=0.25 class 1.0 = 0.998 +- 0.050 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.25 all KL = 0.995 +- 0.050 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.25 all L1 = 0.998 +- 0.021 (in-sample avg dev_std = 0.065)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.010062301587301587
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.999
SUFF_SIMPLE for r=0.6 class 1.0 = 0.998 +- 0.055 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.6 all KL = 0.995 +- 0.055 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.6 all L1 = 0.998 +- 0.023 (in-sample avg dev_std = 0.071)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11172082658022689
len(reference) = 1975
Effective ratio: 0.312 +- 0.401
Model Accuracy over intervened graphs for r=0.01 =  0.995
SUFF_SIMPLE for r=0.01 class 1.0 = 0.993 +- 0.099 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.01 all KL = 0.986 +- 0.099 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.01 all L1 = 0.993 +- 0.054 (in-sample avg dev_std = 0.109)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11134481361426256
len(reference) = 2130
Effective ratio: 0.237 +- 0.354
Model Accuracy over intervened graphs for r=0.1 =  0.99
SUFF_SIMPLE for r=0.1 class 1.0 = 0.986 +- 0.143 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.1 all KL = 0.972 +- 0.143 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.1 all L1 = 0.986 +- 0.079 (in-sample avg dev_std = 0.160)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.999
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10893881685575364
len(reference) = 2296
Effective ratio: 0.176 +- 0.290
Model Accuracy over intervened graphs for r=0.25 =  0.979
SUFF_SIMPLE for r=0.25 class 1.0 = 0.974 +- 0.188 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.25 all KL = 0.952 +- 0.188 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.25 all L1 = 0.974 +- 0.114 (in-sample avg dev_std = 0.200)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.998
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0834035656401945
len(reference) = 2450
Effective ratio: 0.073 +- 0.171
Model Accuracy over intervened graphs for r=0.6 =  0.978
SUFF_SIMPLE for r=0.6 class 1.0 = 0.97 +- 0.199 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.6 all KL = 0.945 +- 0.199 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.6 all L1 = 0.97 +- 0.119 (in-sample avg dev_std = 0.220)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.0916534296028881
len(reference) = 277
Effective ratio: 0.583 +- 0.272
Model Accuracy over intervened graphs for r=0.01 =  0.995
NEC for r=0.01 class 1.0 = 0.008 +- 0.107 (in-sample avg dev_std = 0.132)
NEC for r=0.01 all KL = 0.019 +- 0.107 (in-sample avg dev_std = 0.132)
NEC for r=0.01 all L1 = 0.008 +- 0.044 (in-sample avg dev_std = 0.132)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08918050541516247
len(reference) = 277
Effective ratio: 0.202 +- 0.193
Model Accuracy over intervened graphs for r=0.1 =  0.993
NEC for r=0.1 class 1.0 = 0.011 +- 0.130 (in-sample avg dev_std = 0.153)
NEC for r=0.1 all KL = 0.023 +- 0.130 (in-sample avg dev_std = 0.153)
NEC for r=0.1 all L1 = 0.011 +- 0.062 (in-sample avg dev_std = 0.153)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08541516245487363
len(reference) = 277
Effective ratio: 0.141 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.996
NEC for r=0.25 class 1.0 = 0.006 +- 0.094 (in-sample avg dev_std = 0.111)
NEC for r=0.25 all KL = 0.012 +- 0.094 (in-sample avg dev_std = 0.111)
NEC for r=0.25 all L1 = 0.006 +- 0.045 (in-sample avg dev_std = 0.111)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.06506859205776173
len(reference) = 277
Effective ratio: 0.024 +- 0.032
Model Accuracy over intervened graphs for r=0.6 =  0.996
NEC for r=0.6 class 1.0 = 0.003 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.004 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.003 +- 0.052 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012118650793650794
len(reference) = 2520
Effective ratio: 0.110 +- 0.037
Model Accuracy over intervened graphs for r=0.01 =  0.999
NEC for r=0.01 class 1.0 = 0.001 +- 0.039 (in-sample avg dev_std = 0.047)
NEC for r=0.01 all KL = 0.002 +- 0.039 (in-sample avg dev_std = 0.047)
NEC for r=0.01 all L1 = 0.001 +- 0.020 (in-sample avg dev_std = 0.047)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01192579365079365
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01169484126984127
len(reference) = 2520
Effective ratio: 0.023 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  1.0
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.010062301587301587
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.998
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11172082658022689
len(reference) = 2468
Effective ratio: 0.312 +- 0.401
Model Accuracy over intervened graphs for r=0.01 =  0.983
NEC for r=0.01 class 1.0 = 0.026 +- 0.192 (in-sample avg dev_std = 0.230)
NEC for r=0.01 all KL = 0.054 +- 0.192 (in-sample avg dev_std = 0.230)
NEC for r=0.01 all L1 = 0.026 +- 0.100 (in-sample avg dev_std = 0.230)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11134481361426256
len(reference) = 2468
Effective ratio: 0.237 +- 0.354
Model Accuracy over intervened graphs for r=0.1 =  0.982
NEC for r=0.1 class 1.0 = 0.028 +- 0.199 (in-sample avg dev_std = 0.238)
NEC for r=0.1 all KL = 0.058 +- 0.199 (in-sample avg dev_std = 0.238)
NEC for r=0.1 all L1 = 0.028 +- 0.104 (in-sample avg dev_std = 0.238)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.998
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10893881685575364
len(reference) = 2468
Effective ratio: 0.176 +- 0.290
Model Accuracy over intervened graphs for r=0.25 =  0.982
NEC for r=0.25 class 1.0 = 0.024 +- 0.183 (in-sample avg dev_std = 0.209)
NEC for r=0.25 all KL = 0.046 +- 0.183 (in-sample avg dev_std = 0.209)
NEC for r=0.25 all L1 = 0.024 +- 0.105 (in-sample avg dev_std = 0.209)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.998
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0834035656401945
len(reference) = 2468
Effective ratio: 0.073 +- 0.171
Model Accuracy over intervened graphs for r=0.6 =  0.988
NEC for r=0.6 class 1.0 = 0.011 +- 0.114 (in-sample avg dev_std = 0.054)
NEC for r=0.6 all KL = 0.014 +- 0.114 (in-sample avg dev_std = 0.054)
NEC for r=0.6 all L1 = 0.011 +- 0.093 (in-sample avg dev_std = 0.054)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 03:55:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 03:55:16 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 03:55:16 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 03:55:16 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 03:55:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:55:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:55:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:55:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 03:55:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 03:55:16 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 03:55:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.101
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.101
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.101
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.074
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.013
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.013
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.111
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.111
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.109
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.089


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10113718411552347
len(reference) = 233
Effective ratio: 0.580 +- 0.257
Model Accuracy over intervened graphs for r=0.01 =  0.999
SUFF_SIMPLE for r=0.01 class 1.0 = 0.998 +- 0.046 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.01 all KL = 0.996 +- 0.046 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.01 all L1 = 0.998 +- 0.020 (in-sample avg dev_std = 0.065)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.10067509025270759
len(reference) = 271
Effective ratio: 0.227 +- 0.219
Model Accuracy over intervened graphs for r=0.1 =  0.992
SUFF_SIMPLE for r=0.1 class 1.0 = 0.99 +- 0.107 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.1 all KL = 0.982 +- 0.107 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.1 all L1 = 0.99 +- 0.068 (in-sample avg dev_std = 0.120)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10105415162454874
len(reference) = 276
Effective ratio: 0.169 +- 0.141
Model Accuracy over intervened graphs for r=0.25 =  0.988
SUFF_SIMPLE for r=0.25 class 1.0 = 0.982 +- 0.149 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.25 all KL = 0.964 +- 0.149 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.25 all L1 = 0.982 +- 0.081 (in-sample avg dev_std = 0.196)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07420216606498195
len(reference) = 277
Effective ratio: 0.028 +- 0.049
Model Accuracy over intervened graphs for r=0.6 =  0.988
SUFF_SIMPLE for r=0.6 class 1.0 = 0.981 +- 0.150 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.6 all KL = 0.959 +- 0.150 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.6 all L1 = 0.981 +- 0.073 (in-sample avg dev_std = 0.206)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.86
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.01276746031746032
len(reference) = 2520
Effective ratio: 0.134 +- 0.040
Model Accuracy over intervened graphs for r=0.01 =  0.859
SUFF_SIMPLE for r=0.01 class 1.0 = 0.999 +- 0.030 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.01 all KL = 0.998 +- 0.030 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.01 all L1 = 0.999 +- 0.014 (in-sample avg dev_std = 0.046)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01265595238095238
len(reference) = 2520
Effective ratio: 0.027 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.859
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.027 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.1 all KL = 0.998 +- 0.027 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.1 all L1 = 0.999 +- 0.013 (in-sample avg dev_std = 0.041)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.86
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.012505952380952383
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.25 =  0.86
SUFF_SIMPLE for r=0.25 class 1.0 = 1.0 +- 0.014 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.25 all KL = 1.0 +- 0.014 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.25 all L1 = 1.0 +- 0.006 (in-sample avg dev_std = 0.020)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.86
SUFF_SIMPLE for r=0.6 class 1.0 = 0.999 +- 0.027 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.6 all KL = 0.998 +- 0.027 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.6 all L1 = 0.999 +- 0.012 (in-sample avg dev_std = 0.039)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11139789303079414
len(reference) = 1905
Effective ratio: 0.316 +- 0.408
Model Accuracy over intervened graphs for r=0.01 =  0.997
SUFF_SIMPLE for r=0.01 class 1.0 = 0.996 +- 0.070 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.01 all KL = 0.991 +- 0.070 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.01 all L1 = 0.996 +- 0.036 (in-sample avg dev_std = 0.093)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11123662884927069
len(reference) = 2077
Effective ratio: 0.256 +- 0.369
Model Accuracy over intervened graphs for r=0.1 =  0.989
SUFF_SIMPLE for r=0.1 class 1.0 = 0.987 +- 0.124 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.1 all KL = 0.978 +- 0.124 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.1 all L1 = 0.987 +- 0.080 (in-sample avg dev_std = 0.140)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.996
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10948217179902756
len(reference) = 2250
Effective ratio: 0.207 +- 0.319
Model Accuracy over intervened graphs for r=0.25 =  0.978
SUFF_SIMPLE for r=0.25 class 1.0 = 0.976 +- 0.168 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.25 all KL = 0.962 +- 0.168 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.25 all L1 = 0.976 +- 0.117 (in-sample avg dev_std = 0.175)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.992
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0885996758508914
len(reference) = 2435
Effective ratio: 0.094 +- 0.212
Model Accuracy over intervened graphs for r=0.6 =  0.97
SUFF_SIMPLE for r=0.6 class 1.0 = 0.964 +- 0.204 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.6 all KL = 0.944 +- 0.204 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.6 all L1 = 0.964 +- 0.144 (in-sample avg dev_std = 0.212)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10113718411552347
len(reference) = 277
Effective ratio: 0.580 +- 0.257
Model Accuracy over intervened graphs for r=0.01 =  0.995
NEC for r=0.01 class 1.0 = 0.008 +- 0.101 (in-sample avg dev_std = 0.130)
NEC for r=0.01 all KL = 0.015 +- 0.101 (in-sample avg dev_std = 0.130)
NEC for r=0.01 all L1 = 0.008 +- 0.057 (in-sample avg dev_std = 0.130)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.10067509025270759
len(reference) = 277
Effective ratio: 0.227 +- 0.219
Model Accuracy over intervened graphs for r=0.1 =  0.995
NEC for r=0.1 class 1.0 = 0.008 +- 0.098 (in-sample avg dev_std = 0.134)
NEC for r=0.1 all KL = 0.017 +- 0.098 (in-sample avg dev_std = 0.134)
NEC for r=0.1 all L1 = 0.008 +- 0.048 (in-sample avg dev_std = 0.134)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10105415162454874
len(reference) = 277
Effective ratio: 0.169 +- 0.141
Model Accuracy over intervened graphs for r=0.25 =  0.993
NEC for r=0.25 class 1.0 = 0.011 +- 0.118 (in-sample avg dev_std = 0.155)
NEC for r=0.25 all KL = 0.022 +- 0.118 (in-sample avg dev_std = 0.155)
NEC for r=0.25 all L1 = 0.011 +- 0.059 (in-sample avg dev_std = 0.155)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07420216606498195
len(reference) = 277
Effective ratio: 0.028 +- 0.049
Model Accuracy over intervened graphs for r=0.6 =  0.991
NEC for r=0.6 class 1.0 = 0.009 +- 0.101 (in-sample avg dev_std = 0.064)
NEC for r=0.6 all KL = 0.011 +- 0.101 (in-sample avg dev_std = 0.064)
NEC for r=0.6 all L1 = 0.009 +- 0.082 (in-sample avg dev_std = 0.064)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.86
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.01276746031746032
len(reference) = 2520
Effective ratio: 0.134 +- 0.040
Model Accuracy over intervened graphs for r=0.01 =  0.86
NEC for r=0.01 class 1.0 = 0.0 +- 0.012 (in-sample avg dev_std = 0.020)
NEC for r=0.01 all KL = 0.0 +- 0.012 (in-sample avg dev_std = 0.020)
NEC for r=0.01 all L1 = 0.0 +- 0.006 (in-sample avg dev_std = 0.020)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01265595238095238
len(reference) = 2520
Effective ratio: 0.027 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.86
NEC for r=0.1 class 1.0 = 0.0 +- 0.015 (in-sample avg dev_std = 0.018)
NEC for r=0.1 all KL = 0.0 +- 0.015 (in-sample avg dev_std = 0.018)
NEC for r=0.1 all L1 = 0.0 +- 0.008 (in-sample avg dev_std = 0.018)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.86
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.012505952380952383
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.25 =  0.86
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.01196547619047619
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.86
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.992
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11139789303079414
len(reference) = 2468
Effective ratio: 0.316 +- 0.408
Model Accuracy over intervened graphs for r=0.01 =  0.977
NEC for r=0.01 class 1.0 = 0.034 +- 0.203 (in-sample avg dev_std = 0.257)
NEC for r=0.01 all KL = 0.061 +- 0.203 (in-sample avg dev_std = 0.257)
NEC for r=0.01 all L1 = 0.034 +- 0.121 (in-sample avg dev_std = 0.257)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11123662884927069
len(reference) = 2468
Effective ratio: 0.256 +- 0.369
Model Accuracy over intervened graphs for r=0.1 =  0.976
NEC for r=0.1 class 1.0 = 0.034 +- 0.200 (in-sample avg dev_std = 0.252)
NEC for r=0.1 all KL = 0.06 +- 0.200 (in-sample avg dev_std = 0.252)
NEC for r=0.1 all L1 = 0.034 +- 0.121 (in-sample avg dev_std = 0.252)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.992
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10948217179902756
len(reference) = 2468
Effective ratio: 0.207 +- 0.319
Model Accuracy over intervened graphs for r=0.25 =  0.977
NEC for r=0.25 class 1.0 = 0.034 +- 0.200 (in-sample avg dev_std = 0.243)
NEC for r=0.25 all KL = 0.057 +- 0.200 (in-sample avg dev_std = 0.243)
NEC for r=0.25 all L1 = 0.034 +- 0.128 (in-sample avg dev_std = 0.243)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.992
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0885996758508914
len(reference) = 2468
Effective ratio: 0.094 +- 0.212
Model Accuracy over intervened graphs for r=0.6 =  0.98
NEC for r=0.6 class 1.0 = 0.023 +- 0.164 (in-sample avg dev_std = 0.139)
NEC for r=0.6 all KL = 0.032 +- 0.164 (in-sample avg dev_std = 0.139)
NEC for r=0.6 all L1 = 0.023 +- 0.125 (in-sample avg dev_std = 0.139)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 04:00:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 04:00:28 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 04:00:28 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 04:00:28 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 04:00:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:00:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 04:00:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:00:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 04:00:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:00:28 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 04:00:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.093
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.089
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.070
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.070
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.011
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.011
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.112
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.112
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.098
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.049


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09340794223826715
len(reference) = 271
Effective ratio: 0.315 +- 0.189
Model Accuracy over intervened graphs for r=0.01 =  0.995
SUFF_SIMPLE for r=0.01 class 1.0 = 0.996 +- 0.065 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.01 all KL = 0.994 +- 0.065 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.01 all L1 = 0.996 +- 0.052 (in-sample avg dev_std = 0.048)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08869314079422382
len(reference) = 277
Effective ratio: 0.168 +- 0.136
Model Accuracy over intervened graphs for r=0.1 =  0.991
SUFF_SIMPLE for r=0.1 class 1.0 = 0.989 +- 0.108 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.1 all KL = 0.982 +- 0.108 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.1 all L1 = 0.989 +- 0.072 (in-sample avg dev_std = 0.133)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.06991696750902528
len(reference) = 277
Effective ratio: 0.027 +- 0.051
Model Accuracy over intervened graphs for r=0.25 =  0.992
SUFF_SIMPLE for r=0.25 class 1.0 = 0.991 +- 0.102 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.25 all KL = 0.985 +- 0.102 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.25 all L1 = 0.991 +- 0.070 (in-sample avg dev_std = 0.110)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07038628158844765
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  0.993
SUFF_SIMPLE for r=0.6 class 1.0 = 0.991 +- 0.100 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.6 all KL = 0.986 +- 0.100 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.6 all L1 = 0.991 +- 0.067 (in-sample avg dev_std = 0.118)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.762
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012090873015873017
len(reference) = 2520
Effective ratio: 0.106 +- 0.032
Model Accuracy over intervened graphs for r=0.01 =  0.697
SUFF_SIMPLE for r=0.01 class 1.0 = 0.904 +- 0.245 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.01 all KL = 0.884 +- 0.245 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.01 all L1 = 0.904 +- 0.182 (in-sample avg dev_std = 0.303)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011874999999999998
len(reference) = 2520
Effective ratio: 0.024 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.694
SUFF_SIMPLE for r=0.1 class 1.0 = 0.901 +- 0.250 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.1 all KL = 0.88 +- 0.250 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.1 all L1 = 0.901 +- 0.184 (in-sample avg dev_std = 0.310)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.762
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.010976190476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.25 =  0.697
SUFF_SIMPLE for r=0.25 class 1.0 = 0.904 +- 0.248 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.25 all KL = 0.885 +- 0.248 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.25 all L1 = 0.904 +- 0.184 (in-sample avg dev_std = 0.303)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.010976190476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.696
SUFF_SIMPLE for r=0.6 class 1.0 = 0.902 +- 0.250 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.6 all KL = 0.882 +- 0.250 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.6 all L1 = 0.902 +- 0.184 (in-sample avg dev_std = 0.310)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11205429497568882
len(reference) = 2062
Effective ratio: 0.268 +- 0.372
Model Accuracy over intervened graphs for r=0.01 =  0.989
SUFF_SIMPLE for r=0.01 class 1.0 = 0.985 +- 0.126 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.01 all KL = 0.976 +- 0.126 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.01 all L1 = 0.985 +- 0.086 (in-sample avg dev_std = 0.144)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.995
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11165883306320908
len(reference) = 2210
Effective ratio: 0.209 +- 0.326
Model Accuracy over intervened graphs for r=0.1 =  0.977
SUFF_SIMPLE for r=0.1 class 1.0 = 0.972 +- 0.169 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.1 all KL = 0.959 +- 0.169 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.1 all L1 = 0.972 +- 0.121 (in-sample avg dev_std = 0.187)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.986
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09752836304700162
len(reference) = 2328
Effective ratio: 0.120 +- 0.274
Model Accuracy over intervened graphs for r=0.25 =  0.963
SUFF_SIMPLE for r=0.25 class 1.0 = 0.955 +- 0.214 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.25 all KL = 0.933 +- 0.214 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.25 all L1 = 0.955 +- 0.155 (in-sample avg dev_std = 0.232)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.977
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.048913695299837925
len(reference) = 2468
Effective ratio: 0.027 +- 0.043
Model Accuracy over intervened graphs for r=0.6 =  0.958
SUFF_SIMPLE for r=0.6 class 1.0 = 0.937 +- 0.249 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.6 all KL = 0.903 +- 0.249 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.6 all L1 = 0.937 +- 0.172 (in-sample avg dev_std = 0.307)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09340794223826715
len(reference) = 277
Effective ratio: 0.315 +- 0.189
Model Accuracy over intervened graphs for r=0.01 =  0.998
NEC for r=0.01 class 1.0 = 0.003 +- 0.060 (in-sample avg dev_std = 0.084)
NEC for r=0.01 all KL = 0.006 +- 0.060 (in-sample avg dev_std = 0.084)
NEC for r=0.01 all L1 = 0.003 +- 0.034 (in-sample avg dev_std = 0.084)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08869314079422382
len(reference) = 277
Effective ratio: 0.168 +- 0.136
Model Accuracy over intervened graphs for r=0.1 =  0.995
NEC for r=0.1 class 1.0 = 0.006 +- 0.086 (in-sample avg dev_std = 0.103)
NEC for r=0.1 all KL = 0.009 +- 0.086 (in-sample avg dev_std = 0.103)
NEC for r=0.1 all L1 = 0.006 +- 0.057 (in-sample avg dev_std = 0.103)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.06991696750902528
len(reference) = 277
Effective ratio: 0.027 +- 0.051
Model Accuracy over intervened graphs for r=0.25 =  0.997
NEC for r=0.25 class 1.0 = 0.003 +- 0.063 (in-sample avg dev_std = 0.077)
NEC for r=0.25 all KL = 0.005 +- 0.063 (in-sample avg dev_std = 0.077)
NEC for r=0.25 all L1 = 0.003 +- 0.042 (in-sample avg dev_std = 0.077)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07038628158844765
len(reference) = 277
Effective ratio: 0.020 +- 0.019
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.762
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012090873015873017
len(reference) = 2520
Effective ratio: 0.106 +- 0.032
Model Accuracy over intervened graphs for r=0.01 =  0.75
NEC for r=0.01 class 1.0 = 0.021 +- 0.106 (in-sample avg dev_std = 0.121)
NEC for r=0.01 all KL = 0.022 +- 0.106 (in-sample avg dev_std = 0.121)
NEC for r=0.01 all L1 = 0.021 +- 0.084 (in-sample avg dev_std = 0.121)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011874999999999998
len(reference) = 2520
Effective ratio: 0.024 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.751
NEC for r=0.1 class 1.0 = 0.018 +- 0.101 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all KL = 0.016 +- 0.101 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all L1 = 0.018 +- 0.090 (in-sample avg dev_std = 0.061)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.762
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.010976190476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.25 =  0.761
NEC for r=0.25 class 1.0 = 0.001 +- 0.014 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.014 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.001 +- 0.017 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.010976190476190476
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.761
NEC for r=0.6 class 1.0 = 0.001 +- 0.014 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.014 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.001 +- 0.017 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.977
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11205429497568882
len(reference) = 2468
Effective ratio: 0.268 +- 0.372
Model Accuracy over intervened graphs for r=0.01 =  0.962
NEC for r=0.01 class 1.0 = 0.051 +- 0.226 (in-sample avg dev_std = 0.286)
NEC for r=0.01 all KL = 0.078 +- 0.226 (in-sample avg dev_std = 0.286)
NEC for r=0.01 all L1 = 0.051 +- 0.154 (in-sample avg dev_std = 0.286)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11165883306320908
len(reference) = 2468
Effective ratio: 0.209 +- 0.326
Model Accuracy over intervened graphs for r=0.1 =  0.964
NEC for r=0.1 class 1.0 = 0.05 +- 0.224 (in-sample avg dev_std = 0.273)
NEC for r=0.1 all KL = 0.074 +- 0.224 (in-sample avg dev_std = 0.273)
NEC for r=0.1 all L1 = 0.05 +- 0.157 (in-sample avg dev_std = 0.273)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.977
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09752836304700162
len(reference) = 2468
Effective ratio: 0.120 +- 0.274
Model Accuracy over intervened graphs for r=0.25 =  0.968
NEC for r=0.25 class 1.0 = 0.039 +- 0.197 (in-sample avg dev_std = 0.217)
NEC for r=0.25 all KL = 0.054 +- 0.197 (in-sample avg dev_std = 0.217)
NEC for r=0.25 all L1 = 0.039 +- 0.145 (in-sample avg dev_std = 0.217)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.977
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.048913695299837925
len(reference) = 2468
Effective ratio: 0.027 +- 0.043
Model Accuracy over intervened graphs for r=0.6 =  0.97
NEC for r=0.6 class 1.0 = 0.02 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.021 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.02 +- 0.120 (in-sample avg dev_std = 0.000)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 04:05:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 04:05:44 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 04:05:44 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 04:05:44 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 04:05:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:05:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 04:05:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:05:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 04:05:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:05:44 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 04:05:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.090
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.089
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.085
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.061
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.013
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.013
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.111
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.110
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.109
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.087


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09029241877256318
len(reference) = 274
Effective ratio: 0.230 +- 0.170
Model Accuracy over intervened graphs for r=0.01 =  0.994
SUFF_SIMPLE for r=0.01 class 1.0 = 0.99 +- 0.124 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.01 all KL = 0.976 +- 0.124 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.01 all L1 = 0.99 +- 0.053 (in-sample avg dev_std = 0.149)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08892057761732852
len(reference) = 277
Effective ratio: 0.166 +- 0.130
Model Accuracy over intervened graphs for r=0.1 =  0.992
SUFF_SIMPLE for r=0.1 class 1.0 = 0.986 +- 0.143 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.1 all KL = 0.965 +- 0.143 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.1 all L1 = 0.986 +- 0.058 (in-sample avg dev_std = 0.177)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08524548736462094
len(reference) = 277
Effective ratio: 0.128 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.992
SUFF_SIMPLE for r=0.25 class 1.0 = 0.987 +- 0.138 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.25 all KL = 0.97 +- 0.138 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.25 all L1 = 0.987 +- 0.061 (in-sample avg dev_std = 0.167)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.06067148014440432
len(reference) = 277
Effective ratio: 0.024 +- 0.030
Model Accuracy over intervened graphs for r=0.6 =  0.993
SUFF_SIMPLE for r=0.6 class 1.0 = 0.988 +- 0.130 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.6 all KL = 0.973 +- 0.130 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.6 all L1 = 0.988 +- 0.057 (in-sample avg dev_std = 0.159)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.891
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012509126984126985
len(reference) = 2520
Effective ratio: 0.049 +- 0.015
Model Accuracy over intervened graphs for r=0.01 =  0.89
SUFF_SIMPLE for r=0.01 class 1.0 = 0.999 +- 0.039 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.01 all KL = 0.998 +- 0.039 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.01 all L1 = 0.999 +- 0.018 (in-sample avg dev_std = 0.047)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012418650793650794
len(reference) = 2520
Effective ratio: 0.026 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.89
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.041 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.1 all KL = 0.997 +- 0.041 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.1 all L1 = 0.999 +- 0.019 (in-sample avg dev_std = 0.051)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.891
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.012612301587301587
len(reference) = 2520
Effective ratio: 0.019 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.89
SUFF_SIMPLE for r=0.25 class 1.0 = 0.999 +- 0.042 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.25 all KL = 0.997 +- 0.042 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.25 all L1 = 0.999 +- 0.017 (in-sample avg dev_std = 0.053)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.012826587301587302
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.89
SUFF_SIMPLE for r=0.6 class 1.0 = 0.998 +- 0.043 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.6 all KL = 0.997 +- 0.043 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.6 all L1 = 0.998 +- 0.020 (in-sample avg dev_std = 0.055)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11105186385737438
len(reference) = 2110
Effective ratio: 0.250 +- 0.354
Model Accuracy over intervened graphs for r=0.01 =  0.991
SUFF_SIMPLE for r=0.01 class 1.0 = 0.986 +- 0.139 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.01 all KL = 0.968 +- 0.139 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.01 all L1 = 0.986 +- 0.065 (in-sample avg dev_std = 0.166)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11046555915721233
len(reference) = 2246
Effective ratio: 0.203 +- 0.307
Model Accuracy over intervened graphs for r=0.1 =  0.991
SUFF_SIMPLE for r=0.1 class 1.0 = 0.986 +- 0.139 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.1 all KL = 0.968 +- 0.139 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.1 all L1 = 0.986 +- 0.066 (in-sample avg dev_std = 0.167)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10862682333873583
len(reference) = 2345
Effective ratio: 0.167 +- 0.275
Model Accuracy over intervened graphs for r=0.25 =  0.99
SUFF_SIMPLE for r=0.25 class 1.0 = 0.986 +- 0.140 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.25 all KL = 0.969 +- 0.140 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.25 all L1 = 0.986 +- 0.071 (in-sample avg dev_std = 0.160)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08661021069692058
len(reference) = 2442
Effective ratio: 0.068 +- 0.176
Model Accuracy over intervened graphs for r=0.6 =  0.985
SUFF_SIMPLE for r=0.6 class 1.0 = 0.978 +- 0.177 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.6 all KL = 0.952 +- 0.177 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.6 all L1 = 0.978 +- 0.091 (in-sample avg dev_std = 0.206)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09029241877256318
len(reference) = 277
Effective ratio: 0.230 +- 0.170
Model Accuracy over intervened graphs for r=0.01 =  0.997
NEC for r=0.01 class 1.0 = 0.004 +- 0.085 (in-sample avg dev_std = 0.099)
NEC for r=0.01 all KL = 0.01 +- 0.085 (in-sample avg dev_std = 0.099)
NEC for r=0.01 all L1 = 0.004 +- 0.038 (in-sample avg dev_std = 0.099)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08892057761732852
len(reference) = 277
Effective ratio: 0.166 +- 0.130
Model Accuracy over intervened graphs for r=0.1 =  0.998
NEC for r=0.1 class 1.0 = 0.003 +- 0.074 (in-sample avg dev_std = 0.083)
NEC for r=0.1 all KL = 0.006 +- 0.074 (in-sample avg dev_std = 0.083)
NEC for r=0.1 all L1 = 0.003 +- 0.039 (in-sample avg dev_std = 0.083)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08524548736462094
len(reference) = 277
Effective ratio: 0.128 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.997
NEC for r=0.25 class 1.0 = 0.004 +- 0.081 (in-sample avg dev_std = 0.093)
NEC for r=0.25 all KL = 0.008 +- 0.081 (in-sample avg dev_std = 0.093)
NEC for r=0.25 all L1 = 0.004 +- 0.042 (in-sample avg dev_std = 0.093)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.06067148014440432
len(reference) = 277
Effective ratio: 0.024 +- 0.030
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.891
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.012509126984126985
len(reference) = 2520
Effective ratio: 0.049 +- 0.015
Model Accuracy over intervened graphs for r=0.01 =  0.89
NEC for r=0.01 class 1.0 = 0.001 +- 0.032 (in-sample avg dev_std = 0.033)
NEC for r=0.01 all KL = 0.001 +- 0.032 (in-sample avg dev_std = 0.033)
NEC for r=0.01 all L1 = 0.001 +- 0.022 (in-sample avg dev_std = 0.033)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012418650793650794
len(reference) = 2520
Effective ratio: 0.026 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.89
NEC for r=0.1 class 1.0 = 0.0 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.017 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.891
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.012612301587301587
len(reference) = 2520
Effective ratio: 0.019 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.891
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.012826587301587302
len(reference) = 2520
Effective ratio: 0.004 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.891
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11105186385737438
len(reference) = 2468
Effective ratio: 0.250 +- 0.354
Model Accuracy over intervened graphs for r=0.01 =  0.991
NEC for r=0.01 class 1.0 = 0.014 +- 0.140 (in-sample avg dev_std = 0.161)
NEC for r=0.01 all KL = 0.029 +- 0.140 (in-sample avg dev_std = 0.161)
NEC for r=0.01 all L1 = 0.014 +- 0.073 (in-sample avg dev_std = 0.161)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11046555915721233
len(reference) = 2468
Effective ratio: 0.203 +- 0.307
Model Accuracy over intervened graphs for r=0.1 =  0.991
NEC for r=0.1 class 1.0 = 0.012 +- 0.133 (in-sample avg dev_std = 0.148)
NEC for r=0.1 all KL = 0.024 +- 0.133 (in-sample avg dev_std = 0.148)
NEC for r=0.1 all L1 = 0.012 +- 0.076 (in-sample avg dev_std = 0.148)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10862682333873583
len(reference) = 2468
Effective ratio: 0.167 +- 0.275
Model Accuracy over intervened graphs for r=0.25 =  0.991
NEC for r=0.25 class 1.0 = 0.013 +- 0.134 (in-sample avg dev_std = 0.142)
NEC for r=0.25 all KL = 0.023 +- 0.134 (in-sample avg dev_std = 0.142)
NEC for r=0.25 all L1 = 0.013 +- 0.080 (in-sample avg dev_std = 0.142)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08661021069692058
len(reference) = 2468
Effective ratio: 0.068 +- 0.176
Model Accuracy over intervened graphs for r=0.6 =  0.993
NEC for r=0.6 class 1.0 = 0.007 +- 0.097 (in-sample avg dev_std = 0.062)
NEC for r=0.6 all KL = 0.01 +- 0.097 (in-sample avg dev_std = 0.062)
NEC for r=0.6 all L1 = 0.007 +- 0.074 (in-sample avg dev_std = 0.062)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 04:11:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 04:11:05 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 04:11:05 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 04:11:05 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 04:11:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:11:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 04:11:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:11:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 04:11:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:11:05 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 04:11:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.091
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.088
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.084
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.014
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.014
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.113
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.113
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.111
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.089


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09149458483754512
len(reference) = 242
Effective ratio: 0.514 +- 0.279
Model Accuracy over intervened graphs for r=0.01 =  1.0
SUFF_SIMPLE for r=0.01 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.01 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08826353790613718
len(reference) = 270
Effective ratio: 0.212 +- 0.208
Model Accuracy over intervened graphs for r=0.1 =  0.999
SUFF_SIMPLE for r=0.1 class 1.0 = 0.997 +- 0.053 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.1 all KL = 0.994 +- 0.053 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.1 all L1 = 0.997 +- 0.023 (in-sample avg dev_std = 0.074)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08374368231046933
len(reference) = 275
Effective ratio: 0.126 +- 0.139
Model Accuracy over intervened graphs for r=0.25 =  0.998
SUFF_SIMPLE for r=0.25 class 1.0 = 0.996 +- 0.071 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.25 all KL = 0.992 +- 0.071 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.25 all L1 = 0.996 +- 0.037 (in-sample avg dev_std = 0.089)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03984476534296029
len(reference) = 277
Effective ratio: 0.027 +- 0.049
Model Accuracy over intervened graphs for r=0.6 =  0.995
SUFF_SIMPLE for r=0.6 class 1.0 = 0.993 +- 0.099 (in-sample avg dev_std = 0.114)
SUFF_SIMPLE for r=0.6 all KL = 0.986 +- 0.099 (in-sample avg dev_std = 0.114)
SUFF_SIMPLE for r=0.6 all L1 = 0.993 +- 0.060 (in-sample avg dev_std = 0.114)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.94
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013517857142857142
len(reference) = 2520
Effective ratio: 0.109 +- 0.034
Model Accuracy over intervened graphs for r=0.01 =  0.937
SUFF_SIMPLE for r=0.01 class 1.0 = 0.996 +- 0.064 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.01 all KL = 0.994 +- 0.064 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.01 all L1 = 0.996 +- 0.045 (in-sample avg dev_std = 0.071)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013257936507936507
len(reference) = 2520
Effective ratio: 0.026 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.936
SUFF_SIMPLE for r=0.1 class 1.0 = 0.996 +- 0.069 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.1 all KL = 0.993 +- 0.069 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.1 all L1 = 0.996 +- 0.044 (in-sample avg dev_std = 0.081)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.94
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01353968253968254
len(reference) = 2520
Effective ratio: 0.016 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.937
SUFF_SIMPLE for r=0.25 class 1.0 = 0.997 +- 0.061 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.25 all KL = 0.994 +- 0.061 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.25 all L1 = 0.997 +- 0.040 (in-sample avg dev_std = 0.071)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.012710714285714285
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.937
SUFF_SIMPLE for r=0.6 class 1.0 = 0.996 +- 0.065 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.6 all KL = 0.994 +- 0.065 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.6 all L1 = 0.996 +- 0.043 (in-sample avg dev_std = 0.073)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11274513776337115
len(reference) = 1915
Effective ratio: 0.310 +- 0.406
Model Accuracy over intervened graphs for r=0.01 =  0.999
SUFF_SIMPLE for r=0.01 class 1.0 = 0.999 +- 0.035 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.01 all KL = 0.998 +- 0.035 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.01 all L1 = 0.999 +- 0.019 (in-sample avg dev_std = 0.042)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11258589951377634
len(reference) = 2066
Effective ratio: 0.250 +- 0.370
Model Accuracy over intervened graphs for r=0.1 =  0.988
SUFF_SIMPLE for r=0.1 class 1.0 = 0.987 +- 0.131 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.1 all KL = 0.979 +- 0.131 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.1 all L1 = 0.987 +- 0.090 (in-sample avg dev_std = 0.125)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.992
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.1108776337115073
len(reference) = 2190
Effective ratio: 0.199 +- 0.331
Model Accuracy over intervened graphs for r=0.25 =  0.983
SUFF_SIMPLE for r=0.25 class 1.0 = 0.98 +- 0.159 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.25 all KL = 0.966 +- 0.159 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.25 all L1 = 0.98 +- 0.102 (in-sample avg dev_std = 0.171)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.982
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08873298217179902
len(reference) = 2444
Effective ratio: 0.086 +- 0.197
Model Accuracy over intervened graphs for r=0.6 =  0.972
SUFF_SIMPLE for r=0.6 class 1.0 = 0.962 +- 0.215 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.6 all KL = 0.939 +- 0.215 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.6 all L1 = 0.962 +- 0.146 (in-sample avg dev_std = 0.221)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09149458483754512
len(reference) = 277
Effective ratio: 0.514 +- 0.279
Model Accuracy over intervened graphs for r=0.01 =  1.0
NEC for r=0.01 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.01 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08826353790613718
len(reference) = 277
Effective ratio: 0.212 +- 0.208
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.08374368231046933
len(reference) = 277
Effective ratio: 0.126 +- 0.139
Model Accuracy over intervened graphs for r=0.25 =  1.0
NEC for r=0.25 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03984476534296029
len(reference) = 277
Effective ratio: 0.027 +- 0.049
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.94
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013517857142857142
len(reference) = 2520
Effective ratio: 0.109 +- 0.034
Model Accuracy over intervened graphs for r=0.01 =  0.939
NEC for r=0.01 class 1.0 = 0.001 +- 0.028 (in-sample avg dev_std = 0.027)
NEC for r=0.01 all KL = 0.001 +- 0.028 (in-sample avg dev_std = 0.027)
NEC for r=0.01 all L1 = 0.001 +- 0.023 (in-sample avg dev_std = 0.027)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013257936507936507
len(reference) = 2520
Effective ratio: 0.026 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.939
NEC for r=0.1 class 1.0 = 0.001 +- 0.028 (in-sample avg dev_std = 0.017)
NEC for r=0.1 all KL = 0.001 +- 0.028 (in-sample avg dev_std = 0.017)
NEC for r=0.1 all L1 = 0.001 +- 0.023 (in-sample avg dev_std = 0.017)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.94
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.01353968253968254
len(reference) = 2520
Effective ratio: 0.016 +- 0.003
Model Accuracy over intervened graphs for r=0.25 =  0.939
NEC for r=0.25 class 1.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all KL = 0.0 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.25 all L1 = 0.0 +- 0.014 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.012710714285714285
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.939
NEC for r=0.6 class 1.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.010 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.014 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.982
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11274513776337115
len(reference) = 2468
Effective ratio: 0.310 +- 0.406
Model Accuracy over intervened graphs for r=0.01 =  0.972
NEC for r=0.01 class 1.0 = 0.041 +- 0.228 (in-sample avg dev_std = 0.272)
NEC for r=0.01 all KL = 0.074 +- 0.228 (in-sample avg dev_std = 0.272)
NEC for r=0.01 all L1 = 0.041 +- 0.137 (in-sample avg dev_std = 0.272)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11258589951377634
len(reference) = 2468
Effective ratio: 0.250 +- 0.370
Model Accuracy over intervened graphs for r=0.1 =  0.973
NEC for r=0.1 class 1.0 = 0.04 +- 0.224 (in-sample avg dev_std = 0.264)
NEC for r=0.1 all KL = 0.07 +- 0.224 (in-sample avg dev_std = 0.264)
NEC for r=0.1 all L1 = 0.04 +- 0.137 (in-sample avg dev_std = 0.264)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.982
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.1108776337115073
len(reference) = 2468
Effective ratio: 0.199 +- 0.331
Model Accuracy over intervened graphs for r=0.25 =  0.972
NEC for r=0.25 class 1.0 = 0.041 +- 0.229 (in-sample avg dev_std = 0.268)
NEC for r=0.25 all KL = 0.072 +- 0.229 (in-sample avg dev_std = 0.268)
NEC for r=0.25 all L1 = 0.041 +- 0.140 (in-sample avg dev_std = 0.268)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.982
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08873298217179902
len(reference) = 2468
Effective ratio: 0.086 +- 0.197
Model Accuracy over intervened graphs for r=0.6 =  0.977
NEC for r=0.6 class 1.0 = 0.026 +- 0.176 (in-sample avg dev_std = 0.142)
NEC for r=0.6 all KL = 0.037 +- 0.176 (in-sample avg dev_std = 0.142)
NEC for r=0.6 all L1 = 0.026 +- 0.134 (in-sample avg dev_std = 0.142)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 04:16:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 04:16:34 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 04:16:34 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 04:16:34 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 04:16:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:16:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 04:16:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:16:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 04:16:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:16:34 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 04:16:34 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.094
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.092
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.090
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.055
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.014
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.014
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.014
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.112
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.112
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.110
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.089


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09387725631768952
len(reference) = 257
Effective ratio: 0.371 +- 0.272
Model Accuracy over intervened graphs for r=0.01 =  0.983
SUFF_SIMPLE for r=0.01 class 1.0 = 0.973 +- 0.192 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.01 all KL = 0.942 +- 0.192 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.01 all L1 = 0.973 +- 0.096 (in-sample avg dev_std = 0.238)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.09160288808664259
len(reference) = 276
Effective ratio: 0.156 +- 0.151
Model Accuracy over intervened graphs for r=0.1 =  0.962
SUFF_SIMPLE for r=0.1 class 1.0 = 0.945 +- 0.259 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.1 all KL = 0.891 +- 0.259 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.1 all L1 = 0.945 +- 0.141 (in-sample avg dev_std = 0.326)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09044404332129963
len(reference) = 277
Effective ratio: 0.139 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.951
SUFF_SIMPLE for r=0.25 class 1.0 = 0.934 +- 0.280 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.25 all KL = 0.876 +- 0.280 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.25 all L1 = 0.934 +- 0.165 (in-sample avg dev_std = 0.341)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.054642599277978335
len(reference) = 277
Effective ratio: 0.023 +- 0.035
Model Accuracy over intervened graphs for r=0.6 =  0.951
SUFF_SIMPLE for r=0.6 class 1.0 = 0.93 +- 0.288 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.6 all KL = 0.869 +- 0.288 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.6 all L1 = 0.93 +- 0.167 (in-sample avg dev_std = 0.365)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013948015873015874
len(reference) = 2520
Effective ratio: 0.048 +- 0.016
Model Accuracy over intervened graphs for r=0.01 =  0.993
SUFF_SIMPLE for r=0.01 class 1.0 = 0.989 +- 0.115 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.01 all KL = 0.976 +- 0.115 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.01 all L1 = 0.989 +- 0.053 (in-sample avg dev_std = 0.154)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014033730158730159
len(reference) = 2520
Effective ratio: 0.024 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.993
SUFF_SIMPLE for r=0.1 class 1.0 = 0.989 +- 0.113 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.1 all KL = 0.976 +- 0.113 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.1 all L1 = 0.989 +- 0.054 (in-sample avg dev_std = 0.155)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013994444444444443
len(reference) = 2520
Effective ratio: 0.023 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.994
SUFF_SIMPLE for r=0.25 class 1.0 = 0.99 +- 0.107 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.25 all KL = 0.979 +- 0.107 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.25 all L1 = 0.99 +- 0.049 (in-sample avg dev_std = 0.143)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.014190476190476193
len(reference) = 2520
Effective ratio: 0.003 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.992
SUFF_SIMPLE for r=0.6 class 1.0 = 0.987 +- 0.120 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.6 all KL = 0.973 +- 0.120 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.6 all L1 = 0.987 +- 0.058 (in-sample avg dev_std = 0.164)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.997
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.1123982982171799
len(reference) = 1988
Effective ratio: 0.284 +- 0.395
Model Accuracy over intervened graphs for r=0.01 =  0.973
SUFF_SIMPLE for r=0.01 class 1.0 = 0.967 +- 0.203 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.01 all KL = 0.943 +- 0.203 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.01 all L1 = 0.967 +- 0.129 (in-sample avg dev_std = 0.218)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.111652755267423
len(reference) = 2182
Effective ratio: 0.210 +- 0.336
Model Accuracy over intervened graphs for r=0.1 =  0.927
SUFF_SIMPLE for r=0.1 class 1.0 = 0.922 +- 0.299 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.1 all KL = 0.877 +- 0.299 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.1 all L1 = 0.922 +- 0.204 (in-sample avg dev_std = 0.328)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.967
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10954862236628848
len(reference) = 2368
Effective ratio: 0.167 +- 0.270
Model Accuracy over intervened graphs for r=0.25 =  0.919
SUFF_SIMPLE for r=0.25 class 1.0 = 0.905 +- 0.324 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.25 all KL = 0.854 +- 0.324 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.25 all L1 = 0.905 +- 0.226 (in-sample avg dev_std = 0.353)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.966
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08894327390599675
len(reference) = 2442
Effective ratio: 0.083 +- 0.187
Model Accuracy over intervened graphs for r=0.6 =  0.91
SUFF_SIMPLE for r=0.6 class 1.0 = 0.894 +- 0.338 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.6 all KL = 0.835 +- 0.338 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.6 all L1 = 0.894 +- 0.234 (in-sample avg dev_std = 0.377)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09387725631768952
len(reference) = 277
Effective ratio: 0.371 +- 0.272
Model Accuracy over intervened graphs for r=0.01 =  0.993
NEC for r=0.01 class 1.0 = 0.011 +- 0.121 (in-sample avg dev_std = 0.147)
NEC for r=0.01 all KL = 0.022 +- 0.121 (in-sample avg dev_std = 0.147)
NEC for r=0.01 all L1 = 0.011 +- 0.064 (in-sample avg dev_std = 0.147)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.09160288808664259
len(reference) = 277
Effective ratio: 0.156 +- 0.151
Model Accuracy over intervened graphs for r=0.1 =  0.991
NEC for r=0.1 class 1.0 = 0.014 +- 0.141 (in-sample avg dev_std = 0.166)
NEC for r=0.1 all KL = 0.027 +- 0.141 (in-sample avg dev_std = 0.166)
NEC for r=0.1 all L1 = 0.014 +- 0.074 (in-sample avg dev_std = 0.166)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09044404332129963
len(reference) = 277
Effective ratio: 0.139 +- 0.107
Model Accuracy over intervened graphs for r=0.25 =  0.992
NEC for r=0.25 class 1.0 = 0.013 +- 0.135 (in-sample avg dev_std = 0.158)
NEC for r=0.25 all KL = 0.025 +- 0.135 (in-sample avg dev_std = 0.158)
NEC for r=0.25 all L1 = 0.013 +- 0.069 (in-sample avg dev_std = 0.158)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.054642599277978335
len(reference) = 277
Effective ratio: 0.023 +- 0.035
Model Accuracy over intervened graphs for r=0.6 =  0.986
NEC for r=0.6 class 1.0 = 0.013 +- 0.126 (in-sample avg dev_std = 0.083)
NEC for r=0.6 all KL = 0.017 +- 0.126 (in-sample avg dev_std = 0.083)
NEC for r=0.6 all L1 = 0.013 +- 0.099 (in-sample avg dev_std = 0.083)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013948015873015874
len(reference) = 2520
Effective ratio: 0.048 +- 0.016
Model Accuracy over intervened graphs for r=0.01 =  0.999
NEC for r=0.01 class 1.0 = 0.002 +- 0.048 (in-sample avg dev_std = 0.061)
NEC for r=0.01 all KL = 0.004 +- 0.048 (in-sample avg dev_std = 0.061)
NEC for r=0.01 all L1 = 0.002 +- 0.025 (in-sample avg dev_std = 0.061)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014033730158730159
len(reference) = 2520
Effective ratio: 0.024 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.998
NEC for r=0.1 class 1.0 = 0.001 +- 0.041 (in-sample avg dev_std = 0.020)
NEC for r=0.1 all KL = 0.002 +- 0.041 (in-sample avg dev_std = 0.020)
NEC for r=0.1 all L1 = 0.001 +- 0.034 (in-sample avg dev_std = 0.020)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013994444444444443
len(reference) = 2520
Effective ratio: 0.023 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.999
NEC for r=0.25 class 1.0 = 0.001 +- 0.040 (in-sample avg dev_std = 0.019)
NEC for r=0.25 all KL = 0.002 +- 0.040 (in-sample avg dev_std = 0.019)
NEC for r=0.25 all L1 = 0.001 +- 0.033 (in-sample avg dev_std = 0.019)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.014190476190476193
len(reference) = 2520
Effective ratio: 0.003 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  1.0
NEC for r=0.6 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.966
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.1123982982171799
len(reference) = 2468
Effective ratio: 0.284 +- 0.395
Model Accuracy over intervened graphs for r=0.01 =  0.932
NEC for r=0.01 class 1.0 = 0.084 +- 0.312 (in-sample avg dev_std = 0.382)
NEC for r=0.01 all KL = 0.143 +- 0.312 (in-sample avg dev_std = 0.382)
NEC for r=0.01 all L1 = 0.084 +- 0.197 (in-sample avg dev_std = 0.382)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.966
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.111652755267423
len(reference) = 2468
Effective ratio: 0.210 +- 0.336
Model Accuracy over intervened graphs for r=0.1 =  0.928
NEC for r=0.1 class 1.0 = 0.082 +- 0.309 (in-sample avg dev_std = 0.365)
NEC for r=0.1 all KL = 0.134 +- 0.309 (in-sample avg dev_std = 0.365)
NEC for r=0.1 all L1 = 0.082 +- 0.201 (in-sample avg dev_std = 0.365)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.966
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.10954862236628848
len(reference) = 2468
Effective ratio: 0.167 +- 0.270
Model Accuracy over intervened graphs for r=0.25 =  0.929
NEC for r=0.25 class 1.0 = 0.076 +- 0.295 (in-sample avg dev_std = 0.321)
NEC for r=0.25 all KL = 0.119 +- 0.295 (in-sample avg dev_std = 0.321)
NEC for r=0.25 all L1 = 0.076 +- 0.201 (in-sample avg dev_std = 0.321)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.966
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.08894327390599675
len(reference) = 2468
Effective ratio: 0.083 +- 0.187
Model Accuracy over intervened graphs for r=0.6 =  0.941
NEC for r=0.6 class 1.0 = 0.043 +- 0.221 (in-sample avg dev_std = 0.145)
NEC for r=0.6 all KL = 0.057 +- 0.221 (in-sample avg dev_std = 0.145)
NEC for r=0.6 all L1 = 0.043 +- 0.175 (in-sample avg dev_std = 0.145)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 04:21:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 04:21:38 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 04:21:38 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 04:21:38 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 04:21:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:21:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 04:21:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:21:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 04:21:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:21:38 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 04:21:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.101
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.100
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.099
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.057
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.013
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.013
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.113
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.113
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.112
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.099


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10103971119133574
len(reference) = 242
Effective ratio: 0.641 +- 0.222
Model Accuracy over intervened graphs for r=0.01 =  0.997
SUFF_SIMPLE for r=0.01 class 1.0 = 0.995 +- 0.072 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.01 all KL = 0.99 +- 0.072 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.01 all L1 = 0.995 +- 0.037 (in-sample avg dev_std = 0.105)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.10011913357400722
len(reference) = 269
Effective ratio: 0.241 +- 0.207
Model Accuracy over intervened graphs for r=0.1 =  0.994
SUFF_SIMPLE for r=0.1 class 1.0 = 0.99 +- 0.101 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.1 all KL = 0.978 +- 0.101 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.1 all L1 = 0.99 +- 0.049 (in-sample avg dev_std = 0.147)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.0986101083032491
len(reference) = 276
Effective ratio: 0.152 +- 0.141
Model Accuracy over intervened graphs for r=0.25 =  0.995
SUFF_SIMPLE for r=0.25 class 1.0 = 0.992 +- 0.094 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.25 all KL = 0.985 +- 0.094 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.25 all L1 = 0.992 +- 0.054 (in-sample avg dev_std = 0.131)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05745487364620938
len(reference) = 277
Effective ratio: 0.030 +- 0.056
Model Accuracy over intervened graphs for r=0.6 =  0.991
SUFF_SIMPLE for r=0.6 class 1.0 = 0.988 +- 0.115 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.6 all KL = 0.979 +- 0.115 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.6 all L1 = 0.988 +- 0.074 (in-sample avg dev_std = 0.138)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.638
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013122619047619048
len(reference) = 2520
Effective ratio: 0.286 +- 0.071
Model Accuracy over intervened graphs for r=0.01 =  0.495
SUFF_SIMPLE for r=0.01 class 1.0 = 0.828 +- 0.358 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.01 all KL = 0.767 +- 0.358 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.01 all L1 = 0.828 +- 0.274 (in-sample avg dev_std = 0.440)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013186507936507936
len(reference) = 2520
Effective ratio: 0.043 +- 0.013
Model Accuracy over intervened graphs for r=0.1 =  0.492
SUFF_SIMPLE for r=0.1 class 1.0 = 0.824 +- 0.360 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.1 all KL = 0.76 +- 0.360 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.1 all L1 = 0.824 +- 0.274 (in-sample avg dev_std = 0.452)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.638
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013166666666666669
len(reference) = 2520
Effective ratio: 0.022 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.494
SUFF_SIMPLE for r=0.25 class 1.0 = 0.828 +- 0.358 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.25 all KL = 0.767 +- 0.358 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.25 all L1 = 0.828 +- 0.275 (in-sample avg dev_std = 0.438)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.638
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.011692857142857142
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.493
SUFF_SIMPLE for r=0.6 class 1.0 = 0.826 +- 0.359 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.6 all KL = 0.763 +- 0.359 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.6 all L1 = 0.826 +- 0.275 (in-sample avg dev_std = 0.443)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11334238249594814
len(reference) = 1901
Effective ratio: 0.323 +- 0.412
Model Accuracy over intervened graphs for r=0.01 =  0.997
SUFF_SIMPLE for r=0.01 class 1.0 = 0.997 +- 0.061 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.01 all KL = 0.995 +- 0.061 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.01 all L1 = 0.997 +- 0.043 (in-sample avg dev_std = 0.060)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1131114262560778
len(reference) = 2053
Effective ratio: 0.258 +- 0.374
Model Accuracy over intervened graphs for r=0.1 =  0.985
SUFF_SIMPLE for r=0.1 class 1.0 = 0.982 +- 0.145 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.1 all KL = 0.971 +- 0.145 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.1 all L1 = 0.982 +- 0.099 (in-sample avg dev_std = 0.158)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.998
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11242260940032416
len(reference) = 2177
Effective ratio: 0.209 +- 0.336
Model Accuracy over intervened graphs for r=0.25 =  0.976
SUFF_SIMPLE for r=0.25 class 1.0 = 0.971 +- 0.183 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.25 all KL = 0.953 +- 0.183 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.25 all L1 = 0.971 +- 0.122 (in-sample avg dev_std = 0.208)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.09925688816855754
len(reference) = 2376
Effective ratio: 0.115 +- 0.257
Model Accuracy over intervened graphs for r=0.6 =  0.96
SUFF_SIMPLE for r=0.6 class 1.0 = 0.953 +- 0.228 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.6 all KL = 0.928 +- 0.228 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.6 all L1 = 0.953 +- 0.161 (in-sample avg dev_std = 0.243)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.10103971119133574
len(reference) = 277
Effective ratio: 0.641 +- 0.222
Model Accuracy over intervened graphs for r=0.01 =  0.998
NEC for r=0.01 class 1.0 = 0.002 +- 0.055 (in-sample avg dev_std = 0.063)
NEC for r=0.01 all KL = 0.003 +- 0.055 (in-sample avg dev_std = 0.063)
NEC for r=0.01 all L1 = 0.002 +- 0.038 (in-sample avg dev_std = 0.063)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.10011913357400722
len(reference) = 277
Effective ratio: 0.241 +- 0.207
Model Accuracy over intervened graphs for r=0.1 =  0.997
NEC for r=0.1 class 1.0 = 0.004 +- 0.070 (in-sample avg dev_std = 0.092)
NEC for r=0.1 all KL = 0.007 +- 0.070 (in-sample avg dev_std = 0.092)
NEC for r=0.1 all L1 = 0.004 +- 0.041 (in-sample avg dev_std = 0.092)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.0986101083032491
len(reference) = 277
Effective ratio: 0.152 +- 0.141
Model Accuracy over intervened graphs for r=0.25 =  0.998
NEC for r=0.25 class 1.0 = 0.002 +- 0.055 (in-sample avg dev_std = 0.063)
NEC for r=0.25 all KL = 0.003 +- 0.055 (in-sample avg dev_std = 0.063)
NEC for r=0.25 all L1 = 0.002 +- 0.038 (in-sample avg dev_std = 0.063)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05745487364620938
len(reference) = 277
Effective ratio: 0.030 +- 0.056
Model Accuracy over intervened graphs for r=0.6 =  0.999
NEC for r=0.6 class 1.0 = 0.001 +- 0.043 (in-sample avg dev_std = 0.055)
NEC for r=0.6 all KL = 0.003 +- 0.043 (in-sample avg dev_std = 0.055)
NEC for r=0.6 all L1 = 0.001 +- 0.023 (in-sample avg dev_std = 0.055)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.638
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013122619047619048
len(reference) = 2520
Effective ratio: 0.286 +- 0.071
Model Accuracy over intervened graphs for r=0.01 =  0.58
NEC for r=0.01 class 1.0 = 0.074 +- 0.252 (in-sample avg dev_std = 0.290)
NEC for r=0.01 all KL = 0.101 +- 0.252 (in-sample avg dev_std = 0.290)
NEC for r=0.01 all L1 = 0.074 +- 0.192 (in-sample avg dev_std = 0.290)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013186507936507936
len(reference) = 2520
Effective ratio: 0.043 +- 0.013
Model Accuracy over intervened graphs for r=0.1 =  0.58
NEC for r=0.1 class 1.0 = 0.067 +- 0.249 (in-sample avg dev_std = 0.241)
NEC for r=0.1 all KL = 0.084 +- 0.249 (in-sample avg dev_std = 0.241)
NEC for r=0.1 all L1 = 0.067 +- 0.198 (in-sample avg dev_std = 0.241)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.638
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013166666666666669
len(reference) = 2520
Effective ratio: 0.022 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.588
NEC for r=0.25 class 1.0 = 0.053 +- 0.220 (in-sample avg dev_std = 0.108)
NEC for r=0.25 all KL = 0.059 +- 0.220 (in-sample avg dev_std = 0.108)
NEC for r=0.25 all L1 = 0.053 +- 0.191 (in-sample avg dev_std = 0.108)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.638
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.011692857142857142
len(reference) = 2520
Effective ratio: 0.003 +- 0.001
Model Accuracy over intervened graphs for r=0.6 =  0.633
NEC for r=0.6 class 1.0 = 0.008 +- 0.067 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.007 +- 0.067 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.008 +- 0.068 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.987
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11334238249594814
len(reference) = 2468
Effective ratio: 0.323 +- 0.412
Model Accuracy over intervened graphs for r=0.01 =  0.965
NEC for r=0.01 class 1.0 = 0.044 +- 0.224 (in-sample avg dev_std = 0.287)
NEC for r=0.01 all KL = 0.074 +- 0.224 (in-sample avg dev_std = 0.287)
NEC for r=0.01 all L1 = 0.044 +- 0.140 (in-sample avg dev_std = 0.287)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1131114262560778
len(reference) = 2468
Effective ratio: 0.258 +- 0.374
Model Accuracy over intervened graphs for r=0.1 =  0.966
NEC for r=0.1 class 1.0 = 0.044 +- 0.222 (in-sample avg dev_std = 0.284)
NEC for r=0.1 all KL = 0.074 +- 0.222 (in-sample avg dev_std = 0.284)
NEC for r=0.1 all L1 = 0.044 +- 0.139 (in-sample avg dev_std = 0.284)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.987
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11242260940032416
len(reference) = 2468
Effective ratio: 0.209 +- 0.336
Model Accuracy over intervened graphs for r=0.25 =  0.966
NEC for r=0.25 class 1.0 = 0.042 +- 0.217 (in-sample avg dev_std = 0.276)
NEC for r=0.25 all KL = 0.071 +- 0.217 (in-sample avg dev_std = 0.276)
NEC for r=0.25 all L1 = 0.042 +- 0.136 (in-sample avg dev_std = 0.276)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.987
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.09925688816855754
len(reference) = 2468
Effective ratio: 0.115 +- 0.257
Model Accuracy over intervened graphs for r=0.6 =  0.973
NEC for r=0.6 class 1.0 = 0.031 +- 0.188 (in-sample avg dev_std = 0.212)
NEC for r=0.6 all KL = 0.048 +- 0.188 (in-sample avg dev_std = 0.212)
NEC for r=0.6 all L1 = 0.031 +- 0.129 (in-sample avg dev_std = 0.212)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 04:27:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 04:27:06 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 04:27:06 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 04:27:06 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 04:27:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:27:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 04:27:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:27:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 04:27:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:27:06 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 04:27:06 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.099
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.099
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.099
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.071
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.014
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.014
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.011
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.111
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.111
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.111
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.092


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09894945848375451
len(reference) = 276
Effective ratio: 0.201 +- 0.146
Model Accuracy over intervened graphs for r=0.01 =  0.98
SUFF_SIMPLE for r=0.01 class 1.0 = 0.97 +- 0.176 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.01 all KL = 0.946 +- 0.176 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.01 all L1 = 0.97 +- 0.106 (in-sample avg dev_std = 0.245)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.09866425992779786
len(reference) = 276
Effective ratio: 0.167 +- 0.135
Model Accuracy over intervened graphs for r=0.1 =  0.982
SUFF_SIMPLE for r=0.1 class 1.0 = 0.971 +- 0.169 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.1 all KL = 0.944 +- 0.169 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.1 all L1 = 0.971 +- 0.090 (in-sample avg dev_std = 0.248)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09904693140794224
len(reference) = 276
Effective ratio: 0.164 +- 0.135
Model Accuracy over intervened graphs for r=0.25 =  0.974
SUFF_SIMPLE for r=0.25 class 1.0 = 0.959 +- 0.198 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.25 all KL = 0.922 +- 0.198 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.25 all L1 = 0.959 +- 0.109 (in-sample avg dev_std = 0.295)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07073285198555956
len(reference) = 276
Effective ratio: 0.030 +- 0.072
Model Accuracy over intervened graphs for r=0.6 =  0.978
SUFF_SIMPLE for r=0.6 class 1.0 = 0.964 +- 0.184 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.6 all KL = 0.93 +- 0.184 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.6 all L1 = 0.964 +- 0.098 (in-sample avg dev_std = 0.278)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.731
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013592063492063494
len(reference) = 2520
Effective ratio: 0.034 +- 0.009
Model Accuracy over intervened graphs for r=0.01 =  0.724
SUFF_SIMPLE for r=0.01 class 1.0 = 0.988 +- 0.099 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.01 all KL = 0.978 +- 0.099 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.01 all L1 = 0.988 +- 0.050 (in-sample avg dev_std = 0.152)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01363015873015873
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.724
SUFF_SIMPLE for r=0.1 class 1.0 = 0.988 +- 0.100 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.1 all KL = 0.978 +- 0.100 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.1 all L1 = 0.988 +- 0.050 (in-sample avg dev_std = 0.154)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.731
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013629365079365081
len(reference) = 2520
Effective ratio: 0.024 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.724
SUFF_SIMPLE for r=0.25 class 1.0 = 0.989 +- 0.097 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.25 all KL = 0.979 +- 0.097 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.25 all L1 = 0.989 +- 0.049 (in-sample avg dev_std = 0.149)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.731
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.011222222222222222
len(reference) = 2520
Effective ratio: 0.004 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.724
SUFF_SIMPLE for r=0.6 class 1.0 = 0.988 +- 0.099 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.6 all KL = 0.978 +- 0.099 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.6 all L1 = 0.988 +- 0.050 (in-sample avg dev_std = 0.153)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11124230145867099
len(reference) = 2213
Effective ratio: 0.225 +- 0.330
Model Accuracy over intervened graphs for r=0.01 =  0.964
SUFF_SIMPLE for r=0.01 class 1.0 = 0.944 +- 0.221 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.01 all KL = 0.897 +- 0.221 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.01 all L1 = 0.944 +- 0.127 (in-sample avg dev_std = 0.332)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11107009724473257
len(reference) = 2306
Effective ratio: 0.193 +- 0.293
Model Accuracy over intervened graphs for r=0.1 =  0.958
SUFF_SIMPLE for r=0.1 class 1.0 = 0.938 +- 0.230 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.1 all KL = 0.886 +- 0.230 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.1 all L1 = 0.938 +- 0.137 (in-sample avg dev_std = 0.339)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11074149108589952
len(reference) = 2334
Effective ratio: 0.185 +- 0.283
Model Accuracy over intervened graphs for r=0.25 =  0.958
SUFF_SIMPLE for r=0.25 class 1.0 = 0.938 +- 0.230 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.25 all KL = 0.886 +- 0.230 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.25 all L1 = 0.938 +- 0.137 (in-sample avg dev_std = 0.341)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0918820907617504
len(reference) = 2379
Effective ratio: 0.097 +- 0.217
Model Accuracy over intervened graphs for r=0.6 =  0.943
SUFF_SIMPLE for r=0.6 class 1.0 = 0.919 +- 0.261 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.6 all KL = 0.858 +- 0.261 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.6 all L1 = 0.919 +- 0.164 (in-sample avg dev_std = 0.374)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.09894945848375451
len(reference) = 277
Effective ratio: 0.201 +- 0.146
Model Accuracy over intervened graphs for r=0.01 =  0.993
NEC for r=0.01 class 1.0 = 0.011 +- 0.108 (in-sample avg dev_std = 0.155)
NEC for r=0.01 all KL = 0.021 +- 0.108 (in-sample avg dev_std = 0.155)
NEC for r=0.01 all L1 = 0.011 +- 0.061 (in-sample avg dev_std = 0.155)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.09866425992779786
len(reference) = 277
Effective ratio: 0.167 +- 0.135
Model Accuracy over intervened graphs for r=0.1 =  0.995
NEC for r=0.1 class 1.0 = 0.008 +- 0.097 (in-sample avg dev_std = 0.133)
NEC for r=0.1 all KL = 0.016 +- 0.097 (in-sample avg dev_std = 0.133)
NEC for r=0.1 all L1 = 0.008 +- 0.049 (in-sample avg dev_std = 0.133)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09904693140794224
len(reference) = 277
Effective ratio: 0.164 +- 0.135
Model Accuracy over intervened graphs for r=0.25 =  0.995
NEC for r=0.25 class 1.0 = 0.008 +- 0.100 (in-sample avg dev_std = 0.130)
NEC for r=0.25 all KL = 0.014 +- 0.100 (in-sample avg dev_std = 0.130)
NEC for r=0.25 all L1 = 0.008 +- 0.058 (in-sample avg dev_std = 0.130)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.07073285198555956
len(reference) = 277
Effective ratio: 0.030 +- 0.072
Model Accuracy over intervened graphs for r=0.6 =  0.996
NEC for r=0.6 class 1.0 = 0.004 +- 0.066 (in-sample avg dev_std = 0.042)
NEC for r=0.6 all KL = 0.005 +- 0.066 (in-sample avg dev_std = 0.042)
NEC for r=0.6 all L1 = 0.004 +- 0.053 (in-sample avg dev_std = 0.042)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.731
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013592063492063494
len(reference) = 2520
Effective ratio: 0.034 +- 0.009
Model Accuracy over intervened graphs for r=0.01 =  0.728
NEC for r=0.01 class 1.0 = 0.004 +- 0.064 (in-sample avg dev_std = 0.067)
NEC for r=0.01 all KL = 0.005 +- 0.064 (in-sample avg dev_std = 0.067)
NEC for r=0.01 all L1 = 0.004 +- 0.048 (in-sample avg dev_std = 0.067)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01363015873015873
len(reference) = 2520
Effective ratio: 0.025 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.729
NEC for r=0.1 class 1.0 = 0.002 +- 0.040 (in-sample avg dev_std = 0.005)
NEC for r=0.1 all KL = 0.002 +- 0.040 (in-sample avg dev_std = 0.005)
NEC for r=0.1 all L1 = 0.002 +- 0.035 (in-sample avg dev_std = 0.005)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.731
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013629365079365081
len(reference) = 2520
Effective ratio: 0.024 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.729
NEC for r=0.25 class 1.0 = 0.002 +- 0.040 (in-sample avg dev_std = 0.003)
NEC for r=0.25 all KL = 0.002 +- 0.040 (in-sample avg dev_std = 0.003)
NEC for r=0.25 all L1 = 0.002 +- 0.035 (in-sample avg dev_std = 0.003)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.731
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.011222222222222222
len(reference) = 2520
Effective ratio: 0.004 +- 0.005
Model Accuracy over intervened graphs for r=0.6 =  0.73
NEC for r=0.6 class 1.0 = 0.0 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.0 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.0 +- 0.017 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11124230145867099
len(reference) = 2468
Effective ratio: 0.225 +- 0.330
Model Accuracy over intervened graphs for r=0.01 =  0.96
NEC for r=0.01 class 1.0 = 0.053 +- 0.240 (in-sample avg dev_std = 0.294)
NEC for r=0.01 all KL = 0.082 +- 0.240 (in-sample avg dev_std = 0.294)
NEC for r=0.01 all L1 = 0.053 +- 0.162 (in-sample avg dev_std = 0.294)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11107009724473257
len(reference) = 2468
Effective ratio: 0.193 +- 0.293
Model Accuracy over intervened graphs for r=0.1 =  0.96
NEC for r=0.1 class 1.0 = 0.051 +- 0.235 (in-sample avg dev_std = 0.281)
NEC for r=0.1 all KL = 0.079 +- 0.235 (in-sample avg dev_std = 0.281)
NEC for r=0.1 all L1 = 0.051 +- 0.162 (in-sample avg dev_std = 0.281)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11074149108589952
len(reference) = 2468
Effective ratio: 0.185 +- 0.283
Model Accuracy over intervened graphs for r=0.25 =  0.959
NEC for r=0.25 class 1.0 = 0.051 +- 0.235 (in-sample avg dev_std = 0.274)
NEC for r=0.25 all KL = 0.077 +- 0.235 (in-sample avg dev_std = 0.274)
NEC for r=0.25 all L1 = 0.051 +- 0.164 (in-sample avg dev_std = 0.274)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.0918820907617504
len(reference) = 2468
Effective ratio: 0.097 +- 0.217
Model Accuracy over intervened graphs for r=0.6 =  0.966
NEC for r=0.6 class 1.0 = 0.037 +- 0.206 (in-sample avg dev_std = 0.207)
NEC for r=0.6 all KL = 0.051 +- 0.206 (in-sample avg dev_std = 0.207)
NEC for r=0.6 all L1 = 0.037 +- 0.154 (in-sample avg dev_std = 0.207)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 04:32:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 04:32:12 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 04:32:12 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 04:32:12 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 04:32:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:32:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 04:32:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:32:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 04:32:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 04:32:12 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 04:32:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.094
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.093
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.091
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.013
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.014
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.01 = 0.000
WIoU for r=0.01 = 0.112
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.111
F1 for r=0.25 = 0.000
WIoU for r=0.25 = 0.110
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.091


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.0944115523465704
len(reference) = 264
Effective ratio: 0.404 +- 0.220
Model Accuracy over intervened graphs for r=0.01 =  0.97
SUFF_SIMPLE for r=0.01 class 1.0 = 0.954 +- 0.252 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.01 all KL = 0.9 +- 0.252 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.01 all L1 = 0.954 +- 0.125 (in-sample avg dev_std = 0.302)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0932129963898917
len(reference) = 275
Effective ratio: 0.179 +- 0.154
Model Accuracy over intervened graphs for r=0.1 =  0.96
SUFF_SIMPLE for r=0.1 class 1.0 = 0.938 +- 0.282 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.1 all KL = 0.863 +- 0.282 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.1 all L1 = 0.938 +- 0.140 (in-sample avg dev_std = 0.349)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09055595667870037
len(reference) = 277
Effective ratio: 0.153 +- 0.129
Model Accuracy over intervened graphs for r=0.25 =  0.952
SUFF_SIMPLE for r=0.25 class 1.0 = 0.924 +- 0.309 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.25 all KL = 0.833 +- 0.309 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.25 all L1 = 0.924 +- 0.152 (in-sample avg dev_std = 0.390)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05894945848375451
len(reference) = 277
Effective ratio: 0.026 +- 0.040
Model Accuracy over intervened graphs for r=0.6 =  0.966
SUFF_SIMPLE for r=0.6 class 1.0 = 0.945 +- 0.271 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.6 all KL = 0.875 +- 0.271 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.6 all L1 = 0.945 +- 0.127 (in-sample avg dev_std = 0.336)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.768
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013351587301587302
len(reference) = 2520
Effective ratio: 0.266 +- 0.077
Model Accuracy over intervened graphs for r=0.01 =  0.433
SUFF_SIMPLE for r=0.01 class 1.0 = 0.556 +- 0.325 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.01 all KL = 0.452 +- 0.325 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.01 all L1 = 0.556 +- 0.264 (in-sample avg dev_std = 0.551)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013426190476190477
len(reference) = 2520
Effective ratio: 0.028 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.434
SUFF_SIMPLE for r=0.1 class 1.0 = 0.563 +- 0.326 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.1 all KL = 0.461 +- 0.326 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.1 all L1 = 0.563 +- 0.266 (in-sample avg dev_std = 0.546)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.768
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013577380952380954
len(reference) = 2520
Effective ratio: 0.020 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.428
SUFF_SIMPLE for r=0.25 class 1.0 = 0.555 +- 0.324 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.25 all KL = 0.45 +- 0.324 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.25 all L1 = 0.555 +- 0.264 (in-sample avg dev_std = 0.550)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.768
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013490873015873015
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.429
SUFF_SIMPLE for r=0.6 class 1.0 = 0.556 +- 0.326 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.6 all KL = 0.45 +- 0.326 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.6 all L1 = 0.556 +- 0.265 (in-sample avg dev_std = 0.554)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.995
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11166410048622366
len(reference) = 2011
Effective ratio: 0.279 +- 0.384
Model Accuracy over intervened graphs for r=0.01 =  0.942
SUFF_SIMPLE for r=0.01 class 1.0 = 0.914 +- 0.315 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.01 all KL = 0.81 +- 0.315 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.01 all L1 = 0.914 +- 0.162 (in-sample avg dev_std = 0.403)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11124189627228523
len(reference) = 2156
Effective ratio: 0.225 +- 0.344
Model Accuracy over intervened graphs for r=0.1 =  0.917
SUFF_SIMPLE for r=0.1 class 1.0 = 0.886 +- 0.344 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.1 all KL = 0.771 +- 0.344 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.1 all L1 = 0.886 +- 0.197 (in-sample avg dev_std = 0.437)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.978
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11018962722852511
len(reference) = 2257
Effective ratio: 0.189 +- 0.306
Model Accuracy over intervened graphs for r=0.25 =  0.897
SUFF_SIMPLE for r=0.25 class 1.0 = 0.867 +- 0.362 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.25 all KL = 0.745 +- 0.362 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.25 all L1 = 0.867 +- 0.221 (in-sample avg dev_std = 0.456)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.966
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.09117949756888169
len(reference) = 2374
Effective ratio: 0.102 +- 0.247
Model Accuracy over intervened graphs for r=0.6 =  0.864
SUFF_SIMPLE for r=0.6 class 1.0 = 0.839 +- 0.385 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.6 all KL = 0.705 +- 0.385 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.6 all L1 = 0.839 +- 0.243 (in-sample avg dev_std = 0.494)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  1.0
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.0944115523465704
len(reference) = 277
Effective ratio: 0.404 +- 0.220
Model Accuracy over intervened graphs for r=0.01 =  0.995
NEC for r=0.01 class 1.0 = 0.008 +- 0.115 (in-sample avg dev_std = 0.134)
NEC for r=0.01 all KL = 0.02 +- 0.115 (in-sample avg dev_std = 0.134)
NEC for r=0.01 all L1 = 0.008 +- 0.049 (in-sample avg dev_std = 0.134)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0932129963898917
len(reference) = 277
Effective ratio: 0.179 +- 0.154
Model Accuracy over intervened graphs for r=0.1 =  0.992
NEC for r=0.1 class 1.0 = 0.013 +- 0.144 (in-sample avg dev_std = 0.165)
NEC for r=0.1 all KL = 0.029 +- 0.144 (in-sample avg dev_std = 0.165)
NEC for r=0.1 all L1 = 0.013 +- 0.064 (in-sample avg dev_std = 0.165)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  1.0
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.09055595667870037
len(reference) = 277
Effective ratio: 0.153 +- 0.129
Model Accuracy over intervened graphs for r=0.25 =  0.995
NEC for r=0.25 class 1.0 = 0.007 +- 0.112 (in-sample avg dev_std = 0.124)
NEC for r=0.25 all KL = 0.016 +- 0.112 (in-sample avg dev_std = 0.124)
NEC for r=0.25 all L1 = 0.007 +- 0.051 (in-sample avg dev_std = 0.124)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  1.0
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05894945848375451
len(reference) = 277
Effective ratio: 0.026 +- 0.040
Model Accuracy over intervened graphs for r=0.6 =  0.991
NEC for r=0.6 class 1.0 = 0.009 +- 0.103 (in-sample avg dev_std = 0.060)
NEC for r=0.6 all KL = 0.011 +- 0.103 (in-sample avg dev_std = 0.060)
NEC for r=0.6 all L1 = 0.009 +- 0.084 (in-sample avg dev_std = 0.060)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.768
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.013351587301587302
len(reference) = 2520
Effective ratio: 0.266 +- 0.077
Model Accuracy over intervened graphs for r=0.01 =  0.619
NEC for r=0.01 class 1.0 = 0.238 +- 0.252 (in-sample avg dev_std = 0.352)
NEC for r=0.01 all KL = 0.238 +- 0.252 (in-sample avg dev_std = 0.352)
NEC for r=0.01 all L1 = 0.238 +- 0.232 (in-sample avg dev_std = 0.352)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013426190476190477
len(reference) = 2520
Effective ratio: 0.028 +- 0.006
Model Accuracy over intervened graphs for r=0.1 =  0.621
NEC for r=0.1 class 1.0 = 0.223 +- 0.273 (in-sample avg dev_std = 0.233)
NEC for r=0.1 all KL = 0.195 +- 0.273 (in-sample avg dev_std = 0.233)
NEC for r=0.1 all L1 = 0.223 +- 0.259 (in-sample avg dev_std = 0.233)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.768
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.013577380952380954
len(reference) = 2520
Effective ratio: 0.020 +- 0.006
Model Accuracy over intervened graphs for r=0.25 =  0.637
NEC for r=0.25 class 1.0 = 0.202 +- 0.260 (in-sample avg dev_std = 0.150)
NEC for r=0.25 all KL = 0.164 +- 0.260 (in-sample avg dev_std = 0.150)
NEC for r=0.25 all L1 = 0.202 +- 0.256 (in-sample avg dev_std = 0.150)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.768
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.013490873015873015
len(reference) = 2520
Effective ratio: 0.003 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.751
NEC for r=0.6 class 1.0 = 0.038 +- 0.067 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all KL = 0.012 +- 0.067 (in-sample avg dev_std = 0.000)
NEC for r=0.6 all L1 = 0.038 +- 0.093 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.01



Model Accuracy of binarized graphs for r=0.01 =  0.947
Model XAI F1 of binarized graphs for r=0.01 =  0.0
Model XAI WIoU of binarized graphs for r=0.01 =  0.11166410048622366
len(reference) = 2468
Effective ratio: 0.279 +- 0.384
Model Accuracy over intervened graphs for r=0.01 =  0.89
NEC for r=0.01 class 1.0 = 0.129 +- 0.371 (in-sample avg dev_std = 0.455)
NEC for r=0.01 all KL = 0.212 +- 0.371 (in-sample avg dev_std = 0.455)
NEC for r=0.01 all L1 = 0.129 +- 0.238 (in-sample avg dev_std = 0.455)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.947
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.11124189627228523
len(reference) = 2468
Effective ratio: 0.225 +- 0.344
Model Accuracy over intervened graphs for r=0.1 =  0.887
NEC for r=0.1 class 1.0 = 0.126 +- 0.366 (in-sample avg dev_std = 0.437)
NEC for r=0.1 all KL = 0.2 +- 0.366 (in-sample avg dev_std = 0.437)
NEC for r=0.1 all L1 = 0.126 +- 0.242 (in-sample avg dev_std = 0.437)


ratio=0.25



Model Accuracy of binarized graphs for r=0.25 =  0.947
Model XAI F1 of binarized graphs for r=0.25 =  0.0
Model XAI WIoU of binarized graphs for r=0.25 =  0.11018962722852511
len(reference) = 2468
Effective ratio: 0.189 +- 0.306
Model Accuracy over intervened graphs for r=0.25 =  0.893
NEC for r=0.25 class 1.0 = 0.119 +- 0.357 (in-sample avg dev_std = 0.418)
NEC for r=0.25 all KL = 0.185 +- 0.357 (in-sample avg dev_std = 0.418)
NEC for r=0.25 all L1 = 0.119 +- 0.240 (in-sample avg dev_std = 0.418)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.947
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.09117949756888169
len(reference) = 2468
Effective ratio: 0.102 +- 0.247
Model Accuracy over intervened graphs for r=0.6 =  0.912
NEC for r=0.6 class 1.0 = 0.077 +- 0.285 (in-sample avg dev_std = 0.261)
NEC for r=0.6 all KL = 0.105 +- 0.285 (in-sample avg dev_std = 0.261)
NEC for r=0.6 all L1 = 0.077 +- 0.215 (in-sample avg dev_std = 0.261)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.998, 0.998, 1.0, 0.995], 'all_L1': [0.999, 0.999, 1.0, 0.998]}), defaultdict(<class 'list'>, {'all_KL': [0.986, 0.971, 0.967, 0.955], 'all_L1': [0.994, 0.988, 0.986, 0.98]}), defaultdict(<class 'list'>, {'all_KL': [0.996, 0.982, 0.964, 0.959], 'all_L1': [0.998, 0.99, 0.982, 0.981]}), defaultdict(<class 'list'>, {'all_KL': [0.994, 0.982, 0.985, 0.986], 'all_L1': [0.996, 0.989, 0.991, 0.991]}), defaultdict(<class 'list'>, {'all_KL': [0.976, 0.965, 0.97, 0.973], 'all_L1': [0.99, 0.986, 0.987, 0.988]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 0.994, 0.992, 0.986], 'all_L1': [1.0, 0.997, 0.996, 0.993]}), defaultdict(<class 'list'>, {'all_KL': [0.942, 0.891, 0.876, 0.869], 'all_L1': [0.973, 0.945, 0.934, 0.93]}), defaultdict(<class 'list'>, {'all_KL': [0.99, 0.978, 0.985, 0.979], 'all_L1': [0.995, 0.99, 0.992, 0.988]}), defaultdict(<class 'list'>, {'all_KL': [0.946, 0.944, 0.922, 0.93], 'all_L1': [0.97, 0.971, 0.959, 0.964]}), defaultdict(<class 'list'>, {'all_KL': [0.9, 0.863, 0.833, 0.875], 'all_L1': [0.954, 0.938, 0.924, 0.945]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.0, 0.0], 'all_L1': [0.0, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.019, 0.023, 0.012, 0.004], 'all_L1': [0.008, 0.011, 0.006, 0.003]}), defaultdict(<class 'list'>, {'all_KL': [0.015, 0.017, 0.022, 0.011], 'all_L1': [0.008, 0.008, 0.011, 0.009]}), defaultdict(<class 'list'>, {'all_KL': [0.006, 0.009, 0.005, 0.0], 'all_L1': [0.003, 0.006, 0.003, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.006, 0.008, 0.0], 'all_L1': [0.004, 0.003, 0.004, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.0, 0.0], 'all_L1': [0.0, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.022, 0.027, 0.025, 0.017], 'all_L1': [0.011, 0.014, 0.013, 0.013]}), defaultdict(<class 'list'>, {'all_KL': [0.003, 0.007, 0.003, 0.003], 'all_L1': [0.002, 0.004, 0.002, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.021, 0.016, 0.014, 0.005], 'all_L1': [0.011, 0.008, 0.008, 0.004]}), defaultdict(<class 'list'>, {'all_KL': [0.02, 0.029, 0.016, 0.011], 'all_L1': [0.008, 0.013, 0.007, 0.009]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.999, 0.999, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.995, 0.995, 0.995, 0.995], 'all_L1': [0.998, 0.998, 0.998, 0.998]}), defaultdict(<class 'list'>, {'all_KL': [0.998, 0.998, 1.0, 0.998], 'all_L1': [0.999, 0.999, 1.0, 0.999]}), defaultdict(<class 'list'>, {'all_KL': [0.884, 0.88, 0.885, 0.882], 'all_L1': [0.904, 0.901, 0.904, 0.902]}), defaultdict(<class 'list'>, {'all_KL': [0.998, 0.997, 0.997, 0.997], 'all_L1': [0.999, 0.999, 0.999, 0.998]}), defaultdict(<class 'list'>, {'all_KL': [0.994, 0.993, 0.994, 0.994], 'all_L1': [0.996, 0.996, 0.997, 0.996]}), defaultdict(<class 'list'>, {'all_KL': [0.976, 0.976, 0.979, 0.973], 'all_L1': [0.989, 0.989, 0.99, 0.987]}), defaultdict(<class 'list'>, {'all_KL': [0.767, 0.76, 0.767, 0.763], 'all_L1': [0.828, 0.824, 0.828, 0.826]}), defaultdict(<class 'list'>, {'all_KL': [0.978, 0.978, 0.979, 0.978], 'all_L1': [0.988, 0.988, 0.989, 0.988]}), defaultdict(<class 'list'>, {'all_KL': [0.452, 0.461, 0.45, 0.45], 'all_L1': [0.556, 0.563, 0.555, 0.556]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.0, 0.0], 'all_L1': [0.0, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.0, 0.0, 0.0], 'all_L1': [0.001, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.0, 0.0], 'all_L1': [0.0, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.022, 0.016, 0.0, 0.0], 'all_L1': [0.021, 0.018, 0.001, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.001, 0.0, 0.0, 0.0], 'all_L1': [0.001, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.001, 0.001, 0.0, 0.0], 'all_L1': [0.001, 0.001, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.002, 0.002, 0.0], 'all_L1': [0.002, 0.001, 0.001, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.101, 0.084, 0.059, 0.007], 'all_L1': [0.074, 0.067, 0.053, 0.008]}), defaultdict(<class 'list'>, {'all_KL': [0.005, 0.002, 0.002, 0.0], 'all_L1': [0.004, 0.002, 0.002, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.238, 0.195, 0.164, 0.012], 'all_L1': [0.238, 0.223, 0.202, 0.038]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.998, 0.997, 0.989, 0.984], 'all_L1': [0.999, 0.998, 0.994, 0.992]}), defaultdict(<class 'list'>, {'all_KL': [0.986, 0.972, 0.952, 0.945], 'all_L1': [0.993, 0.986, 0.974, 0.97]}), defaultdict(<class 'list'>, {'all_KL': [0.991, 0.978, 0.962, 0.944], 'all_L1': [0.996, 0.987, 0.976, 0.964]}), defaultdict(<class 'list'>, {'all_KL': [0.976, 0.959, 0.933, 0.903], 'all_L1': [0.985, 0.972, 0.955, 0.937]}), defaultdict(<class 'list'>, {'all_KL': [0.968, 0.968, 0.969, 0.952], 'all_L1': [0.986, 0.986, 0.986, 0.978]}), defaultdict(<class 'list'>, {'all_KL': [0.998, 0.979, 0.966, 0.939], 'all_L1': [0.999, 0.987, 0.98, 0.962]}), defaultdict(<class 'list'>, {'all_KL': [0.943, 0.877, 0.854, 0.835], 'all_L1': [0.967, 0.922, 0.905, 0.894]}), defaultdict(<class 'list'>, {'all_KL': [0.995, 0.971, 0.953, 0.928], 'all_L1': [0.997, 0.982, 0.971, 0.953]}), defaultdict(<class 'list'>, {'all_KL': [0.897, 0.886, 0.886, 0.858], 'all_L1': [0.944, 0.938, 0.938, 0.919]}), defaultdict(<class 'list'>, {'all_KL': [0.81, 0.771, 0.745, 0.705], 'all_L1': [0.914, 0.886, 0.867, 0.839]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.005, 0.006, 0.001, 0.0], 'all_L1': [0.002, 0.003, 0.001, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.054, 0.058, 0.046, 0.014], 'all_L1': [0.026, 0.028, 0.024, 0.011]}), defaultdict(<class 'list'>, {'all_KL': [0.061, 0.06, 0.057, 0.032], 'all_L1': [0.034, 0.034, 0.034, 0.023]}), defaultdict(<class 'list'>, {'all_KL': [0.078, 0.074, 0.054, 0.021], 'all_L1': [0.051, 0.05, 0.039, 0.02]}), defaultdict(<class 'list'>, {'all_KL': [0.029, 0.024, 0.023, 0.01], 'all_L1': [0.014, 0.012, 0.013, 0.007]}), defaultdict(<class 'list'>, {'all_KL': [0.074, 0.07, 0.072, 0.037], 'all_L1': [0.041, 0.04, 0.041, 0.026]}), defaultdict(<class 'list'>, {'all_KL': [0.143, 0.134, 0.119, 0.057], 'all_L1': [0.084, 0.082, 0.076, 0.043]}), defaultdict(<class 'list'>, {'all_KL': [0.074, 0.074, 0.071, 0.048], 'all_L1': [0.044, 0.044, 0.042, 0.031]}), defaultdict(<class 'list'>, {'all_KL': [0.082, 0.079, 0.077, 0.051], 'all_L1': [0.053, 0.051, 0.051, 0.037]}), defaultdict(<class 'list'>, {'all_KL': [0.212, 0.2, 0.185, 0.105], 'all_L1': [0.129, 0.126, 0.119, 0.077]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.987 +- 0.015, 0.979 +- 0.020, 0.975 +- 0.025, 0.976 +- 0.021
suff_simple class all_KL  =  0.973 +- 0.031, 0.957 +- 0.043, 0.949 +- 0.052, 0.951 +- 0.043
suff_simple_acc_int  =  0.991 +- 0.010, 0.986 +- 0.013, 0.983 +- 0.017, 0.984 +- 0.014
nec class all_L1  =  0.005 +- 0.004, 0.007 +- 0.005, 0.005 +- 0.004, 0.004 +- 0.005
nec class all_KL  =  0.012 +- 0.008, 0.013 +- 0.010, 0.011 +- 0.008, 0.005 +- 0.006
nec_acc_int  =  0.996 +- 0.003, 0.996 +- 0.003, 0.996 +- 0.003, 0.996 +- 0.005

Eval split val
suff_simple class all_L1  =  0.926 +- 0.135, 0.926 +- 0.133, 0.926 +- 0.135, 0.925 +- 0.135
suff_simple class all_KL  =  0.904 +- 0.166, 0.904 +- 0.165, 0.905 +- 0.167, 0.903 +- 0.167
suff_simple_acc_int  =  0.803 +- 0.198, 0.802 +- 0.198, 0.802 +- 0.199, 0.802 +- 0.199
nec class all_L1  =  0.034 +- 0.071, 0.031 +- 0.067, 0.026 +- 0.061, 0.005 +- 0.011
nec class all_KL  =  0.037 +- 0.073, 0.030 +- 0.060, 0.023 +- 0.050, 0.002 +- 0.004
nec_acc_int  =  0.836 +- 0.150, 0.837 +- 0.150, 0.840 +- 0.146, 0.856 +- 0.125

Eval split test
suff_simple class all_L1  =  0.978 +- 0.027, 0.964 +- 0.035, 0.955 +- 0.038, 0.941 +- 0.044
suff_simple class all_KL  =  0.956 +- 0.057, 0.936 +- 0.067, 0.921 +- 0.070, 0.899 +- 0.077
suff_simple_acc_int  =  0.985 +- 0.018, 0.972 +- 0.027, 0.964 +- 0.030, 0.953 +- 0.037
nec class all_L1  =  0.048 +- 0.035, 0.047 +- 0.034, 0.044 +- 0.032, 0.028 +- 0.021
nec class all_KL  =  0.081 +- 0.055, 0.078 +- 0.052, 0.071 +- 0.049, 0.037 +- 0.029
nec_acc_int  =  0.963 +- 0.030, 0.963 +- 0.031, 0.964 +- 0.030, 0.970 +- 0.025


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.496 +- 0.006, 0.493 +- 0.008, 0.490 +- 0.011, 0.490 +- 0.009
Faith. Armon (L1)= 		  =  0.011 +- 0.008, 0.013 +- 0.009, 0.011 +- 0.008, 0.008 +- 0.009
Faith. GMean (L1)= 	  =  0.063 +- 0.037, 0.070 +- 0.040, 0.062 +- 0.037, 0.044 +- 0.042
Faith. Aritm (KL)= 		  =  0.492 +- 0.013, 0.485 +- 0.018, 0.480 +- 0.023, 0.478 +- 0.019
Faith. Armon (KL)= 		  =  0.023 +- 0.016, 0.026 +- 0.020, 0.021 +- 0.016, 0.010 +- 0.011
Faith. GMean (KL)= 	  =  0.091 +- 0.053, 0.097 +- 0.056, 0.084 +- 0.051, 0.051 +- 0.045

Eval split val
Faith. Aritm (L1)= 		  =  0.480 +- 0.032, 0.478 +- 0.034, 0.476 +- 0.038, 0.465 +- 0.062
Faith. Armon (L1)= 		  =  0.053 +- 0.102, 0.049 +- 0.097, 0.040 +- 0.090, 0.009 +- 0.021
Faith. GMean (L1)= 	  =  0.095 +- 0.114, 0.082 +- 0.115, 0.065 +- 0.108, 0.026 +- 0.047
Faith. Aritm (KL)= 		  =  0.471 +- 0.047, 0.467 +- 0.053, 0.464 +- 0.059, 0.452 +- 0.082
Faith. Armon (KL)= 		  =  0.056 +- 0.100, 0.047 +- 0.088, 0.036 +- 0.076, 0.004 +- 0.008
Faith. GMean (KL)= 	  =  0.099 +- 0.110, 0.079 +- 0.105, 0.057 +- 0.095, 0.015 +- 0.029

Eval split test
Faith. Aritm (L1)= 		  =  0.513 +- 0.010, 0.506 +- 0.006, 0.499 +- 0.006, 0.484 +- 0.012
Faith. Armon (L1)= 		  =  0.089 +- 0.060, 0.087 +- 0.059, 0.082 +- 0.056, 0.052 +- 0.038
Faith. GMean (L1)= 	  =  0.199 +- 0.079, 0.197 +- 0.074, 0.188 +- 0.075, 0.144 +- 0.066
Faith. Aritm (KL)= 		  =  0.519 +- 0.017, 0.507 +- 0.014, 0.496 +- 0.015, 0.468 +- 0.026
Faith. Armon (KL)= 		  =  0.144 +- 0.087, 0.138 +- 0.082, 0.126 +- 0.078, 0.070 +- 0.050
Faith. GMean (KL)= 	  =  0.259 +- 0.090, 0.251 +- 0.083, 0.232 +- 0.088, 0.162 +- 0.073
Computed for split load_split = id



Completed in  0:52:01.433166  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN TopoFeature/basis/no_shift NEC_ALPHA 0.01 RANDOM
DONE all :)
