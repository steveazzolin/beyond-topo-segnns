nohup: ignoring input
I'm computing faithfulness :)
The PID of this script is: 103998

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 18:14:18 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 06:14:19 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 06:14:19 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 06:14:19 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 06:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 06:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:14:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 06:14:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:14:19 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 06:14:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.9868
Train Loss: 0.0344
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0199
ID Test ACCURACY: 0.9860
ID Test Loss: 0.0461
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0199
OOD Test ACCURACY: 0.9860
OOD Test Loss: 0.0461

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.9868
Train Loss: 0.0344
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0199
ID Test ACCURACY: 0.9860
ID Test Loss: 0.0461
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0199
OOD Test ACCURACY: 0.9860
OOD Test Loss: 0.0461

[0m[1;37mINFO[0m: [1mChartInfo 0.9860 0.9860 0.9860 0.9860 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.377
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.358
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.256
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.168
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.114
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.259
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.146
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.078
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.041
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.023
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.261
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.199
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.143
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.108
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.098


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.37670399999999993
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.956
SUFF_SIMPLE for r=0.05 class 0.0 = 0.905 +- 0.216 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.948 +- 0.216 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.05 all KL = 0.907 +- 0.216 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.05 all L1 = 0.929 +- 0.151 (in-sample avg dev_std = 0.269)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35792399999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.959
SUFF_SIMPLE for r=0.1 class 0.0 = 0.918 +- 0.206 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.946 +- 0.206 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.1 all KL = 0.911 +- 0.206 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.1 all L1 = 0.934 +- 0.141 (in-sample avg dev_std = 0.263)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.255554
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.956
SUFF_SIMPLE for r=0.2 class 0.0 = 0.904 +- 0.215 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.952 +- 0.215 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 all KL = 0.905 +- 0.215 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 all L1 = 0.931 +- 0.147 (in-sample avg dev_std = 0.264)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.167592
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.951
SUFF_SIMPLE for r=0.4 class 0.0 = 0.903 +- 0.228 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.938 +- 0.228 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.4 all KL = 0.892 +- 0.228 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.4 all L1 = 0.922 +- 0.155 (in-sample avg dev_std = 0.279)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11382400000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.933
SUFF_SIMPLE for r=0.8 class 0.0 = 0.928 +- 0.263 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.886 +- 0.263 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.8 all KL = 0.873 +- 0.263 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.8 all L1 = 0.905 +- 0.187 (in-sample avg dev_std = 0.283)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.849
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2589384
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.876
SUFF_SIMPLE for r=0.05 class 0.0 = 0.834 +- 0.326 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.989 +- 0.326 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.05 all KL = 0.834 +- 0.326 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.05 all L1 = 0.912 +- 0.186 (in-sample avg dev_std = 0.282)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.849
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.14558780000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.877
SUFF_SIMPLE for r=0.1 class 0.0 = 0.828 +- 0.331 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.989 +- 0.331 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.1 all KL = 0.828 +- 0.331 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.1 all L1 = 0.909 +- 0.190 (in-sample avg dev_std = 0.287)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.849
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0780266
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.88
SUFF_SIMPLE for r=0.2 class 0.0 = 0.823 +- 0.337 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.987 +- 0.337 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.2 all KL = 0.822 +- 0.337 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.2 all L1 = 0.905 +- 0.195 (in-sample avg dev_std = 0.290)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.849
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.041049199999999994
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.894
SUFF_SIMPLE for r=0.4 class 0.0 = 0.816 +- 0.335 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.98 +- 0.335 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.4 all KL = 0.821 +- 0.335 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.4 all L1 = 0.899 +- 0.211 (in-sample avg dev_std = 0.277)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.849
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.023097000000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.921
SUFF_SIMPLE for r=0.8 class 0.0 = 0.77 +- 0.372 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.947 +- 0.372 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.8 all KL = 0.777 +- 0.372 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.8 all L1 = 0.86 +- 0.261 (in-sample avg dev_std = 0.285)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.652
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2607398
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.619
SUFF_SIMPLE for r=0.05 class 0.0 = 0.897 +- 0.249 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.839 +- 0.249 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.05 all KL = 0.875 +- 0.249 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.05 all L1 = 0.868 +- 0.223 (in-sample avg dev_std = 0.224)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.652
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1991426
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.62
SUFF_SIMPLE for r=0.1 class 0.0 = 0.898 +- 0.248 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.84 +- 0.248 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.1 all KL = 0.877 +- 0.248 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.1 all L1 = 0.87 +- 0.222 (in-sample avg dev_std = 0.221)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.652
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1432844
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.619
SUFF_SIMPLE for r=0.2 class 0.0 = 0.904 +- 0.250 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.84 +- 0.250 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.2 all KL = 0.878 +- 0.250 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.2 all L1 = 0.872 +- 0.223 (in-sample avg dev_std = 0.210)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.652
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10787739999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.621
SUFF_SIMPLE for r=0.4 class 0.0 = 0.905 +- 0.254 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.838 +- 0.254 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.4 all KL = 0.878 +- 0.254 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.4 all L1 = 0.872 +- 0.223 (in-sample avg dev_std = 0.205)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.652
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0978094
len(reference) = 4963
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.598
SUFF_SIMPLE for r=0.8 class 0.0 = 0.914 +- 0.269 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.834 +- 0.269 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.8 all KL = 0.88 +- 0.269 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.8 all L1 = 0.874 +- 0.235 (in-sample avg dev_std = 0.162)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.37670399999999993
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.981
NEC for r=0.05 class 0.0 = 0.046 +- 0.127 (in-sample avg dev_std = 0.122)
NEC for r=0.05 class 1.0 = 0.024 +- 0.127 (in-sample avg dev_std = 0.122)
NEC for r=0.05 all KL = 0.032 +- 0.127 (in-sample avg dev_std = 0.122)
NEC for r=0.05 all L1 = 0.034 +- 0.101 (in-sample avg dev_std = 0.122)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35792399999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.982
NEC for r=0.1 class 0.0 = 0.041 +- 0.117 (in-sample avg dev_std = 0.141)
NEC for r=0.1 class 1.0 = 0.024 +- 0.117 (in-sample avg dev_std = 0.141)
NEC for r=0.1 all KL = 0.032 +- 0.117 (in-sample avg dev_std = 0.141)
NEC for r=0.1 all L1 = 0.032 +- 0.090 (in-sample avg dev_std = 0.141)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.255554
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.985
NEC for r=0.2 class 0.0 = 0.036 +- 0.107 (in-sample avg dev_std = 0.143)
NEC for r=0.2 class 1.0 = 0.021 +- 0.107 (in-sample avg dev_std = 0.143)
NEC for r=0.2 all KL = 0.028 +- 0.107 (in-sample avg dev_std = 0.143)
NEC for r=0.2 all L1 = 0.028 +- 0.081 (in-sample avg dev_std = 0.143)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.167592
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.987
NEC for r=0.4 class 0.0 = 0.032 +- 0.101 (in-sample avg dev_std = 0.135)
NEC for r=0.4 class 1.0 = 0.014 +- 0.101 (in-sample avg dev_std = 0.135)
NEC for r=0.4 all KL = 0.023 +- 0.101 (in-sample avg dev_std = 0.135)
NEC for r=0.4 all L1 = 0.022 +- 0.069 (in-sample avg dev_std = 0.135)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11382400000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.986
NEC for r=0.8 class 0.0 = 0.032 +- 0.094 (in-sample avg dev_std = 0.142)
NEC for r=0.8 class 1.0 = 0.016 +- 0.094 (in-sample avg dev_std = 0.142)
NEC for r=0.8 all KL = 0.024 +- 0.094 (in-sample avg dev_std = 0.142)
NEC for r=0.8 all L1 = 0.023 +- 0.070 (in-sample avg dev_std = 0.142)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.849
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2589384
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.818
NEC for r=0.05 class 0.0 = 0.096 +- 0.308 (in-sample avg dev_std = 0.297)
NEC for r=0.05 class 1.0 = 0.031 +- 0.308 (in-sample avg dev_std = 0.297)
NEC for r=0.05 all KL = 0.143 +- 0.308 (in-sample avg dev_std = 0.297)
NEC for r=0.05 all L1 = 0.063 +- 0.128 (in-sample avg dev_std = 0.297)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.849
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.14558780000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.84
NEC for r=0.1 class 0.0 = 0.061 +- 0.220 (in-sample avg dev_std = 0.191)
NEC for r=0.1 class 1.0 = 0.005 +- 0.220 (in-sample avg dev_std = 0.191)
NEC for r=0.1 all KL = 0.064 +- 0.220 (in-sample avg dev_std = 0.191)
NEC for r=0.1 all L1 = 0.033 +- 0.088 (in-sample avg dev_std = 0.191)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.849
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0780266
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.848
NEC for r=0.2 class 0.0 = 0.048 +- 0.178 (in-sample avg dev_std = 0.148)
NEC for r=0.2 class 1.0 = 0.002 +- 0.178 (in-sample avg dev_std = 0.148)
NEC for r=0.2 all KL = 0.042 +- 0.178 (in-sample avg dev_std = 0.148)
NEC for r=0.2 all L1 = 0.025 +- 0.075 (in-sample avg dev_std = 0.148)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.849
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.041049199999999994
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.848
NEC for r=0.4 class 0.0 = 0.045 +- 0.184 (in-sample avg dev_std = 0.144)
NEC for r=0.4 class 1.0 = 0.001 +- 0.184 (in-sample avg dev_std = 0.144)
NEC for r=0.4 all KL = 0.044 +- 0.184 (in-sample avg dev_std = 0.144)
NEC for r=0.4 all L1 = 0.023 +- 0.070 (in-sample avg dev_std = 0.144)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.849
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.023097000000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.856
NEC for r=0.8 class 0.0 = 0.052 +- 0.160 (in-sample avg dev_std = 0.132)
NEC for r=0.8 class 1.0 = 0.001 +- 0.160 (in-sample avg dev_std = 0.132)
NEC for r=0.8 all KL = 0.038 +- 0.160 (in-sample avg dev_std = 0.132)
NEC for r=0.8 all L1 = 0.027 +- 0.083 (in-sample avg dev_std = 0.132)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.652
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2607398
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.627
NEC for r=0.05 class 0.0 = 0.066 +- 0.222 (in-sample avg dev_std = 0.155)
NEC for r=0.05 class 1.0 = 0.125 +- 0.222 (in-sample avg dev_std = 0.155)
NEC for r=0.05 all KL = 0.08 +- 0.222 (in-sample avg dev_std = 0.155)
NEC for r=0.05 all L1 = 0.095 +- 0.203 (in-sample avg dev_std = 0.155)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.652
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1991426
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.646
NEC for r=0.1 class 0.0 = 0.078 +- 0.192 (in-sample avg dev_std = 0.140)
NEC for r=0.1 class 1.0 = 0.084 +- 0.192 (in-sample avg dev_std = 0.140)
NEC for r=0.1 all KL = 0.065 +- 0.192 (in-sample avg dev_std = 0.140)
NEC for r=0.1 all L1 = 0.081 +- 0.177 (in-sample avg dev_std = 0.140)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.652
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1432844
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.646
NEC for r=0.2 class 0.0 = 0.08 +- 0.173 (in-sample avg dev_std = 0.145)
NEC for r=0.2 class 1.0 = 0.082 +- 0.173 (in-sample avg dev_std = 0.145)
NEC for r=0.2 all KL = 0.061 +- 0.173 (in-sample avg dev_std = 0.145)
NEC for r=0.2 all L1 = 0.081 +- 0.173 (in-sample avg dev_std = 0.145)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.652
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10787739999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.644
NEC for r=0.4 class 0.0 = 0.079 +- 0.164 (in-sample avg dev_std = 0.158)
NEC for r=0.4 class 1.0 = 0.082 +- 0.164 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all KL = 0.059 +- 0.164 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all L1 = 0.08 +- 0.169 (in-sample avg dev_std = 0.158)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.652
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0978094
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.644
NEC for r=0.8 class 0.0 = 0.071 +- 0.158 (in-sample avg dev_std = 0.178)
NEC for r=0.8 class 1.0 = 0.092 +- 0.158 (in-sample avg dev_std = 0.178)
NEC for r=0.8 all KL = 0.062 +- 0.158 (in-sample avg dev_std = 0.178)
NEC for r=0.8 all L1 = 0.082 +- 0.163 (in-sample avg dev_std = 0.178)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 18:29:28 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 06:29:29 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 06:29:29 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 06:29:29 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 06:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 06:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 06:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:29:29 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 06:29:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 89 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9952
Train Loss: 0.0252
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0215
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0308
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0215
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0308

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 89...
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9952
Train Loss: 0.0252
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0215
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0308
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0215
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0308

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.379
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.354
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.254
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.169
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.115
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.257
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.145
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.078
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.042
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.024
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.285
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.214
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.153
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.117
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.102


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.37894
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.967
SUFF_SIMPLE for r=0.05 class 0.0 = 0.919 +- 0.177 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.973 +- 0.177 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.05 all KL = 0.936 +- 0.177 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.05 all L1 = 0.949 +- 0.122 (in-sample avg dev_std = 0.227)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35417200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.968
SUFF_SIMPLE for r=0.1 class 0.0 = 0.915 +- 0.185 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.973 +- 0.185 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.1 all KL = 0.927 +- 0.185 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.1 all L1 = 0.947 +- 0.117 (in-sample avg dev_std = 0.243)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25360200000000005
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.969
SUFF_SIMPLE for r=0.2 class 0.0 = 0.921 +- 0.190 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.966 +- 0.190 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.2 all KL = 0.923 +- 0.190 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.2 all L1 = 0.946 +- 0.116 (in-sample avg dev_std = 0.243)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.169174
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.962
SUFF_SIMPLE for r=0.4 class 0.0 = 0.919 +- 0.202 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.955 +- 0.202 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.4 all KL = 0.914 +- 0.202 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.4 all L1 = 0.939 +- 0.131 (in-sample avg dev_std = 0.261)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11512199999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.942
SUFF_SIMPLE for r=0.8 class 0.0 = 0.891 +- 0.238 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.927 +- 0.238 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.8 all KL = 0.885 +- 0.238 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.8 all L1 = 0.911 +- 0.171 (in-sample avg dev_std = 0.266)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25650019999999996
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.932
SUFF_SIMPLE for r=0.05 class 0.0 = 0.98 +- 0.153 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.887 +- 0.153 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.05 all KL = 0.947 +- 0.153 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.05 all L1 = 0.933 +- 0.123 (in-sample avg dev_std = 0.148)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1450794
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.931
SUFF_SIMPLE for r=0.1 class 0.0 = 0.98 +- 0.154 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.888 +- 0.154 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.1 all KL = 0.947 +- 0.154 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.1 all L1 = 0.933 +- 0.123 (in-sample avg dev_std = 0.148)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0784476
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.929
SUFF_SIMPLE for r=0.2 class 0.0 = 0.981 +- 0.148 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.884 +- 0.148 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all KL = 0.947 +- 0.148 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all L1 = 0.932 +- 0.125 (in-sample avg dev_std = 0.147)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0418752
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.926
SUFF_SIMPLE for r=0.4 class 0.0 = 0.981 +- 0.148 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.872 +- 0.148 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.4 all KL = 0.943 +- 0.148 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.4 all L1 = 0.926 +- 0.136 (in-sample avg dev_std = 0.155)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.024070800000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.896
SUFF_SIMPLE for r=0.8 class 0.0 = 0.978 +- 0.195 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.822 +- 0.195 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.8 all KL = 0.909 +- 0.195 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.8 all L1 = 0.9 +- 0.179 (in-sample avg dev_std = 0.204)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.695
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2850872
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.659
SUFF_SIMPLE for r=0.05 class 0.0 = 0.898 +- 0.244 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.856 +- 0.244 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.05 all KL = 0.881 +- 0.244 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.05 all L1 = 0.877 +- 0.210 (in-sample avg dev_std = 0.214)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.695
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.213785
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.656
SUFF_SIMPLE for r=0.1 class 0.0 = 0.901 +- 0.247 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.854 +- 0.247 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 all KL = 0.88 +- 0.247 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 all L1 = 0.878 +- 0.210 (in-sample avg dev_std = 0.218)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.695
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.152517
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.656
SUFF_SIMPLE for r=0.2 class 0.0 = 0.907 +- 0.244 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.857 +- 0.244 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.2 all KL = 0.885 +- 0.244 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.2 all L1 = 0.882 +- 0.208 (in-sample avg dev_std = 0.204)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.695
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1165626
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.655
SUFF_SIMPLE for r=0.4 class 0.0 = 0.913 +- 0.249 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.853 +- 0.249 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.4 all KL = 0.884 +- 0.249 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.4 all L1 = 0.883 +- 0.208 (in-sample avg dev_std = 0.208)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.696
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1024266
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.643
SUFF_SIMPLE for r=0.8 class 0.0 = 0.902 +- 0.264 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.845 +- 0.264 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.8 all KL = 0.879 +- 0.264 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.8 all L1 = 0.874 +- 0.226 (in-sample avg dev_std = 0.167)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.37894
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.965
NEC for r=0.05 class 0.0 = 0.084 +- 0.200 (in-sample avg dev_std = 0.197)
NEC for r=0.05 class 1.0 = 0.01 +- 0.200 (in-sample avg dev_std = 0.197)
NEC for r=0.05 all KL = 0.055 +- 0.200 (in-sample avg dev_std = 0.197)
NEC for r=0.05 all L1 = 0.043 +- 0.135 (in-sample avg dev_std = 0.197)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35417200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.975
NEC for r=0.1 class 0.0 = 0.062 +- 0.164 (in-sample avg dev_std = 0.185)
NEC for r=0.1 class 1.0 = 0.011 +- 0.164 (in-sample avg dev_std = 0.185)
NEC for r=0.1 all KL = 0.045 +- 0.164 (in-sample avg dev_std = 0.185)
NEC for r=0.1 all L1 = 0.034 +- 0.103 (in-sample avg dev_std = 0.185)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25360200000000005
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.977
NEC for r=0.2 class 0.0 = 0.059 +- 0.141 (in-sample avg dev_std = 0.183)
NEC for r=0.2 class 1.0 = 0.008 +- 0.141 (in-sample avg dev_std = 0.183)
NEC for r=0.2 all KL = 0.039 +- 0.141 (in-sample avg dev_std = 0.183)
NEC for r=0.2 all L1 = 0.031 +- 0.093 (in-sample avg dev_std = 0.183)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.169174
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.987
NEC for r=0.4 class 0.0 = 0.034 +- 0.098 (in-sample avg dev_std = 0.138)
NEC for r=0.4 class 1.0 = 0.009 +- 0.098 (in-sample avg dev_std = 0.138)
NEC for r=0.4 all KL = 0.021 +- 0.098 (in-sample avg dev_std = 0.138)
NEC for r=0.4 all L1 = 0.02 +- 0.069 (in-sample avg dev_std = 0.138)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11512199999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.987
NEC for r=0.8 class 0.0 = 0.031 +- 0.097 (in-sample avg dev_std = 0.133)
NEC for r=0.8 class 1.0 = 0.009 +- 0.097 (in-sample avg dev_std = 0.133)
NEC for r=0.8 all KL = 0.021 +- 0.097 (in-sample avg dev_std = 0.133)
NEC for r=0.8 all L1 = 0.019 +- 0.064 (in-sample avg dev_std = 0.133)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25650019999999996
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.856
NEC for r=0.05 class 0.0 = 0.043 +- 0.297 (in-sample avg dev_std = 0.397)
NEC for r=0.05 class 1.0 = 0.267 +- 0.297 (in-sample avg dev_std = 0.397)
NEC for r=0.05 all KL = 0.213 +- 0.297 (in-sample avg dev_std = 0.397)
NEC for r=0.05 all L1 = 0.156 +- 0.189 (in-sample avg dev_std = 0.397)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1450794
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.899
NEC for r=0.1 class 0.0 = 0.029 +- 0.225 (in-sample avg dev_std = 0.285)
NEC for r=0.1 class 1.0 = 0.172 +- 0.225 (in-sample avg dev_std = 0.285)
NEC for r=0.1 all KL = 0.12 +- 0.225 (in-sample avg dev_std = 0.285)
NEC for r=0.1 all L1 = 0.101 +- 0.146 (in-sample avg dev_std = 0.285)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0784476
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.916
NEC for r=0.2 class 0.0 = 0.021 +- 0.178 (in-sample avg dev_std = 0.214)
NEC for r=0.2 class 1.0 = 0.118 +- 0.178 (in-sample avg dev_std = 0.214)
NEC for r=0.2 all KL = 0.071 +- 0.178 (in-sample avg dev_std = 0.214)
NEC for r=0.2 all L1 = 0.07 +- 0.114 (in-sample avg dev_std = 0.214)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0418752
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.924
NEC for r=0.4 class 0.0 = 0.014 +- 0.138 (in-sample avg dev_std = 0.160)
NEC for r=0.4 class 1.0 = 0.085 +- 0.138 (in-sample avg dev_std = 0.160)
NEC for r=0.4 all KL = 0.042 +- 0.138 (in-sample avg dev_std = 0.160)
NEC for r=0.4 all L1 = 0.05 +- 0.089 (in-sample avg dev_std = 0.160)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.024070800000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.929
NEC for r=0.8 class 0.0 = 0.009 +- 0.095 (in-sample avg dev_std = 0.120)
NEC for r=0.8 class 1.0 = 0.074 +- 0.095 (in-sample avg dev_std = 0.120)
NEC for r=0.8 all KL = 0.025 +- 0.095 (in-sample avg dev_std = 0.120)
NEC for r=0.8 all L1 = 0.042 +- 0.078 (in-sample avg dev_std = 0.120)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.695
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2850872
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.648
NEC for r=0.05 class 0.0 = 0.066 +- 0.241 (in-sample avg dev_std = 0.190)
NEC for r=0.05 class 1.0 = 0.137 +- 0.241 (in-sample avg dev_std = 0.190)
NEC for r=0.05 all KL = 0.093 +- 0.241 (in-sample avg dev_std = 0.190)
NEC for r=0.05 all L1 = 0.101 +- 0.209 (in-sample avg dev_std = 0.190)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.695
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.213785
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.666
NEC for r=0.1 class 0.0 = 0.076 +- 0.210 (in-sample avg dev_std = 0.167)
NEC for r=0.1 class 1.0 = 0.094 +- 0.210 (in-sample avg dev_std = 0.167)
NEC for r=0.1 all KL = 0.074 +- 0.210 (in-sample avg dev_std = 0.167)
NEC for r=0.1 all L1 = 0.085 +- 0.183 (in-sample avg dev_std = 0.167)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.695
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.152517
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.674
NEC for r=0.2 class 0.0 = 0.081 +- 0.189 (in-sample avg dev_std = 0.165)
NEC for r=0.2 class 1.0 = 0.075 +- 0.189 (in-sample avg dev_std = 0.165)
NEC for r=0.2 all KL = 0.065 +- 0.189 (in-sample avg dev_std = 0.165)
NEC for r=0.2 all L1 = 0.078 +- 0.171 (in-sample avg dev_std = 0.165)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.695
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1165626
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.681
NEC for r=0.4 class 0.0 = 0.076 +- 0.172 (in-sample avg dev_std = 0.170)
NEC for r=0.4 class 1.0 = 0.074 +- 0.172 (in-sample avg dev_std = 0.170)
NEC for r=0.4 all KL = 0.061 +- 0.172 (in-sample avg dev_std = 0.170)
NEC for r=0.4 all L1 = 0.075 +- 0.161 (in-sample avg dev_std = 0.170)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.695
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1024266
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.676
NEC for r=0.8 class 0.0 = 0.07 +- 0.163 (in-sample avg dev_std = 0.177)
NEC for r=0.8 class 1.0 = 0.08 +- 0.163 (in-sample avg dev_std = 0.177)
NEC for r=0.8 all KL = 0.06 +- 0.163 (in-sample avg dev_std = 0.177)
NEC for r=0.8 all L1 = 0.075 +- 0.154 (in-sample avg dev_std = 0.177)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 18:44:45 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 06:44:45 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 06:44:45 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 06:44:45 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 06:44:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:44:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 06:44:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:44:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 06:44:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:44:45 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 06:44:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 77 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ACCURACY: 0.9888
Train Loss: 0.0367
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0348
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0351
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0348
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0351

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 77...
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ACCURACY: 0.9888
Train Loss: 0.0367
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0348
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0351
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0348
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0351

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.382
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.353
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.255
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.169
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.114
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.248
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.139
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.075
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.039
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.023
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.283
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.212
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.146
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.110
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.094


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381686
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.935
SUFF_SIMPLE for r=0.05 class 0.0 = 0.857 +- 0.271 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.939 +- 0.271 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.05 all KL = 0.86 +- 0.271 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.05 all L1 = 0.903 +- 0.173 (in-sample avg dev_std = 0.343)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35322
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.938
SUFF_SIMPLE for r=0.1 class 0.0 = 0.868 +- 0.251 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.942 +- 0.251 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.1 all KL = 0.871 +- 0.251 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.1 all L1 = 0.909 +- 0.163 (in-sample avg dev_std = 0.316)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254516
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.933
SUFF_SIMPLE for r=0.2 class 0.0 = 0.865 +- 0.265 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.933 +- 0.265 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.2 all KL = 0.865 +- 0.265 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.2 all L1 = 0.903 +- 0.174 (in-sample avg dev_std = 0.337)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.16855400000000004
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.933
SUFF_SIMPLE for r=0.4 class 0.0 = 0.86 +- 0.269 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.934 +- 0.269 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.4 all KL = 0.861 +- 0.269 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.4 all L1 = 0.901 +- 0.173 (in-sample avg dev_std = 0.341)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11422
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.916
SUFF_SIMPLE for r=0.8 class 0.0 = 0.87 +- 0.277 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.893 +- 0.277 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.8 all KL = 0.851 +- 0.277 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.8 all L1 = 0.883 +- 0.200 (in-sample avg dev_std = 0.316)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.797
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2482062
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.773
SUFF_SIMPLE for r=0.05 class 0.0 = 0.969 +- 0.222 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.899 +- 0.222 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.05 all KL = 0.921 +- 0.222 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.05 all L1 = 0.934 +- 0.093 (in-sample avg dev_std = 0.179)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.797
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1390932
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.774
SUFF_SIMPLE for r=0.1 class 0.0 = 0.971 +- 0.221 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.897 +- 0.221 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.1 all KL = 0.921 +- 0.221 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.1 all L1 = 0.934 +- 0.093 (in-sample avg dev_std = 0.177)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.797
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07463979999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.773
SUFF_SIMPLE for r=0.2 class 0.0 = 0.97 +- 0.219 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.893 +- 0.219 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.2 all KL = 0.921 +- 0.219 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.2 all L1 = 0.931 +- 0.096 (in-sample avg dev_std = 0.180)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.797
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03945939999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.768
SUFF_SIMPLE for r=0.4 class 0.0 = 0.969 +- 0.223 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.878 +- 0.223 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.4 all KL = 0.913 +- 0.223 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.4 all L1 = 0.923 +- 0.106 (in-sample avg dev_std = 0.190)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.797
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.023059800000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.743
SUFF_SIMPLE for r=0.8 class 0.0 = 0.98 +- 0.189 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.805 +- 0.189 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.8 all KL = 0.907 +- 0.189 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.8 all L1 = 0.892 +- 0.152 (in-sample avg dev_std = 0.199)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.679
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.28305860000000005
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.648
SUFF_SIMPLE for r=0.05 class 0.0 = 0.902 +- 0.256 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.841 +- 0.256 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.05 all KL = 0.872 +- 0.256 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.05 all L1 = 0.872 +- 0.223 (in-sample avg dev_std = 0.236)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.679
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2117496
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.648
SUFF_SIMPLE for r=0.1 class 0.0 = 0.903 +- 0.259 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.839 +- 0.259 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.1 all KL = 0.872 +- 0.259 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.1 all L1 = 0.871 +- 0.225 (in-sample avg dev_std = 0.230)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.679
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.14642339999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.642
SUFF_SIMPLE for r=0.2 class 0.0 = 0.906 +- 0.261 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.84 +- 0.261 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.2 all KL = 0.874 +- 0.261 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.2 all L1 = 0.873 +- 0.226 (in-sample avg dev_std = 0.224)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10953380000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.641
SUFF_SIMPLE for r=0.4 class 0.0 = 0.91 +- 0.263 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.834 +- 0.263 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.4 all KL = 0.872 +- 0.263 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.4 all L1 = 0.872 +- 0.228 (in-sample avg dev_std = 0.223)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.679
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0943582
len(reference) = 4946
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.638
SUFF_SIMPLE for r=0.8 class 0.0 = 0.923 +- 0.259 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.849 +- 0.259 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.8 all KL = 0.89 +- 0.259 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.8 all L1 = 0.887 +- 0.223 (in-sample avg dev_std = 0.161)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381686
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.951
NEC for r=0.05 class 0.0 = 0.103 +- 0.231 (in-sample avg dev_std = 0.255)
NEC for r=0.05 class 1.0 = 0.036 +- 0.231 (in-sample avg dev_std = 0.255)
NEC for r=0.05 all KL = 0.081 +- 0.231 (in-sample avg dev_std = 0.255)
NEC for r=0.05 all L1 = 0.066 +- 0.146 (in-sample avg dev_std = 0.255)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35322
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.954
NEC for r=0.1 class 0.0 = 0.092 +- 0.213 (in-sample avg dev_std = 0.254)
NEC for r=0.1 class 1.0 = 0.034 +- 0.213 (in-sample avg dev_std = 0.254)
NEC for r=0.1 all KL = 0.075 +- 0.213 (in-sample avg dev_std = 0.254)
NEC for r=0.1 all L1 = 0.06 +- 0.135 (in-sample avg dev_std = 0.254)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254516
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.961
NEC for r=0.2 class 0.0 = 0.08 +- 0.198 (in-sample avg dev_std = 0.243)
NEC for r=0.2 class 1.0 = 0.027 +- 0.198 (in-sample avg dev_std = 0.243)
NEC for r=0.2 all KL = 0.066 +- 0.198 (in-sample avg dev_std = 0.243)
NEC for r=0.2 all L1 = 0.051 +- 0.121 (in-sample avg dev_std = 0.243)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.16855400000000004
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.974
NEC for r=0.4 class 0.0 = 0.059 +- 0.157 (in-sample avg dev_std = 0.203)
NEC for r=0.4 class 1.0 = 0.02 +- 0.157 (in-sample avg dev_std = 0.203)
NEC for r=0.4 all KL = 0.047 +- 0.157 (in-sample avg dev_std = 0.203)
NEC for r=0.4 all L1 = 0.037 +- 0.097 (in-sample avg dev_std = 0.203)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11422
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.971
NEC for r=0.8 class 0.0 = 0.064 +- 0.170 (in-sample avg dev_std = 0.214)
NEC for r=0.8 class 1.0 = 0.017 +- 0.170 (in-sample avg dev_std = 0.214)
NEC for r=0.8 all KL = 0.056 +- 0.170 (in-sample avg dev_std = 0.214)
NEC for r=0.8 all L1 = 0.038 +- 0.095 (in-sample avg dev_std = 0.214)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.797
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2482062
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.717
NEC for r=0.05 class 0.0 = 0.07 +- 0.292 (in-sample avg dev_std = 0.306)
NEC for r=0.05 class 1.0 = 0.185 +- 0.292 (in-sample avg dev_std = 0.306)
NEC for r=0.05 all KL = 0.16 +- 0.292 (in-sample avg dev_std = 0.306)
NEC for r=0.05 all L1 = 0.128 +- 0.164 (in-sample avg dev_std = 0.306)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.797
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1390932
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.751
NEC for r=0.1 class 0.0 = 0.05 +- 0.259 (in-sample avg dev_std = 0.221)
NEC for r=0.1 class 1.0 = 0.108 +- 0.259 (in-sample avg dev_std = 0.221)
NEC for r=0.1 all KL = 0.103 +- 0.259 (in-sample avg dev_std = 0.221)
NEC for r=0.1 all L1 = 0.079 +- 0.115 (in-sample avg dev_std = 0.221)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.797
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07463979999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.772
NEC for r=0.2 class 0.0 = 0.031 +- 0.223 (in-sample avg dev_std = 0.168)
NEC for r=0.2 class 1.0 = 0.072 +- 0.223 (in-sample avg dev_std = 0.168)
NEC for r=0.2 all KL = 0.07 +- 0.223 (in-sample avg dev_std = 0.168)
NEC for r=0.2 all L1 = 0.052 +- 0.081 (in-sample avg dev_std = 0.168)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.797
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03945939999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.784
NEC for r=0.4 class 0.0 = 0.018 +- 0.177 (in-sample avg dev_std = 0.127)
NEC for r=0.4 class 1.0 = 0.055 +- 0.177 (in-sample avg dev_std = 0.127)
NEC for r=0.4 all KL = 0.044 +- 0.177 (in-sample avg dev_std = 0.127)
NEC for r=0.4 all L1 = 0.036 +- 0.059 (in-sample avg dev_std = 0.127)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.797
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.023059800000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.787
NEC for r=0.8 class 0.0 = 0.012 +- 0.150 (in-sample avg dev_std = 0.106)
NEC for r=0.8 class 1.0 = 0.054 +- 0.150 (in-sample avg dev_std = 0.106)
NEC for r=0.8 all KL = 0.033 +- 0.150 (in-sample avg dev_std = 0.106)
NEC for r=0.8 all L1 = 0.033 +- 0.051 (in-sample avg dev_std = 0.106)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.679
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.28305860000000005
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.638
NEC for r=0.05 class 0.0 = 0.073 +- 0.261 (in-sample avg dev_std = 0.194)
NEC for r=0.05 class 1.0 = 0.159 +- 0.261 (in-sample avg dev_std = 0.194)
NEC for r=0.05 all KL = 0.108 +- 0.261 (in-sample avg dev_std = 0.194)
NEC for r=0.05 all L1 = 0.115 +- 0.229 (in-sample avg dev_std = 0.194)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.679
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2117496
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.671
NEC for r=0.1 class 0.0 = 0.082 +- 0.215 (in-sample avg dev_std = 0.175)
NEC for r=0.1 class 1.0 = 0.1 +- 0.215 (in-sample avg dev_std = 0.175)
NEC for r=0.1 all KL = 0.08 +- 0.215 (in-sample avg dev_std = 0.175)
NEC for r=0.1 all L1 = 0.091 +- 0.191 (in-sample avg dev_std = 0.175)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.679
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.14642339999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.671
NEC for r=0.2 class 0.0 = 0.083 +- 0.188 (in-sample avg dev_std = 0.172)
NEC for r=0.2 class 1.0 = 0.085 +- 0.188 (in-sample avg dev_std = 0.172)
NEC for r=0.2 all KL = 0.068 +- 0.188 (in-sample avg dev_std = 0.172)
NEC for r=0.2 all L1 = 0.084 +- 0.176 (in-sample avg dev_std = 0.172)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10953380000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.676
NEC for r=0.4 class 0.0 = 0.079 +- 0.183 (in-sample avg dev_std = 0.182)
NEC for r=0.4 class 1.0 = 0.086 +- 0.183 (in-sample avg dev_std = 0.182)
NEC for r=0.4 all KL = 0.068 +- 0.183 (in-sample avg dev_std = 0.182)
NEC for r=0.4 all L1 = 0.082 +- 0.173 (in-sample avg dev_std = 0.182)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.679
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0943582
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.667
NEC for r=0.8 class 0.0 = 0.074 +- 0.182 (in-sample avg dev_std = 0.203)
NEC for r=0.8 class 1.0 = 0.095 +- 0.182 (in-sample avg dev_std = 0.203)
NEC for r=0.8 all KL = 0.073 +- 0.182 (in-sample avg dev_std = 0.203)
NEC for r=0.8 all L1 = 0.085 +- 0.172 (in-sample avg dev_std = 0.203)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 19:00:08 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 07:00:08 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 07:00:08 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 07:00:08 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 07:00:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:00:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:00:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:00:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:00:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:00:08 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 07:00:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9898
Train Loss: 0.0441
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0486
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0525
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0486
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0525

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9898
Train Loss: 0.0441
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0486
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0525
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0486
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0525

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.369
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.322
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.228
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.141
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.096
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.255
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.145
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.079
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.042
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.022
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.276
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.199
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.133
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.101
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.092


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.368644
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.945
SUFF_SIMPLE for r=0.05 class 0.0 = 0.874 +- 0.239 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.952 +- 0.239 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.05 all KL = 0.892 +- 0.239 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.05 all L1 = 0.917 +- 0.157 (in-sample avg dev_std = 0.290)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32156799999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.946
SUFF_SIMPLE for r=0.1 class 0.0 = 0.875 +- 0.233 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.955 +- 0.233 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.1 all KL = 0.898 +- 0.233 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.1 all L1 = 0.92 +- 0.156 (in-sample avg dev_std = 0.279)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.228022
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.945
SUFF_SIMPLE for r=0.2 class 0.0 = 0.874 +- 0.244 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.95 +- 0.244 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.2 all KL = 0.886 +- 0.244 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.2 all L1 = 0.916 +- 0.157 (in-sample avg dev_std = 0.295)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.955
SUFF_SIMPLE for r=0.4 class 0.0 = 0.892 +- 0.213 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.947 +- 0.213 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.4 all KL = 0.905 +- 0.213 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.4 all L1 = 0.922 +- 0.147 (in-sample avg dev_std = 0.271)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.096098
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.934
SUFF_SIMPLE for r=0.8 class 0.0 = 0.891 +- 0.238 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.904 +- 0.238 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.8 all KL = 0.887 +- 0.238 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.8 all L1 = 0.898 +- 0.185 (in-sample avg dev_std = 0.257)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.74
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25512219999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.755
SUFF_SIMPLE for r=0.05 class 0.0 = 0.992 +- 0.132 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.859 +- 0.132 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 all KL = 0.953 +- 0.132 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 all L1 = 0.925 +- 0.124 (in-sample avg dev_std = 0.128)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.74
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1447938
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.757
SUFF_SIMPLE for r=0.1 class 0.0 = 0.994 +- 0.122 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.856 +- 0.122 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all KL = 0.956 +- 0.122 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all L1 = 0.924 +- 0.127 (in-sample avg dev_std = 0.123)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.74
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07866580000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.758
SUFF_SIMPLE for r=0.2 class 0.0 = 0.994 +- 0.114 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.852 +- 0.114 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 all KL = 0.957 +- 0.114 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 all L1 = 0.923 +- 0.129 (in-sample avg dev_std = 0.121)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.74
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0417914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.761
SUFF_SIMPLE for r=0.4 class 0.0 = 0.995 +- 0.117 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.834 +- 0.117 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.4 all KL = 0.952 +- 0.117 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.143 (in-sample avg dev_std = 0.126)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.74
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0224552
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.756
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.192 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.736 +- 0.192 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.8 all KL = 0.901 +- 0.192 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.8 all L1 = 0.865 +- 0.208 (in-sample avg dev_std = 0.151)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.626
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.27557080000000006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.595
SUFF_SIMPLE for r=0.05 class 0.0 = 0.915 +- 0.251 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.84 +- 0.251 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.05 all KL = 0.88 +- 0.251 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.05 all L1 = 0.878 +- 0.223 (in-sample avg dev_std = 0.209)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.626
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1988164
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.594
SUFF_SIMPLE for r=0.1 class 0.0 = 0.915 +- 0.253 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.837 +- 0.253 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.1 all KL = 0.878 +- 0.253 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.1 all L1 = 0.877 +- 0.224 (in-sample avg dev_std = 0.211)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.626
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1334176
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.595
SUFF_SIMPLE for r=0.2 class 0.0 = 0.918 +- 0.250 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.838 +- 0.250 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 all KL = 0.883 +- 0.250 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 all L1 = 0.879 +- 0.225 (in-sample avg dev_std = 0.198)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.626
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1005448
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.59
SUFF_SIMPLE for r=0.4 class 0.0 = 0.918 +- 0.254 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.833 +- 0.254 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 all KL = 0.88 +- 0.254 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 all L1 = 0.876 +- 0.230 (in-sample avg dev_std = 0.191)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.63
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0916568
len(reference) = 4955
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.599
SUFF_SIMPLE for r=0.8 class 0.0 = 0.938 +- 0.242 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.832 +- 0.242 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.8 all KL = 0.896 +- 0.242 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.8 all L1 = 0.886 +- 0.224 (in-sample avg dev_std = 0.118)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.368644
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.941
NEC for r=0.05 class 0.0 = 0.104 +- 0.227 (in-sample avg dev_std = 0.238)
NEC for r=0.05 class 1.0 = 0.034 +- 0.227 (in-sample avg dev_std = 0.238)
NEC for r=0.05 all KL = 0.078 +- 0.227 (in-sample avg dev_std = 0.238)
NEC for r=0.05 all L1 = 0.065 +- 0.158 (in-sample avg dev_std = 0.238)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32156799999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.956
NEC for r=0.1 class 0.0 = 0.095 +- 0.208 (in-sample avg dev_std = 0.228)
NEC for r=0.1 class 1.0 = 0.021 +- 0.208 (in-sample avg dev_std = 0.228)
NEC for r=0.1 all KL = 0.067 +- 0.208 (in-sample avg dev_std = 0.228)
NEC for r=0.1 all L1 = 0.054 +- 0.135 (in-sample avg dev_std = 0.228)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.228022
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.96
NEC for r=0.2 class 0.0 = 0.084 +- 0.194 (in-sample avg dev_std = 0.219)
NEC for r=0.2 class 1.0 = 0.019 +- 0.194 (in-sample avg dev_std = 0.219)
NEC for r=0.2 all KL = 0.062 +- 0.194 (in-sample avg dev_std = 0.219)
NEC for r=0.2 all L1 = 0.048 +- 0.124 (in-sample avg dev_std = 0.219)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.965
NEC for r=0.4 class 0.0 = 0.066 +- 0.164 (in-sample avg dev_std = 0.210)
NEC for r=0.4 class 1.0 = 0.017 +- 0.164 (in-sample avg dev_std = 0.210)
NEC for r=0.4 all KL = 0.049 +- 0.164 (in-sample avg dev_std = 0.210)
NEC for r=0.4 all L1 = 0.039 +- 0.102 (in-sample avg dev_std = 0.210)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.096098
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.969
NEC for r=0.8 class 0.0 = 0.05 +- 0.130 (in-sample avg dev_std = 0.168)
NEC for r=0.8 class 1.0 = 0.013 +- 0.130 (in-sample avg dev_std = 0.168)
NEC for r=0.8 all KL = 0.034 +- 0.130 (in-sample avg dev_std = 0.168)
NEC for r=0.8 all L1 = 0.03 +- 0.086 (in-sample avg dev_std = 0.168)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.74
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25512219999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.578
NEC for r=0.05 class 0.0 = 0.049 +- 0.358 (in-sample avg dev_std = 0.397)
NEC for r=0.05 class 1.0 = 0.415 +- 0.358 (in-sample avg dev_std = 0.397)
NEC for r=0.05 all KL = 0.279 +- 0.358 (in-sample avg dev_std = 0.397)
NEC for r=0.05 all L1 = 0.233 +- 0.279 (in-sample avg dev_std = 0.397)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.74
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1447938
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.65
NEC for r=0.1 class 0.0 = 0.034 +- 0.300 (in-sample avg dev_std = 0.385)
NEC for r=0.1 class 1.0 = 0.309 +- 0.300 (in-sample avg dev_std = 0.385)
NEC for r=0.1 all KL = 0.207 +- 0.300 (in-sample avg dev_std = 0.385)
NEC for r=0.1 all L1 = 0.173 +- 0.216 (in-sample avg dev_std = 0.385)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.74
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07866580000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.693
NEC for r=0.2 class 0.0 = 0.026 +- 0.250 (in-sample avg dev_std = 0.325)
NEC for r=0.2 class 1.0 = 0.211 +- 0.250 (in-sample avg dev_std = 0.325)
NEC for r=0.2 all KL = 0.141 +- 0.250 (in-sample avg dev_std = 0.325)
NEC for r=0.2 all L1 = 0.119 +- 0.160 (in-sample avg dev_std = 0.325)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.74
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0417914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.72
NEC for r=0.4 class 0.0 = 0.011 +- 0.176 (in-sample avg dev_std = 0.244)
NEC for r=0.4 class 1.0 = 0.142 +- 0.176 (in-sample avg dev_std = 0.244)
NEC for r=0.4 all KL = 0.075 +- 0.176 (in-sample avg dev_std = 0.244)
NEC for r=0.4 all L1 = 0.077 +- 0.118 (in-sample avg dev_std = 0.244)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.74
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0224552
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.733
NEC for r=0.8 class 0.0 = 0.005 +- 0.120 (in-sample avg dev_std = 0.181)
NEC for r=0.8 class 1.0 = 0.102 +- 0.120 (in-sample avg dev_std = 0.181)
NEC for r=0.8 all KL = 0.039 +- 0.120 (in-sample avg dev_std = 0.181)
NEC for r=0.8 all L1 = 0.054 +- 0.089 (in-sample avg dev_std = 0.181)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.626
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.27557080000000006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.583
NEC for r=0.05 class 0.0 = 0.064 +- 0.233 (in-sample avg dev_std = 0.037)
NEC for r=0.05 class 1.0 = 0.129 +- 0.233 (in-sample avg dev_std = 0.037)
NEC for r=0.05 all KL = 0.082 +- 0.233 (in-sample avg dev_std = 0.037)
NEC for r=0.05 all L1 = 0.096 +- 0.221 (in-sample avg dev_std = 0.037)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.626
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1988164
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.589
NEC for r=0.1 class 0.0 = 0.07 +- 0.235 (in-sample avg dev_std = 0.194)
NEC for r=0.1 class 1.0 = 0.128 +- 0.235 (in-sample avg dev_std = 0.194)
NEC for r=0.1 all KL = 0.091 +- 0.235 (in-sample avg dev_std = 0.194)
NEC for r=0.1 all L1 = 0.099 +- 0.207 (in-sample avg dev_std = 0.194)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.626
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1334176
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.606
NEC for r=0.2 class 0.0 = 0.071 +- 0.200 (in-sample avg dev_std = 0.202)
NEC for r=0.2 class 1.0 = 0.099 +- 0.200 (in-sample avg dev_std = 0.202)
NEC for r=0.2 all KL = 0.079 +- 0.200 (in-sample avg dev_std = 0.202)
NEC for r=0.2 all L1 = 0.085 +- 0.174 (in-sample avg dev_std = 0.202)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.626
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1005448
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.621
NEC for r=0.4 class 0.0 = 0.068 +- 0.180 (in-sample avg dev_std = 0.183)
NEC for r=0.4 class 1.0 = 0.09 +- 0.180 (in-sample avg dev_std = 0.183)
NEC for r=0.4 all KL = 0.068 +- 0.180 (in-sample avg dev_std = 0.183)
NEC for r=0.4 all L1 = 0.079 +- 0.162 (in-sample avg dev_std = 0.183)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.626
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0916568
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.61
NEC for r=0.8 class 0.0 = 0.065 +- 0.179 (in-sample avg dev_std = 0.187)
NEC for r=0.8 class 1.0 = 0.099 +- 0.179 (in-sample avg dev_std = 0.187)
NEC for r=0.8 all KL = 0.07 +- 0.179 (in-sample avg dev_std = 0.187)
NEC for r=0.8 all L1 = 0.082 +- 0.168 (in-sample avg dev_std = 0.187)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 19:15:33 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 07:15:33 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 07:15:33 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 07:15:33 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 07:15:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:15:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:15:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:15:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:15:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:15:33 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 07:15:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9718
Train Loss: 0.0708
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0692
ID Test ACCURACY: 0.9580
ID Test Loss: 0.0971
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0692
OOD Test ACCURACY: 0.9580
OOD Test Loss: 0.0971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9718
Train Loss: 0.0708
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0692
ID Test ACCURACY: 0.9580
ID Test Loss: 0.0971
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0692
OOD Test ACCURACY: 0.9580
OOD Test Loss: 0.0971

[0m[1;37mINFO[0m: [1mChartInfo 0.9580 0.9580 0.9580 0.9580 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.413
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.361
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.255
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.159
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.109
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.228
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.131
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.073
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.040
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.022
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.268
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.202
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.140
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.108
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.097


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.413274
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.939
SUFF_SIMPLE for r=0.05 class 0.0 = 0.884 +- 0.184 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.95 +- 0.184 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.05 all KL = 0.917 +- 0.184 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.05 all L1 = 0.92 +- 0.145 (in-sample avg dev_std = 0.265)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.361036
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.939
SUFF_SIMPLE for r=0.1 class 0.0 = 0.882 +- 0.194 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.953 +- 0.194 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.1 all KL = 0.915 +- 0.194 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.1 all L1 = 0.921 +- 0.147 (in-sample avg dev_std = 0.273)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254962
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.938
SUFF_SIMPLE for r=0.2 class 0.0 = 0.886 +- 0.189 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.95 +- 0.189 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.2 all KL = 0.916 +- 0.189 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.2 all L1 = 0.921 +- 0.146 (in-sample avg dev_std = 0.260)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.158738
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.939
SUFF_SIMPLE for r=0.4 class 0.0 = 0.883 +- 0.200 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.943 +- 0.200 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.4 all KL = 0.911 +- 0.200 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.4 all L1 = 0.917 +- 0.156 (in-sample avg dev_std = 0.264)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.109048
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.903
SUFF_SIMPLE for r=0.8 class 0.0 = 0.846 +- 0.250 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.896 +- 0.250 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.8 all KL = 0.868 +- 0.250 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.8 all L1 = 0.873 +- 0.204 (in-sample avg dev_std = 0.275)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.791
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22811019999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.796
SUFF_SIMPLE for r=0.05 class 0.0 = 0.995 +- 0.109 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.874 +- 0.109 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.05 all KL = 0.958 +- 0.109 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.05 all L1 = 0.934 +- 0.123 (in-sample avg dev_std = 0.155)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.791
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1310016
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.795
SUFF_SIMPLE for r=0.1 class 0.0 = 0.994 +- 0.113 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.875 +- 0.113 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.1 all KL = 0.958 +- 0.113 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.1 all L1 = 0.934 +- 0.123 (in-sample avg dev_std = 0.153)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.791
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0726636
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.793
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.112 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.872 +- 0.112 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.2 all KL = 0.957 +- 0.112 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.2 all L1 = 0.933 +- 0.126 (in-sample avg dev_std = 0.157)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.791
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0396364
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.79
SUFF_SIMPLE for r=0.4 class 0.0 = 0.994 +- 0.128 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.858 +- 0.128 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 all KL = 0.948 +- 0.128 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 all L1 = 0.925 +- 0.137 (in-sample avg dev_std = 0.168)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.791
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.022072
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.744
SUFF_SIMPLE for r=0.8 class 0.0 = 0.992 +- 0.227 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.75 +- 0.227 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.8 all KL = 0.877 +- 0.227 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.8 all L1 = 0.87 +- 0.212 (in-sample avg dev_std = 0.242)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.666
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2678134
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.626
SUFF_SIMPLE for r=0.05 class 0.0 = 0.892 +- 0.230 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.848 +- 0.230 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.05 all KL = 0.888 +- 0.230 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.05 all L1 = 0.871 +- 0.220 (in-sample avg dev_std = 0.202)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.666
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2021102
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.626
SUFF_SIMPLE for r=0.1 class 0.0 = 0.893 +- 0.232 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.847 +- 0.232 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.1 all KL = 0.888 +- 0.232 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.1 all L1 = 0.87 +- 0.221 (in-sample avg dev_std = 0.201)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.666
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1403772
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.626
SUFF_SIMPLE for r=0.2 class 0.0 = 0.896 +- 0.230 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.846 +- 0.230 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.2 all KL = 0.889 +- 0.230 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.2 all L1 = 0.871 +- 0.221 (in-sample avg dev_std = 0.194)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.666
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10781439999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.627
SUFF_SIMPLE for r=0.4 class 0.0 = 0.9 +- 0.231 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.844 +- 0.231 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all KL = 0.89 +- 0.231 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all L1 = 0.872 +- 0.224 (in-sample avg dev_std = 0.182)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.665
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0974388
len(reference) = 4911
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.642
SUFF_SIMPLE for r=0.8 class 0.0 = 0.911 +- 0.233 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.844 +- 0.233 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.8 all KL = 0.897 +- 0.233 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.8 all L1 = 0.878 +- 0.223 (in-sample avg dev_std = 0.105)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.413274
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.954
NEC for r=0.05 class 0.0 = 0.077 +- 0.152 (in-sample avg dev_std = 0.167)
NEC for r=0.05 class 1.0 = 0.026 +- 0.152 (in-sample avg dev_std = 0.167)
NEC for r=0.05 all KL = 0.042 +- 0.152 (in-sample avg dev_std = 0.167)
NEC for r=0.05 all L1 = 0.049 +- 0.119 (in-sample avg dev_std = 0.167)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.361036
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.955
NEC for r=0.1 class 0.0 = 0.066 +- 0.135 (in-sample avg dev_std = 0.174)
NEC for r=0.1 class 1.0 = 0.029 +- 0.135 (in-sample avg dev_std = 0.174)
NEC for r=0.1 all KL = 0.037 +- 0.135 (in-sample avg dev_std = 0.174)
NEC for r=0.1 all L1 = 0.046 +- 0.114 (in-sample avg dev_std = 0.174)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254962
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.959
NEC for r=0.2 class 0.0 = 0.056 +- 0.113 (in-sample avg dev_std = 0.169)
NEC for r=0.2 class 1.0 = 0.023 +- 0.113 (in-sample avg dev_std = 0.169)
NEC for r=0.2 all KL = 0.034 +- 0.113 (in-sample avg dev_std = 0.169)
NEC for r=0.2 all L1 = 0.037 +- 0.087 (in-sample avg dev_std = 0.169)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.158738
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.962
NEC for r=0.4 class 0.0 = 0.047 +- 0.100 (in-sample avg dev_std = 0.150)
NEC for r=0.4 class 1.0 = 0.016 +- 0.100 (in-sample avg dev_std = 0.150)
NEC for r=0.4 all KL = 0.026 +- 0.100 (in-sample avg dev_std = 0.150)
NEC for r=0.4 all L1 = 0.03 +- 0.076 (in-sample avg dev_std = 0.150)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.109048
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.966
NEC for r=0.8 class 0.0 = 0.04 +- 0.072 (in-sample avg dev_std = 0.128)
NEC for r=0.8 class 1.0 = 0.012 +- 0.072 (in-sample avg dev_std = 0.128)
NEC for r=0.8 all KL = 0.017 +- 0.072 (in-sample avg dev_std = 0.128)
NEC for r=0.8 all L1 = 0.025 +- 0.069 (in-sample avg dev_std = 0.128)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.791
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22811019999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.582
NEC for r=0.05 class 0.0 = 0.023 +- 0.395 (in-sample avg dev_std = 0.410)
NEC for r=0.05 class 1.0 = 0.478 +- 0.395 (in-sample avg dev_std = 0.410)
NEC for r=0.05 all KL = 0.303 +- 0.395 (in-sample avg dev_std = 0.410)
NEC for r=0.05 all L1 = 0.253 +- 0.316 (in-sample avg dev_std = 0.410)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.791
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1310016
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.676
NEC for r=0.1 class 0.0 = 0.012 +- 0.320 (in-sample avg dev_std = 0.417)
NEC for r=0.1 class 1.0 = 0.347 +- 0.320 (in-sample avg dev_std = 0.417)
NEC for r=0.1 all KL = 0.22 +- 0.320 (in-sample avg dev_std = 0.417)
NEC for r=0.1 all L1 = 0.181 +- 0.242 (in-sample avg dev_std = 0.417)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.791
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0726636
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.734
NEC for r=0.2 class 0.0 = 0.007 +- 0.241 (in-sample avg dev_std = 0.350)
NEC for r=0.2 class 1.0 = 0.233 +- 0.241 (in-sample avg dev_std = 0.350)
NEC for r=0.2 all KL = 0.139 +- 0.241 (in-sample avg dev_std = 0.350)
NEC for r=0.2 all L1 = 0.121 +- 0.177 (in-sample avg dev_std = 0.350)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.791
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0396364
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.768
NEC for r=0.4 class 0.0 = 0.005 +- 0.172 (in-sample avg dev_std = 0.266)
NEC for r=0.4 class 1.0 = 0.148 +- 0.172 (in-sample avg dev_std = 0.266)
NEC for r=0.4 all KL = 0.077 +- 0.172 (in-sample avg dev_std = 0.266)
NEC for r=0.4 all L1 = 0.077 +- 0.127 (in-sample avg dev_std = 0.266)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.791
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.022072
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.782
NEC for r=0.8 class 0.0 = 0.002 +- 0.115 (in-sample avg dev_std = 0.197)
NEC for r=0.8 class 1.0 = 0.1 +- 0.115 (in-sample avg dev_std = 0.197)
NEC for r=0.8 all KL = 0.042 +- 0.115 (in-sample avg dev_std = 0.197)
NEC for r=0.8 all L1 = 0.051 +- 0.093 (in-sample avg dev_std = 0.197)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.666
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2678134
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.579
NEC for r=0.05 class 0.0 = 0.082 +- 0.287 (in-sample avg dev_std = 0.125)
NEC for r=0.05 class 1.0 = 0.193 +- 0.287 (in-sample avg dev_std = 0.125)
NEC for r=0.05 all KL = 0.123 +- 0.287 (in-sample avg dev_std = 0.125)
NEC for r=0.05 all L1 = 0.137 +- 0.262 (in-sample avg dev_std = 0.125)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.666
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2021102
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.608
NEC for r=0.1 class 0.0 = 0.085 +- 0.247 (in-sample avg dev_std = 0.242)
NEC for r=0.1 class 1.0 = 0.149 +- 0.247 (in-sample avg dev_std = 0.242)
NEC for r=0.1 all KL = 0.109 +- 0.247 (in-sample avg dev_std = 0.242)
NEC for r=0.1 all L1 = 0.117 +- 0.210 (in-sample avg dev_std = 0.242)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.666
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1403772
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.63
NEC for r=0.2 class 0.0 = 0.081 +- 0.192 (in-sample avg dev_std = 0.210)
NEC for r=0.2 class 1.0 = 0.107 +- 0.192 (in-sample avg dev_std = 0.210)
NEC for r=0.2 all KL = 0.079 +- 0.192 (in-sample avg dev_std = 0.210)
NEC for r=0.2 all L1 = 0.094 +- 0.173 (in-sample avg dev_std = 0.210)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.666
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10781439999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.647
NEC for r=0.4 class 0.0 = 0.079 +- 0.165 (in-sample avg dev_std = 0.181)
NEC for r=0.4 class 1.0 = 0.098 +- 0.165 (in-sample avg dev_std = 0.181)
NEC for r=0.4 all KL = 0.066 +- 0.165 (in-sample avg dev_std = 0.181)
NEC for r=0.4 all L1 = 0.088 +- 0.166 (in-sample avg dev_std = 0.181)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.666
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0974388
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.638
NEC for r=0.8 class 0.0 = 0.075 +- 0.158 (in-sample avg dev_std = 0.181)
NEC for r=0.8 class 1.0 = 0.098 +- 0.158 (in-sample avg dev_std = 0.181)
NEC for r=0.8 all KL = 0.063 +- 0.158 (in-sample avg dev_std = 0.181)
NEC for r=0.8 all L1 = 0.087 +- 0.166 (in-sample avg dev_std = 0.181)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 19:31:20 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 07:31:21 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 07:31:21 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 07:31:21 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 07:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:31:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 07:31:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0398
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0312
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0530
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0312
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0530

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0398
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0312
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0530
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0312
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0530

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9920 0.9920[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.361
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.338
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.242
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.153
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.110
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.228
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.128
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.069
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.036
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.022
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.271
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.201
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.139
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.107
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.100


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.36095000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.952
SUFF_SIMPLE for r=0.05 class 0.0 = 0.882 +- 0.227 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.969 +- 0.227 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.05 all KL = 0.897 +- 0.227 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.05 all L1 = 0.93 +- 0.143 (in-sample avg dev_std = 0.283)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.337952
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.949
SUFF_SIMPLE for r=0.1 class 0.0 = 0.888 +- 0.224 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.965 +- 0.224 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.1 all KL = 0.897 +- 0.224 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.1 all L1 = 0.93 +- 0.140 (in-sample avg dev_std = 0.283)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.242072
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.956
SUFF_SIMPLE for r=0.2 class 0.0 = 0.902 +- 0.210 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.962 +- 0.210 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.2 all KL = 0.906 +- 0.210 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.2 all L1 = 0.935 +- 0.132 (in-sample avg dev_std = 0.266)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.152696
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.952
SUFF_SIMPLE for r=0.4 class 0.0 = 0.888 +- 0.234 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.961 +- 0.234 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.4 all KL = 0.888 +- 0.234 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.4 all L1 = 0.928 +- 0.139 (in-sample avg dev_std = 0.292)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.110316
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.92
SUFF_SIMPLE for r=0.8 class 0.0 = 0.881 +- 0.267 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.916 +- 0.267 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.8 all KL = 0.865 +- 0.267 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.8 all L1 = 0.9 +- 0.190 (in-sample avg dev_std = 0.281)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.227644
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.887
SUFF_SIMPLE for r=0.05 class 0.0 = 0.83 +- 0.336 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.973 +- 0.336 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.05 all KL = 0.816 +- 0.336 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.05 all L1 = 0.902 +- 0.181 (in-sample avg dev_std = 0.313)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1283276
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.887
SUFF_SIMPLE for r=0.1 class 0.0 = 0.827 +- 0.342 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.97 +- 0.342 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.1 all KL = 0.806 +- 0.342 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.1 all L1 = 0.899 +- 0.183 (in-sample avg dev_std = 0.315)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0689638
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.891
SUFF_SIMPLE for r=0.2 class 0.0 = 0.823 +- 0.340 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.967 +- 0.340 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.2 all KL = 0.807 +- 0.340 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.2 all L1 = 0.896 +- 0.191 (in-sample avg dev_std = 0.311)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0364488
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.896
SUFF_SIMPLE for r=0.4 class 0.0 = 0.807 +- 0.357 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.951 +- 0.357 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.4 all KL = 0.781 +- 0.357 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.4 all L1 = 0.88 +- 0.213 (in-sample avg dev_std = 0.321)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.022016200000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.895
SUFF_SIMPLE for r=0.8 class 0.0 = 0.756 +- 0.419 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.856 +- 0.419 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.8 all KL = 0.673 +- 0.419 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.8 all L1 = 0.806 +- 0.283 (in-sample avg dev_std = 0.363)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.708
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2708354
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.679
SUFF_SIMPLE for r=0.05 class 0.0 = 0.888 +- 0.246 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.853 +- 0.246 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.05 all KL = 0.877 +- 0.246 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.05 all L1 = 0.871 +- 0.211 (in-sample avg dev_std = 0.218)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.708
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2011656
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.681
SUFF_SIMPLE for r=0.1 class 0.0 = 0.891 +- 0.244 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.854 +- 0.244 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 all KL = 0.88 +- 0.244 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 all L1 = 0.873 +- 0.211 (in-sample avg dev_std = 0.208)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.708
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.13908579999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.68
SUFF_SIMPLE for r=0.2 class 0.0 = 0.896 +- 0.246 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.851 +- 0.246 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.2 all KL = 0.881 +- 0.246 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.2 all L1 = 0.874 +- 0.211 (in-sample avg dev_std = 0.199)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.708
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10683719999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.67
SUFF_SIMPLE for r=0.4 class 0.0 = 0.898 +- 0.254 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.849 +- 0.254 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.4 all KL = 0.877 +- 0.254 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.4 all L1 = 0.874 +- 0.209 (in-sample avg dev_std = 0.209)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.709
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1004552
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.668
SUFF_SIMPLE for r=0.8 class 0.0 = 0.916 +- 0.245 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.853 +- 0.245 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.8 all KL = 0.897 +- 0.245 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.8 all L1 = 0.885 +- 0.209 (in-sample avg dev_std = 0.142)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.36095000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.942
NEC for r=0.05 class 0.0 = 0.135 +- 0.260 (in-sample avg dev_std = 0.272)
NEC for r=0.05 class 1.0 = 0.007 +- 0.260 (in-sample avg dev_std = 0.272)
NEC for r=0.05 all KL = 0.091 +- 0.260 (in-sample avg dev_std = 0.272)
NEC for r=0.05 all L1 = 0.064 +- 0.170 (in-sample avg dev_std = 0.272)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.337952
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.961
NEC for r=0.1 class 0.0 = 0.093 +- 0.213 (in-sample avg dev_std = 0.244)
NEC for r=0.1 class 1.0 = 0.009 +- 0.213 (in-sample avg dev_std = 0.244)
NEC for r=0.1 all KL = 0.07 +- 0.213 (in-sample avg dev_std = 0.244)
NEC for r=0.1 all L1 = 0.046 +- 0.130 (in-sample avg dev_std = 0.244)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.242072
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.967
NEC for r=0.2 class 0.0 = 0.078 +- 0.187 (in-sample avg dev_std = 0.223)
NEC for r=0.2 class 1.0 = 0.007 +- 0.187 (in-sample avg dev_std = 0.223)
NEC for r=0.2 all KL = 0.056 +- 0.187 (in-sample avg dev_std = 0.223)
NEC for r=0.2 all L1 = 0.039 +- 0.114 (in-sample avg dev_std = 0.223)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.152696
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.973
NEC for r=0.4 class 0.0 = 0.058 +- 0.149 (in-sample avg dev_std = 0.195)
NEC for r=0.4 class 1.0 = 0.008 +- 0.149 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all KL = 0.042 +- 0.149 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all L1 = 0.03 +- 0.092 (in-sample avg dev_std = 0.195)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.110316
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.978
NEC for r=0.8 class 0.0 = 0.044 +- 0.121 (in-sample avg dev_std = 0.162)
NEC for r=0.8 class 1.0 = 0.008 +- 0.121 (in-sample avg dev_std = 0.162)
NEC for r=0.8 all KL = 0.032 +- 0.121 (in-sample avg dev_std = 0.162)
NEC for r=0.8 all L1 = 0.024 +- 0.073 (in-sample avg dev_std = 0.162)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.227644
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.812
NEC for r=0.05 class 0.0 = 0.192 +- 0.388 (in-sample avg dev_std = 0.404)
NEC for r=0.05 class 1.0 = 0.028 +- 0.388 (in-sample avg dev_std = 0.404)
NEC for r=0.05 all KL = 0.222 +- 0.388 (in-sample avg dev_std = 0.404)
NEC for r=0.05 all L1 = 0.109 +- 0.192 (in-sample avg dev_std = 0.404)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1283276
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.843
NEC for r=0.1 class 0.0 = 0.13 +- 0.341 (in-sample avg dev_std = 0.322)
NEC for r=0.1 class 1.0 = 0.006 +- 0.341 (in-sample avg dev_std = 0.322)
NEC for r=0.1 all KL = 0.15 +- 0.341 (in-sample avg dev_std = 0.322)
NEC for r=0.1 all L1 = 0.067 +- 0.144 (in-sample avg dev_std = 0.322)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0689638
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.86
NEC for r=0.2 class 0.0 = 0.083 +- 0.293 (in-sample avg dev_std = 0.255)
NEC for r=0.2 class 1.0 = 0.003 +- 0.293 (in-sample avg dev_std = 0.255)
NEC for r=0.2 all KL = 0.106 +- 0.293 (in-sample avg dev_std = 0.255)
NEC for r=0.2 all L1 = 0.043 +- 0.104 (in-sample avg dev_std = 0.255)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0364488
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.87
NEC for r=0.4 class 0.0 = 0.058 +- 0.250 (in-sample avg dev_std = 0.202)
NEC for r=0.4 class 1.0 = 0.003 +- 0.250 (in-sample avg dev_std = 0.202)
NEC for r=0.4 all KL = 0.075 +- 0.250 (in-sample avg dev_std = 0.202)
NEC for r=0.4 all L1 = 0.03 +- 0.079 (in-sample avg dev_std = 0.202)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.022016200000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.88
NEC for r=0.8 class 0.0 = 0.061 +- 0.217 (in-sample avg dev_std = 0.177)
NEC for r=0.8 class 1.0 = 0.004 +- 0.217 (in-sample avg dev_std = 0.177)
NEC for r=0.8 all KL = 0.061 +- 0.217 (in-sample avg dev_std = 0.177)
NEC for r=0.8 all L1 = 0.033 +- 0.084 (in-sample avg dev_std = 0.177)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.708
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2708354
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.686
NEC for r=0.05 class 0.0 = 0.071 +- 0.216 (in-sample avg dev_std = 0.168)
NEC for r=0.05 class 1.0 = 0.11 +- 0.216 (in-sample avg dev_std = 0.168)
NEC for r=0.05 all KL = 0.078 +- 0.216 (in-sample avg dev_std = 0.168)
NEC for r=0.05 all L1 = 0.09 +- 0.187 (in-sample avg dev_std = 0.168)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.708
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2011656
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.697
NEC for r=0.1 class 0.0 = 0.082 +- 0.199 (in-sample avg dev_std = 0.149)
NEC for r=0.1 class 1.0 = 0.081 +- 0.199 (in-sample avg dev_std = 0.149)
NEC for r=0.1 all KL = 0.067 +- 0.199 (in-sample avg dev_std = 0.149)
NEC for r=0.1 all L1 = 0.082 +- 0.173 (in-sample avg dev_std = 0.149)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.708
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.13908579999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.691
NEC for r=0.2 class 0.0 = 0.087 +- 0.188 (in-sample avg dev_std = 0.161)
NEC for r=0.2 class 1.0 = 0.071 +- 0.188 (in-sample avg dev_std = 0.161)
NEC for r=0.2 all KL = 0.063 +- 0.188 (in-sample avg dev_std = 0.161)
NEC for r=0.2 all L1 = 0.079 +- 0.167 (in-sample avg dev_std = 0.161)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.708
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10683719999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.701
NEC for r=0.4 class 0.0 = 0.083 +- 0.175 (in-sample avg dev_std = 0.168)
NEC for r=0.4 class 1.0 = 0.069 +- 0.175 (in-sample avg dev_std = 0.168)
NEC for r=0.4 all KL = 0.061 +- 0.175 (in-sample avg dev_std = 0.168)
NEC for r=0.4 all L1 = 0.076 +- 0.161 (in-sample avg dev_std = 0.168)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.708
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1004552
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.698
NEC for r=0.8 class 0.0 = 0.075 +- 0.163 (in-sample avg dev_std = 0.173)
NEC for r=0.8 class 1.0 = 0.078 +- 0.163 (in-sample avg dev_std = 0.173)
NEC for r=0.8 all KL = 0.059 +- 0.163 (in-sample avg dev_std = 0.173)
NEC for r=0.8 all L1 = 0.076 +- 0.153 (in-sample avg dev_std = 0.173)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 19:47:21 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 07:47:21 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 07:47:21 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 07:47:21 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 07:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:47:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:47:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:47:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 07:47:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0298
ID Validation ACCURACY: 0.9880
ID Validation Loss: 0.0315
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0329
OOD Validation ACCURACY: 0.9880
OOD Validation Loss: 0.0315
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0329

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0298
ID Validation ACCURACY: 0.9880
ID Validation Loss: 0.0315
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0329
OOD Validation ACCURACY: 0.9880
OOD Validation Loss: 0.0315
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0329

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9880 0.9880[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.387
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.359
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.254
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.162
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.113
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.253
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.144
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.078
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.042
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.023
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.259
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.201
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.146
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.108
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.098


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387144
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.963
SUFF_SIMPLE for r=0.05 class 0.0 = 0.918 +- 0.173 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.961 +- 0.173 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.05 all KL = 0.933 +- 0.173 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.05 all L1 = 0.942 +- 0.125 (in-sample avg dev_std = 0.222)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35862
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.968
SUFF_SIMPLE for r=0.1 class 0.0 = 0.926 +- 0.166 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.959 +- 0.166 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.1 all KL = 0.935 +- 0.166 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.1 all L1 = 0.944 +- 0.117 (in-sample avg dev_std = 0.220)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254072
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.958
SUFF_SIMPLE for r=0.2 class 0.0 = 0.914 +- 0.199 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.954 +- 0.199 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.2 all KL = 0.917 +- 0.199 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.2 all L1 = 0.936 +- 0.133 (in-sample avg dev_std = 0.253)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.16170400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.964
SUFF_SIMPLE for r=0.4 class 0.0 = 0.921 +- 0.176 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.95 +- 0.176 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.4 all KL = 0.928 +- 0.176 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.4 all L1 = 0.937 +- 0.127 (in-sample avg dev_std = 0.239)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11291000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.944
SUFF_SIMPLE for r=0.8 class 0.0 = 0.912 +- 0.228 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.904 +- 0.228 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.8 all KL = 0.895 +- 0.228 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.8 all L1 = 0.908 +- 0.176 (in-sample avg dev_std = 0.231)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.902
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2534924
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.916
SUFF_SIMPLE for r=0.05 class 0.0 = 0.933 +- 0.151 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.863 +- 0.151 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.05 all KL = 0.929 +- 0.151 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.05 all L1 = 0.898 +- 0.154 (in-sample avg dev_std = 0.180)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.902
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1439618
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.915
SUFF_SIMPLE for r=0.1 class 0.0 = 0.93 +- 0.157 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.864 +- 0.157 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.1 all KL = 0.926 +- 0.157 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.1 all L1 = 0.897 +- 0.155 (in-sample avg dev_std = 0.187)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.902
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0783842
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.914
SUFF_SIMPLE for r=0.2 class 0.0 = 0.926 +- 0.168 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.858 +- 0.168 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.2 all KL = 0.919 +- 0.168 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.2 all L1 = 0.892 +- 0.160 (in-sample avg dev_std = 0.194)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.902
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0416024
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.909
SUFF_SIMPLE for r=0.4 class 0.0 = 0.92 +- 0.185 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.842 +- 0.185 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.4 all KL = 0.905 +- 0.185 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.4 all L1 = 0.881 +- 0.176 (in-sample avg dev_std = 0.215)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.902
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0228274
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.865
SUFF_SIMPLE for r=0.8 class 0.0 = 0.897 +- 0.276 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.735 +- 0.276 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.8 all KL = 0.823 +- 0.276 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.8 all L1 = 0.816 +- 0.248 (in-sample avg dev_std = 0.279)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.653
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2594706
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.621
SUFF_SIMPLE for r=0.05 class 0.0 = 0.906 +- 0.233 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.846 +- 0.233 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.05 all KL = 0.888 +- 0.233 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.05 all L1 = 0.876 +- 0.212 (in-sample avg dev_std = 0.202)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.653
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.201044
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.622
SUFF_SIMPLE for r=0.1 class 0.0 = 0.907 +- 0.236 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.844 +- 0.236 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.1 all KL = 0.886 +- 0.236 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.1 all L1 = 0.876 +- 0.213 (in-sample avg dev_std = 0.206)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.653
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459106
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.621
SUFF_SIMPLE for r=0.2 class 0.0 = 0.91 +- 0.237 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.845 +- 0.237 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all KL = 0.889 +- 0.237 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all L1 = 0.878 +- 0.214 (in-sample avg dev_std = 0.195)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.653
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1083908
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.621
SUFF_SIMPLE for r=0.4 class 0.0 = 0.91 +- 0.243 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.84 +- 0.243 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.4 all KL = 0.884 +- 0.243 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.4 all L1 = 0.875 +- 0.216 (in-sample avg dev_std = 0.197)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.653
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.097769
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.602
SUFF_SIMPLE for r=0.8 class 0.0 = 0.915 +- 0.256 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.838 +- 0.256 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.8 all KL = 0.89 +- 0.256 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.8 all L1 = 0.877 +- 0.230 (in-sample avg dev_std = 0.115)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387144
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.987
NEC for r=0.05 class 0.0 = 0.028 +- 0.031 (in-sample avg dev_std = 0.050)
NEC for r=0.05 class 1.0 = 0.02 +- 0.031 (in-sample avg dev_std = 0.050)
NEC for r=0.05 all KL = 0.008 +- 0.031 (in-sample avg dev_std = 0.050)
NEC for r=0.05 all L1 = 0.024 +- 0.064 (in-sample avg dev_std = 0.050)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35862
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.988
NEC for r=0.1 class 0.0 = 0.032 +- 0.069 (in-sample avg dev_std = 0.095)
NEC for r=0.1 class 1.0 = 0.018 +- 0.069 (in-sample avg dev_std = 0.095)
NEC for r=0.1 all KL = 0.014 +- 0.069 (in-sample avg dev_std = 0.095)
NEC for r=0.1 all L1 = 0.024 +- 0.069 (in-sample avg dev_std = 0.095)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254072
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.985
NEC for r=0.2 class 0.0 = 0.028 +- 0.060 (in-sample avg dev_std = 0.087)
NEC for r=0.2 class 1.0 = 0.014 +- 0.060 (in-sample avg dev_std = 0.087)
NEC for r=0.2 all KL = 0.012 +- 0.060 (in-sample avg dev_std = 0.087)
NEC for r=0.2 all L1 = 0.021 +- 0.062 (in-sample avg dev_std = 0.087)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.16170400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.985
NEC for r=0.4 class 0.0 = 0.024 +- 0.054 (in-sample avg dev_std = 0.079)
NEC for r=0.4 class 1.0 = 0.013 +- 0.054 (in-sample avg dev_std = 0.079)
NEC for r=0.4 all KL = 0.01 +- 0.054 (in-sample avg dev_std = 0.079)
NEC for r=0.4 all L1 = 0.018 +- 0.058 (in-sample avg dev_std = 0.079)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11291000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.986
NEC for r=0.8 class 0.0 = 0.023 +- 0.063 (in-sample avg dev_std = 0.106)
NEC for r=0.8 class 1.0 = 0.014 +- 0.063 (in-sample avg dev_std = 0.106)
NEC for r=0.8 all KL = 0.013 +- 0.063 (in-sample avg dev_std = 0.106)
NEC for r=0.8 all L1 = 0.018 +- 0.056 (in-sample avg dev_std = 0.106)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.902
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2534924
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.822
NEC for r=0.05 class 0.0 = 0.067 +- 0.252 (in-sample avg dev_std = 0.415)
NEC for r=0.05 class 1.0 = 0.327 +- 0.252 (in-sample avg dev_std = 0.415)
NEC for r=0.05 all KL = 0.211 +- 0.252 (in-sample avg dev_std = 0.415)
NEC for r=0.05 all L1 = 0.198 +- 0.208 (in-sample avg dev_std = 0.415)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.902
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1439618
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.873
NEC for r=0.1 class 0.0 = 0.05 +- 0.173 (in-sample avg dev_std = 0.295)
NEC for r=0.1 class 1.0 = 0.206 +- 0.173 (in-sample avg dev_std = 0.295)
NEC for r=0.1 all KL = 0.111 +- 0.173 (in-sample avg dev_std = 0.295)
NEC for r=0.1 all L1 = 0.129 +- 0.160 (in-sample avg dev_std = 0.295)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.902
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0783842
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.894
NEC for r=0.2 class 0.0 = 0.038 +- 0.113 (in-sample avg dev_std = 0.209)
NEC for r=0.2 class 1.0 = 0.141 +- 0.113 (in-sample avg dev_std = 0.209)
NEC for r=0.2 all KL = 0.058 +- 0.113 (in-sample avg dev_std = 0.209)
NEC for r=0.2 all L1 = 0.09 +- 0.126 (in-sample avg dev_std = 0.209)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.902
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0416024
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.902
NEC for r=0.4 class 0.0 = 0.032 +- 0.083 (in-sample avg dev_std = 0.164)
NEC for r=0.4 class 1.0 = 0.106 +- 0.083 (in-sample avg dev_std = 0.164)
NEC for r=0.4 all KL = 0.036 +- 0.083 (in-sample avg dev_std = 0.164)
NEC for r=0.4 all L1 = 0.069 +- 0.103 (in-sample avg dev_std = 0.164)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.902
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0228274
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.907
NEC for r=0.8 class 0.0 = 0.029 +- 0.062 (in-sample avg dev_std = 0.122)
NEC for r=0.8 class 1.0 = 0.086 +- 0.062 (in-sample avg dev_std = 0.122)
NEC for r=0.8 all KL = 0.023 +- 0.062 (in-sample avg dev_std = 0.122)
NEC for r=0.8 all L1 = 0.058 +- 0.091 (in-sample avg dev_std = 0.122)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.653
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2594706
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.624
NEC for r=0.05 class 0.0 = 0.062 +- 0.199 (in-sample avg dev_std = 0.123)
NEC for r=0.05 class 1.0 = 0.123 +- 0.199 (in-sample avg dev_std = 0.123)
NEC for r=0.05 all KL = 0.07 +- 0.199 (in-sample avg dev_std = 0.123)
NEC for r=0.05 all L1 = 0.092 +- 0.196 (in-sample avg dev_std = 0.123)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.653
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.201044
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.645
NEC for r=0.1 class 0.0 = 0.072 +- 0.168 (in-sample avg dev_std = 0.124)
NEC for r=0.1 class 1.0 = 0.085 +- 0.168 (in-sample avg dev_std = 0.124)
NEC for r=0.1 all KL = 0.056 +- 0.168 (in-sample avg dev_std = 0.124)
NEC for r=0.1 all L1 = 0.078 +- 0.168 (in-sample avg dev_std = 0.124)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.653
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459106
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.642
NEC for r=0.2 class 0.0 = 0.075 +- 0.152 (in-sample avg dev_std = 0.137)
NEC for r=0.2 class 1.0 = 0.075 +- 0.152 (in-sample avg dev_std = 0.137)
NEC for r=0.2 all KL = 0.051 +- 0.152 (in-sample avg dev_std = 0.137)
NEC for r=0.2 all L1 = 0.075 +- 0.157 (in-sample avg dev_std = 0.137)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.653
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1083908
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.646
NEC for r=0.4 class 0.0 = 0.07 +- 0.147 (in-sample avg dev_std = 0.150)
NEC for r=0.4 class 1.0 = 0.081 +- 0.147 (in-sample avg dev_std = 0.150)
NEC for r=0.4 all KL = 0.051 +- 0.147 (in-sample avg dev_std = 0.150)
NEC for r=0.4 all L1 = 0.075 +- 0.154 (in-sample avg dev_std = 0.150)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.653
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.097769
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.642
NEC for r=0.8 class 0.0 = 0.064 +- 0.143 (in-sample avg dev_std = 0.163)
NEC for r=0.8 class 1.0 = 0.084 +- 0.143 (in-sample avg dev_std = 0.163)
NEC for r=0.8 all KL = 0.052 +- 0.143 (in-sample avg dev_std = 0.163)
NEC for r=0.8 all L1 = 0.074 +- 0.150 (in-sample avg dev_std = 0.163)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 20:03:11 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 08:03:11 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 08:03:11 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 08:03:11 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 08:03:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:03:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:03:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:03:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:03:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:03:11 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 08:03:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0222
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0180
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0294
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0180
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0294

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0222
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0180
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0294
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0180
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0294

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9920 0.9920[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.372
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.356
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.258
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.160
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.109
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.146
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.081
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.044
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.024
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.014
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.187
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.154
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.117
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.094
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.087


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.372034
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.947
SUFF_SIMPLE for r=0.05 class 0.0 = 0.879 +- 0.256 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.967 +- 0.256 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.05 all KL = 0.881 +- 0.256 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.05 all L1 = 0.928 +- 0.153 (in-sample avg dev_std = 0.298)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.355744
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.957
SUFF_SIMPLE for r=0.1 class 0.0 = 0.893 +- 0.234 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.974 +- 0.234 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.1 all KL = 0.897 +- 0.234 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.1 all L1 = 0.938 +- 0.136 (in-sample avg dev_std = 0.275)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.258336
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.953
SUFF_SIMPLE for r=0.2 class 0.0 = 0.895 +- 0.243 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.966 +- 0.243 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.2 all KL = 0.893 +- 0.243 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.2 all L1 = 0.934 +- 0.145 (in-sample avg dev_std = 0.280)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.160152
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.95
SUFF_SIMPLE for r=0.4 class 0.0 = 0.894 +- 0.258 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.958 +- 0.258 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.4 all KL = 0.882 +- 0.258 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.4 all L1 = 0.929 +- 0.149 (in-sample avg dev_std = 0.295)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10936000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.924
SUFF_SIMPLE for r=0.8 class 0.0 = 0.868 +- 0.293 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.919 +- 0.293 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.8 all KL = 0.847 +- 0.293 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.8 all L1 = 0.896 +- 0.199 (in-sample avg dev_std = 0.297)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.959
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.14637360000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.948
SUFF_SIMPLE for r=0.05 class 0.0 = 0.953 +- 0.258 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.93 +- 0.258 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.05 all KL = 0.892 +- 0.258 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.05 all L1 = 0.941 +- 0.134 (in-sample avg dev_std = 0.239)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.959
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0810178
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.945
SUFF_SIMPLE for r=0.1 class 0.0 = 0.952 +- 0.265 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.928 +- 0.265 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.1 all KL = 0.886 +- 0.265 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.1 all L1 = 0.94 +- 0.136 (in-sample avg dev_std = 0.241)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.959
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.043623199999999994
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.946
SUFF_SIMPLE for r=0.2 class 0.0 = 0.953 +- 0.263 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.922 +- 0.263 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.2 all KL = 0.886 +- 0.263 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.2 all L1 = 0.937 +- 0.140 (in-sample avg dev_std = 0.244)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.959
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0235914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.944
SUFF_SIMPLE for r=0.4 class 0.0 = 0.954 +- 0.270 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.914 +- 0.270 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.4 all KL = 0.88 +- 0.270 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.4 all L1 = 0.934 +- 0.149 (in-sample avg dev_std = 0.248)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.959
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.014064600000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.919
SUFF_SIMPLE for r=0.8 class 0.0 = 0.958 +- 0.319 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.854 +- 0.319 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.8 all KL = 0.829 +- 0.319 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.8 all L1 = 0.906 +- 0.187 (in-sample avg dev_std = 0.304)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.66
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1865096
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.643
SUFF_SIMPLE for r=0.05 class 0.0 = 0.891 +- 0.260 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.85 +- 0.260 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.05 all KL = 0.864 +- 0.260 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.05 all L1 = 0.87 +- 0.221 (in-sample avg dev_std = 0.230)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.66
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.15397539999999998
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.64
SUFF_SIMPLE for r=0.1 class 0.0 = 0.896 +- 0.259 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.849 +- 0.259 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.1 all KL = 0.867 +- 0.259 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.1 all L1 = 0.873 +- 0.219 (in-sample avg dev_std = 0.229)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.66
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1173838
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.635
SUFF_SIMPLE for r=0.2 class 0.0 = 0.906 +- 0.253 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.852 +- 0.253 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.2 all KL = 0.874 +- 0.253 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.2 all L1 = 0.879 +- 0.211 (in-sample avg dev_std = 0.217)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.66
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0939026
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.642
SUFF_SIMPLE for r=0.4 class 0.0 = 0.913 +- 0.253 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.854 +- 0.253 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.4 all KL = 0.876 +- 0.253 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.4 all L1 = 0.884 +- 0.206 (in-sample avg dev_std = 0.225)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.661
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08671319999999999
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.618
SUFF_SIMPLE for r=0.8 class 0.0 = 0.92 +- 0.275 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.837 +- 0.275 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.8 all KL = 0.875 +- 0.275 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.8 all L1 = 0.879 +- 0.229 (in-sample avg dev_std = 0.182)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.372034
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.976
NEC for r=0.05 class 0.0 = 0.05 +- 0.139 (in-sample avg dev_std = 0.133)
NEC for r=0.05 class 1.0 = 0.006 +- 0.139 (in-sample avg dev_std = 0.133)
NEC for r=0.05 all KL = 0.032 +- 0.139 (in-sample avg dev_std = 0.133)
NEC for r=0.05 all L1 = 0.026 +- 0.097 (in-sample avg dev_std = 0.133)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.355744
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.977
NEC for r=0.1 class 0.0 = 0.048 +- 0.139 (in-sample avg dev_std = 0.156)
NEC for r=0.1 class 1.0 = 0.008 +- 0.139 (in-sample avg dev_std = 0.156)
NEC for r=0.1 all KL = 0.034 +- 0.139 (in-sample avg dev_std = 0.156)
NEC for r=0.1 all L1 = 0.026 +- 0.089 (in-sample avg dev_std = 0.156)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.258336
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.979
NEC for r=0.2 class 0.0 = 0.04 +- 0.112 (in-sample avg dev_std = 0.138)
NEC for r=0.2 class 1.0 = 0.011 +- 0.112 (in-sample avg dev_std = 0.138)
NEC for r=0.2 all KL = 0.027 +- 0.112 (in-sample avg dev_std = 0.138)
NEC for r=0.2 all L1 = 0.023 +- 0.083 (in-sample avg dev_std = 0.138)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.160152
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.981
NEC for r=0.4 class 0.0 = 0.038 +- 0.110 (in-sample avg dev_std = 0.128)
NEC for r=0.4 class 1.0 = 0.005 +- 0.110 (in-sample avg dev_std = 0.128)
NEC for r=0.4 all KL = 0.026 +- 0.110 (in-sample avg dev_std = 0.128)
NEC for r=0.4 all L1 = 0.02 +- 0.067 (in-sample avg dev_std = 0.128)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10936000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.981
NEC for r=0.8 class 0.0 = 0.038 +- 0.121 (in-sample avg dev_std = 0.150)
NEC for r=0.8 class 1.0 = 0.007 +- 0.121 (in-sample avg dev_std = 0.150)
NEC for r=0.8 all KL = 0.028 +- 0.121 (in-sample avg dev_std = 0.150)
NEC for r=0.8 all L1 = 0.021 +- 0.077 (in-sample avg dev_std = 0.150)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.959
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.14637360000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.93
NEC for r=0.05 class 0.0 = 0.032 +- 0.293 (in-sample avg dev_std = 0.293)
NEC for r=0.05 class 1.0 = 0.111 +- 0.293 (in-sample avg dev_std = 0.293)
NEC for r=0.05 all KL = 0.138 +- 0.293 (in-sample avg dev_std = 0.293)
NEC for r=0.05 all L1 = 0.072 +- 0.146 (in-sample avg dev_std = 0.293)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.959
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0810178
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.951
NEC for r=0.1 class 0.0 = 0.022 +- 0.201 (in-sample avg dev_std = 0.200)
NEC for r=0.1 class 1.0 = 0.062 +- 0.201 (in-sample avg dev_std = 0.200)
NEC for r=0.1 all KL = 0.068 +- 0.201 (in-sample avg dev_std = 0.200)
NEC for r=0.1 all L1 = 0.042 +- 0.107 (in-sample avg dev_std = 0.200)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.959
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.043623199999999994
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.957
NEC for r=0.2 class 0.0 = 0.018 +- 0.161 (in-sample avg dev_std = 0.159)
NEC for r=0.2 class 1.0 = 0.046 +- 0.161 (in-sample avg dev_std = 0.159)
NEC for r=0.2 all KL = 0.045 +- 0.161 (in-sample avg dev_std = 0.159)
NEC for r=0.2 all L1 = 0.032 +- 0.089 (in-sample avg dev_std = 0.159)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.959
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0235914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.959
NEC for r=0.4 class 0.0 = 0.018 +- 0.142 (in-sample avg dev_std = 0.133)
NEC for r=0.4 class 1.0 = 0.034 +- 0.142 (in-sample avg dev_std = 0.133)
NEC for r=0.4 all KL = 0.034 +- 0.142 (in-sample avg dev_std = 0.133)
NEC for r=0.4 all L1 = 0.026 +- 0.076 (in-sample avg dev_std = 0.133)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.959
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.014064600000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.961
NEC for r=0.8 class 0.0 = 0.015 +- 0.126 (in-sample avg dev_std = 0.120)
NEC for r=0.8 class 1.0 = 0.035 +- 0.126 (in-sample avg dev_std = 0.120)
NEC for r=0.8 all KL = 0.029 +- 0.126 (in-sample avg dev_std = 0.120)
NEC for r=0.8 all L1 = 0.025 +- 0.077 (in-sample avg dev_std = 0.120)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.66
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1865096
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.639
NEC for r=0.05 class 0.0 = 0.065 +- 0.240 (in-sample avg dev_std = 0.173)
NEC for r=0.05 class 1.0 = 0.124 +- 0.240 (in-sample avg dev_std = 0.173)
NEC for r=0.05 all KL = 0.089 +- 0.240 (in-sample avg dev_std = 0.173)
NEC for r=0.05 all L1 = 0.094 +- 0.208 (in-sample avg dev_std = 0.173)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.66
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.15397539999999998
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.651
NEC for r=0.1 class 0.0 = 0.081 +- 0.220 (in-sample avg dev_std = 0.157)
NEC for r=0.1 class 1.0 = 0.091 +- 0.220 (in-sample avg dev_std = 0.157)
NEC for r=0.1 all KL = 0.079 +- 0.220 (in-sample avg dev_std = 0.157)
NEC for r=0.1 all L1 = 0.086 +- 0.193 (in-sample avg dev_std = 0.157)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.66
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1173838
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.653
NEC for r=0.2 class 0.0 = 0.079 +- 0.195 (in-sample avg dev_std = 0.158)
NEC for r=0.2 class 1.0 = 0.079 +- 0.195 (in-sample avg dev_std = 0.158)
NEC for r=0.2 all KL = 0.069 +- 0.195 (in-sample avg dev_std = 0.158)
NEC for r=0.2 all L1 = 0.079 +- 0.182 (in-sample avg dev_std = 0.158)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.66
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0939026
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.653
NEC for r=0.4 class 0.0 = 0.077 +- 0.179 (in-sample avg dev_std = 0.163)
NEC for r=0.4 class 1.0 = 0.073 +- 0.179 (in-sample avg dev_std = 0.163)
NEC for r=0.4 all KL = 0.063 +- 0.179 (in-sample avg dev_std = 0.163)
NEC for r=0.4 all L1 = 0.075 +- 0.171 (in-sample avg dev_std = 0.163)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.66
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08671319999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.657
NEC for r=0.8 class 0.0 = 0.07 +- 0.169 (in-sample avg dev_std = 0.177)
NEC for r=0.8 class 1.0 = 0.081 +- 0.169 (in-sample avg dev_std = 0.177)
NEC for r=0.8 all KL = 0.063 +- 0.169 (in-sample avg dev_std = 0.177)
NEC for r=0.8 all L1 = 0.076 +- 0.161 (in-sample avg dev_std = 0.177)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 20:18:46 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 08:18:46 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 08:18:46 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 08:18:46 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 08:18:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:18:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:18:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:18:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:18:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:18:46 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 08:18:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9865
Train Loss: 0.0472
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0524
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0595
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0524
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0595

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9865
Train Loss: 0.0472
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0524
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0595
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0524
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0595

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.367
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.347
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.254
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.164
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.113
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.243
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.140
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.077
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.042
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.024
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.285
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.216
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.151
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.114
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.101


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.36747199999999997
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.933
SUFF_SIMPLE for r=0.05 class 0.0 = 0.841 +- 0.250 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.956 +- 0.250 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.05 all KL = 0.875 +- 0.250 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.05 all L1 = 0.905 +- 0.161 (in-sample avg dev_std = 0.320)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.34686
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.936
SUFF_SIMPLE for r=0.1 class 0.0 = 0.844 +- 0.243 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.963 +- 0.243 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.1 all KL = 0.889 +- 0.243 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.1 all L1 = 0.91 +- 0.165 (in-sample avg dev_std = 0.304)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25358600000000003
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.939
SUFF_SIMPLE for r=0.2 class 0.0 = 0.853 +- 0.234 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.954 +- 0.234 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.2 all KL = 0.884 +- 0.234 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.2 all L1 = 0.909 +- 0.155 (in-sample avg dev_std = 0.301)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.163798
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.941
SUFF_SIMPLE for r=0.4 class 0.0 = 0.849 +- 0.239 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.956 +- 0.239 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.4 all KL = 0.888 +- 0.239 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.4 all L1 = 0.908 +- 0.163 (in-sample avg dev_std = 0.296)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.113434
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.922
SUFF_SIMPLE for r=0.8 class 0.0 = 0.83 +- 0.253 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.929 +- 0.253 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.8 all KL = 0.872 +- 0.253 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.8 all L1 = 0.885 +- 0.190 (in-sample avg dev_std = 0.284)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.24262579999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.888
SUFF_SIMPLE for r=0.05 class 0.0 = 0.973 +- 0.163 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.921 +- 0.163 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 all KL = 0.953 +- 0.163 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 all L1 = 0.947 +- 0.085 (in-sample avg dev_std = 0.142)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13994340000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.889
SUFF_SIMPLE for r=0.1 class 0.0 = 0.972 +- 0.165 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.922 +- 0.165 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all KL = 0.952 +- 0.165 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all L1 = 0.947 +- 0.082 (in-sample avg dev_std = 0.138)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0773724
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.89
SUFF_SIMPLE for r=0.2 class 0.0 = 0.974 +- 0.151 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.92 +- 0.151 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.2 all KL = 0.957 +- 0.151 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.2 all L1 = 0.947 +- 0.086 (in-sample avg dev_std = 0.133)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0415842
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.886
SUFF_SIMPLE for r=0.4 class 0.0 = 0.971 +- 0.156 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.906 +- 0.156 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 all KL = 0.951 +- 0.156 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 all L1 = 0.938 +- 0.098 (in-sample avg dev_std = 0.138)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0236292
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.867
SUFF_SIMPLE for r=0.8 class 0.0 = 0.972 +- 0.143 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.848 +- 0.143 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.8 all KL = 0.941 +- 0.143 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.145 (in-sample avg dev_std = 0.155)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.685
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2845954
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.647
SUFF_SIMPLE for r=0.05 class 0.0 = 0.904 +- 0.240 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.856 +- 0.240 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.05 all KL = 0.889 +- 0.240 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.05 all L1 = 0.88 +- 0.211 (in-sample avg dev_std = 0.203)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.685
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.21607020000000002
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.648
SUFF_SIMPLE for r=0.1 class 0.0 = 0.906 +- 0.242 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.855 +- 0.242 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.1 all KL = 0.889 +- 0.242 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.1 all L1 = 0.881 +- 0.211 (in-sample avg dev_std = 0.197)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.685
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15108020000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.647
SUFF_SIMPLE for r=0.2 class 0.0 = 0.909 +- 0.243 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.853 +- 0.243 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.2 all KL = 0.89 +- 0.243 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.2 all L1 = 0.881 +- 0.214 (in-sample avg dev_std = 0.188)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.685
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11358539999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.64
SUFF_SIMPLE for r=0.4 class 0.0 = 0.909 +- 0.248 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.848 +- 0.248 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.4 all KL = 0.887 +- 0.248 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.4 all L1 = 0.879 +- 0.219 (in-sample avg dev_std = 0.187)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.686
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1012918
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.643
SUFF_SIMPLE for r=0.8 class 0.0 = 0.909 +- 0.236 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.849 +- 0.236 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.8 all KL = 0.894 +- 0.236 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.8 all L1 = 0.879 +- 0.217 (in-sample avg dev_std = 0.140)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.36747199999999997
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.937
NEC for r=0.05 class 0.0 = 0.121 +- 0.227 (in-sample avg dev_std = 0.247)
NEC for r=0.05 class 1.0 = 0.04 +- 0.227 (in-sample avg dev_std = 0.247)
NEC for r=0.05 all KL = 0.082 +- 0.227 (in-sample avg dev_std = 0.247)
NEC for r=0.05 all L1 = 0.076 +- 0.160 (in-sample avg dev_std = 0.247)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.34686
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.941
NEC for r=0.1 class 0.0 = 0.114 +- 0.214 (in-sample avg dev_std = 0.256)
NEC for r=0.1 class 1.0 = 0.031 +- 0.214 (in-sample avg dev_std = 0.256)
NEC for r=0.1 all KL = 0.081 +- 0.214 (in-sample avg dev_std = 0.256)
NEC for r=0.1 all L1 = 0.068 +- 0.143 (in-sample avg dev_std = 0.256)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25358600000000003
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.952
NEC for r=0.2 class 0.0 = 0.092 +- 0.187 (in-sample avg dev_std = 0.242)
NEC for r=0.2 class 1.0 = 0.023 +- 0.187 (in-sample avg dev_std = 0.242)
NEC for r=0.2 all KL = 0.064 +- 0.187 (in-sample avg dev_std = 0.242)
NEC for r=0.2 all L1 = 0.053 +- 0.119 (in-sample avg dev_std = 0.242)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.163798
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.963
NEC for r=0.4 class 0.0 = 0.069 +- 0.143 (in-sample avg dev_std = 0.196)
NEC for r=0.4 class 1.0 = 0.015 +- 0.143 (in-sample avg dev_std = 0.196)
NEC for r=0.4 all KL = 0.041 +- 0.143 (in-sample avg dev_std = 0.196)
NEC for r=0.4 all L1 = 0.039 +- 0.096 (in-sample avg dev_std = 0.196)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.113434
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.964
NEC for r=0.8 class 0.0 = 0.065 +- 0.150 (in-sample avg dev_std = 0.204)
NEC for r=0.8 class 1.0 = 0.014 +- 0.150 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all KL = 0.046 +- 0.150 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all L1 = 0.037 +- 0.091 (in-sample avg dev_std = 0.204)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.24262579999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.744
NEC for r=0.05 class 0.0 = 0.118 +- 0.347 (in-sample avg dev_std = 0.451)
NEC for r=0.05 class 1.0 = 0.349 +- 0.347 (in-sample avg dev_std = 0.451)
NEC for r=0.05 all KL = 0.314 +- 0.347 (in-sample avg dev_std = 0.451)
NEC for r=0.05 all L1 = 0.234 +- 0.225 (in-sample avg dev_std = 0.451)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13994340000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.825
NEC for r=0.1 class 0.0 = 0.075 +- 0.290 (in-sample avg dev_std = 0.338)
NEC for r=0.1 class 1.0 = 0.207 +- 0.290 (in-sample avg dev_std = 0.338)
NEC for r=0.1 all KL = 0.181 +- 0.290 (in-sample avg dev_std = 0.338)
NEC for r=0.1 all L1 = 0.142 +- 0.164 (in-sample avg dev_std = 0.338)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0773724
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.862
NEC for r=0.2 class 0.0 = 0.044 +- 0.232 (in-sample avg dev_std = 0.247)
NEC for r=0.2 class 1.0 = 0.13 +- 0.232 (in-sample avg dev_std = 0.247)
NEC for r=0.2 all KL = 0.102 +- 0.232 (in-sample avg dev_std = 0.247)
NEC for r=0.2 all L1 = 0.087 +- 0.117 (in-sample avg dev_std = 0.247)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0415842
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.881
NEC for r=0.4 class 0.0 = 0.025 +- 0.177 (in-sample avg dev_std = 0.181)
NEC for r=0.4 class 1.0 = 0.083 +- 0.177 (in-sample avg dev_std = 0.181)
NEC for r=0.4 all KL = 0.056 +- 0.177 (in-sample avg dev_std = 0.181)
NEC for r=0.4 all L1 = 0.054 +- 0.083 (in-sample avg dev_std = 0.181)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0236292
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.889
NEC for r=0.8 class 0.0 = 0.014 +- 0.120 (in-sample avg dev_std = 0.129)
NEC for r=0.8 class 1.0 = 0.063 +- 0.120 (in-sample avg dev_std = 0.129)
NEC for r=0.8 all KL = 0.029 +- 0.120 (in-sample avg dev_std = 0.129)
NEC for r=0.8 all L1 = 0.039 +- 0.063 (in-sample avg dev_std = 0.129)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.685
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2845954
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.624
NEC for r=0.05 class 0.0 = 0.074 +- 0.251 (in-sample avg dev_std = 0.175)
NEC for r=0.05 class 1.0 = 0.159 +- 0.251 (in-sample avg dev_std = 0.175)
NEC for r=0.05 all KL = 0.104 +- 0.251 (in-sample avg dev_std = 0.175)
NEC for r=0.05 all L1 = 0.116 +- 0.224 (in-sample avg dev_std = 0.175)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.685
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.21607020000000002
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.653
NEC for r=0.1 class 0.0 = 0.081 +- 0.199 (in-sample avg dev_std = 0.167)
NEC for r=0.1 class 1.0 = 0.101 +- 0.199 (in-sample avg dev_std = 0.167)
NEC for r=0.1 all KL = 0.074 +- 0.199 (in-sample avg dev_std = 0.167)
NEC for r=0.1 all L1 = 0.091 +- 0.182 (in-sample avg dev_std = 0.167)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.685
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15108020000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.665
NEC for r=0.2 class 0.0 = 0.078 +- 0.175 (in-sample avg dev_std = 0.165)
NEC for r=0.2 class 1.0 = 0.081 +- 0.175 (in-sample avg dev_std = 0.165)
NEC for r=0.2 all KL = 0.061 +- 0.175 (in-sample avg dev_std = 0.165)
NEC for r=0.2 all L1 = 0.079 +- 0.161 (in-sample avg dev_std = 0.165)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.685
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11358539999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.676
NEC for r=0.4 class 0.0 = 0.072 +- 0.159 (in-sample avg dev_std = 0.163)
NEC for r=0.4 class 1.0 = 0.072 +- 0.159 (in-sample avg dev_std = 0.163)
NEC for r=0.4 all KL = 0.054 +- 0.159 (in-sample avg dev_std = 0.163)
NEC for r=0.4 all L1 = 0.072 +- 0.148 (in-sample avg dev_std = 0.163)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.685
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1012918
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.668
NEC for r=0.8 class 0.0 = 0.065 +- 0.155 (in-sample avg dev_std = 0.171)
NEC for r=0.8 class 1.0 = 0.081 +- 0.155 (in-sample avg dev_std = 0.171)
NEC for r=0.8 all KL = 0.056 +- 0.155 (in-sample avg dev_std = 0.171)
NEC for r=0.8 all L1 = 0.073 +- 0.146 (in-sample avg dev_std = 0.171)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 20:34:37 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 08:34:37 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 08:34:37 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 08:34:37 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 08:34:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:34:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:34:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:34:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:34:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:34:37 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 08:34:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9830
Train Loss: 0.0549
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0538
ID Test ACCURACY: 0.9780
ID Test Loss: 0.0652
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0538
OOD Test ACCURACY: 0.9780
OOD Test Loss: 0.0652

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9830
Train Loss: 0.0549
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0538
ID Test ACCURACY: 0.9780
ID Test Loss: 0.0652
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0538
OOD Test ACCURACY: 0.9780
OOD Test Loss: 0.0652

[0m[1;37mINFO[0m: [1mChartInfo 0.9780 0.9780 0.9780 0.9780 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.395
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.364
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.259
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.159
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.109
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.294
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.169
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.092
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.049
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.026
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.304
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.229
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.157
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.116
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.102


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39454
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.948
SUFF_SIMPLE for r=0.05 class 0.0 = 0.902 +- 0.200 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.944 +- 0.200 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.05 all KL = 0.908 +- 0.200 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.05 all L1 = 0.925 +- 0.132 (in-sample avg dev_std = 0.274)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.364388
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.945
SUFF_SIMPLE for r=0.1 class 0.0 = 0.908 +- 0.202 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.943 +- 0.202 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.1 all KL = 0.917 +- 0.202 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.1 all L1 = 0.928 +- 0.144 (in-sample avg dev_std = 0.262)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25869400000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.949
SUFF_SIMPLE for r=0.2 class 0.0 = 0.909 +- 0.199 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.942 +- 0.199 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 all KL = 0.916 +- 0.199 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 all L1 = 0.927 +- 0.140 (in-sample avg dev_std = 0.264)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.159314
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.942
SUFF_SIMPLE for r=0.4 class 0.0 = 0.903 +- 0.212 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.934 +- 0.212 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.4 all KL = 0.908 +- 0.212 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.4 all L1 = 0.92 +- 0.148 (in-sample avg dev_std = 0.274)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10906999999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.928
SUFF_SIMPLE for r=0.8 class 0.0 = 0.89 +- 0.238 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.898 +- 0.238 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.8 all KL = 0.891 +- 0.238 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.8 all L1 = 0.894 +- 0.189 (in-sample avg dev_std = 0.260)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.615
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.294444
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.64
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.083 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.897 +- 0.083 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.05 all KL = 0.976 +- 0.083 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.05 all L1 = 0.947 +- 0.098 (in-sample avg dev_std = 0.082)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.615
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.16908679999999998
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.639
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.079 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.898 +- 0.079 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.1 all KL = 0.977 +- 0.079 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.1 all L1 = 0.947 +- 0.097 (in-sample avg dev_std = 0.080)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.615
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0923886
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.638
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.078 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.897 +- 0.078 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.2 all KL = 0.977 +- 0.078 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.2 all L1 = 0.947 +- 0.097 (in-sample avg dev_std = 0.081)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.615
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0488908
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.639
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.077 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.888 +- 0.077 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.4 all KL = 0.975 +- 0.077 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.4 all L1 = 0.943 +- 0.105 (in-sample avg dev_std = 0.083)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.615
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0262106
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.631
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.102 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.849 +- 0.102 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.8 all KL = 0.959 +- 0.102 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.8 all L1 = 0.924 +- 0.137 (in-sample avg dev_std = 0.111)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.659
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3040794
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.628
SUFF_SIMPLE for r=0.05 class 0.0 = 0.905 +- 0.238 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.846 +- 0.238 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.05 all KL = 0.887 +- 0.238 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.05 all L1 = 0.876 +- 0.211 (in-sample avg dev_std = 0.209)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.659
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.228566
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.626
SUFF_SIMPLE for r=0.1 class 0.0 = 0.906 +- 0.242 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.841 +- 0.242 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 all KL = 0.884 +- 0.242 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 all L1 = 0.874 +- 0.213 (in-sample avg dev_std = 0.208)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.659
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15688000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.626
SUFF_SIMPLE for r=0.2 class 0.0 = 0.907 +- 0.243 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.842 +- 0.243 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all KL = 0.887 +- 0.243 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all L1 = 0.875 +- 0.216 (in-sample avg dev_std = 0.195)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11550140000000002
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.619
SUFF_SIMPLE for r=0.4 class 0.0 = 0.909 +- 0.251 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.831 +- 0.251 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.4 all KL = 0.882 +- 0.251 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.4 all L1 = 0.87 +- 0.223 (in-sample avg dev_std = 0.193)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.66
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10218020000000001
len(reference) = 4990
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.63
SUFF_SIMPLE for r=0.8 class 0.0 = 0.913 +- 0.241 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.833 +- 0.241 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.8 all KL = 0.893 +- 0.241 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.8 all L1 = 0.873 +- 0.227 (in-sample avg dev_std = 0.117)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39454
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.95
NEC for r=0.05 class 0.0 = 0.084 +- 0.212 (in-sample avg dev_std = 0.207)
NEC for r=0.05 class 1.0 = 0.044 +- 0.212 (in-sample avg dev_std = 0.207)
NEC for r=0.05 all KL = 0.066 +- 0.212 (in-sample avg dev_std = 0.207)
NEC for r=0.05 all L1 = 0.062 +- 0.146 (in-sample avg dev_std = 0.207)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.364388
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.95
NEC for r=0.1 class 0.0 = 0.089 +- 0.214 (in-sample avg dev_std = 0.241)
NEC for r=0.1 class 1.0 = 0.031 +- 0.214 (in-sample avg dev_std = 0.241)
NEC for r=0.1 all KL = 0.069 +- 0.214 (in-sample avg dev_std = 0.241)
NEC for r=0.1 all L1 = 0.057 +- 0.135 (in-sample avg dev_std = 0.241)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25869400000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.962
NEC for r=0.2 class 0.0 = 0.063 +- 0.158 (in-sample avg dev_std = 0.197)
NEC for r=0.2 class 1.0 = 0.021 +- 0.158 (in-sample avg dev_std = 0.197)
NEC for r=0.2 all KL = 0.046 +- 0.158 (in-sample avg dev_std = 0.197)
NEC for r=0.2 all L1 = 0.039 +- 0.100 (in-sample avg dev_std = 0.197)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.159314
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.969
NEC for r=0.4 class 0.0 = 0.049 +- 0.142 (in-sample avg dev_std = 0.177)
NEC for r=0.4 class 1.0 = 0.017 +- 0.142 (in-sample avg dev_std = 0.177)
NEC for r=0.4 all KL = 0.038 +- 0.142 (in-sample avg dev_std = 0.177)
NEC for r=0.4 all L1 = 0.031 +- 0.085 (in-sample avg dev_std = 0.177)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10906999999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.971
NEC for r=0.8 class 0.0 = 0.033 +- 0.102 (in-sample avg dev_std = 0.156)
NEC for r=0.8 class 1.0 = 0.019 +- 0.102 (in-sample avg dev_std = 0.156)
NEC for r=0.8 all KL = 0.026 +- 0.102 (in-sample avg dev_std = 0.156)
NEC for r=0.8 all L1 = 0.025 +- 0.069 (in-sample avg dev_std = 0.156)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.615
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.294444
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.549
NEC for r=0.05 class 0.0 = 0.013 +- 0.218 (in-sample avg dev_std = 0.232)
NEC for r=0.05 class 1.0 = 0.217 +- 0.218 (in-sample avg dev_std = 0.232)
NEC for r=0.05 all KL = 0.109 +- 0.218 (in-sample avg dev_std = 0.232)
NEC for r=0.05 all L1 = 0.116 +- 0.197 (in-sample avg dev_std = 0.232)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.615
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.16908679999999998
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.588
NEC for r=0.1 class 0.0 = 0.007 +- 0.155 (in-sample avg dev_std = 0.199)
NEC for r=0.1 class 1.0 = 0.161 +- 0.155 (in-sample avg dev_std = 0.199)
NEC for r=0.1 all KL = 0.067 +- 0.155 (in-sample avg dev_std = 0.199)
NEC for r=0.1 all L1 = 0.085 +- 0.146 (in-sample avg dev_std = 0.199)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.615
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0923886
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.607
NEC for r=0.2 class 0.0 = 0.004 +- 0.113 (in-sample avg dev_std = 0.159)
NEC for r=0.2 class 1.0 = 0.119 +- 0.113 (in-sample avg dev_std = 0.159)
NEC for r=0.2 all KL = 0.04 +- 0.113 (in-sample avg dev_std = 0.159)
NEC for r=0.2 all L1 = 0.062 +- 0.111 (in-sample avg dev_std = 0.159)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.615
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0488908
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.614
NEC for r=0.4 class 0.0 = 0.002 +- 0.085 (in-sample avg dev_std = 0.129)
NEC for r=0.4 class 1.0 = 0.086 +- 0.085 (in-sample avg dev_std = 0.129)
NEC for r=0.4 all KL = 0.024 +- 0.085 (in-sample avg dev_std = 0.129)
NEC for r=0.4 all L1 = 0.045 +- 0.083 (in-sample avg dev_std = 0.129)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.615
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0262106
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.621
NEC for r=0.8 class 0.0 = 0.002 +- 0.064 (in-sample avg dev_std = 0.098)
NEC for r=0.8 class 1.0 = 0.069 +- 0.064 (in-sample avg dev_std = 0.098)
NEC for r=0.8 all KL = 0.015 +- 0.064 (in-sample avg dev_std = 0.098)
NEC for r=0.8 all L1 = 0.036 +- 0.068 (in-sample avg dev_std = 0.098)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.659
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3040794
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.591
NEC for r=0.05 class 0.0 = 0.073 +- 0.257 (in-sample avg dev_std = 0.124)
NEC for r=0.05 class 1.0 = 0.17 +- 0.257 (in-sample avg dev_std = 0.124)
NEC for r=0.05 all KL = 0.105 +- 0.257 (in-sample avg dev_std = 0.124)
NEC for r=0.05 all L1 = 0.121 +- 0.237 (in-sample avg dev_std = 0.124)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.659
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.228566
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.623
NEC for r=0.1 class 0.0 = 0.079 +- 0.219 (in-sample avg dev_std = 0.183)
NEC for r=0.1 class 1.0 = 0.12 +- 0.219 (in-sample avg dev_std = 0.183)
NEC for r=0.1 all KL = 0.084 +- 0.219 (in-sample avg dev_std = 0.183)
NEC for r=0.1 all L1 = 0.099 +- 0.195 (in-sample avg dev_std = 0.183)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.659
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15688000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.64
NEC for r=0.2 class 0.0 = 0.077 +- 0.181 (in-sample avg dev_std = 0.173)
NEC for r=0.2 class 1.0 = 0.088 +- 0.181 (in-sample avg dev_std = 0.173)
NEC for r=0.2 all KL = 0.064 +- 0.181 (in-sample avg dev_std = 0.173)
NEC for r=0.2 all L1 = 0.082 +- 0.166 (in-sample avg dev_std = 0.173)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11550140000000002
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.653
NEC for r=0.4 class 0.0 = 0.074 +- 0.162 (in-sample avg dev_std = 0.171)
NEC for r=0.4 class 1.0 = 0.081 +- 0.162 (in-sample avg dev_std = 0.171)
NEC for r=0.4 all KL = 0.058 +- 0.162 (in-sample avg dev_std = 0.171)
NEC for r=0.4 all L1 = 0.077 +- 0.154 (in-sample avg dev_std = 0.171)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.659
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10218020000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.644
NEC for r=0.8 class 0.0 = 0.065 +- 0.161 (in-sample avg dev_std = 0.182)
NEC for r=0.8 class 1.0 = 0.088 +- 0.161 (in-sample avg dev_std = 0.182)
NEC for r=0.8 all KL = 0.06 +- 0.161 (in-sample avg dev_std = 0.182)
NEC for r=0.8 all L1 = 0.077 +- 0.152 (in-sample avg dev_std = 0.182)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.907, 0.911, 0.905, 0.892, 0.873], 'all_L1': [0.929, 0.934, 0.931, 0.922, 0.905]}), defaultdict(<class 'list'>, {'all_KL': [0.936, 0.927, 0.923, 0.914, 0.885], 'all_L1': [0.949, 0.947, 0.946, 0.939, 0.911]}), defaultdict(<class 'list'>, {'all_KL': [0.86, 0.871, 0.865, 0.861, 0.851], 'all_L1': [0.903, 0.909, 0.903, 0.901, 0.883]}), defaultdict(<class 'list'>, {'all_KL': [0.892, 0.898, 0.886, 0.905, 0.887], 'all_L1': [0.917, 0.92, 0.916, 0.922, 0.898]}), defaultdict(<class 'list'>, {'all_KL': [0.917, 0.915, 0.916, 0.911, 0.868], 'all_L1': [0.92, 0.921, 0.921, 0.917, 0.873]}), defaultdict(<class 'list'>, {'all_KL': [0.897, 0.897, 0.906, 0.888, 0.865], 'all_L1': [0.93, 0.93, 0.935, 0.928, 0.9]}), defaultdict(<class 'list'>, {'all_KL': [0.933, 0.935, 0.917, 0.928, 0.895], 'all_L1': [0.942, 0.944, 0.936, 0.937, 0.908]}), defaultdict(<class 'list'>, {'all_KL': [0.881, 0.897, 0.893, 0.882, 0.847], 'all_L1': [0.928, 0.938, 0.934, 0.929, 0.896]}), defaultdict(<class 'list'>, {'all_KL': [0.875, 0.889, 0.884, 0.888, 0.872], 'all_L1': [0.905, 0.91, 0.909, 0.908, 0.885]}), defaultdict(<class 'list'>, {'all_KL': [0.908, 0.917, 0.916, 0.908, 0.891], 'all_L1': [0.925, 0.928, 0.927, 0.92, 0.894]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.032, 0.032, 0.028, 0.023, 0.024], 'all_L1': [0.034, 0.032, 0.028, 0.022, 0.023]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.045, 0.039, 0.021, 0.021], 'all_L1': [0.043, 0.034, 0.031, 0.02, 0.019]}), defaultdict(<class 'list'>, {'all_KL': [0.081, 0.075, 0.066, 0.047, 0.056], 'all_L1': [0.066, 0.06, 0.051, 0.037, 0.038]}), defaultdict(<class 'list'>, {'all_KL': [0.078, 0.067, 0.062, 0.049, 0.034], 'all_L1': [0.065, 0.054, 0.048, 0.039, 0.03]}), defaultdict(<class 'list'>, {'all_KL': [0.042, 0.037, 0.034, 0.026, 0.017], 'all_L1': [0.049, 0.046, 0.037, 0.03, 0.025]}), defaultdict(<class 'list'>, {'all_KL': [0.091, 0.07, 0.056, 0.042, 0.032], 'all_L1': [0.064, 0.046, 0.039, 0.03, 0.024]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.014, 0.012, 0.01, 0.013], 'all_L1': [0.024, 0.024, 0.021, 0.018, 0.018]}), defaultdict(<class 'list'>, {'all_KL': [0.032, 0.034, 0.027, 0.026, 0.028], 'all_L1': [0.026, 0.026, 0.023, 0.02, 0.021]}), defaultdict(<class 'list'>, {'all_KL': [0.082, 0.081, 0.064, 0.041, 0.046], 'all_L1': [0.076, 0.068, 0.053, 0.039, 0.037]}), defaultdict(<class 'list'>, {'all_KL': [0.066, 0.069, 0.046, 0.038, 0.026], 'all_L1': [0.062, 0.057, 0.039, 0.031, 0.025]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.834, 0.828, 0.822, 0.821, 0.777], 'all_L1': [0.912, 0.909, 0.905, 0.899, 0.86]}), defaultdict(<class 'list'>, {'all_KL': [0.947, 0.947, 0.947, 0.943, 0.909], 'all_L1': [0.933, 0.933, 0.932, 0.926, 0.9]}), defaultdict(<class 'list'>, {'all_KL': [0.921, 0.921, 0.921, 0.913, 0.907], 'all_L1': [0.934, 0.934, 0.931, 0.923, 0.892]}), defaultdict(<class 'list'>, {'all_KL': [0.953, 0.956, 0.957, 0.952, 0.901], 'all_L1': [0.925, 0.924, 0.923, 0.914, 0.865]}), defaultdict(<class 'list'>, {'all_KL': [0.958, 0.958, 0.957, 0.948, 0.877], 'all_L1': [0.934, 0.934, 0.933, 0.925, 0.87]}), defaultdict(<class 'list'>, {'all_KL': [0.816, 0.806, 0.807, 0.781, 0.673], 'all_L1': [0.902, 0.899, 0.896, 0.88, 0.806]}), defaultdict(<class 'list'>, {'all_KL': [0.929, 0.926, 0.919, 0.905, 0.823], 'all_L1': [0.898, 0.897, 0.892, 0.881, 0.816]}), defaultdict(<class 'list'>, {'all_KL': [0.892, 0.886, 0.886, 0.88, 0.829], 'all_L1': [0.941, 0.94, 0.937, 0.934, 0.906]}), defaultdict(<class 'list'>, {'all_KL': [0.953, 0.952, 0.957, 0.951, 0.941], 'all_L1': [0.947, 0.947, 0.947, 0.938, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.976, 0.977, 0.977, 0.975, 0.959], 'all_L1': [0.947, 0.947, 0.947, 0.943, 0.924]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.143, 0.064, 0.042, 0.044, 0.038], 'all_L1': [0.063, 0.033, 0.025, 0.023, 0.027]}), defaultdict(<class 'list'>, {'all_KL': [0.213, 0.12, 0.071, 0.042, 0.025], 'all_L1': [0.156, 0.101, 0.07, 0.05, 0.042]}), defaultdict(<class 'list'>, {'all_KL': [0.16, 0.103, 0.07, 0.044, 0.033], 'all_L1': [0.128, 0.079, 0.052, 0.036, 0.033]}), defaultdict(<class 'list'>, {'all_KL': [0.279, 0.207, 0.141, 0.075, 0.039], 'all_L1': [0.233, 0.173, 0.119, 0.077, 0.054]}), defaultdict(<class 'list'>, {'all_KL': [0.303, 0.22, 0.139, 0.077, 0.042], 'all_L1': [0.253, 0.181, 0.121, 0.077, 0.051]}), defaultdict(<class 'list'>, {'all_KL': [0.222, 0.15, 0.106, 0.075, 0.061], 'all_L1': [0.109, 0.067, 0.043, 0.03, 0.033]}), defaultdict(<class 'list'>, {'all_KL': [0.211, 0.111, 0.058, 0.036, 0.023], 'all_L1': [0.198, 0.129, 0.09, 0.069, 0.058]}), defaultdict(<class 'list'>, {'all_KL': [0.138, 0.068, 0.045, 0.034, 0.029], 'all_L1': [0.072, 0.042, 0.032, 0.026, 0.025]}), defaultdict(<class 'list'>, {'all_KL': [0.314, 0.181, 0.102, 0.056, 0.029], 'all_L1': [0.234, 0.142, 0.087, 0.054, 0.039]}), defaultdict(<class 'list'>, {'all_KL': [0.109, 0.067, 0.04, 0.024, 0.015], 'all_L1': [0.116, 0.085, 0.062, 0.045, 0.036]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.875, 0.877, 0.878, 0.878, 0.88], 'all_L1': [0.868, 0.87, 0.872, 0.872, 0.874]}), defaultdict(<class 'list'>, {'all_KL': [0.881, 0.88, 0.885, 0.884, 0.879], 'all_L1': [0.877, 0.878, 0.882, 0.883, 0.874]}), defaultdict(<class 'list'>, {'all_KL': [0.872, 0.872, 0.874, 0.872, 0.89], 'all_L1': [0.872, 0.871, 0.873, 0.872, 0.887]}), defaultdict(<class 'list'>, {'all_KL': [0.88, 0.878, 0.883, 0.88, 0.896], 'all_L1': [0.878, 0.877, 0.879, 0.876, 0.886]}), defaultdict(<class 'list'>, {'all_KL': [0.888, 0.888, 0.889, 0.89, 0.897], 'all_L1': [0.871, 0.87, 0.871, 0.872, 0.878]}), defaultdict(<class 'list'>, {'all_KL': [0.877, 0.88, 0.881, 0.877, 0.897], 'all_L1': [0.871, 0.873, 0.874, 0.874, 0.885]}), defaultdict(<class 'list'>, {'all_KL': [0.888, 0.886, 0.889, 0.884, 0.89], 'all_L1': [0.876, 0.876, 0.878, 0.875, 0.877]}), defaultdict(<class 'list'>, {'all_KL': [0.864, 0.867, 0.874, 0.876, 0.875], 'all_L1': [0.87, 0.873, 0.879, 0.884, 0.879]}), defaultdict(<class 'list'>, {'all_KL': [0.889, 0.889, 0.89, 0.887, 0.894], 'all_L1': [0.88, 0.881, 0.881, 0.879, 0.879]}), defaultdict(<class 'list'>, {'all_KL': [0.887, 0.884, 0.887, 0.882, 0.893], 'all_L1': [0.876, 0.874, 0.875, 0.87, 0.873]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.08, 0.065, 0.061, 0.059, 0.062], 'all_L1': [0.095, 0.081, 0.081, 0.08, 0.082]}), defaultdict(<class 'list'>, {'all_KL': [0.093, 0.074, 0.065, 0.061, 0.06], 'all_L1': [0.101, 0.085, 0.078, 0.075, 0.075]}), defaultdict(<class 'list'>, {'all_KL': [0.108, 0.08, 0.068, 0.068, 0.073], 'all_L1': [0.115, 0.091, 0.084, 0.082, 0.085]}), defaultdict(<class 'list'>, {'all_KL': [0.082, 0.091, 0.079, 0.068, 0.07], 'all_L1': [0.096, 0.099, 0.085, 0.079, 0.082]}), defaultdict(<class 'list'>, {'all_KL': [0.123, 0.109, 0.079, 0.066, 0.063], 'all_L1': [0.137, 0.117, 0.094, 0.088, 0.087]}), defaultdict(<class 'list'>, {'all_KL': [0.078, 0.067, 0.063, 0.061, 0.059], 'all_L1': [0.09, 0.082, 0.079, 0.076, 0.076]}), defaultdict(<class 'list'>, {'all_KL': [0.07, 0.056, 0.051, 0.051, 0.052], 'all_L1': [0.092, 0.078, 0.075, 0.075, 0.074]}), defaultdict(<class 'list'>, {'all_KL': [0.089, 0.079, 0.069, 0.063, 0.063], 'all_L1': [0.094, 0.086, 0.079, 0.075, 0.076]}), defaultdict(<class 'list'>, {'all_KL': [0.104, 0.074, 0.061, 0.054, 0.056], 'all_L1': [0.116, 0.091, 0.079, 0.072, 0.073]}), defaultdict(<class 'list'>, {'all_KL': [0.105, 0.084, 0.064, 0.058, 0.06], 'all_L1': [0.121, 0.099, 0.082, 0.077, 0.077]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.925 +- 0.014, 0.928 +- 0.012, 0.926 +- 0.013, 0.922 +- 0.011, 0.895 +- 0.011
suff_simple class all_KL  =  0.901 +- 0.023, 0.906 +- 0.018, 0.901 +- 0.018, 0.898 +- 0.018, 0.873 +- 0.015
[[0.9555000066757202, 0.9589999914169312, 0.9557499885559082, 0.9505000114440918, 0.9334999918937683], [0.9670000076293945, 0.9682499766349792, 0.968500018119812, 0.9624999761581421, 0.9417499899864197], [0.9347500205039978, 0.937749981880188, 0.9332500100135803, 0.9332500100135803, 0.9160000085830688], [0.9447500109672546, 0.9455000162124634, 0.9445000290870667, 0.9547500014305115, 0.934249997138977], [0.9394999742507935, 0.9390000104904175, 0.9382500052452087, 0.9390000104904175, 0.9027500152587891], [0.9524999856948853, 0.9492499828338623, 0.9559999704360962, 0.9520000219345093, 0.9200000166893005], [0.9632499814033508, 0.9677500128746033, 0.9577500224113464, 0.9637500047683716, 0.9437500238418579], [0.9467499852180481, 0.9574999809265137, 0.952750027179718, 0.9502500295639038, 0.9235000014305115], [0.9332500100135803, 0.9355000257492065, 0.9390000104904175, 0.940750002861023, 0.921750009059906], [0.9484999775886536, 0.9452499747276306, 0.9490000009536743, 0.9415000081062317, 0.9282500147819519]]
[[0.907, 0.911, 0.905, 0.892, 0.873], [0.936, 0.927, 0.923, 0.914, 0.885], [0.86, 0.871, 0.865, 0.861, 0.851], [0.892, 0.898, 0.886, 0.905, 0.887], [0.917, 0.915, 0.916, 0.911, 0.868], [0.897, 0.897, 0.906, 0.888, 0.865], [0.933, 0.935, 0.917, 0.928, 0.895], [0.881, 0.897, 0.893, 0.882, 0.847], [0.875, 0.889, 0.884, 0.888, 0.872], [0.908, 0.917, 0.916, 0.908, 0.891]]
suff_simple_acc_int  =  0.949 +- 0.011, 0.950 +- 0.011, 0.949 +- 0.010, 0.949 +- 0.010, 0.927 +- 0.012
nec class all_L1  =  0.051 +- 0.017, 0.045 +- 0.014, 0.037 +- 0.011, 0.029 +- 0.008, 0.026 +- 0.007
nec class all_KL  =  0.057 +- 0.026, 0.052 +- 0.022, 0.043 +- 0.017, 0.032 +- 0.012, 0.030 +- 0.012
[[0.981249988079071, 0.9822499752044678, 0.984749972820282, 0.9869999885559082, 0.9857500195503235], [0.9649999737739563, 0.9752500057220459, 0.9772499799728394, 0.9865000247955322, 0.9865000247955322], [0.9509999752044678, 0.9539999961853027, 0.9614999890327454, 0.9735000133514404, 0.9707499742507935], [0.9412500262260437, 0.9555000066757202, 0.9602500200271606, 0.9645000100135803, 0.9692500233650208], [0.9537500143051147, 0.9545000195503235, 0.9589999914169312, 0.9620000123977661, 0.9660000205039978], [0.9424999952316284, 0.9614999890327454, 0.9670000076293945, 0.9729999899864197, 0.9779999852180481], [0.9869999885559082, 0.987500011920929, 0.9854999780654907, 0.9854999780654907, 0.9857500195503235], [0.9760000109672546, 0.9769999980926514, 0.9785000085830688, 0.981249988079071, 0.9807500243186951], [0.937250018119812, 0.9412500262260437, 0.9517499804496765, 0.9629999995231628, 0.9637500047683716], [0.949999988079071, 0.9502500295639038, 0.9622499942779541, 0.968999981880188, 0.9714999794960022]]
[[0.032, 0.032, 0.028, 0.023, 0.024], [0.055, 0.045, 0.039, 0.021, 0.021], [0.081, 0.075, 0.066, 0.047, 0.056], [0.078, 0.067, 0.062, 0.049, 0.034], [0.042, 0.037, 0.034, 0.026, 0.017], [0.091, 0.07, 0.056, 0.042, 0.032], [0.008, 0.014, 0.012, 0.01, 0.013], [0.032, 0.034, 0.027, 0.026, 0.028], [0.082, 0.081, 0.064, 0.041, 0.046], [0.066, 0.069, 0.046, 0.038, 0.026]]
nec_acc_int  =  0.958 +- 0.017, 0.964 +- 0.015, 0.969 +- 0.011, 0.975 +- 0.009, 0.976 +- 0.008

Eval split val
suff_simple class all_L1  =  0.927 +- 0.017, 0.926 +- 0.018, 0.924 +- 0.019, 0.916 +- 0.021, 0.875 +- 0.038
suff_simple class all_KL  =  0.918 +- 0.051, 0.916 +- 0.055, 0.915 +- 0.056, 0.907 +- 0.060, 0.860 +- 0.082
[[0.8764500021934509, 0.8768749833106995, 0.8798499703407288, 0.8935250043869019, 0.9214000105857849], [0.9318249821662903, 0.9305499792098999, 0.9292749762535095, 0.9258750081062317, 0.896049976348877], [0.7727749943733215, 0.7741000056266785, 0.7730500102043152, 0.7675250172615051, 0.7426499724388123], [0.7546250224113464, 0.7567499876022339, 0.7583000063896179, 0.7611500024795532, 0.7562000155448914], [0.7962250113487244, 0.79544997215271, 0.793274998664856, 0.7901999950408936, 0.7436000108718872], [0.8866750001907349, 0.8870000243186951, 0.8909249901771545, 0.8962000012397766, 0.8946499824523926], [0.9155250191688538, 0.9150500297546387, 0.9140999913215637, 0.9094750285148621, 0.8653749823570251], [0.9480500221252441, 0.9452499747276306, 0.9462500214576721, 0.9438750147819519, 0.9188500046730042], [0.8884000182151794, 0.889074981212616, 0.889549970626831, 0.8861500024795532, 0.8665750026702881], [0.6397250294685364, 0.6387249827384949, 0.637624979019165, 0.6394000053405762, 0.6309750080108643]]
[[0.834, 0.828, 0.822, 0.821, 0.777], [0.947, 0.947, 0.947, 0.943, 0.909], [0.921, 0.921, 0.921, 0.913, 0.907], [0.953, 0.956, 0.957, 0.952, 0.901], [0.958, 0.958, 0.957, 0.948, 0.877], [0.816, 0.806, 0.807, 0.781, 0.673], [0.929, 0.926, 0.919, 0.905, 0.823], [0.892, 0.886, 0.886, 0.88, 0.829], [0.953, 0.952, 0.957, 0.951, 0.941], [0.976, 0.977, 0.977, 0.975, 0.959]]
suff_simple_acc_int  =  0.841 +- 0.092, 0.841 +- 0.092, 0.841 +- 0.093, 0.841 +- 0.092, 0.824 +- 0.093
nec class all_L1  =  0.156 +- 0.066, 0.103 +- 0.049, 0.070 +- 0.032, 0.049 +- 0.019, 0.040 +- 0.011
nec class all_KL  =  0.209 +- 0.068, 0.129 +- 0.055, 0.081 +- 0.036, 0.051 +- 0.018, 0.033 +- 0.012
[[0.8175250291824341, 0.8398749828338623, 0.8478999733924866, 0.8484500050544739, 0.8564749956130981], [0.8555999994277954, 0.8986250162124634, 0.9164999723434448, 0.9240249991416931, 0.9293249845504761], [0.7172250151634216, 0.7514749765396118, 0.7720249891281128, 0.7836999893188477, 0.7872499823570251], [0.5776749849319458, 0.6499750018119812, 0.692799985408783, 0.7195000052452087, 0.7327499985694885], [0.5823000073432922, 0.6764500141143799, 0.7344499826431274, 0.7677500247955322, 0.7817999720573425], [0.8118749856948853, 0.8427500128746033, 0.8596749901771545, 0.8702999949455261, 0.8795750141143799], [0.8220000267028809, 0.87295001745224, 0.8939999938011169, 0.9018999934196472, 0.9070249795913696], [0.9304249882698059, 0.9513750076293945, 0.956849992275238, 0.9592000246047974, 0.9607999920845032], [0.7444249987602234, 0.8249750137329102, 0.8622999787330627, 0.8807500004768372, 0.8890249729156494], [0.5494999885559082, 0.5882750153541565, 0.6065499782562256, 0.6144499778747559, 0.6205000281333923]]
[[0.143, 0.064, 0.042, 0.044, 0.038], [0.213, 0.12, 0.071, 0.042, 0.025], [0.16, 0.103, 0.07, 0.044, 0.033], [0.279, 0.207, 0.141, 0.075, 0.039], [0.303, 0.22, 0.139, 0.077, 0.042], [0.222, 0.15, 0.106, 0.075, 0.061], [0.211, 0.111, 0.058, 0.036, 0.023], [0.138, 0.068, 0.045, 0.034, 0.029], [0.314, 0.181, 0.102, 0.056, 0.029], [0.109, 0.067, 0.04, 0.024, 0.015]]
nec_acc_int  =  0.741 +- 0.125, 0.790 +- 0.112, 0.814 +- 0.104, 0.827 +- 0.100, 0.834 +- 0.098

Eval split test
suff_simple class all_L1  =  0.874 +- 0.004, 0.874 +- 0.003, 0.876 +- 0.004, 0.876 +- 0.005, 0.879 +- 0.005
suff_simple class all_KL  =  0.880 +- 0.008, 0.880 +- 0.007, 0.883 +- 0.006, 0.881 +- 0.005, 0.889 +- 0.008
[[0.6191214919090271, 0.6199719905853271, 0.619146466255188, 0.6207724809646606, 0.5984787344932556], [0.6589703559875488, 0.6564438939094543, 0.6564438939094543, 0.6547428369522095, 0.6425886750221252], [0.6478387117385864, 0.6482389569282532, 0.6424104571342468, 0.6413347721099854, 0.6375606656074524], [0.5952070951461792, 0.5935060977935791, 0.5945066809654236, 0.5899039506912231, 0.5988647937774658], [0.6259756088256836, 0.62567538022995, 0.6264758706092834, 0.6271762847900391, 0.642460823059082], [0.6793826222419739, 0.6807334423065186, 0.6799079179763794, 0.6704522967338562, 0.6682701706886292], [0.6214478611946106, 0.6216229796409607, 0.6208475232124329, 0.6205723285675049, 0.601548433303833], [0.6426105499267578, 0.639558732509613, 0.6347058415412903, 0.6424354314804077, 0.6177841424942017], [0.6473884582519531, 0.6479137539863586, 0.6472883820533752, 0.6402841806411743, 0.6430647373199463], [0.6277516484260559, 0.6262257099151611, 0.6257004141807556, 0.6194466948509216, 0.6302855610847473]]
[[0.875, 0.877, 0.878, 0.878, 0.88], [0.881, 0.88, 0.885, 0.884, 0.879], [0.872, 0.872, 0.874, 0.872, 0.89], [0.88, 0.878, 0.883, 0.88, 0.896], [0.888, 0.888, 0.889, 0.89, 0.897], [0.877, 0.88, 0.881, 0.877, 0.897], [0.888, 0.886, 0.889, 0.884, 0.89], [0.864, 0.867, 0.874, 0.876, 0.875], [0.889, 0.889, 0.89, 0.887, 0.894], [0.887, 0.884, 0.887, 0.882, 0.893]]
suff_simple_acc_int  =  0.637 +- 0.022, 0.636 +- 0.023, 0.635 +- 0.022, 0.633 +- 0.021, 0.628 +- 0.022
nec class all_L1  =  0.106 +- 0.015, 0.091 +- 0.011, 0.082 +- 0.005, 0.078 +- 0.004, 0.079 +- 0.005
nec class all_KL  =  0.093 +- 0.016, 0.078 +- 0.014, 0.066 +- 0.008, 0.061 +- 0.005, 0.062 +- 0.006
[[0.6267510652542114, 0.6461126804351807, 0.6457124352455139, 0.6443116068840027, 0.6436862349510193], [0.6477136015892029, 0.6662247180938721, 0.673504114151001, 0.6809836030006409, 0.6763308048248291], [0.6379077434539795, 0.6707524657249451, 0.6708275079727173, 0.6762557625770569, 0.6673004031181335], [0.5834250450134277, 0.5890033841133118, 0.6062387228012085, 0.6205973625183105, 0.6100660562515259], [0.5791224837303162, 0.6078397035598755, 0.6299029588699341, 0.6470632553100586, 0.6378827095031738], [0.6855112910270691, 0.697243332862854, 0.691189706325531, 0.7013458013534546, 0.6981188654899597], [0.6237742900848389, 0.644761860370636, 0.6421853303909302, 0.6458125114440918, 0.6419851779937744], [0.6391084790229797, 0.6513908505439758, 0.6526415944099426, 0.653467059135437, 0.6570191979408264], [0.6237492561340332, 0.6525415182113647, 0.6651991009712219, 0.676155686378479, 0.6678507328033447], [0.5912047028541565, 0.622548520565033, 0.639833927154541, 0.6531168818473816, 0.6439613699913025]]
[[0.08, 0.065, 0.061, 0.059, 0.062], [0.093, 0.074, 0.065, 0.061, 0.06], [0.108, 0.08, 0.068, 0.068, 0.073], [0.082, 0.091, 0.079, 0.068, 0.07], [0.123, 0.109, 0.079, 0.066, 0.063], [0.078, 0.067, 0.063, 0.061, 0.059], [0.07, 0.056, 0.051, 0.051, 0.052], [0.089, 0.079, 0.069, 0.063, 0.063], [0.104, 0.074, 0.061, 0.054, 0.056], [0.105, 0.084, 0.064, 0.058, 0.06]]
nec_acc_int  =  0.624 +- 0.031, 0.645 +- 0.030, 0.652 +- 0.023, 0.660 +- 0.022, 0.654 +- 0.023


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.488 +- 0.006, 0.486 +- 0.003, 0.481 +- 0.004, 0.475 +- 0.003, 0.461 +- 0.004
Faith. Armon (L1)= 		  =  0.096 +- 0.031, 0.085 +- 0.026, 0.071 +- 0.020, 0.055 +- 0.015, 0.050 +- 0.012
Faith. GMean (L1)= 	  =  0.213 +- 0.038, 0.201 +- 0.032, 0.183 +- 0.026, 0.161 +- 0.022, 0.151 +- 0.018
Faith. Aritm (KL)= 		  =  0.479 +- 0.012, 0.479 +- 0.008, 0.472 +- 0.007, 0.465 +- 0.007, 0.452 +- 0.007
Faith. Armon (KL)= 		  =  0.105 +- 0.046, 0.098 +- 0.039, 0.082 +- 0.032, 0.062 +- 0.023, 0.057 +- 0.023
Faith. GMean (KL)= 	  =  0.217 +- 0.059, 0.212 +- 0.048, 0.193 +- 0.042, 0.166 +- 0.034, 0.158 +- 0.032

Eval split val
Faith. Aritm (L1)= 		  =  0.542 +- 0.035, 0.515 +- 0.027, 0.497 +- 0.020, 0.482 +- 0.015, 0.457 +- 0.018
Faith. Armon (L1)= 		  =  0.262 +- 0.097, 0.182 +- 0.079, 0.129 +- 0.055, 0.092 +- 0.035, 0.076 +- 0.019
Faith. GMean (L1)= 	  =  0.372 +- 0.083, 0.300 +- 0.077, 0.248 +- 0.060, 0.207 +- 0.043, 0.185 +- 0.024
Faith. Aritm (KL)= 		  =  0.564 +- 0.048, 0.522 +- 0.045, 0.498 +- 0.037, 0.479 +- 0.030, 0.446 +- 0.037
Faith. Armon (KL)= 		  =  0.336 +- 0.092, 0.222 +- 0.084, 0.147 +- 0.061, 0.095 +- 0.032, 0.064 +- 0.022
Faith. GMean (KL)= 	  =  0.433 +- 0.077, 0.336 +- 0.078, 0.266 +- 0.063, 0.211 +- 0.038, 0.166 +- 0.024

Eval split test
Faith. Aritm (L1)= 		  =  0.490 +- 0.008, 0.483 +- 0.005, 0.479 +- 0.002, 0.477 +- 0.002, 0.479 +- 0.004
Faith. Armon (L1)= 		  =  0.188 +- 0.023, 0.164 +- 0.018, 0.149 +- 0.008, 0.143 +- 0.007, 0.144 +- 0.008
Faith. GMean (L1)= 	  =  0.303 +- 0.021, 0.281 +- 0.017, 0.267 +- 0.008, 0.261 +- 0.007, 0.263 +- 0.008
Faith. Aritm (KL)= 		  =  0.487 +- 0.010, 0.479 +- 0.008, 0.475 +- 0.005, 0.471 +- 0.003, 0.475 +- 0.005
Faith. Armon (KL)= 		  =  0.168 +- 0.026, 0.143 +- 0.024, 0.123 +- 0.014, 0.114 +- 0.009, 0.116 +- 0.010
Faith. GMean (KL)= 	  =  0.285 +- 0.024, 0.261 +- 0.023, 0.241 +- 0.015, 0.231 +- 0.010, 0.234 +- 0.011
Computed for split load_split = id



Completed in  2:36:10.242263  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 20:50:33 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 08:50:34 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 08:50:34 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 08:50:34 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 08:50:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:50:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:50:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:50:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:50:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:50:34 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 08:50:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0013
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0013
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0013
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0013
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.415
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.365
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.247
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.159
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.105
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.263
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.147
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.078
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.040
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.021
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.297
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.213
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.138
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.094
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.085


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.41488200000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.989
SUFF_SIMPLE for r=0.05 class 0.0 = 0.97 +- 0.129 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.992 +- 0.129 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 all KL = 0.967 +- 0.129 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 all L1 = 0.982 +- 0.073 (in-sample avg dev_std = 0.134)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.364978
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.989
SUFF_SIMPLE for r=0.1 class 0.0 = 0.973 +- 0.136 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.987 +- 0.136 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.1 all KL = 0.968 +- 0.136 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.1 all L1 = 0.981 +- 0.082 (in-sample avg dev_std = 0.142)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24656
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.992
SUFF_SIMPLE for r=0.2 class 0.0 = 0.978 +- 0.122 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.99 +- 0.122 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.2 all KL = 0.974 +- 0.122 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.2 all L1 = 0.985 +- 0.070 (in-sample avg dev_std = 0.130)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.15886799999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.993
SUFF_SIMPLE for r=0.4 class 0.0 = 0.979 +- 0.114 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.992 +- 0.114 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.4 all KL = 0.974 +- 0.114 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.4 all L1 = 0.986 +- 0.062 (in-sample avg dev_std = 0.121)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10517
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.986
SUFF_SIMPLE for r=0.8 class 0.0 = 0.967 +- 0.143 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.991 +- 0.143 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.8 all KL = 0.967 +- 0.143 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.8 all L1 = 0.98 +- 0.087 (in-sample avg dev_std = 0.144)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.839
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.26289359999999995
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.84
SUFF_SIMPLE for r=0.05 class 0.0 = 0.977 +- 0.109 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.97 +- 0.109 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.05 all KL = 0.974 +- 0.109 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.05 all L1 = 0.973 +- 0.073 (in-sample avg dev_std = 0.110)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.839
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1465422
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.839
SUFF_SIMPLE for r=0.1 class 0.0 = 0.978 +- 0.106 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.97 +- 0.106 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.1 all KL = 0.975 +- 0.106 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.1 all L1 = 0.974 +- 0.073 (in-sample avg dev_std = 0.105)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.839
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.078009
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.839
SUFF_SIMPLE for r=0.2 class 0.0 = 0.978 +- 0.107 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.97 +- 0.107 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.2 all KL = 0.975 +- 0.107 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.2 all L1 = 0.974 +- 0.073 (in-sample avg dev_std = 0.106)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.839
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04044640000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.839
SUFF_SIMPLE for r=0.4 class 0.0 = 0.975 +- 0.115 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.97 +- 0.115 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.4 all KL = 0.971 +- 0.115 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.4 all L1 = 0.972 +- 0.075 (in-sample avg dev_std = 0.116)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.839
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0210632
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.838
SUFF_SIMPLE for r=0.8 class 0.0 = 0.977 +- 0.116 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.969 +- 0.116 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.8 all KL = 0.972 +- 0.116 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.8 all L1 = 0.973 +- 0.078 (in-sample avg dev_std = 0.110)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.831
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.296562
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.81
SUFF_SIMPLE for r=0.05 class 0.0 = 0.926 +- 0.251 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.874 +- 0.251 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.05 all KL = 0.902 +- 0.251 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.05 all L1 = 0.9 +- 0.205 (in-sample avg dev_std = 0.175)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.831
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.212779
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.812
SUFF_SIMPLE for r=0.1 class 0.0 = 0.929 +- 0.249 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.876 +- 0.249 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.1 all KL = 0.906 +- 0.249 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.1 all L1 = 0.903 +- 0.204 (in-sample avg dev_std = 0.171)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.831
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1383178
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.809
SUFF_SIMPLE for r=0.2 class 0.0 = 0.932 +- 0.248 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.873 +- 0.248 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all KL = 0.909 +- 0.248 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all L1 = 0.903 +- 0.206 (in-sample avg dev_std = 0.147)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0936346
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.821
SUFF_SIMPLE for r=0.4 class 0.0 = 0.941 +- 0.210 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.894 +- 0.210 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.4 all KL = 0.929 +- 0.210 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.4 all L1 = 0.918 +- 0.179 (in-sample avg dev_std = 0.131)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.833
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08455240000000001
len(reference) = 4986
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.837
SUFF_SIMPLE for r=0.8 class 0.0 = 0.951 +- 0.171 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.898 +- 0.171 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 all KL = 0.947 +- 0.171 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 all L1 = 0.925 +- 0.166 (in-sample avg dev_std = 0.094)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.41488200000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.997
NEC for r=0.05 class 0.0 = 0.01 +- 0.052 (in-sample avg dev_std = 0.035)
NEC for r=0.05 class 1.0 = 0.003 +- 0.052 (in-sample avg dev_std = 0.035)
NEC for r=0.05 all KL = 0.007 +- 0.052 (in-sample avg dev_std = 0.035)
NEC for r=0.05 all L1 = 0.006 +- 0.041 (in-sample avg dev_std = 0.035)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.364978
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.996
NEC for r=0.1 class 0.0 = 0.009 +- 0.048 (in-sample avg dev_std = 0.036)
NEC for r=0.1 class 1.0 = 0.002 +- 0.048 (in-sample avg dev_std = 0.036)
NEC for r=0.1 all KL = 0.006 +- 0.048 (in-sample avg dev_std = 0.036)
NEC for r=0.1 all L1 = 0.005 +- 0.038 (in-sample avg dev_std = 0.036)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24656
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.995
NEC for r=0.2 class 0.0 = 0.01 +- 0.058 (in-sample avg dev_std = 0.054)
NEC for r=0.2 class 1.0 = 0.002 +- 0.058 (in-sample avg dev_std = 0.054)
NEC for r=0.2 all KL = 0.007 +- 0.058 (in-sample avg dev_std = 0.054)
NEC for r=0.2 all L1 = 0.006 +- 0.044 (in-sample avg dev_std = 0.054)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.15886799999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.996
NEC for r=0.4 class 0.0 = 0.009 +- 0.057 (in-sample avg dev_std = 0.055)
NEC for r=0.4 class 1.0 = 0.003 +- 0.057 (in-sample avg dev_std = 0.055)
NEC for r=0.4 all KL = 0.007 +- 0.057 (in-sample avg dev_std = 0.055)
NEC for r=0.4 all L1 = 0.006 +- 0.041 (in-sample avg dev_std = 0.055)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10517
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.996
NEC for r=0.8 class 0.0 = 0.008 +- 0.069 (in-sample avg dev_std = 0.073)
NEC for r=0.8 class 1.0 = 0.005 +- 0.069 (in-sample avg dev_std = 0.073)
NEC for r=0.8 all KL = 0.009 +- 0.069 (in-sample avg dev_std = 0.073)
NEC for r=0.8 all L1 = 0.006 +- 0.046 (in-sample avg dev_std = 0.073)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.839
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.26289359999999995
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.806
NEC for r=0.05 class 0.0 = 0.013 +- 0.241 (in-sample avg dev_std = 0.298)
NEC for r=0.05 class 1.0 = 0.12 +- 0.241 (in-sample avg dev_std = 0.298)
NEC for r=0.05 all KL = 0.118 +- 0.241 (in-sample avg dev_std = 0.298)
NEC for r=0.05 all L1 = 0.067 +- 0.124 (in-sample avg dev_std = 0.298)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.839
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1465422
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.825
NEC for r=0.1 class 0.0 = 0.009 +- 0.159 (in-sample avg dev_std = 0.201)
NEC for r=0.1 class 1.0 = 0.063 +- 0.159 (in-sample avg dev_std = 0.201)
NEC for r=0.1 all KL = 0.056 +- 0.159 (in-sample avg dev_std = 0.201)
NEC for r=0.1 all L1 = 0.036 +- 0.087 (in-sample avg dev_std = 0.201)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.839
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.078009
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.833
NEC for r=0.2 class 0.0 = 0.006 +- 0.108 (in-sample avg dev_std = 0.138)
NEC for r=0.2 class 1.0 = 0.037 +- 0.108 (in-sample avg dev_std = 0.138)
NEC for r=0.2 all KL = 0.027 +- 0.108 (in-sample avg dev_std = 0.138)
NEC for r=0.2 all L1 = 0.022 +- 0.062 (in-sample avg dev_std = 0.138)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.839
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04044640000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.838
NEC for r=0.4 class 0.0 = 0.004 +- 0.069 (in-sample avg dev_std = 0.095)
NEC for r=0.4 class 1.0 = 0.026 +- 0.069 (in-sample avg dev_std = 0.095)
NEC for r=0.4 all KL = 0.013 +- 0.069 (in-sample avg dev_std = 0.095)
NEC for r=0.4 all L1 = 0.015 +- 0.045 (in-sample avg dev_std = 0.095)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.839
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0210632
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.84
NEC for r=0.8 class 0.0 = 0.004 +- 0.048 (in-sample avg dev_std = 0.068)
NEC for r=0.8 class 1.0 = 0.021 +- 0.048 (in-sample avg dev_std = 0.068)
NEC for r=0.8 all KL = 0.008 +- 0.048 (in-sample avg dev_std = 0.068)
NEC for r=0.8 all L1 = 0.012 +- 0.040 (in-sample avg dev_std = 0.068)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.831
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.296562
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.682
NEC for r=0.05 class 0.0 = 0.041 +- 0.338 (in-sample avg dev_std = 0.305)
NEC for r=0.05 class 1.0 = 0.415 +- 0.338 (in-sample avg dev_std = 0.305)
NEC for r=0.05 all KL = 0.235 +- 0.338 (in-sample avg dev_std = 0.305)
NEC for r=0.05 all L1 = 0.226 +- 0.302 (in-sample avg dev_std = 0.305)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.831
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.212779
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.753
NEC for r=0.1 class 0.0 = 0.053 +- 0.281 (in-sample avg dev_std = 0.341)
NEC for r=0.1 class 1.0 = 0.291 +- 0.281 (in-sample avg dev_std = 0.341)
NEC for r=0.1 all KL = 0.187 +- 0.281 (in-sample avg dev_std = 0.341)
NEC for r=0.1 all L1 = 0.17 +- 0.235 (in-sample avg dev_std = 0.341)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.831
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1383178
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.789
NEC for r=0.2 class 0.0 = 0.055 +- 0.224 (in-sample avg dev_std = 0.288)
NEC for r=0.2 class 1.0 = 0.181 +- 0.224 (in-sample avg dev_std = 0.288)
NEC for r=0.2 all KL = 0.123 +- 0.224 (in-sample avg dev_std = 0.288)
NEC for r=0.2 all L1 = 0.117 +- 0.189 (in-sample avg dev_std = 0.288)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0936346
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.804
NEC for r=0.4 class 0.0 = 0.059 +- 0.206 (in-sample avg dev_std = 0.239)
NEC for r=0.4 class 1.0 = 0.124 +- 0.206 (in-sample avg dev_std = 0.239)
NEC for r=0.4 all KL = 0.093 +- 0.206 (in-sample avg dev_std = 0.239)
NEC for r=0.4 all L1 = 0.091 +- 0.172 (in-sample avg dev_std = 0.239)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.831
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08455240000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.814
NEC for r=0.8 class 0.0 = 0.053 +- 0.192 (in-sample avg dev_std = 0.225)
NEC for r=0.8 class 1.0 = 0.098 +- 0.192 (in-sample avg dev_std = 0.225)
NEC for r=0.8 all KL = 0.077 +- 0.192 (in-sample avg dev_std = 0.225)
NEC for r=0.8 all L1 = 0.075 +- 0.154 (in-sample avg dev_std = 0.225)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 21:05:55 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 09:05:55 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 09:05:55 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 09:05:55 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 09:05:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:05:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:05:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:05:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:05:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:05:55 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 09:05:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 54 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 54...
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.458
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.365
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.241
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.141
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.088
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.226
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.123
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.035
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.020
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.260
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.193
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.134
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.094
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45770400000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.991
SUFF_SIMPLE for r=0.05 class 0.0 = 0.966 +- 0.183 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.183 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.05 all KL = 0.956 +- 0.183 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.05 all L1 = 0.985 +- 0.069 (in-sample avg dev_std = 0.174)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.365004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.989
SUFF_SIMPLE for r=0.1 class 0.0 = 0.963 +- 0.189 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.189 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.1 all KL = 0.956 +- 0.189 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.1 all L1 = 0.983 +- 0.077 (in-sample avg dev_std = 0.184)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24081
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.99
SUFF_SIMPLE for r=0.2 class 0.0 = 0.967 +- 0.176 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.176 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.2 all KL = 0.96 +- 0.176 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.2 all L1 = 0.985 +- 0.071 (in-sample avg dev_std = 0.169)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14131799999999997
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.993
SUFF_SIMPLE for r=0.4 class 0.0 = 0.978 +- 0.145 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.145 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 all KL = 0.974 +- 0.145 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 all L1 = 0.99 +- 0.061 (in-sample avg dev_std = 0.138)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.087738
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.991
SUFF_SIMPLE for r=0.8 class 0.0 = 0.969 +- 0.168 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.168 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.8 all KL = 0.966 +- 0.168 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.8 all L1 = 0.986 +- 0.075 (in-sample avg dev_std = 0.161)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22572780000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.992
SUFF_SIMPLE for r=0.05 class 0.0 = 0.973 +- 0.192 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.996 +- 0.192 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.05 all KL = 0.953 +- 0.192 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.05 all L1 = 0.985 +- 0.068 (in-sample avg dev_std = 0.167)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1234076
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.992
SUFF_SIMPLE for r=0.1 class 0.0 = 0.972 +- 0.197 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.996 +- 0.197 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.1 all KL = 0.951 +- 0.197 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.1 all L1 = 0.984 +- 0.070 (in-sample avg dev_std = 0.171)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06595659999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.991
SUFF_SIMPLE for r=0.2 class 0.0 = 0.969 +- 0.204 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.996 +- 0.204 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.2 all KL = 0.947 +- 0.204 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.2 all L1 = 0.983 +- 0.072 (in-sample avg dev_std = 0.178)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0353154
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.99
SUFF_SIMPLE for r=0.4 class 0.0 = 0.968 +- 0.206 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.996 +- 0.206 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 all KL = 0.946 +- 0.206 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 all L1 = 0.982 +- 0.074 (in-sample avg dev_std = 0.183)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.019738599999999995
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.99
SUFF_SIMPLE for r=0.8 class 0.0 = 0.968 +- 0.202 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.996 +- 0.202 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.8 all KL = 0.949 +- 0.202 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.8 all L1 = 0.982 +- 0.076 (in-sample avg dev_std = 0.181)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.896
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2604718
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.879
SUFF_SIMPLE for r=0.05 class 0.0 = 0.953 +- 0.201 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.967 +- 0.201 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.05 all KL = 0.946 +- 0.201 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.05 all L1 = 0.96 +- 0.142 (in-sample avg dev_std = 0.184)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.896
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1929138
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.88
SUFF_SIMPLE for r=0.1 class 0.0 = 0.954 +- 0.201 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.967 +- 0.201 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.1 all KL = 0.946 +- 0.201 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.1 all L1 = 0.96 +- 0.141 (in-sample avg dev_std = 0.186)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.896
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1335818
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.878
SUFF_SIMPLE for r=0.2 class 0.0 = 0.954 +- 0.203 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.965 +- 0.203 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.2 all KL = 0.946 +- 0.203 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.2 all L1 = 0.959 +- 0.145 (in-sample avg dev_std = 0.178)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.896
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09350420000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.879
SUFF_SIMPLE for r=0.4 class 0.0 = 0.953 +- 0.207 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.963 +- 0.207 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 all KL = 0.943 +- 0.207 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 all L1 = 0.958 +- 0.145 (in-sample avg dev_std = 0.191)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0805062
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.908
SUFF_SIMPLE for r=0.8 class 0.0 = 0.986 +- 0.184 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.946 +- 0.184 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.8 all KL = 0.948 +- 0.184 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.8 all L1 = 0.966 +- 0.115 (in-sample avg dev_std = 0.210)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45770400000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.365004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24081
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 0.0 = 0.001 +- 0.034 (in-sample avg dev_std = 0.032)
NEC for r=0.2 class 1.0 = 0.0 +- 0.034 (in-sample avg dev_std = 0.032)
NEC for r=0.2 all KL = 0.002 +- 0.034 (in-sample avg dev_std = 0.032)
NEC for r=0.2 all L1 = 0.0 +- 0.010 (in-sample avg dev_std = 0.032)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14131799999999997
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.999
NEC for r=0.4 class 0.0 = 0.003 +- 0.055 (in-sample avg dev_std = 0.041)
NEC for r=0.4 class 1.0 = 0.0 +- 0.055 (in-sample avg dev_std = 0.041)
NEC for r=0.4 all KL = 0.004 +- 0.055 (in-sample avg dev_std = 0.041)
NEC for r=0.4 all L1 = 0.001 +- 0.015 (in-sample avg dev_std = 0.041)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.087738
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.002 +- 0.051 (in-sample avg dev_std = 0.046)
NEC for r=0.8 class 1.0 = 0.0 +- 0.051 (in-sample avg dev_std = 0.046)
NEC for r=0.8 all KL = 0.004 +- 0.051 (in-sample avg dev_std = 0.046)
NEC for r=0.8 all L1 = 0.001 +- 0.014 (in-sample avg dev_std = 0.046)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22572780000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.985
NEC for r=0.05 class 0.0 = 0.0 +- 0.195 (in-sample avg dev_std = 0.224)
NEC for r=0.05 class 1.0 = 0.052 +- 0.195 (in-sample avg dev_std = 0.224)
NEC for r=0.05 all KL = 0.062 +- 0.195 (in-sample avg dev_std = 0.224)
NEC for r=0.05 all L1 = 0.026 +- 0.085 (in-sample avg dev_std = 0.224)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1234076
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.997
NEC for r=0.1 class 0.0 = 0.0 +- 0.089 (in-sample avg dev_std = 0.096)
NEC for r=0.1 class 1.0 = 0.012 +- 0.089 (in-sample avg dev_std = 0.096)
NEC for r=0.1 all KL = 0.012 +- 0.089 (in-sample avg dev_std = 0.096)
NEC for r=0.1 all L1 = 0.006 +- 0.046 (in-sample avg dev_std = 0.096)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06595659999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.999
NEC for r=0.2 class 0.0 = 0.001 +- 0.064 (in-sample avg dev_std = 0.058)
NEC for r=0.2 class 1.0 = 0.006 +- 0.064 (in-sample avg dev_std = 0.058)
NEC for r=0.2 all KL = 0.006 +- 0.064 (in-sample avg dev_std = 0.058)
NEC for r=0.2 all L1 = 0.004 +- 0.038 (in-sample avg dev_std = 0.058)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0353154
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.999
NEC for r=0.4 class 0.0 = 0.002 +- 0.066 (in-sample avg dev_std = 0.050)
NEC for r=0.4 class 1.0 = 0.005 +- 0.066 (in-sample avg dev_std = 0.050)
NEC for r=0.4 all KL = 0.006 +- 0.066 (in-sample avg dev_std = 0.050)
NEC for r=0.4 all L1 = 0.003 +- 0.037 (in-sample avg dev_std = 0.050)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.019738599999999995
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.003 +- 0.078 (in-sample avg dev_std = 0.061)
NEC for r=0.8 class 1.0 = 0.004 +- 0.078 (in-sample avg dev_std = 0.061)
NEC for r=0.8 all KL = 0.008 +- 0.078 (in-sample avg dev_std = 0.061)
NEC for r=0.8 all L1 = 0.004 +- 0.037 (in-sample avg dev_std = 0.061)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.896
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2604718
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.836
NEC for r=0.05 class 0.0 = 0.026 +- 0.332 (in-sample avg dev_std = 0.346)
NEC for r=0.05 class 1.0 = 0.191 +- 0.332 (in-sample avg dev_std = 0.346)
NEC for r=0.05 all KL = 0.175 +- 0.332 (in-sample avg dev_std = 0.346)
NEC for r=0.05 all L1 = 0.107 +- 0.213 (in-sample avg dev_std = 0.346)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.896
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1929138
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.873
NEC for r=0.1 class 0.0 = 0.033 +- 0.236 (in-sample avg dev_std = 0.231)
NEC for r=0.1 class 1.0 = 0.085 +- 0.236 (in-sample avg dev_std = 0.231)
NEC for r=0.1 all KL = 0.091 +- 0.236 (in-sample avg dev_std = 0.231)
NEC for r=0.1 all L1 = 0.059 +- 0.161 (in-sample avg dev_std = 0.231)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.896
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1335818
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.882
NEC for r=0.2 class 0.0 = 0.033 +- 0.176 (in-sample avg dev_std = 0.166)
NEC for r=0.2 class 1.0 = 0.04 +- 0.176 (in-sample avg dev_std = 0.166)
NEC for r=0.2 all KL = 0.048 +- 0.176 (in-sample avg dev_std = 0.166)
NEC for r=0.2 all L1 = 0.036 +- 0.130 (in-sample avg dev_std = 0.166)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.896
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09350420000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.885
NEC for r=0.4 class 0.0 = 0.03 +- 0.152 (in-sample avg dev_std = 0.147)
NEC for r=0.4 class 1.0 = 0.024 +- 0.152 (in-sample avg dev_std = 0.147)
NEC for r=0.4 all KL = 0.034 +- 0.152 (in-sample avg dev_std = 0.147)
NEC for r=0.4 all L1 = 0.027 +- 0.109 (in-sample avg dev_std = 0.147)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.896
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0805062
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.886
NEC for r=0.8 class 0.0 = 0.029 +- 0.146 (in-sample avg dev_std = 0.138)
NEC for r=0.8 class 1.0 = 0.017 +- 0.146 (in-sample avg dev_std = 0.138)
NEC for r=0.8 all KL = 0.03 +- 0.146 (in-sample avg dev_std = 0.138)
NEC for r=0.8 all L1 = 0.023 +- 0.101 (in-sample avg dev_std = 0.138)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 21:21:24 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 09:21:24 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 09:21:24 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 09:21:24 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 09:21:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:21:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:21:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:21:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:21:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:21:24 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 09:21:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.478
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.410
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.291
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.179
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.103
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.226
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.122
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.064
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.033
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.018
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.255
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.201
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.153
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.118
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.092


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.47767000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.995
SUFF_SIMPLE for r=0.05 class 0.0 = 0.98 +- 0.142 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.142 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.05 all KL = 0.972 +- 0.142 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.05 all L1 = 0.991 +- 0.046 (in-sample avg dev_std = 0.135)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.409704
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.995
SUFF_SIMPLE for r=0.1 class 0.0 = 0.981 +- 0.133 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.133 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.1 all KL = 0.976 +- 0.133 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.1 all L1 = 0.992 +- 0.052 (in-sample avg dev_std = 0.129)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.29106600000000005
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.995
SUFF_SIMPLE for r=0.2 class 0.0 = 0.983 +- 0.130 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.130 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.2 all KL = 0.976 +- 0.130 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.2 all L1 = 0.992 +- 0.044 (in-sample avg dev_std = 0.123)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.178766
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.994
SUFF_SIMPLE for r=0.4 class 0.0 = 0.98 +- 0.141 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.141 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.4 all KL = 0.975 +- 0.141 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.4 all L1 = 0.991 +- 0.058 (in-sample avg dev_std = 0.133)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.102912
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.993
SUFF_SIMPLE for r=0.8 class 0.0 = 0.977 +- 0.149 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.149 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.8 all KL = 0.972 +- 0.149 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.8 all L1 = 0.99 +- 0.059 (in-sample avg dev_std = 0.140)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.995
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22569260000000005
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.991
SUFF_SIMPLE for r=0.05 class 0.0 = 0.971 +- 0.198 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.99 +- 0.198 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.05 all KL = 0.948 +- 0.198 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.05 all L1 = 0.98 +- 0.084 (in-sample avg dev_std = 0.174)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.995
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1222672
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.992
SUFF_SIMPLE for r=0.1 class 0.0 = 0.972 +- 0.193 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.99 +- 0.193 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.1 all KL = 0.95 +- 0.193 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.1 all L1 = 0.981 +- 0.083 (in-sample avg dev_std = 0.169)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.995
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0640396
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.99
SUFF_SIMPLE for r=0.2 class 0.0 = 0.967 +- 0.209 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.99 +- 0.209 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.2 all KL = 0.942 +- 0.209 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.2 all L1 = 0.978 +- 0.087 (in-sample avg dev_std = 0.185)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.995
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.033169599999999994
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.989
SUFF_SIMPLE for r=0.4 class 0.0 = 0.964 +- 0.214 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.99 +- 0.214 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 all KL = 0.939 +- 0.214 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 all L1 = 0.977 +- 0.091 (in-sample avg dev_std = 0.191)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.995
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0176382
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.983
SUFF_SIMPLE for r=0.8 class 0.0 = 0.946 +- 0.247 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.99 +- 0.247 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.8 all KL = 0.92 +- 0.247 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.8 all L1 = 0.968 +- 0.110 (in-sample avg dev_std = 0.231)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2546228
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.953
SUFF_SIMPLE for r=0.05 class 0.0 = 0.95 +- 0.181 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.992 +- 0.181 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.05 all KL = 0.96 +- 0.181 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.05 all L1 = 0.97 +- 0.133 (in-sample avg dev_std = 0.146)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.20126739999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.953
SUFF_SIMPLE for r=0.1 class 0.0 = 0.949 +- 0.184 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.991 +- 0.184 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.1 all KL = 0.959 +- 0.184 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.1 all L1 = 0.97 +- 0.132 (in-sample avg dev_std = 0.149)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15335919999999997
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.955
SUFF_SIMPLE for r=0.2 class 0.0 = 0.953 +- 0.178 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.992 +- 0.178 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.2 all KL = 0.963 +- 0.178 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.2 all L1 = 0.972 +- 0.128 (in-sample avg dev_std = 0.143)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11829880000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.956
SUFF_SIMPLE for r=0.4 class 0.0 = 0.954 +- 0.176 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.991 +- 0.176 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.4 all KL = 0.964 +- 0.176 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.4 all L1 = 0.973 +- 0.125 (in-sample avg dev_std = 0.149)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0920228
len(reference) = 4968
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.975
SUFF_SIMPLE for r=0.8 class 0.0 = 0.989 +- 0.092 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.985 +- 0.092 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.8 all KL = 0.987 +- 0.092 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.8 all L1 = 0.987 +- 0.062 (in-sample avg dev_std = 0.084)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.47767000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.001 +- 0.035 (in-sample avg dev_std = 0.031)
NEC for r=0.05 class 1.0 = 0.0 +- 0.035 (in-sample avg dev_std = 0.031)
NEC for r=0.05 all KL = 0.002 +- 0.035 (in-sample avg dev_std = 0.031)
NEC for r=0.05 all L1 = 0.0 +- 0.010 (in-sample avg dev_std = 0.031)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.409704
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.999
NEC for r=0.1 class 0.0 = 0.002 +- 0.047 (in-sample avg dev_std = 0.045)
NEC for r=0.1 class 1.0 = 0.0 +- 0.047 (in-sample avg dev_std = 0.045)
NEC for r=0.1 all KL = 0.003 +- 0.047 (in-sample avg dev_std = 0.045)
NEC for r=0.1 all L1 = 0.001 +- 0.014 (in-sample avg dev_std = 0.045)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.29106600000000005
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 0.0 = 0.001 +- 0.033 (in-sample avg dev_std = 0.032)
NEC for r=0.2 class 1.0 = 0.0 +- 0.033 (in-sample avg dev_std = 0.032)
NEC for r=0.2 all KL = 0.002 +- 0.033 (in-sample avg dev_std = 0.032)
NEC for r=0.2 all L1 = 0.0 +- 0.010 (in-sample avg dev_std = 0.032)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.178766
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.999
NEC for r=0.4 class 0.0 = 0.002 +- 0.048 (in-sample avg dev_std = 0.044)
NEC for r=0.4 class 1.0 = 0.0 +- 0.048 (in-sample avg dev_std = 0.044)
NEC for r=0.4 all KL = 0.003 +- 0.048 (in-sample avg dev_std = 0.044)
NEC for r=0.4 all L1 = 0.001 +- 0.014 (in-sample avg dev_std = 0.044)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.102912
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
NEC for r=0.8 class 0.0 = 0.001 +- 0.034 (in-sample avg dev_std = 0.031)
NEC for r=0.8 class 1.0 = 0.0 +- 0.034 (in-sample avg dev_std = 0.031)
NEC for r=0.8 all KL = 0.002 +- 0.034 (in-sample avg dev_std = 0.031)
NEC for r=0.8 all L1 = 0.0 +- 0.010 (in-sample avg dev_std = 0.031)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.995
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22569260000000005
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.982
NEC for r=0.05 class 0.0 = 0.003 +- 0.219 (in-sample avg dev_std = 0.237)
NEC for r=0.05 class 1.0 = 0.059 +- 0.219 (in-sample avg dev_std = 0.237)
NEC for r=0.05 all KL = 0.075 +- 0.219 (in-sample avg dev_std = 0.237)
NEC for r=0.05 all L1 = 0.032 +- 0.101 (in-sample avg dev_std = 0.237)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.995
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1222672
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.996
NEC for r=0.1 class 0.0 = 0.003 +- 0.120 (in-sample avg dev_std = 0.113)
NEC for r=0.1 class 1.0 = 0.018 +- 0.120 (in-sample avg dev_std = 0.113)
NEC for r=0.1 all KL = 0.022 +- 0.120 (in-sample avg dev_std = 0.113)
NEC for r=0.1 all L1 = 0.011 +- 0.068 (in-sample avg dev_std = 0.113)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.995
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0640396
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.998
NEC for r=0.2 class 0.0 = 0.003 +- 0.096 (in-sample avg dev_std = 0.075)
NEC for r=0.2 class 1.0 = 0.012 +- 0.096 (in-sample avg dev_std = 0.075)
NEC for r=0.2 all KL = 0.013 +- 0.096 (in-sample avg dev_std = 0.075)
NEC for r=0.2 all L1 = 0.007 +- 0.062 (in-sample avg dev_std = 0.075)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.995
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.033169599999999994
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.999
NEC for r=0.4 class 0.0 = 0.002 +- 0.079 (in-sample avg dev_std = 0.057)
NEC for r=0.4 class 1.0 = 0.01 +- 0.079 (in-sample avg dev_std = 0.057)
NEC for r=0.4 all KL = 0.008 +- 0.079 (in-sample avg dev_std = 0.057)
NEC for r=0.4 all L1 = 0.006 +- 0.057 (in-sample avg dev_std = 0.057)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.995
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0176382
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.998
NEC for r=0.8 class 0.0 = 0.003 +- 0.083 (in-sample avg dev_std = 0.061)
NEC for r=0.8 class 1.0 = 0.009 +- 0.083 (in-sample avg dev_std = 0.061)
NEC for r=0.8 all KL = 0.009 +- 0.083 (in-sample avg dev_std = 0.061)
NEC for r=0.8 all L1 = 0.006 +- 0.055 (in-sample avg dev_std = 0.061)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2546228
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.893
NEC for r=0.05 class 0.0 = 0.027 +- 0.321 (in-sample avg dev_std = 0.371)
NEC for r=0.05 class 1.0 = 0.238 +- 0.321 (in-sample avg dev_std = 0.371)
NEC for r=0.05 all KL = 0.194 +- 0.321 (in-sample avg dev_std = 0.371)
NEC for r=0.05 all L1 = 0.131 +- 0.224 (in-sample avg dev_std = 0.371)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.20126739999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.942
NEC for r=0.1 class 0.0 = 0.036 +- 0.234 (in-sample avg dev_std = 0.251)
NEC for r=0.1 class 1.0 = 0.108 +- 0.234 (in-sample avg dev_std = 0.251)
NEC for r=0.1 all KL = 0.104 +- 0.234 (in-sample avg dev_std = 0.251)
NEC for r=0.1 all L1 = 0.072 +- 0.167 (in-sample avg dev_std = 0.251)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15335919999999997
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.954
NEC for r=0.2 class 0.0 = 0.039 +- 0.190 (in-sample avg dev_std = 0.192)
NEC for r=0.2 class 1.0 = 0.05 +- 0.190 (in-sample avg dev_std = 0.192)
NEC for r=0.2 all KL = 0.061 +- 0.190 (in-sample avg dev_std = 0.192)
NEC for r=0.2 all L1 = 0.044 +- 0.140 (in-sample avg dev_std = 0.192)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11829880000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.956
NEC for r=0.4 class 0.0 = 0.035 +- 0.174 (in-sample avg dev_std = 0.156)
NEC for r=0.4 class 1.0 = 0.027 +- 0.174 (in-sample avg dev_std = 0.156)
NEC for r=0.4 all KL = 0.042 +- 0.174 (in-sample avg dev_std = 0.156)
NEC for r=0.4 all L1 = 0.031 +- 0.127 (in-sample avg dev_std = 0.156)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.977
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0920228
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.962
NEC for r=0.8 class 0.0 = 0.033 +- 0.155 (in-sample avg dev_std = 0.146)
NEC for r=0.8 class 1.0 = 0.012 +- 0.155 (in-sample avg dev_std = 0.146)
NEC for r=0.8 all KL = 0.033 +- 0.155 (in-sample avg dev_std = 0.146)
NEC for r=0.8 all L1 = 0.022 +- 0.106 (in-sample avg dev_std = 0.146)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 21:36:53 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 09:36:53 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 09:36:53 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 09:36:53 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 09:36:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:36:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:36:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:36:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:36:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:36:53 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 09:36:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.553
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.511
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.389
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.250
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.138
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.296
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.164
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.087
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.045
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.023
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.367
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.302
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.232
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.170
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.121


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.552706
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.987
SUFF_SIMPLE for r=0.05 class 0.0 = 0.955 +- 0.188 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.188 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.05 all KL = 0.945 +- 0.188 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.05 all L1 = 0.98 +- 0.081 (in-sample avg dev_std = 0.179)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5110319999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.989
SUFF_SIMPLE for r=0.1 class 0.0 = 0.958 +- 0.189 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.189 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.1 all KL = 0.947 +- 0.189 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.1 all L1 = 0.981 +- 0.075 (in-sample avg dev_std = 0.181)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.388652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.986
SUFF_SIMPLE for r=0.2 class 0.0 = 0.952 +- 0.200 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.200 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 all KL = 0.945 +- 0.200 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 all L1 = 0.979 +- 0.088 (in-sample avg dev_std = 0.197)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.249828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.984
SUFF_SIMPLE for r=0.4 class 0.0 = 0.945 +- 0.211 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.211 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.4 all KL = 0.937 +- 0.211 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.4 all L1 = 0.976 +- 0.093 (in-sample avg dev_std = 0.206)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.138484
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.969
SUFF_SIMPLE for r=0.8 class 0.0 = 0.897 +- 0.281 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.281 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.8 all KL = 0.897 +- 0.281 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.8 all L1 = 0.954 +- 0.137 (in-sample avg dev_std = 0.279)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.957
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.295537
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.905
SUFF_SIMPLE for r=0.05 class 0.0 = 0.845 +- 0.363 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.999 +- 0.363 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.05 all KL = 0.816 +- 0.363 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.05 all L1 = 0.923 +- 0.169 (in-sample avg dev_std = 0.374)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.957
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.164454
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.905
SUFF_SIMPLE for r=0.1 class 0.0 = 0.846 +- 0.362 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.362 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.1 all KL = 0.817 +- 0.362 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.1 all L1 = 0.923 +- 0.170 (in-sample avg dev_std = 0.371)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.957
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08715619999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.903
SUFF_SIMPLE for r=0.2 class 0.0 = 0.843 +- 0.364 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.364 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.2 all KL = 0.818 +- 0.364 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.2 all L1 = 0.921 +- 0.174 (in-sample avg dev_std = 0.373)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.957
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04494
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.898
SUFF_SIMPLE for r=0.4 class 0.0 = 0.83 +- 0.371 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.999 +- 0.371 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.4 all KL = 0.811 +- 0.371 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.4 all L1 = 0.915 +- 0.184 (in-sample avg dev_std = 0.383)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.957
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0228408
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.838
SUFF_SIMPLE for r=0.8 class 0.0 = 0.72 +- 0.411 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.999 +- 0.411 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.8 all KL = 0.77 +- 0.411 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.8 all L1 = 0.861 +- 0.268 (in-sample avg dev_std = 0.406)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.366908
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.946
SUFF_SIMPLE for r=0.05 class 0.0 = 0.947 +- 0.230 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.974 +- 0.230 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.05 all KL = 0.934 +- 0.230 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.05 all L1 = 0.96 +- 0.149 (in-sample avg dev_std = 0.165)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3018496
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.947
SUFF_SIMPLE for r=0.1 class 0.0 = 0.947 +- 0.227 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.976 +- 0.227 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.1 all KL = 0.936 +- 0.227 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.1 all L1 = 0.961 +- 0.148 (in-sample avg dev_std = 0.166)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23168560000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.949
SUFF_SIMPLE for r=0.2 class 0.0 = 0.948 +- 0.197 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.989 +- 0.197 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.2 all KL = 0.955 +- 0.197 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.2 all L1 = 0.969 +- 0.143 (in-sample avg dev_std = 0.130)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.170355
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.952
SUFF_SIMPLE for r=0.4 class 0.0 = 0.954 +- 0.171 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.171 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.4 all KL = 0.967 +- 0.171 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.4 all L1 = 0.977 +- 0.125 (in-sample avg dev_std = 0.136)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.973
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.12148319999999999
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.965
SUFF_SIMPLE for r=0.8 class 0.0 = 0.982 +- 0.107 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.107 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.8 all KL = 0.986 +- 0.107 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.8 all L1 = 0.991 +- 0.073 (in-sample avg dev_std = 0.086)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.552706
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.997
NEC for r=0.05 class 0.0 = 0.014 +- 0.110 (in-sample avg dev_std = 0.096)
NEC for r=0.05 class 1.0 = 0.0 +- 0.110 (in-sample avg dev_std = 0.096)
NEC for r=0.05 all KL = 0.015 +- 0.110 (in-sample avg dev_std = 0.096)
NEC for r=0.05 all L1 = 0.006 +- 0.053 (in-sample avg dev_std = 0.096)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5110319999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.998
NEC for r=0.1 class 0.0 = 0.012 +- 0.104 (in-sample avg dev_std = 0.095)
NEC for r=0.1 class 1.0 = 0.0 +- 0.104 (in-sample avg dev_std = 0.095)
NEC for r=0.1 all KL = 0.014 +- 0.104 (in-sample avg dev_std = 0.095)
NEC for r=0.1 all L1 = 0.005 +- 0.042 (in-sample avg dev_std = 0.095)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.388652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.999
NEC for r=0.2 class 0.0 = 0.006 +- 0.077 (in-sample avg dev_std = 0.070)
NEC for r=0.2 class 1.0 = 0.0 +- 0.077 (in-sample avg dev_std = 0.070)
NEC for r=0.2 all KL = 0.008 +- 0.077 (in-sample avg dev_std = 0.070)
NEC for r=0.2 all L1 = 0.003 +- 0.028 (in-sample avg dev_std = 0.070)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.249828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.999
NEC for r=0.4 class 0.0 = 0.004 +- 0.061 (in-sample avg dev_std = 0.057)
NEC for r=0.4 class 1.0 = 0.0 +- 0.061 (in-sample avg dev_std = 0.057)
NEC for r=0.4 all KL = 0.006 +- 0.061 (in-sample avg dev_std = 0.057)
NEC for r=0.4 all L1 = 0.002 +- 0.018 (in-sample avg dev_std = 0.057)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.138484
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.004 +- 0.054 (in-sample avg dev_std = 0.049)
NEC for r=0.8 class 1.0 = 0.0 +- 0.054 (in-sample avg dev_std = 0.049)
NEC for r=0.8 all KL = 0.005 +- 0.054 (in-sample avg dev_std = 0.049)
NEC for r=0.8 all L1 = 0.002 +- 0.017 (in-sample avg dev_std = 0.049)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.957
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.295537
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.934
NEC for r=0.05 class 0.0 = 0.055 +- 0.240 (in-sample avg dev_std = 0.236)
NEC for r=0.05 class 1.0 = 0.011 +- 0.240 (in-sample avg dev_std = 0.236)
NEC for r=0.05 all KL = 0.075 +- 0.240 (in-sample avg dev_std = 0.236)
NEC for r=0.05 all L1 = 0.033 +- 0.113 (in-sample avg dev_std = 0.236)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.957
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.164454
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.943
NEC for r=0.1 class 0.0 = 0.043 +- 0.218 (in-sample avg dev_std = 0.199)
NEC for r=0.1 class 1.0 = 0.002 +- 0.218 (in-sample avg dev_std = 0.199)
NEC for r=0.1 all KL = 0.062 +- 0.218 (in-sample avg dev_std = 0.199)
NEC for r=0.1 all L1 = 0.022 +- 0.085 (in-sample avg dev_std = 0.199)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.957
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08715619999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.945
NEC for r=0.2 class 0.0 = 0.039 +- 0.212 (in-sample avg dev_std = 0.192)
NEC for r=0.2 class 1.0 = 0.001 +- 0.212 (in-sample avg dev_std = 0.192)
NEC for r=0.2 all KL = 0.06 +- 0.212 (in-sample avg dev_std = 0.192)
NEC for r=0.2 all L1 = 0.02 +- 0.075 (in-sample avg dev_std = 0.192)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.957
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04494
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.946
NEC for r=0.4 class 0.0 = 0.036 +- 0.207 (in-sample avg dev_std = 0.187)
NEC for r=0.4 class 1.0 = 0.001 +- 0.207 (in-sample avg dev_std = 0.187)
NEC for r=0.4 all KL = 0.059 +- 0.207 (in-sample avg dev_std = 0.187)
NEC for r=0.4 all L1 = 0.018 +- 0.069 (in-sample avg dev_std = 0.187)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.957
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0228408
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.949
NEC for r=0.8 class 0.0 = 0.027 +- 0.185 (in-sample avg dev_std = 0.164)
NEC for r=0.8 class 1.0 = 0.001 +- 0.185 (in-sample avg dev_std = 0.164)
NEC for r=0.8 all KL = 0.047 +- 0.185 (in-sample avg dev_std = 0.164)
NEC for r=0.8 all L1 = 0.014 +- 0.057 (in-sample avg dev_std = 0.164)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.366908
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.933
NEC for r=0.05 class 0.0 = 0.033 +- 0.314 (in-sample avg dev_std = 0.276)
NEC for r=0.05 class 1.0 = 0.133 +- 0.314 (in-sample avg dev_std = 0.276)
NEC for r=0.05 all KL = 0.158 +- 0.314 (in-sample avg dev_std = 0.276)
NEC for r=0.05 all L1 = 0.082 +- 0.189 (in-sample avg dev_std = 0.276)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3018496
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.965
NEC for r=0.1 class 0.0 = 0.042 +- 0.196 (in-sample avg dev_std = 0.136)
NEC for r=0.1 class 1.0 = 0.023 +- 0.196 (in-sample avg dev_std = 0.136)
NEC for r=0.1 all KL = 0.057 +- 0.196 (in-sample avg dev_std = 0.136)
NEC for r=0.1 all L1 = 0.033 +- 0.135 (in-sample avg dev_std = 0.136)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23168560000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.964
NEC for r=0.2 class 0.0 = 0.04 +- 0.166 (in-sample avg dev_std = 0.132)
NEC for r=0.2 class 1.0 = 0.005 +- 0.166 (in-sample avg dev_std = 0.132)
NEC for r=0.2 all KL = 0.035 +- 0.166 (in-sample avg dev_std = 0.132)
NEC for r=0.2 all L1 = 0.023 +- 0.117 (in-sample avg dev_std = 0.132)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.170355
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.962
NEC for r=0.4 class 0.0 = 0.034 +- 0.158 (in-sample avg dev_std = 0.131)
NEC for r=0.4 class 1.0 = 0.006 +- 0.158 (in-sample avg dev_std = 0.131)
NEC for r=0.4 all KL = 0.032 +- 0.158 (in-sample avg dev_std = 0.131)
NEC for r=0.4 all L1 = 0.02 +- 0.109 (in-sample avg dev_std = 0.131)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.12148319999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.96
NEC for r=0.8 class 0.0 = 0.032 +- 0.160 (in-sample avg dev_std = 0.136)
NEC for r=0.8 class 1.0 = 0.007 +- 0.160 (in-sample avg dev_std = 0.136)
NEC for r=0.8 all KL = 0.033 +- 0.160 (in-sample avg dev_std = 0.136)
NEC for r=0.8 all L1 = 0.02 +- 0.104 (in-sample avg dev_std = 0.136)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 21:52:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 09:52:30 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 09:52:30 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 09:52:30 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 09:52:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:52:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:52:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:52:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:52:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:52:30 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 09:52:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.507
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.427
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.289
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.185
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.108
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.250
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.137
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.073
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.038
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.020
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.265
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.211
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.154
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.121
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.097


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5074919999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.994
SUFF_SIMPLE for r=0.05 class 0.0 = 0.981 +- 0.125 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.125 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.05 all KL = 0.979 +- 0.125 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.05 all L1 = 0.991 +- 0.060 (in-sample avg dev_std = 0.121)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.42704999999999993
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.993
SUFF_SIMPLE for r=0.1 class 0.0 = 0.976 +- 0.146 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.146 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all KL = 0.97 +- 0.146 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all L1 = 0.989 +- 0.057 (in-sample avg dev_std = 0.139)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.288848
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.993
SUFF_SIMPLE for r=0.2 class 0.0 = 0.978 +- 0.136 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.136 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 all KL = 0.975 +- 0.136 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 all L1 = 0.99 +- 0.063 (in-sample avg dev_std = 0.129)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.18531999999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.994
SUFF_SIMPLE for r=0.4 class 0.0 = 0.979 +- 0.137 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.137 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.4 all KL = 0.976 +- 0.137 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.4 all L1 = 0.991 +- 0.058 (in-sample avg dev_std = 0.132)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10813399999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.99
SUFF_SIMPLE for r=0.8 class 0.0 = 0.97 +- 0.161 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.161 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.8 all KL = 0.966 +- 0.161 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.8 all L1 = 0.986 +- 0.072 (in-sample avg dev_std = 0.150)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.682
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2501604
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.891
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.427 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.593 +- 0.427 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.05 all KL = 0.726 +- 0.427 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.05 all L1 = 0.793 +- 0.338 (in-sample avg dev_std = 0.282)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.682
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.136849
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.892
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.427 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.591 +- 0.427 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.1 all KL = 0.726 +- 0.427 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.1 all L1 = 0.792 +- 0.339 (in-sample avg dev_std = 0.284)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.682
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07258699999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.895
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.429 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.586 +- 0.429 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.2 all KL = 0.724 +- 0.429 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.2 all L1 = 0.79 +- 0.340 (in-sample avg dev_std = 0.284)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.682
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.038020399999999996
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.906
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.434 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.568 +- 0.434 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.4 all KL = 0.712 +- 0.434 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.4 all L1 = 0.78 +- 0.346 (in-sample avg dev_std = 0.286)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.682
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0199446
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.941
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.446 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.518 +- 0.446 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.8 all KL = 0.689 +- 0.446 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.8 all L1 = 0.751 +- 0.369 (in-sample avg dev_std = 0.241)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.828
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2653514
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.814
SUFF_SIMPLE for r=0.05 class 0.0 = 0.953 +- 0.180 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.969 +- 0.180 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.05 all KL = 0.951 +- 0.180 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.05 all L1 = 0.961 +- 0.135 (in-sample avg dev_std = 0.160)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.828
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.210971
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.815
SUFF_SIMPLE for r=0.1 class 0.0 = 0.955 +- 0.181 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.968 +- 0.181 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.1 all KL = 0.949 +- 0.181 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.1 all L1 = 0.961 +- 0.134 (in-sample avg dev_std = 0.163)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.828
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1541828
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.815
SUFF_SIMPLE for r=0.2 class 0.0 = 0.955 +- 0.182 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.971 +- 0.182 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.2 all KL = 0.953 +- 0.182 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.2 all L1 = 0.963 +- 0.134 (in-sample avg dev_std = 0.164)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.828
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1210356
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.815
SUFF_SIMPLE for r=0.4 class 0.0 = 0.954 +- 0.184 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.971 +- 0.184 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.4 all KL = 0.952 +- 0.184 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.4 all L1 = 0.962 +- 0.137 (in-sample avg dev_std = 0.181)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.829
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0970336
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.842
SUFF_SIMPLE for r=0.8 class 0.0 = 0.985 +- 0.158 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.944 +- 0.158 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.8 all KL = 0.955 +- 0.158 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.8 all L1 = 0.965 +- 0.119 (in-sample avg dev_std = 0.182)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5074919999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)
NEC for r=0.05 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)
NEC for r=0.05 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)
NEC for r=0.05 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.001)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.42704999999999993
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.288848
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.18531999999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  1.0
NEC for r=0.4 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10813399999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.002 +- 0.042 (in-sample avg dev_std = 0.038)
NEC for r=0.8 class 1.0 = 0.0 +- 0.042 (in-sample avg dev_std = 0.038)
NEC for r=0.8 all KL = 0.002 +- 0.042 (in-sample avg dev_std = 0.038)
NEC for r=0.8 all L1 = 0.001 +- 0.020 (in-sample avg dev_std = 0.038)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.682
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2501604
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.778
NEC for r=0.05 class 0.0 = 0.0 +- 0.398 (in-sample avg dev_std = 0.450)
NEC for r=0.05 class 1.0 = 0.329 +- 0.398 (in-sample avg dev_std = 0.450)
NEC for r=0.05 all KL = 0.264 +- 0.398 (in-sample avg dev_std = 0.450)
NEC for r=0.05 all L1 = 0.166 +- 0.269 (in-sample avg dev_std = 0.450)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.682
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.136849
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.8
NEC for r=0.1 class 0.0 = 0.0 +- 0.383 (in-sample avg dev_std = 0.365)
NEC for r=0.1 class 1.0 = 0.29 +- 0.383 (in-sample avg dev_std = 0.365)
NEC for r=0.1 all KL = 0.221 +- 0.383 (in-sample avg dev_std = 0.365)
NEC for r=0.1 all L1 = 0.146 +- 0.270 (in-sample avg dev_std = 0.365)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.682
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07258699999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.795
NEC for r=0.2 class 0.0 = 0.0 +- 0.369 (in-sample avg dev_std = 0.322)
NEC for r=0.2 class 1.0 = 0.262 +- 0.369 (in-sample avg dev_std = 0.322)
NEC for r=0.2 all KL = 0.201 +- 0.369 (in-sample avg dev_std = 0.322)
NEC for r=0.2 all L1 = 0.132 +- 0.261 (in-sample avg dev_std = 0.322)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.682
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.038020399999999996
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.785
NEC for r=0.4 class 0.0 = 0.0 +- 0.350 (in-sample avg dev_std = 0.283)
NEC for r=0.4 class 1.0 = 0.233 +- 0.350 (in-sample avg dev_std = 0.283)
NEC for r=0.4 all KL = 0.176 +- 0.350 (in-sample avg dev_std = 0.283)
NEC for r=0.4 all L1 = 0.118 +- 0.250 (in-sample avg dev_std = 0.283)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.682
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0199446
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.783
NEC for r=0.8 class 0.0 = 0.0 +- 0.344 (in-sample avg dev_std = 0.270)
NEC for r=0.8 class 1.0 = 0.226 +- 0.344 (in-sample avg dev_std = 0.270)
NEC for r=0.8 all KL = 0.17 +- 0.344 (in-sample avg dev_std = 0.270)
NEC for r=0.8 all L1 = 0.114 +- 0.247 (in-sample avg dev_std = 0.270)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.828
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2653514
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.779
NEC for r=0.05 class 0.0 = 0.023 +- 0.303 (in-sample avg dev_std = 0.303)
NEC for r=0.05 class 1.0 = 0.171 +- 0.303 (in-sample avg dev_std = 0.303)
NEC for r=0.05 all KL = 0.142 +- 0.303 (in-sample avg dev_std = 0.303)
NEC for r=0.05 all L1 = 0.096 +- 0.204 (in-sample avg dev_std = 0.303)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.828
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.210971
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.822
NEC for r=0.1 class 0.0 = 0.027 +- 0.195 (in-sample avg dev_std = 0.182)
NEC for r=0.1 class 1.0 = 0.065 +- 0.195 (in-sample avg dev_std = 0.182)
NEC for r=0.1 all KL = 0.064 +- 0.195 (in-sample avg dev_std = 0.182)
NEC for r=0.1 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.182)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.828
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1541828
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.824
NEC for r=0.2 class 0.0 = 0.027 +- 0.145 (in-sample avg dev_std = 0.122)
NEC for r=0.2 class 1.0 = 0.029 +- 0.145 (in-sample avg dev_std = 0.122)
NEC for r=0.2 all KL = 0.032 +- 0.145 (in-sample avg dev_std = 0.122)
NEC for r=0.2 all L1 = 0.028 +- 0.108 (in-sample avg dev_std = 0.122)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.828
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1210356
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.822
NEC for r=0.4 class 0.0 = 0.026 +- 0.134 (in-sample avg dev_std = 0.118)
NEC for r=0.4 class 1.0 = 0.018 +- 0.134 (in-sample avg dev_std = 0.118)
NEC for r=0.4 all KL = 0.024 +- 0.134 (in-sample avg dev_std = 0.118)
NEC for r=0.4 all L1 = 0.022 +- 0.097 (in-sample avg dev_std = 0.118)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.828
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0970336
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.82
NEC for r=0.8 class 0.0 = 0.026 +- 0.135 (in-sample avg dev_std = 0.120)
NEC for r=0.8 class 1.0 = 0.013 +- 0.135 (in-sample avg dev_std = 0.120)
NEC for r=0.8 all KL = 0.024 +- 0.135 (in-sample avg dev_std = 0.120)
NEC for r=0.8 all L1 = 0.02 +- 0.093 (in-sample avg dev_std = 0.120)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 22:07:59 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 10:08:00 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 10:08:00 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 10:08:00 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 10:08:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:08:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:08:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:08:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:08:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:08:00 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 10:08:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 88 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0038
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0053
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0046
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0053
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0046

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0038
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0053
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0046
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0053
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0046

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.341
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.290
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.203
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.125
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.095
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.129
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.074
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.042
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.023
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.196
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.142
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.098
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.070
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.074


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.34084400000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.987
SUFF_SIMPLE for r=0.05 class 0.0 = 0.954 +- 0.158 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.99 +- 0.158 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.05 all KL = 0.957 +- 0.158 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.05 all L1 = 0.974 +- 0.090 (in-sample avg dev_std = 0.159)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.290016
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.989
SUFF_SIMPLE for r=0.1 class 0.0 = 0.959 +- 0.155 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.99 +- 0.155 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.1 all KL = 0.958 +- 0.155 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.1 all L1 = 0.976 +- 0.081 (in-sample avg dev_std = 0.161)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20252599999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.988
SUFF_SIMPLE for r=0.2 class 0.0 = 0.963 +- 0.147 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.99 +- 0.147 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.2 all KL = 0.964 +- 0.147 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.2 all L1 = 0.978 +- 0.082 (in-sample avg dev_std = 0.158)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.12509399999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.994
SUFF_SIMPLE for r=0.4 class 0.0 = 0.971 +- 0.105 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.996 +- 0.105 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.4 all KL = 0.979 +- 0.105 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.4 all L1 = 0.985 +- 0.064 (in-sample avg dev_std = 0.096)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.094814
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.997
SUFF_SIMPLE for r=0.8 class 0.0 = 0.98 +- 0.096 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.993 +- 0.096 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.8 all KL = 0.983 +- 0.096 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.8 all L1 = 0.987 +- 0.057 (in-sample avg dev_std = 0.097)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1285564
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.919
SUFF_SIMPLE for r=0.05 class 0.0 = 0.871 +- 0.210 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.936 +- 0.210 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.05 all KL = 0.898 +- 0.210 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.05 all L1 = 0.904 +- 0.191 (in-sample avg dev_std = 0.193)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.07448060000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.919
SUFF_SIMPLE for r=0.1 class 0.0 = 0.874 +- 0.205 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.936 +- 0.205 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.1 all KL = 0.901 +- 0.205 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.1 all L1 = 0.905 +- 0.189 (in-sample avg dev_std = 0.185)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.041658799999999996
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.917
SUFF_SIMPLE for r=0.2 class 0.0 = 0.872 +- 0.209 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.936 +- 0.209 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.2 all KL = 0.899 +- 0.209 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.2 all L1 = 0.904 +- 0.191 (in-sample avg dev_std = 0.189)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.022569400000000003
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.916
SUFF_SIMPLE for r=0.4 class 0.0 = 0.87 +- 0.212 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.935 +- 0.212 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.4 all KL = 0.898 +- 0.212 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.4 all L1 = 0.903 +- 0.193 (in-sample avg dev_std = 0.187)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0124992
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.902
SUFF_SIMPLE for r=0.8 class 0.0 = 0.856 +- 0.241 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.933 +- 0.241 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.8 all KL = 0.88 +- 0.241 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.8 all L1 = 0.895 +- 0.201 (in-sample avg dev_std = 0.224)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.657
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1956148
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.645
SUFF_SIMPLE for r=0.05 class 0.0 = 0.914 +- 0.276 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.853 +- 0.276 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.05 all KL = 0.869 +- 0.276 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.05 all L1 = 0.884 +- 0.221 (in-sample avg dev_std = 0.238)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.657
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1417826
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.646
SUFF_SIMPLE for r=0.1 class 0.0 = 0.919 +- 0.273 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.854 +- 0.273 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.1 all KL = 0.873 +- 0.273 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.1 all L1 = 0.887 +- 0.219 (in-sample avg dev_std = 0.231)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.657
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09757640000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.645
SUFF_SIMPLE for r=0.2 class 0.0 = 0.924 +- 0.263 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.86 +- 0.263 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.2 all KL = 0.884 +- 0.263 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.2 all L1 = 0.892 +- 0.216 (in-sample avg dev_std = 0.205)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.657
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.069615
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.661
SUFF_SIMPLE for r=0.4 class 0.0 = 0.935 +- 0.242 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.865 +- 0.242 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.4 all KL = 0.897 +- 0.242 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.4 all L1 = 0.9 +- 0.205 (in-sample avg dev_std = 0.192)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.658
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0743998
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.669
SUFF_SIMPLE for r=0.8 class 0.0 = 0.974 +- 0.164 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.888 +- 0.164 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.8 all KL = 0.945 +- 0.164 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.8 all L1 = 0.931 +- 0.160 (in-sample avg dev_std = 0.113)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.34084400000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.988
NEC for r=0.05 class 0.0 = 0.027 +- 0.121 (in-sample avg dev_std = 0.083)
NEC for r=0.05 class 1.0 = 0.022 +- 0.121 (in-sample avg dev_std = 0.083)
NEC for r=0.05 all KL = 0.03 +- 0.121 (in-sample avg dev_std = 0.083)
NEC for r=0.05 all L1 = 0.024 +- 0.090 (in-sample avg dev_std = 0.083)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.290016
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.993
NEC for r=0.1 class 0.0 = 0.022 +- 0.104 (in-sample avg dev_std = 0.096)
NEC for r=0.1 class 1.0 = 0.015 +- 0.104 (in-sample avg dev_std = 0.096)
NEC for r=0.1 all KL = 0.022 +- 0.104 (in-sample avg dev_std = 0.096)
NEC for r=0.1 all L1 = 0.018 +- 0.073 (in-sample avg dev_std = 0.096)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20252599999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.994
NEC for r=0.2 class 0.0 = 0.021 +- 0.096 (in-sample avg dev_std = 0.099)
NEC for r=0.2 class 1.0 = 0.011 +- 0.096 (in-sample avg dev_std = 0.099)
NEC for r=0.2 all KL = 0.021 +- 0.096 (in-sample avg dev_std = 0.099)
NEC for r=0.2 all L1 = 0.015 +- 0.062 (in-sample avg dev_std = 0.099)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.12509399999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.994
NEC for r=0.4 class 0.0 = 0.021 +- 0.092 (in-sample avg dev_std = 0.092)
NEC for r=0.4 class 1.0 = 0.007 +- 0.092 (in-sample avg dev_std = 0.092)
NEC for r=0.4 all KL = 0.017 +- 0.092 (in-sample avg dev_std = 0.092)
NEC for r=0.4 all L1 = 0.013 +- 0.060 (in-sample avg dev_std = 0.092)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.094814
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.996
NEC for r=0.8 class 0.0 = 0.015 +- 0.056 (in-sample avg dev_std = 0.063)
NEC for r=0.8 class 1.0 = 0.004 +- 0.056 (in-sample avg dev_std = 0.063)
NEC for r=0.8 all KL = 0.009 +- 0.056 (in-sample avg dev_std = 0.063)
NEC for r=0.8 all L1 = 0.009 +- 0.047 (in-sample avg dev_std = 0.063)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1285564
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.868
NEC for r=0.05 class 0.0 = 0.158 +- 0.330 (in-sample avg dev_std = 0.439)
NEC for r=0.05 class 1.0 = 0.188 +- 0.330 (in-sample avg dev_std = 0.439)
NEC for r=0.05 all KL = 0.268 +- 0.330 (in-sample avg dev_std = 0.439)
NEC for r=0.05 all L1 = 0.173 +- 0.219 (in-sample avg dev_std = 0.439)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.07448060000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.907
NEC for r=0.1 class 0.0 = 0.123 +- 0.258 (in-sample avg dev_std = 0.323)
NEC for r=0.1 class 1.0 = 0.107 +- 0.258 (in-sample avg dev_std = 0.323)
NEC for r=0.1 all KL = 0.157 +- 0.258 (in-sample avg dev_std = 0.323)
NEC for r=0.1 all L1 = 0.115 +- 0.184 (in-sample avg dev_std = 0.323)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.041658799999999996
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.929
NEC for r=0.2 class 0.0 = 0.088 +- 0.183 (in-sample avg dev_std = 0.234)
NEC for r=0.2 class 1.0 = 0.072 +- 0.183 (in-sample avg dev_std = 0.234)
NEC for r=0.2 all KL = 0.088 +- 0.183 (in-sample avg dev_std = 0.234)
NEC for r=0.2 all L1 = 0.08 +- 0.153 (in-sample avg dev_std = 0.234)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.022569400000000003
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.936
NEC for r=0.4 class 0.0 = 0.069 +- 0.134 (in-sample avg dev_std = 0.180)
NEC for r=0.4 class 1.0 = 0.057 +- 0.134 (in-sample avg dev_std = 0.180)
NEC for r=0.4 all KL = 0.057 +- 0.134 (in-sample avg dev_std = 0.180)
NEC for r=0.4 all L1 = 0.063 +- 0.131 (in-sample avg dev_std = 0.180)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0124992
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.939
NEC for r=0.8 class 0.0 = 0.062 +- 0.105 (in-sample avg dev_std = 0.141)
NEC for r=0.8 class 1.0 = 0.05 +- 0.105 (in-sample avg dev_std = 0.141)
NEC for r=0.8 all KL = 0.04 +- 0.105 (in-sample avg dev_std = 0.141)
NEC for r=0.8 all L1 = 0.056 +- 0.125 (in-sample avg dev_std = 0.141)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.657
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1956148
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.572
NEC for r=0.05 class 0.0 = 0.059 +- 0.303 (in-sample avg dev_std = 0.116)
NEC for r=0.05 class 1.0 = 0.218 +- 0.303 (in-sample avg dev_std = 0.116)
NEC for r=0.05 all KL = 0.138 +- 0.303 (in-sample avg dev_std = 0.116)
NEC for r=0.05 all L1 = 0.138 +- 0.268 (in-sample avg dev_std = 0.116)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.657
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1417826
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.593
NEC for r=0.1 class 0.0 = 0.076 +- 0.303 (in-sample avg dev_std = 0.231)
NEC for r=0.1 class 1.0 = 0.188 +- 0.303 (in-sample avg dev_std = 0.231)
NEC for r=0.1 all KL = 0.145 +- 0.303 (in-sample avg dev_std = 0.231)
NEC for r=0.1 all L1 = 0.131 +- 0.245 (in-sample avg dev_std = 0.231)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.657
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09757640000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.622
NEC for r=0.2 class 0.0 = 0.081 +- 0.269 (in-sample avg dev_std = 0.222)
NEC for r=0.2 class 1.0 = 0.136 +- 0.269 (in-sample avg dev_std = 0.222)
NEC for r=0.2 all KL = 0.121 +- 0.269 (in-sample avg dev_std = 0.222)
NEC for r=0.2 all L1 = 0.108 +- 0.215 (in-sample avg dev_std = 0.222)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.657
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.069615
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.638
NEC for r=0.4 class 0.0 = 0.08 +- 0.245 (in-sample avg dev_std = 0.210)
NEC for r=0.4 class 1.0 = 0.104 +- 0.245 (in-sample avg dev_std = 0.210)
NEC for r=0.4 all KL = 0.101 +- 0.245 (in-sample avg dev_std = 0.210)
NEC for r=0.4 all L1 = 0.092 +- 0.198 (in-sample avg dev_std = 0.210)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.657
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0743998
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.647
NEC for r=0.8 class 0.0 = 0.066 +- 0.231 (in-sample avg dev_std = 0.247)
NEC for r=0.8 class 1.0 = 0.099 +- 0.231 (in-sample avg dev_std = 0.247)
NEC for r=0.8 all KL = 0.094 +- 0.231 (in-sample avg dev_std = 0.247)
NEC for r=0.8 all L1 = 0.082 +- 0.176 (in-sample avg dev_std = 0.247)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 22:23:50 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 10:23:50 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 10:23:50 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 10:23:50 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 10:23:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:23:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:23:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:23:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:23:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:23:50 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 10:23:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 66 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.9972
Train Loss: 0.0102
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0090
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0138
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0090
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.9972
Train Loss: 0.0102
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0090
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0138
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0090
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0138

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.453
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.377
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.248
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.149
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.100
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.152
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.083
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.045
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.025
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.014
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.252
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.189
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.130
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.091
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.084


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.453204
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.974
SUFF_SIMPLE for r=0.05 class 0.0 = 0.929 +- 0.197 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.988 +- 0.197 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.05 all KL = 0.939 +- 0.197 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.05 all L1 = 0.962 +- 0.126 (in-sample avg dev_std = 0.184)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.37665
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.979
SUFF_SIMPLE for r=0.1 class 0.0 = 0.934 +- 0.189 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.988 +- 0.189 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.1 all KL = 0.942 +- 0.189 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.1 all L1 = 0.964 +- 0.117 (in-sample avg dev_std = 0.182)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.248162
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.979
SUFF_SIMPLE for r=0.2 class 0.0 = 0.937 +- 0.184 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.991 +- 0.184 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.2 all KL = 0.948 +- 0.184 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.2 all L1 = 0.967 +- 0.115 (in-sample avg dev_std = 0.172)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.149492
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.986
SUFF_SIMPLE for r=0.4 class 0.0 = 0.952 +- 0.152 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.992 +- 0.152 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.4 all KL = 0.962 +- 0.152 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.4 all L1 = 0.974 +- 0.098 (in-sample avg dev_std = 0.144)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10047
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.988
SUFF_SIMPLE for r=0.8 class 0.0 = 0.975 +- 0.122 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.987 +- 0.122 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.8 all KL = 0.975 +- 0.122 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.8 all L1 = 0.982 +- 0.077 (in-sample avg dev_std = 0.119)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.757
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1520884
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.815
SUFF_SIMPLE for r=0.05 class 0.0 = 0.983 +- 0.279 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.839 +- 0.279 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.05 all KL = 0.873 +- 0.279 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.207 (in-sample avg dev_std = 0.212)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.757
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0831856
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.815
SUFF_SIMPLE for r=0.1 class 0.0 = 0.985 +- 0.275 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.84 +- 0.275 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.1 all KL = 0.877 +- 0.275 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.1 all L1 = 0.912 +- 0.205 (in-sample avg dev_std = 0.204)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.757
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.045058600000000004
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.814
SUFF_SIMPLE for r=0.2 class 0.0 = 0.985 +- 0.274 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.841 +- 0.274 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all KL = 0.878 +- 0.274 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all L1 = 0.912 +- 0.205 (in-sample avg dev_std = 0.202)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.757
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024718
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.814
SUFF_SIMPLE for r=0.4 class 0.0 = 0.986 +- 0.276 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.839 +- 0.276 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.4 all KL = 0.877 +- 0.276 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.4 all L1 = 0.912 +- 0.204 (in-sample avg dev_std = 0.210)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.757
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.014107600000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.818
SUFF_SIMPLE for r=0.8 class 0.0 = 0.987 +- 0.292 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.82 +- 0.292 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 all KL = 0.864 +- 0.292 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 all L1 = 0.903 +- 0.215 (in-sample avg dev_std = 0.232)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.658
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25195080000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.637
SUFF_SIMPLE for r=0.05 class 0.0 = 0.906 +- 0.299 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.866 +- 0.299 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.05 all KL = 0.856 +- 0.299 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.05 all L1 = 0.886 +- 0.234 (in-sample avg dev_std = 0.256)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.658
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1887576
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.639
SUFF_SIMPLE for r=0.1 class 0.0 = 0.907 +- 0.291 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.874 +- 0.291 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.1 all KL = 0.867 +- 0.291 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.1 all L1 = 0.891 +- 0.233 (in-sample avg dev_std = 0.231)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.658
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.129688
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.636
SUFF_SIMPLE for r=0.2 class 0.0 = 0.914 +- 0.284 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.879 +- 0.284 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 all KL = 0.875 +- 0.284 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 all L1 = 0.896 +- 0.226 (in-sample avg dev_std = 0.203)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.658
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09080840000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.648
SUFF_SIMPLE for r=0.4 class 0.0 = 0.926 +- 0.260 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.892 +- 0.260 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.4 all KL = 0.891 +- 0.260 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.4 all L1 = 0.909 +- 0.208 (in-sample avg dev_std = 0.195)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.659
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08438720000000001
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.664
SUFF_SIMPLE for r=0.8 class 0.0 = 0.971 +- 0.188 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.912 +- 0.188 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 all KL = 0.941 +- 0.188 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 all L1 = 0.942 +- 0.161 (in-sample avg dev_std = 0.143)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.453204
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.987
NEC for r=0.05 class 0.0 = 0.03 +- 0.112 (in-sample avg dev_std = 0.078)
NEC for r=0.05 class 1.0 = 0.013 +- 0.112 (in-sample avg dev_std = 0.078)
NEC for r=0.05 all KL = 0.022 +- 0.112 (in-sample avg dev_std = 0.078)
NEC for r=0.05 all L1 = 0.02 +- 0.091 (in-sample avg dev_std = 0.078)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.37665
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.986
NEC for r=0.1 class 0.0 = 0.035 +- 0.124 (in-sample avg dev_std = 0.115)
NEC for r=0.1 class 1.0 = 0.009 +- 0.124 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all KL = 0.024 +- 0.124 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all L1 = 0.02 +- 0.090 (in-sample avg dev_std = 0.115)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.248162
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.988
NEC for r=0.2 class 0.0 = 0.033 +- 0.114 (in-sample avg dev_std = 0.106)
NEC for r=0.2 class 1.0 = 0.007 +- 0.114 (in-sample avg dev_std = 0.106)
NEC for r=0.2 all KL = 0.023 +- 0.114 (in-sample avg dev_std = 0.106)
NEC for r=0.2 all L1 = 0.018 +- 0.079 (in-sample avg dev_std = 0.106)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.149492
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.991
NEC for r=0.4 class 0.0 = 0.028 +- 0.087 (in-sample avg dev_std = 0.092)
NEC for r=0.4 class 1.0 = 0.005 +- 0.087 (in-sample avg dev_std = 0.092)
NEC for r=0.4 all KL = 0.016 +- 0.087 (in-sample avg dev_std = 0.092)
NEC for r=0.4 all L1 = 0.016 +- 0.073 (in-sample avg dev_std = 0.092)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10047
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.993
NEC for r=0.8 class 0.0 = 0.021 +- 0.070 (in-sample avg dev_std = 0.075)
NEC for r=0.8 class 1.0 = 0.006 +- 0.070 (in-sample avg dev_std = 0.075)
NEC for r=0.8 all KL = 0.012 +- 0.070 (in-sample avg dev_std = 0.075)
NEC for r=0.8 all L1 = 0.013 +- 0.062 (in-sample avg dev_std = 0.075)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.757
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1520884
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.696
NEC for r=0.05 class 0.0 = 0.015 +- 0.337 (in-sample avg dev_std = 0.416)
NEC for r=0.05 class 1.0 = 0.254 +- 0.337 (in-sample avg dev_std = 0.416)
NEC for r=0.05 all KL = 0.218 +- 0.337 (in-sample avg dev_std = 0.416)
NEC for r=0.05 all L1 = 0.136 +- 0.222 (in-sample avg dev_std = 0.416)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.757
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0831856
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.747
NEC for r=0.1 class 0.0 = 0.01 +- 0.263 (in-sample avg dev_std = 0.333)
NEC for r=0.1 class 1.0 = 0.176 +- 0.263 (in-sample avg dev_std = 0.333)
NEC for r=0.1 all KL = 0.147 +- 0.263 (in-sample avg dev_std = 0.333)
NEC for r=0.1 all L1 = 0.094 +- 0.175 (in-sample avg dev_std = 0.333)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.757
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.045058600000000004
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.77
NEC for r=0.2 class 0.0 = 0.008 +- 0.215 (in-sample avg dev_std = 0.258)
NEC for r=0.2 class 1.0 = 0.136 +- 0.215 (in-sample avg dev_std = 0.258)
NEC for r=0.2 all KL = 0.104 +- 0.215 (in-sample avg dev_std = 0.258)
NEC for r=0.2 all L1 = 0.072 +- 0.157 (in-sample avg dev_std = 0.258)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.757
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024718
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.778
NEC for r=0.4 class 0.0 = 0.007 +- 0.186 (in-sample avg dev_std = 0.210)
NEC for r=0.4 class 1.0 = 0.114 +- 0.186 (in-sample avg dev_std = 0.210)
NEC for r=0.4 all KL = 0.078 +- 0.186 (in-sample avg dev_std = 0.210)
NEC for r=0.4 all L1 = 0.061 +- 0.149 (in-sample avg dev_std = 0.210)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.757
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.014107600000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.779
NEC for r=0.8 class 0.0 = 0.005 +- 0.156 (in-sample avg dev_std = 0.166)
NEC for r=0.8 class 1.0 = 0.097 +- 0.156 (in-sample avg dev_std = 0.166)
NEC for r=0.8 all KL = 0.058 +- 0.156 (in-sample avg dev_std = 0.166)
NEC for r=0.8 all L1 = 0.052 +- 0.139 (in-sample avg dev_std = 0.166)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.658
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25195080000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.576
NEC for r=0.05 class 0.0 = 0.075 +- 0.337 (in-sample avg dev_std = 0.222)
NEC for r=0.05 class 1.0 = 0.198 +- 0.337 (in-sample avg dev_std = 0.222)
NEC for r=0.05 all KL = 0.189 +- 0.337 (in-sample avg dev_std = 0.222)
NEC for r=0.05 all L1 = 0.136 +- 0.258 (in-sample avg dev_std = 0.222)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.658
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1887576
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.612
NEC for r=0.1 class 0.0 = 0.076 +- 0.305 (in-sample avg dev_std = 0.271)
NEC for r=0.1 class 1.0 = 0.153 +- 0.305 (in-sample avg dev_std = 0.271)
NEC for r=0.1 all KL = 0.166 +- 0.305 (in-sample avg dev_std = 0.271)
NEC for r=0.1 all L1 = 0.114 +- 0.218 (in-sample avg dev_std = 0.271)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.658
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.129688
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.629
NEC for r=0.2 class 0.0 = 0.077 +- 0.265 (in-sample avg dev_std = 0.241)
NEC for r=0.2 class 1.0 = 0.105 +- 0.265 (in-sample avg dev_std = 0.241)
NEC for r=0.2 all KL = 0.127 +- 0.265 (in-sample avg dev_std = 0.241)
NEC for r=0.2 all L1 = 0.091 +- 0.194 (in-sample avg dev_std = 0.241)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.658
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09080840000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.634
NEC for r=0.4 class 0.0 = 0.076 +- 0.249 (in-sample avg dev_std = 0.227)
NEC for r=0.4 class 1.0 = 0.089 +- 0.249 (in-sample avg dev_std = 0.227)
NEC for r=0.4 all KL = 0.108 +- 0.249 (in-sample avg dev_std = 0.227)
NEC for r=0.4 all L1 = 0.082 +- 0.188 (in-sample avg dev_std = 0.227)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.658
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08438720000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.642
NEC for r=0.8 class 0.0 = 0.068 +- 0.240 (in-sample avg dev_std = 0.233)
NEC for r=0.8 class 1.0 = 0.083 +- 0.240 (in-sample avg dev_std = 0.233)
NEC for r=0.8 all KL = 0.097 +- 0.240 (in-sample avg dev_std = 0.233)
NEC for r=0.8 all L1 = 0.076 +- 0.181 (in-sample avg dev_std = 0.233)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 22:39:28 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 10:39:28 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 10:39:28 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 10:39:28 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 10:39:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:39:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:39:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:39:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:39:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:39:28 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 10:39:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0000
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0000
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0000
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0000
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.510
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.426
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.318
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.208
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.121
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.241
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.132
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.069
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.037
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.019
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.307
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.241
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.190
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.146
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.106


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.51013
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
SUFF_SIMPLE for r=0.05 class 0.0 = 0.993 +- 0.082 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.082 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.05 all KL = 0.989 +- 0.082 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.05 all L1 = 0.997 +- 0.025 (in-sample avg dev_std = 0.079)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.425676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.999
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.054 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.054 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.1 all KL = 0.996 +- 0.054 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.1 all L1 = 0.998 +- 0.026 (in-sample avg dev_std = 0.056)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.318306
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.999
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.064 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.064 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.2 all KL = 0.994 +- 0.064 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.2 all L1 = 0.998 +- 0.021 (in-sample avg dev_std = 0.062)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.208474
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.999
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.038 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.038 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 all KL = 0.997 +- 0.038 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 all L1 = 0.999 +- 0.012 (in-sample avg dev_std = 0.032)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.120992
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.042 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.042 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.8 all KL = 0.998 +- 0.042 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.8 all L1 = 0.999 +- 0.016 (in-sample avg dev_std = 0.037)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.619
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.24126999999999998
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.778
SUFF_SIMPLE for r=0.05 class 0.0 = 1.0 +- 0.397 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.657 +- 0.397 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.05 all KL = 0.75 +- 0.397 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.05 all L1 = 0.827 +- 0.294 (in-sample avg dev_std = 0.303)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.619
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13151000000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.778
SUFF_SIMPLE for r=0.1 class 0.0 = 1.0 +- 0.397 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.658 +- 0.397 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.1 all KL = 0.75 +- 0.397 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.1 all L1 = 0.828 +- 0.294 (in-sample avg dev_std = 0.302)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.619
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06946799999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.778
SUFF_SIMPLE for r=0.2 class 0.0 = 1.0 +- 0.398 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.657 +- 0.398 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.2 all KL = 0.747 +- 0.398 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.2 all L1 = 0.827 +- 0.293 (in-sample avg dev_std = 0.306)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.619
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03662580000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.775
SUFF_SIMPLE for r=0.4 class 0.0 = 1.0 +- 0.395 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.663 +- 0.395 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.4 all KL = 0.752 +- 0.395 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.4 all L1 = 0.83 +- 0.291 (in-sample avg dev_std = 0.301)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.619
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0193212
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.775
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.385 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.673 +- 0.385 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.8 all KL = 0.775 +- 0.385 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.8 all L1 = 0.835 +- 0.296 (in-sample avg dev_std = 0.254)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.798
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3073686
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.785
SUFF_SIMPLE for r=0.05 class 0.0 = 0.951 +- 0.235 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.952 +- 0.235 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.05 all KL = 0.927 +- 0.235 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.05 all L1 = 0.952 +- 0.156 (in-sample avg dev_std = 0.171)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.798
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.240738
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.785
SUFF_SIMPLE for r=0.1 class 0.0 = 0.953 +- 0.230 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.953 +- 0.230 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.1 all KL = 0.93 +- 0.230 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.1 all L1 = 0.953 +- 0.153 (in-sample avg dev_std = 0.164)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.798
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1904696
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.789
SUFF_SIMPLE for r=0.2 class 0.0 = 0.958 +- 0.195 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.964 +- 0.195 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.2 all KL = 0.95 +- 0.195 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.2 all L1 = 0.961 +- 0.146 (in-sample avg dev_std = 0.137)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.798
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14582580000000003
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.793
SUFF_SIMPLE for r=0.4 class 0.0 = 0.967 +- 0.158 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.974 +- 0.158 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 all KL = 0.966 +- 0.158 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 all L1 = 0.97 +- 0.128 (in-sample avg dev_std = 0.125)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.799
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10550900000000002
len(reference) = 4991
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.808
SUFF_SIMPLE for r=0.8 class 0.0 = 0.994 +- 0.092 (in-sample avg dev_std = 0.029)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.97 +- 0.092 (in-sample avg dev_std = 0.029)
SUFF_SIMPLE for r=0.8 all KL = 0.984 +- 0.092 (in-sample avg dev_std = 0.029)
SUFF_SIMPLE for r=0.8 all L1 = 0.982 +- 0.099 (in-sample avg dev_std = 0.029)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.51013
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.038 (in-sample avg dev_std = 0.025)
NEC for r=0.05 class 1.0 = 0.002 +- 0.038 (in-sample avg dev_std = 0.025)
NEC for r=0.05 all KL = 0.002 +- 0.038 (in-sample avg dev_std = 0.025)
NEC for r=0.05 all L1 = 0.001 +- 0.014 (in-sample avg dev_std = 0.025)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.425676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.318306
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 0.0 = 0.0 +- 0.001 (in-sample avg dev_std = 0.001)
NEC for r=0.2 class 1.0 = 0.0 +- 0.001 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all KL = 0.0 +- 0.001 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.208474
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  1.0
NEC for r=0.4 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.120992
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
NEC for r=0.8 class 0.0 = 0.0 +- 0.002 (in-sample avg dev_std = 0.002)
NEC for r=0.8 class 1.0 = 0.0 +- 0.002 (in-sample avg dev_std = 0.002)
NEC for r=0.8 all KL = 0.0 +- 0.002 (in-sample avg dev_std = 0.002)
NEC for r=0.8 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.002)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.619
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.24126999999999998
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.593
NEC for r=0.05 class 0.0 = 0.0 +- 0.325 (in-sample avg dev_std = 0.390)
NEC for r=0.05 class 1.0 = 0.237 +- 0.325 (in-sample avg dev_std = 0.390)
NEC for r=0.05 all KL = 0.184 +- 0.325 (in-sample avg dev_std = 0.390)
NEC for r=0.05 all L1 = 0.12 +- 0.221 (in-sample avg dev_std = 0.390)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.619
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13151000000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.645
NEC for r=0.1 class 0.0 = 0.0 +- 0.313 (in-sample avg dev_std = 0.378)
NEC for r=0.1 class 1.0 = 0.225 +- 0.313 (in-sample avg dev_std = 0.378)
NEC for r=0.1 all KL = 0.186 +- 0.313 (in-sample avg dev_std = 0.378)
NEC for r=0.1 all L1 = 0.114 +- 0.204 (in-sample avg dev_std = 0.378)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.619
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06946799999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.669
NEC for r=0.2 class 0.0 = 0.0 +- 0.304 (in-sample avg dev_std = 0.337)
NEC for r=0.2 class 1.0 = 0.211 +- 0.304 (in-sample avg dev_std = 0.337)
NEC for r=0.2 all KL = 0.17 +- 0.304 (in-sample avg dev_std = 0.337)
NEC for r=0.2 all L1 = 0.106 +- 0.204 (in-sample avg dev_std = 0.337)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.619
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03662580000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.682
NEC for r=0.4 class 0.0 = 0.0 +- 0.300 (in-sample avg dev_std = 0.303)
NEC for r=0.4 class 1.0 = 0.203 +- 0.300 (in-sample avg dev_std = 0.303)
NEC for r=0.4 all KL = 0.158 +- 0.300 (in-sample avg dev_std = 0.303)
NEC for r=0.4 all L1 = 0.102 +- 0.208 (in-sample avg dev_std = 0.303)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.619
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0193212
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.689
NEC for r=0.8 class 0.0 = 0.0 +- 0.300 (in-sample avg dev_std = 0.289)
NEC for r=0.8 class 1.0 = 0.198 +- 0.300 (in-sample avg dev_std = 0.289)
NEC for r=0.8 all KL = 0.155 +- 0.300 (in-sample avg dev_std = 0.289)
NEC for r=0.8 all L1 = 0.1 +- 0.208 (in-sample avg dev_std = 0.289)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.798
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3073686
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.714
NEC for r=0.05 class 0.0 = 0.028 +- 0.402 (in-sample avg dev_std = 0.386)
NEC for r=0.05 class 1.0 = 0.296 +- 0.402 (in-sample avg dev_std = 0.386)
NEC for r=0.05 all KL = 0.245 +- 0.402 (in-sample avg dev_std = 0.386)
NEC for r=0.05 all L1 = 0.16 +- 0.282 (in-sample avg dev_std = 0.386)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.798
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.240738
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.762
NEC for r=0.1 class 0.0 = 0.038 +- 0.335 (in-sample avg dev_std = 0.329)
NEC for r=0.1 class 1.0 = 0.162 +- 0.335 (in-sample avg dev_std = 0.329)
NEC for r=0.1 all KL = 0.178 +- 0.335 (in-sample avg dev_std = 0.329)
NEC for r=0.1 all L1 = 0.099 +- 0.210 (in-sample avg dev_std = 0.329)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.798
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1904696
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.776
NEC for r=0.2 class 0.0 = 0.04 +- 0.265 (in-sample avg dev_std = 0.251)
NEC for r=0.2 class 1.0 = 0.085 +- 0.265 (in-sample avg dev_std = 0.251)
NEC for r=0.2 all KL = 0.108 +- 0.265 (in-sample avg dev_std = 0.251)
NEC for r=0.2 all L1 = 0.062 +- 0.170 (in-sample avg dev_std = 0.251)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.798
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14582580000000003
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.783
NEC for r=0.4 class 0.0 = 0.039 +- 0.218 (in-sample avg dev_std = 0.203)
NEC for r=0.4 class 1.0 = 0.05 +- 0.218 (in-sample avg dev_std = 0.203)
NEC for r=0.4 all KL = 0.071 +- 0.218 (in-sample avg dev_std = 0.203)
NEC for r=0.4 all L1 = 0.044 +- 0.145 (in-sample avg dev_std = 0.203)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.798
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10550900000000002
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.789
NEC for r=0.8 class 0.0 = 0.034 +- 0.194 (in-sample avg dev_std = 0.180)
NEC for r=0.8 class 1.0 = 0.034 +- 0.194 (in-sample avg dev_std = 0.180)
NEC for r=0.8 all KL = 0.056 +- 0.194 (in-sample avg dev_std = 0.180)
NEC for r=0.8 all L1 = 0.034 +- 0.122 (in-sample avg dev_std = 0.180)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 22:55:17 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 10:55:17 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 10:55:17 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 10:55:17 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 10:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:55:17 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 10:55:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0002
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0002
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0002
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0002

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0002
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0002
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0002
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0002

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.535
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.500
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.370
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.241
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.147
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.238
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.130
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.070
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.037
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.020
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.349
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.292
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.223
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.168
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.127


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5350560000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.997
SUFF_SIMPLE for r=0.05 class 0.0 = 0.988 +- 0.101 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.101 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.05 all KL = 0.987 +- 0.101 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.05 all L1 = 0.994 +- 0.048 (in-sample avg dev_std = 0.087)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.499676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.998
SUFF_SIMPLE for r=0.1 class 0.0 = 0.991 +- 0.089 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.089 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.1 all KL = 0.989 +- 0.089 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.1 all L1 = 0.996 +- 0.039 (in-sample avg dev_std = 0.074)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.36993
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.998
SUFF_SIMPLE for r=0.2 class 0.0 = 0.992 +- 0.077 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.077 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.2 all KL = 0.991 +- 0.077 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.2 all L1 = 0.996 +- 0.039 (in-sample avg dev_std = 0.064)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.240702
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.998
SUFF_SIMPLE for r=0.4 class 0.0 = 0.991 +- 0.090 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.090 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.4 all KL = 0.988 +- 0.090 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.4 all L1 = 0.996 +- 0.032 (in-sample avg dev_std = 0.079)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.146824
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.998
SUFF_SIMPLE for r=0.8 class 0.0 = 0.992 +- 0.077 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.077 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.8 all KL = 0.992 +- 0.077 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.8 all L1 = 0.997 +- 0.038 (in-sample avg dev_std = 0.051)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.564
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.23845619999999998
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.702
SUFF_SIMPLE for r=0.05 class 0.0 = 1.0 +- 0.386 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.7 +- 0.386 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.05 all KL = 0.77 +- 0.386 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.05 all L1 = 0.849 +- 0.278 (in-sample avg dev_std = 0.281)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.564
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13016
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.704
SUFF_SIMPLE for r=0.1 class 0.0 = 1.0 +- 0.388 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.695 +- 0.388 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.1 all KL = 0.765 +- 0.388 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.1 all L1 = 0.846 +- 0.280 (in-sample avg dev_std = 0.279)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.564
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0701918
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.708
SUFF_SIMPLE for r=0.2 class 0.0 = 1.0 +- 0.389 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.69 +- 0.389 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.2 all KL = 0.766 +- 0.389 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.2 all L1 = 0.844 +- 0.284 (in-sample avg dev_std = 0.274)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.564
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.037450199999999996
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.709
SUFF_SIMPLE for r=0.4 class 0.0 = 1.0 +- 0.390 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.688 +- 0.390 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.4 all KL = 0.767 +- 0.390 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.4 all L1 = 0.843 +- 0.286 (in-sample avg dev_std = 0.267)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.564
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0201228
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.729
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.395 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.663 +- 0.395 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.8 all KL = 0.769 +- 0.395 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.8 all L1 = 0.83 +- 0.306 (in-sample avg dev_std = 0.227)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.771
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.34878200000000004
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.741
SUFF_SIMPLE for r=0.05 class 0.0 = 0.942 +- 0.267 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.914 +- 0.267 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.05 all KL = 0.905 +- 0.267 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.05 all L1 = 0.928 +- 0.201 (in-sample avg dev_std = 0.205)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.771
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2917014
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.741
SUFF_SIMPLE for r=0.1 class 0.0 = 0.941 +- 0.264 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.917 +- 0.264 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.1 all KL = 0.909 +- 0.264 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.1 all L1 = 0.929 +- 0.202 (in-sample avg dev_std = 0.199)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.771
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.22268539999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.736
SUFF_SIMPLE for r=0.2 class 0.0 = 0.943 +- 0.261 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.914 +- 0.261 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all KL = 0.91 +- 0.261 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all L1 = 0.929 +- 0.205 (in-sample avg dev_std = 0.147)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.771
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1677538
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.758
SUFF_SIMPLE for r=0.4 class 0.0 = 0.952 +- 0.200 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.959 +- 0.200 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.4 all KL = 0.944 +- 0.200 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.4 all L1 = 0.955 +- 0.154 (in-sample avg dev_std = 0.132)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.772
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1269028
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.771
SUFF_SIMPLE for r=0.8 class 0.0 = 0.972 +- 0.163 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.956 +- 0.163 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.8 all KL = 0.962 +- 0.163 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.8 all L1 = 0.964 +- 0.141 (in-sample avg dev_std = 0.067)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5350560000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.994
NEC for r=0.05 class 0.0 = 0.0 +- 0.105 (in-sample avg dev_std = 0.109)
NEC for r=0.05 class 1.0 = 0.014 +- 0.105 (in-sample avg dev_std = 0.109)
NEC for r=0.05 all KL = 0.016 +- 0.105 (in-sample avg dev_std = 0.109)
NEC for r=0.05 all L1 = 0.008 +- 0.054 (in-sample avg dev_std = 0.109)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.499676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.998
NEC for r=0.1 class 0.0 = 0.0 +- 0.062 (in-sample avg dev_std = 0.071)
NEC for r=0.1 class 1.0 = 0.006 +- 0.062 (in-sample avg dev_std = 0.071)
NEC for r=0.1 all KL = 0.007 +- 0.062 (in-sample avg dev_std = 0.071)
NEC for r=0.1 all L1 = 0.003 +- 0.026 (in-sample avg dev_std = 0.071)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.36993
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.999
NEC for r=0.2 class 0.0 = 0.0 +- 0.031 (in-sample avg dev_std = 0.040)
NEC for r=0.2 class 1.0 = 0.002 +- 0.031 (in-sample avg dev_std = 0.040)
NEC for r=0.2 all KL = 0.002 +- 0.031 (in-sample avg dev_std = 0.040)
NEC for r=0.2 all L1 = 0.001 +- 0.013 (in-sample avg dev_std = 0.040)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.240702
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.998
NEC for r=0.4 class 0.0 = 0.0 +- 0.057 (in-sample avg dev_std = 0.062)
NEC for r=0.4 class 1.0 = 0.004 +- 0.057 (in-sample avg dev_std = 0.062)
NEC for r=0.4 all KL = 0.005 +- 0.057 (in-sample avg dev_std = 0.062)
NEC for r=0.4 all L1 = 0.002 +- 0.025 (in-sample avg dev_std = 0.062)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.146824
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.0 +- 0.051 (in-sample avg dev_std = 0.061)
NEC for r=0.8 class 1.0 = 0.003 +- 0.051 (in-sample avg dev_std = 0.061)
NEC for r=0.8 all KL = 0.004 +- 0.051 (in-sample avg dev_std = 0.061)
NEC for r=0.8 all L1 = 0.002 +- 0.023 (in-sample avg dev_std = 0.061)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.564
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.23845619999999998
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.546
NEC for r=0.05 class 0.0 = 0.0 +- 0.271 (in-sample avg dev_std = 0.303)
NEC for r=0.05 class 1.0 = 0.157 +- 0.271 (in-sample avg dev_std = 0.303)
NEC for r=0.05 all KL = 0.123 +- 0.271 (in-sample avg dev_std = 0.303)
NEC for r=0.05 all L1 = 0.079 +- 0.186 (in-sample avg dev_std = 0.303)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.564
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13016
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.576
NEC for r=0.1 class 0.0 = 0.0 +- 0.266 (in-sample avg dev_std = 0.305)
NEC for r=0.1 class 1.0 = 0.155 +- 0.266 (in-sample avg dev_std = 0.305)
NEC for r=0.1 all KL = 0.126 +- 0.266 (in-sample avg dev_std = 0.305)
NEC for r=0.1 all L1 = 0.078 +- 0.175 (in-sample avg dev_std = 0.305)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.564
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0701918
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.592
NEC for r=0.2 class 0.0 = 0.0 +- 0.262 (in-sample avg dev_std = 0.286)
NEC for r=0.2 class 1.0 = 0.149 +- 0.262 (in-sample avg dev_std = 0.286)
NEC for r=0.2 all KL = 0.123 +- 0.262 (in-sample avg dev_std = 0.286)
NEC for r=0.2 all L1 = 0.075 +- 0.171 (in-sample avg dev_std = 0.286)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.564
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.037450199999999996
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.607
NEC for r=0.4 class 0.0 = 0.0 +- 0.271 (in-sample avg dev_std = 0.266)
NEC for r=0.4 class 1.0 = 0.152 +- 0.271 (in-sample avg dev_std = 0.266)
NEC for r=0.4 all KL = 0.126 +- 0.271 (in-sample avg dev_std = 0.266)
NEC for r=0.4 all L1 = 0.077 +- 0.178 (in-sample avg dev_std = 0.266)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.564
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0201228
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.614
NEC for r=0.8 class 0.0 = 0.0 +- 0.272 (in-sample avg dev_std = 0.244)
NEC for r=0.8 class 1.0 = 0.151 +- 0.272 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all KL = 0.124 +- 0.272 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all L1 = 0.076 +- 0.181 (in-sample avg dev_std = 0.244)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.771
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.34878200000000004
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.653
NEC for r=0.05 class 0.0 = 0.021 +- 0.372 (in-sample avg dev_std = 0.268)
NEC for r=0.05 class 1.0 = 0.292 +- 0.372 (in-sample avg dev_std = 0.268)
NEC for r=0.05 all KL = 0.193 +- 0.372 (in-sample avg dev_std = 0.268)
NEC for r=0.05 all L1 = 0.155 +- 0.300 (in-sample avg dev_std = 0.268)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.771
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2917014
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.739
NEC for r=0.1 class 0.0 = 0.023 +- 0.305 (in-sample avg dev_std = 0.314)
NEC for r=0.1 class 1.0 = 0.17 +- 0.305 (in-sample avg dev_std = 0.314)
NEC for r=0.1 all KL = 0.153 +- 0.305 (in-sample avg dev_std = 0.314)
NEC for r=0.1 all L1 = 0.096 +- 0.200 (in-sample avg dev_std = 0.314)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.771
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.22268539999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.764
NEC for r=0.2 class 0.0 = 0.029 +- 0.223 (in-sample avg dev_std = 0.239)
NEC for r=0.2 class 1.0 = 0.087 +- 0.223 (in-sample avg dev_std = 0.239)
NEC for r=0.2 all KL = 0.091 +- 0.223 (in-sample avg dev_std = 0.239)
NEC for r=0.2 all L1 = 0.058 +- 0.148 (in-sample avg dev_std = 0.239)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.771
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1677538
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.751
NEC for r=0.4 class 0.0 = 0.038 +- 0.229 (in-sample avg dev_std = 0.210)
NEC for r=0.4 class 1.0 = 0.082 +- 0.229 (in-sample avg dev_std = 0.210)
NEC for r=0.4 all KL = 0.085 +- 0.229 (in-sample avg dev_std = 0.210)
NEC for r=0.4 all L1 = 0.06 +- 0.170 (in-sample avg dev_std = 0.210)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.771
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1269028
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.759
NEC for r=0.8 class 0.0 = 0.035 +- 0.194 (in-sample avg dev_std = 0.193)
NEC for r=0.8 class 1.0 = 0.046 +- 0.194 (in-sample avg dev_std = 0.193)
NEC for r=0.8 all KL = 0.059 +- 0.194 (in-sample avg dev_std = 0.193)
NEC for r=0.8 all L1 = 0.04 +- 0.133 (in-sample avg dev_std = 0.193)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:11:16 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 11:11:16 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 11:11:16 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:11:16 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 11:11:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:11:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:11:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:11:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:11:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:11:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:11:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.389
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.320
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.224
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.135
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.170
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.095
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.030
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.015
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.246
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.191
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.139
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.103
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.38880200000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.996
SUFF_SIMPLE for r=0.05 class 0.0 = 0.988 +- 0.098 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.098 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.05 all KL = 0.986 +- 0.098 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.05 all L1 = 0.994 +- 0.050 (in-sample avg dev_std = 0.082)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.31998800000000005
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.997
SUFF_SIMPLE for r=0.1 class 0.0 = 0.991 +- 0.086 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.086 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.1 all KL = 0.99 +- 0.086 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.1 all L1 = 0.996 +- 0.043 (in-sample avg dev_std = 0.080)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.224438
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.996
SUFF_SIMPLE for r=0.2 class 0.0 = 0.989 +- 0.089 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.089 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.2 all KL = 0.99 +- 0.089 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.2 all L1 = 0.995 +- 0.051 (in-sample avg dev_std = 0.079)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.13499599999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.998
SUFF_SIMPLE for r=0.4 class 0.0 = 0.991 +- 0.087 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.087 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.4 all KL = 0.989 +- 0.087 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.4 all L1 = 0.996 +- 0.037 (in-sample avg dev_std = 0.082)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07880200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.998
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.063 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.063 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 all KL = 0.995 +- 0.063 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 all L1 = 0.998 +- 0.025 (in-sample avg dev_std = 0.052)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.999
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.169573
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.995
SUFF_SIMPLE for r=0.05 class 0.0 = 0.982 +- 0.156 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.998 +- 0.156 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all KL = 0.968 +- 0.156 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all L1 = 0.99 +- 0.052 (in-sample avg dev_std = 0.139)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0945816
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.995
SUFF_SIMPLE for r=0.1 class 0.0 = 0.984 +- 0.148 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.998 +- 0.148 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.1 all KL = 0.971 +- 0.148 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.1 all L1 = 0.991 +- 0.049 (in-sample avg dev_std = 0.131)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.999
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05013100000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.996
SUFF_SIMPLE for r=0.2 class 0.0 = 0.985 +- 0.143 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.998 +- 0.143 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.2 all KL = 0.972 +- 0.143 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.2 all L1 = 0.991 +- 0.047 (in-sample avg dev_std = 0.126)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.999
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.029687800000000004
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.996
SUFF_SIMPLE for r=0.4 class 0.0 = 0.985 +- 0.141 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.998 +- 0.141 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 all KL = 0.974 +- 0.141 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 all L1 = 0.992 +- 0.047 (in-sample avg dev_std = 0.125)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.999
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.015123000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.988
SUFF_SIMPLE for r=0.8 class 0.0 = 0.972 +- 0.146 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.998 +- 0.146 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.8 all KL = 0.976 +- 0.146 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.8 all L1 = 0.985 +- 0.097 (in-sample avg dev_std = 0.117)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.975
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2455962
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.954
SUFF_SIMPLE for r=0.05 class 0.0 = 0.957 +- 0.161 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.161 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.05 all KL = 0.971 +- 0.161 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.05 all L1 = 0.978 +- 0.124 (in-sample avg dev_std = 0.102)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.975
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.191233
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.954
SUFF_SIMPLE for r=0.1 class 0.0 = 0.958 +- 0.160 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.160 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.1 all KL = 0.971 +- 0.160 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.1 all L1 = 0.979 +- 0.124 (in-sample avg dev_std = 0.099)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.975
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.138973
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.954
SUFF_SIMPLE for r=0.2 class 0.0 = 0.959 +- 0.158 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.158 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.2 all KL = 0.972 +- 0.158 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.2 all L1 = 0.979 +- 0.124 (in-sample avg dev_std = 0.096)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.975
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10286400000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.956
SUFF_SIMPLE for r=0.4 class 0.0 = 0.961 +- 0.152 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.152 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.4 all KL = 0.974 +- 0.152 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.4 all L1 = 0.98 +- 0.120 (in-sample avg dev_std = 0.098)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.977
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0797904
len(reference) = 4961
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.972
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.076 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.076 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.8 all KL = 0.993 +- 0.076 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.8 all L1 = 0.994 +- 0.065 (in-sample avg dev_std = 0.015)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.38880200000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.001 +- 0.029 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.029 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.001 +- 0.029 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.001 +- 0.011 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.31998800000000005
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.1 class 1.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.1 all KL = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.1 all L1 = 0.0 +- 0.003 (in-sample avg dev_std = 0.006)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.224438
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 0.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.2 class 1.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.2 all KL = 0.001 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.2 all L1 = 0.0 +- 0.003 (in-sample avg dev_std = 0.006)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.13499599999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  1.0
NEC for r=0.4 class 0.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.4 class 1.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.4 all KL = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.4 all L1 = 0.0 +- 0.003 (in-sample avg dev_std = 0.006)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07880200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
NEC for r=0.8 class 0.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.8 class 1.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.8 all KL = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.8 all L1 = 0.0 +- 0.003 (in-sample avg dev_std = 0.006)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.999
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.169573
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.965
NEC for r=0.05 class 0.0 = 0.06 +- 0.313 (in-sample avg dev_std = 0.341)
NEC for r=0.05 class 1.0 = 0.056 +- 0.313 (in-sample avg dev_std = 0.341)
NEC for r=0.05 all KL = 0.155 +- 0.313 (in-sample avg dev_std = 0.341)
NEC for r=0.05 all L1 = 0.058 +- 0.127 (in-sample avg dev_std = 0.341)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0945816
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.984
NEC for r=0.1 class 0.0 = 0.046 +- 0.239 (in-sample avg dev_std = 0.228)
NEC for r=0.1 class 1.0 = 0.007 +- 0.239 (in-sample avg dev_std = 0.228)
NEC for r=0.1 all KL = 0.078 +- 0.239 (in-sample avg dev_std = 0.228)
NEC for r=0.1 all L1 = 0.026 +- 0.087 (in-sample avg dev_std = 0.228)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.999
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05013100000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.993
NEC for r=0.2 class 0.0 = 0.024 +- 0.180 (in-sample avg dev_std = 0.162)
NEC for r=0.2 class 1.0 = 0.003 +- 0.180 (in-sample avg dev_std = 0.162)
NEC for r=0.2 all KL = 0.044 +- 0.180 (in-sample avg dev_std = 0.162)
NEC for r=0.2 all L1 = 0.014 +- 0.059 (in-sample avg dev_std = 0.162)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.999
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.029687800000000004
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.998
NEC for r=0.4 class 0.0 = 0.007 +- 0.097 (in-sample avg dev_std = 0.084)
NEC for r=0.4 class 1.0 = 0.002 +- 0.097 (in-sample avg dev_std = 0.084)
NEC for r=0.4 all KL = 0.013 +- 0.097 (in-sample avg dev_std = 0.084)
NEC for r=0.4 all L1 = 0.004 +- 0.036 (in-sample avg dev_std = 0.084)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.999
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.015123000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.003 +- 0.066 (in-sample avg dev_std = 0.056)
NEC for r=0.8 class 1.0 = 0.002 +- 0.066 (in-sample avg dev_std = 0.056)
NEC for r=0.8 all KL = 0.006 +- 0.066 (in-sample avg dev_std = 0.056)
NEC for r=0.8 all L1 = 0.002 +- 0.028 (in-sample avg dev_std = 0.056)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.975
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2455962
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.931
NEC for r=0.05 class 0.0 = 0.033 +- 0.263 (in-sample avg dev_std = 0.170)
NEC for r=0.05 class 1.0 = 0.081 +- 0.263 (in-sample avg dev_std = 0.170)
NEC for r=0.05 all KL = 0.085 +- 0.263 (in-sample avg dev_std = 0.170)
NEC for r=0.05 all L1 = 0.056 +- 0.189 (in-sample avg dev_std = 0.170)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.975
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.191233
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.952
NEC for r=0.1 class 0.0 = 0.049 +- 0.212 (in-sample avg dev_std = 0.133)
NEC for r=0.1 class 1.0 = 0.023 +- 0.212 (in-sample avg dev_std = 0.133)
NEC for r=0.1 all KL = 0.055 +- 0.212 (in-sample avg dev_std = 0.133)
NEC for r=0.1 all L1 = 0.036 +- 0.152 (in-sample avg dev_std = 0.133)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.975
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.138973
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.959
NEC for r=0.2 class 0.0 = 0.041 +- 0.173 (in-sample avg dev_std = 0.127)
NEC for r=0.2 class 1.0 = 0.005 +- 0.173 (in-sample avg dev_std = 0.127)
NEC for r=0.2 all KL = 0.036 +- 0.173 (in-sample avg dev_std = 0.127)
NEC for r=0.2 all L1 = 0.023 +- 0.123 (in-sample avg dev_std = 0.127)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.975
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10286400000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.961
NEC for r=0.4 class 0.0 = 0.034 +- 0.150 (in-sample avg dev_std = 0.118)
NEC for r=0.4 class 1.0 = 0.001 +- 0.150 (in-sample avg dev_std = 0.118)
NEC for r=0.4 all KL = 0.027 +- 0.150 (in-sample avg dev_std = 0.118)
NEC for r=0.4 all L1 = 0.018 +- 0.105 (in-sample avg dev_std = 0.118)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.975
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0797904
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.963
NEC for r=0.8 class 0.0 = 0.03 +- 0.139 (in-sample avg dev_std = 0.113)
NEC for r=0.8 class 1.0 = 0.0 +- 0.139 (in-sample avg dev_std = 0.113)
NEC for r=0.8 all KL = 0.023 +- 0.139 (in-sample avg dev_std = 0.113)
NEC for r=0.8 all L1 = 0.015 +- 0.098 (in-sample avg dev_std = 0.113)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.967, 0.968, 0.974, 0.974, 0.967], 'all_L1': [0.982, 0.981, 0.985, 0.986, 0.98]}), defaultdict(<class 'list'>, {'all_KL': [0.956, 0.956, 0.96, 0.974, 0.966], 'all_L1': [0.985, 0.983, 0.985, 0.99, 0.986]}), defaultdict(<class 'list'>, {'all_KL': [0.972, 0.976, 0.976, 0.975, 0.972], 'all_L1': [0.991, 0.992, 0.992, 0.991, 0.99]}), defaultdict(<class 'list'>, {'all_KL': [0.945, 0.947, 0.945, 0.937, 0.897], 'all_L1': [0.98, 0.981, 0.979, 0.976, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.979, 0.97, 0.975, 0.976, 0.966], 'all_L1': [0.991, 0.989, 0.99, 0.991, 0.986]}), defaultdict(<class 'list'>, {'all_KL': [0.957, 0.958, 0.964, 0.979, 0.983], 'all_L1': [0.974, 0.976, 0.978, 0.985, 0.987]}), defaultdict(<class 'list'>, {'all_KL': [0.939, 0.942, 0.948, 0.962, 0.975], 'all_L1': [0.962, 0.964, 0.967, 0.974, 0.982]}), defaultdict(<class 'list'>, {'all_KL': [0.989, 0.996, 0.994, 0.997, 0.998], 'all_L1': [0.997, 0.998, 0.998, 0.999, 0.999]}), defaultdict(<class 'list'>, {'all_KL': [0.987, 0.989, 0.991, 0.988, 0.992], 'all_L1': [0.994, 0.996, 0.996, 0.996, 0.997]}), defaultdict(<class 'list'>, {'all_KL': [0.986, 0.99, 0.99, 0.989, 0.995], 'all_L1': [0.994, 0.996, 0.995, 0.996, 0.998]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.007, 0.006, 0.007, 0.007, 0.009], 'all_L1': [0.006, 0.005, 0.006, 0.006, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.002, 0.004, 0.004], 'all_L1': [0.0, 0.0, 0.0, 0.001, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.003, 0.002, 0.003, 0.002], 'all_L1': [0.0, 0.001, 0.0, 0.001, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.015, 0.014, 0.008, 0.006, 0.005], 'all_L1': [0.006, 0.005, 0.003, 0.002, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.0, 0.0, 0.002], 'all_L1': [0.0, 0.0, 0.0, 0.0, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.03, 0.022, 0.021, 0.017, 0.009], 'all_L1': [0.024, 0.018, 0.015, 0.013, 0.009]}), defaultdict(<class 'list'>, {'all_KL': [0.022, 0.024, 0.023, 0.016, 0.012], 'all_L1': [0.02, 0.02, 0.018, 0.016, 0.013]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.0, 0.0, 0.0, 0.0], 'all_L1': [0.001, 0.0, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.016, 0.007, 0.002, 0.005, 0.004], 'all_L1': [0.008, 0.003, 0.001, 0.002, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.001, 0.0, 0.001, 0.0, 0.0], 'all_L1': [0.001, 0.0, 0.0, 0.0, 0.0]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.974, 0.975, 0.975, 0.971, 0.972], 'all_L1': [0.973, 0.974, 0.974, 0.972, 0.973]}), defaultdict(<class 'list'>, {'all_KL': [0.953, 0.951, 0.947, 0.946, 0.949], 'all_L1': [0.985, 0.984, 0.983, 0.982, 0.982]}), defaultdict(<class 'list'>, {'all_KL': [0.948, 0.95, 0.942, 0.939, 0.92], 'all_L1': [0.98, 0.981, 0.978, 0.977, 0.968]}), defaultdict(<class 'list'>, {'all_KL': [0.816, 0.817, 0.818, 0.811, 0.77], 'all_L1': [0.923, 0.923, 0.921, 0.915, 0.861]}), defaultdict(<class 'list'>, {'all_KL': [0.726, 0.726, 0.724, 0.712, 0.689], 'all_L1': [0.793, 0.792, 0.79, 0.78, 0.751]}), defaultdict(<class 'list'>, {'all_KL': [0.898, 0.901, 0.899, 0.898, 0.88], 'all_L1': [0.904, 0.905, 0.904, 0.903, 0.895]}), defaultdict(<class 'list'>, {'all_KL': [0.873, 0.877, 0.878, 0.877, 0.864], 'all_L1': [0.91, 0.912, 0.912, 0.912, 0.903]}), defaultdict(<class 'list'>, {'all_KL': [0.75, 0.75, 0.747, 0.752, 0.775], 'all_L1': [0.827, 0.828, 0.827, 0.83, 0.835]}), defaultdict(<class 'list'>, {'all_KL': [0.77, 0.765, 0.766, 0.767, 0.769], 'all_L1': [0.849, 0.846, 0.844, 0.843, 0.83]}), defaultdict(<class 'list'>, {'all_KL': [0.968, 0.971, 0.972, 0.974, 0.976], 'all_L1': [0.99, 0.991, 0.991, 0.992, 0.985]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.118, 0.056, 0.027, 0.013, 0.008], 'all_L1': [0.067, 0.036, 0.022, 0.015, 0.012]}), defaultdict(<class 'list'>, {'all_KL': [0.062, 0.012, 0.006, 0.006, 0.008], 'all_L1': [0.026, 0.006, 0.004, 0.003, 0.004]}), defaultdict(<class 'list'>, {'all_KL': [0.075, 0.022, 0.013, 0.008, 0.009], 'all_L1': [0.032, 0.011, 0.007, 0.006, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.075, 0.062, 0.06, 0.059, 0.047], 'all_L1': [0.033, 0.022, 0.02, 0.018, 0.014]}), defaultdict(<class 'list'>, {'all_KL': [0.264, 0.221, 0.201, 0.176, 0.17], 'all_L1': [0.166, 0.146, 0.132, 0.118, 0.114]}), defaultdict(<class 'list'>, {'all_KL': [0.268, 0.157, 0.088, 0.057, 0.04], 'all_L1': [0.173, 0.115, 0.08, 0.063, 0.056]}), defaultdict(<class 'list'>, {'all_KL': [0.218, 0.147, 0.104, 0.078, 0.058], 'all_L1': [0.136, 0.094, 0.072, 0.061, 0.052]}), defaultdict(<class 'list'>, {'all_KL': [0.184, 0.186, 0.17, 0.158, 0.155], 'all_L1': [0.12, 0.114, 0.106, 0.102, 0.1]}), defaultdict(<class 'list'>, {'all_KL': [0.123, 0.126, 0.123, 0.126, 0.124], 'all_L1': [0.079, 0.078, 0.075, 0.077, 0.076]}), defaultdict(<class 'list'>, {'all_KL': [0.155, 0.078, 0.044, 0.013, 0.006], 'all_L1': [0.058, 0.026, 0.014, 0.004, 0.002]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.902, 0.906, 0.909, 0.929, 0.947], 'all_L1': [0.9, 0.903, 0.903, 0.918, 0.925]}), defaultdict(<class 'list'>, {'all_KL': [0.946, 0.946, 0.946, 0.943, 0.948], 'all_L1': [0.96, 0.96, 0.959, 0.958, 0.966]}), defaultdict(<class 'list'>, {'all_KL': [0.96, 0.959, 0.963, 0.964, 0.987], 'all_L1': [0.97, 0.97, 0.972, 0.973, 0.987]}), defaultdict(<class 'list'>, {'all_KL': [0.934, 0.936, 0.955, 0.967, 0.986], 'all_L1': [0.96, 0.961, 0.969, 0.977, 0.991]}), defaultdict(<class 'list'>, {'all_KL': [0.951, 0.949, 0.953, 0.952, 0.955], 'all_L1': [0.961, 0.961, 0.963, 0.962, 0.965]}), defaultdict(<class 'list'>, {'all_KL': [0.869, 0.873, 0.884, 0.897, 0.945], 'all_L1': [0.884, 0.887, 0.892, 0.9, 0.931]}), defaultdict(<class 'list'>, {'all_KL': [0.856, 0.867, 0.875, 0.891, 0.941], 'all_L1': [0.886, 0.891, 0.896, 0.909, 0.942]}), defaultdict(<class 'list'>, {'all_KL': [0.927, 0.93, 0.95, 0.966, 0.984], 'all_L1': [0.952, 0.953, 0.961, 0.97, 0.982]}), defaultdict(<class 'list'>, {'all_KL': [0.905, 0.909, 0.91, 0.944, 0.962], 'all_L1': [0.928, 0.929, 0.929, 0.955, 0.964]}), defaultdict(<class 'list'>, {'all_KL': [0.971, 0.971, 0.972, 0.974, 0.993], 'all_L1': [0.978, 0.979, 0.979, 0.98, 0.994]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.235, 0.187, 0.123, 0.093, 0.077], 'all_L1': [0.226, 0.17, 0.117, 0.091, 0.075]}), defaultdict(<class 'list'>, {'all_KL': [0.175, 0.091, 0.048, 0.034, 0.03], 'all_L1': [0.107, 0.059, 0.036, 0.027, 0.023]}), defaultdict(<class 'list'>, {'all_KL': [0.194, 0.104, 0.061, 0.042, 0.033], 'all_L1': [0.131, 0.072, 0.044, 0.031, 0.022]}), defaultdict(<class 'list'>, {'all_KL': [0.158, 0.057, 0.035, 0.032, 0.033], 'all_L1': [0.082, 0.033, 0.023, 0.02, 0.02]}), defaultdict(<class 'list'>, {'all_KL': [0.142, 0.064, 0.032, 0.024, 0.024], 'all_L1': [0.096, 0.046, 0.028, 0.022, 0.02]}), defaultdict(<class 'list'>, {'all_KL': [0.138, 0.145, 0.121, 0.101, 0.094], 'all_L1': [0.138, 0.131, 0.108, 0.092, 0.082]}), defaultdict(<class 'list'>, {'all_KL': [0.189, 0.166, 0.127, 0.108, 0.097], 'all_L1': [0.136, 0.114, 0.091, 0.082, 0.076]}), defaultdict(<class 'list'>, {'all_KL': [0.245, 0.178, 0.108, 0.071, 0.056], 'all_L1': [0.16, 0.099, 0.062, 0.044, 0.034]}), defaultdict(<class 'list'>, {'all_KL': [0.193, 0.153, 0.091, 0.085, 0.059], 'all_L1': [0.155, 0.096, 0.058, 0.06, 0.04]}), defaultdict(<class 'list'>, {'all_KL': [0.085, 0.055, 0.036, 0.027, 0.023], 'all_L1': [0.056, 0.036, 0.023, 0.018, 0.015]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.985 +- 0.010, 0.986 +- 0.010, 0.986 +- 0.009, 0.988 +- 0.008, 0.986 +- 0.012
suff_simple class all_KL  =  0.968 +- 0.017, 0.969 +- 0.018, 0.972 +- 0.016, 0.975 +- 0.016, 0.971 +- 0.027
[[0.9894999861717224, 0.9890000224113464, 0.9922500252723694, 0.9927499890327454, 0.9860000014305115], [0.9907500147819519, 0.9892500042915344, 0.9904999732971191, 0.9934999942779541, 0.9907500147819519], [0.9950000047683716, 0.9947500228881836, 0.9952499866485596, 0.9937499761581421, 0.9932500123977661], [0.9867500066757202, 0.9887499809265137, 0.9857500195503235, 0.9837499856948853, 0.968999981880188], [0.9940000176429749, 0.9934999942779541, 0.9929999709129333, 0.9940000176429749, 0.9904999732971191], [0.9869999885559082, 0.9894999861717224, 0.9879999756813049, 0.9942499995231628, 0.9965000152587891], [0.9739999771118164, 0.9787499904632568, 0.9794999957084656, 0.9860000014305115, 0.9884999990463257], [0.9980000257492065, 0.9990000128746033, 0.9990000128746033, 0.9994999766349792, 0.9994999766349792], [0.9965000152587891, 0.9977499842643738, 0.9975000023841858, 0.9982500076293945, 0.9980000257492065], [0.9959999918937683, 0.9972500205039978, 0.9962499737739563, 0.9975000023841858, 0.9984999895095825]]
[[0.967, 0.968, 0.974, 0.974, 0.967], [0.956, 0.956, 0.96, 0.974, 0.966], [0.972, 0.976, 0.976, 0.975, 0.972], [0.945, 0.947, 0.945, 0.937, 0.897], [0.979, 0.97, 0.975, 0.976, 0.966], [0.957, 0.958, 0.964, 0.979, 0.983], [0.939, 0.942, 0.948, 0.962, 0.975], [0.989, 0.996, 0.994, 0.997, 0.998], [0.987, 0.989, 0.991, 0.988, 0.992], [0.986, 0.99, 0.99, 0.989, 0.995]]
suff_simple_acc_int  =  0.991 +- 0.007, 0.992 +- 0.006, 0.992 +- 0.006, 0.993 +- 0.005, 0.991 +- 0.009
nec class all_L1  =  0.007 +- 0.008, 0.005 +- 0.007, 0.004 +- 0.006, 0.004 +- 0.006, 0.003 +- 0.004
nec class all_KL  =  0.009 +- 0.010, 0.008 +- 0.009, 0.007 +- 0.008, 0.006 +- 0.006, 0.005 +- 0.004
[[0.9965000152587891, 0.9962499737739563, 0.9952499866485596, 0.9959999918937683, 0.9957500100135803], [1.0, 1.0, 0.999750018119812, 0.9990000128746033, 0.9992499947547913], [0.999750018119812, 0.9994999766349792, 0.999750018119812, 0.9994999766349792, 0.999750018119812], [0.996999979019165, 0.9975000023841858, 0.9987499713897705, 0.9992499947547913, 0.9994999766349792], [1.0, 1.0, 1.0, 1.0, 0.9992499947547913], [0.9884999990463257, 0.9927499890327454, 0.9937499761581421, 0.9942499995231628, 0.9955000281333923], [0.9869999885559082, 0.9860000014305115, 0.9882500171661377, 0.9909999966621399, 0.9934999942779541], [1.0, 1.0, 1.0, 1.0, 1.0], [0.9944999814033508, 0.9982500076293945, 0.9994999766349792, 0.9984999895095825, 0.9987499713897705], [1.0, 1.0, 1.0, 1.0, 1.0]]
[[0.007, 0.006, 0.007, 0.007, 0.009], [0.0, 0.0, 0.002, 0.004, 0.004], [0.002, 0.003, 0.002, 0.003, 0.002], [0.015, 0.014, 0.008, 0.006, 0.005], [0.0, 0.0, 0.0, 0.0, 0.002], [0.03, 0.022, 0.021, 0.017, 0.009], [0.022, 0.024, 0.023, 0.016, 0.012], [0.002, 0.0, 0.0, 0.0, 0.0], [0.016, 0.007, 0.002, 0.005, 0.004], [0.001, 0.0, 0.001, 0.0, 0.0]]
nec_acc_int  =  0.996 +- 0.005, 0.997 +- 0.004, 0.997 +- 0.004, 0.998 +- 0.003, 0.998 +- 0.002

Eval split val
suff_simple class all_L1  =  0.913 +- 0.067, 0.914 +- 0.068, 0.912 +- 0.068, 0.911 +- 0.069, 0.898 +- 0.075
suff_simple class all_KL  =  0.868 +- 0.091, 0.868 +- 0.092, 0.867 +- 0.091, 0.865 +- 0.092, 0.856 +- 0.095
[[0.8396499752998352, 0.8394749760627747, 0.8394500017166138, 0.8387749791145325, 0.8376500010490417], [0.9919999837875366, 0.991599977016449, 0.9909499883651733, 0.9903249740600586, 0.9896249771118164], [0.9913250207901001, 0.9919499754905701, 0.9899749755859375, 0.9892500042915344, 0.9827250242233276], [0.9049500226974487, 0.9048500061035156, 0.9030249714851379, 0.897849977016449, 0.8381999731063843], [0.8909249901771545, 0.892300009727478, 0.8952249884605408, 0.9058250188827515, 0.9405249953269958], [0.9185749888420105, 0.918524980545044, 0.9173499941825867, 0.916100025177002, 0.9017500281333923], [0.8150249719619751, 0.8148499727249146, 0.8144749999046326, 0.8143249750137329, 0.8177750110626221], [0.7782999873161316, 0.7775999903678894, 0.7779250144958496, 0.7751500010490417, 0.7749000191688538], [0.7015249729156494, 0.7038499712944031, 0.7080749869346619, 0.7089250087738037, 0.7291250228881836], [0.9947749972343445, 0.9953749775886536, 0.9957249760627747, 0.9957500100135803, 0.9881250262260437]]
[[0.974, 0.975, 0.975, 0.971, 0.972], [0.953, 0.951, 0.947, 0.946, 0.949], [0.948, 0.95, 0.942, 0.939, 0.92], [0.816, 0.817, 0.818, 0.811, 0.77], [0.726, 0.726, 0.724, 0.712, 0.689], [0.898, 0.901, 0.899, 0.898, 0.88], [0.873, 0.877, 0.878, 0.877, 0.864], [0.75, 0.75, 0.747, 0.752, 0.775], [0.77, 0.765, 0.766, 0.767, 0.769], [0.968, 0.971, 0.972, 0.974, 0.976]]
suff_simple_acc_int  =  0.883 +- 0.094, 0.883 +- 0.094, 0.883 +- 0.093, 0.883 +- 0.093, 0.880 +- 0.089
nec class all_L1  =  0.089 +- 0.053, 0.065 +- 0.048, 0.053 +- 0.043, 0.047 +- 0.041, 0.044 +- 0.040
nec class all_KL  =  0.154 +- 0.073, 0.107 +- 0.067, 0.084 +- 0.063, 0.069 +- 0.061, 0.062 +- 0.061
[[0.805649995803833, 0.8245999813079834, 0.8333500027656555, 0.8379499912261963, 0.839900016784668], [0.984624981880188, 0.9969499707221985, 0.9987499713897705, 0.9991000294685364, 0.9987000226974487], [0.9824749827384949, 0.9958750009536743, 0.9983500242233276, 0.9987499713897705, 0.998449981212616], [0.934499979019165, 0.9434999823570251, 0.9453750252723694, 0.9464750289916992, 0.9492499828338623], [0.778249979019165, 0.7999250292778015, 0.7952749729156494, 0.7846750020980835, 0.782925009727478], [0.8678249716758728, 0.9069499969482422, 0.9291250109672546, 0.9359250068664551, 0.9394749999046326], [0.6957250237464905, 0.746874988079071, 0.7700250148773193, 0.7777500152587891, 0.7793750166893005], [0.592674970626831, 0.6446750164031982, 0.6687250137329102, 0.682200014591217, 0.6887000203132629], [0.5464000105857849, 0.5755500197410583, 0.5924249887466431, 0.6073750257492065, 0.6142749786376953], [0.9645000100135803, 0.9844499826431274, 0.9926999807357788, 0.998075008392334, 0.9991499781608582]]
[[0.118, 0.056, 0.027, 0.013, 0.008], [0.062, 0.012, 0.006, 0.006, 0.008], [0.075, 0.022, 0.013, 0.008, 0.009], [0.075, 0.062, 0.06, 0.059, 0.047], [0.264, 0.221, 0.201, 0.176, 0.17], [0.268, 0.157, 0.088, 0.057, 0.04], [0.218, 0.147, 0.104, 0.078, 0.058], [0.184, 0.186, 0.17, 0.158, 0.155], [0.123, 0.126, 0.123, 0.126, 0.124], [0.155, 0.078, 0.044, 0.013, 0.006]]
nec_acc_int  =  0.815 +- 0.153, 0.842 +- 0.143, 0.852 +- 0.137, 0.857 +- 0.134, 0.859 +- 0.132

Eval split test
suff_simple class all_L1  =  0.938 +- 0.034, 0.939 +- 0.033, 0.942 +- 0.032, 0.950 +- 0.028, 0.965 +- 0.024
suff_simple class all_KL  =  0.922 +- 0.036, 0.925 +- 0.033, 0.932 +- 0.033, 0.943 +- 0.028, 0.965 +- 0.019
[[0.8097858428955078, 0.8121373057365417, 0.8092355132102966, 0.8212677836418152, 0.8365172743797302], [0.8788022994995117, 0.8800280094146729, 0.8780518174171448, 0.8790774345397949, 0.9084705114364624], [0.9531969428062439, 0.9532469511032104, 0.9553481936454773, 0.956223726272583, 0.9749899506568909], [0.9462177157402039, 0.9469931721687317, 0.9492445588111877, 0.9524214267730713, 0.9654004573822021], [0.8136382102966309, 0.8148388862609863, 0.8146888017654419, 0.8151640892028809, 0.841554582118988], [0.6453121900558472, 0.6455122828483582, 0.6445617079734802, 0.6610716581344604, 0.6690645813941956], [0.6374574899673462, 0.6390084028244019, 0.6361066699028015, 0.6475885510444641, 0.6643615961074829], [0.7849459648132324, 0.7851710915565491, 0.7894737124443054, 0.79302579164505, 0.8082298040390015], [0.7406944036483765, 0.7409695982933044, 0.7356663942337036, 0.7578046917915344, 0.7713640928268433], [0.9536471962928772, 0.9536221623420715, 0.9544476866722107, 0.955573320388794, 0.9718806743621826]]
[[0.902, 0.906, 0.909, 0.929, 0.947], [0.946, 0.946, 0.946, 0.943, 0.948], [0.96, 0.959, 0.963, 0.964, 0.987], [0.934, 0.936, 0.955, 0.967, 0.986], [0.951, 0.949, 0.953, 0.952, 0.955], [0.869, 0.873, 0.884, 0.897, 0.945], [0.856, 0.867, 0.875, 0.891, 0.941], [0.927, 0.93, 0.95, 0.966, 0.984], [0.905, 0.909, 0.91, 0.944, 0.962], [0.971, 0.971, 0.972, 0.974, 0.993]]
suff_simple_acc_int  =  0.816 +- 0.112, 0.817 +- 0.112, 0.817 +- 0.114, 0.824 +- 0.108, 0.841 +- 0.110
nec class all_L1  =  0.129 +- 0.045, 0.086 +- 0.042, 0.059 +- 0.033, 0.049 +- 0.029, 0.041 +- 0.025
nec class all_KL  =  0.175 +- 0.045, 0.120 +- 0.049, 0.078 +- 0.038, 0.062 +- 0.032, 0.053 +- 0.027
[[0.6824594736099243, 0.7528016567230225, 0.7888733148574829, 0.8039323687553406, 0.8139883875846863], [0.8357264399528503, 0.8725985884666443, 0.8824544548988342, 0.8847308158874512, 0.8857314586639404], [0.8932609558105469, 0.9421152472496033, 0.9535220861434937, 0.9561986923217773, 0.9616269469261169], [0.9325595498085022, 0.9648538827896118, 0.9640534520149231, 0.9615269303321838, 0.959625780582428], [0.7794926762580872, 0.8215178847312927, 0.8235191106796265, 0.8219681978225708, 0.8204672932624817], [0.5719181299209595, 0.5929808020591736, 0.6219981908798218, 0.6384580731391907, 0.6465129256248474], [0.5758705139160156, 0.6116169691085815, 0.6289273500442505, 0.6342555284500122, 0.6416099667549133], [0.7140284180641174, 0.7618070840835571, 0.7755403518676758, 0.7825445532798767, 0.7894486784934998], [0.6531168818473816, 0.739418625831604, 0.7638332843780518, 0.7514258623123169, 0.7594306468963623], [0.9312587380409241, 0.952446460723877, 0.9591004848480225, 0.9611517190933228, 0.9630028009414673]]
[[0.235, 0.187, 0.123, 0.093, 0.077], [0.175, 0.091, 0.048, 0.034, 0.03], [0.194, 0.104, 0.061, 0.042, 0.033], [0.158, 0.057, 0.035, 0.032, 0.033], [0.142, 0.064, 0.032, 0.024, 0.024], [0.138, 0.145, 0.121, 0.101, 0.094], [0.189, 0.166, 0.127, 0.108, 0.097], [0.245, 0.178, 0.108, 0.071, 0.056], [0.193, 0.153, 0.091, 0.085, 0.059], [0.085, 0.055, 0.036, 0.027, 0.023]]
nec_acc_int  =  0.757 +- 0.131, 0.801 +- 0.127, 0.816 +- 0.120, 0.820 +- 0.117, 0.824 +- 0.114


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.496 +- 0.003, 0.495 +- 0.003, 0.495 +- 0.003, 0.496 +- 0.003, 0.495 +- 0.006
Faith. Armon (L1)= 		  =  0.013 +- 0.016, 0.010 +- 0.014, 0.008 +- 0.013, 0.008 +- 0.011, 0.007 +- 0.008
Faith. GMean (L1)= 	  =  0.060 +- 0.054, 0.050 +- 0.051, 0.042 +- 0.050, 0.047 +- 0.043, 0.044 +- 0.038
Faith. Aritm (KL)= 		  =  0.489 +- 0.007, 0.488 +- 0.007, 0.489 +- 0.006, 0.490 +- 0.007, 0.488 +- 0.013
Faith. Armon (KL)= 		  =  0.019 +- 0.020, 0.015 +- 0.017, 0.013 +- 0.016, 0.011 +- 0.012, 0.009 +- 0.008
Faith. GMean (KL)= 	  =  0.076 +- 0.058, 0.062 +- 0.058, 0.062 +- 0.049, 0.060 +- 0.045, 0.058 +- 0.035

Eval split val
Faith. Aritm (L1)= 		  =  0.501 +- 0.024, 0.489 +- 0.018, 0.483 +- 0.016, 0.479 +- 0.016, 0.471 +- 0.022
Faith. Armon (L1)= 		  =  0.157 +- 0.086, 0.116 +- 0.082, 0.096 +- 0.075, 0.085 +- 0.072, 0.079 +- 0.070
Faith. GMean (L1)= 	  =  0.269 +- 0.080, 0.219 +- 0.092, 0.194 +- 0.090, 0.177 +- 0.093, 0.167 +- 0.092
Faith. Aritm (KL)= 		  =  0.511 +- 0.046, 0.487 +- 0.030, 0.475 +- 0.022, 0.467 +- 0.019, 0.459 +- 0.025
Faith. Armon (KL)= 		  =  0.253 +- 0.102, 0.180 +- 0.104, 0.144 +- 0.099, 0.120 +- 0.098, 0.108 +- 0.098
Faith. GMean (KL)= 	  =  0.353 +- 0.082, 0.281 +- 0.097, 0.240 +- 0.097, 0.210 +- 0.102, 0.194 +- 0.103

Eval split test
Faith. Aritm (L1)= 		  =  0.533 +- 0.018, 0.513 +- 0.011, 0.501 +- 0.006, 0.499 +- 0.005, 0.503 +- 0.005
Faith. Armon (L1)= 		  =  0.223 +- 0.068, 0.154 +- 0.069, 0.109 +- 0.058, 0.091 +- 0.051, 0.077 +- 0.046
Faith. GMean (L1)= 	  =  0.341 +- 0.058, 0.274 +- 0.066, 0.225 +- 0.062, 0.205 +- 0.060, 0.188 +- 0.057
Faith. Aritm (KL)= 		  =  0.549 +- 0.024, 0.522 +- 0.017, 0.505 +- 0.011, 0.502 +- 0.010, 0.509 +- 0.011
Faith. Armon (KL)= 		  =  0.292 +- 0.064, 0.208 +- 0.077, 0.142 +- 0.064, 0.114 +- 0.055, 0.098 +- 0.048
Faith. GMean (KL)= 	  =  0.398 +- 0.053, 0.324 +- 0.067, 0.260 +- 0.064, 0.232 +- 0.060, 0.218 +- 0.056
Computed for split load_split = id



Completed in  2:39:11.670215  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GL-GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:29:49 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 11:29:49 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 11:29:49 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:29:49 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 11:29:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:29:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:29:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:29:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:29:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:29:49 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:29:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.617
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.703
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.741
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.749
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.747
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.700
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.696
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.695
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.695
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.695
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.589
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.631
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.656
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.671
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.676


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.617022
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.024 (in-sample avg dev_std = 0.029)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.024 (in-sample avg dev_std = 0.029)
SUFF_SIMPLE for r=0.05 all KL = 0.999 +- 0.024 (in-sample avg dev_std = 0.029)
SUFF_SIMPLE for r=0.05 all L1 = 0.999 +- 0.009 (in-sample avg dev_std = 0.029)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.702622
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.999
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.028 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.028 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.1 all KL = 0.998 +- 0.028 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.1 all L1 = 0.999 +- 0.010 (in-sample avg dev_std = 0.031)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.74054
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.035 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.035 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.2 all KL = 0.998 +- 0.035 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.2 all L1 = 0.999 +- 0.015 (in-sample avg dev_std = 0.034)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7490539999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.999
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.037 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.037 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.4 all KL = 0.998 +- 0.037 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.4 all L1 = 0.999 +- 0.014 (in-sample avg dev_std = 0.044)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.746838
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6998616
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.997
SUFF_SIMPLE for r=0.05 class 0.0 = 0.987 +- 0.090 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.090 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.05 all KL = 0.984 +- 0.090 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.05 all L1 = 0.994 +- 0.033 (in-sample avg dev_std = 0.104)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6956418000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.997
SUFF_SIMPLE for r=0.1 class 0.0 = 0.989 +- 0.081 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.081 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.1 all KL = 0.986 +- 0.081 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.1 all L1 = 0.995 +- 0.030 (in-sample avg dev_std = 0.094)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6948674
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.998
SUFF_SIMPLE for r=0.2 class 0.0 = 0.99 +- 0.078 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.078 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.2 all KL = 0.988 +- 0.078 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.2 all L1 = 0.995 +- 0.029 (in-sample avg dev_std = 0.090)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6948222
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.998
SUFF_SIMPLE for r=0.4 class 0.0 = 0.99 +- 0.078 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.078 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.4 all KL = 0.988 +- 0.078 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.4 all L1 = 0.995 +- 0.030 (in-sample avg dev_std = 0.089)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6948219999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.998
SUFF_SIMPLE for r=0.8 class 0.0 = 0.992 +- 0.073 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.073 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.8 all KL = 0.99 +- 0.073 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.8 all L1 = 0.996 +- 0.030 (in-sample avg dev_std = 0.081)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5890152
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.96
SUFF_SIMPLE for r=0.05 class 0.0 = 0.952 +- 0.177 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.997 +- 0.177 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.05 all KL = 0.964 +- 0.177 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.05 all L1 = 0.974 +- 0.133 (in-sample avg dev_std = 0.143)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6307624
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.96
SUFF_SIMPLE for r=0.1 class 0.0 = 0.952 +- 0.175 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.998 +- 0.175 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.1 all KL = 0.965 +- 0.175 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.1 all L1 = 0.974 +- 0.133 (in-sample avg dev_std = 0.129)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6556327999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.959
SUFF_SIMPLE for r=0.2 class 0.0 = 0.952 +- 0.170 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.170 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.2 all KL = 0.968 +- 0.170 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.2 all L1 = 0.975 +- 0.135 (in-sample avg dev_std = 0.108)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6706832
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.96
SUFF_SIMPLE for r=0.4 class 0.0 = 0.955 +- 0.161 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.161 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.4 all KL = 0.971 +- 0.161 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.4 all L1 = 0.977 +- 0.132 (in-sample avg dev_std = 0.085)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6757221999999999
len(reference) = 4905
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.973
SUFF_SIMPLE for r=0.8 class 0.0 = 0.979 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.988 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.989 +- 0.092 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.617022
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.018 (in-sample avg dev_std = 0.001)
NEC for r=0.05 class 1.0 = 0.001 +- 0.018 (in-sample avg dev_std = 0.001)
NEC for r=0.05 all KL = 0.001 +- 0.018 (in-sample avg dev_std = 0.001)
NEC for r=0.05 all L1 = 0.0 +- 0.010 (in-sample avg dev_std = 0.001)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.702622
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.1 class 1.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.1 all KL = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.1 all L1 = 0.0 +- 0.005 (in-sample avg dev_std = 0.006)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.74054
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 0.0 = 0.0 +- 0.008 (in-sample avg dev_std = 0.006)
NEC for r=0.2 class 1.0 = 0.0 +- 0.008 (in-sample avg dev_std = 0.006)
NEC for r=0.2 all KL = 0.0 +- 0.008 (in-sample avg dev_std = 0.006)
NEC for r=0.2 all L1 = 0.0 +- 0.004 (in-sample avg dev_std = 0.006)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7490539999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  1.0
NEC for r=0.4 class 0.0 = 0.0 +- 0.003 (in-sample avg dev_std = 0.004)
NEC for r=0.4 class 1.0 = 0.0 +- 0.003 (in-sample avg dev_std = 0.004)
NEC for r=0.4 all KL = 0.0 +- 0.003 (in-sample avg dev_std = 0.004)
NEC for r=0.4 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.004)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.746838
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
NEC for r=0.8 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6998616
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.984
NEC for r=0.05 class 0.0 = 0.005 +- 0.174 (in-sample avg dev_std = 0.228)
NEC for r=0.05 class 1.0 = 0.049 +- 0.174 (in-sample avg dev_std = 0.228)
NEC for r=0.05 all KL = 0.057 +- 0.174 (in-sample avg dev_std = 0.228)
NEC for r=0.05 all L1 = 0.027 +- 0.082 (in-sample avg dev_std = 0.228)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6956418000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.996
NEC for r=0.1 class 0.0 = 0.006 +- 0.087 (in-sample avg dev_std = 0.109)
NEC for r=0.1 class 1.0 = 0.008 +- 0.087 (in-sample avg dev_std = 0.109)
NEC for r=0.1 all KL = 0.015 +- 0.087 (in-sample avg dev_std = 0.109)
NEC for r=0.1 all L1 = 0.007 +- 0.038 (in-sample avg dev_std = 0.109)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6948674
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.998
NEC for r=0.2 class 0.0 = 0.005 +- 0.065 (in-sample avg dev_std = 0.079)
NEC for r=0.2 class 1.0 = 0.002 +- 0.065 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all KL = 0.009 +- 0.065 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all L1 = 0.004 +- 0.026 (in-sample avg dev_std = 0.079)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6948222
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.999
NEC for r=0.4 class 0.0 = 0.004 +- 0.047 (in-sample avg dev_std = 0.057)
NEC for r=0.4 class 1.0 = 0.0 +- 0.047 (in-sample avg dev_std = 0.057)
NEC for r=0.4 all KL = 0.005 +- 0.047 (in-sample avg dev_std = 0.057)
NEC for r=0.4 all L1 = 0.002 +- 0.018 (in-sample avg dev_std = 0.057)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6948219999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.002 +- 0.037 (in-sample avg dev_std = 0.044)
NEC for r=0.8 class 1.0 = 0.0 +- 0.037 (in-sample avg dev_std = 0.044)
NEC for r=0.8 all KL = 0.003 +- 0.037 (in-sample avg dev_std = 0.044)
NEC for r=0.8 all L1 = 0.001 +- 0.014 (in-sample avg dev_std = 0.044)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5890152
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.935
NEC for r=0.05 class 0.0 = 0.016 +- 0.286 (in-sample avg dev_std = 0.272)
NEC for r=0.05 class 1.0 = 0.135 +- 0.286 (in-sample avg dev_std = 0.272)
NEC for r=0.05 all KL = 0.121 +- 0.286 (in-sample avg dev_std = 0.272)
NEC for r=0.05 all L1 = 0.074 +- 0.197 (in-sample avg dev_std = 0.272)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6307624
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.966
NEC for r=0.1 class 0.0 = 0.02 +- 0.220 (in-sample avg dev_std = 0.199)
NEC for r=0.1 class 1.0 = 0.063 +- 0.220 (in-sample avg dev_std = 0.199)
NEC for r=0.1 all KL = 0.068 +- 0.220 (in-sample avg dev_std = 0.199)
NEC for r=0.1 all L1 = 0.041 +- 0.150 (in-sample avg dev_std = 0.199)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6556327999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.979
NEC for r=0.2 class 0.0 = 0.025 +- 0.173 (in-sample avg dev_std = 0.144)
NEC for r=0.2 class 1.0 = 0.027 +- 0.173 (in-sample avg dev_std = 0.144)
NEC for r=0.2 all KL = 0.041 +- 0.173 (in-sample avg dev_std = 0.144)
NEC for r=0.2 all L1 = 0.026 +- 0.123 (in-sample avg dev_std = 0.144)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6706832
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.965
NEC for r=0.4 class 0.0 = 0.034 +- 0.203 (in-sample avg dev_std = 0.167)
NEC for r=0.4 class 1.0 = 0.034 +- 0.203 (in-sample avg dev_std = 0.167)
NEC for r=0.4 all KL = 0.05 +- 0.203 (in-sample avg dev_std = 0.167)
NEC for r=0.4 all L1 = 0.034 +- 0.148 (in-sample avg dev_std = 0.167)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6757221999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.974
NEC for r=0.8 class 0.0 = 0.03 +- 0.150 (in-sample avg dev_std = 0.158)
NEC for r=0.8 class 1.0 = 0.004 +- 0.150 (in-sample avg dev_std = 0.158)
NEC for r=0.8 all KL = 0.03 +- 0.150 (in-sample avg dev_std = 0.158)
NEC for r=0.8 all L1 = 0.017 +- 0.094 (in-sample avg dev_std = 0.158)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:48:58 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 11:48:58 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 11:48:58 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:48:58 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 11:48:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:48:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:48:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:48:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:48:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:48:58 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:48:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.591
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.671
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.686
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.666
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.645
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.661
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.632
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.614
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.608
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.608
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.589
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.638
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.666
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.676
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.671


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.590782
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.999
SUFF_SIMPLE for r=0.05 class 0.0 = 0.995 +- 0.063 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.063 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.05 all KL = 0.994 +- 0.063 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.05 all L1 = 0.998 +- 0.022 (in-sample avg dev_std = 0.071)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.67062
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.998
SUFF_SIMPLE for r=0.1 class 0.0 = 0.995 +- 0.068 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.068 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.1 all KL = 0.993 +- 0.068 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.1 all L1 = 0.997 +- 0.024 (in-sample avg dev_std = 0.077)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.686376
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.028 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.028 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 all KL = 0.999 +- 0.028 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 all L1 = 1.0 +- 0.010 (in-sample avg dev_std = 0.032)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.665924
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.999
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.040 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.040 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.4 all KL = 0.997 +- 0.040 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.4 all L1 = 0.999 +- 0.014 (in-sample avg dev_std = 0.045)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6453420000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6606139999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.996
SUFF_SIMPLE for r=0.05 class 0.0 = 0.985 +- 0.112 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.112 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.05 all KL = 0.98 +- 0.112 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.05 all L1 = 0.993 +- 0.041 (in-sample avg dev_std = 0.124)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.631517
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.996
SUFF_SIMPLE for r=0.1 class 0.0 = 0.985 +- 0.111 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.111 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all KL = 0.98 +- 0.111 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all L1 = 0.993 +- 0.040 (in-sample avg dev_std = 0.123)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.613718
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.997
SUFF_SIMPLE for r=0.2 class 0.0 = 0.99 +- 0.094 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.094 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.2 all KL = 0.985 +- 0.094 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.2 all L1 = 0.995 +- 0.033 (in-sample avg dev_std = 0.105)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6084058
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.996
SUFF_SIMPLE for r=0.4 class 0.0 = 0.986 +- 0.109 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.109 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.4 all KL = 0.981 +- 0.109 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.4 all L1 = 0.993 +- 0.040 (in-sample avg dev_std = 0.121)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6081776
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.998
SUFF_SIMPLE for r=0.8 class 0.0 = 0.992 +- 0.082 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.082 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.8 all KL = 0.99 +- 0.082 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.8 all L1 = 0.996 +- 0.030 (in-sample avg dev_std = 0.090)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5885536
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.972
SUFF_SIMPLE for r=0.05 class 0.0 = 0.959 +- 0.181 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.994 +- 0.181 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 all KL = 0.961 +- 0.181 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 all L1 = 0.976 +- 0.120 (in-sample avg dev_std = 0.178)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6379520000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.974
SUFF_SIMPLE for r=0.1 class 0.0 = 0.96 +- 0.172 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.997 +- 0.172 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.1 all KL = 0.965 +- 0.172 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.1 all L1 = 0.978 +- 0.115 (in-sample avg dev_std = 0.165)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6657922000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.975
SUFF_SIMPLE for r=0.2 class 0.0 = 0.965 +- 0.162 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.997 +- 0.162 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.2 all KL = 0.97 +- 0.162 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.2 all L1 = 0.981 +- 0.113 (in-sample avg dev_std = 0.146)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6764781999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.975
SUFF_SIMPLE for r=0.4 class 0.0 = 0.968 +- 0.152 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.996 +- 0.152 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.4 all KL = 0.974 +- 0.152 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.4 all L1 = 0.982 +- 0.112 (in-sample avg dev_std = 0.122)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.991
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.67089
len(reference) = 4925
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.985
SUFF_SIMPLE for r=0.8 class 0.0 = 0.99 +- 0.090 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.996 +- 0.090 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.8 all KL = 0.992 +- 0.090 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.8 all L1 = 0.993 +- 0.077 (in-sample avg dev_std = 0.006)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.590782
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.961
NEC for r=0.05 class 0.0 = 0.0 +- 0.234 (in-sample avg dev_std = 0.219)
NEC for r=0.05 class 1.0 = 0.078 +- 0.234 (in-sample avg dev_std = 0.219)
NEC for r=0.05 all KL = 0.068 +- 0.234 (in-sample avg dev_std = 0.219)
NEC for r=0.05 all L1 = 0.043 +- 0.161 (in-sample avg dev_std = 0.219)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.67062
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.975
NEC for r=0.1 class 0.0 = 0.0 +- 0.209 (in-sample avg dev_std = 0.230)
NEC for r=0.1 class 1.0 = 0.057 +- 0.209 (in-sample avg dev_std = 0.230)
NEC for r=0.1 all KL = 0.054 +- 0.209 (in-sample avg dev_std = 0.230)
NEC for r=0.1 all L1 = 0.031 +- 0.130 (in-sample avg dev_std = 0.230)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.686376
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.987
NEC for r=0.2 class 0.0 = 0.0 +- 0.169 (in-sample avg dev_std = 0.199)
NEC for r=0.2 class 1.0 = 0.035 +- 0.169 (in-sample avg dev_std = 0.199)
NEC for r=0.2 all KL = 0.039 +- 0.169 (in-sample avg dev_std = 0.199)
NEC for r=0.2 all L1 = 0.019 +- 0.090 (in-sample avg dev_std = 0.199)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.665924
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.995
NEC for r=0.4 class 0.0 = 0.0 +- 0.115 (in-sample avg dev_std = 0.141)
NEC for r=0.4 class 1.0 = 0.016 +- 0.115 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all KL = 0.021 +- 0.115 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all L1 = 0.009 +- 0.049 (in-sample avg dev_std = 0.141)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6453420000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.997
NEC for r=0.8 class 0.0 = 0.0 +- 0.089 (in-sample avg dev_std = 0.110)
NEC for r=0.8 class 1.0 = 0.01 +- 0.089 (in-sample avg dev_std = 0.110)
NEC for r=0.8 all KL = 0.013 +- 0.089 (in-sample avg dev_std = 0.110)
NEC for r=0.8 all L1 = 0.005 +- 0.039 (in-sample avg dev_std = 0.110)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6606139999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.978
NEC for r=0.05 class 0.0 = 0.027 +- 0.219 (in-sample avg dev_std = 0.269)
NEC for r=0.05 class 1.0 = 0.042 +- 0.219 (in-sample avg dev_std = 0.269)
NEC for r=0.05 all KL = 0.078 +- 0.219 (in-sample avg dev_std = 0.269)
NEC for r=0.05 all L1 = 0.035 +- 0.103 (in-sample avg dev_std = 0.269)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.631517
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.99
NEC for r=0.1 class 0.0 = 0.024 +- 0.166 (in-sample avg dev_std = 0.193)
NEC for r=0.1 class 1.0 = 0.011 +- 0.166 (in-sample avg dev_std = 0.193)
NEC for r=0.1 all KL = 0.044 +- 0.166 (in-sample avg dev_std = 0.193)
NEC for r=0.1 all L1 = 0.018 +- 0.068 (in-sample avg dev_std = 0.193)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.613718
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.993
NEC for r=0.2 class 0.0 = 0.021 +- 0.143 (in-sample avg dev_std = 0.164)
NEC for r=0.2 class 1.0 = 0.004 +- 0.143 (in-sample avg dev_std = 0.164)
NEC for r=0.2 all KL = 0.033 +- 0.143 (in-sample avg dev_std = 0.164)
NEC for r=0.2 all L1 = 0.013 +- 0.056 (in-sample avg dev_std = 0.164)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6084058
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.996
NEC for r=0.4 class 0.0 = 0.014 +- 0.114 (in-sample avg dev_std = 0.129)
NEC for r=0.4 class 1.0 = 0.002 +- 0.114 (in-sample avg dev_std = 0.129)
NEC for r=0.4 all KL = 0.021 +- 0.114 (in-sample avg dev_std = 0.129)
NEC for r=0.4 all L1 = 0.008 +- 0.042 (in-sample avg dev_std = 0.129)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6081776
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.998
NEC for r=0.8 class 0.0 = 0.005 +- 0.069 (in-sample avg dev_std = 0.078)
NEC for r=0.8 class 1.0 = 0.0 +- 0.069 (in-sample avg dev_std = 0.078)
NEC for r=0.8 all KL = 0.008 +- 0.069 (in-sample avg dev_std = 0.078)
NEC for r=0.8 all L1 = 0.003 +- 0.024 (in-sample avg dev_std = 0.078)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5885536
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.9
NEC for r=0.05 class 0.0 = 0.015 +- 0.327 (in-sample avg dev_std = 0.246)
NEC for r=0.05 class 1.0 = 0.188 +- 0.327 (in-sample avg dev_std = 0.246)
NEC for r=0.05 all KL = 0.141 +- 0.327 (in-sample avg dev_std = 0.246)
NEC for r=0.05 all L1 = 0.1 +- 0.252 (in-sample avg dev_std = 0.246)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6379520000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.92
NEC for r=0.1 class 0.0 = 0.019 +- 0.294 (in-sample avg dev_std = 0.200)
NEC for r=0.1 class 1.0 = 0.141 +- 0.294 (in-sample avg dev_std = 0.200)
NEC for r=0.1 all KL = 0.11 +- 0.294 (in-sample avg dev_std = 0.200)
NEC for r=0.1 all L1 = 0.079 +- 0.230 (in-sample avg dev_std = 0.200)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6657922000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.93
NEC for r=0.2 class 0.0 = 0.027 +- 0.284 (in-sample avg dev_std = 0.203)
NEC for r=0.2 class 1.0 = 0.118 +- 0.284 (in-sample avg dev_std = 0.203)
NEC for r=0.2 all KL = 0.1 +- 0.284 (in-sample avg dev_std = 0.203)
NEC for r=0.2 all L1 = 0.072 +- 0.219 (in-sample avg dev_std = 0.203)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6764781999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.946
NEC for r=0.4 class 0.0 = 0.033 +- 0.264 (in-sample avg dev_std = 0.232)
NEC for r=0.4 class 1.0 = 0.083 +- 0.264 (in-sample avg dev_std = 0.232)
NEC for r=0.4 all KL = 0.088 +- 0.264 (in-sample avg dev_std = 0.232)
NEC for r=0.4 all L1 = 0.058 +- 0.190 (in-sample avg dev_std = 0.232)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.67089
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.972
NEC for r=0.8 class 0.0 = 0.03 +- 0.213 (in-sample avg dev_std = 0.243)
NEC for r=0.8 class 1.0 = 0.035 +- 0.213 (in-sample avg dev_std = 0.243)
NEC for r=0.8 all KL = 0.063 +- 0.213 (in-sample avg dev_std = 0.243)
NEC for r=0.8 all L1 = 0.032 +- 0.119 (in-sample avg dev_std = 0.243)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:07:54 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 12:07:54 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 12:07:54 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:07:54 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 12:07:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:07:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:07:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:07:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:07:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:07:54 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:07:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.568
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.647
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.663
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.643
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.624
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.625
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.593
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.578
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.575
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.575
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.577
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.632
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.662
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.673
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.667


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5684980000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
SUFF_SIMPLE for r=0.05 class 0.0 = 0.994 +- 0.069 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.998 +- 0.069 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.05 all KL = 0.991 +- 0.069 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.05 all L1 = 0.996 +- 0.031 (in-sample avg dev_std = 0.093)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6473920000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.997
SUFF_SIMPLE for r=0.1 class 0.0 = 0.99 +- 0.082 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.082 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.1 all KL = 0.988 +- 0.082 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.1 all L1 = 0.995 +- 0.037 (in-sample avg dev_std = 0.109)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.662936
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.998
SUFF_SIMPLE for r=0.2 class 0.0 = 0.994 +- 0.065 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.065 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.2 all KL = 0.992 +- 0.065 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.2 all L1 = 0.997 +- 0.030 (in-sample avg dev_std = 0.087)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6430600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.998
SUFF_SIMPLE for r=0.4 class 0.0 = 0.994 +- 0.061 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.999 +- 0.061 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.4 all KL = 0.993 +- 0.061 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.4 all L1 = 0.997 +- 0.026 (in-sample avg dev_std = 0.083)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.623514
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.998
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.063 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.995 +- 0.063 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.8 all KL = 0.995 +- 0.063 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.8 all L1 = 0.997 +- 0.043 (in-sample avg dev_std = 0.069)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.929
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6247208000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.914
SUFF_SIMPLE for r=0.05 class 0.0 = 0.947 +- 0.174 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.174 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.05 all KL = 0.943 +- 0.174 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.05 all L1 = 0.974 +- 0.083 (in-sample avg dev_std = 0.230)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.929
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5931344
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.915
SUFF_SIMPLE for r=0.1 class 0.0 = 0.952 +- 0.166 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.166 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.1 all KL = 0.948 +- 0.166 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.1 all L1 = 0.976 +- 0.079 (in-sample avg dev_std = 0.219)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.929
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5782348
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.915
SUFF_SIMPLE for r=0.2 class 0.0 = 0.953 +- 0.164 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.164 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.2 all KL = 0.948 +- 0.164 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.2 all L1 = 0.976 +- 0.077 (in-sample avg dev_std = 0.217)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.929
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5748004
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.917
SUFF_SIMPLE for r=0.4 class 0.0 = 0.957 +- 0.158 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.158 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.4 all KL = 0.954 +- 0.158 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.4 all L1 = 0.979 +- 0.074 (in-sample avg dev_std = 0.206)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.929
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5746794
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.921
SUFF_SIMPLE for r=0.8 class 0.0 = 0.972 +- 0.129 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.129 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.8 all KL = 0.97 +- 0.129 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.8 all L1 = 0.986 +- 0.062 (in-sample avg dev_std = 0.168)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5771316
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.969
SUFF_SIMPLE for r=0.05 class 0.0 = 0.957 +- 0.190 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.983 +- 0.190 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.05 all KL = 0.954 +- 0.190 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.05 all L1 = 0.97 +- 0.134 (in-sample avg dev_std = 0.192)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6318604
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.97
SUFF_SIMPLE for r=0.1 class 0.0 = 0.956 +- 0.182 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.989 +- 0.182 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.1 all KL = 0.961 +- 0.182 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.1 all L1 = 0.972 +- 0.135 (in-sample avg dev_std = 0.168)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6624736000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.97
SUFF_SIMPLE for r=0.2 class 0.0 = 0.957 +- 0.180 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.989 +- 0.180 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.2 all KL = 0.962 +- 0.180 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.2 all L1 = 0.973 +- 0.137 (in-sample avg dev_std = 0.155)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6730792
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.971
SUFF_SIMPLE for r=0.4 class 0.0 = 0.963 +- 0.171 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.988 +- 0.171 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.4 all KL = 0.966 +- 0.171 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.4 all L1 = 0.975 +- 0.133 (in-sample avg dev_std = 0.137)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6670904000000001
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.981
SUFF_SIMPLE for r=0.8 class 0.0 = 0.99 +- 0.115 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.986 +- 0.115 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all KL = 0.986 +- 0.115 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all L1 = 0.988 +- 0.100 (in-sample avg dev_std = 0.002)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5684980000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.962
NEC for r=0.05 class 0.0 = 0.002 +- 0.221 (in-sample avg dev_std = 0.204)
NEC for r=0.05 class 1.0 = 0.072 +- 0.221 (in-sample avg dev_std = 0.204)
NEC for r=0.05 all KL = 0.059 +- 0.221 (in-sample avg dev_std = 0.204)
NEC for r=0.05 all L1 = 0.041 +- 0.162 (in-sample avg dev_std = 0.204)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6473920000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.979
NEC for r=0.1 class 0.0 = 0.005 +- 0.184 (in-sample avg dev_std = 0.212)
NEC for r=0.1 class 1.0 = 0.044 +- 0.184 (in-sample avg dev_std = 0.212)
NEC for r=0.1 all KL = 0.044 +- 0.184 (in-sample avg dev_std = 0.212)
NEC for r=0.1 all L1 = 0.027 +- 0.117 (in-sample avg dev_std = 0.212)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.662936
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.987
NEC for r=0.2 class 0.0 = 0.004 +- 0.158 (in-sample avg dev_std = 0.203)
NEC for r=0.2 class 1.0 = 0.032 +- 0.158 (in-sample avg dev_std = 0.203)
NEC for r=0.2 all KL = 0.038 +- 0.158 (in-sample avg dev_std = 0.203)
NEC for r=0.2 all L1 = 0.02 +- 0.086 (in-sample avg dev_std = 0.203)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6430600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.993
NEC for r=0.4 class 0.0 = 0.003 +- 0.120 (in-sample avg dev_std = 0.161)
NEC for r=0.4 class 1.0 = 0.019 +- 0.120 (in-sample avg dev_std = 0.161)
NEC for r=0.4 all KL = 0.024 +- 0.120 (in-sample avg dev_std = 0.161)
NEC for r=0.4 all L1 = 0.012 +- 0.060 (in-sample avg dev_std = 0.161)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.623514
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.997
NEC for r=0.8 class 0.0 = 0.002 +- 0.081 (in-sample avg dev_std = 0.112)
NEC for r=0.8 class 1.0 = 0.009 +- 0.081 (in-sample avg dev_std = 0.112)
NEC for r=0.8 all KL = 0.012 +- 0.081 (in-sample avg dev_std = 0.112)
NEC for r=0.8 all L1 = 0.006 +- 0.038 (in-sample avg dev_std = 0.112)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.929
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6247208000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.914
NEC for r=0.05 class 0.0 = 0.032 +- 0.166 (in-sample avg dev_std = 0.217)
NEC for r=0.05 class 1.0 = 0.017 +- 0.166 (in-sample avg dev_std = 0.217)
NEC for r=0.05 all KL = 0.047 +- 0.166 (in-sample avg dev_std = 0.217)
NEC for r=0.05 all L1 = 0.024 +- 0.089 (in-sample avg dev_std = 0.217)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.929
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5931344
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.916
NEC for r=0.1 class 0.0 = 0.039 +- 0.160 (in-sample avg dev_std = 0.203)
NEC for r=0.1 class 1.0 = 0.003 +- 0.160 (in-sample avg dev_std = 0.203)
NEC for r=0.1 all KL = 0.043 +- 0.160 (in-sample avg dev_std = 0.203)
NEC for r=0.1 all L1 = 0.021 +- 0.083 (in-sample avg dev_std = 0.203)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.929
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5782348
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.916
NEC for r=0.2 class 0.0 = 0.042 +- 0.159 (in-sample avg dev_std = 0.204)
NEC for r=0.2 class 1.0 = 0.001 +- 0.159 (in-sample avg dev_std = 0.204)
NEC for r=0.2 all KL = 0.045 +- 0.159 (in-sample avg dev_std = 0.204)
NEC for r=0.2 all L1 = 0.021 +- 0.079 (in-sample avg dev_std = 0.204)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.929
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5748004
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.92
NEC for r=0.4 class 0.0 = 0.032 +- 0.138 (in-sample avg dev_std = 0.181)
NEC for r=0.4 class 1.0 = 0.001 +- 0.138 (in-sample avg dev_std = 0.181)
NEC for r=0.4 all KL = 0.036 +- 0.138 (in-sample avg dev_std = 0.181)
NEC for r=0.4 all L1 = 0.016 +- 0.065 (in-sample avg dev_std = 0.181)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.929
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5746794
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.923
NEC for r=0.8 class 0.0 = 0.021 +- 0.111 (in-sample avg dev_std = 0.147)
NEC for r=0.8 class 1.0 = 0.0 +- 0.111 (in-sample avg dev_std = 0.147)
NEC for r=0.8 all KL = 0.024 +- 0.111 (in-sample avg dev_std = 0.147)
NEC for r=0.8 all L1 = 0.011 +- 0.050 (in-sample avg dev_std = 0.147)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5771316
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.911
NEC for r=0.05 class 0.0 = 0.009 +- 0.297 (in-sample avg dev_std = 0.242)
NEC for r=0.05 class 1.0 = 0.165 +- 0.297 (in-sample avg dev_std = 0.242)
NEC for r=0.05 all KL = 0.119 +- 0.297 (in-sample avg dev_std = 0.242)
NEC for r=0.05 all L1 = 0.086 +- 0.232 (in-sample avg dev_std = 0.242)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6318604
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.923
NEC for r=0.1 class 0.0 = 0.013 +- 0.278 (in-sample avg dev_std = 0.200)
NEC for r=0.1 class 1.0 = 0.135 +- 0.278 (in-sample avg dev_std = 0.200)
NEC for r=0.1 all KL = 0.099 +- 0.278 (in-sample avg dev_std = 0.200)
NEC for r=0.1 all L1 = 0.073 +- 0.221 (in-sample avg dev_std = 0.200)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6624736000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.931
NEC for r=0.2 class 0.0 = 0.018 +- 0.268 (in-sample avg dev_std = 0.196)
NEC for r=0.2 class 1.0 = 0.117 +- 0.268 (in-sample avg dev_std = 0.196)
NEC for r=0.2 all KL = 0.089 +- 0.268 (in-sample avg dev_std = 0.196)
NEC for r=0.2 all L1 = 0.067 +- 0.213 (in-sample avg dev_std = 0.196)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6730792
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.945
NEC for r=0.4 class 0.0 = 0.026 +- 0.254 (in-sample avg dev_std = 0.234)
NEC for r=0.4 class 1.0 = 0.091 +- 0.254 (in-sample avg dev_std = 0.234)
NEC for r=0.4 all KL = 0.083 +- 0.254 (in-sample avg dev_std = 0.234)
NEC for r=0.4 all L1 = 0.058 +- 0.189 (in-sample avg dev_std = 0.234)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.987
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6670904000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.972
NEC for r=0.8 class 0.0 = 0.027 +- 0.203 (in-sample avg dev_std = 0.251)
NEC for r=0.8 class 1.0 = 0.04 +- 0.203 (in-sample avg dev_std = 0.251)
NEC for r=0.8 all KL = 0.059 +- 0.203 (in-sample avg dev_std = 0.251)
NEC for r=0.8 all L1 = 0.034 +- 0.123 (in-sample avg dev_std = 0.251)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:26:47 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 12:26:47 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 12:26:47 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:26:47 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 12:26:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:26:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:26:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:26:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:26:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:26:47 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:26:47 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.578
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.642
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.656
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.646
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.635
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.538
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.490
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.468
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.463
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.462
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.575
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.622
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.646
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.657
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.659


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5778099999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.996
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.074 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.991 +- 0.074 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.05 all KL = 0.991 +- 0.074 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.05 all L1 = 0.994 +- 0.048 (in-sample avg dev_std = 0.097)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.642428
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.996
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.074 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.991 +- 0.074 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.1 all KL = 0.989 +- 0.074 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.1 all L1 = 0.993 +- 0.045 (in-sample avg dev_std = 0.104)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6555319999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.996
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.080 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.992 +- 0.080 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.2 all KL = 0.988 +- 0.080 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.2 all L1 = 0.993 +- 0.046 (in-sample avg dev_std = 0.113)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.646244
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.997
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.079 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.99 +- 0.079 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.4 all KL = 0.991 +- 0.079 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.4 all L1 = 0.994 +- 0.050 (in-sample avg dev_std = 0.096)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6348959999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.988
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.107 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.981 +- 0.107 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.8 all KL = 0.988 +- 0.107 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.8 all L1 = 0.989 +- 0.091 (in-sample avg dev_std = 0.051)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.537904
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.842
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.193 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.895 +- 0.193 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.05 all KL = 0.936 +- 0.193 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.05 all L1 = 0.947 +- 0.147 (in-sample avg dev_std = 0.217)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49017380000000005
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.842
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.194 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.894 +- 0.194 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.1 all KL = 0.936 +- 0.194 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.1 all L1 = 0.946 +- 0.148 (in-sample avg dev_std = 0.216)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46806099999999995
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.841
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.197 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.891 +- 0.197 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.2 all KL = 0.934 +- 0.197 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.2 all L1 = 0.945 +- 0.150 (in-sample avg dev_std = 0.220)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.46268940000000003
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.841
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.196 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.891 +- 0.196 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.4 all KL = 0.934 +- 0.196 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.4 all L1 = 0.945 +- 0.150 (in-sample avg dev_std = 0.220)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.4624746
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.834
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.207 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.877 +- 0.207 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.8 all KL = 0.928 +- 0.207 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.8 all L1 = 0.938 +- 0.162 (in-sample avg dev_std = 0.216)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.979
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5754468
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.963
SUFF_SIMPLE for r=0.05 class 0.0 = 0.957 +- 0.214 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.955 +- 0.214 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.05 all KL = 0.936 +- 0.214 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.05 all L1 = 0.956 +- 0.155 (in-sample avg dev_std = 0.235)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.979
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6217768
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.964
SUFF_SIMPLE for r=0.1 class 0.0 = 0.957 +- 0.208 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.959 +- 0.208 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.1 all KL = 0.941 +- 0.208 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.1 all L1 = 0.958 +- 0.155 (in-sample avg dev_std = 0.215)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.979
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6455696
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.964
SUFF_SIMPLE for r=0.2 class 0.0 = 0.959 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.961 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.2 all KL = 0.945 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.2 all L1 = 0.96 +- 0.155 (in-sample avg dev_std = 0.193)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.979
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6570275999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.967
SUFF_SIMPLE for r=0.4 class 0.0 = 0.967 +- 0.199 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.956 +- 0.199 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 all KL = 0.95 +- 0.199 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 all L1 = 0.962 +- 0.156 (in-sample avg dev_std = 0.168)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.979
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6593992000000001
len(reference) = 4919
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.961
SUFF_SIMPLE for r=0.8 class 0.0 = 0.984 +- 0.178 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.952 +- 0.178 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all KL = 0.965 +- 0.178 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all L1 = 0.968 +- 0.154 (in-sample avg dev_std = 0.031)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5778099999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.999
NEC for r=0.05 class 0.0 = 0.0 +- 0.050 (in-sample avg dev_std = 0.061)
NEC for r=0.05 class 1.0 = 0.003 +- 0.050 (in-sample avg dev_std = 0.061)
NEC for r=0.05 all KL = 0.003 +- 0.050 (in-sample avg dev_std = 0.061)
NEC for r=0.05 all L1 = 0.002 +- 0.029 (in-sample avg dev_std = 0.061)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.642428
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6555319999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.999
NEC for r=0.2 class 0.0 = 0.001 +- 0.030 (in-sample avg dev_std = 0.044)
NEC for r=0.2 class 1.0 = 0.002 +- 0.030 (in-sample avg dev_std = 0.044)
NEC for r=0.2 all KL = 0.002 +- 0.030 (in-sample avg dev_std = 0.044)
NEC for r=0.2 all L1 = 0.001 +- 0.014 (in-sample avg dev_std = 0.044)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.646244
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  1.0
NEC for r=0.4 class 0.0 = 0.0 +- 0.021 (in-sample avg dev_std = 0.031)
NEC for r=0.4 class 1.0 = 0.001 +- 0.021 (in-sample avg dev_std = 0.031)
NEC for r=0.4 all KL = 0.001 +- 0.021 (in-sample avg dev_std = 0.031)
NEC for r=0.4 all L1 = 0.001 +- 0.010 (in-sample avg dev_std = 0.031)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6348959999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.001 +- 0.028 (in-sample avg dev_std = 0.044)
NEC for r=0.8 class 1.0 = 0.002 +- 0.028 (in-sample avg dev_std = 0.044)
NEC for r=0.8 all KL = 0.002 +- 0.028 (in-sample avg dev_std = 0.044)
NEC for r=0.8 all L1 = 0.001 +- 0.015 (in-sample avg dev_std = 0.044)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.537904
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.843
NEC for r=0.05 class 0.0 = 0.003 +- 0.205 (in-sample avg dev_std = 0.308)
NEC for r=0.05 class 1.0 = 0.117 +- 0.205 (in-sample avg dev_std = 0.308)
NEC for r=0.05 all KL = 0.09 +- 0.205 (in-sample avg dev_std = 0.308)
NEC for r=0.05 all L1 = 0.06 +- 0.128 (in-sample avg dev_std = 0.308)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49017380000000005
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.868
NEC for r=0.1 class 0.0 = 0.001 +- 0.121 (in-sample avg dev_std = 0.178)
NEC for r=0.1 class 1.0 = 0.043 +- 0.121 (in-sample avg dev_std = 0.178)
NEC for r=0.1 all KL = 0.032 +- 0.121 (in-sample avg dev_std = 0.178)
NEC for r=0.1 all L1 = 0.022 +- 0.077 (in-sample avg dev_std = 0.178)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46806099999999995
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.872
NEC for r=0.2 class 0.0 = 0.001 +- 0.097 (in-sample avg dev_std = 0.128)
NEC for r=0.2 class 1.0 = 0.029 +- 0.097 (in-sample avg dev_std = 0.128)
NEC for r=0.2 all KL = 0.019 +- 0.097 (in-sample avg dev_std = 0.128)
NEC for r=0.2 all L1 = 0.015 +- 0.068 (in-sample avg dev_std = 0.128)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.46268940000000003
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.872
NEC for r=0.4 class 0.0 = 0.001 +- 0.090 (in-sample avg dev_std = 0.114)
NEC for r=0.4 class 1.0 = 0.026 +- 0.090 (in-sample avg dev_std = 0.114)
NEC for r=0.4 all KL = 0.016 +- 0.090 (in-sample avg dev_std = 0.114)
NEC for r=0.4 all L1 = 0.014 +- 0.067 (in-sample avg dev_std = 0.114)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.4624746
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.874
NEC for r=0.8 class 0.0 = 0.0 +- 0.078 (in-sample avg dev_std = 0.094)
NEC for r=0.8 class 1.0 = 0.022 +- 0.078 (in-sample avg dev_std = 0.094)
NEC for r=0.8 all KL = 0.012 +- 0.078 (in-sample avg dev_std = 0.094)
NEC for r=0.8 all L1 = 0.011 +- 0.060 (in-sample avg dev_std = 0.094)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.979
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5754468
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.925
NEC for r=0.05 class 0.0 = 0.011 +- 0.273 (in-sample avg dev_std = 0.282)
NEC for r=0.05 class 1.0 = 0.155 +- 0.273 (in-sample avg dev_std = 0.282)
NEC for r=0.05 all KL = 0.115 +- 0.273 (in-sample avg dev_std = 0.282)
NEC for r=0.05 all L1 = 0.082 +- 0.206 (in-sample avg dev_std = 0.282)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.979
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6217768
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.945
NEC for r=0.1 class 0.0 = 0.015 +- 0.234 (in-sample avg dev_std = 0.216)
NEC for r=0.1 class 1.0 = 0.103 +- 0.234 (in-sample avg dev_std = 0.216)
NEC for r=0.1 all KL = 0.079 +- 0.234 (in-sample avg dev_std = 0.216)
NEC for r=0.1 all L1 = 0.058 +- 0.181 (in-sample avg dev_std = 0.216)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.979
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6455696
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.942
NEC for r=0.2 class 0.0 = 0.021 +- 0.235 (in-sample avg dev_std = 0.186)
NEC for r=0.2 class 1.0 = 0.093 +- 0.235 (in-sample avg dev_std = 0.186)
NEC for r=0.2 all KL = 0.074 +- 0.235 (in-sample avg dev_std = 0.186)
NEC for r=0.2 all L1 = 0.057 +- 0.188 (in-sample avg dev_std = 0.186)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.979
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6570275999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.949
NEC for r=0.4 class 0.0 = 0.026 +- 0.224 (in-sample avg dev_std = 0.207)
NEC for r=0.4 class 1.0 = 0.075 +- 0.224 (in-sample avg dev_std = 0.207)
NEC for r=0.4 all KL = 0.068 +- 0.224 (in-sample avg dev_std = 0.207)
NEC for r=0.4 all L1 = 0.05 +- 0.174 (in-sample avg dev_std = 0.207)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.979
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6593992000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.967
NEC for r=0.8 class 0.0 = 0.025 +- 0.195 (in-sample avg dev_std = 0.239)
NEC for r=0.8 class 1.0 = 0.051 +- 0.195 (in-sample avg dev_std = 0.239)
NEC for r=0.8 all KL = 0.057 +- 0.195 (in-sample avg dev_std = 0.239)
NEC for r=0.8 all L1 = 0.038 +- 0.135 (in-sample avg dev_std = 0.239)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:45:59 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 12:45:59 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:59 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:59 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 12:45:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:59 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:45:59 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.606
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.698
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.738
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.747
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.745
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.686
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.678
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.676
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.676
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.676
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.588
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.636
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.665
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.683
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.688


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.605934
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.999
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.035 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.035 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.05 all KL = 0.998 +- 0.035 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.05 all L1 = 0.999 +- 0.014 (in-sample avg dev_std = 0.044)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6984199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.999
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.049 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.049 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.1 all KL = 0.996 +- 0.049 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.1 all L1 = 0.998 +- 0.019 (in-sample avg dev_std = 0.059)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.737992
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.999
SUFF_SIMPLE for r=0.2 class 0.0 = 0.996 +- 0.049 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.049 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.2 all KL = 0.996 +- 0.049 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.2 all L1 = 0.998 +- 0.019 (in-sample avg dev_std = 0.059)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.746616
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.999
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.038 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.038 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.4 all KL = 0.998 +- 0.038 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.4 all L1 = 0.999 +- 0.017 (in-sample avg dev_std = 0.041)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.74456
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.042 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.042 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.8 all KL = 0.998 +- 0.042 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.8 all L1 = 0.999 +- 0.023 (in-sample avg dev_std = 0.046)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6862308
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.941
SUFF_SIMPLE for r=0.05 class 0.0 = 0.985 +- 0.100 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.100 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.05 all KL = 0.981 +- 0.100 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.05 all L1 = 0.993 +- 0.040 (in-sample avg dev_std = 0.119)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.678315
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.941
SUFF_SIMPLE for r=0.1 class 0.0 = 0.987 +- 0.096 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.096 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.1 all KL = 0.982 +- 0.096 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.1 all L1 = 0.993 +- 0.037 (in-sample avg dev_std = 0.112)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6761617999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.942
SUFF_SIMPLE for r=0.2 class 0.0 = 0.988 +- 0.092 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.092 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.2 all KL = 0.984 +- 0.092 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.2 all L1 = 0.994 +- 0.037 (in-sample avg dev_std = 0.109)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6759417999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.942
SUFF_SIMPLE for r=0.4 class 0.0 = 0.989 +- 0.086 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.086 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.4 all KL = 0.986 +- 0.086 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.4 all L1 = 0.995 +- 0.033 (in-sample avg dev_std = 0.099)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6759394
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.942
SUFF_SIMPLE for r=0.8 class 0.0 = 0.991 +- 0.079 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.079 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.8 all KL = 0.989 +- 0.079 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.8 all L1 = 0.996 +- 0.032 (in-sample avg dev_std = 0.091)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5882718000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.965
SUFF_SIMPLE for r=0.05 class 0.0 = 0.953 +- 0.172 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.172 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.05 all KL = 0.966 +- 0.172 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.05 all L1 = 0.976 +- 0.127 (in-sample avg dev_std = 0.152)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6363555999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.964
SUFF_SIMPLE for r=0.1 class 0.0 = 0.952 +- 0.173 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.173 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.1 all KL = 0.966 +- 0.173 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.1 all L1 = 0.976 +- 0.130 (in-sample avg dev_std = 0.144)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6654072
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.964
SUFF_SIMPLE for r=0.2 class 0.0 = 0.953 +- 0.170 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.170 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.2 all KL = 0.968 +- 0.170 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.2 all L1 = 0.976 +- 0.132 (in-sample avg dev_std = 0.124)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6832090000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.965
SUFF_SIMPLE for r=0.4 class 0.0 = 0.957 +- 0.160 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.160 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.4 all KL = 0.972 +- 0.160 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.4 all L1 = 0.978 +- 0.128 (in-sample avg dev_std = 0.101)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.989
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.687851
len(reference) = 4956
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.979
SUFF_SIMPLE for r=0.8 class 0.0 = 0.983 +- 0.098 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.098 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.99 +- 0.098 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.991 +- 0.084 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.605934
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.969
NEC for r=0.05 class 0.0 = 0.0 +- 0.213 (in-sample avg dev_std = 0.204)
NEC for r=0.05 class 1.0 = 0.064 +- 0.213 (in-sample avg dev_std = 0.204)
NEC for r=0.05 all KL = 0.056 +- 0.213 (in-sample avg dev_std = 0.204)
NEC for r=0.05 all L1 = 0.035 +- 0.146 (in-sample avg dev_std = 0.204)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6984199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.981
NEC for r=0.1 class 0.0 = 0.0 +- 0.196 (in-sample avg dev_std = 0.221)
NEC for r=0.1 class 1.0 = 0.047 +- 0.196 (in-sample avg dev_std = 0.221)
NEC for r=0.1 all KL = 0.048 +- 0.196 (in-sample avg dev_std = 0.221)
NEC for r=0.1 all L1 = 0.026 +- 0.113 (in-sample avg dev_std = 0.221)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.737992
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.991
NEC for r=0.2 class 0.0 = 0.0 +- 0.147 (in-sample avg dev_std = 0.173)
NEC for r=0.2 class 1.0 = 0.025 +- 0.147 (in-sample avg dev_std = 0.173)
NEC for r=0.2 all KL = 0.03 +- 0.147 (in-sample avg dev_std = 0.173)
NEC for r=0.2 all L1 = 0.014 +- 0.072 (in-sample avg dev_std = 0.173)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.746616
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.995
NEC for r=0.4 class 0.0 = 0.0 +- 0.114 (in-sample avg dev_std = 0.132)
NEC for r=0.4 class 1.0 = 0.015 +- 0.114 (in-sample avg dev_std = 0.132)
NEC for r=0.4 all KL = 0.018 +- 0.114 (in-sample avg dev_std = 0.132)
NEC for r=0.4 all L1 = 0.008 +- 0.055 (in-sample avg dev_std = 0.132)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.74456
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.998
NEC for r=0.8 class 0.0 = 0.0 +- 0.077 (in-sample avg dev_std = 0.095)
NEC for r=0.8 class 1.0 = 0.007 +- 0.077 (in-sample avg dev_std = 0.095)
NEC for r=0.8 all KL = 0.01 +- 0.077 (in-sample avg dev_std = 0.095)
NEC for r=0.8 all L1 = 0.004 +- 0.029 (in-sample avg dev_std = 0.095)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6862308
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.93
NEC for r=0.05 class 0.0 = 0.009 +- 0.163 (in-sample avg dev_std = 0.208)
NEC for r=0.05 class 1.0 = 0.037 +- 0.163 (in-sample avg dev_std = 0.208)
NEC for r=0.05 all KL = 0.046 +- 0.163 (in-sample avg dev_std = 0.208)
NEC for r=0.05 all L1 = 0.023 +- 0.079 (in-sample avg dev_std = 0.208)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.678315
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.94
NEC for r=0.1 class 0.0 = 0.01 +- 0.107 (in-sample avg dev_std = 0.126)
NEC for r=0.1 class 1.0 = 0.007 +- 0.107 (in-sample avg dev_std = 0.126)
NEC for r=0.1 all KL = 0.019 +- 0.107 (in-sample avg dev_std = 0.126)
NEC for r=0.1 all L1 = 0.008 +- 0.046 (in-sample avg dev_std = 0.126)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6761617999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.942
NEC for r=0.2 class 0.0 = 0.007 +- 0.084 (in-sample avg dev_std = 0.100)
NEC for r=0.2 class 1.0 = 0.003 +- 0.084 (in-sample avg dev_std = 0.100)
NEC for r=0.2 all KL = 0.013 +- 0.084 (in-sample avg dev_std = 0.100)
NEC for r=0.2 all L1 = 0.005 +- 0.034 (in-sample avg dev_std = 0.100)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6759417999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.943
NEC for r=0.4 class 0.0 = 0.005 +- 0.065 (in-sample avg dev_std = 0.077)
NEC for r=0.4 class 1.0 = 0.002 +- 0.065 (in-sample avg dev_std = 0.077)
NEC for r=0.4 all KL = 0.008 +- 0.065 (in-sample avg dev_std = 0.077)
NEC for r=0.4 all L1 = 0.003 +- 0.025 (in-sample avg dev_std = 0.077)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6759394
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.944
NEC for r=0.8 class 0.0 = 0.003 +- 0.050 (in-sample avg dev_std = 0.059)
NEC for r=0.8 class 1.0 = 0.001 +- 0.050 (in-sample avg dev_std = 0.059)
NEC for r=0.8 all KL = 0.005 +- 0.050 (in-sample avg dev_std = 0.059)
NEC for r=0.8 all L1 = 0.002 +- 0.019 (in-sample avg dev_std = 0.059)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5882718000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.918
NEC for r=0.05 class 0.0 = 0.011 +- 0.315 (in-sample avg dev_std = 0.306)
NEC for r=0.05 class 1.0 = 0.171 +- 0.315 (in-sample avg dev_std = 0.306)
NEC for r=0.05 all KL = 0.144 +- 0.315 (in-sample avg dev_std = 0.306)
NEC for r=0.05 all L1 = 0.09 +- 0.219 (in-sample avg dev_std = 0.306)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6363555999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.947
NEC for r=0.1 class 0.0 = 0.015 +- 0.267 (in-sample avg dev_std = 0.250)
NEC for r=0.1 class 1.0 = 0.107 +- 0.267 (in-sample avg dev_std = 0.250)
NEC for r=0.1 all KL = 0.099 +- 0.267 (in-sample avg dev_std = 0.250)
NEC for r=0.1 all L1 = 0.06 +- 0.182 (in-sample avg dev_std = 0.250)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6654072
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.961
NEC for r=0.2 class 0.0 = 0.023 +- 0.239 (in-sample avg dev_std = 0.219)
NEC for r=0.2 class 1.0 = 0.073 +- 0.239 (in-sample avg dev_std = 0.219)
NEC for r=0.2 all KL = 0.077 +- 0.239 (in-sample avg dev_std = 0.219)
NEC for r=0.2 all L1 = 0.048 +- 0.165 (in-sample avg dev_std = 0.219)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6832090000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.959
NEC for r=0.4 class 0.0 = 0.031 +- 0.242 (in-sample avg dev_std = 0.227)
NEC for r=0.4 class 1.0 = 0.065 +- 0.242 (in-sample avg dev_std = 0.227)
NEC for r=0.4 all KL = 0.076 +- 0.242 (in-sample avg dev_std = 0.227)
NEC for r=0.4 all L1 = 0.047 +- 0.166 (in-sample avg dev_std = 0.227)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.687851
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.973
NEC for r=0.8 class 0.0 = 0.027 +- 0.189 (in-sample avg dev_std = 0.215)
NEC for r=0.8 class 1.0 = 0.024 +- 0.189 (in-sample avg dev_std = 0.215)
NEC for r=0.8 all KL = 0.05 +- 0.189 (in-sample avg dev_std = 0.215)
NEC for r=0.8 all L1 = 0.026 +- 0.107 (in-sample avg dev_std = 0.215)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:05:07 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 01:05:07 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 01:05:07 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:05:07 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 01:05:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:05:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:05:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:05:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:05:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:05:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:05:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.608
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.665
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.669
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.646
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.626
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.610
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.580
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.567
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.564
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.564
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.592
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.638
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.660
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.665
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.657


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.607754
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.073 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.996 +- 0.073 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.05 all KL = 0.991 +- 0.073 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.05 all L1 = 0.996 +- 0.034 (in-sample avg dev_std = 0.096)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.665344
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.997
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.084 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.993 +- 0.084 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.1 all KL = 0.99 +- 0.084 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.1 all L1 = 0.995 +- 0.043 (in-sample avg dev_std = 0.106)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.668788
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.999
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.039 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.998 +- 0.039 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.2 all KL = 0.997 +- 0.039 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.2 all L1 = 0.998 +- 0.017 (in-sample avg dev_std = 0.056)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.646372
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.998
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.061 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.996 +- 0.061 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.4 all KL = 0.994 +- 0.061 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.4 all L1 = 0.997 +- 0.029 (in-sample avg dev_std = 0.077)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6258859999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.988
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.123 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.978 +- 0.123 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.8 all KL = 0.983 +- 0.123 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.8 all L1 = 0.988 +- 0.094 (in-sample avg dev_std = 0.087)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6103658
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.966
SUFF_SIMPLE for r=0.05 class 0.0 = 0.993 +- 0.080 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.997 +- 0.080 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.05 all KL = 0.989 +- 0.080 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.05 all L1 = 0.995 +- 0.040 (in-sample avg dev_std = 0.098)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.57956
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.966
SUFF_SIMPLE for r=0.1 class 0.0 = 0.994 +- 0.076 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.996 +- 0.076 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.1 all KL = 0.99 +- 0.076 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.1 all L1 = 0.995 +- 0.040 (in-sample avg dev_std = 0.093)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5668784
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.967
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.069 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.997 +- 0.069 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.2 all KL = 0.992 +- 0.069 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.2 all L1 = 0.996 +- 0.037 (in-sample avg dev_std = 0.083)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5644142
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.966
SUFF_SIMPLE for r=0.4 class 0.0 = 0.994 +- 0.073 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.997 +- 0.073 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.4 all KL = 0.99 +- 0.073 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.4 all L1 = 0.995 +- 0.039 (in-sample avg dev_std = 0.089)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5643466
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.968
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.054 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.997 +- 0.054 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.8 all KL = 0.995 +- 0.054 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.8 all L1 = 0.997 +- 0.033 (in-sample avg dev_std = 0.065)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.592398
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.969
SUFF_SIMPLE for r=0.05 class 0.0 = 0.96 +- 0.205 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.969 +- 0.205 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 all KL = 0.946 +- 0.205 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 all L1 = 0.965 +- 0.145 (in-sample avg dev_std = 0.213)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6381454
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.969
SUFF_SIMPLE for r=0.1 class 0.0 = 0.96 +- 0.200 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.971 +- 0.200 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.1 all KL = 0.949 +- 0.200 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.1 all L1 = 0.966 +- 0.146 (in-sample avg dev_std = 0.194)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6601752
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.97
SUFF_SIMPLE for r=0.2 class 0.0 = 0.964 +- 0.197 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.97 +- 0.197 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.2 all KL = 0.952 +- 0.197 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.2 all L1 = 0.967 +- 0.147 (in-sample avg dev_std = 0.175)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6654783999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.972
SUFF_SIMPLE for r=0.4 class 0.0 = 0.97 +- 0.191 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.968 +- 0.191 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.4 all KL = 0.957 +- 0.191 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.4 all L1 = 0.969 +- 0.145 (in-sample avg dev_std = 0.159)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6571288
len(reference) = 4912
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.97
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.157 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.967 +- 0.157 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.8 all KL = 0.974 +- 0.157 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.8 all L1 = 0.978 +- 0.136 (in-sample avg dev_std = 0.012)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.607754
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.665344
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.668788
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.646372
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  1.0
NEC for r=0.4 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6258859999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
NEC for r=0.8 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6103658
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.952
NEC for r=0.05 class 0.0 = 0.01 +- 0.174 (in-sample avg dev_std = 0.239)
NEC for r=0.05 class 1.0 = 0.046 +- 0.174 (in-sample avg dev_std = 0.239)
NEC for r=0.05 all KL = 0.058 +- 0.174 (in-sample avg dev_std = 0.239)
NEC for r=0.05 all L1 = 0.028 +- 0.083 (in-sample avg dev_std = 0.239)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.57956
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.964
NEC for r=0.1 class 0.0 = 0.009 +- 0.103 (in-sample avg dev_std = 0.135)
NEC for r=0.1 class 1.0 = 0.009 +- 0.103 (in-sample avg dev_std = 0.135)
NEC for r=0.1 all KL = 0.02 +- 0.103 (in-sample avg dev_std = 0.135)
NEC for r=0.1 all L1 = 0.009 +- 0.046 (in-sample avg dev_std = 0.135)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5668784
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.966
NEC for r=0.2 class 0.0 = 0.008 +- 0.081 (in-sample avg dev_std = 0.105)
NEC for r=0.2 class 1.0 = 0.003 +- 0.081 (in-sample avg dev_std = 0.105)
NEC for r=0.2 all KL = 0.013 +- 0.081 (in-sample avg dev_std = 0.105)
NEC for r=0.2 all L1 = 0.005 +- 0.036 (in-sample avg dev_std = 0.105)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5644142
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.968
NEC for r=0.4 class 0.0 = 0.004 +- 0.061 (in-sample avg dev_std = 0.075)
NEC for r=0.4 class 1.0 = 0.002 +- 0.061 (in-sample avg dev_std = 0.075)
NEC for r=0.4 all KL = 0.007 +- 0.061 (in-sample avg dev_std = 0.075)
NEC for r=0.4 all L1 = 0.003 +- 0.027 (in-sample avg dev_std = 0.075)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5643466
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.969
NEC for r=0.8 class 0.0 = 0.002 +- 0.043 (in-sample avg dev_std = 0.052)
NEC for r=0.8 class 1.0 = 0.001 +- 0.043 (in-sample avg dev_std = 0.052)
NEC for r=0.8 all KL = 0.003 +- 0.043 (in-sample avg dev_std = 0.052)
NEC for r=0.8 all L1 = 0.002 +- 0.023 (in-sample avg dev_std = 0.052)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.592398
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.921
NEC for r=0.05 class 0.0 = 0.01 +- 0.289 (in-sample avg dev_std = 0.246)
NEC for r=0.05 class 1.0 = 0.145 +- 0.289 (in-sample avg dev_std = 0.246)
NEC for r=0.05 all KL = 0.111 +- 0.289 (in-sample avg dev_std = 0.246)
NEC for r=0.05 all L1 = 0.077 +- 0.216 (in-sample avg dev_std = 0.246)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6381454
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.941
NEC for r=0.1 class 0.0 = 0.012 +- 0.246 (in-sample avg dev_std = 0.183)
NEC for r=0.1 class 1.0 = 0.097 +- 0.246 (in-sample avg dev_std = 0.183)
NEC for r=0.1 all KL = 0.075 +- 0.246 (in-sample avg dev_std = 0.183)
NEC for r=0.1 all L1 = 0.054 +- 0.190 (in-sample avg dev_std = 0.183)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6601752
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.942
NEC for r=0.2 class 0.0 = 0.018 +- 0.242 (in-sample avg dev_std = 0.170)
NEC for r=0.2 class 1.0 = 0.087 +- 0.242 (in-sample avg dev_std = 0.170)
NEC for r=0.2 all KL = 0.07 +- 0.242 (in-sample avg dev_std = 0.170)
NEC for r=0.2 all L1 = 0.052 +- 0.191 (in-sample avg dev_std = 0.170)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6654783999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.951
NEC for r=0.4 class 0.0 = 0.024 +- 0.240 (in-sample avg dev_std = 0.214)
NEC for r=0.4 class 1.0 = 0.077 +- 0.240 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all KL = 0.072 +- 0.240 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all L1 = 0.05 +- 0.178 (in-sample avg dev_std = 0.214)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6571288
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.972
NEC for r=0.8 class 0.0 = 0.026 +- 0.207 (in-sample avg dev_std = 0.240)
NEC for r=0.8 class 1.0 = 0.043 +- 0.207 (in-sample avg dev_std = 0.240)
NEC for r=0.8 all KL = 0.058 +- 0.207 (in-sample avg dev_std = 0.240)
NEC for r=0.8 all L1 = 0.034 +- 0.131 (in-sample avg dev_std = 0.240)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:24:09 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 01:24:09 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 01:24:09 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:24:09 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 01:24:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:24:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:24:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:24:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:24:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:24:09 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:24:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.606
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.696
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.729
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.725
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.715
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.706
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.695
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.691
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.691
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.691
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.595
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.640
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.671
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.684
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.682


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6056379999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.99
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.143 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.974 +- 0.143 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.05 all KL = 0.969 +- 0.143 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.05 all L1 = 0.985 +- 0.074 (in-sample avg dev_std = 0.176)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.696192
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.991
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.135 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.977 +- 0.135 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.1 all KL = 0.975 +- 0.135 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.1 all L1 = 0.987 +- 0.076 (in-sample avg dev_std = 0.161)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.729034
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.993
SUFF_SIMPLE for r=0.2 class 0.0 = 1.0 +- 0.116 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.983 +- 0.116 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.2 all KL = 0.982 +- 0.116 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.2 all L1 = 0.99 +- 0.065 (in-sample avg dev_std = 0.138)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7247560000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.991
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.134 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.979 +- 0.134 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.4 all KL = 0.975 +- 0.134 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.4 all L1 = 0.987 +- 0.074 (in-sample avg dev_std = 0.160)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.715498
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.981
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.158 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.964 +- 0.158 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.8 all KL = 0.971 +- 0.158 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.8 all L1 = 0.98 +- 0.116 (in-sample avg dev_std = 0.140)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7063147999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.998
SUFF_SIMPLE for r=0.05 class 0.0 = 0.995 +- 0.063 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.999 +- 0.063 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.05 all KL = 0.993 +- 0.063 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.05 all L1 = 0.997 +- 0.028 (in-sample avg dev_std = 0.081)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6954691999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.998
SUFF_SIMPLE for r=0.1 class 0.0 = 0.995 +- 0.062 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.062 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.1 all KL = 0.993 +- 0.062 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.1 all L1 = 0.997 +- 0.026 (in-sample avg dev_std = 0.080)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6913632
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.998
SUFF_SIMPLE for r=0.2 class 0.0 = 0.996 +- 0.059 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.059 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.2 all KL = 0.994 +- 0.059 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.2 all L1 = 0.997 +- 0.025 (in-sample avg dev_std = 0.075)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6907478
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.999
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.053 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.999 +- 0.053 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.4 all KL = 0.995 +- 0.053 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.4 all L1 = 0.998 +- 0.024 (in-sample avg dev_std = 0.067)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.690738
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.999
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.046 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.999 +- 0.046 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.8 all KL = 0.996 +- 0.046 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.8 all L1 = 0.998 +- 0.021 (in-sample avg dev_std = 0.059)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.98
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5945608
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.956
SUFF_SIMPLE for r=0.05 class 0.0 = 0.973 +- 0.266 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.266 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.05 all KL = 0.904 +- 0.266 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.05 all L1 = 0.942 +- 0.173 (in-sample avg dev_std = 0.308)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.98
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6403356
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.965
SUFF_SIMPLE for r=0.1 class 0.0 = 0.973 +- 0.247 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.925 +- 0.247 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 all KL = 0.92 +- 0.247 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 all L1 = 0.949 +- 0.167 (in-sample avg dev_std = 0.269)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.98
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.670858
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.972
SUFF_SIMPLE for r=0.2 class 0.0 = 0.975 +- 0.212 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.948 +- 0.212 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.2 all KL = 0.946 +- 0.212 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.2 all L1 = 0.962 +- 0.157 (in-sample avg dev_std = 0.196)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.98
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6837898
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.971
SUFF_SIMPLE for r=0.4 class 0.0 = 0.978 +- 0.212 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.945 +- 0.212 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 all KL = 0.948 +- 0.212 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 all L1 = 0.962 +- 0.161 (in-sample avg dev_std = 0.183)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.98
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6816638
len(reference) = 4936
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.971
SUFF_SIMPLE for r=0.8 class 0.0 = 0.993 +- 0.173 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.952 +- 0.173 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.8 all KL = 0.968 +- 0.173 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.8 all L1 = 0.973 +- 0.149 (in-sample avg dev_std = 0.041)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6056379999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.95
NEC for r=0.05 class 0.0 = 0.001 +- 0.246 (in-sample avg dev_std = 0.204)
NEC for r=0.05 class 1.0 = 0.092 +- 0.246 (in-sample avg dev_std = 0.204)
NEC for r=0.05 all KL = 0.072 +- 0.246 (in-sample avg dev_std = 0.204)
NEC for r=0.05 all L1 = 0.051 +- 0.185 (in-sample avg dev_std = 0.204)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.696192
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.965
NEC for r=0.1 class 0.0 = 0.0 +- 0.224 (in-sample avg dev_std = 0.225)
NEC for r=0.1 class 1.0 = 0.073 +- 0.224 (in-sample avg dev_std = 0.225)
NEC for r=0.1 all KL = 0.063 +- 0.224 (in-sample avg dev_std = 0.225)
NEC for r=0.1 all L1 = 0.041 +- 0.155 (in-sample avg dev_std = 0.225)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.729034
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.98
NEC for r=0.2 class 0.0 = 0.0 +- 0.184 (in-sample avg dev_std = 0.201)
NEC for r=0.2 class 1.0 = 0.045 +- 0.184 (in-sample avg dev_std = 0.201)
NEC for r=0.2 all KL = 0.044 +- 0.184 (in-sample avg dev_std = 0.201)
NEC for r=0.2 all L1 = 0.025 +- 0.114 (in-sample avg dev_std = 0.201)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7247560000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.987
NEC for r=0.4 class 0.0 = 0.0 +- 0.165 (in-sample avg dev_std = 0.195)
NEC for r=0.4 class 1.0 = 0.036 +- 0.165 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all KL = 0.038 +- 0.165 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all L1 = 0.02 +- 0.090 (in-sample avg dev_std = 0.195)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.715498
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.994
NEC for r=0.8 class 0.0 = 0.0 +- 0.114 (in-sample avg dev_std = 0.140)
NEC for r=0.8 class 1.0 = 0.017 +- 0.114 (in-sample avg dev_std = 0.140)
NEC for r=0.8 all KL = 0.02 +- 0.114 (in-sample avg dev_std = 0.140)
NEC for r=0.8 all L1 = 0.01 +- 0.059 (in-sample avg dev_std = 0.140)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7063147999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.95
NEC for r=0.05 class 0.0 = 0.003 +- 0.272 (in-sample avg dev_std = 0.382)
NEC for r=0.05 class 1.0 = 0.144 +- 0.272 (in-sample avg dev_std = 0.382)
NEC for r=0.05 all KL = 0.135 +- 0.272 (in-sample avg dev_std = 0.382)
NEC for r=0.05 all L1 = 0.074 +- 0.153 (in-sample avg dev_std = 0.382)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6954691999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.982
NEC for r=0.1 class 0.0 = 0.004 +- 0.179 (in-sample avg dev_std = 0.242)
NEC for r=0.1 class 1.0 = 0.053 +- 0.179 (in-sample avg dev_std = 0.242)
NEC for r=0.1 all KL = 0.057 +- 0.179 (in-sample avg dev_std = 0.242)
NEC for r=0.1 all L1 = 0.028 +- 0.089 (in-sample avg dev_std = 0.242)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6913632
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.994
NEC for r=0.2 class 0.0 = 0.003 +- 0.104 (in-sample avg dev_std = 0.143)
NEC for r=0.2 class 1.0 = 0.016 +- 0.104 (in-sample avg dev_std = 0.143)
NEC for r=0.2 all KL = 0.021 +- 0.104 (in-sample avg dev_std = 0.143)
NEC for r=0.2 all L1 = 0.01 +- 0.048 (in-sample avg dev_std = 0.143)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6907478
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.997
NEC for r=0.4 class 0.0 = 0.003 +- 0.076 (in-sample avg dev_std = 0.100)
NEC for r=0.4 class 1.0 = 0.007 +- 0.076 (in-sample avg dev_std = 0.100)
NEC for r=0.4 all KL = 0.011 +- 0.076 (in-sample avg dev_std = 0.100)
NEC for r=0.4 all L1 = 0.005 +- 0.033 (in-sample avg dev_std = 0.100)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.690738
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.002 +- 0.056 (in-sample avg dev_std = 0.073)
NEC for r=0.8 class 1.0 = 0.003 +- 0.056 (in-sample avg dev_std = 0.073)
NEC for r=0.8 all KL = 0.006 +- 0.056 (in-sample avg dev_std = 0.073)
NEC for r=0.8 all L1 = 0.002 +- 0.023 (in-sample avg dev_std = 0.073)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.98
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5945608
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.859
NEC for r=0.05 class 0.0 = 0.004 +- 0.350 (in-sample avg dev_std = 0.269)
NEC for r=0.05 class 1.0 = 0.244 +- 0.350 (in-sample avg dev_std = 0.269)
NEC for r=0.05 all KL = 0.169 +- 0.350 (in-sample avg dev_std = 0.269)
NEC for r=0.05 all L1 = 0.123 +- 0.274 (in-sample avg dev_std = 0.269)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.98
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6403356
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.883
NEC for r=0.1 class 0.0 = 0.005 +- 0.319 (in-sample avg dev_std = 0.225)
NEC for r=0.1 class 1.0 = 0.192 +- 0.319 (in-sample avg dev_std = 0.225)
NEC for r=0.1 all KL = 0.131 +- 0.319 (in-sample avg dev_std = 0.225)
NEC for r=0.1 all L1 = 0.097 +- 0.252 (in-sample avg dev_std = 0.225)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.98
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.670858
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.897
NEC for r=0.2 class 0.0 = 0.008 +- 0.305 (in-sample avg dev_std = 0.229)
NEC for r=0.2 class 1.0 = 0.168 +- 0.305 (in-sample avg dev_std = 0.229)
NEC for r=0.2 all KL = 0.118 +- 0.305 (in-sample avg dev_std = 0.229)
NEC for r=0.2 all L1 = 0.087 +- 0.238 (in-sample avg dev_std = 0.229)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.98
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6837898
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.921
NEC for r=0.4 class 0.0 = 0.011 +- 0.281 (in-sample avg dev_std = 0.252)
NEC for r=0.4 class 1.0 = 0.133 +- 0.281 (in-sample avg dev_std = 0.252)
NEC for r=0.4 all KL = 0.102 +- 0.281 (in-sample avg dev_std = 0.252)
NEC for r=0.4 all L1 = 0.071 +- 0.210 (in-sample avg dev_std = 0.252)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.98
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6816638
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.956
NEC for r=0.8 class 0.0 = 0.015 +- 0.249 (in-sample avg dev_std = 0.295)
NEC for r=0.8 class 1.0 = 0.086 +- 0.249 (in-sample avg dev_std = 0.295)
NEC for r=0.8 all KL = 0.085 +- 0.249 (in-sample avg dev_std = 0.295)
NEC for r=0.8 all L1 = 0.05 +- 0.155 (in-sample avg dev_std = 0.295)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:42:45 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 01:42:45 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 01:42:45 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:42:45 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 01:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:42:45 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:42:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.573
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.624
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.609
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.566
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.540
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.492
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.417
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.376
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.362
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.361
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.581
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.626
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.650
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.655
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.648


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5729839999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.996
SUFF_SIMPLE for r=0.05 class 0.0 = 0.994 +- 0.078 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.994 +- 0.078 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.05 all KL = 0.99 +- 0.078 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.05 all L1 = 0.994 +- 0.048 (in-sample avg dev_std = 0.101)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6235920000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.997
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.074 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.993 +- 0.074 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.1 all KL = 0.99 +- 0.074 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.1 all L1 = 0.995 +- 0.042 (in-sample avg dev_std = 0.094)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6085740000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.997
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.072 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.993 +- 0.072 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.2 all KL = 0.991 +- 0.072 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.2 all L1 = 0.995 +- 0.041 (in-sample avg dev_std = 0.092)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.56628
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.996
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.081 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.993 +- 0.081 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.4 all KL = 0.99 +- 0.081 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.4 all L1 = 0.994 +- 0.049 (in-sample avg dev_std = 0.101)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5399259999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.989
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.112 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.981 +- 0.112 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.8 all KL = 0.986 +- 0.112 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.8 all L1 = 0.989 +- 0.091 (in-sample avg dev_std = 0.063)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.818
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4918258
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.75
SUFF_SIMPLE for r=0.05 class 0.0 = 1.0 +- 0.268 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.849 +- 0.268 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.05 all KL = 0.901 +- 0.268 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.05 all L1 = 0.923 +- 0.210 (in-sample avg dev_std = 0.270)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.818
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4167548
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.747
SUFF_SIMPLE for r=0.1 class 0.0 = 1.0 +- 0.273 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.842 +- 0.273 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 all KL = 0.898 +- 0.273 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 all L1 = 0.92 +- 0.216 (in-sample avg dev_std = 0.269)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.818
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3760186
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.739
SUFF_SIMPLE for r=0.2 class 0.0 = 1.0 +- 0.286 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.826 +- 0.286 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.2 all KL = 0.888 +- 0.286 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.2 all L1 = 0.912 +- 0.226 (in-sample avg dev_std = 0.278)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3623914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.725
SUFF_SIMPLE for r=0.4 class 0.0 = 1.0 +- 0.303 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.802 +- 0.303 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.4 all KL = 0.876 +- 0.303 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.4 all L1 = 0.9 +- 0.244 (in-sample avg dev_std = 0.279)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.818
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.3613786
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.687
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.343 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.733 +- 0.343 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.8 all KL = 0.835 +- 0.343 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.8 all L1 = 0.865 +- 0.281 (in-sample avg dev_std = 0.288)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5808394
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.964
SUFF_SIMPLE for r=0.05 class 0.0 = 0.96 +- 0.206 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.965 +- 0.206 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.05 all KL = 0.943 +- 0.206 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.05 all L1 = 0.962 +- 0.145 (in-sample avg dev_std = 0.231)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6264194
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.967
SUFF_SIMPLE for r=0.1 class 0.0 = 0.96 +- 0.196 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.971 +- 0.196 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 all KL = 0.949 +- 0.196 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 all L1 = 0.965 +- 0.143 (in-sample avg dev_std = 0.208)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.64957
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.971
SUFF_SIMPLE for r=0.2 class 0.0 = 0.964 +- 0.180 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.979 +- 0.180 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.2 all KL = 0.96 +- 0.180 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.2 all L1 = 0.971 +- 0.136 (in-sample avg dev_std = 0.169)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6553962
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.973
SUFF_SIMPLE for r=0.4 class 0.0 = 0.969 +- 0.176 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.976 +- 0.176 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.4 all KL = 0.962 +- 0.176 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.4 all L1 = 0.972 +- 0.135 (in-sample avg dev_std = 0.159)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6484614
len(reference) = 4957
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.972
SUFF_SIMPLE for r=0.8 class 0.0 = 0.986 +- 0.152 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.972 +- 0.152 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.8 all KL = 0.976 +- 0.152 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.8 all L1 = 0.979 +- 0.131 (in-sample avg dev_std = 0.032)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5729839999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.997
NEC for r=0.05 class 0.0 = 0.0 +- 0.061 (in-sample avg dev_std = 0.062)
NEC for r=0.05 class 1.0 = 0.007 +- 0.061 (in-sample avg dev_std = 0.062)
NEC for r=0.05 all KL = 0.005 +- 0.061 (in-sample avg dev_std = 0.062)
NEC for r=0.05 all L1 = 0.004 +- 0.046 (in-sample avg dev_std = 0.062)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6235920000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.998
NEC for r=0.1 class 0.0 = 0.0 +- 0.056 (in-sample avg dev_std = 0.075)
NEC for r=0.1 class 1.0 = 0.005 +- 0.056 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all KL = 0.005 +- 0.056 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all L1 = 0.003 +- 0.034 (in-sample avg dev_std = 0.075)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6085740000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.999
NEC for r=0.2 class 0.0 = 0.0 +- 0.044 (in-sample avg dev_std = 0.056)
NEC for r=0.2 class 1.0 = 0.003 +- 0.044 (in-sample avg dev_std = 0.056)
NEC for r=0.2 all KL = 0.002 +- 0.044 (in-sample avg dev_std = 0.056)
NEC for r=0.2 all L1 = 0.002 +- 0.030 (in-sample avg dev_std = 0.056)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.56628
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.999
NEC for r=0.4 class 0.0 = 0.0 +- 0.045 (in-sample avg dev_std = 0.059)
NEC for r=0.4 class 1.0 = 0.003 +- 0.045 (in-sample avg dev_std = 0.059)
NEC for r=0.4 all KL = 0.003 +- 0.045 (in-sample avg dev_std = 0.059)
NEC for r=0.4 all L1 = 0.002 +- 0.026 (in-sample avg dev_std = 0.059)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5399259999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.0 +- 0.040 (in-sample avg dev_std = 0.047)
NEC for r=0.8 class 1.0 = 0.002 +- 0.040 (in-sample avg dev_std = 0.047)
NEC for r=0.8 all KL = 0.002 +- 0.040 (in-sample avg dev_std = 0.047)
NEC for r=0.8 all L1 = 0.001 +- 0.024 (in-sample avg dev_std = 0.047)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.818
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4918258
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.726
NEC for r=0.05 class 0.0 = 0.0 +- 0.327 (in-sample avg dev_std = 0.448)
NEC for r=0.05 class 1.0 = 0.255 +- 0.327 (in-sample avg dev_std = 0.448)
NEC for r=0.05 all KL = 0.188 +- 0.327 (in-sample avg dev_std = 0.448)
NEC for r=0.05 all L1 = 0.129 +- 0.229 (in-sample avg dev_std = 0.448)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.818
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4167548
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.775
NEC for r=0.1 class 0.0 = 0.0 +- 0.247 (in-sample avg dev_std = 0.349)
NEC for r=0.1 class 1.0 = 0.139 +- 0.247 (in-sample avg dev_std = 0.349)
NEC for r=0.1 all KL = 0.109 +- 0.247 (in-sample avg dev_std = 0.349)
NEC for r=0.1 all L1 = 0.07 +- 0.163 (in-sample avg dev_std = 0.349)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.818
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3760186
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.789
NEC for r=0.2 class 0.0 = 0.0 +- 0.203 (in-sample avg dev_std = 0.280)
NEC for r=0.2 class 1.0 = 0.091 +- 0.203 (in-sample avg dev_std = 0.280)
NEC for r=0.2 all KL = 0.071 +- 0.203 (in-sample avg dev_std = 0.280)
NEC for r=0.2 all L1 = 0.046 +- 0.135 (in-sample avg dev_std = 0.280)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3623914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.793
NEC for r=0.4 class 0.0 = 0.0 +- 0.182 (in-sample avg dev_std = 0.238)
NEC for r=0.4 class 1.0 = 0.074 +- 0.182 (in-sample avg dev_std = 0.238)
NEC for r=0.4 all KL = 0.056 +- 0.182 (in-sample avg dev_std = 0.238)
NEC for r=0.4 all L1 = 0.037 +- 0.125 (in-sample avg dev_std = 0.238)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.818
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.3613786
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.791
NEC for r=0.8 class 0.0 = 0.0 +- 0.179 (in-sample avg dev_std = 0.209)
NEC for r=0.8 class 1.0 = 0.07 +- 0.179 (in-sample avg dev_std = 0.209)
NEC for r=0.8 all KL = 0.05 +- 0.179 (in-sample avg dev_std = 0.209)
NEC for r=0.8 all L1 = 0.035 +- 0.133 (in-sample avg dev_std = 0.209)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5808394
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.909
NEC for r=0.05 class 0.0 = 0.013 +- 0.293 (in-sample avg dev_std = 0.250)
NEC for r=0.05 class 1.0 = 0.164 +- 0.293 (in-sample avg dev_std = 0.250)
NEC for r=0.05 all KL = 0.118 +- 0.293 (in-sample avg dev_std = 0.250)
NEC for r=0.05 all L1 = 0.087 +- 0.230 (in-sample avg dev_std = 0.250)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6264194
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.932
NEC for r=0.1 class 0.0 = 0.017 +- 0.253 (in-sample avg dev_std = 0.180)
NEC for r=0.1 class 1.0 = 0.11 +- 0.253 (in-sample avg dev_std = 0.180)
NEC for r=0.1 all KL = 0.082 +- 0.253 (in-sample avg dev_std = 0.180)
NEC for r=0.1 all L1 = 0.063 +- 0.203 (in-sample avg dev_std = 0.180)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.64957
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.942
NEC for r=0.2 class 0.0 = 0.018 +- 0.238 (in-sample avg dev_std = 0.186)
NEC for r=0.2 class 1.0 = 0.092 +- 0.238 (in-sample avg dev_std = 0.186)
NEC for r=0.2 all KL = 0.071 +- 0.238 (in-sample avg dev_std = 0.186)
NEC for r=0.2 all L1 = 0.055 +- 0.188 (in-sample avg dev_std = 0.186)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6553962
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.942
NEC for r=0.4 class 0.0 = 0.022 +- 0.239 (in-sample avg dev_std = 0.216)
NEC for r=0.4 class 1.0 = 0.087 +- 0.239 (in-sample avg dev_std = 0.216)
NEC for r=0.4 all KL = 0.074 +- 0.239 (in-sample avg dev_std = 0.216)
NEC for r=0.4 all L1 = 0.054 +- 0.183 (in-sample avg dev_std = 0.216)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6484614
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.965
NEC for r=0.8 class 0.0 = 0.023 +- 0.203 (in-sample avg dev_std = 0.250)
NEC for r=0.8 class 1.0 = 0.051 +- 0.203 (in-sample avg dev_std = 0.250)
NEC for r=0.8 all KL = 0.059 +- 0.203 (in-sample avg dev_std = 0.250)
NEC for r=0.8 all L1 = 0.037 +- 0.133 (in-sample avg dev_std = 0.250)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:01:43 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 02:01:44 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 02:01:44 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:01:44 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 02:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:01:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:01:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:01:44 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:01:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.579
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.691
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.747
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.761
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.763
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.725
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.723
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.723
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.723
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.723
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.567
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.619
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.653
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.676
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.695


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5794159999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.996
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.091 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.988 +- 0.091 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.05 all KL = 0.986 +- 0.091 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.05 all L1 = 0.993 +- 0.048 (in-sample avg dev_std = 0.122)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.691082
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.999
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.039 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.039 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.1 all KL = 0.997 +- 0.039 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.1 all L1 = 0.998 +- 0.017 (in-sample avg dev_std = 0.053)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.746906
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.024 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.024 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.2 all KL = 0.999 +- 0.024 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.2 all L1 = 0.999 +- 0.011 (in-sample avg dev_std = 0.035)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7613
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  1.0
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.022 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.022 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 all KL = 0.999 +- 0.022 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 all L1 = 0.999 +- 0.010 (in-sample avg dev_std = 0.032)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7630060000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.864
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7245484000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.862
SUFF_SIMPLE for r=0.05 class 0.0 = 0.991 +- 0.066 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.066 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.05 all KL = 0.991 +- 0.066 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.05 all L1 = 0.996 +- 0.031 (in-sample avg dev_std = 0.091)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.864
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7230476
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.862
SUFF_SIMPLE for r=0.1 class 0.0 = 0.993 +- 0.060 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.060 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.1 all KL = 0.992 +- 0.060 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.1 all L1 = 0.996 +- 0.027 (in-sample avg dev_std = 0.082)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.864
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7227928
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.862
SUFF_SIMPLE for r=0.2 class 0.0 = 0.993 +- 0.062 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.062 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.2 all KL = 0.992 +- 0.062 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.2 all L1 = 0.996 +- 0.027 (in-sample avg dev_std = 0.084)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.864
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7227802
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.863
SUFF_SIMPLE for r=0.4 class 0.0 = 0.994 +- 0.057 (in-sample avg dev_std = 0.078)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.057 (in-sample avg dev_std = 0.078)
SUFF_SIMPLE for r=0.4 all KL = 0.993 +- 0.057 (in-sample avg dev_std = 0.078)
SUFF_SIMPLE for r=0.4 all L1 = 0.997 +- 0.025 (in-sample avg dev_std = 0.078)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.864
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7227802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.863
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.050 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.050 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.8 all KL = 0.995 +- 0.050 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.8 all L1 = 0.998 +- 0.023 (in-sample avg dev_std = 0.066)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5665304
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.952
SUFF_SIMPLE for r=0.05 class 0.0 = 0.951 +- 0.238 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.945 +- 0.238 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.05 all KL = 0.927 +- 0.238 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.05 all L1 = 0.948 +- 0.173 (in-sample avg dev_std = 0.256)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6188512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.958
SUFF_SIMPLE for r=0.1 class 0.0 = 0.954 +- 0.214 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.965 +- 0.214 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.1 all KL = 0.944 +- 0.214 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.1 all L1 = 0.959 +- 0.159 (in-sample avg dev_std = 0.221)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6533772
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.972
SUFF_SIMPLE for r=0.2 class 0.0 = 0.96 +- 0.152 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.152 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.2 all KL = 0.973 +- 0.152 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.2 all L1 = 0.979 +- 0.118 (in-sample avg dev_std = 0.126)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6760868
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.971
SUFF_SIMPLE for r=0.4 class 0.0 = 0.961 +- 0.148 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.148 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.4 all KL = 0.975 +- 0.148 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.4 all L1 = 0.98 +- 0.118 (in-sample avg dev_std = 0.105)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.991
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6949712
len(reference) = 4958
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.981
SUFF_SIMPLE for r=0.8 class 0.0 = 0.982 +- 0.096 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.096 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.8 all KL = 0.99 +- 0.096 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.8 all L1 = 0.991 +- 0.083 (in-sample avg dev_std = 0.012)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5794159999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.963
NEC for r=0.05 class 0.0 = 0.0 +- 0.235 (in-sample avg dev_std = 0.311)
NEC for r=0.05 class 1.0 = 0.092 +- 0.235 (in-sample avg dev_std = 0.311)
NEC for r=0.05 all KL = 0.084 +- 0.235 (in-sample avg dev_std = 0.311)
NEC for r=0.05 all L1 = 0.051 +- 0.149 (in-sample avg dev_std = 0.311)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.691082
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.973
NEC for r=0.1 class 0.0 = 0.001 +- 0.204 (in-sample avg dev_std = 0.268)
NEC for r=0.1 class 1.0 = 0.068 +- 0.204 (in-sample avg dev_std = 0.268)
NEC for r=0.1 all KL = 0.066 +- 0.204 (in-sample avg dev_std = 0.268)
NEC for r=0.1 all L1 = 0.038 +- 0.125 (in-sample avg dev_std = 0.268)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.746906
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.985
NEC for r=0.2 class 0.0 = 0.001 +- 0.159 (in-sample avg dev_std = 0.221)
NEC for r=0.2 class 1.0 = 0.041 +- 0.159 (in-sample avg dev_std = 0.221)
NEC for r=0.2 all KL = 0.043 +- 0.159 (in-sample avg dev_std = 0.221)
NEC for r=0.2 all L1 = 0.023 +- 0.088 (in-sample avg dev_std = 0.221)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7613
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.99
NEC for r=0.4 class 0.0 = 0.0 +- 0.127 (in-sample avg dev_std = 0.182)
NEC for r=0.4 class 1.0 = 0.028 +- 0.127 (in-sample avg dev_std = 0.182)
NEC for r=0.4 all KL = 0.03 +- 0.127 (in-sample avg dev_std = 0.182)
NEC for r=0.4 all L1 = 0.016 +- 0.067 (in-sample avg dev_std = 0.182)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7630060000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.994
NEC for r=0.8 class 0.0 = 0.0 +- 0.099 (in-sample avg dev_std = 0.140)
NEC for r=0.8 class 1.0 = 0.017 +- 0.099 (in-sample avg dev_std = 0.140)
NEC for r=0.8 all KL = 0.017 +- 0.099 (in-sample avg dev_std = 0.140)
NEC for r=0.8 all L1 = 0.009 +- 0.055 (in-sample avg dev_std = 0.140)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.864
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7245484000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.778
NEC for r=0.05 class 0.0 = 0.001 +- 0.317 (in-sample avg dev_std = 0.472)
NEC for r=0.05 class 1.0 = 0.256 +- 0.317 (in-sample avg dev_std = 0.472)
NEC for r=0.05 all KL = 0.199 +- 0.317 (in-sample avg dev_std = 0.472)
NEC for r=0.05 all L1 = 0.13 +- 0.202 (in-sample avg dev_std = 0.472)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.864
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7230476
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.837
NEC for r=0.1 class 0.0 = 0.002 +- 0.197 (in-sample avg dev_std = 0.287)
NEC for r=0.1 class 1.0 = 0.086 +- 0.197 (in-sample avg dev_std = 0.287)
NEC for r=0.1 all KL = 0.075 +- 0.197 (in-sample avg dev_std = 0.287)
NEC for r=0.1 all L1 = 0.044 +- 0.111 (in-sample avg dev_std = 0.287)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.864
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7227928
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.853
NEC for r=0.2 class 0.0 = 0.002 +- 0.127 (in-sample avg dev_std = 0.186)
NEC for r=0.2 class 1.0 = 0.035 +- 0.127 (in-sample avg dev_std = 0.186)
NEC for r=0.2 all KL = 0.032 +- 0.127 (in-sample avg dev_std = 0.186)
NEC for r=0.2 all L1 = 0.018 +- 0.069 (in-sample avg dev_std = 0.186)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.864
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7227802
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.859
NEC for r=0.4 class 0.0 = 0.003 +- 0.089 (in-sample avg dev_std = 0.131)
NEC for r=0.4 class 1.0 = 0.014 +- 0.089 (in-sample avg dev_std = 0.131)
NEC for r=0.4 all KL = 0.016 +- 0.089 (in-sample avg dev_std = 0.131)
NEC for r=0.4 all L1 = 0.008 +- 0.045 (in-sample avg dev_std = 0.131)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.864
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7227802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.862
NEC for r=0.8 class 0.0 = 0.002 +- 0.066 (in-sample avg dev_std = 0.098)
NEC for r=0.8 class 1.0 = 0.008 +- 0.066 (in-sample avg dev_std = 0.098)
NEC for r=0.8 all KL = 0.009 +- 0.066 (in-sample avg dev_std = 0.098)
NEC for r=0.8 all L1 = 0.005 +- 0.032 (in-sample avg dev_std = 0.098)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5665304
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.824
NEC for r=0.05 class 0.0 = 0.014 +- 0.391 (in-sample avg dev_std = 0.440)
NEC for r=0.05 class 1.0 = 0.375 +- 0.391 (in-sample avg dev_std = 0.440)
NEC for r=0.05 all KL = 0.265 +- 0.391 (in-sample avg dev_std = 0.440)
NEC for r=0.05 all L1 = 0.192 +- 0.302 (in-sample avg dev_std = 0.440)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6188512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.872
NEC for r=0.1 class 0.0 = 0.015 +- 0.353 (in-sample avg dev_std = 0.422)
NEC for r=0.1 class 1.0 = 0.288 +- 0.353 (in-sample avg dev_std = 0.422)
NEC for r=0.1 all KL = 0.218 +- 0.353 (in-sample avg dev_std = 0.422)
NEC for r=0.1 all L1 = 0.15 +- 0.262 (in-sample avg dev_std = 0.422)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6533772
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.91
NEC for r=0.2 class 0.0 = 0.019 +- 0.316 (in-sample avg dev_std = 0.375)
NEC for r=0.2 class 1.0 = 0.211 +- 0.316 (in-sample avg dev_std = 0.375)
NEC for r=0.2 all KL = 0.172 +- 0.316 (in-sample avg dev_std = 0.375)
NEC for r=0.2 all L1 = 0.114 +- 0.227 (in-sample avg dev_std = 0.375)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6760868
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.933
NEC for r=0.4 class 0.0 = 0.025 +- 0.281 (in-sample avg dev_std = 0.322)
NEC for r=0.4 class 1.0 = 0.149 +- 0.281 (in-sample avg dev_std = 0.322)
NEC for r=0.4 all KL = 0.13 +- 0.281 (in-sample avg dev_std = 0.322)
NEC for r=0.4 all L1 = 0.086 +- 0.204 (in-sample avg dev_std = 0.322)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6949712
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.958
NEC for r=0.8 class 0.0 = 0.028 +- 0.224 (in-sample avg dev_std = 0.284)
NEC for r=0.8 class 1.0 = 0.075 +- 0.224 (in-sample avg dev_std = 0.284)
NEC for r=0.8 all KL = 0.084 +- 0.224 (in-sample avg dev_std = 0.284)
NEC for r=0.8 all L1 = 0.051 +- 0.147 (in-sample avg dev_std = 0.284)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:20:49 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 02:20:49 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:49 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:49 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 02:20:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:20:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.588
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.658
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.672
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.658
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.641
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.531
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.453
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.404
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.386
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.384
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.588
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.633
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.660
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.672
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.673


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5881980000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.99
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.149 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.972 +- 0.149 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.05 all KL = 0.964 +- 0.149 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.05 all L1 = 0.984 +- 0.069 (in-sample avg dev_std = 0.172)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6579259999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.995
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.110 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.985 +- 0.110 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.1 all KL = 0.979 +- 0.110 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.1 all L1 = 0.991 +- 0.048 (in-sample avg dev_std = 0.130)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6717
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.993
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.132 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.978 +- 0.132 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.2 all KL = 0.972 +- 0.132 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.2 all L1 = 0.988 +- 0.059 (in-sample avg dev_std = 0.153)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.657956
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.99
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.152 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.972 +- 0.152 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 all KL = 0.964 +- 0.152 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 all L1 = 0.984 +- 0.073 (in-sample avg dev_std = 0.174)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.641064
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.996
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.074 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.991 +- 0.074 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.8 all KL = 0.994 +- 0.074 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.8 all L1 = 0.995 +- 0.058 (in-sample avg dev_std = 0.039)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5309848
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.679
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.370 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.546 +- 0.370 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.05 all KL = 0.725 +- 0.370 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.05 all L1 = 0.771 +- 0.308 (in-sample avg dev_std = 0.313)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4525552
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.68
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.368 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.551 +- 0.368 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.1 all KL = 0.729 +- 0.368 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.1 all L1 = 0.773 +- 0.307 (in-sample avg dev_std = 0.306)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4042606
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.683
SUFF_SIMPLE for r=0.2 class 0.0 = 1.0 +- 0.367 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.552 +- 0.367 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.2 all KL = 0.73 +- 0.367 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.2 all L1 = 0.774 +- 0.306 (in-sample avg dev_std = 0.308)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3859232
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.683
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.366 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.555 +- 0.366 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.4 all KL = 0.731 +- 0.366 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.4 all L1 = 0.775 +- 0.305 (in-sample avg dev_std = 0.307)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.883
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.3839996
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.659
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.382 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.524 +- 0.382 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.8 all KL = 0.72 +- 0.382 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.8 all L1 = 0.76 +- 0.323 (in-sample avg dev_std = 0.266)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.969
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.587751
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.928
SUFF_SIMPLE for r=0.05 class 0.0 = 0.972 +- 0.312 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.861 +- 0.312 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.05 all KL = 0.87 +- 0.312 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.05 all L1 = 0.917 +- 0.209 (in-sample avg dev_std = 0.345)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.969
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6332434000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.934
SUFF_SIMPLE for r=0.1 class 0.0 = 0.974 +- 0.304 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.867 +- 0.304 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.1 all KL = 0.875 +- 0.304 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.1 all L1 = 0.921 +- 0.203 (in-sample avg dev_std = 0.332)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.969
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6602308
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.953
SUFF_SIMPLE for r=0.2 class 0.0 = 0.975 +- 0.284 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.886 +- 0.284 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.2 all KL = 0.897 +- 0.284 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.2 all L1 = 0.931 +- 0.199 (in-sample avg dev_std = 0.273)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.969
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6722484
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.954
SUFF_SIMPLE for r=0.4 class 0.0 = 0.978 +- 0.268 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.896 +- 0.268 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 all KL = 0.911 +- 0.268 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 all L1 = 0.937 +- 0.196 (in-sample avg dev_std = 0.236)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.969
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6725572
len(reference) = 4961
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.945
SUFF_SIMPLE for r=0.8 class 0.0 = 0.992 +- 0.218 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.914 +- 0.218 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 all KL = 0.946 +- 0.218 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 all L1 = 0.953 +- 0.187 (in-sample avg dev_std = 0.030)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5881980000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.938
NEC for r=0.05 class 0.0 = 0.0 +- 0.306 (in-sample avg dev_std = 0.328)
NEC for r=0.05 class 1.0 = 0.135 +- 0.306 (in-sample avg dev_std = 0.328)
NEC for r=0.05 all KL = 0.126 +- 0.306 (in-sample avg dev_std = 0.328)
NEC for r=0.05 all L1 = 0.075 +- 0.198 (in-sample avg dev_std = 0.328)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6579259999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.959
NEC for r=0.1 class 0.0 = 0.0 +- 0.281 (in-sample avg dev_std = 0.325)
NEC for r=0.1 class 1.0 = 0.103 +- 0.281 (in-sample avg dev_std = 0.325)
NEC for r=0.1 all KL = 0.11 +- 0.281 (in-sample avg dev_std = 0.325)
NEC for r=0.1 all L1 = 0.057 +- 0.158 (in-sample avg dev_std = 0.325)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6717
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.979
NEC for r=0.2 class 0.0 = 0.0 +- 0.219 (in-sample avg dev_std = 0.258)
NEC for r=0.2 class 1.0 = 0.057 +- 0.219 (in-sample avg dev_std = 0.258)
NEC for r=0.2 all KL = 0.071 +- 0.219 (in-sample avg dev_std = 0.258)
NEC for r=0.2 all L1 = 0.032 +- 0.105 (in-sample avg dev_std = 0.258)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.657956
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.987
NEC for r=0.4 class 0.0 = 0.0 +- 0.188 (in-sample avg dev_std = 0.219)
NEC for r=0.4 class 1.0 = 0.04 +- 0.188 (in-sample avg dev_std = 0.219)
NEC for r=0.4 all KL = 0.054 +- 0.188 (in-sample avg dev_std = 0.219)
NEC for r=0.4 all L1 = 0.022 +- 0.081 (in-sample avg dev_std = 0.219)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.641064
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.994
NEC for r=0.8 class 0.0 = 0.0 +- 0.132 (in-sample avg dev_std = 0.154)
NEC for r=0.8 class 1.0 = 0.019 +- 0.132 (in-sample avg dev_std = 0.154)
NEC for r=0.8 all KL = 0.028 +- 0.132 (in-sample avg dev_std = 0.154)
NEC for r=0.8 all L1 = 0.011 +- 0.051 (in-sample avg dev_std = 0.154)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5309848
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.776
NEC for r=0.05 class 0.0 = 0.001 +- 0.387 (in-sample avg dev_std = 0.573)
NEC for r=0.05 class 1.0 = 0.509 +- 0.387 (in-sample avg dev_std = 0.573)
NEC for r=0.05 all KL = 0.341 +- 0.387 (in-sample avg dev_std = 0.573)
NEC for r=0.05 all L1 = 0.257 +- 0.283 (in-sample avg dev_std = 0.573)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4525552
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.828
NEC for r=0.1 class 0.0 = 0.001 +- 0.323 (in-sample avg dev_std = 0.478)
NEC for r=0.1 class 1.0 = 0.366 +- 0.323 (in-sample avg dev_std = 0.478)
NEC for r=0.1 all KL = 0.249 +- 0.323 (in-sample avg dev_std = 0.478)
NEC for r=0.1 all L1 = 0.185 +- 0.231 (in-sample avg dev_std = 0.478)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4042606
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.82
NEC for r=0.2 class 0.0 = 0.001 +- 0.278 (in-sample avg dev_std = 0.395)
NEC for r=0.2 class 1.0 = 0.308 +- 0.278 (in-sample avg dev_std = 0.395)
NEC for r=0.2 all KL = 0.195 +- 0.278 (in-sample avg dev_std = 0.395)
NEC for r=0.2 all L1 = 0.156 +- 0.215 (in-sample avg dev_std = 0.395)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3859232
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.809
NEC for r=0.4 class 0.0 = 0.001 +- 0.247 (in-sample avg dev_std = 0.326)
NEC for r=0.4 class 1.0 = 0.274 +- 0.247 (in-sample avg dev_std = 0.326)
NEC for r=0.4 all KL = 0.159 +- 0.247 (in-sample avg dev_std = 0.326)
NEC for r=0.4 all L1 = 0.139 +- 0.210 (in-sample avg dev_std = 0.326)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.883
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.3839996
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.808
NEC for r=0.8 class 0.0 = 0.0 +- 0.222 (in-sample avg dev_std = 0.271)
NEC for r=0.8 class 1.0 = 0.246 +- 0.222 (in-sample avg dev_std = 0.271)
NEC for r=0.8 all KL = 0.13 +- 0.222 (in-sample avg dev_std = 0.271)
NEC for r=0.8 all L1 = 0.124 +- 0.204 (in-sample avg dev_std = 0.271)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.969
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.587751
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.769
NEC for r=0.05 class 0.0 = 0.006 +- 0.439 (in-sample avg dev_std = 0.461)
NEC for r=0.05 class 1.0 = 0.456 +- 0.439 (in-sample avg dev_std = 0.461)
NEC for r=0.05 all KL = 0.337 +- 0.439 (in-sample avg dev_std = 0.461)
NEC for r=0.05 all L1 = 0.228 +- 0.323 (in-sample avg dev_std = 0.461)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.969
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6332434000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.827
NEC for r=0.1 class 0.0 = 0.006 +- 0.405 (in-sample avg dev_std = 0.450)
NEC for r=0.1 class 1.0 = 0.346 +- 0.405 (in-sample avg dev_std = 0.450)
NEC for r=0.1 all KL = 0.28 +- 0.405 (in-sample avg dev_std = 0.450)
NEC for r=0.1 all L1 = 0.174 +- 0.279 (in-sample avg dev_std = 0.450)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.969
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6602308
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.874
NEC for r=0.2 class 0.0 = 0.009 +- 0.368 (in-sample avg dev_std = 0.413)
NEC for r=0.2 class 1.0 = 0.254 +- 0.368 (in-sample avg dev_std = 0.413)
NEC for r=0.2 all KL = 0.224 +- 0.368 (in-sample avg dev_std = 0.413)
NEC for r=0.2 all L1 = 0.13 +- 0.241 (in-sample avg dev_std = 0.413)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.969
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6722484
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.905
NEC for r=0.4 class 0.0 = 0.014 +- 0.330 (in-sample avg dev_std = 0.364)
NEC for r=0.4 class 1.0 = 0.184 +- 0.330 (in-sample avg dev_std = 0.364)
NEC for r=0.4 all KL = 0.171 +- 0.330 (in-sample avg dev_std = 0.364)
NEC for r=0.4 all L1 = 0.098 +- 0.212 (in-sample avg dev_std = 0.364)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.969
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6725572
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.935
NEC for r=0.8 class 0.0 = 0.019 +- 0.300 (in-sample avg dev_std = 0.355)
NEC for r=0.8 class 1.0 = 0.132 +- 0.300 (in-sample avg dev_std = 0.355)
NEC for r=0.8 all KL = 0.138 +- 0.300 (in-sample avg dev_std = 0.355)
NEC for r=0.8 all L1 = 0.075 +- 0.179 (in-sample avg dev_std = 0.355)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.999, 0.998, 0.998, 0.998, 1.0], 'all_L1': [0.999, 0.999, 0.999, 0.999, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.994, 0.993, 0.999, 0.997, 1.0], 'all_L1': [0.998, 0.997, 1.0, 0.999, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.991, 0.988, 0.992, 0.993, 0.995], 'all_L1': [0.996, 0.995, 0.997, 0.997, 0.997]}), defaultdict(<class 'list'>, {'all_KL': [0.991, 0.989, 0.988, 0.991, 0.988], 'all_L1': [0.994, 0.993, 0.993, 0.994, 0.989]}), defaultdict(<class 'list'>, {'all_KL': [0.998, 0.996, 0.996, 0.998, 0.998], 'all_L1': [0.999, 0.998, 0.998, 0.999, 0.999]}), defaultdict(<class 'list'>, {'all_KL': [0.991, 0.99, 0.997, 0.994, 0.983], 'all_L1': [0.996, 0.995, 0.998, 0.997, 0.988]}), defaultdict(<class 'list'>, {'all_KL': [0.969, 0.975, 0.982, 0.975, 0.971], 'all_L1': [0.985, 0.987, 0.99, 0.987, 0.98]}), defaultdict(<class 'list'>, {'all_KL': [0.99, 0.99, 0.991, 0.99, 0.986], 'all_L1': [0.994, 0.995, 0.995, 0.994, 0.989]}), defaultdict(<class 'list'>, {'all_KL': [0.986, 0.997, 0.999, 0.999, 1.0], 'all_L1': [0.993, 0.998, 0.999, 0.999, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.964, 0.979, 0.972, 0.964, 0.994], 'all_L1': [0.984, 0.991, 0.988, 0.984, 0.995]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.001, 0.0, 0.0, 0.0, 0.0], 'all_L1': [0.0, 0.0, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.068, 0.054, 0.039, 0.021, 0.013], 'all_L1': [0.043, 0.031, 0.019, 0.009, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.059, 0.044, 0.038, 0.024, 0.012], 'all_L1': [0.041, 0.027, 0.02, 0.012, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.003, 0.0, 0.002, 0.001, 0.002], 'all_L1': [0.002, 0.0, 0.001, 0.001, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.056, 0.048, 0.03, 0.018, 0.01], 'all_L1': [0.035, 0.026, 0.014, 0.008, 0.004]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.0, 0.0, 0.0], 'all_L1': [0.0, 0.0, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.063, 0.044, 0.038, 0.02], 'all_L1': [0.051, 0.041, 0.025, 0.02, 0.01]}), defaultdict(<class 'list'>, {'all_KL': [0.005, 0.005, 0.002, 0.003, 0.002], 'all_L1': [0.004, 0.003, 0.002, 0.002, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.084, 0.066, 0.043, 0.03, 0.017], 'all_L1': [0.051, 0.038, 0.023, 0.016, 0.009]}), defaultdict(<class 'list'>, {'all_KL': [0.126, 0.11, 0.071, 0.054, 0.028], 'all_L1': [0.075, 0.057, 0.032, 0.022, 0.011]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.984, 0.986, 0.988, 0.988, 0.99], 'all_L1': [0.994, 0.995, 0.995, 0.995, 0.996]}), defaultdict(<class 'list'>, {'all_KL': [0.98, 0.98, 0.985, 0.981, 0.99], 'all_L1': [0.993, 0.993, 0.995, 0.993, 0.996]}), defaultdict(<class 'list'>, {'all_KL': [0.943, 0.948, 0.948, 0.954, 0.97], 'all_L1': [0.974, 0.976, 0.976, 0.979, 0.986]}), defaultdict(<class 'list'>, {'all_KL': [0.936, 0.936, 0.934, 0.934, 0.928], 'all_L1': [0.947, 0.946, 0.945, 0.945, 0.938]}), defaultdict(<class 'list'>, {'all_KL': [0.981, 0.982, 0.984, 0.986, 0.989], 'all_L1': [0.993, 0.993, 0.994, 0.995, 0.996]}), defaultdict(<class 'list'>, {'all_KL': [0.989, 0.99, 0.992, 0.99, 0.995], 'all_L1': [0.995, 0.995, 0.996, 0.995, 0.997]}), defaultdict(<class 'list'>, {'all_KL': [0.993, 0.993, 0.994, 0.995, 0.996], 'all_L1': [0.997, 0.997, 0.997, 0.998, 0.998]}), defaultdict(<class 'list'>, {'all_KL': [0.901, 0.898, 0.888, 0.876, 0.835], 'all_L1': [0.923, 0.92, 0.912, 0.9, 0.865]}), defaultdict(<class 'list'>, {'all_KL': [0.991, 0.992, 0.992, 0.993, 0.995], 'all_L1': [0.996, 0.996, 0.996, 0.997, 0.998]}), defaultdict(<class 'list'>, {'all_KL': [0.725, 0.729, 0.73, 0.731, 0.72], 'all_L1': [0.771, 0.773, 0.774, 0.775, 0.76]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.057, 0.015, 0.009, 0.005, 0.003], 'all_L1': [0.027, 0.007, 0.004, 0.002, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.078, 0.044, 0.033, 0.021, 0.008], 'all_L1': [0.035, 0.018, 0.013, 0.008, 0.003]}), defaultdict(<class 'list'>, {'all_KL': [0.047, 0.043, 0.045, 0.036, 0.024], 'all_L1': [0.024, 0.021, 0.021, 0.016, 0.011]}), defaultdict(<class 'list'>, {'all_KL': [0.09, 0.032, 0.019, 0.016, 0.012], 'all_L1': [0.06, 0.022, 0.015, 0.014, 0.011]}), defaultdict(<class 'list'>, {'all_KL': [0.046, 0.019, 0.013, 0.008, 0.005], 'all_L1': [0.023, 0.008, 0.005, 0.003, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.02, 0.013, 0.007, 0.003], 'all_L1': [0.028, 0.009, 0.005, 0.003, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.135, 0.057, 0.021, 0.011, 0.006], 'all_L1': [0.074, 0.028, 0.01, 0.005, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.188, 0.109, 0.071, 0.056, 0.05], 'all_L1': [0.129, 0.07, 0.046, 0.037, 0.035]}), defaultdict(<class 'list'>, {'all_KL': [0.199, 0.075, 0.032, 0.016, 0.009], 'all_L1': [0.13, 0.044, 0.018, 0.008, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.341, 0.249, 0.195, 0.159, 0.13], 'all_L1': [0.257, 0.185, 0.156, 0.139, 0.124]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.964, 0.965, 0.968, 0.971, 0.988], 'all_L1': [0.974, 0.974, 0.975, 0.977, 0.989]}), defaultdict(<class 'list'>, {'all_KL': [0.961, 0.965, 0.97, 0.974, 0.992], 'all_L1': [0.976, 0.978, 0.981, 0.982, 0.993]}), defaultdict(<class 'list'>, {'all_KL': [0.954, 0.961, 0.962, 0.966, 0.986], 'all_L1': [0.97, 0.972, 0.973, 0.975, 0.988]}), defaultdict(<class 'list'>, {'all_KL': [0.936, 0.941, 0.945, 0.95, 0.965], 'all_L1': [0.956, 0.958, 0.96, 0.962, 0.968]}), defaultdict(<class 'list'>, {'all_KL': [0.966, 0.966, 0.968, 0.972, 0.99], 'all_L1': [0.976, 0.976, 0.976, 0.978, 0.991]}), defaultdict(<class 'list'>, {'all_KL': [0.946, 0.949, 0.952, 0.957, 0.974], 'all_L1': [0.965, 0.966, 0.967, 0.969, 0.978]}), defaultdict(<class 'list'>, {'all_KL': [0.904, 0.92, 0.946, 0.948, 0.968], 'all_L1': [0.942, 0.949, 0.962, 0.962, 0.973]}), defaultdict(<class 'list'>, {'all_KL': [0.943, 0.949, 0.96, 0.962, 0.976], 'all_L1': [0.962, 0.965, 0.971, 0.972, 0.979]}), defaultdict(<class 'list'>, {'all_KL': [0.927, 0.944, 0.973, 0.975, 0.99], 'all_L1': [0.948, 0.959, 0.979, 0.98, 0.991]}), defaultdict(<class 'list'>, {'all_KL': [0.87, 0.875, 0.897, 0.911, 0.946], 'all_L1': [0.917, 0.921, 0.931, 0.937, 0.953]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.121, 0.068, 0.041, 0.05, 0.03], 'all_L1': [0.074, 0.041, 0.026, 0.034, 0.017]}), defaultdict(<class 'list'>, {'all_KL': [0.141, 0.11, 0.1, 0.088, 0.063], 'all_L1': [0.1, 0.079, 0.072, 0.058, 0.032]}), defaultdict(<class 'list'>, {'all_KL': [0.119, 0.099, 0.089, 0.083, 0.059], 'all_L1': [0.086, 0.073, 0.067, 0.058, 0.034]}), defaultdict(<class 'list'>, {'all_KL': [0.115, 0.079, 0.074, 0.068, 0.057], 'all_L1': [0.082, 0.058, 0.057, 0.05, 0.038]}), defaultdict(<class 'list'>, {'all_KL': [0.144, 0.099, 0.077, 0.076, 0.05], 'all_L1': [0.09, 0.06, 0.048, 0.047, 0.026]}), defaultdict(<class 'list'>, {'all_KL': [0.111, 0.075, 0.07, 0.072, 0.058], 'all_L1': [0.077, 0.054, 0.052, 0.05, 0.034]}), defaultdict(<class 'list'>, {'all_KL': [0.169, 0.131, 0.118, 0.102, 0.085], 'all_L1': [0.123, 0.097, 0.087, 0.071, 0.05]}), defaultdict(<class 'list'>, {'all_KL': [0.118, 0.082, 0.071, 0.074, 0.059], 'all_L1': [0.087, 0.063, 0.055, 0.054, 0.037]}), defaultdict(<class 'list'>, {'all_KL': [0.265, 0.218, 0.172, 0.13, 0.084], 'all_L1': [0.192, 0.15, 0.114, 0.086, 0.051]}), defaultdict(<class 'list'>, {'all_KL': [0.337, 0.28, 0.224, 0.171, 0.138], 'all_L1': [0.228, 0.174, 0.13, 0.098, 0.075]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.994 +- 0.005, 0.995 +- 0.003, 0.996 +- 0.004, 0.995 +- 0.005, 0.994 +- 0.007
suff_simple class all_KL  =  0.987 +- 0.011, 0.989 +- 0.007, 0.991 +- 0.008, 0.990 +- 0.011, 0.991 +- 0.009
[[0.999750018119812, 0.9994999766349792, 0.999750018119812, 0.9994999766349792, 1.0], [0.9987499713897705, 0.9984999895095825, 0.999750018119812, 0.9994999766349792, 1.0], [0.9977499842643738, 0.996749997138977, 0.9980000257492065, 0.9982500076293945, 0.9975000023841858], [0.9962499737739563, 0.9962499737739563, 0.9959999918937683, 0.9965000152587891, 0.9884999990463257], [0.9994999766349792, 0.9990000128746033, 0.9990000128746033, 0.9994999766349792, 0.9992499947547913], [0.9975000023841858, 0.996749997138977, 0.9992499947547913, 0.9982500076293945, 0.9877499938011169], [0.9904999732971191, 0.9909999966621399, 0.9932500123977661, 0.9912499785423279, 0.9810000061988831], [0.9962499737739563, 0.9972500205039978, 0.9972500205039978, 0.9962499737739563, 0.9892500042915344], [0.9957500100135803, 0.9992499947547913, 0.999750018119812, 0.999750018119812, 1.0], [0.9904999732971191, 0.9950000047683716, 0.9927499890327454, 0.9900000095367432, 0.9955000281333923]]
[[0.999, 0.998, 0.998, 0.998, 1.0], [0.994, 0.993, 0.999, 0.997, 1.0], [0.991, 0.988, 0.992, 0.993, 0.995], [0.991, 0.989, 0.988, 0.991, 0.988], [0.998, 0.996, 0.996, 0.998, 0.998], [0.991, 0.99, 0.997, 0.994, 0.983], [0.969, 0.975, 0.982, 0.975, 0.971], [0.99, 0.99, 0.991, 0.99, 0.986], [0.986, 0.997, 0.999, 0.999, 1.0], [0.964, 0.979, 0.972, 0.964, 0.994]]
suff_simple_acc_int  =  0.996 +- 0.003, 0.997 +- 0.002, 0.997 +- 0.003, 0.997 +- 0.003, 0.994 +- 0.006
nec class all_L1  =  0.030 +- 0.025, 0.022 +- 0.019, 0.014 +- 0.011, 0.009 +- 0.008, 0.005 +- 0.004
nec class all_KL  =  0.047 +- 0.041, 0.039 +- 0.035, 0.027 +- 0.023, 0.019 +- 0.017, 0.010 +- 0.009
[[1.0, 1.0, 1.0, 1.0, 1.0], [0.9612500071525574, 0.9754999876022339, 0.9869999885559082, 0.9947500228881836, 0.996749997138977], [0.9620000123977661, 0.9794999957084656, 0.9869999885559082, 0.9927499890327454, 0.996749997138977], [0.9987499713897705, 1.0, 0.9994999766349792, 0.999750018119812, 0.9994999766349792], [0.968500018119812, 0.9807500243186951, 0.9909999966621399, 0.9947500228881836, 0.9977499842643738], [1.0, 1.0, 1.0, 1.0, 1.0], [0.9502500295639038, 0.9647499918937683, 0.9804999828338623, 0.9865000247955322, 0.9937499761581421], [0.9965000152587891, 0.9980000257492065, 0.9987499713897705, 0.9987499713897705, 0.9992499947547913], [0.9632499814033508, 0.9732499718666077, 0.9854999780654907, 0.9904999732971191, 0.9942499995231628], [0.9380000233650208, 0.9587500095367432, 0.9794999957084656, 0.9867500066757202, 0.9937499761581421]]
[[0.001, 0.0, 0.0, 0.0, 0.0], [0.068, 0.054, 0.039, 0.021, 0.013], [0.059, 0.044, 0.038, 0.024, 0.012], [0.003, 0.0, 0.002, 0.001, 0.002], [0.056, 0.048, 0.03, 0.018, 0.01], [0.0, 0.0, 0.0, 0.0, 0.0], [0.072, 0.063, 0.044, 0.038, 0.02], [0.005, 0.005, 0.002, 0.003, 0.002], [0.084, 0.066, 0.043, 0.03, 0.017], [0.126, 0.11, 0.071, 0.054, 0.028]]
nec_acc_int  =  0.974 +- 0.022, 0.983 +- 0.015, 0.991 +- 0.008, 0.994 +- 0.005, 0.997 +- 0.002

Eval split val
suff_simple class all_L1  =  0.958 +- 0.067, 0.958 +- 0.067, 0.958 +- 0.067, 0.957 +- 0.068, 0.953 +- 0.076
suff_simple class all_KL  =  0.942 +- 0.078, 0.943 +- 0.077, 0.944 +- 0.078, 0.943 +- 0.079, 0.941 +- 0.088
[[0.9966999888420105, 0.9972749948501587, 0.9975500106811523, 0.9975749850273132, 0.9978500008583069], [0.9958500266075134, 0.9958750009536743, 0.9970250129699707, 0.9961000084877014, 0.997825026512146], [0.9136750102043152, 0.9153000116348267, 0.9154499769210815, 0.9167500138282776, 0.9208750128746033], [0.8423500061035156, 0.841949999332428, 0.8410249948501587, 0.8409249782562256, 0.8340499997138977], [0.9408749938011169, 0.9411249756813049, 0.9415749907493591, 0.9420750141143799, 0.9424999952316284], [0.9661250114440918, 0.9663000106811523, 0.9668499827384949, 0.9664750099182129, 0.9675499796867371], [0.9981250166893005, 0.9981750249862671, 0.9984250068664551, 0.9986749887466431, 0.9989749789237976], [0.7504749894142151, 0.7470750212669373, 0.739425003528595, 0.7253000140190125, 0.6866000294685364], [0.8617500066757202, 0.8623250126838684, 0.8622499704360962, 0.8625500202178955, 0.8629249930381775], [0.679099977016449, 0.680400013923645, 0.6825000047683716, 0.6830000281333923, 0.6585999727249146]]
[[0.984, 0.986, 0.988, 0.988, 0.99], [0.98, 0.98, 0.985, 0.981, 0.99], [0.943, 0.948, 0.948, 0.954, 0.97], [0.936, 0.936, 0.934, 0.934, 0.928], [0.981, 0.982, 0.984, 0.986, 0.989], [0.989, 0.99, 0.992, 0.99, 0.995], [0.993, 0.993, 0.994, 0.995, 0.996], [0.901, 0.898, 0.888, 0.876, 0.835], [0.991, 0.992, 0.992, 0.993, 0.995], [0.725, 0.729, 0.73, 0.731, 0.72]]
suff_simple_acc_int  =  0.895 +- 0.105, 0.895 +- 0.105, 0.894 +- 0.106, 0.893 +- 0.108, 0.887 +- 0.120
nec class all_L1  =  0.079 +- 0.071, 0.041 +- 0.051, 0.029 +- 0.044, 0.024 +- 0.040, 0.020 +- 0.036
nec class all_KL  =  0.124 +- 0.090, 0.066 +- 0.067, 0.045 +- 0.053, 0.033 +- 0.044, 0.025 +- 0.038
[[0.9835249781608582, 0.9961749911308289, 0.9980499744415283, 0.9989500045776367, 0.9994000196456909], [0.9783999919891357, 0.9895250201225281, 0.9926750063896179, 0.9955999851226807, 0.9983999729156494], [0.9142249822616577, 0.9161249995231628, 0.916225016117096, 0.9196500182151794, 0.9232500195503235], [0.8434000015258789, 0.8675000071525574, 0.8718249797821045, 0.8722249865531921, 0.8737999796867371], [0.9304500222206116, 0.9399999976158142, 0.9419749975204468, 0.9432500004768372, 0.9439749717712402], [0.9522749781608582, 0.9641500115394592, 0.9664000272750854, 0.9678750038146973, 0.968500018119812], [0.9498249888420105, 0.9821000099182129, 0.9941250085830688, 0.9971500039100647, 0.99857497215271], [0.7257750034332275, 0.7745500206947327, 0.7886000275611877, 0.7929250001907349, 0.7908750176429749], [0.7775750160217285, 0.8372499942779541, 0.8534749746322632, 0.859375, 0.8615999817848206], [0.7760000228881836, 0.8281750082969666, 0.8197000026702881, 0.809499979019165, 0.8081499934196472]]
[[0.057, 0.015, 0.009, 0.005, 0.003], [0.078, 0.044, 0.033, 0.021, 0.008], [0.047, 0.043, 0.045, 0.036, 0.024], [0.09, 0.032, 0.019, 0.016, 0.012], [0.046, 0.019, 0.013, 0.008, 0.005], [0.058, 0.02, 0.013, 0.007, 0.003], [0.135, 0.057, 0.021, 0.011, 0.006], [0.188, 0.109, 0.071, 0.056, 0.05], [0.199, 0.075, 0.032, 0.016, 0.009], [0.341, 0.249, 0.195, 0.159, 0.13]]
nec_acc_int  =  0.883 +- 0.090, 0.910 +- 0.074, 0.914 +- 0.073, 0.916 +- 0.074, 0.917 +- 0.075

Eval split test
suff_simple class all_L1  =  0.959 +- 0.018, 0.962 +- 0.016, 0.968 +- 0.014, 0.969 +- 0.013, 0.980 +- 0.012
suff_simple class all_KL  =  0.937 +- 0.029, 0.943 +- 0.027, 0.954 +- 0.021, 0.959 +- 0.018, 0.978 +- 0.014
[[0.9596508145332336, 0.9595007300376892, 0.9592005014419556, 0.9604512453079224, 0.9730886816978455], [0.9721583127975464, 0.9736091494560242, 0.97465980052948, 0.9747598767280579, 0.9847715497016907], [0.9690564274787903, 0.9698318839073181, 0.9695317149162292, 0.9710075855255127, 0.980958104133606], [0.9627026319503784, 0.9635031223297119, 0.9642285108566284, 0.967480480670929, 0.9610185027122498], [0.9654042720794678, 0.9644286632537842, 0.9637032151222229, 0.9652791619300842, 0.9790153503417969], [0.9685311317443848, 0.9689063429832458, 0.9696817994117737, 0.971532940864563, 0.9697933793067932], [0.9555233120918274, 0.9645287394523621, 0.9724334478378296, 0.9709075689315796, 0.9706999659538269], [0.963878333568573, 0.9667300581932068, 0.9712327122688293, 0.972858726978302, 0.9722362160682678], [0.9519461393356323, 0.9584500789642334, 0.9724334478378296, 0.9711576700210571, 0.9813936948776245], [0.927756667137146, 0.9339603781700134, 0.9531468749046326, 0.9537972807884216, 0.9450715780258179]]
[[0.964, 0.965, 0.968, 0.971, 0.988], [0.961, 0.965, 0.97, 0.974, 0.992], [0.954, 0.961, 0.962, 0.966, 0.986], [0.936, 0.941, 0.945, 0.95, 0.965], [0.966, 0.966, 0.968, 0.972, 0.99], [0.946, 0.949, 0.952, 0.957, 0.974], [0.904, 0.92, 0.946, 0.948, 0.968], [0.943, 0.949, 0.96, 0.962, 0.976], [0.927, 0.944, 0.973, 0.975, 0.99], [0.87, 0.875, 0.897, 0.911, 0.946]]
suff_simple_acc_int  =  0.960 +- 0.012, 0.962 +- 0.010, 0.967 +- 0.006, 0.968 +- 0.006, 0.972 +- 0.011
nec class all_L1  =  0.114 +- 0.050, 0.085 +- 0.041, 0.071 +- 0.030, 0.061 +- 0.018, 0.039 +- 0.015
nec class all_KL  =  0.164 +- 0.072, 0.124 +- 0.066, 0.104 +- 0.052, 0.091 +- 0.033, 0.068 +- 0.028
[[0.934935986995697, 0.9662047028541565, 0.9787122011184692, 0.9653291702270508, 0.9739593863487244], [0.8997648358345032, 0.9196017384529114, 0.9299579858779907, 0.9459425806999207, 0.9715829491615295], [0.9111716747283936, 0.9234790802001953, 0.9308584928512573, 0.9445167183876038, 0.971733033657074], [0.9247798919677734, 0.9449669718742371, 0.9416149854660034, 0.9494696855545044, 0.9666299819946289], [0.9180758595466614, 0.9473934173583984, 0.960951566696167, 0.9592005014419556, 0.9730088114738464], [0.9205273389816284, 0.9405893683433533, 0.9419651627540588, 0.9509705901145935, 0.9716329574584961], [0.8590154051780701, 0.8833299875259399, 0.8967380523681641, 0.9211776852607727, 0.9564238786697388], [0.9093956351280212, 0.932209312915802, 0.9416399598121643, 0.9421152472496033, 0.9653291702270508], [0.8236441612243652, 0.872348427772522, 0.9098959565162659, 0.9327846765518188, 0.958299994468689], [0.7689363360404968, 0.8270212411880493, 0.873674213886261, 0.904592752456665, 0.9350610375404358]]
[[0.121, 0.068, 0.041, 0.05, 0.03], [0.141, 0.11, 0.1, 0.088, 0.063], [0.119, 0.099, 0.089, 0.083, 0.059], [0.115, 0.079, 0.074, 0.068, 0.057], [0.144, 0.099, 0.077, 0.076, 0.05], [0.111, 0.075, 0.07, 0.072, 0.058], [0.169, 0.131, 0.118, 0.102, 0.085], [0.118, 0.082, 0.071, 0.074, 0.059], [0.265, 0.218, 0.172, 0.13, 0.084], [0.337, 0.28, 0.224, 0.171, 0.138]]
nec_acc_int  =  0.887 +- 0.051, 0.916 +- 0.040, 0.931 +- 0.029, 0.942 +- 0.017, 0.964 +- 0.011


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.512 +- 0.011, 0.509 +- 0.009, 0.505 +- 0.005, 0.502 +- 0.003, 0.499 +- 0.004
Faith. Armon (L1)= 		  =  0.057 +- 0.048, 0.043 +- 0.037, 0.027 +- 0.022, 0.018 +- 0.015, 0.009 +- 0.008
Faith. GMean (L1)= 	  =  0.142 +- 0.098, 0.119 +- 0.090, 0.096 +- 0.066, 0.078 +- 0.053, 0.057 +- 0.037
Faith. Aritm (KL)= 		  =  0.517 +- 0.017, 0.514 +- 0.016, 0.509 +- 0.010, 0.504 +- 0.006, 0.501 +- 0.006
Faith. Armon (KL)= 		  =  0.087 +- 0.074, 0.073 +- 0.064, 0.051 +- 0.044, 0.037 +- 0.033, 0.020 +- 0.018
Faith. GMean (KL)= 	  =  0.180 +- 0.119, 0.156 +- 0.119, 0.133 +- 0.094, 0.111 +- 0.079, 0.085 +- 0.056

Eval split val
Faith. Aritm (L1)= 		  =  0.518 +- 0.018, 0.500 +- 0.011, 0.494 +- 0.013, 0.490 +- 0.015, 0.486 +- 0.022
Faith. Armon (L1)= 		  =  0.136 +- 0.107, 0.073 +- 0.082, 0.053 +- 0.072, 0.042 +- 0.067, 0.035 +- 0.062
Faith. GMean (L1)= 	  =  0.248 +- 0.099, 0.170 +- 0.086, 0.137 +- 0.081, 0.115 +- 0.081, 0.098 +- 0.081
Faith. Aritm (KL)= 		  =  0.533 +- 0.027, 0.505 +- 0.014, 0.494 +- 0.015, 0.488 +- 0.019, 0.483 +- 0.026
Faith. Armon (KL)= 		  =  0.205 +- 0.121, 0.115 +- 0.098, 0.080 +- 0.083, 0.060 +- 0.073, 0.045 +- 0.064
Faith. GMean (KL)= 	  =  0.319 +- 0.099, 0.223 +- 0.089, 0.179 +- 0.080, 0.149 +- 0.078, 0.121 +- 0.076

Eval split test
Faith. Aritm (L1)= 		  =  0.536 +- 0.018, 0.523 +- 0.015, 0.519 +- 0.013, 0.515 +- 0.008, 0.510 +- 0.005
Faith. Armon (L1)= 		  =  0.200 +- 0.075, 0.153 +- 0.067, 0.130 +- 0.051, 0.113 +- 0.032, 0.075 +- 0.028
Faith. GMean (L1)= 	  =  0.323 +- 0.063, 0.278 +- 0.062, 0.256 +- 0.054, 0.240 +- 0.034, 0.193 +- 0.036
Faith. Aritm (KL)= 		  =  0.551 +- 0.026, 0.534 +- 0.024, 0.529 +- 0.021, 0.525 +- 0.013, 0.523 +- 0.010
Faith. Armon (KL)= 		  =  0.272 +- 0.093, 0.213 +- 0.094, 0.183 +- 0.080, 0.165 +- 0.053, 0.126 +- 0.046
Faith. GMean (KL)= 	  =  0.383 +- 0.071, 0.331 +- 0.077, 0.305 +- 0.071, 0.291 +- 0.049, 0.253 +- 0.047
Computed for split load_split = id



Completed in  3:10:00.844264  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN simple_concept2temperature TopoFeature/basis/no_shift NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:39:53 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 02:39:54 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:54 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:54 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 02:39:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:54 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:39:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 94 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mChartInfo 0.9560 0.9560 0.9560 0.9560 0.9740 0.9740[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.564
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.612
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.582
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.515
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.455
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.459
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.330
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.232
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.174
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.156
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.573
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.621
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.641
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.645
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.640


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5639660000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.907
SUFF_SIMPLE for r=0.05 class 0.0 = 0.891 +- 0.217 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.835 +- 0.217 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.05 all KL = 0.869 +- 0.217 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.05 all L1 = 0.86 +- 0.184 (in-sample avg dev_std = 0.300)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6115419999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.902
SUFF_SIMPLE for r=0.1 class 0.0 = 0.889 +- 0.213 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.838 +- 0.213 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.1 all KL = 0.869 +- 0.213 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.1 all L1 = 0.861 +- 0.181 (in-sample avg dev_std = 0.298)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5823539999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.896
SUFF_SIMPLE for r=0.2 class 0.0 = 0.879 +- 0.221 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.83 +- 0.221 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.2 all KL = 0.859 +- 0.221 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.2 all L1 = 0.852 +- 0.188 (in-sample avg dev_std = 0.305)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.514786
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.887
SUFF_SIMPLE for r=0.4 class 0.0 = 0.863 +- 0.244 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.814 +- 0.244 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.4 all KL = 0.842 +- 0.244 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.4 all L1 = 0.836 +- 0.205 (in-sample avg dev_std = 0.311)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.45546
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.859
SUFF_SIMPLE for r=0.8 class 0.0 = 0.869 +- 0.276 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.766 +- 0.276 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.8 all KL = 0.825 +- 0.276 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.8 all L1 = 0.812 +- 0.242 (in-sample avg dev_std = 0.259)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45907420000000004
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.515
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.093 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.884 +- 0.093 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.05 all KL = 0.967 +- 0.093 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.05 all L1 = 0.941 +- 0.141 (in-sample avg dev_std = 0.107)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32966680000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.513
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.096 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.88 +- 0.096 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.1 all KL = 0.965 +- 0.096 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.1 all L1 = 0.939 +- 0.145 (in-sample avg dev_std = 0.107)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2324982
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.511
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.102 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.876 +- 0.102 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.2 all KL = 0.963 +- 0.102 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.2 all L1 = 0.936 +- 0.150 (in-sample avg dev_std = 0.101)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1744924
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.508
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.114 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.868 +- 0.114 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.4 all KL = 0.958 +- 0.114 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.4 all L1 = 0.933 +- 0.160 (in-sample avg dev_std = 0.094)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1557414
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.501
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.143 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.853 +- 0.143 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.8 all KL = 0.947 +- 0.143 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.8 all L1 = 0.925 +- 0.179 (in-sample avg dev_std = 0.072)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5730348
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.735
SUFF_SIMPLE for r=0.05 class 0.0 = 0.864 +- 0.314 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.868 +- 0.314 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.05 all KL = 0.836 +- 0.314 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.05 all L1 = 0.866 +- 0.239 (in-sample avg dev_std = 0.317)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6207962
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.734
SUFF_SIMPLE for r=0.1 class 0.0 = 0.864 +- 0.315 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.865 +- 0.315 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.1 all KL = 0.838 +- 0.315 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.1 all L1 = 0.865 +- 0.245 (in-sample avg dev_std = 0.305)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.641156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.737
SUFF_SIMPLE for r=0.2 class 0.0 = 0.865 +- 0.301 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.885 +- 0.301 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.2 all KL = 0.853 +- 0.301 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.2 all L1 = 0.875 +- 0.241 (in-sample avg dev_std = 0.244)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6453472
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.735
SUFF_SIMPLE for r=0.4 class 0.0 = 0.867 +- 0.293 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.889 +- 0.293 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.4 all KL = 0.866 +- 0.293 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.4 all L1 = 0.878 +- 0.248 (in-sample avg dev_std = 0.223)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.764
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6398050000000001
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.73
SUFF_SIMPLE for r=0.8 class 0.0 = 0.892 +- 0.263 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.899 +- 0.263 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.8 all KL = 0.9 +- 0.263 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.8 all L1 = 0.896 +- 0.238 (in-sample avg dev_std = 0.074)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5639660000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.921
NEC for r=0.05 class 0.0 = 0.053 +- 0.182 (in-sample avg dev_std = 0.227)
NEC for r=0.05 class 1.0 = 0.202 +- 0.182 (in-sample avg dev_std = 0.227)
NEC for r=0.05 all KL = 0.121 +- 0.182 (in-sample avg dev_std = 0.227)
NEC for r=0.05 all L1 = 0.136 +- 0.173 (in-sample avg dev_std = 0.227)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6115419999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.945
NEC for r=0.1 class 0.0 = 0.046 +- 0.142 (in-sample avg dev_std = 0.210)
NEC for r=0.1 class 1.0 = 0.141 +- 0.142 (in-sample avg dev_std = 0.210)
NEC for r=0.1 all KL = 0.084 +- 0.142 (in-sample avg dev_std = 0.210)
NEC for r=0.1 all L1 = 0.099 +- 0.135 (in-sample avg dev_std = 0.210)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5823539999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.952
NEC for r=0.2 class 0.0 = 0.043 +- 0.110 (in-sample avg dev_std = 0.195)
NEC for r=0.2 class 1.0 = 0.095 +- 0.110 (in-sample avg dev_std = 0.195)
NEC for r=0.2 all KL = 0.057 +- 0.110 (in-sample avg dev_std = 0.195)
NEC for r=0.2 all L1 = 0.072 +- 0.108 (in-sample avg dev_std = 0.195)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.514786
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.959
NEC for r=0.4 class 0.0 = 0.043 +- 0.095 (in-sample avg dev_std = 0.176)
NEC for r=0.4 class 1.0 = 0.074 +- 0.095 (in-sample avg dev_std = 0.176)
NEC for r=0.4 all KL = 0.046 +- 0.095 (in-sample avg dev_std = 0.176)
NEC for r=0.4 all L1 = 0.06 +- 0.090 (in-sample avg dev_std = 0.176)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.45546
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.956
NEC for r=0.8 class 0.0 = 0.048 +- 0.089 (in-sample avg dev_std = 0.164)
NEC for r=0.8 class 1.0 = 0.058 +- 0.089 (in-sample avg dev_std = 0.164)
NEC for r=0.8 all KL = 0.037 +- 0.089 (in-sample avg dev_std = 0.164)
NEC for r=0.8 all L1 = 0.054 +- 0.089 (in-sample avg dev_std = 0.164)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45907420000000004
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.517
NEC for r=0.05 class 0.0 = 0.002 +- 0.119 (in-sample avg dev_std = 0.131)
NEC for r=0.05 class 1.0 = 0.126 +- 0.119 (in-sample avg dev_std = 0.131)
NEC for r=0.05 all KL = 0.042 +- 0.119 (in-sample avg dev_std = 0.131)
NEC for r=0.05 all L1 = 0.064 +- 0.155 (in-sample avg dev_std = 0.131)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32966680000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.534
NEC for r=0.1 class 0.0 = 0.001 +- 0.079 (in-sample avg dev_std = 0.134)
NEC for r=0.1 class 1.0 = 0.098 +- 0.079 (in-sample avg dev_std = 0.134)
NEC for r=0.1 all KL = 0.027 +- 0.079 (in-sample avg dev_std = 0.134)
NEC for r=0.1 all L1 = 0.05 +- 0.118 (in-sample avg dev_std = 0.134)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2324982
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.539
NEC for r=0.2 class 0.0 = 0.001 +- 0.056 (in-sample avg dev_std = 0.120)
NEC for r=0.2 class 1.0 = 0.072 +- 0.056 (in-sample avg dev_std = 0.120)
NEC for r=0.2 all KL = 0.018 +- 0.056 (in-sample avg dev_std = 0.120)
NEC for r=0.2 all L1 = 0.036 +- 0.090 (in-sample avg dev_std = 0.120)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1744924
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.537
NEC for r=0.4 class 0.0 = 0.001 +- 0.042 (in-sample avg dev_std = 0.106)
NEC for r=0.4 class 1.0 = 0.058 +- 0.042 (in-sample avg dev_std = 0.106)
NEC for r=0.4 all KL = 0.013 +- 0.042 (in-sample avg dev_std = 0.106)
NEC for r=0.4 all L1 = 0.029 +- 0.074 (in-sample avg dev_std = 0.106)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1557414
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.533
NEC for r=0.8 class 0.0 = 0.001 +- 0.039 (in-sample avg dev_std = 0.095)
NEC for r=0.8 class 1.0 = 0.063 +- 0.039 (in-sample avg dev_std = 0.095)
NEC for r=0.8 all KL = 0.012 +- 0.039 (in-sample avg dev_std = 0.095)
NEC for r=0.8 all L1 = 0.032 +- 0.078 (in-sample avg dev_std = 0.095)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5730348
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.642
NEC for r=0.05 class 0.0 = 0.21 +- 0.374 (in-sample avg dev_std = 0.442)
NEC for r=0.05 class 1.0 = 0.461 +- 0.374 (in-sample avg dev_std = 0.442)
NEC for r=0.05 all KL = 0.375 +- 0.374 (in-sample avg dev_std = 0.442)
NEC for r=0.05 all L1 = 0.334 +- 0.309 (in-sample avg dev_std = 0.442)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6207962
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.685
NEC for r=0.1 class 0.0 = 0.156 +- 0.322 (in-sample avg dev_std = 0.412)
NEC for r=0.1 class 1.0 = 0.329 +- 0.322 (in-sample avg dev_std = 0.412)
NEC for r=0.1 all KL = 0.275 +- 0.322 (in-sample avg dev_std = 0.412)
NEC for r=0.1 all L1 = 0.242 +- 0.259 (in-sample avg dev_std = 0.412)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.641156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.711
NEC for r=0.2 class 0.0 = 0.117 +- 0.281 (in-sample avg dev_std = 0.338)
NEC for r=0.2 class 1.0 = 0.229 +- 0.281 (in-sample avg dev_std = 0.338)
NEC for r=0.2 all KL = 0.195 +- 0.281 (in-sample avg dev_std = 0.338)
NEC for r=0.2 all L1 = 0.172 +- 0.226 (in-sample avg dev_std = 0.338)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6453472
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.741
NEC for r=0.4 class 0.0 = 0.107 +- 0.252 (in-sample avg dev_std = 0.304)
NEC for r=0.4 class 1.0 = 0.146 +- 0.252 (in-sample avg dev_std = 0.304)
NEC for r=0.4 all KL = 0.146 +- 0.252 (in-sample avg dev_std = 0.304)
NEC for r=0.4 all L1 = 0.126 +- 0.195 (in-sample avg dev_std = 0.304)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6398050000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.741
NEC for r=0.8 class 0.0 = 0.111 +- 0.260 (in-sample avg dev_std = 0.304)
NEC for r=0.8 class 1.0 = 0.116 +- 0.260 (in-sample avg dev_std = 0.304)
NEC for r=0.8 all KL = 0.139 +- 0.260 (in-sample avg dev_std = 0.304)
NEC for r=0.8 all L1 = 0.114 +- 0.193 (in-sample avg dev_std = 0.304)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:58:15 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 02:58:15 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 02:58:15 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:58:15 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 02:58:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:58:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:58:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:58:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:58:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:58:15 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:58:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mChartInfo 0.9600 0.9600 0.9600 0.9600 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.524
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.564
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.554
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.515
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.480
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.398
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.297
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.232
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.200
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.193
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.565
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.604
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.624
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.632
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.636


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5240820000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.886
SUFF_SIMPLE for r=0.05 class 0.0 = 0.88 +- 0.325 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.762 +- 0.325 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.05 all KL = 0.742 +- 0.325 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.05 all L1 = 0.815 +- 0.215 (in-sample avg dev_std = 0.425)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5642619999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.894
SUFF_SIMPLE for r=0.1 class 0.0 = 0.878 +- 0.314 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.785 +- 0.314 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.1 all KL = 0.767 +- 0.314 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.1 all L1 = 0.827 +- 0.213 (in-sample avg dev_std = 0.403)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5535039999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.891
SUFF_SIMPLE for r=0.2 class 0.0 = 0.869 +- 0.316 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.79 +- 0.316 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.2 all KL = 0.765 +- 0.316 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.2 all L1 = 0.825 +- 0.214 (in-sample avg dev_std = 0.407)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5145619999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.883
SUFF_SIMPLE for r=0.4 class 0.0 = 0.87 +- 0.317 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.773 +- 0.317 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.4 all KL = 0.766 +- 0.317 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.4 all L1 = 0.816 +- 0.231 (in-sample avg dev_std = 0.391)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47984000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.867
SUFF_SIMPLE for r=0.8 class 0.0 = 0.862 +- 0.322 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.762 +- 0.322 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.8 all KL = 0.776 +- 0.322 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.8 all L1 = 0.806 +- 0.265 (in-sample avg dev_std = 0.308)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3980822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.524
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.200 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.833 +- 0.200 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.05 all KL = 0.921 +- 0.200 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.05 all L1 = 0.914 +- 0.195 (in-sample avg dev_std = 0.181)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2967962
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.524
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.835 +- 0.198 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 all KL = 0.923 +- 0.198 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 all L1 = 0.915 +- 0.195 (in-sample avg dev_std = 0.176)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.232206
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.521
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.202 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.202 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.2 all KL = 0.922 +- 0.202 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.197 (in-sample avg dev_std = 0.173)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2004564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.518
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.208 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.829 +- 0.208 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 all KL = 0.92 +- 0.208 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 all L1 = 0.913 +- 0.202 (in-sample avg dev_std = 0.166)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1929168
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.508
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.223 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.82 +- 0.223 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.8 all KL = 0.916 +- 0.223 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.8 all L1 = 0.908 +- 0.216 (in-sample avg dev_std = 0.138)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5646831999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.707
SUFF_SIMPLE for r=0.05 class 0.0 = 0.896 +- 0.369 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.807 +- 0.369 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.05 all KL = 0.765 +- 0.369 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.05 all L1 = 0.852 +- 0.249 (in-sample avg dev_std = 0.365)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6044842
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.711
SUFF_SIMPLE for r=0.1 class 0.0 = 0.902 +- 0.356 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.827 +- 0.356 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 all KL = 0.793 +- 0.356 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 all L1 = 0.865 +- 0.244 (in-sample avg dev_std = 0.335)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6237054
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.71
SUFF_SIMPLE for r=0.2 class 0.0 = 0.909 +- 0.337 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.843 +- 0.337 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.2 all KL = 0.823 +- 0.337 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.2 all L1 = 0.876 +- 0.244 (in-sample avg dev_std = 0.308)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6324598
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.707
SUFF_SIMPLE for r=0.4 class 0.0 = 0.915 +- 0.329 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.842 +- 0.329 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 all KL = 0.839 +- 0.329 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 all L1 = 0.879 +- 0.250 (in-sample avg dev_std = 0.276)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6358043999999999
len(reference) = 4964
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.718
SUFF_SIMPLE for r=0.8 class 0.0 = 0.921 +- 0.285 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.88 +- 0.285 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.8 all KL = 0.89 +- 0.285 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.8 all L1 = 0.901 +- 0.241 (in-sample avg dev_std = 0.146)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5240820000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.668
NEC for r=0.05 class 0.0 = 0.099 +- 0.441 (in-sample avg dev_std = 0.394)
NEC for r=0.05 class 1.0 = 0.611 +- 0.441 (in-sample avg dev_std = 0.394)
NEC for r=0.05 all KL = 0.518 +- 0.441 (in-sample avg dev_std = 0.394)
NEC for r=0.05 all L1 = 0.383 +- 0.331 (in-sample avg dev_std = 0.394)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5642619999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.774
NEC for r=0.1 class 0.0 = 0.085 +- 0.408 (in-sample avg dev_std = 0.485)
NEC for r=0.1 class 1.0 = 0.468 +- 0.408 (in-sample avg dev_std = 0.485)
NEC for r=0.1 all KL = 0.444 +- 0.408 (in-sample avg dev_std = 0.485)
NEC for r=0.1 all L1 = 0.297 +- 0.284 (in-sample avg dev_std = 0.485)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5535039999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.855
NEC for r=0.2 class 0.0 = 0.073 +- 0.363 (in-sample avg dev_std = 0.481)
NEC for r=0.2 class 1.0 = 0.319 +- 0.363 (in-sample avg dev_std = 0.481)
NEC for r=0.2 all KL = 0.337 +- 0.363 (in-sample avg dev_std = 0.481)
NEC for r=0.2 all L1 = 0.209 +- 0.228 (in-sample avg dev_std = 0.481)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5145619999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.902
NEC for r=0.4 class 0.0 = 0.063 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.4 class 1.0 = 0.208 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.4 all KL = 0.243 +- 0.314 (in-sample avg dev_std = 0.421)
NEC for r=0.4 all L1 = 0.143 +- 0.175 (in-sample avg dev_std = 0.421)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47984000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.933
NEC for r=0.8 class 0.0 = 0.061 +- 0.271 (in-sample avg dev_std = 0.349)
NEC for r=0.8 class 1.0 = 0.137 +- 0.271 (in-sample avg dev_std = 0.349)
NEC for r=0.8 all KL = 0.169 +- 0.271 (in-sample avg dev_std = 0.349)
NEC for r=0.8 all L1 = 0.103 +- 0.142 (in-sample avg dev_std = 0.349)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3980822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.504
NEC for r=0.05 class 0.0 = 0.006 +- 0.234 (in-sample avg dev_std = 0.138)
NEC for r=0.05 class 1.0 = 0.186 +- 0.234 (in-sample avg dev_std = 0.138)
NEC for r=0.05 all KL = 0.091 +- 0.234 (in-sample avg dev_std = 0.138)
NEC for r=0.05 all L1 = 0.096 +- 0.223 (in-sample avg dev_std = 0.138)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2967962
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.516
NEC for r=0.1 class 0.0 = 0.005 +- 0.220 (in-sample avg dev_std = 0.192)
NEC for r=0.1 class 1.0 = 0.175 +- 0.220 (in-sample avg dev_std = 0.192)
NEC for r=0.1 all KL = 0.086 +- 0.220 (in-sample avg dev_std = 0.192)
NEC for r=0.1 all L1 = 0.09 +- 0.207 (in-sample avg dev_std = 0.192)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.232206
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.53
NEC for r=0.2 class 0.0 = 0.004 +- 0.197 (in-sample avg dev_std = 0.213)
NEC for r=0.2 class 1.0 = 0.158 +- 0.197 (in-sample avg dev_std = 0.213)
NEC for r=0.2 all KL = 0.077 +- 0.197 (in-sample avg dev_std = 0.213)
NEC for r=0.2 all L1 = 0.081 +- 0.185 (in-sample avg dev_std = 0.213)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2004564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.54
NEC for r=0.4 class 0.0 = 0.002 +- 0.167 (in-sample avg dev_std = 0.202)
NEC for r=0.4 class 1.0 = 0.14 +- 0.167 (in-sample avg dev_std = 0.202)
NEC for r=0.4 all KL = 0.063 +- 0.167 (in-sample avg dev_std = 0.202)
NEC for r=0.4 all L1 = 0.072 +- 0.164 (in-sample avg dev_std = 0.202)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1929168
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.542
NEC for r=0.8 class 0.0 = 0.003 +- 0.147 (in-sample avg dev_std = 0.183)
NEC for r=0.8 class 1.0 = 0.131 +- 0.147 (in-sample avg dev_std = 0.183)
NEC for r=0.8 all KL = 0.055 +- 0.147 (in-sample avg dev_std = 0.183)
NEC for r=0.8 all L1 = 0.067 +- 0.154 (in-sample avg dev_std = 0.183)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5646831999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.643
NEC for r=0.05 class 0.0 = 0.292 +- 0.452 (in-sample avg dev_std = 0.471)
NEC for r=0.05 class 1.0 = 0.563 +- 0.452 (in-sample avg dev_std = 0.471)
NEC for r=0.05 all KL = 0.59 +- 0.452 (in-sample avg dev_std = 0.471)
NEC for r=0.05 all L1 = 0.426 +- 0.354 (in-sample avg dev_std = 0.471)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6044842
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.667
NEC for r=0.1 class 0.0 = 0.253 +- 0.436 (in-sample avg dev_std = 0.501)
NEC for r=0.1 class 1.0 = 0.463 +- 0.436 (in-sample avg dev_std = 0.501)
NEC for r=0.1 all KL = 0.534 +- 0.436 (in-sample avg dev_std = 0.501)
NEC for r=0.1 all L1 = 0.356 +- 0.330 (in-sample avg dev_std = 0.501)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6237054
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.681
NEC for r=0.2 class 0.0 = 0.207 +- 0.420 (in-sample avg dev_std = 0.509)
NEC for r=0.2 class 1.0 = 0.367 +- 0.420 (in-sample avg dev_std = 0.509)
NEC for r=0.2 all KL = 0.453 +- 0.420 (in-sample avg dev_std = 0.509)
NEC for r=0.2 all L1 = 0.286 +- 0.303 (in-sample avg dev_std = 0.509)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6324598
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.702
NEC for r=0.4 class 0.0 = 0.165 +- 0.389 (in-sample avg dev_std = 0.493)
NEC for r=0.4 class 1.0 = 0.268 +- 0.389 (in-sample avg dev_std = 0.493)
NEC for r=0.4 all KL = 0.366 +- 0.389 (in-sample avg dev_std = 0.493)
NEC for r=0.4 all L1 = 0.216 +- 0.260 (in-sample avg dev_std = 0.493)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6358043999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.713
NEC for r=0.8 class 0.0 = 0.124 +- 0.363 (in-sample avg dev_std = 0.446)
NEC for r=0.8 class 1.0 = 0.207 +- 0.363 (in-sample avg dev_std = 0.446)
NEC for r=0.8 all KL = 0.291 +- 0.363 (in-sample avg dev_std = 0.446)
NEC for r=0.8 all L1 = 0.165 +- 0.232 (in-sample avg dev_std = 0.446)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:16:42 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 03:16:42 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 03:16:42 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:16:42 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 03:16:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:16:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:16:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:16:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:16:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:16:42 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:16:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mChartInfo 0.9620 0.9620 0.9620 0.9620 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.558
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.602
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.583
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.538
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.497
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.389
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.275
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.205
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.171
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.163
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.567
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.607
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.627
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.633
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.631


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.558236
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.89
SUFF_SIMPLE for r=0.05 class 0.0 = 0.902 +- 0.270 (in-sample avg dev_std = 0.378)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.79 +- 0.270 (in-sample avg dev_std = 0.378)
SUFF_SIMPLE for r=0.05 all KL = 0.808 +- 0.270 (in-sample avg dev_std = 0.378)
SUFF_SIMPLE for r=0.05 all L1 = 0.84 +- 0.195 (in-sample avg dev_std = 0.378)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.601664
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.889
SUFF_SIMPLE for r=0.1 class 0.0 = 0.901 +- 0.258 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.808 +- 0.258 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.1 all KL = 0.83 +- 0.258 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.1 all L1 = 0.849 +- 0.195 (in-sample avg dev_std = 0.342)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.582798
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.896
SUFF_SIMPLE for r=0.2 class 0.0 = 0.899 +- 0.246 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.821 +- 0.246 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.2 all KL = 0.84 +- 0.246 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.2 all L1 = 0.856 +- 0.190 (in-sample avg dev_std = 0.334)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537856
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.905
SUFF_SIMPLE for r=0.4 class 0.0 = 0.893 +- 0.243 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.835 +- 0.243 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.4 all KL = 0.857 +- 0.243 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.4 all L1 = 0.861 +- 0.197 (in-sample avg dev_std = 0.305)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.497126
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.889
SUFF_SIMPLE for r=0.8 class 0.0 = 0.897 +- 0.271 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.81 +- 0.271 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.8 all KL = 0.848 +- 0.271 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.8 all L1 = 0.849 +- 0.228 (in-sample avg dev_std = 0.263)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.389181
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.526
SUFF_SIMPLE for r=0.05 class 0.0 = 0.995 +- 0.158 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.882 +- 0.158 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.05 all KL = 0.947 +- 0.158 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.05 all L1 = 0.938 +- 0.162 (in-sample avg dev_std = 0.167)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2747986
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.528
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.155 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.883 +- 0.155 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.1 all KL = 0.948 +- 0.155 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.1 all L1 = 0.939 +- 0.159 (in-sample avg dev_std = 0.163)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20482960000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.525
SUFF_SIMPLE for r=0.2 class 0.0 = 0.996 +- 0.156 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.882 +- 0.156 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.2 all KL = 0.948 +- 0.156 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.2 all L1 = 0.939 +- 0.161 (in-sample avg dev_std = 0.158)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.17085540000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.525
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.159 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.88 +- 0.159 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 all KL = 0.947 +- 0.159 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 all L1 = 0.938 +- 0.164 (in-sample avg dev_std = 0.156)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.16306579999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.515
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.184 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.868 +- 0.184 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 all KL = 0.94 +- 0.184 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 all L1 = 0.932 +- 0.183 (in-sample avg dev_std = 0.143)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5668956
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.726
SUFF_SIMPLE for r=0.05 class 0.0 = 0.896 +- 0.305 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.846 +- 0.305 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.05 all KL = 0.85 +- 0.305 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.05 all L1 = 0.871 +- 0.242 (in-sample avg dev_std = 0.270)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6068646
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.73
SUFF_SIMPLE for r=0.1 class 0.0 = 0.897 +- 0.295 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.86 +- 0.295 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.1 all KL = 0.863 +- 0.295 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.1 all L1 = 0.879 +- 0.237 (in-sample avg dev_std = 0.250)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6267582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.734
SUFF_SIMPLE for r=0.2 class 0.0 = 0.9 +- 0.288 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.864 +- 0.288 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.2 all KL = 0.869 +- 0.288 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.2 all L1 = 0.882 +- 0.235 (in-sample avg dev_std = 0.234)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6328718000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.737
SUFF_SIMPLE for r=0.4 class 0.0 = 0.902 +- 0.283 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.87 +- 0.283 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.4 all KL = 0.875 +- 0.283 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.4 all L1 = 0.886 +- 0.234 (in-sample avg dev_std = 0.213)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6309754000000001
len(reference) = 4979
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.736
SUFF_SIMPLE for r=0.8 class 0.0 = 0.907 +- 0.257 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.893 +- 0.257 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.8 all KL = 0.902 +- 0.257 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.8 all L1 = 0.9 +- 0.231 (in-sample avg dev_std = 0.088)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.558236
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.713
NEC for r=0.05 class 0.0 = 0.069 +- 0.399 (in-sample avg dev_std = 0.363)
NEC for r=0.05 class 1.0 = 0.532 +- 0.399 (in-sample avg dev_std = 0.363)
NEC for r=0.05 all KL = 0.421 +- 0.399 (in-sample avg dev_std = 0.363)
NEC for r=0.05 all L1 = 0.326 +- 0.304 (in-sample avg dev_std = 0.363)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.601664
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.793
NEC for r=0.1 class 0.0 = 0.056 +- 0.358 (in-sample avg dev_std = 0.431)
NEC for r=0.1 class 1.0 = 0.408 +- 0.358 (in-sample avg dev_std = 0.431)
NEC for r=0.1 all KL = 0.344 +- 0.358 (in-sample avg dev_std = 0.431)
NEC for r=0.1 all L1 = 0.251 +- 0.257 (in-sample avg dev_std = 0.431)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.582798
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.862
NEC for r=0.2 class 0.0 = 0.047 +- 0.312 (in-sample avg dev_std = 0.422)
NEC for r=0.2 class 1.0 = 0.284 +- 0.312 (in-sample avg dev_std = 0.422)
NEC for r=0.2 all KL = 0.259 +- 0.312 (in-sample avg dev_std = 0.422)
NEC for r=0.2 all L1 = 0.178 +- 0.204 (in-sample avg dev_std = 0.422)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537856
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.912
NEC for r=0.4 class 0.0 = 0.038 +- 0.246 (in-sample avg dev_std = 0.362)
NEC for r=0.4 class 1.0 = 0.186 +- 0.246 (in-sample avg dev_std = 0.362)
NEC for r=0.4 all KL = 0.174 +- 0.246 (in-sample avg dev_std = 0.362)
NEC for r=0.4 all L1 = 0.12 +- 0.150 (in-sample avg dev_std = 0.362)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.497126
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.944
NEC for r=0.8 class 0.0 = 0.045 +- 0.187 (in-sample avg dev_std = 0.282)
NEC for r=0.8 class 1.0 = 0.112 +- 0.187 (in-sample avg dev_std = 0.282)
NEC for r=0.8 all KL = 0.108 +- 0.187 (in-sample avg dev_std = 0.282)
NEC for r=0.8 all L1 = 0.082 +- 0.111 (in-sample avg dev_std = 0.282)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.389181
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.504
NEC for r=0.05 class 0.0 = 0.008 +- 0.211 (in-sample avg dev_std = 0.139)
NEC for r=0.05 class 1.0 = 0.147 +- 0.211 (in-sample avg dev_std = 0.139)
NEC for r=0.05 all KL = 0.073 +- 0.211 (in-sample avg dev_std = 0.139)
NEC for r=0.05 all L1 = 0.078 +- 0.203 (in-sample avg dev_std = 0.139)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2747986
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.519
NEC for r=0.1 class 0.0 = 0.007 +- 0.190 (in-sample avg dev_std = 0.184)
NEC for r=0.1 class 1.0 = 0.132 +- 0.190 (in-sample avg dev_std = 0.184)
NEC for r=0.1 all KL = 0.065 +- 0.190 (in-sample avg dev_std = 0.184)
NEC for r=0.1 all L1 = 0.07 +- 0.181 (in-sample avg dev_std = 0.184)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20482960000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.531
NEC for r=0.2 class 0.0 = 0.005 +- 0.158 (in-sample avg dev_std = 0.188)
NEC for r=0.2 class 1.0 = 0.113 +- 0.158 (in-sample avg dev_std = 0.188)
NEC for r=0.2 all KL = 0.053 +- 0.158 (in-sample avg dev_std = 0.188)
NEC for r=0.2 all L1 = 0.059 +- 0.155 (in-sample avg dev_std = 0.188)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.17085540000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.536
NEC for r=0.4 class 0.0 = 0.004 +- 0.135 (in-sample avg dev_std = 0.177)
NEC for r=0.4 class 1.0 = 0.101 +- 0.135 (in-sample avg dev_std = 0.177)
NEC for r=0.4 all KL = 0.045 +- 0.135 (in-sample avg dev_std = 0.177)
NEC for r=0.4 all L1 = 0.053 +- 0.139 (in-sample avg dev_std = 0.177)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.16306579999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.54
NEC for r=0.8 class 0.0 = 0.003 +- 0.116 (in-sample avg dev_std = 0.163)
NEC for r=0.8 class 1.0 = 0.091 +- 0.116 (in-sample avg dev_std = 0.163)
NEC for r=0.8 all KL = 0.037 +- 0.116 (in-sample avg dev_std = 0.163)
NEC for r=0.8 all L1 = 0.047 +- 0.125 (in-sample avg dev_std = 0.163)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5668956
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.638
NEC for r=0.05 class 0.0 = 0.276 +- 0.435 (in-sample avg dev_std = 0.460)
NEC for r=0.05 class 1.0 = 0.582 +- 0.435 (in-sample avg dev_std = 0.460)
NEC for r=0.05 all KL = 0.539 +- 0.435 (in-sample avg dev_std = 0.460)
NEC for r=0.05 all L1 = 0.427 +- 0.351 (in-sample avg dev_std = 0.460)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6068646
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.676
NEC for r=0.1 class 0.0 = 0.235 +- 0.409 (in-sample avg dev_std = 0.479)
NEC for r=0.1 class 1.0 = 0.46 +- 0.409 (in-sample avg dev_std = 0.479)
NEC for r=0.1 all KL = 0.462 +- 0.409 (in-sample avg dev_std = 0.479)
NEC for r=0.1 all L1 = 0.346 +- 0.325 (in-sample avg dev_std = 0.479)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6267582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.696
NEC for r=0.2 class 0.0 = 0.187 +- 0.378 (in-sample avg dev_std = 0.469)
NEC for r=0.2 class 1.0 = 0.351 +- 0.378 (in-sample avg dev_std = 0.469)
NEC for r=0.2 all KL = 0.37 +- 0.378 (in-sample avg dev_std = 0.469)
NEC for r=0.2 all L1 = 0.268 +- 0.289 (in-sample avg dev_std = 0.469)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6328718000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.713
NEC for r=0.4 class 0.0 = 0.147 +- 0.340 (in-sample avg dev_std = 0.430)
NEC for r=0.4 class 1.0 = 0.257 +- 0.340 (in-sample avg dev_std = 0.430)
NEC for r=0.4 all KL = 0.281 +- 0.340 (in-sample avg dev_std = 0.430)
NEC for r=0.4 all L1 = 0.201 +- 0.254 (in-sample avg dev_std = 0.430)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6309754000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.732
NEC for r=0.8 class 0.0 = 0.119 +- 0.309 (in-sample avg dev_std = 0.390)
NEC for r=0.8 class 1.0 = 0.189 +- 0.309 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all KL = 0.215 +- 0.309 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all L1 = 0.153 +- 0.222 (in-sample avg dev_std = 0.390)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:35:24 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 03:35:24 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 03:35:24 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:35:24 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 03:35:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:35:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:35:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:35:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:35:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:35:24 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:35:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mChartInfo 0.9440 0.9440 0.9440 0.9440 0.9680 0.9680[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.586
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.607
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.567
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.506
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.464
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.388
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.263
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.182
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.140
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.130
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.583
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.617
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.629
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.632
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.635


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.586386
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.873
SUFF_SIMPLE for r=0.05 class 0.0 = 0.911 +- 0.311 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.752 +- 0.311 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.05 all KL = 0.782 +- 0.311 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.05 all L1 = 0.823 +- 0.214 (in-sample avg dev_std = 0.424)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.606532
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.892
SUFF_SIMPLE for r=0.1 class 0.0 = 0.905 +- 0.280 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.803 +- 0.280 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.1 all KL = 0.825 +- 0.280 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.1 all L1 = 0.848 +- 0.199 (in-sample avg dev_std = 0.374)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5667620000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.89
SUFF_SIMPLE for r=0.2 class 0.0 = 0.904 +- 0.274 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.807 +- 0.274 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.2 all KL = 0.834 +- 0.274 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.2 all L1 = 0.85 +- 0.201 (in-sample avg dev_std = 0.368)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.506066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.89
SUFF_SIMPLE for r=0.4 class 0.0 = 0.892 +- 0.272 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.808 +- 0.272 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.4 all KL = 0.834 +- 0.272 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.4 all L1 = 0.846 +- 0.209 (in-sample avg dev_std = 0.344)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.463508
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.869
SUFF_SIMPLE for r=0.8 class 0.0 = 0.877 +- 0.290 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.789 +- 0.290 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.8 all KL = 0.831 +- 0.290 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.8 all L1 = 0.828 +- 0.247 (in-sample avg dev_std = 0.285)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387676
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.513
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.089 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.918 +- 0.089 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.05 all KL = 0.974 +- 0.089 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.05 all L1 = 0.959 +- 0.125 (in-sample avg dev_std = 0.089)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.26267599999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.512
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.091 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.917 +- 0.091 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.1 all KL = 0.973 +- 0.091 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.1 all L1 = 0.958 +- 0.127 (in-sample avg dev_std = 0.090)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.181619
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.511
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.096 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.914 +- 0.096 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.2 all KL = 0.972 +- 0.096 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.2 all L1 = 0.956 +- 0.132 (in-sample avg dev_std = 0.086)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.140123
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.509
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.107 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.107 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.4 all KL = 0.969 +- 0.107 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.138 (in-sample avg dev_std = 0.084)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1298802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.502
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.070)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.899 +- 0.137 (in-sample avg dev_std = 0.070)
SUFF_SIMPLE for r=0.8 all KL = 0.961 +- 0.137 (in-sample avg dev_std = 0.070)
SUFF_SIMPLE for r=0.8 all L1 = 0.949 +- 0.157 (in-sample avg dev_std = 0.070)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5830317999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.7
SUFF_SIMPLE for r=0.05 class 0.0 = 0.897 +- 0.344 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.788 +- 0.344 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.05 all KL = 0.788 +- 0.344 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.05 all L1 = 0.843 +- 0.261 (in-sample avg dev_std = 0.376)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6166992
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.705
SUFF_SIMPLE for r=0.1 class 0.0 = 0.902 +- 0.331 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.808 +- 0.331 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.1 all KL = 0.809 +- 0.331 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.1 all L1 = 0.856 +- 0.255 (in-sample avg dev_std = 0.347)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6291796000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.702
SUFF_SIMPLE for r=0.2 class 0.0 = 0.913 +- 0.307 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.307 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.2 all KL = 0.84 +- 0.307 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.2 all L1 = 0.874 +- 0.245 (in-sample avg dev_std = 0.304)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6322397999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.701
SUFF_SIMPLE for r=0.4 class 0.0 = 0.917 +- 0.303 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.831 +- 0.303 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.4 all KL = 0.846 +- 0.303 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.4 all L1 = 0.875 +- 0.247 (in-sample avg dev_std = 0.290)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6347246
len(reference) = 4962
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.703
SUFF_SIMPLE for r=0.8 class 0.0 = 0.916 +- 0.297 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.85 +- 0.297 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.8 all KL = 0.868 +- 0.297 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.8 all L1 = 0.883 +- 0.251 (in-sample avg dev_std = 0.234)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.586386
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.58
NEC for r=0.05 class 0.0 = 0.083 +- 0.444 (in-sample avg dev_std = 0.341)
NEC for r=0.05 class 1.0 = 0.694 +- 0.444 (in-sample avg dev_std = 0.341)
NEC for r=0.05 all KL = 0.502 +- 0.444 (in-sample avg dev_std = 0.341)
NEC for r=0.05 all L1 = 0.422 +- 0.361 (in-sample avg dev_std = 0.341)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.606532
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.691
NEC for r=0.1 class 0.0 = 0.071 +- 0.418 (in-sample avg dev_std = 0.535)
NEC for r=0.1 class 1.0 = 0.578 +- 0.418 (in-sample avg dev_std = 0.535)
NEC for r=0.1 all KL = 0.454 +- 0.418 (in-sample avg dev_std = 0.535)
NEC for r=0.1 all L1 = 0.352 +- 0.314 (in-sample avg dev_std = 0.535)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5667620000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.801
NEC for r=0.2 class 0.0 = 0.054 +- 0.370 (in-sample avg dev_std = 0.535)
NEC for r=0.2 class 1.0 = 0.406 +- 0.370 (in-sample avg dev_std = 0.535)
NEC for r=0.2 all KL = 0.353 +- 0.370 (in-sample avg dev_std = 0.535)
NEC for r=0.2 all L1 = 0.249 +- 0.257 (in-sample avg dev_std = 0.535)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.506066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.869
NEC for r=0.4 class 0.0 = 0.043 +- 0.316 (in-sample avg dev_std = 0.474)
NEC for r=0.4 class 1.0 = 0.267 +- 0.316 (in-sample avg dev_std = 0.474)
NEC for r=0.4 all KL = 0.249 +- 0.316 (in-sample avg dev_std = 0.474)
NEC for r=0.4 all L1 = 0.167 +- 0.200 (in-sample avg dev_std = 0.474)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.463508
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.91
NEC for r=0.8 class 0.0 = 0.042 +- 0.260 (in-sample avg dev_std = 0.389)
NEC for r=0.8 class 1.0 = 0.172 +- 0.260 (in-sample avg dev_std = 0.389)
NEC for r=0.8 all KL = 0.167 +- 0.260 (in-sample avg dev_std = 0.389)
NEC for r=0.8 all L1 = 0.114 +- 0.152 (in-sample avg dev_std = 0.389)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387676
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.001 +- 0.162 (in-sample avg dev_std = 0.060)
NEC for r=0.05 class 1.0 = 0.109 +- 0.162 (in-sample avg dev_std = 0.060)
NEC for r=0.05 all KL = 0.046 +- 0.162 (in-sample avg dev_std = 0.060)
NEC for r=0.05 all L1 = 0.055 +- 0.171 (in-sample avg dev_std = 0.060)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.26267599999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.508
NEC for r=0.1 class 0.0 = 0.001 +- 0.144 (in-sample avg dev_std = 0.136)
NEC for r=0.1 class 1.0 = 0.096 +- 0.144 (in-sample avg dev_std = 0.136)
NEC for r=0.1 all KL = 0.039 +- 0.144 (in-sample avg dev_std = 0.136)
NEC for r=0.1 all L1 = 0.048 +- 0.151 (in-sample avg dev_std = 0.136)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.181619
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.517
NEC for r=0.2 class 0.0 = 0.0 +- 0.115 (in-sample avg dev_std = 0.160)
NEC for r=0.2 class 1.0 = 0.073 +- 0.115 (in-sample avg dev_std = 0.160)
NEC for r=0.2 all KL = 0.03 +- 0.115 (in-sample avg dev_std = 0.160)
NEC for r=0.2 all L1 = 0.037 +- 0.120 (in-sample avg dev_std = 0.160)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.140123
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.522
NEC for r=0.4 class 0.0 = 0.0 +- 0.086 (in-sample avg dev_std = 0.141)
NEC for r=0.4 class 1.0 = 0.058 +- 0.086 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all KL = 0.021 +- 0.086 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all L1 = 0.03 +- 0.094 (in-sample avg dev_std = 0.141)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1298802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.523
NEC for r=0.8 class 0.0 = 0.0 +- 0.067 (in-sample avg dev_std = 0.115)
NEC for r=0.8 class 1.0 = 0.055 +- 0.067 (in-sample avg dev_std = 0.115)
NEC for r=0.8 all KL = 0.016 +- 0.067 (in-sample avg dev_std = 0.115)
NEC for r=0.8 all L1 = 0.028 +- 0.086 (in-sample avg dev_std = 0.115)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5830317999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.56
NEC for r=0.05 class 0.0 = 0.31 +- 0.448 (in-sample avg dev_std = 0.425)
NEC for r=0.05 class 1.0 = 0.668 +- 0.448 (in-sample avg dev_std = 0.425)
NEC for r=0.05 all KL = 0.581 +- 0.448 (in-sample avg dev_std = 0.425)
NEC for r=0.05 all L1 = 0.487 +- 0.376 (in-sample avg dev_std = 0.425)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6166992
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.591
NEC for r=0.1 class 0.0 = 0.275 +- 0.428 (in-sample avg dev_std = 0.538)
NEC for r=0.1 class 1.0 = 0.584 +- 0.428 (in-sample avg dev_std = 0.538)
NEC for r=0.1 all KL = 0.536 +- 0.428 (in-sample avg dev_std = 0.538)
NEC for r=0.1 all L1 = 0.428 +- 0.349 (in-sample avg dev_std = 0.538)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6291796000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.628
NEC for r=0.2 class 0.0 = 0.224 +- 0.404 (in-sample avg dev_std = 0.574)
NEC for r=0.2 class 1.0 = 0.467 +- 0.404 (in-sample avg dev_std = 0.574)
NEC for r=0.2 all KL = 0.457 +- 0.404 (in-sample avg dev_std = 0.574)
NEC for r=0.2 all L1 = 0.344 +- 0.315 (in-sample avg dev_std = 0.574)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6322397999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.668
NEC for r=0.4 class 0.0 = 0.167 +- 0.370 (in-sample avg dev_std = 0.553)
NEC for r=0.4 class 1.0 = 0.336 +- 0.370 (in-sample avg dev_std = 0.553)
NEC for r=0.4 all KL = 0.357 +- 0.370 (in-sample avg dev_std = 0.553)
NEC for r=0.4 all L1 = 0.251 +- 0.272 (in-sample avg dev_std = 0.553)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6347246
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.69
NEC for r=0.8 class 0.0 = 0.13 +- 0.343 (in-sample avg dev_std = 0.499)
NEC for r=0.8 class 1.0 = 0.259 +- 0.343 (in-sample avg dev_std = 0.499)
NEC for r=0.8 all KL = 0.287 +- 0.343 (in-sample avg dev_std = 0.499)
NEC for r=0.8 all L1 = 0.194 +- 0.244 (in-sample avg dev_std = 0.499)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:53:36 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 03:53:36 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 03:53:36 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:53:36 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 03:53:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:53:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:53:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:53:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:53:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:53:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:53:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mChartInfo 0.9500 0.9500 0.9500 0.9500 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.545
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.589
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.571
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.528
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.491
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.419
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.308
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.237
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.203
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.196
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.563
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.600
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.619
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.626
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.634


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.544598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.869
SUFF_SIMPLE for r=0.05 class 0.0 = 0.909 +- 0.320 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.717 +- 0.320 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.05 all KL = 0.76 +- 0.320 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.05 all L1 = 0.803 +- 0.222 (in-sample avg dev_std = 0.448)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.589254
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.893
SUFF_SIMPLE for r=0.1 class 0.0 = 0.906 +- 0.290 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.771 +- 0.290 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.1 all KL = 0.803 +- 0.290 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.1 all L1 = 0.831 +- 0.198 (in-sample avg dev_std = 0.410)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.571346
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.91
SUFF_SIMPLE for r=0.2 class 0.0 = 0.9 +- 0.258 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.811 +- 0.258 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.2 all KL = 0.839 +- 0.258 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.2 all L1 = 0.851 +- 0.188 (in-sample avg dev_std = 0.364)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.52767
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.913
SUFF_SIMPLE for r=0.4 class 0.0 = 0.899 +- 0.246 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.815 +- 0.246 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.4 all KL = 0.847 +- 0.246 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.4 all L1 = 0.852 +- 0.188 (in-sample avg dev_std = 0.339)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.491084
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.883
SUFF_SIMPLE for r=0.8 class 0.0 = 0.881 +- 0.270 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.788 +- 0.270 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.8 all KL = 0.839 +- 0.270 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.8 all L1 = 0.829 +- 0.234 (in-sample avg dev_std = 0.275)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4193664000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.517
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.123 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.861 +- 0.123 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 all KL = 0.953 +- 0.123 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 all L1 = 0.929 +- 0.160 (in-sample avg dev_std = 0.128)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3080754
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.517
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.125 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.86 +- 0.125 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.1 all KL = 0.952 +- 0.125 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.1 all L1 = 0.928 +- 0.161 (in-sample avg dev_std = 0.128)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23700439999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.515
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.126 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.858 +- 0.126 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.2 all KL = 0.952 +- 0.126 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.2 all L1 = 0.927 +- 0.165 (in-sample avg dev_std = 0.117)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20296779999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.513
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.134 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.853 +- 0.134 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.4 all KL = 0.948 +- 0.134 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.4 all L1 = 0.925 +- 0.170 (in-sample avg dev_std = 0.115)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1956944
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.505
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.167 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.837 +- 0.167 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.8 all KL = 0.937 +- 0.167 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.8 all L1 = 0.917 +- 0.191 (in-sample avg dev_std = 0.093)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5627904
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.705
SUFF_SIMPLE for r=0.05 class 0.0 = 0.895 +- 0.348 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.791 +- 0.348 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.05 all KL = 0.793 +- 0.348 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.05 all L1 = 0.843 +- 0.255 (in-sample avg dev_std = 0.368)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.600358
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.714
SUFF_SIMPLE for r=0.1 class 0.0 = 0.902 +- 0.324 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.821 +- 0.324 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 all KL = 0.829 +- 0.324 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 all L1 = 0.862 +- 0.246 (in-sample avg dev_std = 0.324)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.618613
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.713
SUFF_SIMPLE for r=0.2 class 0.0 = 0.916 +- 0.287 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.854 +- 0.287 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 all KL = 0.87 +- 0.287 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 all L1 = 0.885 +- 0.233 (in-sample avg dev_std = 0.264)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6259155999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.715
SUFF_SIMPLE for r=0.4 class 0.0 = 0.921 +- 0.276 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.862 +- 0.276 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.4 all KL = 0.883 +- 0.276 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.4 all L1 = 0.892 +- 0.231 (in-sample avg dev_std = 0.227)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.759
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6338482
len(reference) = 4960
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.711
SUFF_SIMPLE for r=0.8 class 0.0 = 0.917 +- 0.264 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.879 +- 0.264 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.8 all KL = 0.902 +- 0.264 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.8 all L1 = 0.899 +- 0.237 (in-sample avg dev_std = 0.119)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.544598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.511
NEC for r=0.05 class 0.0 = 0.08 +- 0.453 (in-sample avg dev_std = 0.321)
NEC for r=0.05 class 1.0 = 0.775 +- 0.453 (in-sample avg dev_std = 0.321)
NEC for r=0.05 all KL = 0.53 +- 0.453 (in-sample avg dev_std = 0.321)
NEC for r=0.05 all L1 = 0.465 +- 0.377 (in-sample avg dev_std = 0.321)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.589254
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.639
NEC for r=0.1 class 0.0 = 0.067 +- 0.431 (in-sample avg dev_std = 0.545)
NEC for r=0.1 class 1.0 = 0.647 +- 0.431 (in-sample avg dev_std = 0.545)
NEC for r=0.1 all KL = 0.48 +- 0.431 (in-sample avg dev_std = 0.545)
NEC for r=0.1 all L1 = 0.389 +- 0.334 (in-sample avg dev_std = 0.545)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.571346
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.758
NEC for r=0.2 class 0.0 = 0.057 +- 0.394 (in-sample avg dev_std = 0.575)
NEC for r=0.2 class 1.0 = 0.485 +- 0.394 (in-sample avg dev_std = 0.575)
NEC for r=0.2 all KL = 0.394 +- 0.394 (in-sample avg dev_std = 0.575)
NEC for r=0.2 all L1 = 0.294 +- 0.285 (in-sample avg dev_std = 0.575)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.52767
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.856
NEC for r=0.4 class 0.0 = 0.045 +- 0.345 (in-sample avg dev_std = 0.515)
NEC for r=0.4 class 1.0 = 0.314 +- 0.345 (in-sample avg dev_std = 0.515)
NEC for r=0.4 all KL = 0.278 +- 0.345 (in-sample avg dev_std = 0.515)
NEC for r=0.4 all L1 = 0.194 +- 0.225 (in-sample avg dev_std = 0.515)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.491084
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.911
NEC for r=0.8 class 0.0 = 0.041 +- 0.291 (in-sample avg dev_std = 0.432)
NEC for r=0.8 class 1.0 = 0.194 +- 0.291 (in-sample avg dev_std = 0.432)
NEC for r=0.8 all KL = 0.184 +- 0.291 (in-sample avg dev_std = 0.432)
NEC for r=0.8 all L1 = 0.126 +- 0.168 (in-sample avg dev_std = 0.432)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4193664000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.002 +- 0.194 (in-sample avg dev_std = 0.086)
NEC for r=0.05 class 1.0 = 0.172 +- 0.194 (in-sample avg dev_std = 0.086)
NEC for r=0.05 all KL = 0.072 +- 0.194 (in-sample avg dev_std = 0.086)
NEC for r=0.05 all L1 = 0.088 +- 0.206 (in-sample avg dev_std = 0.086)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3080754
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.513
NEC for r=0.1 class 0.0 = 0.002 +- 0.173 (in-sample avg dev_std = 0.169)
NEC for r=0.1 class 1.0 = 0.151 +- 0.173 (in-sample avg dev_std = 0.169)
NEC for r=0.1 all KL = 0.062 +- 0.173 (in-sample avg dev_std = 0.169)
NEC for r=0.1 all L1 = 0.077 +- 0.182 (in-sample avg dev_std = 0.169)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23700439999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.523
NEC for r=0.2 class 0.0 = 0.002 +- 0.143 (in-sample avg dev_std = 0.188)
NEC for r=0.2 class 1.0 = 0.126 +- 0.143 (in-sample avg dev_std = 0.188)
NEC for r=0.2 all KL = 0.049 +- 0.143 (in-sample avg dev_std = 0.188)
NEC for r=0.2 all L1 = 0.064 +- 0.153 (in-sample avg dev_std = 0.188)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20296779999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.531
NEC for r=0.4 class 0.0 = 0.002 +- 0.109 (in-sample avg dev_std = 0.171)
NEC for r=0.4 class 1.0 = 0.104 +- 0.109 (in-sample avg dev_std = 0.171)
NEC for r=0.4 all KL = 0.036 +- 0.109 (in-sample avg dev_std = 0.171)
NEC for r=0.4 all L1 = 0.053 +- 0.126 (in-sample avg dev_std = 0.171)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1956944
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.533
NEC for r=0.8 class 0.0 = 0.002 +- 0.086 (in-sample avg dev_std = 0.144)
NEC for r=0.8 class 1.0 = 0.095 +- 0.086 (in-sample avg dev_std = 0.144)
NEC for r=0.8 all KL = 0.028 +- 0.086 (in-sample avg dev_std = 0.144)
NEC for r=0.8 all L1 = 0.048 +- 0.112 (in-sample avg dev_std = 0.144)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5627904
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.556
NEC for r=0.05 class 0.0 = 0.302 +- 0.441 (in-sample avg dev_std = 0.406)
NEC for r=0.05 class 1.0 = 0.692 +- 0.441 (in-sample avg dev_std = 0.406)
NEC for r=0.05 all KL = 0.568 +- 0.441 (in-sample avg dev_std = 0.406)
NEC for r=0.05 all L1 = 0.495 +- 0.382 (in-sample avg dev_std = 0.406)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.600358
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.59
NEC for r=0.1 class 0.0 = 0.269 +- 0.425 (in-sample avg dev_std = 0.550)
NEC for r=0.1 class 1.0 = 0.61 +- 0.425 (in-sample avg dev_std = 0.550)
NEC for r=0.1 all KL = 0.525 +- 0.425 (in-sample avg dev_std = 0.550)
NEC for r=0.1 all L1 = 0.437 +- 0.355 (in-sample avg dev_std = 0.550)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.618613
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.628
NEC for r=0.2 class 0.0 = 0.221 +- 0.410 (in-sample avg dev_std = 0.607)
NEC for r=0.2 class 1.0 = 0.494 +- 0.410 (in-sample avg dev_std = 0.607)
NEC for r=0.2 all KL = 0.458 +- 0.410 (in-sample avg dev_std = 0.607)
NEC for r=0.2 all L1 = 0.356 +- 0.321 (in-sample avg dev_std = 0.607)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6259155999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.665
NEC for r=0.4 class 0.0 = 0.164 +- 0.387 (in-sample avg dev_std = 0.587)
NEC for r=0.4 class 1.0 = 0.373 +- 0.387 (in-sample avg dev_std = 0.587)
NEC for r=0.4 all KL = 0.374 +- 0.387 (in-sample avg dev_std = 0.587)
NEC for r=0.4 all L1 = 0.267 +- 0.279 (in-sample avg dev_std = 0.587)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.758
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6338482
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.691
NEC for r=0.8 class 0.0 = 0.129 +- 0.364 (in-sample avg dev_std = 0.540)
NEC for r=0.8 class 1.0 = 0.281 +- 0.364 (in-sample avg dev_std = 0.540)
NEC for r=0.8 all KL = 0.307 +- 0.364 (in-sample avg dev_std = 0.540)
NEC for r=0.8 all L1 = 0.204 +- 0.243 (in-sample avg dev_std = 0.540)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:12:09 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 04:12:09 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 04:12:09 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:12:09 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 04:12:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:12:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:12:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:12:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:12:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:12:09 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:12:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mChartInfo 0.9460 0.9460 0.9460 0.9460 0.9560 0.9560[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.544
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.543
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.467
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.374
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.311
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.326
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.199
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.120
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.063
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.545
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.572
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.579
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.581
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.586


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.543858
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.814
SUFF_SIMPLE for r=0.05 class 0.0 = 0.887 +- 0.292 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.633 +- 0.292 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.05 all KL = 0.738 +- 0.292 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.05 all L1 = 0.747 +- 0.237 (in-sample avg dev_std = 0.444)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.54268
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.836
SUFF_SIMPLE for r=0.1 class 0.0 = 0.883 +- 0.274 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.676 +- 0.274 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.1 all KL = 0.767 +- 0.274 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.1 all L1 = 0.769 +- 0.226 (in-sample avg dev_std = 0.408)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46653999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.849
SUFF_SIMPLE for r=0.2 class 0.0 = 0.882 +- 0.269 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.714 +- 0.269 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.2 all KL = 0.796 +- 0.269 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.2 all L1 = 0.789 +- 0.226 (in-sample avg dev_std = 0.376)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.37388600000000005
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.862
SUFF_SIMPLE for r=0.4 class 0.0 = 0.881 +- 0.257 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.729 +- 0.257 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.4 all KL = 0.808 +- 0.257 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.4 all L1 = 0.797 +- 0.225 (in-sample avg dev_std = 0.349)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.310576
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.846
SUFF_SIMPLE for r=0.8 class 0.0 = 0.873 +- 0.280 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.725 +- 0.280 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.8 all KL = 0.823 +- 0.280 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.8 all L1 = 0.791 +- 0.258 (in-sample avg dev_std = 0.238)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3264632
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.084 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.918 +- 0.084 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.05 all KL = 0.975 +- 0.084 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.05 all L1 = 0.958 +- 0.120 (in-sample avg dev_std = 0.051)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1992766
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.082 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.918 +- 0.082 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.1 all KL = 0.975 +- 0.082 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.1 all L1 = 0.958 +- 0.120 (in-sample avg dev_std = 0.050)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.120321
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.080 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.919 +- 0.080 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.2 all KL = 0.976 +- 0.080 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.2 all L1 = 0.959 +- 0.118 (in-sample avg dev_std = 0.052)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0774788
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.081 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.918 +- 0.081 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.4 all KL = 0.975 +- 0.081 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.4 all L1 = 0.958 +- 0.119 (in-sample avg dev_std = 0.051)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06265060000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.497
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.087 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.915 +- 0.087 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all KL = 0.973 +- 0.087 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all L1 = 0.957 +- 0.124 (in-sample avg dev_std = 0.031)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5448006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.702
SUFF_SIMPLE for r=0.05 class 0.0 = 0.914 +- 0.313 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.841 +- 0.313 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.05 all KL = 0.852 +- 0.313 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.05 all L1 = 0.878 +- 0.242 (in-sample avg dev_std = 0.245)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5719512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.706
SUFF_SIMPLE for r=0.1 class 0.0 = 0.916 +- 0.300 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.854 +- 0.300 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.1 all KL = 0.865 +- 0.300 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.1 all L1 = 0.886 +- 0.235 (in-sample avg dev_std = 0.217)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5790533999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.711
SUFF_SIMPLE for r=0.2 class 0.0 = 0.925 +- 0.269 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.87 +- 0.269 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all KL = 0.892 +- 0.269 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all L1 = 0.898 +- 0.229 (in-sample avg dev_std = 0.195)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5811682
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.714
SUFF_SIMPLE for r=0.4 class 0.0 = 0.93 +- 0.256 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.878 +- 0.256 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 all KL = 0.904 +- 0.256 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 all L1 = 0.904 +- 0.226 (in-sample avg dev_std = 0.166)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5863786
len(reference) = 4946
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.707
SUFF_SIMPLE for r=0.8 class 0.0 = 0.936 +- 0.248 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.884 +- 0.248 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.8 all KL = 0.916 +- 0.248 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.226 (in-sample avg dev_std = 0.080)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.543858
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.555
NEC for r=0.05 class 0.0 = 0.119 +- 0.419 (in-sample avg dev_std = 0.354)
NEC for r=0.05 class 1.0 = 0.721 +- 0.419 (in-sample avg dev_std = 0.354)
NEC for r=0.05 all KL = 0.495 +- 0.419 (in-sample avg dev_std = 0.354)
NEC for r=0.05 all L1 = 0.453 +- 0.356 (in-sample avg dev_std = 0.354)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.54268
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.661
NEC for r=0.1 class 0.0 = 0.108 +- 0.387 (in-sample avg dev_std = 0.493)
NEC for r=0.1 class 1.0 = 0.607 +- 0.387 (in-sample avg dev_std = 0.493)
NEC for r=0.1 all KL = 0.432 +- 0.387 (in-sample avg dev_std = 0.493)
NEC for r=0.1 all L1 = 0.384 +- 0.318 (in-sample avg dev_std = 0.493)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46653999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.757
NEC for r=0.2 class 0.0 = 0.087 +- 0.333 (in-sample avg dev_std = 0.535)
NEC for r=0.2 class 1.0 = 0.475 +- 0.333 (in-sample avg dev_std = 0.535)
NEC for r=0.2 all KL = 0.349 +- 0.333 (in-sample avg dev_std = 0.535)
NEC for r=0.2 all L1 = 0.302 +- 0.261 (in-sample avg dev_std = 0.535)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.37388600000000005
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.831
NEC for r=0.4 class 0.0 = 0.08 +- 0.277 (in-sample avg dev_std = 0.493)
NEC for r=0.4 class 1.0 = 0.345 +- 0.277 (in-sample avg dev_std = 0.493)
NEC for r=0.4 all KL = 0.26 +- 0.277 (in-sample avg dev_std = 0.493)
NEC for r=0.4 all L1 = 0.227 +- 0.215 (in-sample avg dev_std = 0.493)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.310576
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.887
NEC for r=0.8 class 0.0 = 0.068 +- 0.218 (in-sample avg dev_std = 0.396)
NEC for r=0.8 class 1.0 = 0.215 +- 0.218 (in-sample avg dev_std = 0.396)
NEC for r=0.8 all KL = 0.159 +- 0.218 (in-sample avg dev_std = 0.396)
NEC for r=0.8 all L1 = 0.15 +- 0.169 (in-sample avg dev_std = 0.396)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3264632
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.104 (in-sample avg dev_std = 0.023)
NEC for r=0.05 class 1.0 = 0.089 +- 0.104 (in-sample avg dev_std = 0.023)
NEC for r=0.05 all KL = 0.031 +- 0.104 (in-sample avg dev_std = 0.023)
NEC for r=0.05 all L1 = 0.045 +- 0.132 (in-sample avg dev_std = 0.023)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1992766
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.001 +- 0.097 (in-sample avg dev_std = 0.050)
NEC for r=0.1 class 1.0 = 0.085 +- 0.097 (in-sample avg dev_std = 0.050)
NEC for r=0.1 all KL = 0.029 +- 0.097 (in-sample avg dev_std = 0.050)
NEC for r=0.1 all L1 = 0.043 +- 0.127 (in-sample avg dev_std = 0.050)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.120321
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
NEC for r=0.2 class 0.0 = 0.001 +- 0.086 (in-sample avg dev_std = 0.066)
NEC for r=0.2 class 1.0 = 0.08 +- 0.086 (in-sample avg dev_std = 0.066)
NEC for r=0.2 all KL = 0.025 +- 0.086 (in-sample avg dev_std = 0.066)
NEC for r=0.2 all L1 = 0.041 +- 0.118 (in-sample avg dev_std = 0.066)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0774788
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.5
NEC for r=0.4 class 0.0 = 0.001 +- 0.075 (in-sample avg dev_std = 0.072)
NEC for r=0.4 class 1.0 = 0.073 +- 0.075 (in-sample avg dev_std = 0.072)
NEC for r=0.4 all KL = 0.022 +- 0.075 (in-sample avg dev_std = 0.072)
NEC for r=0.4 all L1 = 0.037 +- 0.109 (in-sample avg dev_std = 0.072)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06265060000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.501
NEC for r=0.8 class 0.0 = 0.0 +- 0.061 (in-sample avg dev_std = 0.076)
NEC for r=0.8 class 1.0 = 0.067 +- 0.061 (in-sample avg dev_std = 0.076)
NEC for r=0.8 all KL = 0.018 +- 0.061 (in-sample avg dev_std = 0.076)
NEC for r=0.8 all L1 = 0.034 +- 0.098 (in-sample avg dev_std = 0.076)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5448006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.573
NEC for r=0.05 class 0.0 = 0.308 +- 0.430 (in-sample avg dev_std = 0.433)
NEC for r=0.05 class 1.0 = 0.685 +- 0.430 (in-sample avg dev_std = 0.433)
NEC for r=0.05 all KL = 0.559 +- 0.430 (in-sample avg dev_std = 0.433)
NEC for r=0.05 all L1 = 0.494 +- 0.370 (in-sample avg dev_std = 0.433)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5719512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.597
NEC for r=0.1 class 0.0 = 0.272 +- 0.408 (in-sample avg dev_std = 0.558)
NEC for r=0.1 class 1.0 = 0.609 +- 0.408 (in-sample avg dev_std = 0.558)
NEC for r=0.1 all KL = 0.514 +- 0.408 (in-sample avg dev_std = 0.558)
NEC for r=0.1 all L1 = 0.438 +- 0.343 (in-sample avg dev_std = 0.558)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5790533999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.624
NEC for r=0.2 class 0.0 = 0.217 +- 0.378 (in-sample avg dev_std = 0.590)
NEC for r=0.2 class 1.0 = 0.474 +- 0.378 (in-sample avg dev_std = 0.590)
NEC for r=0.2 all KL = 0.422 +- 0.378 (in-sample avg dev_std = 0.590)
NEC for r=0.2 all L1 = 0.344 +- 0.310 (in-sample avg dev_std = 0.590)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5811682
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.666
NEC for r=0.4 class 0.0 = 0.163 +- 0.344 (in-sample avg dev_std = 0.543)
NEC for r=0.4 class 1.0 = 0.341 +- 0.344 (in-sample avg dev_std = 0.543)
NEC for r=0.4 all KL = 0.32 +- 0.344 (in-sample avg dev_std = 0.543)
NEC for r=0.4 all L1 = 0.251 +- 0.271 (in-sample avg dev_std = 0.543)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5863786
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.691
NEC for r=0.8 class 0.0 = 0.121 +- 0.311 (in-sample avg dev_std = 0.471)
NEC for r=0.8 class 1.0 = 0.242 +- 0.311 (in-sample avg dev_std = 0.471)
NEC for r=0.8 all KL = 0.24 +- 0.311 (in-sample avg dev_std = 0.471)
NEC for r=0.8 all L1 = 0.181 +- 0.235 (in-sample avg dev_std = 0.471)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:30:49 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 04:30:49 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 04:30:49 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:30:49 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 04:30:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:30:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:30:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:30:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:30:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:30:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:30:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mChartInfo 0.9660 0.9660 0.9660 0.9660 0.9720 0.9720[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.572
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.604
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.572
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.518
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.472
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.385
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.263
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.186
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.147
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.135
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.554
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.599
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.618
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.624
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.624


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5724199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.877
SUFF_SIMPLE for r=0.05 class 0.0 = 0.922 +- 0.288 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.767 +- 0.288 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.05 all KL = 0.816 +- 0.288 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.05 all L1 = 0.836 +- 0.213 (in-sample avg dev_std = 0.371)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6036300000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.9
SUFF_SIMPLE for r=0.1 class 0.0 = 0.918 +- 0.259 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.808 +- 0.259 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.1 all KL = 0.855 +- 0.259 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.1 all L1 = 0.857 +- 0.204 (in-sample avg dev_std = 0.314)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5717420000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.909
SUFF_SIMPLE for r=0.2 class 0.0 = 0.914 +- 0.221 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.835 +- 0.221 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.2 all KL = 0.878 +- 0.221 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.2 all L1 = 0.871 +- 0.188 (in-sample avg dev_std = 0.278)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.517828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.902
SUFF_SIMPLE for r=0.4 class 0.0 = 0.905 +- 0.228 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.834 +- 0.228 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.4 all KL = 0.87 +- 0.228 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.4 all L1 = 0.865 +- 0.197 (in-sample avg dev_std = 0.281)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47195
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.866
SUFF_SIMPLE for r=0.8 class 0.0 = 0.898 +- 0.285 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.781 +- 0.285 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.8 all KL = 0.841 +- 0.285 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.8 all L1 = 0.833 +- 0.250 (in-sample avg dev_std = 0.260)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3853108
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.502
SUFF_SIMPLE for r=0.05 class 0.0 = 1.0 +- 0.091 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.924 +- 0.091 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.05 all KL = 0.975 +- 0.091 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.05 all L1 = 0.961 +- 0.126 (in-sample avg dev_std = 0.069)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2630796
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.502
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.096 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.922 +- 0.096 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.1 all KL = 0.974 +- 0.096 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.1 all L1 = 0.96 +- 0.129 (in-sample avg dev_std = 0.069)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1859616
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.502
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.098 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.921 +- 0.098 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.2 all KL = 0.973 +- 0.098 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.2 all L1 = 0.96 +- 0.130 (in-sample avg dev_std = 0.069)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1471292
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.501
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.100 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.92 +- 0.100 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 all KL = 0.973 +- 0.100 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 all L1 = 0.96 +- 0.132 (in-sample avg dev_std = 0.065)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.13548960000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.498
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.121 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.914 +- 0.121 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.8 all KL = 0.967 +- 0.121 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.8 all L1 = 0.956 +- 0.144 (in-sample avg dev_std = 0.047)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5538407999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.716
SUFF_SIMPLE for r=0.05 class 0.0 = 0.919 +- 0.299 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.833 +- 0.299 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.05 all KL = 0.864 +- 0.299 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.05 all L1 = 0.877 +- 0.255 (in-sample avg dev_std = 0.230)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5990923999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.726
SUFF_SIMPLE for r=0.1 class 0.0 = 0.92 +- 0.281 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.857 +- 0.281 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all KL = 0.881 +- 0.281 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all L1 = 0.889 +- 0.244 (in-sample avg dev_std = 0.196)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6184592000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.729
SUFF_SIMPLE for r=0.2 class 0.0 = 0.919 +- 0.282 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.861 +- 0.282 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 all KL = 0.882 +- 0.282 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 all L1 = 0.891 +- 0.242 (in-sample avg dev_std = 0.198)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6244049999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.734
SUFF_SIMPLE for r=0.4 class 0.0 = 0.917 +- 0.280 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.865 +- 0.280 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all KL = 0.883 +- 0.280 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all L1 = 0.891 +- 0.242 (in-sample avg dev_std = 0.182)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6240072
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.728
SUFF_SIMPLE for r=0.8 class 0.0 = 0.92 +- 0.262 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.886 +- 0.262 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.8 all KL = 0.903 +- 0.262 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.8 all L1 = 0.903 +- 0.236 (in-sample avg dev_std = 0.085)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5724199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.537
NEC for r=0.05 class 0.0 = 0.059 +- 0.447 (in-sample avg dev_std = 0.367)
NEC for r=0.05 class 1.0 = 0.727 +- 0.447 (in-sample avg dev_std = 0.367)
NEC for r=0.05 all KL = 0.506 +- 0.447 (in-sample avg dev_std = 0.367)
NEC for r=0.05 all L1 = 0.429 +- 0.364 (in-sample avg dev_std = 0.367)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6036300000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.665
NEC for r=0.1 class 0.0 = 0.051 +- 0.411 (in-sample avg dev_std = 0.515)
NEC for r=0.1 class 1.0 = 0.585 +- 0.411 (in-sample avg dev_std = 0.515)
NEC for r=0.1 all KL = 0.439 +- 0.411 (in-sample avg dev_std = 0.515)
NEC for r=0.1 all L1 = 0.347 +- 0.318 (in-sample avg dev_std = 0.515)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5717420000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.779
NEC for r=0.2 class 0.0 = 0.038 +- 0.368 (in-sample avg dev_std = 0.508)
NEC for r=0.2 class 1.0 = 0.412 +- 0.368 (in-sample avg dev_std = 0.508)
NEC for r=0.2 all KL = 0.328 +- 0.368 (in-sample avg dev_std = 0.508)
NEC for r=0.2 all L1 = 0.245 +- 0.268 (in-sample avg dev_std = 0.508)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.517828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.86
NEC for r=0.4 class 0.0 = 0.033 +- 0.308 (in-sample avg dev_std = 0.471)
NEC for r=0.4 class 1.0 = 0.277 +- 0.308 (in-sample avg dev_std = 0.471)
NEC for r=0.4 all KL = 0.238 +- 0.308 (in-sample avg dev_std = 0.471)
NEC for r=0.4 all L1 = 0.168 +- 0.203 (in-sample avg dev_std = 0.471)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47195
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.902
NEC for r=0.8 class 0.0 = 0.036 +- 0.256 (in-sample avg dev_std = 0.395)
NEC for r=0.8 class 1.0 = 0.189 +- 0.256 (in-sample avg dev_std = 0.395)
NEC for r=0.8 all KL = 0.167 +- 0.256 (in-sample avg dev_std = 0.395)
NEC for r=0.8 all L1 = 0.121 +- 0.161 (in-sample avg dev_std = 0.395)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3853108
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
NEC for r=0.05 class 0.0 = 0.0 +- 0.133 (in-sample avg dev_std = 0.057)
NEC for r=0.05 class 1.0 = 0.088 +- 0.133 (in-sample avg dev_std = 0.057)
NEC for r=0.05 all KL = 0.035 +- 0.133 (in-sample avg dev_std = 0.057)
NEC for r=0.05 all L1 = 0.045 +- 0.149 (in-sample avg dev_std = 0.057)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2630796
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.504
NEC for r=0.1 class 0.0 = 0.0 +- 0.114 (in-sample avg dev_std = 0.110)
NEC for r=0.1 class 1.0 = 0.076 +- 0.114 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all KL = 0.029 +- 0.114 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all L1 = 0.039 +- 0.130 (in-sample avg dev_std = 0.110)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1859616
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.507
NEC for r=0.2 class 0.0 = 0.0 +- 0.093 (in-sample avg dev_std = 0.115)
NEC for r=0.2 class 1.0 = 0.066 +- 0.093 (in-sample avg dev_std = 0.115)
NEC for r=0.2 all KL = 0.023 +- 0.093 (in-sample avg dev_std = 0.115)
NEC for r=0.2 all L1 = 0.033 +- 0.113 (in-sample avg dev_std = 0.115)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1471292
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.51
NEC for r=0.4 class 0.0 = 0.0 +- 0.072 (in-sample avg dev_std = 0.101)
NEC for r=0.4 class 1.0 = 0.059 +- 0.072 (in-sample avg dev_std = 0.101)
NEC for r=0.4 all KL = 0.017 +- 0.072 (in-sample avg dev_std = 0.101)
NEC for r=0.4 all L1 = 0.03 +- 0.099 (in-sample avg dev_std = 0.101)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.13548960000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.511
NEC for r=0.8 class 0.0 = 0.0 +- 0.060 (in-sample avg dev_std = 0.086)
NEC for r=0.8 class 1.0 = 0.057 +- 0.060 (in-sample avg dev_std = 0.086)
NEC for r=0.8 all KL = 0.015 +- 0.060 (in-sample avg dev_std = 0.086)
NEC for r=0.8 all L1 = 0.029 +- 0.093 (in-sample avg dev_std = 0.086)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5538407999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.552
NEC for r=0.05 class 0.0 = 0.301 +- 0.448 (in-sample avg dev_std = 0.453)
NEC for r=0.05 class 1.0 = 0.708 +- 0.448 (in-sample avg dev_std = 0.453)
NEC for r=0.05 all KL = 0.603 +- 0.448 (in-sample avg dev_std = 0.453)
NEC for r=0.05 all L1 = 0.502 +- 0.368 (in-sample avg dev_std = 0.453)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5990923999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.589
NEC for r=0.1 class 0.0 = 0.259 +- 0.424 (in-sample avg dev_std = 0.545)
NEC for r=0.1 class 1.0 = 0.605 +- 0.424 (in-sample avg dev_std = 0.545)
NEC for r=0.1 all KL = 0.552 +- 0.424 (in-sample avg dev_std = 0.545)
NEC for r=0.1 all L1 = 0.43 +- 0.339 (in-sample avg dev_std = 0.545)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6184592000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.63
NEC for r=0.2 class 0.0 = 0.201 +- 0.396 (in-sample avg dev_std = 0.554)
NEC for r=0.2 class 1.0 = 0.47 +- 0.396 (in-sample avg dev_std = 0.554)
NEC for r=0.2 all KL = 0.454 +- 0.396 (in-sample avg dev_std = 0.554)
NEC for r=0.2 all L1 = 0.334 +- 0.307 (in-sample avg dev_std = 0.554)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6244049999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.673
NEC for r=0.4 class 0.0 = 0.146 +- 0.362 (in-sample avg dev_std = 0.513)
NEC for r=0.4 class 1.0 = 0.344 +- 0.362 (in-sample avg dev_std = 0.513)
NEC for r=0.4 all KL = 0.344 +- 0.362 (in-sample avg dev_std = 0.513)
NEC for r=0.4 all L1 = 0.244 +- 0.269 (in-sample avg dev_std = 0.513)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6240072
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.703
NEC for r=0.8 class 0.0 = 0.116 +- 0.328 (in-sample avg dev_std = 0.455)
NEC for r=0.8 class 1.0 = 0.256 +- 0.328 (in-sample avg dev_std = 0.455)
NEC for r=0.8 all KL = 0.263 +- 0.328 (in-sample avg dev_std = 0.455)
NEC for r=0.8 all L1 = 0.185 +- 0.242 (in-sample avg dev_std = 0.455)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:49:08 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 04:49:08 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 04:49:08 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:49:08 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 04:49:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:49:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:49:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:49:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:49:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:49:08 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:49:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mChartInfo 0.9320 0.9320 0.9320 0.9320 0.9260 0.9260[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.520
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.497
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.408
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.300
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.219
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.266
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.161
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.099
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.055
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.528
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.545
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.538
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.529
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.536


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.519802
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.807
SUFF_SIMPLE for r=0.05 class 0.0 = 0.857 +- 0.280 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.674 +- 0.280 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all KL = 0.802 +- 0.280 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all L1 = 0.755 +- 0.239 (in-sample avg dev_std = 0.340)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49693200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.823
SUFF_SIMPLE for r=0.1 class 0.0 = 0.859 +- 0.248 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.707 +- 0.248 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.1 all KL = 0.831 +- 0.248 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.1 all L1 = 0.775 +- 0.222 (in-sample avg dev_std = 0.295)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.407726
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.84
SUFF_SIMPLE for r=0.2 class 0.0 = 0.856 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.74 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.2 all KL = 0.858 +- 0.214 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.2 all L1 = 0.792 +- 0.213 (in-sample avg dev_std = 0.237)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.300044
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.838
SUFF_SIMPLE for r=0.4 class 0.0 = 0.849 +- 0.209 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.739 +- 0.209 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.4 all KL = 0.858 +- 0.209 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.4 all L1 = 0.788 +- 0.213 (in-sample avg dev_std = 0.227)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.218806
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.806
SUFF_SIMPLE for r=0.8 class 0.0 = 0.826 +- 0.244 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.682 +- 0.244 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.8 all KL = 0.821 +- 0.244 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.8 all L1 = 0.747 +- 0.247 (in-sample avg dev_std = 0.166)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2663822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.501
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.083 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.862 +- 0.083 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.05 all KL = 0.963 +- 0.083 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.05 all L1 = 0.928 +- 0.142 (in-sample avg dev_std = 0.066)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1609544
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.501
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.085 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.861 +- 0.085 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.1 all KL = 0.962 +- 0.085 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.1 all L1 = 0.928 +- 0.144 (in-sample avg dev_std = 0.064)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0992264
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.501
SUFF_SIMPLE for r=0.2 class 0.0 = 0.996 +- 0.085 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.861 +- 0.085 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.2 all KL = 0.962 +- 0.085 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.2 all L1 = 0.928 +- 0.144 (in-sample avg dev_std = 0.062)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661854
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.501
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.088 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.859 +- 0.088 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.4 all KL = 0.961 +- 0.088 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.4 all L1 = 0.927 +- 0.146 (in-sample avg dev_std = 0.060)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.054928
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.5
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.096 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.855 +- 0.096 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 all KL = 0.958 +- 0.096 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 all L1 = 0.925 +- 0.151 (in-sample avg dev_std = 0.052)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5278546000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.622
SUFF_SIMPLE for r=0.05 class 0.0 = 0.91 +- 0.282 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.812 +- 0.282 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.05 all KL = 0.871 +- 0.282 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.05 all L1 = 0.862 +- 0.246 (in-sample avg dev_std = 0.190)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5454656
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.628
SUFF_SIMPLE for r=0.1 class 0.0 = 0.913 +- 0.267 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.829 +- 0.267 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.1 all KL = 0.886 +- 0.267 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.1 all L1 = 0.871 +- 0.239 (in-sample avg dev_std = 0.141)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5384985999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.632
SUFF_SIMPLE for r=0.2 class 0.0 = 0.915 +- 0.261 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.261 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 all KL = 0.891 +- 0.261 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 all L1 = 0.875 +- 0.234 (in-sample avg dev_std = 0.132)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5286824000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.634
SUFF_SIMPLE for r=0.4 class 0.0 = 0.913 +- 0.263 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.836 +- 0.263 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.4 all KL = 0.89 +- 0.263 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.4 all L1 = 0.875 +- 0.234 (in-sample avg dev_std = 0.133)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.535523
len(reference) = 4947
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.639
SUFF_SIMPLE for r=0.8 class 0.0 = 0.92 +- 0.246 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.852 +- 0.246 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.8 all KL = 0.908 +- 0.246 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.8 all L1 = 0.886 +- 0.230 (in-sample avg dev_std = 0.046)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.519802
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.515
NEC for r=0.05 class 0.0 = 0.15 +- 0.400 (in-sample avg dev_std = 0.292)
NEC for r=0.05 class 1.0 = 0.727 +- 0.400 (in-sample avg dev_std = 0.292)
NEC for r=0.05 all KL = 0.482 +- 0.400 (in-sample avg dev_std = 0.292)
NEC for r=0.05 all L1 = 0.47 +- 0.349 (in-sample avg dev_std = 0.292)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49693200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.626
NEC for r=0.1 class 0.0 = 0.134 +- 0.369 (in-sample avg dev_std = 0.493)
NEC for r=0.1 class 1.0 = 0.608 +- 0.369 (in-sample avg dev_std = 0.493)
NEC for r=0.1 all KL = 0.416 +- 0.369 (in-sample avg dev_std = 0.493)
NEC for r=0.1 all L1 = 0.397 +- 0.310 (in-sample avg dev_std = 0.493)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.407726
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.732
NEC for r=0.2 class 0.0 = 0.103 +- 0.327 (in-sample avg dev_std = 0.510)
NEC for r=0.2 class 1.0 = 0.448 +- 0.327 (in-sample avg dev_std = 0.510)
NEC for r=0.2 all KL = 0.307 +- 0.327 (in-sample avg dev_std = 0.510)
NEC for r=0.2 all L1 = 0.294 +- 0.263 (in-sample avg dev_std = 0.510)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.300044
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.811
NEC for r=0.4 class 0.0 = 0.094 +- 0.281 (in-sample avg dev_std = 0.476)
NEC for r=0.4 class 1.0 = 0.322 +- 0.281 (in-sample avg dev_std = 0.476)
NEC for r=0.4 all KL = 0.224 +- 0.281 (in-sample avg dev_std = 0.476)
NEC for r=0.4 all L1 = 0.22 +- 0.218 (in-sample avg dev_std = 0.476)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.218806
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.861
NEC for r=0.8 class 0.0 = 0.08 +- 0.218 (in-sample avg dev_std = 0.390)
NEC for r=0.8 class 1.0 = 0.216 +- 0.218 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all KL = 0.146 +- 0.218 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all L1 = 0.155 +- 0.168 (in-sample avg dev_std = 0.390)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2663822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
NEC for r=0.05 class 0.0 = 0.004 +- 0.141 (in-sample avg dev_std = 0.056)
NEC for r=0.05 class 1.0 = 0.162 +- 0.141 (in-sample avg dev_std = 0.056)
NEC for r=0.05 all KL = 0.058 +- 0.141 (in-sample avg dev_std = 0.056)
NEC for r=0.05 all L1 = 0.084 +- 0.175 (in-sample avg dev_std = 0.056)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1609544
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.501
NEC for r=0.1 class 0.0 = 0.004 +- 0.123 (in-sample avg dev_std = 0.102)
NEC for r=0.1 class 1.0 = 0.147 +- 0.123 (in-sample avg dev_std = 0.102)
NEC for r=0.1 all KL = 0.05 +- 0.123 (in-sample avg dev_std = 0.102)
NEC for r=0.1 all L1 = 0.076 +- 0.159 (in-sample avg dev_std = 0.102)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0992264
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.506
NEC for r=0.2 class 0.0 = 0.003 +- 0.097 (in-sample avg dev_std = 0.117)
NEC for r=0.2 class 1.0 = 0.128 +- 0.097 (in-sample avg dev_std = 0.117)
NEC for r=0.2 all KL = 0.038 +- 0.097 (in-sample avg dev_std = 0.117)
NEC for r=0.2 all L1 = 0.066 +- 0.137 (in-sample avg dev_std = 0.117)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661854
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.509
NEC for r=0.4 class 0.0 = 0.003 +- 0.069 (in-sample avg dev_std = 0.108)
NEC for r=0.4 class 1.0 = 0.111 +- 0.069 (in-sample avg dev_std = 0.108)
NEC for r=0.4 all KL = 0.028 +- 0.069 (in-sample avg dev_std = 0.108)
NEC for r=0.4 all L1 = 0.057 +- 0.116 (in-sample avg dev_std = 0.108)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.054928
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.51
NEC for r=0.8 class 0.0 = 0.003 +- 0.054 (in-sample avg dev_std = 0.093)
NEC for r=0.8 class 1.0 = 0.103 +- 0.054 (in-sample avg dev_std = 0.093)
NEC for r=0.8 all KL = 0.022 +- 0.054 (in-sample avg dev_std = 0.093)
NEC for r=0.8 all L1 = 0.053 +- 0.106 (in-sample avg dev_std = 0.093)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5278546000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.544
NEC for r=0.05 class 0.0 = 0.306 +- 0.396 (in-sample avg dev_std = 0.276)
NEC for r=0.05 class 1.0 = 0.592 +- 0.396 (in-sample avg dev_std = 0.276)
NEC for r=0.05 all KL = 0.442 +- 0.396 (in-sample avg dev_std = 0.276)
NEC for r=0.05 all L1 = 0.447 +- 0.351 (in-sample avg dev_std = 0.276)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5454656
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.558
NEC for r=0.1 class 0.0 = 0.269 +- 0.382 (in-sample avg dev_std = 0.431)
NEC for r=0.1 class 1.0 = 0.529 +- 0.382 (in-sample avg dev_std = 0.431)
NEC for r=0.1 all KL = 0.401 +- 0.382 (in-sample avg dev_std = 0.431)
NEC for r=0.1 all L1 = 0.398 +- 0.332 (in-sample avg dev_std = 0.431)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5384985999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.575
NEC for r=0.2 class 0.0 = 0.222 +- 0.356 (in-sample avg dev_std = 0.507)
NEC for r=0.2 class 1.0 = 0.45 +- 0.356 (in-sample avg dev_std = 0.507)
NEC for r=0.2 all KL = 0.349 +- 0.356 (in-sample avg dev_std = 0.507)
NEC for r=0.2 all L1 = 0.334 +- 0.302 (in-sample avg dev_std = 0.507)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5286824000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.593
NEC for r=0.4 class 0.0 = 0.174 +- 0.331 (in-sample avg dev_std = 0.503)
NEC for r=0.4 class 1.0 = 0.367 +- 0.331 (in-sample avg dev_std = 0.503)
NEC for r=0.4 all KL = 0.29 +- 0.331 (in-sample avg dev_std = 0.503)
NEC for r=0.4 all L1 = 0.269 +- 0.274 (in-sample avg dev_std = 0.503)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.535523
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.606
NEC for r=0.8 class 0.0 = 0.122 +- 0.294 (in-sample avg dev_std = 0.428)
NEC for r=0.8 class 1.0 = 0.274 +- 0.294 (in-sample avg dev_std = 0.428)
NEC for r=0.8 all KL = 0.215 +- 0.294 (in-sample avg dev_std = 0.428)
NEC for r=0.8 all L1 = 0.197 +- 0.246 (in-sample avg dev_std = 0.428)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:07:31 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 05:07:31 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:31 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:31 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 05:07:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:31 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:07:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mChartInfo 0.9540 0.9540 0.9540 0.9540 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.523
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.545
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.492
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.418
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.361
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.345
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.225
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.146
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.102
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.087
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.556
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.592
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.607
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.612
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.609


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5233880000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.841
SUFF_SIMPLE for r=0.05 class 0.0 = 0.883 +- 0.297 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.65 +- 0.297 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.05 all KL = 0.712 +- 0.297 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.05 all L1 = 0.754 +- 0.222 (in-sample avg dev_std = 0.458)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5450740000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.853
SUFF_SIMPLE for r=0.1 class 0.0 = 0.886 +- 0.290 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.676 +- 0.290 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.1 all KL = 0.737 +- 0.290 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.1 all L1 = 0.77 +- 0.216 (in-sample avg dev_std = 0.442)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.49151599999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.868
SUFF_SIMPLE for r=0.2 class 0.0 = 0.883 +- 0.267 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.71 +- 0.267 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.2 all KL = 0.763 +- 0.267 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.2 all L1 = 0.787 +- 0.206 (in-sample avg dev_std = 0.413)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.41751
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.863
SUFF_SIMPLE for r=0.4 class 0.0 = 0.874 +- 0.275 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.709 +- 0.275 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.4 all KL = 0.761 +- 0.275 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.4 all L1 = 0.783 +- 0.215 (in-sample avg dev_std = 0.405)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.36093000000000003
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.862
SUFF_SIMPLE for r=0.8 class 0.0 = 0.871 +- 0.282 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.709 +- 0.282 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.8 all KL = 0.782 +- 0.282 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.8 all L1 = 0.781 +- 0.239 (in-sample avg dev_std = 0.318)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3449662
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.5
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.154 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.838 +- 0.154 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.05 all KL = 0.94 +- 0.154 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.05 all L1 = 0.917 +- 0.184 (in-sample avg dev_std = 0.083)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22476139999999994
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.501
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.151 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.839 +- 0.151 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.1 all KL = 0.941 +- 0.151 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.1 all L1 = 0.918 +- 0.182 (in-sample avg dev_std = 0.088)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459654
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.501
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.150 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.84 +- 0.150 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.2 all KL = 0.941 +- 0.150 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.2 all L1 = 0.918 +- 0.182 (in-sample avg dev_std = 0.090)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10206439999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.501
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.150 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.84 +- 0.150 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.4 all KL = 0.941 +- 0.150 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.4 all L1 = 0.918 +- 0.182 (in-sample avg dev_std = 0.088)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08663779999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.499
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.154 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.838 +- 0.154 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.8 all KL = 0.941 +- 0.154 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.8 all L1 = 0.917 +- 0.185 (in-sample avg dev_std = 0.062)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5557373999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.709
SUFF_SIMPLE for r=0.05 class 0.0 = 0.897 +- 0.326 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.801 +- 0.326 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all KL = 0.808 +- 0.326 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all L1 = 0.85 +- 0.254 (in-sample avg dev_std = 0.340)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5918868
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.711
SUFF_SIMPLE for r=0.1 class 0.0 = 0.902 +- 0.317 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.819 +- 0.317 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.1 all KL = 0.828 +- 0.317 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.1 all L1 = 0.861 +- 0.253 (in-sample avg dev_std = 0.294)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6069532
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.716
SUFF_SIMPLE for r=0.2 class 0.0 = 0.907 +- 0.311 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.828 +- 0.311 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 all KL = 0.842 +- 0.311 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 all L1 = 0.868 +- 0.252 (in-sample avg dev_std = 0.269)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6120368
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.719
SUFF_SIMPLE for r=0.4 class 0.0 = 0.913 +- 0.303 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.837 +- 0.303 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.4 all KL = 0.859 +- 0.303 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.4 all L1 = 0.876 +- 0.253 (in-sample avg dev_std = 0.224)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6086604
len(reference) = 4961
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.741
SUFF_SIMPLE for r=0.8 class 0.0 = 0.927 +- 0.253 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.888 +- 0.253 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 all KL = 0.908 +- 0.253 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 all L1 = 0.908 +- 0.227 (in-sample avg dev_std = 0.089)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5233880000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.635
NEC for r=0.05 class 0.0 = 0.095 +- 0.404 (in-sample avg dev_std = 0.347)
NEC for r=0.05 class 1.0 = 0.652 +- 0.404 (in-sample avg dev_std = 0.347)
NEC for r=0.05 all KL = 0.473 +- 0.404 (in-sample avg dev_std = 0.347)
NEC for r=0.05 all L1 = 0.403 +- 0.326 (in-sample avg dev_std = 0.347)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5450740000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.734
NEC for r=0.1 class 0.0 = 0.087 +- 0.363 (in-sample avg dev_std = 0.450)
NEC for r=0.1 class 1.0 = 0.533 +- 0.363 (in-sample avg dev_std = 0.450)
NEC for r=0.1 all KL = 0.405 +- 0.363 (in-sample avg dev_std = 0.450)
NEC for r=0.1 all L1 = 0.334 +- 0.283 (in-sample avg dev_std = 0.450)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.49151599999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.825
NEC for r=0.2 class 0.0 = 0.076 +- 0.313 (in-sample avg dev_std = 0.472)
NEC for r=0.2 class 1.0 = 0.392 +- 0.313 (in-sample avg dev_std = 0.472)
NEC for r=0.2 all KL = 0.312 +- 0.313 (in-sample avg dev_std = 0.472)
NEC for r=0.2 all L1 = 0.251 +- 0.231 (in-sample avg dev_std = 0.472)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.41751
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.868
NEC for r=0.4 class 0.0 = 0.065 +- 0.273 (in-sample avg dev_std = 0.450)
NEC for r=0.4 class 1.0 = 0.303 +- 0.273 (in-sample avg dev_std = 0.450)
NEC for r=0.4 all KL = 0.247 +- 0.273 (in-sample avg dev_std = 0.450)
NEC for r=0.4 all L1 = 0.196 +- 0.189 (in-sample avg dev_std = 0.450)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.36093000000000003
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.918
NEC for r=0.8 class 0.0 = 0.06 +- 0.215 (in-sample avg dev_std = 0.362)
NEC for r=0.8 class 1.0 = 0.189 +- 0.215 (in-sample avg dev_std = 0.362)
NEC for r=0.8 all KL = 0.157 +- 0.215 (in-sample avg dev_std = 0.362)
NEC for r=0.8 all L1 = 0.132 +- 0.151 (in-sample avg dev_std = 0.362)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3449662
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.169 (in-sample avg dev_std = 0.027)
NEC for r=0.05 class 1.0 = 0.169 +- 0.169 (in-sample avg dev_std = 0.027)
NEC for r=0.05 all KL = 0.065 +- 0.169 (in-sample avg dev_std = 0.027)
NEC for r=0.05 all L1 = 0.086 +- 0.193 (in-sample avg dev_std = 0.027)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22476139999999994
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
NEC for r=0.1 class 0.0 = 0.002 +- 0.164 (in-sample avg dev_std = 0.061)
NEC for r=0.1 class 1.0 = 0.166 +- 0.164 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all KL = 0.064 +- 0.164 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all L1 = 0.085 +- 0.190 (in-sample avg dev_std = 0.061)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459654
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.501
NEC for r=0.2 class 0.0 = 0.002 +- 0.154 (in-sample avg dev_std = 0.097)
NEC for r=0.2 class 1.0 = 0.16 +- 0.154 (in-sample avg dev_std = 0.097)
NEC for r=0.2 all KL = 0.06 +- 0.154 (in-sample avg dev_std = 0.097)
NEC for r=0.2 all L1 = 0.082 +- 0.182 (in-sample avg dev_std = 0.097)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10206439999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.505
NEC for r=0.4 class 0.0 = 0.002 +- 0.139 (in-sample avg dev_std = 0.122)
NEC for r=0.4 class 1.0 = 0.15 +- 0.139 (in-sample avg dev_std = 0.122)
NEC for r=0.4 all KL = 0.054 +- 0.139 (in-sample avg dev_std = 0.122)
NEC for r=0.4 all L1 = 0.076 +- 0.170 (in-sample avg dev_std = 0.122)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08663779999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.508
NEC for r=0.8 class 0.0 = 0.002 +- 0.126 (in-sample avg dev_std = 0.132)
NEC for r=0.8 class 1.0 = 0.14 +- 0.126 (in-sample avg dev_std = 0.132)
NEC for r=0.8 all KL = 0.048 +- 0.126 (in-sample avg dev_std = 0.132)
NEC for r=0.8 all L1 = 0.072 +- 0.160 (in-sample avg dev_std = 0.132)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5557373999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.603
NEC for r=0.05 class 0.0 = 0.282 +- 0.440 (in-sample avg dev_std = 0.504)
NEC for r=0.05 class 1.0 = 0.631 +- 0.440 (in-sample avg dev_std = 0.504)
NEC for r=0.05 all KL = 0.575 +- 0.440 (in-sample avg dev_std = 0.504)
NEC for r=0.05 all L1 = 0.454 +- 0.351 (in-sample avg dev_std = 0.504)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5918868
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.623
NEC for r=0.1 class 0.0 = 0.237 +- 0.414 (in-sample avg dev_std = 0.538)
NEC for r=0.1 class 1.0 = 0.543 +- 0.414 (in-sample avg dev_std = 0.538)
NEC for r=0.1 all KL = 0.52 +- 0.414 (in-sample avg dev_std = 0.538)
NEC for r=0.1 all L1 = 0.388 +- 0.326 (in-sample avg dev_std = 0.538)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6069532
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.66
NEC for r=0.2 class 0.0 = 0.188 +- 0.384 (in-sample avg dev_std = 0.516)
NEC for r=0.2 class 1.0 = 0.423 +- 0.384 (in-sample avg dev_std = 0.516)
NEC for r=0.2 all KL = 0.422 +- 0.384 (in-sample avg dev_std = 0.516)
NEC for r=0.2 all L1 = 0.304 +- 0.298 (in-sample avg dev_std = 0.516)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6120368
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.689
NEC for r=0.4 class 0.0 = 0.144 +- 0.353 (in-sample avg dev_std = 0.476)
NEC for r=0.4 class 1.0 = 0.32 +- 0.353 (in-sample avg dev_std = 0.476)
NEC for r=0.4 all KL = 0.327 +- 0.353 (in-sample avg dev_std = 0.476)
NEC for r=0.4 all L1 = 0.231 +- 0.267 (in-sample avg dev_std = 0.476)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6086604
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.714
NEC for r=0.8 class 0.0 = 0.119 +- 0.319 (in-sample avg dev_std = 0.432)
NEC for r=0.8 class 1.0 = 0.234 +- 0.319 (in-sample avg dev_std = 0.432)
NEC for r=0.8 all KL = 0.25 +- 0.319 (in-sample avg dev_std = 0.432)
NEC for r=0.8 all L1 = 0.176 +- 0.235 (in-sample avg dev_std = 0.432)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:26:04 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 05:26:04 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:04 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:04 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 05:26:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:04 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:26:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mChartInfo 0.9680 0.9680 0.9680 0.9680 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.570
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.615
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.591
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.537
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.487
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.427
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.297
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.204
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.151
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.132
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.577
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.617
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.634
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.638
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.637


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.570182
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.919
SUFF_SIMPLE for r=0.05 class 0.0 = 0.9 +- 0.234 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.88 +- 0.234 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.05 all KL = 0.873 +- 0.234 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.05 all L1 = 0.889 +- 0.179 (in-sample avg dev_std = 0.306)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6153200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.922
SUFF_SIMPLE for r=0.1 class 0.0 = 0.899 +- 0.233 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.885 +- 0.233 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.1 all KL = 0.877 +- 0.233 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.1 all L1 = 0.891 +- 0.179 (in-sample avg dev_std = 0.299)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.591372
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.914
SUFF_SIMPLE for r=0.2 class 0.0 = 0.893 +- 0.244 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.866 +- 0.244 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.2 all KL = 0.858 +- 0.244 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.2 all L1 = 0.878 +- 0.189 (in-sample avg dev_std = 0.311)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537098
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.902
SUFF_SIMPLE for r=0.4 class 0.0 = 0.882 +- 0.259 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.858 +- 0.259 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.4 all KL = 0.853 +- 0.259 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.4 all L1 = 0.869 +- 0.207 (in-sample avg dev_std = 0.308)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.486506
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.881
SUFF_SIMPLE for r=0.8 class 0.0 = 0.884 +- 0.288 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.809 +- 0.288 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.8 all KL = 0.835 +- 0.288 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.8 all L1 = 0.842 +- 0.246 (in-sample avg dev_std = 0.269)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4265934
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.525
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.109 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.884 +- 0.109 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all KL = 0.962 +- 0.109 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all L1 = 0.941 +- 0.146 (in-sample avg dev_std = 0.126)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.296979
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.524
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.111 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.881 +- 0.111 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all KL = 0.96 +- 0.111 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all L1 = 0.94 +- 0.149 (in-sample avg dev_std = 0.123)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.204242
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.522
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.118 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.878 +- 0.118 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 all KL = 0.958 +- 0.118 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 all L1 = 0.938 +- 0.155 (in-sample avg dev_std = 0.121)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1510458
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.517
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.133 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.87 +- 0.133 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.4 all KL = 0.952 +- 0.133 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.4 all L1 = 0.934 +- 0.165 (in-sample avg dev_std = 0.121)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1320686
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.509
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.165 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.855 +- 0.165 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.8 all KL = 0.942 +- 0.165 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.8 all L1 = 0.927 +- 0.185 (in-sample avg dev_std = 0.107)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5766038
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.741
SUFF_SIMPLE for r=0.05 class 0.0 = 0.862 +- 0.321 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.894 +- 0.321 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all KL = 0.841 +- 0.321 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all L1 = 0.878 +- 0.246 (in-sample avg dev_std = 0.323)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6165012
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.737
SUFF_SIMPLE for r=0.1 class 0.0 = 0.86 +- 0.317 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.898 +- 0.317 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.1 all KL = 0.847 +- 0.317 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.1 all L1 = 0.879 +- 0.249 (in-sample avg dev_std = 0.299)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6341762000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.735
SUFF_SIMPLE for r=0.2 class 0.0 = 0.857 +- 0.321 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.896 +- 0.321 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.2 all KL = 0.848 +- 0.321 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.2 all L1 = 0.877 +- 0.259 (in-sample avg dev_std = 0.263)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6379336
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.734
SUFF_SIMPLE for r=0.4 class 0.0 = 0.855 +- 0.327 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.892 +- 0.327 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.4 all KL = 0.845 +- 0.327 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.4 all L1 = 0.873 +- 0.265 (in-sample avg dev_std = 0.258)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6368773999999999
len(reference) = 4936
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.746
SUFF_SIMPLE for r=0.8 class 0.0 = 0.897 +- 0.268 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.916 +- 0.268 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.8 all KL = 0.902 +- 0.268 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.8 all L1 = 0.906 +- 0.240 (in-sample avg dev_std = 0.079)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.570182
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.893
NEC for r=0.05 class 0.0 = 0.086 +- 0.289 (in-sample avg dev_std = 0.321)
NEC for r=0.05 class 1.0 = 0.172 +- 0.289 (in-sample avg dev_std = 0.321)
NEC for r=0.05 all KL = 0.15 +- 0.289 (in-sample avg dev_std = 0.321)
NEC for r=0.05 all L1 = 0.133 +- 0.225 (in-sample avg dev_std = 0.321)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6153200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.923
NEC for r=0.1 class 0.0 = 0.068 +- 0.243 (in-sample avg dev_std = 0.314)
NEC for r=0.1 class 1.0 = 0.12 +- 0.243 (in-sample avg dev_std = 0.314)
NEC for r=0.1 all KL = 0.114 +- 0.243 (in-sample avg dev_std = 0.314)
NEC for r=0.1 all L1 = 0.096 +- 0.174 (in-sample avg dev_std = 0.314)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.591372
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.954
NEC for r=0.2 class 0.0 = 0.049 +- 0.167 (in-sample avg dev_std = 0.233)
NEC for r=0.2 class 1.0 = 0.064 +- 0.167 (in-sample avg dev_std = 0.233)
NEC for r=0.2 all KL = 0.065 +- 0.167 (in-sample avg dev_std = 0.233)
NEC for r=0.2 all L1 = 0.057 +- 0.114 (in-sample avg dev_std = 0.233)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537098
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.955
NEC for r=0.4 class 0.0 = 0.045 +- 0.152 (in-sample avg dev_std = 0.226)
NEC for r=0.4 class 1.0 = 0.055 +- 0.152 (in-sample avg dev_std = 0.226)
NEC for r=0.4 all KL = 0.058 +- 0.152 (in-sample avg dev_std = 0.226)
NEC for r=0.4 all L1 = 0.051 +- 0.104 (in-sample avg dev_std = 0.226)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.486506
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.962
NEC for r=0.8 class 0.0 = 0.048 +- 0.143 (in-sample avg dev_std = 0.189)
NEC for r=0.8 class 1.0 = 0.039 +- 0.143 (in-sample avg dev_std = 0.189)
NEC for r=0.8 all KL = 0.045 +- 0.143 (in-sample avg dev_std = 0.189)
NEC for r=0.8 all L1 = 0.043 +- 0.101 (in-sample avg dev_std = 0.189)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4265934
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.555
NEC for r=0.05 class 0.0 = 0.001 +- 0.162 (in-sample avg dev_std = 0.208)
NEC for r=0.05 class 1.0 = 0.167 +- 0.162 (in-sample avg dev_std = 0.208)
NEC for r=0.05 all KL = 0.071 +- 0.162 (in-sample avg dev_std = 0.208)
NEC for r=0.05 all L1 = 0.085 +- 0.180 (in-sample avg dev_std = 0.208)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.296979
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.578
NEC for r=0.1 class 0.0 = 0.001 +- 0.129 (in-sample avg dev_std = 0.197)
NEC for r=0.1 class 1.0 = 0.143 +- 0.129 (in-sample avg dev_std = 0.197)
NEC for r=0.1 all KL = 0.057 +- 0.129 (in-sample avg dev_std = 0.197)
NEC for r=0.1 all L1 = 0.073 +- 0.154 (in-sample avg dev_std = 0.197)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.204242
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.573
NEC for r=0.2 class 0.0 = 0.001 +- 0.087 (in-sample avg dev_std = 0.169)
NEC for r=0.2 class 1.0 = 0.1 +- 0.087 (in-sample avg dev_std = 0.169)
NEC for r=0.2 all KL = 0.035 +- 0.087 (in-sample avg dev_std = 0.169)
NEC for r=0.2 all L1 = 0.051 +- 0.115 (in-sample avg dev_std = 0.169)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1510458
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.561
NEC for r=0.4 class 0.0 = 0.0 +- 0.057 (in-sample avg dev_std = 0.129)
NEC for r=0.4 class 1.0 = 0.072 +- 0.057 (in-sample avg dev_std = 0.129)
NEC for r=0.4 all KL = 0.02 +- 0.057 (in-sample avg dev_std = 0.129)
NEC for r=0.4 all L1 = 0.036 +- 0.087 (in-sample avg dev_std = 0.129)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1320686
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.55
NEC for r=0.8 class 0.0 = 0.001 +- 0.046 (in-sample avg dev_std = 0.105)
NEC for r=0.8 class 1.0 = 0.069 +- 0.046 (in-sample avg dev_std = 0.105)
NEC for r=0.8 all KL = 0.015 +- 0.046 (in-sample avg dev_std = 0.105)
NEC for r=0.8 all L1 = 0.035 +- 0.086 (in-sample avg dev_std = 0.105)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5766038
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.631
NEC for r=0.05 class 0.0 = 0.222 +- 0.427 (in-sample avg dev_std = 0.564)
NEC for r=0.05 class 1.0 = 0.472 +- 0.427 (in-sample avg dev_std = 0.564)
NEC for r=0.05 all KL = 0.471 +- 0.427 (in-sample avg dev_std = 0.564)
NEC for r=0.05 all L1 = 0.345 +- 0.331 (in-sample avg dev_std = 0.564)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6165012
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.667
NEC for r=0.1 class 0.0 = 0.165 +- 0.391 (in-sample avg dev_std = 0.541)
NEC for r=0.1 class 1.0 = 0.352 +- 0.391 (in-sample avg dev_std = 0.541)
NEC for r=0.1 all KL = 0.373 +- 0.391 (in-sample avg dev_std = 0.541)
NEC for r=0.1 all L1 = 0.257 +- 0.289 (in-sample avg dev_std = 0.541)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6341762000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.697
NEC for r=0.2 class 0.0 = 0.123 +- 0.348 (in-sample avg dev_std = 0.473)
NEC for r=0.2 class 1.0 = 0.245 +- 0.348 (in-sample avg dev_std = 0.473)
NEC for r=0.2 all KL = 0.277 +- 0.348 (in-sample avg dev_std = 0.473)
NEC for r=0.2 all L1 = 0.183 +- 0.246 (in-sample avg dev_std = 0.473)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6379336
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.729
NEC for r=0.4 class 0.0 = 0.11 +- 0.318 (in-sample avg dev_std = 0.393)
NEC for r=0.4 class 1.0 = 0.164 +- 0.318 (in-sample avg dev_std = 0.393)
NEC for r=0.4 all KL = 0.208 +- 0.318 (in-sample avg dev_std = 0.393)
NEC for r=0.4 all L1 = 0.136 +- 0.222 (in-sample avg dev_std = 0.393)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6368773999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.739
NEC for r=0.8 class 0.0 = 0.108 +- 0.309 (in-sample avg dev_std = 0.358)
NEC for r=0.8 class 1.0 = 0.119 +- 0.309 (in-sample avg dev_std = 0.358)
NEC for r=0.8 all KL = 0.173 +- 0.309 (in-sample avg dev_std = 0.358)
NEC for r=0.8 all L1 = 0.113 +- 0.211 (in-sample avg dev_std = 0.358)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.869, 0.869, 0.859, 0.842, 0.825], 'all_L1': [0.86, 0.861, 0.852, 0.836, 0.812]}), defaultdict(<class 'list'>, {'all_KL': [0.742, 0.767, 0.765, 0.766, 0.776], 'all_L1': [0.815, 0.827, 0.825, 0.816, 0.806]}), defaultdict(<class 'list'>, {'all_KL': [0.808, 0.83, 0.84, 0.857, 0.848], 'all_L1': [0.84, 0.849, 0.856, 0.861, 0.849]}), defaultdict(<class 'list'>, {'all_KL': [0.782, 0.825, 0.834, 0.834, 0.831], 'all_L1': [0.823, 0.848, 0.85, 0.846, 0.828]}), defaultdict(<class 'list'>, {'all_KL': [0.76, 0.803, 0.839, 0.847, 0.839], 'all_L1': [0.803, 0.831, 0.851, 0.852, 0.829]}), defaultdict(<class 'list'>, {'all_KL': [0.738, 0.767, 0.796, 0.808, 0.823], 'all_L1': [0.747, 0.769, 0.789, 0.797, 0.791]}), defaultdict(<class 'list'>, {'all_KL': [0.816, 0.855, 0.878, 0.87, 0.841], 'all_L1': [0.836, 0.857, 0.871, 0.865, 0.833]}), defaultdict(<class 'list'>, {'all_KL': [0.802, 0.831, 0.858, 0.858, 0.821], 'all_L1': [0.755, 0.775, 0.792, 0.788, 0.747]}), defaultdict(<class 'list'>, {'all_KL': [0.712, 0.737, 0.763, 0.761, 0.782], 'all_L1': [0.754, 0.77, 0.787, 0.783, 0.781]}), defaultdict(<class 'list'>, {'all_KL': [0.873, 0.877, 0.858, 0.853, 0.835], 'all_L1': [0.889, 0.891, 0.878, 0.869, 0.842]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.121, 0.084, 0.057, 0.046, 0.037], 'all_L1': [0.136, 0.099, 0.072, 0.06, 0.054]}), defaultdict(<class 'list'>, {'all_KL': [0.518, 0.444, 0.337, 0.243, 0.169], 'all_L1': [0.383, 0.297, 0.209, 0.143, 0.103]}), defaultdict(<class 'list'>, {'all_KL': [0.421, 0.344, 0.259, 0.174, 0.108], 'all_L1': [0.326, 0.251, 0.178, 0.12, 0.082]}), defaultdict(<class 'list'>, {'all_KL': [0.502, 0.454, 0.353, 0.249, 0.167], 'all_L1': [0.422, 0.352, 0.249, 0.167, 0.114]}), defaultdict(<class 'list'>, {'all_KL': [0.53, 0.48, 0.394, 0.278, 0.184], 'all_L1': [0.465, 0.389, 0.294, 0.194, 0.126]}), defaultdict(<class 'list'>, {'all_KL': [0.495, 0.432, 0.349, 0.26, 0.159], 'all_L1': [0.453, 0.384, 0.302, 0.227, 0.15]}), defaultdict(<class 'list'>, {'all_KL': [0.506, 0.439, 0.328, 0.238, 0.167], 'all_L1': [0.429, 0.347, 0.245, 0.168, 0.121]}), defaultdict(<class 'list'>, {'all_KL': [0.482, 0.416, 0.307, 0.224, 0.146], 'all_L1': [0.47, 0.397, 0.294, 0.22, 0.155]}), defaultdict(<class 'list'>, {'all_KL': [0.473, 0.405, 0.312, 0.247, 0.157], 'all_L1': [0.403, 0.334, 0.251, 0.196, 0.132]}), defaultdict(<class 'list'>, {'all_KL': [0.15, 0.114, 0.065, 0.058, 0.045], 'all_L1': [0.133, 0.096, 0.057, 0.051, 0.043]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.967, 0.965, 0.963, 0.958, 0.947], 'all_L1': [0.941, 0.939, 0.936, 0.933, 0.925]}), defaultdict(<class 'list'>, {'all_KL': [0.921, 0.923, 0.922, 0.92, 0.916], 'all_L1': [0.914, 0.915, 0.914, 0.913, 0.908]}), defaultdict(<class 'list'>, {'all_KL': [0.947, 0.948, 0.948, 0.947, 0.94], 'all_L1': [0.938, 0.939, 0.939, 0.938, 0.932]}), defaultdict(<class 'list'>, {'all_KL': [0.974, 0.973, 0.972, 0.969, 0.961], 'all_L1': [0.959, 0.958, 0.956, 0.954, 0.949]}), defaultdict(<class 'list'>, {'all_KL': [0.953, 0.952, 0.952, 0.948, 0.937], 'all_L1': [0.929, 0.928, 0.927, 0.925, 0.917]}), defaultdict(<class 'list'>, {'all_KL': [0.975, 0.975, 0.976, 0.975, 0.973], 'all_L1': [0.958, 0.958, 0.959, 0.958, 0.957]}), defaultdict(<class 'list'>, {'all_KL': [0.975, 0.974, 0.973, 0.973, 0.967], 'all_L1': [0.961, 0.96, 0.96, 0.96, 0.956]}), defaultdict(<class 'list'>, {'all_KL': [0.963, 0.962, 0.962, 0.961, 0.958], 'all_L1': [0.928, 0.928, 0.928, 0.927, 0.925]}), defaultdict(<class 'list'>, {'all_KL': [0.94, 0.941, 0.941, 0.941, 0.941], 'all_L1': [0.917, 0.918, 0.918, 0.918, 0.917]}), defaultdict(<class 'list'>, {'all_KL': [0.962, 0.96, 0.958, 0.952, 0.942], 'all_L1': [0.941, 0.94, 0.938, 0.934, 0.927]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.042, 0.027, 0.018, 0.013, 0.012], 'all_L1': [0.064, 0.05, 0.036, 0.029, 0.032]}), defaultdict(<class 'list'>, {'all_KL': [0.091, 0.086, 0.077, 0.063, 0.055], 'all_L1': [0.096, 0.09, 0.081, 0.072, 0.067]}), defaultdict(<class 'list'>, {'all_KL': [0.073, 0.065, 0.053, 0.045, 0.037], 'all_L1': [0.078, 0.07, 0.059, 0.053, 0.047]}), defaultdict(<class 'list'>, {'all_KL': [0.046, 0.039, 0.03, 0.021, 0.016], 'all_L1': [0.055, 0.048, 0.037, 0.03, 0.028]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.062, 0.049, 0.036, 0.028], 'all_L1': [0.088, 0.077, 0.064, 0.053, 0.048]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.029, 0.025, 0.022, 0.018], 'all_L1': [0.045, 0.043, 0.041, 0.037, 0.034]}), defaultdict(<class 'list'>, {'all_KL': [0.035, 0.029, 0.023, 0.017, 0.015], 'all_L1': [0.045, 0.039, 0.033, 0.03, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.05, 0.038, 0.028, 0.022], 'all_L1': [0.084, 0.076, 0.066, 0.057, 0.053]}), defaultdict(<class 'list'>, {'all_KL': [0.065, 0.064, 0.06, 0.054, 0.048], 'all_L1': [0.086, 0.085, 0.082, 0.076, 0.072]}), defaultdict(<class 'list'>, {'all_KL': [0.071, 0.057, 0.035, 0.02, 0.015], 'all_L1': [0.085, 0.073, 0.051, 0.036, 0.035]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.836, 0.838, 0.853, 0.866, 0.9], 'all_L1': [0.866, 0.865, 0.875, 0.878, 0.896]}), defaultdict(<class 'list'>, {'all_KL': [0.765, 0.793, 0.823, 0.839, 0.89], 'all_L1': [0.852, 0.865, 0.876, 0.879, 0.901]}), defaultdict(<class 'list'>, {'all_KL': [0.85, 0.863, 0.869, 0.875, 0.902], 'all_L1': [0.871, 0.879, 0.882, 0.886, 0.9]}), defaultdict(<class 'list'>, {'all_KL': [0.788, 0.809, 0.84, 0.846, 0.868], 'all_L1': [0.843, 0.856, 0.874, 0.875, 0.883]}), defaultdict(<class 'list'>, {'all_KL': [0.793, 0.829, 0.87, 0.883, 0.902], 'all_L1': [0.843, 0.862, 0.885, 0.892, 0.899]}), defaultdict(<class 'list'>, {'all_KL': [0.852, 0.865, 0.892, 0.904, 0.916], 'all_L1': [0.878, 0.886, 0.898, 0.904, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.864, 0.881, 0.882, 0.883, 0.903], 'all_L1': [0.877, 0.889, 0.891, 0.891, 0.903]}), defaultdict(<class 'list'>, {'all_KL': [0.871, 0.886, 0.891, 0.89, 0.908], 'all_L1': [0.862, 0.871, 0.875, 0.875, 0.886]}), defaultdict(<class 'list'>, {'all_KL': [0.808, 0.828, 0.842, 0.859, 0.908], 'all_L1': [0.85, 0.861, 0.868, 0.876, 0.908]}), defaultdict(<class 'list'>, {'all_KL': [0.841, 0.847, 0.848, 0.845, 0.902], 'all_L1': [0.878, 0.879, 0.877, 0.873, 0.906]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.375, 0.275, 0.195, 0.146, 0.139], 'all_L1': [0.334, 0.242, 0.172, 0.126, 0.114]}), defaultdict(<class 'list'>, {'all_KL': [0.59, 0.534, 0.453, 0.366, 0.291], 'all_L1': [0.426, 0.356, 0.286, 0.216, 0.165]}), defaultdict(<class 'list'>, {'all_KL': [0.539, 0.462, 0.37, 0.281, 0.215], 'all_L1': [0.427, 0.346, 0.268, 0.201, 0.153]}), defaultdict(<class 'list'>, {'all_KL': [0.581, 0.536, 0.457, 0.357, 0.287], 'all_L1': [0.487, 0.428, 0.344, 0.251, 0.194]}), defaultdict(<class 'list'>, {'all_KL': [0.568, 0.525, 0.458, 0.374, 0.307], 'all_L1': [0.495, 0.437, 0.356, 0.267, 0.204]}), defaultdict(<class 'list'>, {'all_KL': [0.559, 0.514, 0.422, 0.32, 0.24], 'all_L1': [0.494, 0.438, 0.344, 0.251, 0.181]}), defaultdict(<class 'list'>, {'all_KL': [0.603, 0.552, 0.454, 0.344, 0.263], 'all_L1': [0.502, 0.43, 0.334, 0.244, 0.185]}), defaultdict(<class 'list'>, {'all_KL': [0.442, 0.401, 0.349, 0.29, 0.215], 'all_L1': [0.447, 0.398, 0.334, 0.269, 0.197]}), defaultdict(<class 'list'>, {'all_KL': [0.575, 0.52, 0.422, 0.327, 0.25], 'all_L1': [0.454, 0.388, 0.304, 0.231, 0.176]}), defaultdict(<class 'list'>, {'all_KL': [0.471, 0.373, 0.277, 0.208, 0.173], 'all_L1': [0.345, 0.257, 0.183, 0.136, 0.113]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.812 +- 0.045, 0.828 +- 0.041, 0.835 +- 0.033, 0.831 +- 0.031, 0.812 +- 0.030
suff_simple class all_KL  =  0.790 +- 0.051, 0.816 +- 0.044, 0.829 +- 0.038, 0.830 +- 0.037, 0.822 +- 0.023
[[0.9072499871253967, 0.9017500281333923, 0.8957499861717224, 0.887499988079071, 0.8587499856948853], [0.8855000138282776, 0.8942499756813049, 0.890999972820282, 0.8832499980926514, 0.8665000200271606], [0.890250027179718, 0.8892499804496765, 0.8960000276565552, 0.9054999947547913, 0.8887500166893005], [0.8725000023841858, 0.8922500014305115, 0.8899999856948853, 0.8897500038146973, 0.8687499761581421], [0.8687499761581421, 0.8934999704360962, 0.9104999899864197, 0.9127500057220459, 0.8832499980926514], [0.8140000104904175, 0.8360000252723694, 0.8489999771118164, 0.8615000247955322, 0.8460000157356262], [0.8769999742507935, 0.8995000123977661, 0.909250020980835, 0.9022499918937683, 0.8662499785423279], [0.8067499995231628, 0.8227499723434448, 0.8395000100135803, 0.8379999995231628, 0.8057500123977661], [0.840749979019165, 0.8532500267028809, 0.8679999709129333, 0.8634999990463257, 0.8615000247955322], [0.9194999933242798, 0.922249972820282, 0.9142500162124634, 0.9017500281333923, 0.8807500004768372]]
[[0.869, 0.869, 0.859, 0.842, 0.825], [0.742, 0.767, 0.765, 0.766, 0.776], [0.808, 0.83, 0.84, 0.857, 0.848], [0.782, 0.825, 0.834, 0.834, 0.831], [0.76, 0.803, 0.839, 0.847, 0.839], [0.738, 0.767, 0.796, 0.808, 0.823], [0.816, 0.855, 0.878, 0.87, 0.841], [0.802, 0.831, 0.858, 0.858, 0.821], [0.712, 0.737, 0.763, 0.761, 0.782], [0.873, 0.877, 0.858, 0.853, 0.835]]
suff_simple_acc_int  =  0.868 +- 0.035, 0.880 +- 0.030, 0.886 +- 0.025, 0.885 +- 0.022, 0.863 +- 0.022
nec class all_L1  =  0.362 +- 0.121, 0.295 +- 0.107, 0.215 +- 0.084, 0.155 +- 0.058, 0.108 +- 0.036
nec class all_KL  =  0.420 +- 0.145, 0.361 +- 0.136, 0.276 +- 0.113, 0.202 +- 0.079, 0.134 +- 0.050
[[0.9212499856948853, 0.9447500109672546, 0.9524999856948853, 0.9589999914169312, 0.9557499885559082], [0.6677500009536743, 0.7742499709129333, 0.8552500009536743, 0.9022499918937683, 0.9330000281333923], [0.7129999995231628, 0.7929999828338623, 0.8617500066757202, 0.9117500185966492, 0.9437500238418579], [0.5802500247955322, 0.6912500262260437, 0.8009999990463257, 0.8694999814033508, 0.9097499847412109], [0.5109999775886536, 0.6387500166893005, 0.7580000162124634, 0.856249988079071, 0.9110000133514404], [0.5554999709129333, 0.6607499718666077, 0.7574999928474426, 0.831250011920929, 0.8870000243186951], [0.5367500185966492, 0.6654999852180481, 0.7789999842643738, 0.8604999780654907, 0.9022499918937683], [0.515250027179718, 0.6262500286102295, 0.7317500114440918, 0.8105000257492065, 0.8607500195503235], [0.6349999904632568, 0.7335000038146973, 0.824999988079071, 0.8679999709129333, 0.9177500009536743], [0.8930000066757202, 0.9229999780654907, 0.9537500143051147, 0.9552500247955322, 0.9624999761581421]]
[[0.121, 0.084, 0.057, 0.046, 0.037], [0.518, 0.444, 0.337, 0.243, 0.169], [0.421, 0.344, 0.259, 0.174, 0.108], [0.502, 0.454, 0.353, 0.249, 0.167], [0.53, 0.48, 0.394, 0.278, 0.184], [0.495, 0.432, 0.349, 0.26, 0.159], [0.506, 0.439, 0.328, 0.238, 0.167], [0.482, 0.416, 0.307, 0.224, 0.146], [0.473, 0.405, 0.312, 0.247, 0.157], [0.15, 0.114, 0.065, 0.058, 0.045]]
nec_acc_int  =  0.653 +- 0.142, 0.745 +- 0.108, 0.828 +- 0.074, 0.882 +- 0.047, 0.918 +- 0.030

Eval split val
suff_simple class all_L1  =  0.939 +- 0.016, 0.938 +- 0.016, 0.938 +- 0.016, 0.936 +- 0.016, 0.931 +- 0.016
suff_simple class all_KL  =  0.958 +- 0.017, 0.957 +- 0.016, 0.957 +- 0.016, 0.954 +- 0.016, 0.948 +- 0.016
[[0.514549970626831, 0.5128750205039978, 0.5107250213623047, 0.5078499913215637, 0.5013750195503235], [0.5237249732017517, 0.5237500071525574, 0.5208250284194946, 0.5180749893188477, 0.5083749890327454], [0.526199996471405, 0.527999997138977, 0.5252000093460083, 0.5248249769210815, 0.5149750113487244], [0.5128250122070312, 0.51214998960495, 0.5108500123023987, 0.508525013923645, 0.5015749931335449], [0.5168499946594238, 0.5165249705314636, 0.515375018119812, 0.5131000280380249, 0.5049499869346619], [0.4976249933242798, 0.4977250099182129, 0.4978249967098236, 0.49777498841285706, 0.49697500467300415], [0.5022000074386597, 0.5015249848365784, 0.5015249848365784, 0.5012999773025513, 0.49802500009536743], [0.5013999938964844, 0.5012999773025513, 0.5013999938964844, 0.5009250044822693, 0.5000500082969666], [0.500249981880188, 0.5008749961853027, 0.5008500218391418, 0.5008500218391418, 0.49869999289512634], [0.5252000093460083, 0.5237500071525574, 0.5216249823570251, 0.5174750089645386, 0.5091000199317932]]
[[0.967, 0.965, 0.963, 0.958, 0.947], [0.921, 0.923, 0.922, 0.92, 0.916], [0.947, 0.948, 0.948, 0.947, 0.94], [0.974, 0.973, 0.972, 0.969, 0.961], [0.953, 0.952, 0.952, 0.948, 0.937], [0.975, 0.975, 0.976, 0.975, 0.973], [0.975, 0.974, 0.973, 0.973, 0.967], [0.963, 0.962, 0.962, 0.961, 0.958], [0.94, 0.941, 0.941, 0.941, 0.941], [0.962, 0.96, 0.958, 0.952, 0.942]]
suff_simple_acc_int  =  0.512 +- 0.010, 0.512 +- 0.011, 0.511 +- 0.009, 0.509 +- 0.009, 0.503 +- 0.006
nec class all_L1  =  0.073 +- 0.018, 0.065 +- 0.017, 0.055 +- 0.017, 0.047 +- 0.017, 0.045 +- 0.015
nec class all_KL  =  0.058 +- 0.018, 0.051 +- 0.019, 0.041 +- 0.018, 0.032 +- 0.016, 0.027 +- 0.014
[[0.5174750089645386, 0.534375011920929, 0.5390999913215637, 0.5372750163078308, 0.5332249999046326], [0.503600001335144, 0.5163750052452087, 0.5302000045776367, 0.5396749973297119, 0.5417249798774719], [0.5043749809265137, 0.5189999938011169, 0.5314249992370605, 0.5364750027656555, 0.5396999716758728], [0.4985249936580658, 0.5081750154495239, 0.5171499848365784, 0.5220500230789185, 0.5229250192642212], [0.4993250072002411, 0.5128499865531921, 0.5228250026702881, 0.5312250256538391, 0.5327500104904175], [0.49619999527931213, 0.4972749948501587, 0.498324990272522, 0.49985000491142273, 0.5010250210762024], [0.49767500162124634, 0.5035499930381775, 0.5073000192642212, 0.5097500085830688, 0.510574996471405], [0.49779999256134033, 0.5009499788284302, 0.5055249929428101, 0.5092250108718872, 0.510325014591217], [0.49617499113082886, 0.49767500162124634, 0.5009499788284302, 0.5053750276565552, 0.5082499980926514], [0.5548499822616577, 0.5781499743461609, 0.572700023651123, 0.5607249736785889, 0.5497999787330627]]
[[0.042, 0.027, 0.018, 0.013, 0.012], [0.091, 0.086, 0.077, 0.063, 0.055], [0.073, 0.065, 0.053, 0.045, 0.037], [0.046, 0.039, 0.03, 0.021, 0.016], [0.072, 0.062, 0.049, 0.036, 0.028], [0.031, 0.029, 0.025, 0.022, 0.018], [0.035, 0.029, 0.023, 0.017, 0.015], [0.058, 0.05, 0.038, 0.028, 0.022], [0.065, 0.064, 0.06, 0.054, 0.048], [0.071, 0.057, 0.035, 0.02, 0.015]]
nec_acc_int  =  0.507 +- 0.017, 0.517 +- 0.023, 0.523 +- 0.021, 0.525 +- 0.018, 0.525 +- 0.016

Eval split test
suff_simple class all_L1  =  0.862 +- 0.013, 0.871 +- 0.011, 0.880 +- 0.009, 0.883 +- 0.010, 0.899 +- 0.008
suff_simple class all_KL  =  0.827 +- 0.034, 0.844 +- 0.029, 0.861 +- 0.022, 0.869 +- 0.021, 0.900 +- 0.012
[[0.7349409461021423, 0.7344656586647034, 0.7373673915863037, 0.7352661490440369, 0.7297974824905396], [0.7068741321563721, 0.711426854133606, 0.7104262709617615, 0.7071242928504944, 0.7182715535163879], [0.72551029920578, 0.7303882241249084, 0.7335901260375977, 0.7365919351577759, 0.7359409332275391], [0.6995697617530823, 0.7048228979110718, 0.7020462155342102, 0.701295793056488, 0.702866792678833], [0.7051730751991272, 0.7143786549568176, 0.7130778431892395, 0.7149789929389954, 0.71098792552948], [0.702246367931366, 0.7061737179756165, 0.7110015749931335, 0.7135531306266785, 0.7073898315429688], [0.715879499912262, 0.7256103754043579, 0.7290874719619751, 0.7343906164169312, 0.7278763055801392], [0.6224985122680664, 0.6284520626068115, 0.6317290663719177, 0.6338303089141846, 0.6390742063522339], [0.7093505859375, 0.7114018201828003, 0.7157294154167175, 0.718806266784668, 0.740626871585846], [0.741019606590271, 0.7372173070907593, 0.7345907688140869, 0.7342405319213867, 0.7459987998008728]]
[[0.836, 0.838, 0.853, 0.866, 0.9], [0.765, 0.793, 0.823, 0.839, 0.89], [0.85, 0.863, 0.869, 0.875, 0.902], [0.788, 0.809, 0.84, 0.846, 0.868], [0.793, 0.829, 0.87, 0.883, 0.902], [0.852, 0.865, 0.892, 0.904, 0.916], [0.864, 0.881, 0.882, 0.883, 0.903], [0.871, 0.886, 0.891, 0.89, 0.908], [0.808, 0.828, 0.842, 0.859, 0.908], [0.841, 0.847, 0.848, 0.845, 0.902]]
suff_simple_acc_int  =  0.706 +- 0.031, 0.710 +- 0.030, 0.712 +- 0.029, 0.713 +- 0.029, 0.716 +- 0.029
nec class all_L1  =  0.441 +- 0.057, 0.372 +- 0.069, 0.292 +- 0.063, 0.219 +- 0.048, 0.168 +- 0.031
nec class all_KL  =  0.530 +- 0.072, 0.469 +- 0.087, 0.386 +- 0.085, 0.301 +- 0.070, 0.238 +- 0.051
[[0.6418851017951965, 0.6853612065315247, 0.7111517190933228, 0.7410696148872375, 0.7409195303916931], [0.6433610320091248, 0.6670752167701721, 0.6806083917617798, 0.7017210125923157, 0.7132028937339783], [0.6377326250076294, 0.675955593585968, 0.6956924200057983, 0.7134780883789062, 0.7317140102386475], [0.5595357418060303, 0.5907044410705566, 0.6277016401290894, 0.6680008172988892, 0.6897638440132141], [0.5561086535453796, 0.5901290774345398, 0.6276766061782837, 0.6645987629890442, 0.6910145878791809], [0.5732939839363098, 0.597008228302002, 0.6244996786117554, 0.6661496758460999, 0.6906644105911255], [0.5520312190055847, 0.5889283418655396, 0.630203127861023, 0.6728537082672119, 0.7030718326568604], [0.5440264344215393, 0.5579847693443298, 0.5754702687263489, 0.5931808948516846, 0.605713427066803], [0.6031368970870972, 0.6232239603996277, 0.6603962182998657, 0.6887632608413696, 0.7142285108566284], [0.6312787532806396, 0.6667500734329224, 0.6974184513092041, 0.7288623452186584, 0.7394686937332153]]
[[0.375, 0.275, 0.195, 0.146, 0.139], [0.59, 0.534, 0.453, 0.366, 0.291], [0.539, 0.462, 0.37, 0.281, 0.215], [0.581, 0.536, 0.457, 0.357, 0.287], [0.568, 0.525, 0.458, 0.374, 0.307], [0.559, 0.514, 0.422, 0.32, 0.24], [0.603, 0.552, 0.454, 0.344, 0.263], [0.442, 0.401, 0.349, 0.29, 0.215], [0.575, 0.52, 0.422, 0.327, 0.25], [0.471, 0.373, 0.277, 0.208, 0.173]]
nec_acc_int  =  0.594 +- 0.039, 0.624 +- 0.043, 0.653 +- 0.041, 0.684 +- 0.040, 0.702 +- 0.037


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.587 +- 0.045, 0.561 +- 0.042, 0.525 +- 0.035, 0.493 +- 0.023, 0.460 +- 0.014
Faith. Armon (L1)= 		  =  0.484 +- 0.130, 0.420 +- 0.129, 0.332 +- 0.114, 0.255 +- 0.086, 0.188 +- 0.057
Faith. GMean (L1)= 	  =  0.530 +- 0.097, 0.481 +- 0.099, 0.411 +- 0.093, 0.349 +- 0.073, 0.291 +- 0.051
Faith. Aritm (KL)= 		  =  0.605 +- 0.054, 0.589 +- 0.057, 0.553 +- 0.052, 0.516 +- 0.038, 0.478 +- 0.025
Faith. Armon (KL)= 		  =  0.526 +- 0.148, 0.480 +- 0.155, 0.398 +- 0.146, 0.315 +- 0.113, 0.226 +- 0.079
Faith. GMean (KL)= 	  =  0.560 +- 0.110, 0.526 +- 0.120, 0.461 +- 0.120, 0.396 +- 0.097, 0.323 +- 0.073

Eval split val
Faith. Aritm (L1)= 		  =  0.506 +- 0.003, 0.502 +- 0.003, 0.496 +- 0.004, 0.492 +- 0.005, 0.488 +- 0.005
Faith. Armon (L1)= 		  =  0.134 +- 0.031, 0.121 +- 0.031, 0.103 +- 0.031, 0.090 +- 0.030, 0.084 +- 0.027
Faith. GMean (L1)= 	  =  0.259 +- 0.032, 0.245 +- 0.032, 0.224 +- 0.034, 0.207 +- 0.035, 0.201 +- 0.032
Faith. Aritm (KL)= 		  =  0.508 +- 0.004, 0.504 +- 0.003, 0.499 +- 0.003, 0.493 +- 0.004, 0.487 +- 0.006
Faith. Armon (KL)= 		  =  0.109 +- 0.033, 0.096 +- 0.033, 0.078 +- 0.032, 0.061 +- 0.030, 0.051 +- 0.027
Faith. GMean (KL)= 	  =  0.233 +- 0.036, 0.216 +- 0.039, 0.193 +- 0.041, 0.169 +- 0.041, 0.153 +- 0.039

Eval split test
Faith. Aritm (L1)= 		  =  0.652 +- 0.027, 0.622 +- 0.035, 0.586 +- 0.033, 0.551 +- 0.026, 0.534 +- 0.015
Faith. Armon (L1)= 		  =  0.581 +- 0.052, 0.517 +- 0.071, 0.435 +- 0.076, 0.348 +- 0.065, 0.282 +- 0.045
Faith. GMean (L1)= 	  =  0.615 +- 0.040, 0.567 +- 0.055, 0.504 +- 0.060, 0.437 +- 0.053, 0.387 +- 0.037
Faith. Aritm (KL)= 		  =  0.679 +- 0.032, 0.657 +- 0.043, 0.623 +- 0.044, 0.585 +- 0.037, 0.569 +- 0.024
Faith. Armon (KL)= 		  =  0.642 +- 0.054, 0.597 +- 0.077, 0.527 +- 0.088, 0.443 +- 0.083, 0.373 +- 0.065
Faith. GMean (KL)= 	  =  0.660 +- 0.043, 0.626 +- 0.061, 0.572 +- 0.069, 0.508 +- 0.065, 0.460 +- 0.051
Computed for split load_split = id



Completed in  3:04:56.109707  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN plain TopoFeature/basis/no_shift NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:44:53 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 05:44:53 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 05:44:53 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:44:53 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 05:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:44:53 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:44:53 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.9868
Train Loss: 0.0344
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0199
ID Test ACCURACY: 0.9860
ID Test Loss: 0.0461
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0199
OOD Test ACCURACY: 0.9860
OOD Test Loss: 0.0461

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.9868
Train Loss: 0.0344
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0199
ID Test ACCURACY: 0.9860
ID Test Loss: 0.0461
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0199
OOD Test ACCURACY: 0.9860
OOD Test Loss: 0.0461

[0m[1;37mINFO[0m: [1mChartInfo 0.9860 0.9860 0.9860 0.9860 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.377
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.358
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.256
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.168
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.114
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.259
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.146
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.078
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.041
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.023
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.261
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.199
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.143
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.108
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.098


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.37670399999999993
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.688
SUFF_SIMPLE for r=0.05 class 0.0 = 0.583 +- 0.426 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.713 +- 0.426 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.05 all KL = 0.531 +- 0.426 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.05 all L1 = 0.655 +- 0.329 (in-sample avg dev_std = 0.457)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35792399999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.676
SUFF_SIMPLE for r=0.1 class 0.0 = 0.579 +- 0.430 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.704 +- 0.430 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.1 all KL = 0.528 +- 0.430 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.1 all L1 = 0.649 +- 0.336 (in-sample avg dev_std = 0.442)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.255554
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.67
SUFF_SIMPLE for r=0.2 class 0.0 = 0.586 +- 0.425 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.694 +- 0.425 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.2 all KL = 0.519 +- 0.425 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.2 all L1 = 0.646 +- 0.332 (in-sample avg dev_std = 0.448)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.167592
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.676
SUFF_SIMPLE for r=0.4 class 0.0 = 0.599 +- 0.427 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.666 +- 0.427 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.4 all KL = 0.5 +- 0.427 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.4 all L1 = 0.636 +- 0.328 (in-sample avg dev_std = 0.467)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11382400000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.65
SUFF_SIMPLE for r=0.8 class 0.0 = 0.707 +- 0.445 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.6 +- 0.445 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.8 all KL = 0.533 +- 0.445 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.8 all L1 = 0.648 +- 0.351 (in-sample avg dev_std = 0.357)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.849
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2589384
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.535
SUFF_SIMPLE for r=0.05 class 0.0 = 0.331 +- 0.380 (in-sample avg dev_std = 0.481)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.497 +- 0.380 (in-sample avg dev_std = 0.481)
SUFF_SIMPLE for r=0.05 all KL = 0.225 +- 0.380 (in-sample avg dev_std = 0.481)
SUFF_SIMPLE for r=0.05 all L1 = 0.415 +- 0.336 (in-sample avg dev_std = 0.481)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.849
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.14558780000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.525
SUFF_SIMPLE for r=0.1 class 0.0 = 0.327 +- 0.378 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.484 +- 0.378 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.1 all KL = 0.22 +- 0.378 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.1 all L1 = 0.407 +- 0.334 (in-sample avg dev_std = 0.477)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.849
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0780266
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.505
SUFF_SIMPLE for r=0.2 class 0.0 = 0.321 +- 0.359 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.45 +- 0.359 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 all KL = 0.194 +- 0.359 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 all L1 = 0.386 +- 0.321 (in-sample avg dev_std = 0.493)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.849
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.041049199999999994
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.314 +- 0.322 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.35 +- 0.322 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.4 all KL = 0.146 +- 0.322 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.4 all L1 = 0.332 +- 0.289 (in-sample avg dev_std = 0.505)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.849
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.023097000000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.392
SUFF_SIMPLE for r=0.8 class 0.0 = 0.332 +- 0.350 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.296 +- 0.350 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.8 all KL = 0.172 +- 0.350 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.8 all L1 = 0.314 +- 0.312 (in-sample avg dev_std = 0.272)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.652
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2607398
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.558
SUFF_SIMPLE for r=0.05 class 0.0 = 0.784 +- 0.384 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.656 +- 0.384 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.05 all KL = 0.692 +- 0.384 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.05 all L1 = 0.721 +- 0.319 (in-sample avg dev_std = 0.251)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.652
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1991426
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.56
SUFF_SIMPLE for r=0.1 class 0.0 = 0.786 +- 0.386 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.657 +- 0.386 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.1 all KL = 0.692 +- 0.386 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.1 all L1 = 0.722 +- 0.322 (in-sample avg dev_std = 0.233)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.652
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1432844
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.554
SUFF_SIMPLE for r=0.2 class 0.0 = 0.791 +- 0.384 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.662 +- 0.384 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.2 all KL = 0.698 +- 0.384 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.2 all L1 = 0.727 +- 0.321 (in-sample avg dev_std = 0.230)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.652
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10787739999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.561
SUFF_SIMPLE for r=0.4 class 0.0 = 0.816 +- 0.376 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.664 +- 0.376 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.4 all KL = 0.719 +- 0.376 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.4 all L1 = 0.741 +- 0.318 (in-sample avg dev_std = 0.223)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.652
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0978094
len(reference) = 4963
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.587
SUFF_SIMPLE for r=0.8 class 0.0 = 0.886 +- 0.324 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.768 +- 0.324 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.8 all KL = 0.828 +- 0.324 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.8 all L1 = 0.827 +- 0.285 (in-sample avg dev_std = 0.012)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.37670399999999993
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.672
NEC for r=0.05 class 0.0 = 0.129 +- 0.460 (in-sample avg dev_std = 0.221)
NEC for r=0.05 class 1.0 = 0.459 +- 0.460 (in-sample avg dev_std = 0.221)
NEC for r=0.05 all KL = 0.372 +- 0.460 (in-sample avg dev_std = 0.221)
NEC for r=0.05 all L1 = 0.312 +- 0.379 (in-sample avg dev_std = 0.221)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35792399999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.75
NEC for r=0.1 class 0.0 = 0.207 +- 0.423 (in-sample avg dev_std = 0.364)
NEC for r=0.1 class 1.0 = 0.311 +- 0.423 (in-sample avg dev_std = 0.364)
NEC for r=0.1 all KL = 0.367 +- 0.423 (in-sample avg dev_std = 0.364)
NEC for r=0.1 all L1 = 0.265 +- 0.319 (in-sample avg dev_std = 0.364)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.255554
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.823
NEC for r=0.2 class 0.0 = 0.28 +- 0.392 (in-sample avg dev_std = 0.402)
NEC for r=0.2 class 1.0 = 0.149 +- 0.392 (in-sample avg dev_std = 0.402)
NEC for r=0.2 all KL = 0.294 +- 0.392 (in-sample avg dev_std = 0.402)
NEC for r=0.2 all L1 = 0.208 +- 0.279 (in-sample avg dev_std = 0.402)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.167592
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.851
NEC for r=0.4 class 0.0 = 0.288 +- 0.369 (in-sample avg dev_std = 0.378)
NEC for r=0.4 class 1.0 = 0.1 +- 0.369 (in-sample avg dev_std = 0.378)
NEC for r=0.4 all KL = 0.248 +- 0.369 (in-sample avg dev_std = 0.378)
NEC for r=0.4 all L1 = 0.184 +- 0.268 (in-sample avg dev_std = 0.378)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11382400000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.877
NEC for r=0.8 class 0.0 = 0.263 +- 0.344 (in-sample avg dev_std = 0.364)
NEC for r=0.8 class 1.0 = 0.082 +- 0.344 (in-sample avg dev_std = 0.364)
NEC for r=0.8 all KL = 0.223 +- 0.344 (in-sample avg dev_std = 0.364)
NEC for r=0.8 all L1 = 0.163 +- 0.248 (in-sample avg dev_std = 0.364)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.849
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2589384
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.443
NEC for r=0.05 class 0.0 = 0.245 +- 0.474 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.811 +- 0.474 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.609 +- 0.474 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.53 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.849
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.14558780000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.626
NEC for r=0.1 class 0.0 = 0.256 +- 0.459 (in-sample avg dev_std = 0.454)
NEC for r=0.1 class 1.0 = 0.504 +- 0.459 (in-sample avg dev_std = 0.454)
NEC for r=0.1 all KL = 0.548 +- 0.459 (in-sample avg dev_std = 0.454)
NEC for r=0.1 all L1 = 0.381 +- 0.359 (in-sample avg dev_std = 0.454)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.849
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0780266
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.775
NEC for r=0.2 class 0.0 = 0.395 +- 0.436 (in-sample avg dev_std = 0.499)
NEC for r=0.2 class 1.0 = 0.075 +- 0.436 (in-sample avg dev_std = 0.499)
NEC for r=0.2 all KL = 0.416 +- 0.436 (in-sample avg dev_std = 0.499)
NEC for r=0.2 all L1 = 0.234 +- 0.278 (in-sample avg dev_std = 0.499)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.849
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.041049199999999994
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.73
NEC for r=0.4 class 0.0 = 0.471 +- 0.444 (in-sample avg dev_std = 0.448)
NEC for r=0.4 class 1.0 = 0.028 +- 0.444 (in-sample avg dev_std = 0.448)
NEC for r=0.4 all KL = 0.351 +- 0.444 (in-sample avg dev_std = 0.448)
NEC for r=0.4 all L1 = 0.248 +- 0.324 (in-sample avg dev_std = 0.448)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.849
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.023097000000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.758
NEC for r=0.8 class 0.0 = 0.503 +- 0.458 (in-sample avg dev_std = 0.469)
NEC for r=0.8 class 1.0 = 0.045 +- 0.458 (in-sample avg dev_std = 0.469)
NEC for r=0.8 all KL = 0.391 +- 0.458 (in-sample avg dev_std = 0.469)
NEC for r=0.8 all L1 = 0.272 +- 0.334 (in-sample avg dev_std = 0.469)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.652
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2607398
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.589
NEC for r=0.05 class 0.0 = 0.066 +- 0.269 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.183 +- 0.269 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.109 +- 0.269 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.124 +- 0.251 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.652
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1991426
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.559
NEC for r=0.1 class 0.0 = 0.08 +- 0.307 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.225 +- 0.307 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.14 +- 0.307 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.152 +- 0.278 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.652
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1432844
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.567
NEC for r=0.2 class 0.0 = 0.095 +- 0.306 (in-sample avg dev_std = 0.130)
NEC for r=0.2 class 1.0 = 0.233 +- 0.306 (in-sample avg dev_std = 0.130)
NEC for r=0.2 all KL = 0.152 +- 0.306 (in-sample avg dev_std = 0.130)
NEC for r=0.2 all L1 = 0.163 +- 0.279 (in-sample avg dev_std = 0.130)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.652
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10787739999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.624
NEC for r=0.4 class 0.0 = 0.126 +- 0.287 (in-sample avg dev_std = 0.217)
NEC for r=0.4 class 1.0 = 0.19 +- 0.287 (in-sample avg dev_std = 0.217)
NEC for r=0.4 all KL = 0.154 +- 0.287 (in-sample avg dev_std = 0.217)
NEC for r=0.4 all L1 = 0.158 +- 0.253 (in-sample avg dev_std = 0.217)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.652
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0978094
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.631
NEC for r=0.8 class 0.0 = 0.146 +- 0.274 (in-sample avg dev_std = 0.212)
NEC for r=0.8 class 1.0 = 0.182 +- 0.274 (in-sample avg dev_std = 0.212)
NEC for r=0.8 all KL = 0.158 +- 0.274 (in-sample avg dev_std = 0.212)
NEC for r=0.8 all L1 = 0.163 +- 0.245 (in-sample avg dev_std = 0.212)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:03:07 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 06:03:07 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 06:03:07 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:03:07 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 06:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:03:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:03:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 89 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9952
Train Loss: 0.0252
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0215
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0308
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0215
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0308

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 89...
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9952
Train Loss: 0.0252
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0215
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0308
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0215
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0308

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.379
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.354
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.254
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.169
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.115
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.257
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.145
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.078
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.042
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.024
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.285
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.214
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.153
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.117
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.102


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.37894
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.759
SUFF_SIMPLE for r=0.05 class 0.0 = 0.6 +- 0.413 (in-sample avg dev_std = 0.472)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.78 +- 0.413 (in-sample avg dev_std = 0.472)
SUFF_SIMPLE for r=0.05 all KL = 0.577 +- 0.413 (in-sample avg dev_std = 0.472)
SUFF_SIMPLE for r=0.05 all L1 = 0.7 +- 0.301 (in-sample avg dev_std = 0.472)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35417200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.752
SUFF_SIMPLE for r=0.1 class 0.0 = 0.6 +- 0.417 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.775 +- 0.417 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.1 all KL = 0.574 +- 0.417 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.1 all L1 = 0.697 +- 0.305 (in-sample avg dev_std = 0.475)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25360200000000005
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.74
SUFF_SIMPLE for r=0.2 class 0.0 = 0.602 +- 0.417 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.75 +- 0.417 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 all KL = 0.553 +- 0.417 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 all L1 = 0.684 +- 0.304 (in-sample avg dev_std = 0.493)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.169174
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.769
SUFF_SIMPLE for r=0.4 class 0.0 = 0.637 +- 0.408 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.755 +- 0.408 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.4 all KL = 0.576 +- 0.408 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.4 all L1 = 0.702 +- 0.297 (in-sample avg dev_std = 0.476)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11512199999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.705
SUFF_SIMPLE for r=0.8 class 0.0 = 0.659 +- 0.437 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.697 +- 0.437 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.8 all KL = 0.577 +- 0.437 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.8 all L1 = 0.68 +- 0.335 (in-sample avg dev_std = 0.358)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25650019999999996
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.63
SUFF_SIMPLE for r=0.05 class 0.0 = 0.636 +- 0.423 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.611 +- 0.423 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.05 all KL = 0.515 +- 0.423 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.05 all L1 = 0.624 +- 0.328 (in-sample avg dev_std = 0.474)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1450794
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.624
SUFF_SIMPLE for r=0.1 class 0.0 = 0.636 +- 0.424 (in-sample avg dev_std = 0.478)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.603 +- 0.424 (in-sample avg dev_std = 0.478)
SUFF_SIMPLE for r=0.1 all KL = 0.509 +- 0.424 (in-sample avg dev_std = 0.478)
SUFF_SIMPLE for r=0.1 all L1 = 0.619 +- 0.328 (in-sample avg dev_std = 0.478)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0784476
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.605
SUFF_SIMPLE for r=0.2 class 0.0 = 0.641 +- 0.423 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.569 +- 0.423 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 all KL = 0.487 +- 0.423 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 all L1 = 0.605 +- 0.328 (in-sample avg dev_std = 0.493)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0418752
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.568
SUFF_SIMPLE for r=0.4 class 0.0 = 0.66 +- 0.422 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.494 +- 0.422 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.4 all KL = 0.44 +- 0.422 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.4 all L1 = 0.576 +- 0.325 (in-sample avg dev_std = 0.528)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.024070800000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.498
SUFF_SIMPLE for r=0.8 class 0.0 = 0.71 +- 0.444 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.445 +- 0.444 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.8 all KL = 0.492 +- 0.444 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.8 all L1 = 0.576 +- 0.372 (in-sample avg dev_std = 0.238)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.695
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2850872
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.594
SUFF_SIMPLE for r=0.05 class 0.0 = 0.785 +- 0.387 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.661 +- 0.387 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.05 all KL = 0.685 +- 0.387 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.05 all L1 = 0.724 +- 0.311 (in-sample avg dev_std = 0.253)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.695
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.21378519999999998
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.597
SUFF_SIMPLE for r=0.1 class 0.0 = 0.779 +- 0.387 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.664 +- 0.387 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.1 all KL = 0.682 +- 0.387 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.1 all L1 = 0.723 +- 0.313 (in-sample avg dev_std = 0.244)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.695
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.152517
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.609
SUFF_SIMPLE for r=0.2 class 0.0 = 0.785 +- 0.386 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.67 +- 0.386 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.2 all KL = 0.686 +- 0.386 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.2 all L1 = 0.728 +- 0.309 (in-sample avg dev_std = 0.239)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.695
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1165626
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.595
SUFF_SIMPLE for r=0.4 class 0.0 = 0.813 +- 0.380 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.665 +- 0.380 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.4 all KL = 0.706 +- 0.380 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.4 all L1 = 0.74 +- 0.310 (in-sample avg dev_std = 0.242)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.696
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1024266
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.641
SUFF_SIMPLE for r=0.8 class 0.0 = 0.9 +- 0.311 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.76 +- 0.311 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 all KL = 0.835 +- 0.311 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 all L1 = 0.831 +- 0.274 (in-sample avg dev_std = 0.030)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.37894
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.64
NEC for r=0.05 class 0.0 = 0.178 +- 0.469 (in-sample avg dev_std = 0.200)
NEC for r=0.05 class 1.0 = 0.474 +- 0.469 (in-sample avg dev_std = 0.200)
NEC for r=0.05 all KL = 0.406 +- 0.469 (in-sample avg dev_std = 0.200)
NEC for r=0.05 all L1 = 0.342 +- 0.387 (in-sample avg dev_std = 0.200)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35417200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.72
NEC for r=0.1 class 0.0 = 0.242 +- 0.435 (in-sample avg dev_std = 0.417)
NEC for r=0.1 class 1.0 = 0.347 +- 0.435 (in-sample avg dev_std = 0.417)
NEC for r=0.1 all KL = 0.419 +- 0.435 (in-sample avg dev_std = 0.417)
NEC for r=0.1 all L1 = 0.3 +- 0.329 (in-sample avg dev_std = 0.417)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25360200000000005
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.822
NEC for r=0.2 class 0.0 = 0.273 +- 0.391 (in-sample avg dev_std = 0.398)
NEC for r=0.2 class 1.0 = 0.157 +- 0.391 (in-sample avg dev_std = 0.398)
NEC for r=0.2 all KL = 0.294 +- 0.391 (in-sample avg dev_std = 0.398)
NEC for r=0.2 all L1 = 0.209 +- 0.277 (in-sample avg dev_std = 0.398)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.169174
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.88
NEC for r=0.4 class 0.0 = 0.267 +- 0.364 (in-sample avg dev_std = 0.396)
NEC for r=0.4 class 1.0 = 0.081 +- 0.364 (in-sample avg dev_std = 0.396)
NEC for r=0.4 all KL = 0.237 +- 0.364 (in-sample avg dev_std = 0.396)
NEC for r=0.4 all L1 = 0.164 +- 0.245 (in-sample avg dev_std = 0.396)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11512199999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.913
NEC for r=0.8 class 0.0 = 0.214 +- 0.309 (in-sample avg dev_std = 0.342)
NEC for r=0.8 class 1.0 = 0.049 +- 0.309 (in-sample avg dev_std = 0.342)
NEC for r=0.8 all KL = 0.179 +- 0.309 (in-sample avg dev_std = 0.342)
NEC for r=0.8 all L1 = 0.123 +- 0.207 (in-sample avg dev_std = 0.342)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25650019999999996
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.487
NEC for r=0.05 class 0.0 = 0.057 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.746 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.446 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.404 +- 0.399 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1450794
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.554
NEC for r=0.1 class 0.0 = 0.138 +- 0.428 (in-sample avg dev_std = 0.317)
NEC for r=0.1 class 1.0 = 0.656 +- 0.428 (in-sample avg dev_std = 0.317)
NEC for r=0.1 all KL = 0.495 +- 0.428 (in-sample avg dev_std = 0.317)
NEC for r=0.1 all L1 = 0.399 +- 0.361 (in-sample avg dev_std = 0.317)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0784476
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.822
NEC for r=0.2 class 0.0 = 0.222 +- 0.373 (in-sample avg dev_std = 0.512)
NEC for r=0.2 class 1.0 = 0.298 +- 0.373 (in-sample avg dev_std = 0.512)
NEC for r=0.2 all KL = 0.414 +- 0.373 (in-sample avg dev_std = 0.512)
NEC for r=0.2 all L1 = 0.26 +- 0.228 (in-sample avg dev_std = 0.512)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0418752
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.862
NEC for r=0.4 class 0.0 = 0.216 +- 0.386 (in-sample avg dev_std = 0.427)
NEC for r=0.4 class 1.0 = 0.192 +- 0.386 (in-sample avg dev_std = 0.427)
NEC for r=0.4 all KL = 0.309 +- 0.386 (in-sample avg dev_std = 0.427)
NEC for r=0.4 all L1 = 0.204 +- 0.230 (in-sample avg dev_std = 0.427)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.024070800000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.89
NEC for r=0.8 class 0.0 = 0.17 +- 0.376 (in-sample avg dev_std = 0.377)
NEC for r=0.8 class 1.0 = 0.174 +- 0.376 (in-sample avg dev_std = 0.377)
NEC for r=0.8 all KL = 0.263 +- 0.376 (in-sample avg dev_std = 0.377)
NEC for r=0.8 all L1 = 0.172 +- 0.218 (in-sample avg dev_std = 0.377)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.695
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2850872
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.584
NEC for r=0.05 class 0.0 = 0.067 +- 0.308 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.229 +- 0.308 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.138 +- 0.308 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.147 +- 0.280 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.695
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.21378519999999998
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.554
NEC for r=0.1 class 0.0 = 0.079 +- 0.338 (in-sample avg dev_std = 0.008)
NEC for r=0.1 class 1.0 = 0.269 +- 0.338 (in-sample avg dev_std = 0.008)
NEC for r=0.1 all KL = 0.168 +- 0.338 (in-sample avg dev_std = 0.008)
NEC for r=0.1 all L1 = 0.173 +- 0.303 (in-sample avg dev_std = 0.008)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.695
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.152517
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.583
NEC for r=0.2 class 0.0 = 0.103 +- 0.331 (in-sample avg dev_std = 0.196)
NEC for r=0.2 class 1.0 = 0.264 +- 0.331 (in-sample avg dev_std = 0.196)
NEC for r=0.2 all KL = 0.18 +- 0.331 (in-sample avg dev_std = 0.196)
NEC for r=0.2 all L1 = 0.182 +- 0.293 (in-sample avg dev_std = 0.196)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.695
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1165626
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.65
NEC for r=0.4 class 0.0 = 0.134 +- 0.296 (in-sample avg dev_std = 0.228)
NEC for r=0.4 class 1.0 = 0.191 +- 0.296 (in-sample avg dev_std = 0.228)
NEC for r=0.4 all KL = 0.166 +- 0.296 (in-sample avg dev_std = 0.228)
NEC for r=0.4 all L1 = 0.162 +- 0.254 (in-sample avg dev_std = 0.228)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.695
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1024266
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.664
NEC for r=0.8 class 0.0 = 0.148 +- 0.279 (in-sample avg dev_std = 0.211)
NEC for r=0.8 class 1.0 = 0.165 +- 0.279 (in-sample avg dev_std = 0.211)
NEC for r=0.8 all KL = 0.156 +- 0.279 (in-sample avg dev_std = 0.211)
NEC for r=0.8 all L1 = 0.156 +- 0.240 (in-sample avg dev_std = 0.211)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:21:41 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 06:21:41 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 06:21:41 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:21:41 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 06:21:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:21:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:21:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:21:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:21:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:21:41 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:21:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 77 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ACCURACY: 0.9888
Train Loss: 0.0367
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0348
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0351
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0348
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0351

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 77...
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ACCURACY: 0.9888
Train Loss: 0.0367
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0348
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0351
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0348
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0351

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.382
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.353
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.255
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.169
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.114
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.248
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.139
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.075
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.039
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.023
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.283
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.212
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.146
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.110
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.094


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381686
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.695
SUFF_SIMPLE for r=0.05 class 0.0 = 0.571 +- 0.413 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.728 +- 0.413 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.05 all KL = 0.566 +- 0.413 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.05 all L1 = 0.658 +- 0.325 (in-sample avg dev_std = 0.442)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35322
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.677
SUFF_SIMPLE for r=0.1 class 0.0 = 0.565 +- 0.418 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.711 +- 0.418 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.1 all KL = 0.547 +- 0.418 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.1 all L1 = 0.646 +- 0.329 (in-sample avg dev_std = 0.440)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254516
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.656
SUFF_SIMPLE for r=0.2 class 0.0 = 0.564 +- 0.419 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.688 +- 0.419 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.2 all KL = 0.53 +- 0.419 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.2 all L1 = 0.633 +- 0.331 (in-sample avg dev_std = 0.447)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.16855400000000004
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.685
SUFF_SIMPLE for r=0.4 class 0.0 = 0.583 +- 0.413 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.688 +- 0.413 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.4 all KL = 0.54 +- 0.413 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.4 all L1 = 0.641 +- 0.324 (in-sample avg dev_std = 0.450)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11422
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.712
SUFF_SIMPLE for r=0.8 class 0.0 = 0.728 +- 0.419 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.647 +- 0.419 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.8 all KL = 0.597 +- 0.419 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.8 all L1 = 0.683 +- 0.330 (in-sample avg dev_std = 0.338)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.797
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2482062
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.526
SUFF_SIMPLE for r=0.05 class 0.0 = 0.733 +- 0.394 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.61 +- 0.394 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.05 all KL = 0.599 +- 0.394 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.05 all L1 = 0.671 +- 0.308 (in-sample avg dev_std = 0.362)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.797
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1390932
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.526
SUFF_SIMPLE for r=0.1 class 0.0 = 0.731 +- 0.396 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.611 +- 0.396 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.1 all KL = 0.598 +- 0.396 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.1 all L1 = 0.67 +- 0.309 (in-sample avg dev_std = 0.357)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.797
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07463979999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.515
SUFF_SIMPLE for r=0.2 class 0.0 = 0.732 +- 0.399 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.59 +- 0.399 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.2 all KL = 0.588 +- 0.399 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.2 all L1 = 0.66 +- 0.314 (in-sample avg dev_std = 0.357)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.797
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03945939999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.476
SUFF_SIMPLE for r=0.4 class 0.0 = 0.735 +- 0.409 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.531 +- 0.409 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.4 all KL = 0.552 +- 0.409 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.4 all L1 = 0.632 +- 0.328 (in-sample avg dev_std = 0.359)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.797
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.023059800000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.401
SUFF_SIMPLE for r=0.8 class 0.0 = 0.755 +- 0.429 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.438 +- 0.429 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.8 all KL = 0.517 +- 0.429 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.8 all L1 = 0.595 +- 0.360 (in-sample avg dev_std = 0.141)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.679
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.28305860000000005
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.583
SUFF_SIMPLE for r=0.05 class 0.0 = 0.788 +- 0.387 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.652 +- 0.387 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.05 all KL = 0.685 +- 0.387 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.05 all L1 = 0.721 +- 0.322 (in-sample avg dev_std = 0.270)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.679
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2117496
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.581
SUFF_SIMPLE for r=0.1 class 0.0 = 0.785 +- 0.389 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.652 +- 0.389 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.1 all KL = 0.684 +- 0.389 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.1 all L1 = 0.719 +- 0.327 (in-sample avg dev_std = 0.250)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.679
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.14642339999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.585
SUFF_SIMPLE for r=0.2 class 0.0 = 0.798 +- 0.381 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.659 +- 0.381 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.2 all KL = 0.697 +- 0.381 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.2 all L1 = 0.73 +- 0.321 (in-sample avg dev_std = 0.235)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10953380000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.584
SUFF_SIMPLE for r=0.4 class 0.0 = 0.829 +- 0.373 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.671 +- 0.373 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.4 all KL = 0.726 +- 0.373 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.4 all L1 = 0.751 +- 0.314 (in-sample avg dev_std = 0.226)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.679
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0943582
len(reference) = 4946
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.642
SUFF_SIMPLE for r=0.8 class 0.0 = 0.935 +- 0.304 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.762 +- 0.304 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.8 all KL = 0.852 +- 0.304 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.8 all L1 = 0.85 +- 0.268 (in-sample avg dev_std = 0.035)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381686
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.628
NEC for r=0.05 class 0.0 = 0.219 +- 0.457 (in-sample avg dev_std = 0.212)
NEC for r=0.05 class 1.0 = 0.439 +- 0.457 (in-sample avg dev_std = 0.212)
NEC for r=0.05 all KL = 0.386 +- 0.457 (in-sample avg dev_std = 0.212)
NEC for r=0.05 all L1 = 0.341 +- 0.384 (in-sample avg dev_std = 0.212)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35322
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.746
NEC for r=0.1 class 0.0 = 0.284 +- 0.418 (in-sample avg dev_std = 0.377)
NEC for r=0.1 class 1.0 = 0.264 +- 0.418 (in-sample avg dev_std = 0.377)
NEC for r=0.1 all KL = 0.341 +- 0.418 (in-sample avg dev_std = 0.377)
NEC for r=0.1 all L1 = 0.273 +- 0.322 (in-sample avg dev_std = 0.377)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254516
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.8
NEC for r=0.2 class 0.0 = 0.335 +- 0.398 (in-sample avg dev_std = 0.399)
NEC for r=0.2 class 1.0 = 0.152 +- 0.398 (in-sample avg dev_std = 0.399)
NEC for r=0.2 all KL = 0.291 +- 0.398 (in-sample avg dev_std = 0.399)
NEC for r=0.2 all L1 = 0.234 +- 0.297 (in-sample avg dev_std = 0.399)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.16855400000000004
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.848
NEC for r=0.4 class 0.0 = 0.313 +- 0.383 (in-sample avg dev_std = 0.431)
NEC for r=0.4 class 1.0 = 0.113 +- 0.383 (in-sample avg dev_std = 0.431)
NEC for r=0.4 all KL = 0.267 +- 0.383 (in-sample avg dev_std = 0.431)
NEC for r=0.4 all L1 = 0.202 +- 0.265 (in-sample avg dev_std = 0.431)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11422
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.849
NEC for r=0.8 class 0.0 = 0.313 +- 0.371 (in-sample avg dev_std = 0.419)
NEC for r=0.8 class 1.0 = 0.096 +- 0.371 (in-sample avg dev_std = 0.419)
NEC for r=0.8 all KL = 0.254 +- 0.371 (in-sample avg dev_std = 0.419)
NEC for r=0.8 all L1 = 0.193 +- 0.262 (in-sample avg dev_std = 0.419)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.797
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2482062
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
NEC for r=0.05 class 0.0 = 0.063 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.546 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.321 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.307 +- 0.358 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.797
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1390932
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.571
NEC for r=0.1 class 0.0 = 0.073 +- 0.373 (in-sample avg dev_std = 0.191)
NEC for r=0.1 class 1.0 = 0.438 +- 0.373 (in-sample avg dev_std = 0.191)
NEC for r=0.1 all KL = 0.284 +- 0.373 (in-sample avg dev_std = 0.191)
NEC for r=0.1 all L1 = 0.257 +- 0.317 (in-sample avg dev_std = 0.191)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.797
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07463979999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.654
NEC for r=0.2 class 0.0 = 0.164 +- 0.361 (in-sample avg dev_std = 0.360)
NEC for r=0.2 class 1.0 = 0.252 +- 0.361 (in-sample avg dev_std = 0.360)
NEC for r=0.2 all KL = 0.274 +- 0.361 (in-sample avg dev_std = 0.360)
NEC for r=0.2 all L1 = 0.208 +- 0.225 (in-sample avg dev_std = 0.360)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.797
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03945939999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.682
NEC for r=0.4 class 0.0 = 0.194 +- 0.373 (in-sample avg dev_std = 0.327)
NEC for r=0.4 class 1.0 = 0.16 +- 0.373 (in-sample avg dev_std = 0.327)
NEC for r=0.4 all KL = 0.237 +- 0.373 (in-sample avg dev_std = 0.327)
NEC for r=0.4 all L1 = 0.177 +- 0.217 (in-sample avg dev_std = 0.327)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.797
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.023059800000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.697
NEC for r=0.8 class 0.0 = 0.186 +- 0.368 (in-sample avg dev_std = 0.318)
NEC for r=0.8 class 1.0 = 0.151 +- 0.368 (in-sample avg dev_std = 0.318)
NEC for r=0.8 all KL = 0.227 +- 0.368 (in-sample avg dev_std = 0.318)
NEC for r=0.8 all L1 = 0.168 +- 0.211 (in-sample avg dev_std = 0.318)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.679
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.28305860000000005
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.589
NEC for r=0.05 class 0.0 = 0.07 +- 0.306 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.225 +- 0.306 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.137 +- 0.306 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.147 +- 0.280 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.679
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2117496
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.562
NEC for r=0.1 class 0.0 = 0.085 +- 0.338 (in-sample avg dev_std = 0.004)
NEC for r=0.1 class 1.0 = 0.267 +- 0.338 (in-sample avg dev_std = 0.004)
NEC for r=0.1 all KL = 0.169 +- 0.338 (in-sample avg dev_std = 0.004)
NEC for r=0.1 all L1 = 0.175 +- 0.304 (in-sample avg dev_std = 0.004)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.679
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.14642339999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.576
NEC for r=0.2 class 0.0 = 0.102 +- 0.331 (in-sample avg dev_std = 0.171)
NEC for r=0.2 class 1.0 = 0.257 +- 0.331 (in-sample avg dev_std = 0.171)
NEC for r=0.2 all KL = 0.174 +- 0.331 (in-sample avg dev_std = 0.171)
NEC for r=0.2 all L1 = 0.179 +- 0.293 (in-sample avg dev_std = 0.171)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10953380000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.638
NEC for r=0.4 class 0.0 = 0.13 +- 0.303 (in-sample avg dev_std = 0.237)
NEC for r=0.4 class 1.0 = 0.201 +- 0.303 (in-sample avg dev_std = 0.237)
NEC for r=0.4 all KL = 0.168 +- 0.303 (in-sample avg dev_std = 0.237)
NEC for r=0.4 all L1 = 0.165 +- 0.258 (in-sample avg dev_std = 0.237)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.679
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0943582
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.651
NEC for r=0.8 class 0.0 = 0.139 +- 0.281 (in-sample avg dev_std = 0.237)
NEC for r=0.8 class 1.0 = 0.178 +- 0.281 (in-sample avg dev_std = 0.237)
NEC for r=0.8 all KL = 0.158 +- 0.281 (in-sample avg dev_std = 0.237)
NEC for r=0.8 all L1 = 0.158 +- 0.247 (in-sample avg dev_std = 0.237)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:40:14 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 06:40:14 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 06:40:14 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:40:14 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 06:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:40:14 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:40:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9898
Train Loss: 0.0441
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0486
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0525
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0486
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0525

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9898
Train Loss: 0.0441
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0486
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0525
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0486
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0525

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.369
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.322
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.228
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.141
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.096
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.255
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.145
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.079
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.042
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.022
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.276
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.199
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.133
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.092


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.368644
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.701
SUFF_SIMPLE for r=0.05 class 0.0 = 0.586 +- 0.420 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.725 +- 0.420 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 all KL = 0.562 +- 0.420 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 all L1 = 0.663 +- 0.316 (in-sample avg dev_std = 0.440)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32156799999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.705
SUFF_SIMPLE for r=0.1 class 0.0 = 0.58 +- 0.420 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.739 +- 0.420 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.1 all KL = 0.572 +- 0.420 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.1 all L1 = 0.668 +- 0.321 (in-sample avg dev_std = 0.428)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.228022
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.703
SUFF_SIMPLE for r=0.2 class 0.0 = 0.587 +- 0.421 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.73 +- 0.421 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.2 all KL = 0.57 +- 0.421 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.2 all L1 = 0.667 +- 0.321 (in-sample avg dev_std = 0.429)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.723
SUFF_SIMPLE for r=0.4 class 0.0 = 0.594 +- 0.413 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.736 +- 0.413 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.4 all KL = 0.579 +- 0.413 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.4 all L1 = 0.672 +- 0.313 (in-sample avg dev_std = 0.419)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.096098
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.767
SUFF_SIMPLE for r=0.8 class 0.0 = 0.791 +- 0.395 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.664 +- 0.395 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.8 all KL = 0.647 +- 0.395 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.8 all L1 = 0.721 +- 0.308 (in-sample avg dev_std = 0.306)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.74
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25512219999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.595
SUFF_SIMPLE for r=0.05 class 0.0 = 0.818 +- 0.389 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.601 +- 0.389 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.05 all KL = 0.628 +- 0.389 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.05 all L1 = 0.709 +- 0.293 (in-sample avg dev_std = 0.322)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.74
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1447938
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.597
SUFF_SIMPLE for r=0.1 class 0.0 = 0.822 +- 0.386 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.605 +- 0.386 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.1 all KL = 0.636 +- 0.386 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.1 all L1 = 0.713 +- 0.293 (in-sample avg dev_std = 0.309)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.74
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07866580000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.597
SUFF_SIMPLE for r=0.2 class 0.0 = 0.838 +- 0.381 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.598 +- 0.381 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.2 all KL = 0.643 +- 0.381 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.2 all L1 = 0.717 +- 0.294 (in-sample avg dev_std = 0.302)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.74
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0417914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.579
SUFF_SIMPLE for r=0.4 class 0.0 = 0.856 +- 0.385 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.565 +- 0.385 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.4 all KL = 0.631 +- 0.385 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.4 all L1 = 0.709 +- 0.300 (in-sample avg dev_std = 0.308)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.74
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0224552
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.533
SUFF_SIMPLE for r=0.8 class 0.0 = 0.939 +- 0.377 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.528 +- 0.377 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.8 all KL = 0.705 +- 0.377 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.8 all L1 = 0.732 +- 0.327 (in-sample avg dev_std = 0.092)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.626
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.27557080000000006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.552
SUFF_SIMPLE for r=0.05 class 0.0 = 0.824 +- 0.394 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.651 +- 0.394 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.05 all KL = 0.709 +- 0.394 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.05 all L1 = 0.739 +- 0.329 (in-sample avg dev_std = 0.236)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.626
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1988164
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.544
SUFF_SIMPLE for r=0.1 class 0.0 = 0.823 +- 0.393 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.655 +- 0.393 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.1 all KL = 0.712 +- 0.393 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.1 all L1 = 0.74 +- 0.331 (in-sample avg dev_std = 0.209)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.626
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1334
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.552
SUFF_SIMPLE for r=0.2 class 0.0 = 0.823 +- 0.389 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.661 +- 0.389 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.2 all KL = 0.715 +- 0.389 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.2 all L1 = 0.743 +- 0.329 (in-sample avg dev_std = 0.192)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.626
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.100493
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.562
SUFF_SIMPLE for r=0.4 class 0.0 = 0.861 +- 0.370 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.679 +- 0.370 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.4 all KL = 0.749 +- 0.370 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.4 all L1 = 0.771 +- 0.314 (in-sample avg dev_std = 0.180)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.63
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0916568
len(reference) = 4955
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.613
SUFF_SIMPLE for r=0.8 class 0.0 = 0.94 +- 0.302 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.755 +- 0.302 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.8 all KL = 0.851 +- 0.302 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.8 all L1 = 0.849 +- 0.268 (in-sample avg dev_std = 0.003)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.368644
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.659
NEC for r=0.05 class 0.0 = 0.174 +- 0.453 (in-sample avg dev_std = 0.157)
NEC for r=0.05 class 1.0 = 0.429 +- 0.453 (in-sample avg dev_std = 0.157)
NEC for r=0.05 all KL = 0.355 +- 0.453 (in-sample avg dev_std = 0.157)
NEC for r=0.05 all L1 = 0.315 +- 0.378 (in-sample avg dev_std = 0.157)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32156799999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.706
NEC for r=0.1 class 0.0 = 0.259 +- 0.436 (in-sample avg dev_std = 0.462)
NEC for r=0.1 class 1.0 = 0.377 +- 0.436 (in-sample avg dev_std = 0.462)
NEC for r=0.1 all KL = 0.432 +- 0.436 (in-sample avg dev_std = 0.462)
NEC for r=0.1 all L1 = 0.324 +- 0.325 (in-sample avg dev_std = 0.462)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.228022
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.797
NEC for r=0.2 class 0.0 = 0.297 +- 0.401 (in-sample avg dev_std = 0.469)
NEC for r=0.2 class 1.0 = 0.218 +- 0.401 (in-sample avg dev_std = 0.469)
NEC for r=0.2 all KL = 0.356 +- 0.401 (in-sample avg dev_std = 0.469)
NEC for r=0.2 all L1 = 0.253 +- 0.279 (in-sample avg dev_std = 0.469)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.844
NEC for r=0.4 class 0.0 = 0.308 +- 0.382 (in-sample avg dev_std = 0.427)
NEC for r=0.4 class 1.0 = 0.115 +- 0.382 (in-sample avg dev_std = 0.427)
NEC for r=0.4 all KL = 0.28 +- 0.382 (in-sample avg dev_std = 0.427)
NEC for r=0.4 all L1 = 0.201 +- 0.261 (in-sample avg dev_std = 0.427)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.096098
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.863
NEC for r=0.8 class 0.0 = 0.288 +- 0.368 (in-sample avg dev_std = 0.395)
NEC for r=0.8 class 1.0 = 0.087 +- 0.368 (in-sample avg dev_std = 0.395)
NEC for r=0.8 all KL = 0.245 +- 0.368 (in-sample avg dev_std = 0.395)
NEC for r=0.8 all L1 = 0.177 +- 0.254 (in-sample avg dev_std = 0.395)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.74
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25512219999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.475
NEC for r=0.05 class 0.0 = 0.054 +- 0.391 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.505 +- 0.391 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.293 +- 0.391 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.281 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.74
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1447938
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.477
NEC for r=0.1 class 0.0 = 0.073 +- 0.399 (in-sample avg dev_std = 0.148)
NEC for r=0.1 class 1.0 = 0.505 +- 0.399 (in-sample avg dev_std = 0.148)
NEC for r=0.1 all KL = 0.329 +- 0.399 (in-sample avg dev_std = 0.148)
NEC for r=0.1 all L1 = 0.291 +- 0.345 (in-sample avg dev_std = 0.148)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.74
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07866580000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.557
NEC for r=0.2 class 0.0 = 0.124 +- 0.386 (in-sample avg dev_std = 0.425)
NEC for r=0.2 class 1.0 = 0.431 +- 0.386 (in-sample avg dev_std = 0.425)
NEC for r=0.2 all KL = 0.384 +- 0.386 (in-sample avg dev_std = 0.425)
NEC for r=0.2 all L1 = 0.279 +- 0.279 (in-sample avg dev_std = 0.425)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.74
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0417914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.608
NEC for r=0.4 class 0.0 = 0.158 +- 0.366 (in-sample avg dev_std = 0.424)
NEC for r=0.4 class 1.0 = 0.335 +- 0.366 (in-sample avg dev_std = 0.424)
NEC for r=0.4 all KL = 0.341 +- 0.366 (in-sample avg dev_std = 0.424)
NEC for r=0.4 all L1 = 0.247 +- 0.242 (in-sample avg dev_std = 0.424)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.74
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0224552
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.67
NEC for r=0.8 class 0.0 = 0.111 +- 0.333 (in-sample avg dev_std = 0.348)
NEC for r=0.8 class 1.0 = 0.266 +- 0.333 (in-sample avg dev_std = 0.348)
NEC for r=0.8 all KL = 0.255 +- 0.333 (in-sample avg dev_std = 0.348)
NEC for r=0.8 all L1 = 0.19 +- 0.207 (in-sample avg dev_std = 0.348)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.626
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.27557080000000006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.582
NEC for r=0.05 class 0.0 = 0.065 +- 0.234 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.13 +- 0.234 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.083 +- 0.234 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.097 +- 0.222 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.626
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1988164
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.564
NEC for r=0.1 class 0.0 = 0.072 +- 0.259 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.154 +- 0.259 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.1 +- 0.259 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.113 +- 0.241 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.626
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1334
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.558
NEC for r=0.2 class 0.0 = 0.085 +- 0.266 (in-sample avg dev_std = 0.055)
NEC for r=0.2 class 1.0 = 0.156 +- 0.266 (in-sample avg dev_std = 0.055)
NEC for r=0.2 all KL = 0.111 +- 0.266 (in-sample avg dev_std = 0.055)
NEC for r=0.2 all L1 = 0.12 +- 0.244 (in-sample avg dev_std = 0.055)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.626
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.100493
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.59
NEC for r=0.4 class 0.0 = 0.104 +- 0.263 (in-sample avg dev_std = 0.214)
NEC for r=0.4 class 1.0 = 0.148 +- 0.263 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all KL = 0.126 +- 0.263 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all L1 = 0.126 +- 0.224 (in-sample avg dev_std = 0.214)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.626
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0916568
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.599
NEC for r=0.8 class 0.0 = 0.118 +- 0.279 (in-sample avg dev_std = 0.243)
NEC for r=0.8 class 1.0 = 0.173 +- 0.279 (in-sample avg dev_std = 0.243)
NEC for r=0.8 all KL = 0.151 +- 0.279 (in-sample avg dev_std = 0.243)
NEC for r=0.8 all L1 = 0.145 +- 0.237 (in-sample avg dev_std = 0.243)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:58:56 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 06:58:56 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 06:58:56 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:58:56 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 06:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:58:56 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:58:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9718
Train Loss: 0.0708
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0692
ID Test ACCURACY: 0.9580
ID Test Loss: 0.0971
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0692
OOD Test ACCURACY: 0.9580
OOD Test Loss: 0.0971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9718
Train Loss: 0.0708
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0692
ID Test ACCURACY: 0.9580
ID Test Loss: 0.0971
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0692
OOD Test ACCURACY: 0.9580
OOD Test Loss: 0.0971

[0m[1;37mINFO[0m: [1mChartInfo 0.9580 0.9580 0.9580 0.9580 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.413
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.361
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.255
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.159
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.109
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.228
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.131
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.073
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.040
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.022
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.268
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.202
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.140
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.108
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.097


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.413274
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.71
SUFF_SIMPLE for r=0.05 class 0.0 = 0.603 +- 0.403 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.724 +- 0.403 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.05 all KL = 0.585 +- 0.403 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.05 all L1 = 0.67 +- 0.305 (in-sample avg dev_std = 0.448)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.361036
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.714
SUFF_SIMPLE for r=0.1 class 0.0 = 0.596 +- 0.407 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.743 +- 0.407 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 all KL = 0.597 +- 0.407 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 all L1 = 0.678 +- 0.309 (in-sample avg dev_std = 0.438)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254962
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.712
SUFF_SIMPLE for r=0.2 class 0.0 = 0.608 +- 0.400 (in-sample avg dev_std = 0.436)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.734 +- 0.400 (in-sample avg dev_std = 0.436)
SUFF_SIMPLE for r=0.2 all KL = 0.596 +- 0.400 (in-sample avg dev_std = 0.436)
SUFF_SIMPLE for r=0.2 all L1 = 0.678 +- 0.309 (in-sample avg dev_std = 0.436)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.158738
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.737
SUFF_SIMPLE for r=0.4 class 0.0 = 0.606 +- 0.388 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.737 +- 0.388 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.4 all KL = 0.596 +- 0.388 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.4 all L1 = 0.678 +- 0.299 (in-sample avg dev_std = 0.422)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.109048
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.772
SUFF_SIMPLE for r=0.8 class 0.0 = 0.737 +- 0.386 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.701 +- 0.386 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.8 all KL = 0.661 +- 0.386 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.8 all L1 = 0.717 +- 0.304 (in-sample avg dev_std = 0.304)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.791
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22811019999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.651
SUFF_SIMPLE for r=0.05 class 0.0 = 0.841 +- 0.389 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.64 +- 0.389 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.05 all KL = 0.658 +- 0.389 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.05 all L1 = 0.739 +- 0.292 (in-sample avg dev_std = 0.390)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.791
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1310016
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.651
SUFF_SIMPLE for r=0.1 class 0.0 = 0.849 +- 0.386 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.643 +- 0.386 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.1 all KL = 0.666 +- 0.386 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.1 all L1 = 0.745 +- 0.291 (in-sample avg dev_std = 0.383)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.791
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0726636
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.644
SUFF_SIMPLE for r=0.2 class 0.0 = 0.868 +- 0.387 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.626 +- 0.387 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.2 all KL = 0.665 +- 0.387 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.2 all L1 = 0.746 +- 0.293 (in-sample avg dev_std = 0.379)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.791
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0396364
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.609
SUFF_SIMPLE for r=0.4 class 0.0 = 0.884 +- 0.397 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.576 +- 0.397 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.4 all KL = 0.649 +- 0.397 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.4 all L1 = 0.729 +- 0.308 (in-sample avg dev_std = 0.382)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.791
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.022072
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.566
SUFF_SIMPLE for r=0.8 class 0.0 = 0.974 +- 0.377 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.542 +- 0.377 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.8 all KL = 0.739 +- 0.377 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.8 all L1 = 0.756 +- 0.333 (in-sample avg dev_std = 0.107)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.666
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2678136
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.586
SUFF_SIMPLE for r=0.05 class 0.0 = 0.797 +- 0.385 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.644 +- 0.385 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.05 all KL = 0.707 +- 0.385 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.05 all L1 = 0.722 +- 0.326 (in-sample avg dev_std = 0.224)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.666
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2021102
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.587
SUFF_SIMPLE for r=0.1 class 0.0 = 0.792 +- 0.386 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.65 +- 0.386 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.1 all KL = 0.708 +- 0.386 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.1 all L1 = 0.722 +- 0.329 (in-sample avg dev_std = 0.204)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.666
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1403772
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.593
SUFF_SIMPLE for r=0.2 class 0.0 = 0.795 +- 0.382 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.656 +- 0.382 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.2 all KL = 0.711 +- 0.382 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.2 all L1 = 0.726 +- 0.326 (in-sample avg dev_std = 0.192)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.666
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10781439999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.627
SUFF_SIMPLE for r=0.4 class 0.0 = 0.84 +- 0.357 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.671 +- 0.357 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 all KL = 0.747 +- 0.357 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 all L1 = 0.756 +- 0.308 (in-sample avg dev_std = 0.179)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.665
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0974388
len(reference) = 4911
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.673
SUFF_SIMPLE for r=0.8 class 0.0 = 0.91 +- 0.307 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.744 +- 0.307 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.8 all KL = 0.837 +- 0.307 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.8 all L1 = 0.828 +- 0.279 (in-sample avg dev_std = 0.021)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.413274
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.62
NEC for r=0.05 class 0.0 = 0.201 +- 0.461 (in-sample avg dev_std = 0.116)
NEC for r=0.05 class 1.0 = 0.484 +- 0.461 (in-sample avg dev_std = 0.116)
NEC for r=0.05 all KL = 0.389 +- 0.461 (in-sample avg dev_std = 0.116)
NEC for r=0.05 all L1 = 0.358 +- 0.387 (in-sample avg dev_std = 0.116)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.361036
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.666
NEC for r=0.1 class 0.0 = 0.289 +- 0.429 (in-sample avg dev_std = 0.467)
NEC for r=0.1 class 1.0 = 0.417 +- 0.429 (in-sample avg dev_std = 0.467)
NEC for r=0.1 all KL = 0.458 +- 0.429 (in-sample avg dev_std = 0.467)
NEC for r=0.1 all L1 = 0.36 +- 0.321 (in-sample avg dev_std = 0.467)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254962
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.801
NEC for r=0.2 class 0.0 = 0.306 +- 0.375 (in-sample avg dev_std = 0.431)
NEC for r=0.2 class 1.0 = 0.195 +- 0.375 (in-sample avg dev_std = 0.431)
NEC for r=0.2 all KL = 0.321 +- 0.375 (in-sample avg dev_std = 0.431)
NEC for r=0.2 all L1 = 0.245 +- 0.271 (in-sample avg dev_std = 0.431)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.158738
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.862
NEC for r=0.4 class 0.0 = 0.277 +- 0.331 (in-sample avg dev_std = 0.380)
NEC for r=0.4 class 1.0 = 0.099 +- 0.331 (in-sample avg dev_std = 0.380)
NEC for r=0.4 all KL = 0.227 +- 0.331 (in-sample avg dev_std = 0.380)
NEC for r=0.4 all L1 = 0.179 +- 0.237 (in-sample avg dev_std = 0.380)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.109048
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.886
NEC for r=0.8 class 0.0 = 0.243 +- 0.311 (in-sample avg dev_std = 0.362)
NEC for r=0.8 class 1.0 = 0.081 +- 0.311 (in-sample avg dev_std = 0.362)
NEC for r=0.8 all KL = 0.19 +- 0.311 (in-sample avg dev_std = 0.362)
NEC for r=0.8 all L1 = 0.153 +- 0.224 (in-sample avg dev_std = 0.362)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.791
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22811019999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.493
NEC for r=0.05 class 0.0 = 0.014 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.561 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.303 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.29 +- 0.374 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.791
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1310016
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
NEC for r=0.1 class 0.0 = 0.023 +- 0.416 (in-sample avg dev_std = 0.128)
NEC for r=0.1 class 1.0 = 0.559 +- 0.416 (in-sample avg dev_std = 0.128)
NEC for r=0.1 all KL = 0.319 +- 0.416 (in-sample avg dev_std = 0.128)
NEC for r=0.1 all L1 = 0.293 +- 0.369 (in-sample avg dev_std = 0.128)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.791
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0726636
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.563
NEC for r=0.2 class 0.0 = 0.078 +- 0.411 (in-sample avg dev_std = 0.436)
NEC for r=0.2 class 1.0 = 0.502 +- 0.411 (in-sample avg dev_std = 0.436)
NEC for r=0.2 all KL = 0.388 +- 0.411 (in-sample avg dev_std = 0.436)
NEC for r=0.2 all L1 = 0.292 +- 0.318 (in-sample avg dev_std = 0.436)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.791
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0396364
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.657
NEC for r=0.4 class 0.0 = 0.089 +- 0.374 (in-sample avg dev_std = 0.475)
NEC for r=0.4 class 1.0 = 0.386 +- 0.374 (in-sample avg dev_std = 0.475)
NEC for r=0.4 all KL = 0.344 +- 0.374 (in-sample avg dev_std = 0.475)
NEC for r=0.4 all L1 = 0.239 +- 0.257 (in-sample avg dev_std = 0.475)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.791
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.022072
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.738
NEC for r=0.8 class 0.0 = 0.056 +- 0.301 (in-sample avg dev_std = 0.376)
NEC for r=0.8 class 1.0 = 0.265 +- 0.301 (in-sample avg dev_std = 0.376)
NEC for r=0.8 all KL = 0.219 +- 0.301 (in-sample avg dev_std = 0.376)
NEC for r=0.8 all L1 = 0.161 +- 0.202 (in-sample avg dev_std = 0.376)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.666
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2678136
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.573
NEC for r=0.05 class 0.0 = 0.084 +- 0.292 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.2 +- 0.292 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.127 +- 0.292 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.141 +- 0.270 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.666
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2021102
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.555
NEC for r=0.1 class 0.0 = 0.099 +- 0.309 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.219 +- 0.309 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.145 +- 0.309 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.158 +- 0.282 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.666
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1403772
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.55
NEC for r=0.2 class 0.0 = 0.114 +- 0.312 (in-sample avg dev_std = 0.102)
NEC for r=0.2 class 1.0 = 0.222 +- 0.312 (in-sample avg dev_std = 0.102)
NEC for r=0.2 all KL = 0.155 +- 0.312 (in-sample avg dev_std = 0.102)
NEC for r=0.2 all L1 = 0.167 +- 0.282 (in-sample avg dev_std = 0.102)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.666
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10781439999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.594
NEC for r=0.4 class 0.0 = 0.127 +- 0.288 (in-sample avg dev_std = 0.271)
NEC for r=0.4 class 1.0 = 0.202 +- 0.288 (in-sample avg dev_std = 0.271)
NEC for r=0.4 all KL = 0.162 +- 0.288 (in-sample avg dev_std = 0.271)
NEC for r=0.4 all L1 = 0.164 +- 0.246 (in-sample avg dev_std = 0.271)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.666
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0974388
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.621
NEC for r=0.8 class 0.0 = 0.136 +- 0.268 (in-sample avg dev_std = 0.247)
NEC for r=0.8 class 1.0 = 0.181 +- 0.268 (in-sample avg dev_std = 0.247)
NEC for r=0.8 all KL = 0.152 +- 0.268 (in-sample avg dev_std = 0.247)
NEC for r=0.8 all L1 = 0.158 +- 0.238 (in-sample avg dev_std = 0.247)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:17:24 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 07:17:24 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 07:17:24 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:17:24 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 07:17:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:17:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:17:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:17:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:17:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:17:24 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:17:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0398
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0312
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0530
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0312
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0530

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0398
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0312
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0530
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0312
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0530

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9920 0.9920[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.361
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.338
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.242
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.153
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.110
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.228
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.128
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.069
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.036
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.022
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.271
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.201
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.139
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.107
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.100


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.36095000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.725
SUFF_SIMPLE for r=0.05 class 0.0 = 0.548 +- 0.426 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.77 +- 0.426 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.05 all KL = 0.544 +- 0.426 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.05 all L1 = 0.671 +- 0.314 (in-sample avg dev_std = 0.480)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.337952
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.717
SUFF_SIMPLE for r=0.1 class 0.0 = 0.555 +- 0.427 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.756 +- 0.427 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.1 all KL = 0.54 +- 0.427 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.1 all L1 = 0.667 +- 0.318 (in-sample avg dev_std = 0.470)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.242072
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.714
SUFF_SIMPLE for r=0.2 class 0.0 = 0.544 +- 0.424 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.756 +- 0.424 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.2 all KL = 0.523 +- 0.424 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.2 all L1 = 0.662 +- 0.316 (in-sample avg dev_std = 0.470)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.152696
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.699
SUFF_SIMPLE for r=0.4 class 0.0 = 0.553 +- 0.418 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.719 +- 0.418 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.4 all KL = 0.487 +- 0.418 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.4 all L1 = 0.645 +- 0.314 (in-sample avg dev_std = 0.496)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.110316
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.66
SUFF_SIMPLE for r=0.8 class 0.0 = 0.761 +- 0.448 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.565 +- 0.448 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.8 all KL = 0.535 +- 0.448 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.8 all L1 = 0.653 +- 0.344 (in-sample avg dev_std = 0.388)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2276438
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.571
SUFF_SIMPLE for r=0.05 class 0.0 = 0.363 +- 0.412 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.584 +- 0.412 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.05 all KL = 0.288 +- 0.412 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.05 all L1 = 0.474 +- 0.352 (in-sample avg dev_std = 0.452)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1283276
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.558
SUFF_SIMPLE for r=0.1 class 0.0 = 0.36 +- 0.407 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.564 +- 0.407 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.1 all KL = 0.277 +- 0.407 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.1 all L1 = 0.463 +- 0.350 (in-sample avg dev_std = 0.455)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0689638
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.534
SUFF_SIMPLE for r=0.2 class 0.0 = 0.356 +- 0.393 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.519 +- 0.393 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.2 all KL = 0.249 +- 0.393 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.2 all L1 = 0.438 +- 0.341 (in-sample avg dev_std = 0.469)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0364488
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.475
SUFF_SIMPLE for r=0.4 class 0.0 = 0.352 +- 0.358 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.409 +- 0.358 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.4 all KL = 0.19 +- 0.358 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.4 all L1 = 0.381 +- 0.313 (in-sample avg dev_std = 0.496)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.022016200000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.329
SUFF_SIMPLE for r=0.8 class 0.0 = 0.364 +- 0.338 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.219 +- 0.338 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.8 all KL = 0.158 +- 0.338 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.8 all L1 = 0.291 +- 0.295 (in-sample avg dev_std = 0.211)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.708
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2708354
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.627
SUFF_SIMPLE for r=0.05 class 0.0 = 0.773 +- 0.375 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.668 +- 0.375 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.05 all KL = 0.693 +- 0.375 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.05 all L1 = 0.721 +- 0.302 (in-sample avg dev_std = 0.250)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.708
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2011656
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.623
SUFF_SIMPLE for r=0.1 class 0.0 = 0.772 +- 0.376 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.672 +- 0.376 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.1 all KL = 0.693 +- 0.376 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.1 all L1 = 0.723 +- 0.302 (in-sample avg dev_std = 0.234)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.708
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.13908579999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.641
SUFF_SIMPLE for r=0.2 class 0.0 = 0.777 +- 0.375 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.673 +- 0.375 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.2 all KL = 0.691 +- 0.375 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.2 all L1 = 0.726 +- 0.299 (in-sample avg dev_std = 0.239)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.708
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10683719999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.597
SUFF_SIMPLE for r=0.4 class 0.0 = 0.802 +- 0.379 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.655 +- 0.379 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.4 all KL = 0.705 +- 0.379 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.4 all L1 = 0.729 +- 0.309 (in-sample avg dev_std = 0.230)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.709
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1004552
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.685
SUFF_SIMPLE for r=0.8 class 0.0 = 0.923 +- 0.290 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.755 +- 0.290 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.8 all KL = 0.852 +- 0.290 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.8 all L1 = 0.84 +- 0.258 (in-sample avg dev_std = 0.056)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.36095000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.665
NEC for r=0.05 class 0.0 = 0.144 +- 0.465 (in-sample avg dev_std = 0.236)
NEC for r=0.05 class 1.0 = 0.437 +- 0.465 (in-sample avg dev_std = 0.236)
NEC for r=0.05 all KL = 0.366 +- 0.465 (in-sample avg dev_std = 0.236)
NEC for r=0.05 all L1 = 0.306 +- 0.379 (in-sample avg dev_std = 0.236)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.337952
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.767
NEC for r=0.1 class 0.0 = 0.24 +- 0.429 (in-sample avg dev_std = 0.391)
NEC for r=0.1 class 1.0 = 0.254 +- 0.429 (in-sample avg dev_std = 0.391)
NEC for r=0.1 all KL = 0.347 +- 0.429 (in-sample avg dev_std = 0.391)
NEC for r=0.1 all L1 = 0.248 +- 0.316 (in-sample avg dev_std = 0.391)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.242072
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.853
NEC for r=0.2 class 0.0 = 0.308 +- 0.381 (in-sample avg dev_std = 0.392)
NEC for r=0.2 class 1.0 = 0.088 +- 0.381 (in-sample avg dev_std = 0.392)
NEC for r=0.2 all KL = 0.255 +- 0.381 (in-sample avg dev_std = 0.392)
NEC for r=0.2 all L1 = 0.186 +- 0.270 (in-sample avg dev_std = 0.392)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.152696
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.866
NEC for r=0.4 class 0.0 = 0.318 +- 0.375 (in-sample avg dev_std = 0.389)
NEC for r=0.4 class 1.0 = 0.042 +- 0.375 (in-sample avg dev_std = 0.389)
NEC for r=0.4 all KL = 0.231 +- 0.375 (in-sample avg dev_std = 0.389)
NEC for r=0.4 all L1 = 0.165 +- 0.260 (in-sample avg dev_std = 0.389)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.110316
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.88
NEC for r=0.8 class 0.0 = 0.298 +- 0.363 (in-sample avg dev_std = 0.395)
NEC for r=0.8 class 1.0 = 0.044 +- 0.363 (in-sample avg dev_std = 0.395)
NEC for r=0.8 all KL = 0.226 +- 0.363 (in-sample avg dev_std = 0.395)
NEC for r=0.8 all L1 = 0.157 +- 0.246 (in-sample avg dev_std = 0.395)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2276438
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.491
NEC for r=0.05 class 0.0 = 0.216 +- 0.482 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.736 +- 0.482 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.551 +- 0.482 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.478 +- 0.411 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1283276
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.623
NEC for r=0.1 class 0.0 = 0.244 +- 0.461 (in-sample avg dev_std = 0.471)
NEC for r=0.1 class 1.0 = 0.469 +- 0.461 (in-sample avg dev_std = 0.471)
NEC for r=0.1 all KL = 0.533 +- 0.461 (in-sample avg dev_std = 0.471)
NEC for r=0.1 all L1 = 0.358 +- 0.348 (in-sample avg dev_std = 0.471)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0689638
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.743
NEC for r=0.2 class 0.0 = 0.37 +- 0.436 (in-sample avg dev_std = 0.482)
NEC for r=0.2 class 1.0 = 0.057 +- 0.436 (in-sample avg dev_std = 0.482)
NEC for r=0.2 all KL = 0.356 +- 0.436 (in-sample avg dev_std = 0.482)
NEC for r=0.2 all L1 = 0.213 +- 0.278 (in-sample avg dev_std = 0.482)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0364488
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.728
NEC for r=0.4 class 0.0 = 0.423 +- 0.431 (in-sample avg dev_std = 0.445)
NEC for r=0.4 class 1.0 = 0.016 +- 0.431 (in-sample avg dev_std = 0.445)
NEC for r=0.4 all KL = 0.293 +- 0.431 (in-sample avg dev_std = 0.445)
NEC for r=0.4 all L1 = 0.218 +- 0.311 (in-sample avg dev_std = 0.445)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.022016200000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.76
NEC for r=0.8 class 0.0 = 0.453 +- 0.438 (in-sample avg dev_std = 0.470)
NEC for r=0.8 class 1.0 = 0.033 +- 0.438 (in-sample avg dev_std = 0.470)
NEC for r=0.8 all KL = 0.335 +- 0.438 (in-sample avg dev_std = 0.470)
NEC for r=0.8 all L1 = 0.242 +- 0.317 (in-sample avg dev_std = 0.470)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.708
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2708354
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.587
NEC for r=0.05 class 0.0 = 0.074 +- 0.328 (in-sample avg dev_std = 0.001)
NEC for r=0.05 class 1.0 = 0.269 +- 0.328 (in-sample avg dev_std = 0.001)
NEC for r=0.05 all KL = 0.161 +- 0.328 (in-sample avg dev_std = 0.001)
NEC for r=0.05 all L1 = 0.171 +- 0.296 (in-sample avg dev_std = 0.001)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.708
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2011656
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.562
NEC for r=0.1 class 0.0 = 0.085 +- 0.354 (in-sample avg dev_std = 0.033)
NEC for r=0.1 class 1.0 = 0.308 +- 0.354 (in-sample avg dev_std = 0.033)
NEC for r=0.1 all KL = 0.189 +- 0.354 (in-sample avg dev_std = 0.033)
NEC for r=0.1 all L1 = 0.195 +- 0.314 (in-sample avg dev_std = 0.033)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.708
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.13908579999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.619
NEC for r=0.2 class 0.0 = 0.107 +- 0.317 (in-sample avg dev_std = 0.219)
NEC for r=0.2 class 1.0 = 0.245 +- 0.317 (in-sample avg dev_std = 0.219)
NEC for r=0.2 all KL = 0.169 +- 0.317 (in-sample avg dev_std = 0.219)
NEC for r=0.2 all L1 = 0.175 +- 0.274 (in-sample avg dev_std = 0.219)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.708
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10683719999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.667
NEC for r=0.4 class 0.0 = 0.148 +- 0.287 (in-sample avg dev_std = 0.208)
NEC for r=0.4 class 1.0 = 0.166 +- 0.287 (in-sample avg dev_std = 0.208)
NEC for r=0.4 all KL = 0.152 +- 0.287 (in-sample avg dev_std = 0.208)
NEC for r=0.4 all L1 = 0.157 +- 0.247 (in-sample avg dev_std = 0.208)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.708
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1004552
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.686
NEC for r=0.8 class 0.0 = 0.167 +- 0.273 (in-sample avg dev_std = 0.211)
NEC for r=0.8 class 1.0 = 0.155 +- 0.273 (in-sample avg dev_std = 0.211)
NEC for r=0.8 all KL = 0.15 +- 0.273 (in-sample avg dev_std = 0.211)
NEC for r=0.8 all L1 = 0.161 +- 0.241 (in-sample avg dev_std = 0.211)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:36:09 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 07:36:09 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 07:36:09 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:36:09 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 07:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:36:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:36:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:36:09 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:36:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0298
ID Validation ACCURACY: 0.9880
ID Validation Loss: 0.0315
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0329
OOD Validation ACCURACY: 0.9880
OOD Validation Loss: 0.0315
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0329

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0298
ID Validation ACCURACY: 0.9880
ID Validation Loss: 0.0315
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0329
OOD Validation ACCURACY: 0.9880
OOD Validation Loss: 0.0315
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0329

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9880 0.9880[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.387
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.359
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.254
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.162
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.113
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.253
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.144
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.078
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.042
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.023
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.259
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.201
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.146
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.108
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.098


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387144
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.747
SUFF_SIMPLE for r=0.05 class 0.0 = 0.608 +- 0.412 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.767 +- 0.412 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.05 all KL = 0.594 +- 0.412 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.05 all L1 = 0.696 +- 0.302 (in-sample avg dev_std = 0.446)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35862
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.75
SUFF_SIMPLE for r=0.1 class 0.0 = 0.613 +- 0.410 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.766 +- 0.410 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.1 all KL = 0.598 +- 0.410 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.1 all L1 = 0.698 +- 0.302 (in-sample avg dev_std = 0.444)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254072
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.733
SUFF_SIMPLE for r=0.2 class 0.0 = 0.614 +- 0.412 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.735 +- 0.412 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.2 all KL = 0.57 +- 0.412 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.2 all L1 = 0.681 +- 0.301 (in-sample avg dev_std = 0.460)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.16170400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.743
SUFF_SIMPLE for r=0.4 class 0.0 = 0.614 +- 0.410 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.729 +- 0.410 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.4 all KL = 0.575 +- 0.410 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.4 all L1 = 0.678 +- 0.302 (in-sample avg dev_std = 0.450)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11291000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.744
SUFF_SIMPLE for r=0.8 class 0.0 = 0.756 +- 0.407 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.681 +- 0.407 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.8 all KL = 0.643 +- 0.407 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.8 all L1 = 0.715 +- 0.323 (in-sample avg dev_std = 0.287)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.902
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2534924
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.659
SUFF_SIMPLE for r=0.05 class 0.0 = 0.545 +- 0.405 (in-sample avg dev_std = 0.481)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.597 +- 0.405 (in-sample avg dev_std = 0.481)
SUFF_SIMPLE for r=0.05 all KL = 0.486 +- 0.405 (in-sample avg dev_std = 0.481)
SUFF_SIMPLE for r=0.05 all L1 = 0.571 +- 0.318 (in-sample avg dev_std = 0.481)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.902
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1439618
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.641
SUFF_SIMPLE for r=0.1 class 0.0 = 0.539 +- 0.405 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.577 +- 0.405 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.1 all KL = 0.473 +- 0.405 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.1 all L1 = 0.558 +- 0.320 (in-sample avg dev_std = 0.479)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.902
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0783842
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.612
SUFF_SIMPLE for r=0.2 class 0.0 = 0.534 +- 0.402 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.543 +- 0.402 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.2 all KL = 0.449 +- 0.402 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.2 all L1 = 0.539 +- 0.318 (in-sample avg dev_std = 0.486)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.902
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0416024
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.544
SUFF_SIMPLE for r=0.4 class 0.0 = 0.53 +- 0.391 (in-sample avg dev_std = 0.497)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.454 +- 0.391 (in-sample avg dev_std = 0.497)
SUFF_SIMPLE for r=0.4 all KL = 0.393 +- 0.391 (in-sample avg dev_std = 0.497)
SUFF_SIMPLE for r=0.4 all L1 = 0.492 +- 0.313 (in-sample avg dev_std = 0.497)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.902
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0228274
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.494
SUFF_SIMPLE for r=0.8 class 0.0 = 0.579 +- 0.414 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.444 +- 0.414 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 all KL = 0.447 +- 0.414 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 all L1 = 0.511 +- 0.348 (in-sample avg dev_std = 0.203)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.653
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2594706
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.576
SUFF_SIMPLE for r=0.05 class 0.0 = 0.805 +- 0.372 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.658 +- 0.372 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.05 all KL = 0.707 +- 0.372 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.05 all L1 = 0.732 +- 0.310 (in-sample avg dev_std = 0.232)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.653
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.201044
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.577
SUFF_SIMPLE for r=0.1 class 0.0 = 0.801 +- 0.373 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.658 +- 0.373 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 all KL = 0.704 +- 0.373 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 all L1 = 0.73 +- 0.313 (in-sample avg dev_std = 0.218)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.653
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459106
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.581
SUFF_SIMPLE for r=0.2 class 0.0 = 0.802 +- 0.371 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.666 +- 0.371 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.2 all KL = 0.708 +- 0.371 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.2 all L1 = 0.735 +- 0.310 (in-sample avg dev_std = 0.208)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.653
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1083908
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.569
SUFF_SIMPLE for r=0.4 class 0.0 = 0.82 +- 0.369 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.666 +- 0.369 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 all KL = 0.726 +- 0.369 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 all L1 = 0.744 +- 0.315 (in-sample avg dev_std = 0.186)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.653
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.097769
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.614
SUFF_SIMPLE for r=0.8 class 0.0 = 0.914 +- 0.291 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.778 +- 0.291 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.8 all KL = 0.858 +- 0.291 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.8 all L1 = 0.847 +- 0.265 (in-sample avg dev_std = 0.003)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387144
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.688
NEC for r=0.05 class 0.0 = 0.09 +- 0.448 (in-sample avg dev_std = 0.198)
NEC for r=0.05 class 1.0 = 0.489 +- 0.448 (in-sample avg dev_std = 0.198)
NEC for r=0.05 all KL = 0.351 +- 0.448 (in-sample avg dev_std = 0.198)
NEC for r=0.05 all L1 = 0.311 +- 0.369 (in-sample avg dev_std = 0.198)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35862
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.768
NEC for r=0.1 class 0.0 = 0.138 +- 0.402 (in-sample avg dev_std = 0.338)
NEC for r=0.1 class 1.0 = 0.352 +- 0.402 (in-sample avg dev_std = 0.338)
NEC for r=0.1 all KL = 0.33 +- 0.402 (in-sample avg dev_std = 0.338)
NEC for r=0.1 all L1 = 0.257 +- 0.307 (in-sample avg dev_std = 0.338)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254072
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.881
NEC for r=0.2 class 0.0 = 0.199 +- 0.326 (in-sample avg dev_std = 0.305)
NEC for r=0.2 class 1.0 = 0.118 +- 0.326 (in-sample avg dev_std = 0.305)
NEC for r=0.2 all KL = 0.199 +- 0.326 (in-sample avg dev_std = 0.305)
NEC for r=0.2 all L1 = 0.154 +- 0.231 (in-sample avg dev_std = 0.305)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.16170400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.915
NEC for r=0.4 class 0.0 = 0.204 +- 0.300 (in-sample avg dev_std = 0.309)
NEC for r=0.4 class 1.0 = 0.064 +- 0.300 (in-sample avg dev_std = 0.309)
NEC for r=0.4 all KL = 0.165 +- 0.300 (in-sample avg dev_std = 0.309)
NEC for r=0.4 all L1 = 0.127 +- 0.208 (in-sample avg dev_std = 0.309)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11291000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.914
NEC for r=0.8 class 0.0 = 0.21 +- 0.300 (in-sample avg dev_std = 0.321)
NEC for r=0.8 class 1.0 = 0.053 +- 0.300 (in-sample avg dev_std = 0.321)
NEC for r=0.8 all KL = 0.167 +- 0.300 (in-sample avg dev_std = 0.321)
NEC for r=0.8 all L1 = 0.123 +- 0.205 (in-sample avg dev_std = 0.321)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.902
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2534924
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
NEC for r=0.05 class 0.0 = 0.113 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.781 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.477 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.449 +- 0.397 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.902
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1439618
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.551
NEC for r=0.1 class 0.0 = 0.131 +- 0.429 (in-sample avg dev_std = 0.311)
NEC for r=0.1 class 1.0 = 0.721 +- 0.429 (in-sample avg dev_std = 0.311)
NEC for r=0.1 all KL = 0.473 +- 0.429 (in-sample avg dev_std = 0.311)
NEC for r=0.1 all L1 = 0.428 +- 0.372 (in-sample avg dev_std = 0.311)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.902
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0783842
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.833
NEC for r=0.2 class 0.0 = 0.14 +- 0.323 (in-sample avg dev_std = 0.450)
NEC for r=0.2 class 1.0 = 0.321 +- 0.323 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all KL = 0.308 +- 0.323 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all L1 = 0.231 +- 0.222 (in-sample avg dev_std = 0.450)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.902
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0416024
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.875
NEC for r=0.4 class 0.0 = 0.165 +- 0.336 (in-sample avg dev_std = 0.358)
NEC for r=0.4 class 1.0 = 0.203 +- 0.336 (in-sample avg dev_std = 0.358)
NEC for r=0.4 all KL = 0.251 +- 0.336 (in-sample avg dev_std = 0.358)
NEC for r=0.4 all L1 = 0.184 +- 0.205 (in-sample avg dev_std = 0.358)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.902
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0228274
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.889
NEC for r=0.8 class 0.0 = 0.182 +- 0.350 (in-sample avg dev_std = 0.335)
NEC for r=0.8 class 1.0 = 0.182 +- 0.350 (in-sample avg dev_std = 0.335)
NEC for r=0.8 all KL = 0.251 +- 0.350 (in-sample avg dev_std = 0.335)
NEC for r=0.8 all L1 = 0.182 +- 0.211 (in-sample avg dev_std = 0.335)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.653
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2594706
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.597
NEC for r=0.05 class 0.0 = 0.063 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.171 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.096 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.116 +- 0.235 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.653
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.201044
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.571
NEC for r=0.1 class 0.0 = 0.074 +- 0.282 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.209 +- 0.282 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.123 +- 0.282 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.141 +- 0.264 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.653
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459106
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.565
NEC for r=0.2 class 0.0 = 0.089 +- 0.286 (in-sample avg dev_std = 0.091)
NEC for r=0.2 class 1.0 = 0.21 +- 0.286 (in-sample avg dev_std = 0.091)
NEC for r=0.2 all KL = 0.13 +- 0.286 (in-sample avg dev_std = 0.091)
NEC for r=0.2 all L1 = 0.149 +- 0.265 (in-sample avg dev_std = 0.091)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.653
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1083908
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.625
NEC for r=0.4 class 0.0 = 0.124 +- 0.268 (in-sample avg dev_std = 0.190)
NEC for r=0.4 class 1.0 = 0.18 +- 0.268 (in-sample avg dev_std = 0.190)
NEC for r=0.4 all KL = 0.139 +- 0.268 (in-sample avg dev_std = 0.190)
NEC for r=0.4 all L1 = 0.152 +- 0.243 (in-sample avg dev_std = 0.190)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.653
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.097769
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.634
NEC for r=0.8 class 0.0 = 0.134 +- 0.259 (in-sample avg dev_std = 0.195)
NEC for r=0.8 class 1.0 = 0.173 +- 0.259 (in-sample avg dev_std = 0.195)
NEC for r=0.8 all KL = 0.142 +- 0.259 (in-sample avg dev_std = 0.195)
NEC for r=0.8 all L1 = 0.153 +- 0.238 (in-sample avg dev_std = 0.195)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:54:33 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 07:54:33 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 07:54:33 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:54:33 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 07:54:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:54:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:54:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:54:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:54:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:54:33 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:54:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0222
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0180
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0294
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0180
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0294

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0222
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0180
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0294
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0180
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0294

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9920 0.9920[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.372
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.356
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.258
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.160
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.109
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.146
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.081
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.044
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.024
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.014
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.187
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.154
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.117
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.094
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.087


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.372034
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.705
SUFF_SIMPLE for r=0.05 class 0.0 = 0.542 +- 0.440 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.765 +- 0.440 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.05 all KL = 0.522 +- 0.440 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.05 all L1 = 0.665 +- 0.332 (in-sample avg dev_std = 0.457)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.355744
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.699
SUFF_SIMPLE for r=0.1 class 0.0 = 0.54 +- 0.441 (in-sample avg dev_std = 0.430)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.789 +- 0.441 (in-sample avg dev_std = 0.430)
SUFF_SIMPLE for r=0.1 all KL = 0.553 +- 0.441 (in-sample avg dev_std = 0.430)
SUFF_SIMPLE for r=0.1 all L1 = 0.678 +- 0.338 (in-sample avg dev_std = 0.430)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.258336
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.704
SUFF_SIMPLE for r=0.2 class 0.0 = 0.546 +- 0.439 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.764 +- 0.439 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.2 all KL = 0.525 +- 0.439 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.2 all L1 = 0.667 +- 0.332 (in-sample avg dev_std = 0.459)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.160152
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.686
SUFF_SIMPLE for r=0.4 class 0.0 = 0.544 +- 0.434 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.747 +- 0.434 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.4 all KL = 0.501 +- 0.434 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.4 all L1 = 0.657 +- 0.329 (in-sample avg dev_std = 0.468)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10936000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.687
SUFF_SIMPLE for r=0.8 class 0.0 = 0.694 +- 0.450 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.644 +- 0.450 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.8 all KL = 0.547 +- 0.450 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.8 all L1 = 0.666 +- 0.350 (in-sample avg dev_std = 0.345)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.959
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.14637360000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.593
SUFF_SIMPLE for r=0.05 class 0.0 = 0.658 +- 0.457 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.522 +- 0.457 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.05 all KL = 0.392 +- 0.457 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.05 all L1 = 0.589 +- 0.355 (in-sample avg dev_std = 0.523)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.959
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0810178
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.589
SUFF_SIMPLE for r=0.1 class 0.0 = 0.663 +- 0.458 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.512 +- 0.458 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.1 all KL = 0.393 +- 0.458 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.1 all L1 = 0.587 +- 0.356 (in-sample avg dev_std = 0.523)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.959
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.043623199999999994
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.581
SUFF_SIMPLE for r=0.2 class 0.0 = 0.667 +- 0.455 (in-sample avg dev_std = 0.532)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.491 +- 0.455 (in-sample avg dev_std = 0.532)
SUFF_SIMPLE for r=0.2 all KL = 0.383 +- 0.455 (in-sample avg dev_std = 0.532)
SUFF_SIMPLE for r=0.2 all L1 = 0.578 +- 0.355 (in-sample avg dev_std = 0.532)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.959
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0235914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.537
SUFF_SIMPLE for r=0.4 class 0.0 = 0.671 +- 0.448 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.41 +- 0.448 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.4 all KL = 0.347 +- 0.448 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.4 all L1 = 0.54 +- 0.355 (in-sample avg dev_std = 0.549)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.959
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.014064600000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.439
SUFF_SIMPLE for r=0.8 class 0.0 = 0.733 +- 0.464 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.282 +- 0.464 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.8 all KL = 0.388 +- 0.464 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.8 all L1 = 0.506 +- 0.398 (in-sample avg dev_std = 0.211)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.66
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1865096
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.595
SUFF_SIMPLE for r=0.05 class 0.0 = 0.762 +- 0.396 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.682 +- 0.396 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.05 all KL = 0.664 +- 0.396 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.05 all L1 = 0.722 +- 0.311 (in-sample avg dev_std = 0.271)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.66
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.15397539999999998
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.606
SUFF_SIMPLE for r=0.1 class 0.0 = 0.765 +- 0.395 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.69 +- 0.395 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.1 all KL = 0.666 +- 0.395 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.1 all L1 = 0.728 +- 0.309 (in-sample avg dev_std = 0.264)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.66
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1173838
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.603
SUFF_SIMPLE for r=0.2 class 0.0 = 0.777 +- 0.381 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.711 +- 0.381 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.2 all KL = 0.687 +- 0.381 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.2 all L1 = 0.744 +- 0.304 (in-sample avg dev_std = 0.259)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.66
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0939026
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.58
SUFF_SIMPLE for r=0.4 class 0.0 = 0.796 +- 0.387 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.69 +- 0.387 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.4 all KL = 0.701 +- 0.387 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.4 all L1 = 0.744 +- 0.317 (in-sample avg dev_std = 0.252)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.661
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08671319999999999
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.617
SUFF_SIMPLE for r=0.8 class 0.0 = 0.93 +- 0.306 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.778 +- 0.306 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 all KL = 0.853 +- 0.306 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 all L1 = 0.855 +- 0.266 (in-sample avg dev_std = 0.030)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.372034
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.676
NEC for r=0.05 class 0.0 = 0.134 +- 0.464 (in-sample avg dev_std = 0.209)
NEC for r=0.05 class 1.0 = 0.431 +- 0.464 (in-sample avg dev_std = 0.209)
NEC for r=0.05 all KL = 0.368 +- 0.464 (in-sample avg dev_std = 0.209)
NEC for r=0.05 all L1 = 0.299 +- 0.381 (in-sample avg dev_std = 0.209)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.355744
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.751
NEC for r=0.1 class 0.0 = 0.225 +- 0.447 (in-sample avg dev_std = 0.374)
NEC for r=0.1 class 1.0 = 0.288 +- 0.447 (in-sample avg dev_std = 0.374)
NEC for r=0.1 all KL = 0.369 +- 0.447 (in-sample avg dev_std = 0.374)
NEC for r=0.1 all L1 = 0.26 +- 0.333 (in-sample avg dev_std = 0.374)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.258336
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.808
NEC for r=0.2 class 0.0 = 0.309 +- 0.413 (in-sample avg dev_std = 0.365)
NEC for r=0.2 class 1.0 = 0.124 +- 0.413 (in-sample avg dev_std = 0.365)
NEC for r=0.2 all KL = 0.297 +- 0.413 (in-sample avg dev_std = 0.365)
NEC for r=0.2 all L1 = 0.206 +- 0.303 (in-sample avg dev_std = 0.365)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.160152
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.85
NEC for r=0.4 class 0.0 = 0.312 +- 0.379 (in-sample avg dev_std = 0.364)
NEC for r=0.4 class 1.0 = 0.043 +- 0.379 (in-sample avg dev_std = 0.364)
NEC for r=0.4 all KL = 0.238 +- 0.379 (in-sample avg dev_std = 0.364)
NEC for r=0.4 all L1 = 0.163 +- 0.273 (in-sample avg dev_std = 0.364)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10936000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.866
NEC for r=0.8 class 0.0 = 0.298 +- 0.374 (in-sample avg dev_std = 0.376)
NEC for r=0.8 class 1.0 = 0.045 +- 0.374 (in-sample avg dev_std = 0.376)
NEC for r=0.8 all KL = 0.235 +- 0.374 (in-sample avg dev_std = 0.376)
NEC for r=0.8 all L1 = 0.158 +- 0.262 (in-sample avg dev_std = 0.376)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.959
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.14637360000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.596
NEC for r=0.05 class 0.0 = 0.056 +- 0.469 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.637 +- 0.469 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.406 +- 0.469 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.349 +- 0.403 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.959
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0810178
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.626
NEC for r=0.1 class 0.0 = 0.215 +- 0.466 (in-sample avg dev_std = 0.383)
NEC for r=0.1 class 1.0 = 0.508 +- 0.466 (in-sample avg dev_std = 0.383)
NEC for r=0.1 all KL = 0.5 +- 0.466 (in-sample avg dev_std = 0.383)
NEC for r=0.1 all L1 = 0.363 +- 0.369 (in-sample avg dev_std = 0.383)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.959
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.043623199999999994
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.8
NEC for r=0.2 class 0.0 = 0.316 +- 0.435 (in-sample avg dev_std = 0.489)
NEC for r=0.2 class 1.0 = 0.161 +- 0.435 (in-sample avg dev_std = 0.489)
NEC for r=0.2 all KL = 0.416 +- 0.435 (in-sample avg dev_std = 0.489)
NEC for r=0.2 all L1 = 0.238 +- 0.283 (in-sample avg dev_std = 0.489)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.959
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0235914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.816
NEC for r=0.4 class 0.0 = 0.313 +- 0.422 (in-sample avg dev_std = 0.455)
NEC for r=0.4 class 1.0 = 0.114 +- 0.422 (in-sample avg dev_std = 0.455)
NEC for r=0.4 all KL = 0.342 +- 0.422 (in-sample avg dev_std = 0.455)
NEC for r=0.4 all L1 = 0.212 +- 0.284 (in-sample avg dev_std = 0.455)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.959
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.014064600000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.839
NEC for r=0.8 class 0.0 = 0.269 +- 0.426 (in-sample avg dev_std = 0.451)
NEC for r=0.8 class 1.0 = 0.119 +- 0.426 (in-sample avg dev_std = 0.451)
NEC for r=0.8 all KL = 0.317 +- 0.426 (in-sample avg dev_std = 0.451)
NEC for r=0.8 all L1 = 0.193 +- 0.277 (in-sample avg dev_std = 0.451)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.66
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1865096
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.578
NEC for r=0.05 class 0.0 = 0.065 +- 0.298 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.204 +- 0.298 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.127 +- 0.298 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.134 +- 0.272 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.66
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.15397539999999998
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.552
NEC for r=0.1 class 0.0 = 0.08 +- 0.333 (in-sample avg dev_std = 0.004)
NEC for r=0.1 class 1.0 = 0.251 +- 0.333 (in-sample avg dev_std = 0.004)
NEC for r=0.1 all KL = 0.162 +- 0.333 (in-sample avg dev_std = 0.004)
NEC for r=0.1 all L1 = 0.164 +- 0.299 (in-sample avg dev_std = 0.004)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.66
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1173838
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.576
NEC for r=0.2 class 0.0 = 0.102 +- 0.335 (in-sample avg dev_std = 0.183)
NEC for r=0.2 class 1.0 = 0.245 +- 0.335 (in-sample avg dev_std = 0.183)
NEC for r=0.2 all KL = 0.178 +- 0.335 (in-sample avg dev_std = 0.183)
NEC for r=0.2 all L1 = 0.173 +- 0.294 (in-sample avg dev_std = 0.183)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.66
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0939026
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.625
NEC for r=0.4 class 0.0 = 0.146 +- 0.312 (in-sample avg dev_std = 0.214)
NEC for r=0.4 class 1.0 = 0.165 +- 0.312 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all KL = 0.168 +- 0.312 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all L1 = 0.155 +- 0.265 (in-sample avg dev_std = 0.214)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.66
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08671319999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.646
NEC for r=0.8 class 0.0 = 0.169 +- 0.307 (in-sample avg dev_std = 0.218)
NEC for r=0.8 class 1.0 = 0.173 +- 0.307 (in-sample avg dev_std = 0.218)
NEC for r=0.8 all KL = 0.182 +- 0.307 (in-sample avg dev_std = 0.218)
NEC for r=0.8 all L1 = 0.171 +- 0.263 (in-sample avg dev_std = 0.218)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 08:09:44 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:09:44 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:09:44 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:09:44 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:09:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:09:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:09:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:09:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:09:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:09:44 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:09:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9865
Train Loss: 0.0472
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0524
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0595
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0524
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0595

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9865
Train Loss: 0.0472
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0524
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0595
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0524
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0595

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.367
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.347
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.254
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.164
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.113
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.243
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.140
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.077
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.042
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.024
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.285
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.216
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.151
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.114
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.101


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.36747199999999997
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.699
SUFF_SIMPLE for r=0.05 class 0.0 = 0.54 +- 0.411 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.746 +- 0.411 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.05 all KL = 0.564 +- 0.411 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.05 all L1 = 0.654 +- 0.318 (in-sample avg dev_std = 0.426)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.34686
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.688
SUFF_SIMPLE for r=0.1 class 0.0 = 0.534 +- 0.415 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.741 +- 0.415 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.1 all KL = 0.556 +- 0.415 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.1 all L1 = 0.649 +- 0.322 (in-sample avg dev_std = 0.422)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25358600000000003
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.688
SUFF_SIMPLE for r=0.2 class 0.0 = 0.539 +- 0.412 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.73 +- 0.412 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.2 all KL = 0.553 +- 0.412 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.2 all L1 = 0.645 +- 0.322 (in-sample avg dev_std = 0.422)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.163798
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.698
SUFF_SIMPLE for r=0.4 class 0.0 = 0.548 +- 0.399 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.725 +- 0.399 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.4 all KL = 0.553 +- 0.399 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.4 all L1 = 0.646 +- 0.313 (in-sample avg dev_std = 0.410)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.113434
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.735
SUFF_SIMPLE for r=0.8 class 0.0 = 0.67 +- 0.402 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.689 +- 0.402 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.8 all KL = 0.607 +- 0.402 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.8 all L1 = 0.68 +- 0.310 (in-sample avg dev_std = 0.343)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.24262579999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.619
SUFF_SIMPLE for r=0.05 class 0.0 = 0.669 +- 0.412 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.631 +- 0.412 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.05 all KL = 0.572 +- 0.412 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.05 all L1 = 0.65 +- 0.312 (in-sample avg dev_std = 0.362)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13994340000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.613
SUFF_SIMPLE for r=0.1 class 0.0 = 0.671 +- 0.413 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.62 +- 0.413 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.1 all KL = 0.566 +- 0.413 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.1 all L1 = 0.645 +- 0.314 (in-sample avg dev_std = 0.353)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0773724
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.598
SUFF_SIMPLE for r=0.2 class 0.0 = 0.681 +- 0.413 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.587 +- 0.413 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.2 all KL = 0.547 +- 0.413 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.2 all L1 = 0.633 +- 0.316 (in-sample avg dev_std = 0.356)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0415842
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.551
SUFF_SIMPLE for r=0.4 class 0.0 = 0.695 +- 0.411 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.49 +- 0.411 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.4 all KL = 0.49 +- 0.411 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.4 all L1 = 0.592 +- 0.321 (in-sample avg dev_std = 0.383)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0236292
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.486
SUFF_SIMPLE for r=0.8 class 0.0 = 0.79 +- 0.426 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.374 +- 0.426 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.8 all KL = 0.511 +- 0.426 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.8 all L1 = 0.58 +- 0.360 (in-sample avg dev_std = 0.148)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.685
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2845954
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.593
SUFF_SIMPLE for r=0.05 class 0.0 = 0.8 +- 0.383 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.657 +- 0.383 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.05 all KL = 0.703 +- 0.383 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.05 all L1 = 0.729 +- 0.317 (in-sample avg dev_std = 0.243)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.685
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.21607020000000002
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.581
SUFF_SIMPLE for r=0.1 class 0.0 = 0.796 +- 0.386 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.654 +- 0.386 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.1 all KL = 0.701 +- 0.386 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.1 all L1 = 0.726 +- 0.323 (in-sample avg dev_std = 0.219)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.685
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15108020000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.58
SUFF_SIMPLE for r=0.2 class 0.0 = 0.799 +- 0.386 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.652 +- 0.386 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.2 all KL = 0.701 +- 0.386 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.2 all L1 = 0.726 +- 0.324 (in-sample avg dev_std = 0.213)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.685
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11358539999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.579
SUFF_SIMPLE for r=0.4 class 0.0 = 0.826 +- 0.376 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.657 +- 0.376 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.4 all KL = 0.722 +- 0.376 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.4 all L1 = 0.742 +- 0.317 (in-sample avg dev_std = 0.209)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.686
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1012918
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.655
SUFF_SIMPLE for r=0.8 class 0.0 = 0.915 +- 0.292 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.755 +- 0.292 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.8 all KL = 0.847 +- 0.292 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.8 all L1 = 0.836 +- 0.267 (in-sample avg dev_std = 0.035)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.36747199999999997
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.658
NEC for r=0.05 class 0.0 = 0.182 +- 0.444 (in-sample avg dev_std = 0.219)
NEC for r=0.05 class 1.0 = 0.451 +- 0.444 (in-sample avg dev_std = 0.219)
NEC for r=0.05 all KL = 0.374 +- 0.444 (in-sample avg dev_std = 0.219)
NEC for r=0.05 all L1 = 0.331 +- 0.369 (in-sample avg dev_std = 0.219)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.34686
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.723
NEC for r=0.1 class 0.0 = 0.297 +- 0.411 (in-sample avg dev_std = 0.385)
NEC for r=0.1 class 1.0 = 0.305 +- 0.411 (in-sample avg dev_std = 0.385)
NEC for r=0.1 all KL = 0.374 +- 0.411 (in-sample avg dev_std = 0.385)
NEC for r=0.1 all L1 = 0.301 +- 0.318 (in-sample avg dev_std = 0.385)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25358600000000003
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.787
NEC for r=0.2 class 0.0 = 0.343 +- 0.395 (in-sample avg dev_std = 0.397)
NEC for r=0.2 class 1.0 = 0.183 +- 0.395 (in-sample avg dev_std = 0.397)
NEC for r=0.2 all KL = 0.31 +- 0.395 (in-sample avg dev_std = 0.397)
NEC for r=0.2 all L1 = 0.254 +- 0.295 (in-sample avg dev_std = 0.397)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.163798
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.831
NEC for r=0.4 class 0.0 = 0.334 +- 0.378 (in-sample avg dev_std = 0.405)
NEC for r=0.4 class 1.0 = 0.106 +- 0.378 (in-sample avg dev_std = 0.405)
NEC for r=0.4 all KL = 0.259 +- 0.378 (in-sample avg dev_std = 0.405)
NEC for r=0.4 all L1 = 0.208 +- 0.271 (in-sample avg dev_std = 0.405)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.113434
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.856
NEC for r=0.8 class 0.0 = 0.31 +- 0.356 (in-sample avg dev_std = 0.395)
NEC for r=0.8 class 1.0 = 0.085 +- 0.356 (in-sample avg dev_std = 0.395)
NEC for r=0.8 all KL = 0.236 +- 0.356 (in-sample avg dev_std = 0.395)
NEC for r=0.8 all L1 = 0.185 +- 0.252 (in-sample avg dev_std = 0.395)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.24262579999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.483
NEC for r=0.05 class 0.0 = 0.062 +- 0.436 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.724 +- 0.436 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.419 +- 0.436 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.396 +- 0.387 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13994340000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.51
NEC for r=0.1 class 0.0 = 0.089 +- 0.425 (in-sample avg dev_std = 0.251)
NEC for r=0.1 class 1.0 = 0.694 +- 0.425 (in-sample avg dev_std = 0.251)
NEC for r=0.1 all KL = 0.456 +- 0.425 (in-sample avg dev_std = 0.251)
NEC for r=0.1 all L1 = 0.394 +- 0.366 (in-sample avg dev_std = 0.251)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0773724
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.684
NEC for r=0.2 class 0.0 = 0.236 +- 0.383 (in-sample avg dev_std = 0.516)
NEC for r=0.2 class 1.0 = 0.393 +- 0.383 (in-sample avg dev_std = 0.516)
NEC for r=0.2 all KL = 0.439 +- 0.383 (in-sample avg dev_std = 0.516)
NEC for r=0.2 all L1 = 0.315 +- 0.248 (in-sample avg dev_std = 0.516)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0415842
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.754
NEC for r=0.4 class 0.0 = 0.245 +- 0.382 (in-sample avg dev_std = 0.433)
NEC for r=0.4 class 1.0 = 0.227 +- 0.382 (in-sample avg dev_std = 0.433)
NEC for r=0.4 all KL = 0.313 +- 0.382 (in-sample avg dev_std = 0.433)
NEC for r=0.4 all L1 = 0.236 +- 0.234 (in-sample avg dev_std = 0.433)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0236292
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.8
NEC for r=0.8 class 0.0 = 0.203 +- 0.372 (in-sample avg dev_std = 0.373)
NEC for r=0.8 class 1.0 = 0.172 +- 0.372 (in-sample avg dev_std = 0.373)
NEC for r=0.8 all KL = 0.257 +- 0.372 (in-sample avg dev_std = 0.373)
NEC for r=0.8 all L1 = 0.187 +- 0.213 (in-sample avg dev_std = 0.373)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.685
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2845954
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.583
NEC for r=0.05 class 0.0 = 0.072 +- 0.299 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.22 +- 0.299 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.133 +- 0.299 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.145 +- 0.274 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.685
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.21607020000000002
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.55
NEC for r=0.1 class 0.0 = 0.083 +- 0.331 (in-sample avg dev_std = 0.009)
NEC for r=0.1 class 1.0 = 0.266 +- 0.331 (in-sample avg dev_std = 0.009)
NEC for r=0.1 all KL = 0.164 +- 0.331 (in-sample avg dev_std = 0.009)
NEC for r=0.1 all L1 = 0.174 +- 0.298 (in-sample avg dev_std = 0.009)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.685
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15108020000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.569
NEC for r=0.2 class 0.0 = 0.104 +- 0.323 (in-sample avg dev_std = 0.168)
NEC for r=0.2 class 1.0 = 0.246 +- 0.323 (in-sample avg dev_std = 0.168)
NEC for r=0.2 all KL = 0.166 +- 0.323 (in-sample avg dev_std = 0.168)
NEC for r=0.2 all L1 = 0.174 +- 0.284 (in-sample avg dev_std = 0.168)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.685
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11358539999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.635
NEC for r=0.4 class 0.0 = 0.122 +- 0.276 (in-sample avg dev_std = 0.224)
NEC for r=0.4 class 1.0 = 0.167 +- 0.276 (in-sample avg dev_std = 0.224)
NEC for r=0.4 all KL = 0.142 +- 0.276 (in-sample avg dev_std = 0.224)
NEC for r=0.4 all L1 = 0.144 +- 0.232 (in-sample avg dev_std = 0.224)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.685
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1012918
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.651
NEC for r=0.8 class 0.0 = 0.131 +- 0.258 (in-sample avg dev_std = 0.204)
NEC for r=0.8 class 1.0 = 0.148 +- 0.258 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all KL = 0.131 +- 0.258 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all L1 = 0.14 +- 0.225 (in-sample avg dev_std = 0.204)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 08:24:48 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:24:48 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:24:48 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:24:48 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:24:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:24:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:24:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:24:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:24:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:24:48 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:24:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9830
Train Loss: 0.0549
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0538
ID Test ACCURACY: 0.9780
ID Test Loss: 0.0652
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0538
OOD Test ACCURACY: 0.9780
OOD Test Loss: 0.0652

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9830
Train Loss: 0.0549
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0538
ID Test ACCURACY: 0.9780
ID Test Loss: 0.0652
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0538
OOD Test ACCURACY: 0.9780
OOD Test Loss: 0.0652

[0m[1;37mINFO[0m: [1mChartInfo 0.9780 0.9780 0.9780 0.9780 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.395
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.364
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.259
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.159
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.109
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.294
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.169
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.092
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.049
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.026
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.304
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.229
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.157
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.116
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.102


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39454
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.72
SUFF_SIMPLE for r=0.05 class 0.0 = 0.611 +- 0.409 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.736 +- 0.409 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.05 all KL = 0.594 +- 0.409 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.05 all L1 = 0.68 +- 0.302 (in-sample avg dev_std = 0.449)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.364388
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.713
SUFF_SIMPLE for r=0.1 class 0.0 = 0.614 +- 0.412 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.732 +- 0.412 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 all KL = 0.593 +- 0.412 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 all L1 = 0.679 +- 0.306 (in-sample avg dev_std = 0.438)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25869400000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.705
SUFF_SIMPLE for r=0.2 class 0.0 = 0.62 +- 0.414 (in-sample avg dev_std = 0.430)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.726 +- 0.414 (in-sample avg dev_std = 0.430)
SUFF_SIMPLE for r=0.2 all KL = 0.596 +- 0.414 (in-sample avg dev_std = 0.430)
SUFF_SIMPLE for r=0.2 all L1 = 0.679 +- 0.309 (in-sample avg dev_std = 0.430)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.159314
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.721
SUFF_SIMPLE for r=0.4 class 0.0 = 0.625 +- 0.407 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.715 +- 0.407 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.4 all KL = 0.591 +- 0.407 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.4 all L1 = 0.675 +- 0.305 (in-sample avg dev_std = 0.435)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10906999999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.727
SUFF_SIMPLE for r=0.8 class 0.0 = 0.747 +- 0.404 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.658 +- 0.404 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.8 all KL = 0.64 +- 0.404 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.8 all L1 = 0.698 +- 0.324 (in-sample avg dev_std = 0.310)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.615
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.294444
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.609
SUFF_SIMPLE for r=0.05 class 0.0 = 0.866 +- 0.352 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.721 +- 0.352 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.05 all KL = 0.735 +- 0.352 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.05 all L1 = 0.793 +- 0.257 (in-sample avg dev_std = 0.263)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.615
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.16908679999999998
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.604
SUFF_SIMPLE for r=0.1 class 0.0 = 0.867 +- 0.348 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.726 +- 0.348 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.1 all KL = 0.742 +- 0.348 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.1 all L1 = 0.796 +- 0.257 (in-sample avg dev_std = 0.262)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.615
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0923886
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.593
SUFF_SIMPLE for r=0.2 class 0.0 = 0.872 +- 0.347 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.726 +- 0.347 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.2 all KL = 0.744 +- 0.347 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.2 all L1 = 0.798 +- 0.257 (in-sample avg dev_std = 0.258)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.615
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0488908
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.561
SUFF_SIMPLE for r=0.4 class 0.0 = 0.877 +- 0.349 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.711 +- 0.349 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.4 all KL = 0.737 +- 0.349 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.4 all L1 = 0.793 +- 0.265 (in-sample avg dev_std = 0.260)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.615
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0262106
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.486
SUFF_SIMPLE for r=0.8 class 0.0 = 0.92 +- 0.324 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.733 +- 0.324 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.8 all KL = 0.8 +- 0.324 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.8 all L1 = 0.826 +- 0.272 (in-sample avg dev_std = 0.045)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.659
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3040794
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.573
SUFF_SIMPLE for r=0.05 class 0.0 = 0.804 +- 0.382 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.646 +- 0.382 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.05 all KL = 0.707 +- 0.382 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.05 all L1 = 0.726 +- 0.318 (in-sample avg dev_std = 0.229)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.659
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.228566
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.572
SUFF_SIMPLE for r=0.1 class 0.0 = 0.801 +- 0.383 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.646 +- 0.383 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.1 all KL = 0.707 +- 0.383 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.1 all L1 = 0.725 +- 0.323 (in-sample avg dev_std = 0.211)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.659
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15688000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.572
SUFF_SIMPLE for r=0.2 class 0.0 = 0.811 +- 0.381 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.643 +- 0.381 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.2 all KL = 0.711 +- 0.381 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.2 all L1 = 0.728 +- 0.320 (in-sample avg dev_std = 0.201)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11550140000000002
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.586
SUFF_SIMPLE for r=0.4 class 0.0 = 0.851 +- 0.367 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.649 +- 0.367 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.4 all KL = 0.738 +- 0.367 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.4 all L1 = 0.751 +- 0.310 (in-sample avg dev_std = 0.198)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.66
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10218020000000001
len(reference) = 4990
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.652
SUFF_SIMPLE for r=0.8 class 0.0 = 0.914 +- 0.302 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.736 +- 0.302 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.8 all KL = 0.838 +- 0.302 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.8 all L1 = 0.826 +- 0.276 (in-sample avg dev_std = 0.023)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39454
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.633
NEC for r=0.05 class 0.0 = 0.15 +- 0.452 (in-sample avg dev_std = 0.185)
NEC for r=0.05 class 1.0 = 0.49 +- 0.452 (in-sample avg dev_std = 0.185)
NEC for r=0.05 all KL = 0.377 +- 0.452 (in-sample avg dev_std = 0.185)
NEC for r=0.05 all L1 = 0.339 +- 0.379 (in-sample avg dev_std = 0.185)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.364388
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.709
NEC for r=0.1 class 0.0 = 0.242 +- 0.420 (in-sample avg dev_std = 0.378)
NEC for r=0.1 class 1.0 = 0.358 +- 0.420 (in-sample avg dev_std = 0.378)
NEC for r=0.1 all KL = 0.38 +- 0.420 (in-sample avg dev_std = 0.378)
NEC for r=0.1 all L1 = 0.306 +- 0.324 (in-sample avg dev_std = 0.378)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25869400000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.82
NEC for r=0.2 class 0.0 = 0.264 +- 0.385 (in-sample avg dev_std = 0.379)
NEC for r=0.2 class 1.0 = 0.177 +- 0.385 (in-sample avg dev_std = 0.379)
NEC for r=0.2 all KL = 0.272 +- 0.385 (in-sample avg dev_std = 0.379)
NEC for r=0.2 all L1 = 0.216 +- 0.274 (in-sample avg dev_std = 0.379)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.159314
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.877
NEC for r=0.4 class 0.0 = 0.249 +- 0.347 (in-sample avg dev_std = 0.371)
NEC for r=0.4 class 1.0 = 0.089 +- 0.347 (in-sample avg dev_std = 0.371)
NEC for r=0.4 all KL = 0.213 +- 0.347 (in-sample avg dev_std = 0.371)
NEC for r=0.4 all L1 = 0.161 +- 0.230 (in-sample avg dev_std = 0.371)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10906999999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.878
NEC for r=0.8 class 0.0 = 0.245 +- 0.338 (in-sample avg dev_std = 0.371)
NEC for r=0.8 class 1.0 = 0.083 +- 0.338 (in-sample avg dev_std = 0.371)
NEC for r=0.8 all KL = 0.205 +- 0.338 (in-sample avg dev_std = 0.371)
NEC for r=0.8 all L1 = 0.155 +- 0.230 (in-sample avg dev_std = 0.371)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.615
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.294444
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.494
NEC for r=0.05 class 0.0 = 0.008 +- 0.273 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.29 +- 0.273 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.136 +- 0.273 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.15 +- 0.270 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.615
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.16908679999999998
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.019 +- 0.288 (in-sample avg dev_std = 0.089)
NEC for r=0.1 class 1.0 = 0.293 +- 0.288 (in-sample avg dev_std = 0.089)
NEC for r=0.1 all KL = 0.16 +- 0.288 (in-sample avg dev_std = 0.089)
NEC for r=0.1 all L1 = 0.157 +- 0.268 (in-sample avg dev_std = 0.089)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.615
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0923886
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.561
NEC for r=0.2 class 0.0 = 0.064 +- 0.304 (in-sample avg dev_std = 0.297)
NEC for r=0.2 class 1.0 = 0.239 +- 0.304 (in-sample avg dev_std = 0.297)
NEC for r=0.2 all KL = 0.203 +- 0.304 (in-sample avg dev_std = 0.297)
NEC for r=0.2 all L1 = 0.152 +- 0.209 (in-sample avg dev_std = 0.297)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.615
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0488908
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.599
NEC for r=0.4 class 0.0 = 0.069 +- 0.288 (in-sample avg dev_std = 0.278)
NEC for r=0.4 class 1.0 = 0.193 +- 0.288 (in-sample avg dev_std = 0.278)
NEC for r=0.4 all KL = 0.172 +- 0.288 (in-sample avg dev_std = 0.278)
NEC for r=0.4 all L1 = 0.132 +- 0.178 (in-sample avg dev_std = 0.278)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.615
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0262106
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.64
NEC for r=0.8 class 0.0 = 0.044 +- 0.249 (in-sample avg dev_std = 0.225)
NEC for r=0.8 class 1.0 = 0.188 +- 0.249 (in-sample avg dev_std = 0.225)
NEC for r=0.8 all KL = 0.133 +- 0.249 (in-sample avg dev_std = 0.225)
NEC for r=0.8 all L1 = 0.117 +- 0.167 (in-sample avg dev_std = 0.225)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.659
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3040794
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.574
NEC for r=0.05 class 0.0 = 0.077 +- 0.282 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.199 +- 0.282 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.123 +- 0.282 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.137 +- 0.262 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.659
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.228566
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.552
NEC for r=0.1 class 0.0 = 0.087 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.235 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.148 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.16 +- 0.284 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.659
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15688000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.552
NEC for r=0.2 class 0.0 = 0.101 +- 0.309 (in-sample avg dev_std = 0.112)
NEC for r=0.2 class 1.0 = 0.226 +- 0.309 (in-sample avg dev_std = 0.112)
NEC for r=0.2 all KL = 0.151 +- 0.309 (in-sample avg dev_std = 0.112)
NEC for r=0.2 all L1 = 0.163 +- 0.278 (in-sample avg dev_std = 0.112)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11550140000000002
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.628
NEC for r=0.4 class 0.0 = 0.114 +- 0.247 (in-sample avg dev_std = 0.216)
NEC for r=0.4 class 1.0 = 0.155 +- 0.247 (in-sample avg dev_std = 0.216)
NEC for r=0.4 all KL = 0.122 +- 0.247 (in-sample avg dev_std = 0.216)
NEC for r=0.4 all L1 = 0.134 +- 0.215 (in-sample avg dev_std = 0.216)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.659
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10218020000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.635
NEC for r=0.8 class 0.0 = 0.132 +- 0.255 (in-sample avg dev_std = 0.216)
NEC for r=0.8 class 1.0 = 0.157 +- 0.255 (in-sample avg dev_std = 0.216)
NEC for r=0.8 all KL = 0.132 +- 0.255 (in-sample avg dev_std = 0.216)
NEC for r=0.8 all L1 = 0.145 +- 0.224 (in-sample avg dev_std = 0.216)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.531, 0.528, 0.519, 0.5, 0.533], 'all_L1': [0.655, 0.649, 0.646, 0.636, 0.648]}), defaultdict(<class 'list'>, {'all_KL': [0.577, 0.574, 0.553, 0.576, 0.577], 'all_L1': [0.7, 0.697, 0.684, 0.702, 0.68]}), defaultdict(<class 'list'>, {'all_KL': [0.566, 0.547, 0.53, 0.54, 0.597], 'all_L1': [0.658, 0.646, 0.633, 0.641, 0.683]}), defaultdict(<class 'list'>, {'all_KL': [0.562, 0.572, 0.57, 0.579, 0.647], 'all_L1': [0.663, 0.668, 0.667, 0.672, 0.721]}), defaultdict(<class 'list'>, {'all_KL': [0.585, 0.597, 0.596, 0.596, 0.661], 'all_L1': [0.67, 0.678, 0.678, 0.678, 0.717]}), defaultdict(<class 'list'>, {'all_KL': [0.544, 0.54, 0.523, 0.487, 0.535], 'all_L1': [0.671, 0.667, 0.662, 0.645, 0.653]}), defaultdict(<class 'list'>, {'all_KL': [0.594, 0.598, 0.57, 0.575, 0.643], 'all_L1': [0.696, 0.698, 0.681, 0.678, 0.715]}), defaultdict(<class 'list'>, {'all_KL': [0.522, 0.553, 0.525, 0.501, 0.547], 'all_L1': [0.665, 0.678, 0.667, 0.657, 0.666]}), defaultdict(<class 'list'>, {'all_KL': [0.564, 0.556, 0.553, 0.553, 0.607], 'all_L1': [0.654, 0.649, 0.645, 0.646, 0.68]}), defaultdict(<class 'list'>, {'all_KL': [0.594, 0.593, 0.596, 0.591, 0.64], 'all_L1': [0.68, 0.679, 0.679, 0.675, 0.698]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.372, 0.367, 0.294, 0.248, 0.223], 'all_L1': [0.312, 0.265, 0.208, 0.184, 0.163]}), defaultdict(<class 'list'>, {'all_KL': [0.406, 0.419, 0.294, 0.237, 0.179], 'all_L1': [0.342, 0.3, 0.209, 0.164, 0.123]}), defaultdict(<class 'list'>, {'all_KL': [0.386, 0.341, 0.291, 0.267, 0.254], 'all_L1': [0.341, 0.273, 0.234, 0.202, 0.193]}), defaultdict(<class 'list'>, {'all_KL': [0.355, 0.432, 0.356, 0.28, 0.245], 'all_L1': [0.315, 0.324, 0.253, 0.201, 0.177]}), defaultdict(<class 'list'>, {'all_KL': [0.389, 0.458, 0.321, 0.227, 0.19], 'all_L1': [0.358, 0.36, 0.245, 0.179, 0.153]}), defaultdict(<class 'list'>, {'all_KL': [0.366, 0.347, 0.255, 0.231, 0.226], 'all_L1': [0.306, 0.248, 0.186, 0.165, 0.157]}), defaultdict(<class 'list'>, {'all_KL': [0.351, 0.33, 0.199, 0.165, 0.167], 'all_L1': [0.311, 0.257, 0.154, 0.127, 0.123]}), defaultdict(<class 'list'>, {'all_KL': [0.368, 0.369, 0.297, 0.238, 0.235], 'all_L1': [0.299, 0.26, 0.206, 0.163, 0.158]}), defaultdict(<class 'list'>, {'all_KL': [0.374, 0.374, 0.31, 0.259, 0.236], 'all_L1': [0.331, 0.301, 0.254, 0.208, 0.185]}), defaultdict(<class 'list'>, {'all_KL': [0.377, 0.38, 0.272, 0.213, 0.205], 'all_L1': [0.339, 0.306, 0.216, 0.161, 0.155]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.225, 0.22, 0.194, 0.146, 0.172], 'all_L1': [0.415, 0.407, 0.386, 0.332, 0.314]}), defaultdict(<class 'list'>, {'all_KL': [0.515, 0.509, 0.487, 0.44, 0.492], 'all_L1': [0.624, 0.619, 0.605, 0.576, 0.576]}), defaultdict(<class 'list'>, {'all_KL': [0.599, 0.598, 0.588, 0.552, 0.517], 'all_L1': [0.671, 0.67, 0.66, 0.632, 0.595]}), defaultdict(<class 'list'>, {'all_KL': [0.628, 0.636, 0.643, 0.631, 0.705], 'all_L1': [0.709, 0.713, 0.717, 0.709, 0.732]}), defaultdict(<class 'list'>, {'all_KL': [0.658, 0.666, 0.665, 0.649, 0.739], 'all_L1': [0.739, 0.745, 0.746, 0.729, 0.756]}), defaultdict(<class 'list'>, {'all_KL': [0.288, 0.277, 0.249, 0.19, 0.158], 'all_L1': [0.474, 0.463, 0.438, 0.381, 0.291]}), defaultdict(<class 'list'>, {'all_KL': [0.486, 0.473, 0.449, 0.393, 0.447], 'all_L1': [0.571, 0.558, 0.539, 0.492, 0.511]}), defaultdict(<class 'list'>, {'all_KL': [0.392, 0.393, 0.383, 0.347, 0.388], 'all_L1': [0.589, 0.587, 0.578, 0.54, 0.506]}), defaultdict(<class 'list'>, {'all_KL': [0.572, 0.566, 0.547, 0.49, 0.511], 'all_L1': [0.65, 0.645, 0.633, 0.592, 0.58]}), defaultdict(<class 'list'>, {'all_KL': [0.735, 0.742, 0.744, 0.737, 0.8], 'all_L1': [0.793, 0.796, 0.798, 0.793, 0.826]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.609, 0.548, 0.416, 0.351, 0.391], 'all_L1': [0.53, 0.381, 0.234, 0.248, 0.272]}), defaultdict(<class 'list'>, {'all_KL': [0.446, 0.495, 0.414, 0.309, 0.263], 'all_L1': [0.404, 0.399, 0.26, 0.204, 0.172]}), defaultdict(<class 'list'>, {'all_KL': [0.321, 0.284, 0.274, 0.237, 0.227], 'all_L1': [0.307, 0.257, 0.208, 0.177, 0.168]}), defaultdict(<class 'list'>, {'all_KL': [0.293, 0.329, 0.384, 0.341, 0.255], 'all_L1': [0.281, 0.291, 0.279, 0.247, 0.19]}), defaultdict(<class 'list'>, {'all_KL': [0.303, 0.319, 0.388, 0.344, 0.219], 'all_L1': [0.29, 0.293, 0.292, 0.239, 0.161]}), defaultdict(<class 'list'>, {'all_KL': [0.551, 0.533, 0.356, 0.293, 0.335], 'all_L1': [0.478, 0.358, 0.213, 0.218, 0.242]}), defaultdict(<class 'list'>, {'all_KL': [0.477, 0.473, 0.308, 0.251, 0.251], 'all_L1': [0.449, 0.428, 0.231, 0.184, 0.182]}), defaultdict(<class 'list'>, {'all_KL': [0.406, 0.5, 0.416, 0.342, 0.317], 'all_L1': [0.349, 0.363, 0.238, 0.212, 0.193]}), defaultdict(<class 'list'>, {'all_KL': [0.419, 0.456, 0.439, 0.313, 0.257], 'all_L1': [0.396, 0.394, 0.315, 0.236, 0.187]}), defaultdict(<class 'list'>, {'all_KL': [0.136, 0.16, 0.203, 0.172, 0.133], 'all_L1': [0.15, 0.157, 0.152, 0.132, 0.117]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.692, 0.692, 0.698, 0.719, 0.828], 'all_L1': [0.721, 0.722, 0.727, 0.741, 0.827]}), defaultdict(<class 'list'>, {'all_KL': [0.685, 0.682, 0.686, 0.706, 0.835], 'all_L1': [0.724, 0.723, 0.728, 0.74, 0.831]}), defaultdict(<class 'list'>, {'all_KL': [0.685, 0.684, 0.697, 0.726, 0.852], 'all_L1': [0.721, 0.719, 0.73, 0.751, 0.85]}), defaultdict(<class 'list'>, {'all_KL': [0.709, 0.712, 0.715, 0.749, 0.851], 'all_L1': [0.739, 0.74, 0.743, 0.771, 0.849]}), defaultdict(<class 'list'>, {'all_KL': [0.707, 0.708, 0.711, 0.747, 0.837], 'all_L1': [0.722, 0.722, 0.726, 0.756, 0.828]}), defaultdict(<class 'list'>, {'all_KL': [0.693, 0.693, 0.691, 0.705, 0.852], 'all_L1': [0.721, 0.723, 0.726, 0.729, 0.84]}), defaultdict(<class 'list'>, {'all_KL': [0.707, 0.704, 0.708, 0.726, 0.858], 'all_L1': [0.732, 0.73, 0.735, 0.744, 0.847]}), defaultdict(<class 'list'>, {'all_KL': [0.664, 0.666, 0.687, 0.701, 0.853], 'all_L1': [0.722, 0.728, 0.744, 0.744, 0.855]}), defaultdict(<class 'list'>, {'all_KL': [0.703, 0.701, 0.701, 0.722, 0.847], 'all_L1': [0.729, 0.726, 0.726, 0.742, 0.836]}), defaultdict(<class 'list'>, {'all_KL': [0.707, 0.707, 0.711, 0.738, 0.838], 'all_L1': [0.726, 0.725, 0.728, 0.751, 0.826]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.109, 0.14, 0.152, 0.154, 0.158], 'all_L1': [0.124, 0.152, 0.163, 0.158, 0.163]}), defaultdict(<class 'list'>, {'all_KL': [0.138, 0.168, 0.18, 0.166, 0.156], 'all_L1': [0.147, 0.173, 0.182, 0.162, 0.156]}), defaultdict(<class 'list'>, {'all_KL': [0.137, 0.169, 0.174, 0.168, 0.158], 'all_L1': [0.147, 0.175, 0.179, 0.165, 0.158]}), defaultdict(<class 'list'>, {'all_KL': [0.083, 0.1, 0.111, 0.126, 0.151], 'all_L1': [0.097, 0.113, 0.12, 0.126, 0.145]}), defaultdict(<class 'list'>, {'all_KL': [0.127, 0.145, 0.155, 0.162, 0.152], 'all_L1': [0.141, 0.158, 0.167, 0.164, 0.158]}), defaultdict(<class 'list'>, {'all_KL': [0.161, 0.189, 0.169, 0.152, 0.15], 'all_L1': [0.171, 0.195, 0.175, 0.157, 0.161]}), defaultdict(<class 'list'>, {'all_KL': [0.096, 0.123, 0.13, 0.139, 0.142], 'all_L1': [0.116, 0.141, 0.149, 0.152, 0.153]}), defaultdict(<class 'list'>, {'all_KL': [0.127, 0.162, 0.178, 0.168, 0.182], 'all_L1': [0.134, 0.164, 0.173, 0.155, 0.171]}), defaultdict(<class 'list'>, {'all_KL': [0.133, 0.164, 0.166, 0.142, 0.131], 'all_L1': [0.145, 0.174, 0.174, 0.144, 0.14]}), defaultdict(<class 'list'>, {'all_KL': [0.123, 0.148, 0.151, 0.122, 0.132], 'all_L1': [0.137, 0.16, 0.163, 0.134, 0.145]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.671 +- 0.015, 0.671 +- 0.018, 0.664 +- 0.017, 0.663 +- 0.020, 0.686 +- 0.025
suff_simple class all_KL  =  0.564 +- 0.024, 0.566 +- 0.024, 0.553 +- 0.028, 0.550 +- 0.039, 0.599 +- 0.046
[[0.687749981880188, 0.6757500171661377, 0.6702499985694885, 0.6759999990463257, 0.6495000123977661], [0.7587500214576721, 0.7522500157356262, 0.7404999732971191, 0.7692499756813049, 0.7052500247955322], [0.6945000290870667, 0.6765000224113464, 0.6557499766349792, 0.6852499842643738, 0.7122499942779541], [0.7005000114440918, 0.7047500014305115, 0.703249990940094, 0.7229999899864197, 0.7667499780654907], [0.7095000147819519, 0.7137500047683716, 0.7124999761581421, 0.7369999885559082, 0.7717499732971191], [0.7247499823570251, 0.7170000076293945, 0.7135000228881836, 0.6990000009536743, 0.6604999899864197], [0.746749997138977, 0.75, 0.7332500219345093, 0.7434999942779541, 0.7440000176429749], [0.7045000195503235, 0.6990000009536743, 0.7037500143051147, 0.6862499713897705, 0.6865000128746033], [0.6990000009536743, 0.687749981880188, 0.6875, 0.6977499723434448, 0.7350000143051147], [0.7204999923706055, 0.7127500176429749, 0.7052500247955322, 0.7212499976158142, 0.7267500162124634]]
[[0.531, 0.528, 0.519, 0.5, 0.533], [0.577, 0.574, 0.553, 0.576, 0.577], [0.566, 0.547, 0.53, 0.54, 0.597], [0.562, 0.572, 0.57, 0.579, 0.647], [0.585, 0.597, 0.596, 0.596, 0.661], [0.544, 0.54, 0.523, 0.487, 0.535], [0.594, 0.598, 0.57, 0.575, 0.643], [0.522, 0.553, 0.525, 0.501, 0.547], [0.564, 0.556, 0.553, 0.553, 0.607], [0.594, 0.593, 0.596, 0.591, 0.64]]
suff_simple_acc_int  =  0.715 +- 0.022, 0.709 +- 0.025, 0.703 +- 0.025, 0.714 +- 0.028, 0.716 +- 0.039
nec class all_L1  =  0.325 +- 0.018, 0.289 +- 0.033, 0.216 +- 0.030, 0.175 +- 0.023, 0.159 +- 0.022
nec class all_KL  =  0.374 +- 0.015, 0.382 +- 0.040, 0.289 +- 0.040, 0.237 +- 0.030, 0.216 +- 0.028
[[0.671500027179718, 0.750249981880188, 0.8232499957084656, 0.8507500290870667, 0.8765000104904175], [0.6397500038146973, 0.7204999923706055, 0.8224999904632568, 0.8797500133514404, 0.9127500057220459], [0.6277499794960022, 0.7459999918937683, 0.8004999756813049, 0.8475000262260437, 0.8492500185966492], [0.6589999794960022, 0.7059999704360962, 0.796500027179718, 0.843500018119812, 0.862500011920929], [0.6200000047683716, 0.6664999723434448, 0.8009999990463257, 0.8619999885559082, 0.8857499957084656], [0.6652500033378601, 0.7672500014305115, 0.8527500033378601, 0.8659999966621399, 0.8802499771118164], [0.6884999871253967, 0.7682499885559082, 0.8812500238418579, 0.9152500033378601, 0.9142500162124634], [0.6759999990463257, 0.7512500286102295, 0.8077499866485596, 0.8502500057220459, 0.8657500147819519], [0.6579999923706055, 0.7229999899864197, 0.7872499823570251, 0.8314999938011169, 0.8557500243186951], [0.6327499747276306, 0.7087500095367432, 0.8195000290870667, 0.8769999742507935, 0.8784999847412109]]
[[0.372, 0.367, 0.294, 0.248, 0.223], [0.406, 0.419, 0.294, 0.237, 0.179], [0.386, 0.341, 0.291, 0.267, 0.254], [0.355, 0.432, 0.356, 0.28, 0.245], [0.389, 0.458, 0.321, 0.227, 0.19], [0.366, 0.347, 0.255, 0.231, 0.226], [0.351, 0.33, 0.199, 0.165, 0.167], [0.368, 0.369, 0.297, 0.238, 0.235], [0.374, 0.374, 0.31, 0.259, 0.236], [0.377, 0.38, 0.272, 0.213, 0.205]]
nec_acc_int  =  0.654 +- 0.022, 0.731 +- 0.030, 0.819 +- 0.027, 0.862 +- 0.023, 0.878 +- 0.021

Eval split val
suff_simple class all_L1  =  0.624 +- 0.111, 0.620 +- 0.115, 0.610 +- 0.124, 0.578 +- 0.141, 0.569 +- 0.167
suff_simple class all_KL  =  0.510 +- 0.156, 0.508 +- 0.161, 0.495 +- 0.170, 0.458 +- 0.184, 0.493 +- 0.207
[[0.5351999998092651, 0.5247499942779541, 0.5045499801635742, 0.44565001130104065, 0.39157500863075256], [0.6298499703407288, 0.6237750053405762, 0.6052500009536743, 0.5677000284194946, 0.4984250068664551], [0.5264250040054321, 0.526324987411499, 0.5152249932289124, 0.47644999623298645, 0.40107500553131104], [0.5952249765396118, 0.5969250202178955, 0.597000002861023, 0.5785750150680542, 0.533050000667572], [0.651075005531311, 0.6505749821662903, 0.643875002861023, 0.6087750196456909, 0.566349983215332], [0.5714499950408936, 0.5583999752998352, 0.5341749787330627, 0.4745500087738037, 0.3294749855995178], [0.6591749787330627, 0.6414999961853027, 0.6119750142097473, 0.5436499714851379, 0.49445000290870667], [0.593375027179718, 0.5894749760627747, 0.5813000202178955, 0.5367749929428101, 0.4394499957561493], [0.6194999814033508, 0.61285001039505, 0.5976250171661377, 0.5513250231742859, 0.48559999465942383], [0.6093249917030334, 0.6043999791145325, 0.5928000211715698, 0.560949981212616, 0.4855000078678131]]
[[0.225, 0.22, 0.194, 0.146, 0.172], [0.515, 0.509, 0.487, 0.44, 0.492], [0.599, 0.598, 0.588, 0.552, 0.517], [0.628, 0.636, 0.643, 0.631, 0.705], [0.658, 0.666, 0.665, 0.649, 0.739], [0.288, 0.277, 0.249, 0.19, 0.158], [0.486, 0.473, 0.449, 0.393, 0.447], [0.392, 0.393, 0.383, 0.347, 0.388], [0.572, 0.566, 0.547, 0.49, 0.511], [0.735, 0.742, 0.744, 0.737, 0.8]]
suff_simple_acc_int  =  0.599 +- 0.042, 0.593 +- 0.042, 0.578 +- 0.043, 0.534 +- 0.049, 0.462 +- 0.068
nec class all_L1  =  0.363 +- 0.106, 0.332 +- 0.078, 0.242 +- 0.045, 0.210 +- 0.035, 0.188 +- 0.041
nec class all_KL  =  0.396 +- 0.131, 0.410 +- 0.122, 0.360 +- 0.072, 0.295 +- 0.056, 0.265 +- 0.067
[[0.4431999921798706, 0.6255999803543091, 0.7753999829292297, 0.7298750281333923, 0.7577750086784363], [0.48739999532699585, 0.5538250207901001, 0.8218250274658203, 0.8622999787330627, 0.8899250030517578], [0.4966000020503998, 0.571025013923645, 0.6543499827384949, 0.682075023651123, 0.6966500282287598], [0.47540000081062317, 0.47655001282691956, 0.5566499829292297, 0.6084250211715698, 0.670199990272522], [0.4927999973297119, 0.4982750117778778, 0.5634750127792358, 0.6567999720573425, 0.7375749945640564], [0.49079999327659607, 0.6231250166893005, 0.7426999807357788, 0.7276999950408936, 0.7598000168800354], [0.4968000054359436, 0.5506500005722046, 0.8325999975204468, 0.8747249841690063, 0.888949990272522], [0.5956000089645386, 0.62642502784729, 0.7997249960899353, 0.8159499764442444, 0.838699996471405], [0.4828000068664551, 0.5103999972343445, 0.6842250227928162, 0.7539499998092651, 0.7997499704360962], [0.49380001425743103, 0.49632498621940613, 0.5608749985694885, 0.599174976348877, 0.6404500007629395]]
[[0.609, 0.548, 0.416, 0.351, 0.391], [0.446, 0.495, 0.414, 0.309, 0.263], [0.321, 0.284, 0.274, 0.237, 0.227], [0.293, 0.329, 0.384, 0.341, 0.255], [0.303, 0.319, 0.388, 0.344, 0.219], [0.551, 0.533, 0.356, 0.293, 0.335], [0.477, 0.473, 0.308, 0.251, 0.251], [0.406, 0.5, 0.416, 0.342, 0.317], [0.419, 0.456, 0.439, 0.313, 0.257], [0.136, 0.16, 0.203, 0.172, 0.133]]
nec_acc_int  =  0.496 +- 0.037, 0.553 +- 0.055, 0.699 +- 0.105, 0.731 +- 0.093, 0.768 +- 0.082

Eval split test
suff_simple class all_L1  =  0.726 +- 0.006, 0.726 +- 0.006, 0.731 +- 0.007, 0.747 +- 0.011, 0.839 +- 0.010
suff_simple class all_KL  =  0.695 +- 0.014, 0.695 +- 0.014, 0.701 +- 0.010, 0.724 +- 0.016, 0.845 +- 0.009
[[0.5582099556922913, 0.5597358345985413, 0.554082453250885, 0.5613868236541748, 0.5868426561355591], [0.5937062501907349, 0.5966079831123352, 0.6092405319213867, 0.5945317149162292, 0.6413359642028809], [0.5825745463371277, 0.5813988447189331, 0.5851261019706726, 0.5838002562522888, 0.6418317556381226], [0.5523063540458679, 0.5435511469841003, 0.5516809821128845, 0.5617120265960693, 0.6129162311553955], [0.5856764316558838, 0.5870522260665894, 0.5928307175636292, 0.6265009045600891, 0.6728517413139343], [0.6271262764930725, 0.6233740448951721, 0.6406844258308411, 0.5966579914093018, 0.6849819421768188], [0.5761457085609436, 0.5769962072372437, 0.5812987685203552, 0.5685661435127258, 0.6139506697654724], [0.5946817994117737, 0.6055383086204529, 0.6025364995002747, 0.5796477794647217, 0.6167318224906921], [0.5925805568695068, 0.581223726272583, 0.5800480246543884, 0.5792475342750549, 0.6553167104721069], [0.5733940601348877, 0.5715178847312927, 0.5723684430122375, 0.5857264399528503, 0.651703417301178]]
[[0.692, 0.692, 0.698, 0.719, 0.828], [0.685, 0.682, 0.686, 0.706, 0.835], [0.685, 0.684, 0.697, 0.726, 0.852], [0.709, 0.712, 0.715, 0.749, 0.851], [0.707, 0.708, 0.711, 0.747, 0.837], [0.693, 0.693, 0.691, 0.705, 0.852], [0.707, 0.704, 0.708, 0.726, 0.858], [0.664, 0.666, 0.687, 0.701, 0.853], [0.703, 0.701, 0.701, 0.722, 0.847], [0.707, 0.707, 0.711, 0.738, 0.838]]
suff_simple_acc_int  =  0.584 +- 0.020, 0.583 +- 0.021, 0.587 +- 0.025, 0.584 +- 0.018, 0.638 +- 0.029
nec class all_L1  =  0.136 +- 0.019, 0.160 +- 0.021, 0.165 +- 0.017, 0.152 +- 0.012, 0.155 +- 0.009
nec class all_KL  =  0.123 +- 0.021, 0.151 +- 0.024, 0.157 +- 0.021, 0.150 +- 0.016, 0.151 +- 0.014
[[0.5885531306266785, 0.5587352514266968, 0.5665649175643921, 0.6235491037368774, 0.630853533744812], [0.584150493144989, 0.5538573265075684, 0.5833750367164612, 0.6495647430419922, 0.6644486784934998], [0.589353621006012, 0.5621373057365417, 0.5756203532218933, 0.6378327012062073, 0.65101557970047], [0.582349419593811, 0.563738226890564, 0.5578097105026245, 0.590004026889801, 0.598534107208252], [0.5731438994407654, 0.5549329519271851, 0.5502051115036011, 0.5939563512802124, 0.6213228106498718], [0.5869521498680115, 0.5623123645782471, 0.6186462044715881, 0.6674754619598389, 0.686261773109436], [0.5969581604003906, 0.5705423355102539, 0.5654892921447754, 0.6248499155044556, 0.6343556046485901], [0.5777466297149658, 0.5519311428070068, 0.5757204294204712, 0.6251751184463501, 0.6459875702857971], [0.582549512386322, 0.5501050353050232, 0.5689163208007812, 0.6345807313919067, 0.650615394115448], [0.5741444826126099, 0.5519311428070068, 0.5524314641952515, 0.6278016567230225, 0.6349560022354126]]
[[0.109, 0.14, 0.152, 0.154, 0.158], [0.138, 0.168, 0.18, 0.166, 0.156], [0.137, 0.169, 0.174, 0.168, 0.158], [0.083, 0.1, 0.111, 0.126, 0.151], [0.127, 0.145, 0.155, 0.162, 0.152], [0.161, 0.189, 0.169, 0.152, 0.15], [0.096, 0.123, 0.13, 0.139, 0.142], [0.127, 0.162, 0.178, 0.168, 0.182], [0.133, 0.164, 0.166, 0.142, 0.131], [0.123, 0.148, 0.151, 0.122, 0.132]]
nec_acc_int  =  0.584 +- 0.007, 0.558 +- 0.006, 0.571 +- 0.019, 0.627 +- 0.022, 0.642 +- 0.023


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.498 +- 0.013, 0.480 +- 0.020, 0.440 +- 0.014, 0.419 +- 0.011, 0.422 +- 0.015
Faith. Armon (L1)= 		  =  0.438 +- 0.017, 0.403 +- 0.033, 0.325 +- 0.034, 0.276 +- 0.029, 0.257 +- 0.029
Faith. GMean (L1)= 	  =  0.467 +- 0.015, 0.440 +- 0.026, 0.378 +- 0.026, 0.340 +- 0.021, 0.329 +- 0.023
Faith. Aritm (KL)= 		  =  0.469 +- 0.015, 0.474 +- 0.027, 0.421 +- 0.025, 0.393 +- 0.022, 0.407 +- 0.023
Faith. Armon (KL)= 		  =  0.450 +- 0.015, 0.455 +- 0.032, 0.378 +- 0.037, 0.329 +- 0.031, 0.316 +- 0.030
Faith. GMean (KL)= 	  =  0.459 +- 0.015, 0.464 +- 0.029, 0.399 +- 0.031, 0.359 +- 0.025, 0.358 +- 0.024

Eval split val
Faith. Aritm (L1)= 		  =  0.493 +- 0.020, 0.476 +- 0.041, 0.426 +- 0.066, 0.394 +- 0.066, 0.379 +- 0.066
Faith. Armon (L1)= 		  =  0.436 +- 0.070, 0.417 +- 0.065, 0.342 +- 0.055, 0.300 +- 0.041, 0.269 +- 0.025
Faith. GMean (L1)= 	  =  0.462 +- 0.045, 0.444 +- 0.047, 0.381 +- 0.055, 0.342 +- 0.045, 0.317 +- 0.028
Faith. Aritm (KL)= 		  =  0.453 +- 0.031, 0.459 +- 0.039, 0.427 +- 0.076, 0.376 +- 0.085, 0.379 +- 0.075
Faith. Armon (KL)= 		  =  0.401 +- 0.074, 0.411 +- 0.075, 0.392 +- 0.079, 0.334 +- 0.077, 0.306 +- 0.054
Faith. GMean (KL)= 	  =  0.425 +- 0.052, 0.433 +- 0.056, 0.409 +- 0.075, 0.354 +- 0.077, 0.339 +- 0.055

Eval split test
Faith. Aritm (L1)= 		  =  0.431 +- 0.008, 0.443 +- 0.009, 0.448 +- 0.007, 0.449 +- 0.006, 0.497 +- 0.008
Faith. Armon (L1)= 		  =  0.228 +- 0.027, 0.262 +- 0.029, 0.268 +- 0.024, 0.252 +- 0.017, 0.262 +- 0.013
Faith. GMean (L1)= 	  =  0.313 +- 0.022, 0.340 +- 0.022, 0.346 +- 0.018, 0.336 +- 0.013, 0.360 +- 0.011
Faith. Aritm (KL)= 		  =  0.409 +- 0.010, 0.423 +- 0.010, 0.429 +- 0.007, 0.437 +- 0.008, 0.498 +- 0.009
Faith. Armon (KL)= 		  =  0.209 +- 0.031, 0.247 +- 0.033, 0.255 +- 0.028, 0.248 +- 0.022, 0.256 +- 0.020
Faith. GMean (KL)= 	  =  0.292 +- 0.025, 0.322 +- 0.025, 0.330 +- 0.021, 0.329 +- 0.016, 0.357 +- 0.017
Computed for split load_split = id



Completed in  2:55:16.360576  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 08:40:13 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:40:13 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:40:13 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:40:13 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:40:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:40:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:40:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:40:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:40:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:40:13 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:40:13 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0013
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0013
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0013
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0013
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.415
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.365
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.247
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.159
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.105
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.263
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.147
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.078
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.040
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.021
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.297
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.213
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.138
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.094
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.085


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.41488200000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.853
SUFF_SIMPLE for r=0.05 class 0.0 = 0.714 +- 0.391 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.931 +- 0.391 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.05 all KL = 0.757 +- 0.391 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.05 all L1 = 0.835 +- 0.290 (in-sample avg dev_std = 0.324)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.364978
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.856
SUFF_SIMPLE for r=0.1 class 0.0 = 0.722 +- 0.387 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.937 +- 0.387 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.1 all KL = 0.772 +- 0.387 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.1 all L1 = 0.841 +- 0.290 (in-sample avg dev_std = 0.319)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24656
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.862
SUFF_SIMPLE for r=0.2 class 0.0 = 0.72 +- 0.392 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.942 +- 0.392 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.2 all KL = 0.771 +- 0.392 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.2 all L1 = 0.843 +- 0.285 (in-sample avg dev_std = 0.342)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.15886799999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.906
SUFF_SIMPLE for r=0.4 class 0.0 = 0.773 +- 0.351 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.974 +- 0.351 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.4 all KL = 0.823 +- 0.351 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.4 all L1 = 0.884 +- 0.245 (in-sample avg dev_std = 0.312)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10517
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.964
SUFF_SIMPLE for r=0.8 class 0.0 = 0.898 +- 0.235 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.99 +- 0.235 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.8 all KL = 0.921 +- 0.235 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.8 all L1 = 0.949 +- 0.161 (in-sample avg dev_std = 0.190)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.839
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.26289359999999995
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.68
SUFF_SIMPLE for r=0.05 class 0.0 = 0.671 +- 0.388 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.947 +- 0.388 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.05 all KL = 0.774 +- 0.388 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.05 all L1 = 0.81 +- 0.317 (in-sample avg dev_std = 0.116)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.839
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1465422
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.682
SUFF_SIMPLE for r=0.1 class 0.0 = 0.672 +- 0.388 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.947 +- 0.388 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.1 all KL = 0.775 +- 0.388 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.1 all L1 = 0.811 +- 0.317 (in-sample avg dev_std = 0.121)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.839
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.078009
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.681
SUFF_SIMPLE for r=0.2 class 0.0 = 0.673 +- 0.388 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.948 +- 0.388 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.2 all KL = 0.776 +- 0.388 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.2 all L1 = 0.812 +- 0.317 (in-sample avg dev_std = 0.122)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.839
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04044640000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.682
SUFF_SIMPLE for r=0.4 class 0.0 = 0.677 +- 0.388 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.949 +- 0.388 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.4 all KL = 0.778 +- 0.388 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.4 all L1 = 0.814 +- 0.316 (in-sample avg dev_std = 0.132)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.839
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.021063
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.765
SUFF_SIMPLE for r=0.8 class 0.0 = 0.823 +- 0.306 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.949 +- 0.306 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.8 all KL = 0.869 +- 0.306 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.8 all L1 = 0.887 +- 0.241 (in-sample avg dev_std = 0.148)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.831
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.296562
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.766
SUFF_SIMPLE for r=0.05 class 0.0 = 0.859 +- 0.390 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.626 +- 0.390 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.05 all KL = 0.726 +- 0.390 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.05 all L1 = 0.744 +- 0.325 (in-sample avg dev_std = 0.202)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.831
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.21277920000000003
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.787
SUFF_SIMPLE for r=0.1 class 0.0 = 0.86 +- 0.376 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.66 +- 0.376 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.1 all KL = 0.747 +- 0.376 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.1 all L1 = 0.761 +- 0.313 (in-sample avg dev_std = 0.181)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.831
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1383178
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.81
SUFF_SIMPLE for r=0.2 class 0.0 = 0.877 +- 0.343 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.716 +- 0.343 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.2 all KL = 0.788 +- 0.343 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.2 all L1 = 0.797 +- 0.288 (in-sample avg dev_std = 0.169)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0936346
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.847
SUFF_SIMPLE for r=0.4 class 0.0 = 0.902 +- 0.312 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.757 +- 0.312 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.4 all KL = 0.825 +- 0.312 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.4 all L1 = 0.831 +- 0.261 (in-sample avg dev_std = 0.181)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.833
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08455240000000001
len(reference) = 4986
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.867
SUFF_SIMPLE for r=0.8 class 0.0 = 0.921 +- 0.304 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.76 +- 0.304 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.8 all KL = 0.848 +- 0.304 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.8 all L1 = 0.841 +- 0.268 (in-sample avg dev_std = 0.059)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.41488200000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.576
NEC for r=0.05 class 0.0 = 0.082 +- 0.483 (in-sample avg dev_std = 0.201)
NEC for r=0.05 class 1.0 = 0.627 +- 0.483 (in-sample avg dev_std = 0.201)
NEC for r=0.05 all KL = 0.465 +- 0.483 (in-sample avg dev_std = 0.201)
NEC for r=0.05 all L1 = 0.384 +- 0.407 (in-sample avg dev_std = 0.201)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.364978
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.71
NEC for r=0.1 class 0.0 = 0.145 +- 0.439 (in-sample avg dev_std = 0.408)
NEC for r=0.1 class 1.0 = 0.449 +- 0.439 (in-sample avg dev_std = 0.408)
NEC for r=0.1 all KL = 0.457 +- 0.439 (in-sample avg dev_std = 0.408)
NEC for r=0.1 all L1 = 0.313 +- 0.342 (in-sample avg dev_std = 0.408)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24656
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.837
NEC for r=0.2 class 0.0 = 0.182 +- 0.401 (in-sample avg dev_std = 0.370)
NEC for r=0.2 class 1.0 = 0.2 +- 0.401 (in-sample avg dev_std = 0.370)
NEC for r=0.2 all KL = 0.306 +- 0.401 (in-sample avg dev_std = 0.370)
NEC for r=0.2 all L1 = 0.192 +- 0.285 (in-sample avg dev_std = 0.370)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.15886799999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.905
NEC for r=0.4 class 0.0 = 0.169 +- 0.346 (in-sample avg dev_std = 0.317)
NEC for r=0.4 class 1.0 = 0.083 +- 0.346 (in-sample avg dev_std = 0.317)
NEC for r=0.4 all KL = 0.196 +- 0.346 (in-sample avg dev_std = 0.317)
NEC for r=0.4 all L1 = 0.122 +- 0.238 (in-sample avg dev_std = 0.317)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10517
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.953
NEC for r=0.8 class 0.0 = 0.132 +- 0.271 (in-sample avg dev_std = 0.245)
NEC for r=0.8 class 1.0 = 0.02 +- 0.271 (in-sample avg dev_std = 0.245)
NEC for r=0.8 all KL = 0.114 +- 0.271 (in-sample avg dev_std = 0.245)
NEC for r=0.8 all L1 = 0.07 +- 0.179 (in-sample avg dev_std = 0.245)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.839
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.26289359999999995
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.462
NEC for r=0.05 class 0.0 = 0.085 +- 0.469 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.613 +- 0.469 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.403 +- 0.469 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.351 +- 0.402 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.839
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1465422
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.472
NEC for r=0.1 class 0.0 = 0.223 +- 0.465 (in-sample avg dev_std = 0.365)
NEC for r=0.1 class 1.0 = 0.516 +- 0.465 (in-sample avg dev_std = 0.365)
NEC for r=0.1 all KL = 0.465 +- 0.465 (in-sample avg dev_std = 0.365)
NEC for r=0.1 all L1 = 0.371 +- 0.377 (in-sample avg dev_std = 0.365)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.839
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.078009
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.691
NEC for r=0.2 class 0.0 = 0.26 +- 0.390 (in-sample avg dev_std = 0.375)
NEC for r=0.2 class 1.0 = 0.118 +- 0.390 (in-sample avg dev_std = 0.375)
NEC for r=0.2 all KL = 0.283 +- 0.390 (in-sample avg dev_std = 0.375)
NEC for r=0.2 all L1 = 0.188 +- 0.278 (in-sample avg dev_std = 0.375)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.839
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04044640000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.737
NEC for r=0.4 class 0.0 = 0.233 +- 0.360 (in-sample avg dev_std = 0.290)
NEC for r=0.4 class 1.0 = 0.055 +- 0.360 (in-sample avg dev_std = 0.290)
NEC for r=0.4 all KL = 0.196 +- 0.360 (in-sample avg dev_std = 0.290)
NEC for r=0.4 all L1 = 0.143 +- 0.258 (in-sample avg dev_std = 0.290)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.839
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.021063
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.754
NEC for r=0.8 class 0.0 = 0.212 +- 0.346 (in-sample avg dev_std = 0.272)
NEC for r=0.8 class 1.0 = 0.047 +- 0.346 (in-sample avg dev_std = 0.272)
NEC for r=0.8 all KL = 0.173 +- 0.346 (in-sample avg dev_std = 0.272)
NEC for r=0.8 all L1 = 0.129 +- 0.245 (in-sample avg dev_std = 0.272)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.831
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.296562
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.586
NEC for r=0.05 class 0.0 = 0.041 +- 0.382 (in-sample avg dev_std = 0.047)
NEC for r=0.05 class 1.0 = 0.472 +- 0.382 (in-sample avg dev_std = 0.047)
NEC for r=0.05 all KL = 0.258 +- 0.382 (in-sample avg dev_std = 0.047)
NEC for r=0.05 all L1 = 0.254 +- 0.355 (in-sample avg dev_std = 0.047)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.831
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.21277920000000003
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.597
NEC for r=0.1 class 0.0 = 0.055 +- 0.388 (in-sample avg dev_std = 0.183)
NEC for r=0.1 class 1.0 = 0.507 +- 0.388 (in-sample avg dev_std = 0.183)
NEC for r=0.1 all KL = 0.295 +- 0.388 (in-sample avg dev_std = 0.183)
NEC for r=0.1 all L1 = 0.278 +- 0.352 (in-sample avg dev_std = 0.183)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.831
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1383178
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.639
NEC for r=0.2 class 0.0 = 0.074 +- 0.372 (in-sample avg dev_std = 0.294)
NEC for r=0.2 class 1.0 = 0.469 +- 0.372 (in-sample avg dev_std = 0.294)
NEC for r=0.2 all KL = 0.289 +- 0.372 (in-sample avg dev_std = 0.294)
NEC for r=0.2 all L1 = 0.269 +- 0.329 (in-sample avg dev_std = 0.294)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0936346
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.733
NEC for r=0.4 class 0.0 = 0.105 +- 0.330 (in-sample avg dev_std = 0.351)
NEC for r=0.4 class 1.0 = 0.336 +- 0.330 (in-sample avg dev_std = 0.351)
NEC for r=0.4 all KL = 0.246 +- 0.330 (in-sample avg dev_std = 0.351)
NEC for r=0.4 all L1 = 0.219 +- 0.272 (in-sample avg dev_std = 0.351)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.831
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08455240000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.754
NEC for r=0.8 class 0.0 = 0.118 +- 0.333 (in-sample avg dev_std = 0.293)
NEC for r=0.8 class 1.0 = 0.299 +- 0.333 (in-sample avg dev_std = 0.293)
NEC for r=0.8 all KL = 0.226 +- 0.333 (in-sample avg dev_std = 0.293)
NEC for r=0.8 all L1 = 0.208 +- 0.276 (in-sample avg dev_std = 0.293)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 08:54:56 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:54:56 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:54:56 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:54:56 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:54:56 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:54:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 54 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 54...
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.458
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.365
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.241
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.141
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.088
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.226
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.123
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.035
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.020
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.260
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.193
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.134
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.094
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45770400000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.878
SUFF_SIMPLE for r=0.05 class 0.0 = 0.706 +- 0.394 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.394 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.05 all KL = 0.801 +- 0.394 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.05 all L1 = 0.869 +- 0.275 (in-sample avg dev_std = 0.376)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.365004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.88
SUFF_SIMPLE for r=0.1 class 0.0 = 0.707 +- 0.397 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.397 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.1 all KL = 0.799 +- 0.397 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.1 all L1 = 0.869 +- 0.272 (in-sample avg dev_std = 0.381)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24081
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.884
SUFF_SIMPLE for r=0.2 class 0.0 = 0.706 +- 0.400 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.998 +- 0.400 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.2 all KL = 0.794 +- 0.400 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.2 all L1 = 0.868 +- 0.269 (in-sample avg dev_std = 0.407)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14131799999999997
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.913
SUFF_SIMPLE for r=0.4 class 0.0 = 0.773 +- 0.373 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.996 +- 0.373 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.4 all KL = 0.824 +- 0.373 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.4 all L1 = 0.896 +- 0.236 (in-sample avg dev_std = 0.373)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.087738
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.978
SUFF_SIMPLE for r=0.8 class 0.0 = 0.931 +- 0.234 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.234 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.8 all KL = 0.935 +- 0.234 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.8 all L1 = 0.969 +- 0.123 (in-sample avg dev_std = 0.229)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22572780000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.749
SUFF_SIMPLE for r=0.05 class 0.0 = 0.561 +- 0.436 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.05 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.05 all L1 = 0.78 +- 0.374 (in-sample avg dev_std = 0.104)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1234076
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.749
SUFF_SIMPLE for r=0.1 class 0.0 = 0.561 +- 0.436 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.1 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.1 all L1 = 0.78 +- 0.374 (in-sample avg dev_std = 0.100)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06595659999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.749
SUFF_SIMPLE for r=0.2 class 0.0 = 0.561 +- 0.436 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.2 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.2 all L1 = 0.78 +- 0.374 (in-sample avg dev_std = 0.102)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0353154
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.757
SUFF_SIMPLE for r=0.4 class 0.0 = 0.567 +- 0.436 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 all KL = 0.745 +- 0.436 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 all L1 = 0.783 +- 0.370 (in-sample avg dev_std = 0.183)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.019738599999999995
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.98
SUFF_SIMPLE for r=0.8 class 0.0 = 0.945 +- 0.236 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.994 +- 0.236 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.8 all KL = 0.934 +- 0.236 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.8 all L1 = 0.97 +- 0.115 (in-sample avg dev_std = 0.222)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.896
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2604718
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.866
SUFF_SIMPLE for r=0.05 class 0.0 = 0.885 +- 0.324 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.899 +- 0.324 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.05 all KL = 0.858 +- 0.324 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.05 all L1 = 0.892 +- 0.253 (in-sample avg dev_std = 0.227)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.896
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1929138
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.865
SUFF_SIMPLE for r=0.1 class 0.0 = 0.884 +- 0.323 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.899 +- 0.323 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.1 all KL = 0.858 +- 0.323 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.1 all L1 = 0.891 +- 0.254 (in-sample avg dev_std = 0.225)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.896
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1335818
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.863
SUFF_SIMPLE for r=0.2 class 0.0 = 0.885 +- 0.325 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.895 +- 0.325 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.2 all KL = 0.858 +- 0.325 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.2 all L1 = 0.89 +- 0.256 (in-sample avg dev_std = 0.223)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.896
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09350420000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.895
SUFF_SIMPLE for r=0.4 class 0.0 = 0.932 +- 0.302 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.889 +- 0.302 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.4 all KL = 0.877 +- 0.302 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.4 all L1 = 0.911 +- 0.223 (in-sample avg dev_std = 0.255)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0805062
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.953
SUFF_SIMPLE for r=0.8 class 0.0 = 0.993 +- 0.257 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.869 +- 0.257 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.8 all KL = 0.919 +- 0.257 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.8 all L1 = 0.931 +- 0.210 (in-sample avg dev_std = 0.202)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45770400000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.817
NEC for r=0.05 class 0.0 = 0.0 +- 0.396 (in-sample avg dev_std = 0.159)
NEC for r=0.05 class 1.0 = 0.295 +- 0.396 (in-sample avg dev_std = 0.159)
NEC for r=0.05 all KL = 0.199 +- 0.396 (in-sample avg dev_std = 0.159)
NEC for r=0.05 all L1 = 0.163 +- 0.330 (in-sample avg dev_std = 0.159)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.365004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.933
NEC for r=0.1 class 0.0 = 0.013 +- 0.296 (in-sample avg dev_std = 0.231)
NEC for r=0.1 class 1.0 = 0.117 +- 0.296 (in-sample avg dev_std = 0.231)
NEC for r=0.1 all KL = 0.113 +- 0.296 (in-sample avg dev_std = 0.231)
NEC for r=0.1 all L1 = 0.071 +- 0.207 (in-sample avg dev_std = 0.231)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24081
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.945
NEC for r=0.2 class 0.0 = 0.079 +- 0.274 (in-sample avg dev_std = 0.199)
NEC for r=0.2 class 1.0 = 0.041 +- 0.274 (in-sample avg dev_std = 0.199)
NEC for r=0.2 all KL = 0.094 +- 0.274 (in-sample avg dev_std = 0.199)
NEC for r=0.2 all L1 = 0.058 +- 0.191 (in-sample avg dev_std = 0.199)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14131799999999997
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.953
NEC for r=0.4 class 0.0 = 0.121 +- 0.296 (in-sample avg dev_std = 0.282)
NEC for r=0.4 class 1.0 = 0.005 +- 0.296 (in-sample avg dev_std = 0.282)
NEC for r=0.4 all KL = 0.111 +- 0.296 (in-sample avg dev_std = 0.282)
NEC for r=0.4 all L1 = 0.057 +- 0.173 (in-sample avg dev_std = 0.282)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.087738
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.96
NEC for r=0.8 class 0.0 = 0.115 +- 0.294 (in-sample avg dev_std = 0.283)
NEC for r=0.8 class 1.0 = 0.001 +- 0.294 (in-sample avg dev_std = 0.283)
NEC for r=0.8 all KL = 0.111 +- 0.294 (in-sample avg dev_std = 0.283)
NEC for r=0.8 all L1 = 0.052 +- 0.158 (in-sample avg dev_std = 0.283)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22572780000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.526
NEC for r=0.05 class 0.0 = 0.0 +- 0.493 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.811 +- 0.493 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.471 +- 0.493 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.409 +- 0.429 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1234076
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.698
NEC for r=0.1 class 0.0 = 0.076 +- 0.466 (in-sample avg dev_std = 0.430)
NEC for r=0.1 class 1.0 = 0.524 +- 0.466 (in-sample avg dev_std = 0.430)
NEC for r=0.1 all KL = 0.407 +- 0.466 (in-sample avg dev_std = 0.430)
NEC for r=0.1 all L1 = 0.302 +- 0.368 (in-sample avg dev_std = 0.430)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06595659999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.896
NEC for r=0.2 class 0.0 = 0.227 +- 0.407 (in-sample avg dev_std = 0.459)
NEC for r=0.2 class 1.0 = 0.044 +- 0.407 (in-sample avg dev_std = 0.459)
NEC for r=0.2 all KL = 0.256 +- 0.407 (in-sample avg dev_std = 0.459)
NEC for r=0.2 all L1 = 0.135 +- 0.239 (in-sample avg dev_std = 0.459)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0353154
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.879
NEC for r=0.4 class 0.0 = 0.286 +- 0.420 (in-sample avg dev_std = 0.447)
NEC for r=0.4 class 1.0 = 0.007 +- 0.420 (in-sample avg dev_std = 0.447)
NEC for r=0.4 all KL = 0.243 +- 0.420 (in-sample avg dev_std = 0.447)
NEC for r=0.4 all L1 = 0.145 +- 0.268 (in-sample avg dev_std = 0.447)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.019738599999999995
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.877
NEC for r=0.8 class 0.0 = 0.29 +- 0.421 (in-sample avg dev_std = 0.448)
NEC for r=0.8 class 1.0 = 0.005 +- 0.421 (in-sample avg dev_std = 0.448)
NEC for r=0.8 all KL = 0.241 +- 0.421 (in-sample avg dev_std = 0.448)
NEC for r=0.8 all L1 = 0.146 +- 0.270 (in-sample avg dev_std = 0.448)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.896
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2604718
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.673
NEC for r=0.05 class 0.0 = 0.026 +- 0.420 (in-sample avg dev_std = 0.001)
NEC for r=0.05 class 1.0 = 0.41 +- 0.420 (in-sample avg dev_std = 0.001)
NEC for r=0.05 all KL = 0.246 +- 0.420 (in-sample avg dev_std = 0.001)
NEC for r=0.05 all L1 = 0.216 +- 0.365 (in-sample avg dev_std = 0.001)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.896
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1929138
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.704
NEC for r=0.1 class 0.0 = 0.034 +- 0.412 (in-sample avg dev_std = 0.241)
NEC for r=0.1 class 1.0 = 0.378 +- 0.412 (in-sample avg dev_std = 0.241)
NEC for r=0.1 all KL = 0.239 +- 0.412 (in-sample avg dev_std = 0.241)
NEC for r=0.1 all L1 = 0.204 +- 0.347 (in-sample avg dev_std = 0.241)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.896
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1335818
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.81
NEC for r=0.2 class 0.0 = 0.043 +- 0.357 (in-sample avg dev_std = 0.363)
NEC for r=0.2 class 1.0 = 0.227 +- 0.357 (in-sample avg dev_std = 0.363)
NEC for r=0.2 all KL = 0.197 +- 0.357 (in-sample avg dev_std = 0.363)
NEC for r=0.2 all L1 = 0.134 +- 0.249 (in-sample avg dev_std = 0.363)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.896
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09350420000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.843
NEC for r=0.4 class 0.0 = 0.072 +- 0.280 (in-sample avg dev_std = 0.253)
NEC for r=0.4 class 1.0 = 0.109 +- 0.280 (in-sample avg dev_std = 0.253)
NEC for r=0.4 all KL = 0.13 +- 0.280 (in-sample avg dev_std = 0.253)
NEC for r=0.4 all L1 = 0.091 +- 0.207 (in-sample avg dev_std = 0.253)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.896
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0805062
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.858
NEC for r=0.8 class 0.0 = 0.075 +- 0.237 (in-sample avg dev_std = 0.172)
NEC for r=0.8 class 1.0 = 0.064 +- 0.237 (in-sample avg dev_std = 0.172)
NEC for r=0.8 all KL = 0.086 +- 0.237 (in-sample avg dev_std = 0.172)
NEC for r=0.8 all L1 = 0.07 +- 0.194 (in-sample avg dev_std = 0.172)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 09:10:03 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 09:10:03 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 09:10:03 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 09:10:03 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 09:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:10:03 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 09:10:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.478
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.410
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.291
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.179
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.103
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.226
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.122
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.064
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.033
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.018
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.255
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.201
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.153
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.118
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.092


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.47767000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.898
SUFF_SIMPLE for r=0.05 class 0.0 = 0.74 +- 0.381 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.999 +- 0.381 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.05 all KL = 0.808 +- 0.381 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.05 all L1 = 0.883 +- 0.252 (in-sample avg dev_std = 0.388)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.409704
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.899
SUFF_SIMPLE for r=0.1 class 0.0 = 0.74 +- 0.383 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.383 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.1 all KL = 0.81 +- 0.383 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.1 all L1 = 0.884 +- 0.251 (in-sample avg dev_std = 0.387)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.29106600000000005
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.899
SUFF_SIMPLE for r=0.2 class 0.0 = 0.739 +- 0.388 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.388 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.2 all KL = 0.801 +- 0.388 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.2 all L1 = 0.884 +- 0.247 (in-sample avg dev_std = 0.392)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.178766
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.919
SUFF_SIMPLE for r=0.4 class 0.0 = 0.78 +- 0.365 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.365 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.4 all KL = 0.83 +- 0.365 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.4 all L1 = 0.902 +- 0.227 (in-sample avg dev_std = 0.379)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.102912
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.977
SUFF_SIMPLE for r=0.8 class 0.0 = 0.932 +- 0.224 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.224 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.8 all KL = 0.941 +- 0.224 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.8 all L1 = 0.97 +- 0.126 (in-sample avg dev_std = 0.217)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.995
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22569260000000005
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.75
SUFF_SIMPLE for r=0.05 class 0.0 = 0.56 +- 0.437 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.05 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.05 all L1 = 0.777 +- 0.376 (in-sample avg dev_std = 0.110)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.995
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1222672
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.75
SUFF_SIMPLE for r=0.1 class 0.0 = 0.56 +- 0.437 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.1 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.1 all L1 = 0.777 +- 0.376 (in-sample avg dev_std = 0.113)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.995
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0640396
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.751
SUFF_SIMPLE for r=0.2 class 0.0 = 0.561 +- 0.437 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.2 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.2 all L1 = 0.777 +- 0.375 (in-sample avg dev_std = 0.130)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.995
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.033169599999999994
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.755
SUFF_SIMPLE for r=0.4 class 0.0 = 0.564 +- 0.437 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 all L1 = 0.779 +- 0.373 (in-sample avg dev_std = 0.174)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.995
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0176382
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.976
SUFF_SIMPLE for r=0.8 class 0.0 = 0.939 +- 0.246 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.987 +- 0.246 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.8 all KL = 0.925 +- 0.246 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.8 all L1 = 0.963 +- 0.133 (in-sample avg dev_std = 0.235)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2546228
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.912
SUFF_SIMPLE for r=0.05 class 0.0 = 0.878 +- 0.263 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.974 +- 0.263 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 all KL = 0.91 +- 0.263 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 all L1 = 0.925 +- 0.214 (in-sample avg dev_std = 0.134)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.20126739999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.913
SUFF_SIMPLE for r=0.1 class 0.0 = 0.879 +- 0.261 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.975 +- 0.261 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.1 all KL = 0.914 +- 0.261 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.1 all L1 = 0.927 +- 0.214 (in-sample avg dev_std = 0.127)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15335919999999997
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.914
SUFF_SIMPLE for r=0.2 class 0.0 = 0.881 +- 0.262 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.976 +- 0.262 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.2 all KL = 0.917 +- 0.262 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.2 all L1 = 0.928 +- 0.214 (in-sample avg dev_std = 0.133)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11829880000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.928
SUFF_SIMPLE for r=0.4 class 0.0 = 0.904 +- 0.242 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.975 +- 0.242 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.4 all KL = 0.929 +- 0.242 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.4 all L1 = 0.939 +- 0.192 (in-sample avg dev_std = 0.143)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0920228
len(reference) = 4968
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.978
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.062 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.968 +- 0.062 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.8 all KL = 0.988 +- 0.062 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.8 all L1 = 0.982 +- 0.074 (in-sample avg dev_std = 0.021)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.47767000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.761
NEC for r=0.05 class 0.0 = 0.03 +- 0.437 (in-sample avg dev_std = 0.186)
NEC for r=0.05 class 1.0 = 0.367 +- 0.437 (in-sample avg dev_std = 0.186)
NEC for r=0.05 all KL = 0.264 +- 0.437 (in-sample avg dev_std = 0.186)
NEC for r=0.05 all L1 = 0.217 +- 0.365 (in-sample avg dev_std = 0.186)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.409704
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.85
NEC for r=0.1 class 0.0 = 0.051 +- 0.395 (in-sample avg dev_std = 0.305)
NEC for r=0.1 class 1.0 = 0.23 +- 0.395 (in-sample avg dev_std = 0.305)
NEC for r=0.1 all KL = 0.218 +- 0.395 (in-sample avg dev_std = 0.305)
NEC for r=0.1 all L1 = 0.15 +- 0.297 (in-sample avg dev_std = 0.305)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.29106600000000005
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.918
NEC for r=0.2 class 0.0 = 0.066 +- 0.341 (in-sample avg dev_std = 0.291)
NEC for r=0.2 class 1.0 = 0.111 +- 0.341 (in-sample avg dev_std = 0.291)
NEC for r=0.2 all KL = 0.156 +- 0.341 (in-sample avg dev_std = 0.291)
NEC for r=0.2 all L1 = 0.091 +- 0.225 (in-sample avg dev_std = 0.291)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.178766
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.947
NEC for r=0.4 class 0.0 = 0.097 +- 0.307 (in-sample avg dev_std = 0.292)
NEC for r=0.4 class 1.0 = 0.037 +- 0.307 (in-sample avg dev_std = 0.292)
NEC for r=0.4 all KL = 0.123 +- 0.307 (in-sample avg dev_std = 0.292)
NEC for r=0.4 all L1 = 0.064 +- 0.180 (in-sample avg dev_std = 0.292)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.102912
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.962
NEC for r=0.8 class 0.0 = 0.11 +- 0.298 (in-sample avg dev_std = 0.296)
NEC for r=0.8 class 1.0 = 0.005 +- 0.298 (in-sample avg dev_std = 0.296)
NEC for r=0.8 all KL = 0.121 +- 0.298 (in-sample avg dev_std = 0.296)
NEC for r=0.8 all L1 = 0.052 +- 0.147 (in-sample avg dev_std = 0.296)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.995
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22569260000000005
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.524
NEC for r=0.05 class 0.0 = 0.03 +- 0.496 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.785 +- 0.496 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.478 +- 0.496 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.411 +- 0.429 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.995
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1222672
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.631
NEC for r=0.1 class 0.0 = 0.198 +- 0.485 (in-sample avg dev_std = 0.441)
NEC for r=0.1 class 1.0 = 0.519 +- 0.485 (in-sample avg dev_std = 0.441)
NEC for r=0.1 all KL = 0.476 +- 0.485 (in-sample avg dev_std = 0.441)
NEC for r=0.1 all L1 = 0.36 +- 0.388 (in-sample avg dev_std = 0.441)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.995
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0640396
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.863
NEC for r=0.2 class 0.0 = 0.283 +- 0.422 (in-sample avg dev_std = 0.450)
NEC for r=0.2 class 1.0 = 0.048 +- 0.422 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all KL = 0.279 +- 0.422 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all L1 = 0.164 +- 0.278 (in-sample avg dev_std = 0.450)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.995
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.033169599999999994
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.871
NEC for r=0.4 class 0.0 = 0.301 +- 0.423 (in-sample avg dev_std = 0.445)
NEC for r=0.4 class 1.0 = 0.012 +- 0.423 (in-sample avg dev_std = 0.445)
NEC for r=0.4 all KL = 0.248 +- 0.423 (in-sample avg dev_std = 0.445)
NEC for r=0.4 all L1 = 0.155 +- 0.280 (in-sample avg dev_std = 0.445)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.995
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0176382
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.875
NEC for r=0.8 class 0.0 = 0.296 +- 0.423 (in-sample avg dev_std = 0.454)
NEC for r=0.8 class 1.0 = 0.01 +- 0.423 (in-sample avg dev_std = 0.454)
NEC for r=0.8 all KL = 0.245 +- 0.423 (in-sample avg dev_std = 0.454)
NEC for r=0.8 all L1 = 0.152 +- 0.276 (in-sample avg dev_std = 0.454)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2546228
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.671
NEC for r=0.05 class 0.0 = 0.027 +- 0.455 (in-sample avg dev_std = 0.085)
NEC for r=0.05 class 1.0 = 0.546 +- 0.455 (in-sample avg dev_std = 0.085)
NEC for r=0.05 all KL = 0.326 +- 0.455 (in-sample avg dev_std = 0.085)
NEC for r=0.05 all L1 = 0.283 +- 0.397 (in-sample avg dev_std = 0.085)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.20126739999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.722
NEC for r=0.1 class 0.0 = 0.037 +- 0.439 (in-sample avg dev_std = 0.324)
NEC for r=0.1 class 1.0 = 0.492 +- 0.439 (in-sample avg dev_std = 0.324)
NEC for r=0.1 all KL = 0.313 +- 0.439 (in-sample avg dev_std = 0.324)
NEC for r=0.1 all L1 = 0.261 +- 0.368 (in-sample avg dev_std = 0.324)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15335919999999997
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.837
NEC for r=0.2 class 0.0 = 0.051 +- 0.370 (in-sample avg dev_std = 0.399)
NEC for r=0.2 class 1.0 = 0.304 +- 0.370 (in-sample avg dev_std = 0.399)
NEC for r=0.2 all KL = 0.244 +- 0.370 (in-sample avg dev_std = 0.399)
NEC for r=0.2 all L1 = 0.176 +- 0.275 (in-sample avg dev_std = 0.399)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11829880000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.891
NEC for r=0.4 class 0.0 = 0.079 +- 0.290 (in-sample avg dev_std = 0.294)
NEC for r=0.4 class 1.0 = 0.135 +- 0.290 (in-sample avg dev_std = 0.294)
NEC for r=0.4 all KL = 0.151 +- 0.290 (in-sample avg dev_std = 0.294)
NEC for r=0.4 all L1 = 0.106 +- 0.217 (in-sample avg dev_std = 0.294)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.977
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0920228
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.921
NEC for r=0.8 class 0.0 = 0.081 +- 0.239 (in-sample avg dev_std = 0.204)
NEC for r=0.8 class 1.0 = 0.057 +- 0.239 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all KL = 0.093 +- 0.239 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all L1 = 0.069 +- 0.184 (in-sample avg dev_std = 0.204)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 09:25:21 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 09:25:21 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 09:25:21 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 09:25:21 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 09:25:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:25:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:25:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:25:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:25:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:25:21 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 09:25:21 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.553
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.511
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.389
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.250
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.138
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.296
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.164
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.087
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.045
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.023
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.367
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.302
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.232
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.170
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.121


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.552706
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.853
SUFF_SIMPLE for r=0.05 class 0.0 = 0.662 +- 0.412 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.985 +- 0.412 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.05 all KL = 0.773 +- 0.412 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.05 all L1 = 0.841 +- 0.300 (in-sample avg dev_std = 0.390)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5110319999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.851
SUFF_SIMPLE for r=0.1 class 0.0 = 0.655 +- 0.407 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.996 +- 0.407 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.1 all KL = 0.786 +- 0.407 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.1 all L1 = 0.844 +- 0.304 (in-sample avg dev_std = 0.372)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.388652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.855
SUFF_SIMPLE for r=0.2 class 0.0 = 0.667 +- 0.401 (in-sample avg dev_std = 0.361)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.401 (in-sample avg dev_std = 0.361)
SUFF_SIMPLE for r=0.2 all KL = 0.796 +- 0.401 (in-sample avg dev_std = 0.361)
SUFF_SIMPLE for r=0.2 all L1 = 0.851 +- 0.300 (in-sample avg dev_std = 0.361)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.249828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.867
SUFF_SIMPLE for r=0.4 class 0.0 = 0.689 +- 0.392 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.392 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.4 all KL = 0.806 +- 0.392 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.4 all L1 = 0.861 +- 0.289 (in-sample avg dev_std = 0.360)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.138484
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.946
SUFF_SIMPLE for r=0.8 class 0.0 = 0.866 +- 0.285 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.285 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.8 all KL = 0.905 +- 0.285 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.8 all L1 = 0.94 +- 0.193 (in-sample avg dev_std = 0.251)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.957
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.29553720000000006
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.727
SUFF_SIMPLE for r=0.05 class 0.0 = 0.584 +- 0.434 (in-sample avg dev_std = 0.026)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.999 +- 0.434 (in-sample avg dev_std = 0.026)
SUFF_SIMPLE for r=0.05 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.026)
SUFF_SIMPLE for r=0.05 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.026)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.957
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.164454
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.727
SUFF_SIMPLE for r=0.1 class 0.0 = 0.584 +- 0.434 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.434 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.1 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.1 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.024)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.957
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08715619999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.727
SUFF_SIMPLE for r=0.2 class 0.0 = 0.584 +- 0.434 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.434 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.2 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.2 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.033)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.957
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04494
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.728
SUFF_SIMPLE for r=0.4 class 0.0 = 0.585 +- 0.433 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.999 +- 0.433 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.4 all KL = 0.747 +- 0.433 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.4 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.049)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.957
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0228408
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.886
SUFF_SIMPLE for r=0.8 class 0.0 = 0.845 +- 0.316 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.995 +- 0.316 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.8 all KL = 0.878 +- 0.316 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.8 all L1 = 0.921 +- 0.222 (in-sample avg dev_std = 0.206)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3669036
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.908
SUFF_SIMPLE for r=0.05 class 0.0 = 0.875 +- 0.334 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.936 +- 0.334 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.05 all KL = 0.851 +- 0.334 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.05 all L1 = 0.905 +- 0.229 (in-sample avg dev_std = 0.200)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3018496
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.909
SUFF_SIMPLE for r=0.1 class 0.0 = 0.876 +- 0.299 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.968 +- 0.299 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.1 all KL = 0.888 +- 0.299 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.1 all L1 = 0.922 +- 0.223 (in-sample avg dev_std = 0.157)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23168560000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.912
SUFF_SIMPLE for r=0.2 class 0.0 = 0.885 +- 0.267 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.989 +- 0.267 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.2 all KL = 0.918 +- 0.267 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.2 all L1 = 0.936 +- 0.213 (in-sample avg dev_std = 0.124)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.170355
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.924
SUFF_SIMPLE for r=0.4 class 0.0 = 0.904 +- 0.237 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.237 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.4 all KL = 0.937 +- 0.237 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.4 all L1 = 0.952 +- 0.188 (in-sample avg dev_std = 0.129)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.973
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.12148319999999999
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.967
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.994 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.994 +- 0.065 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.552706
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.667
NEC for r=0.05 class 0.0 = 0.115 +- 0.477 (in-sample avg dev_std = 0.218)
NEC for r=0.05 class 1.0 = 0.455 +- 0.477 (in-sample avg dev_std = 0.218)
NEC for r=0.05 all KL = 0.374 +- 0.477 (in-sample avg dev_std = 0.218)
NEC for r=0.05 all L1 = 0.303 +- 0.399 (in-sample avg dev_std = 0.218)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5110319999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.781
NEC for r=0.1 class 0.0 = 0.145 +- 0.442 (in-sample avg dev_std = 0.359)
NEC for r=0.1 class 1.0 = 0.283 +- 0.442 (in-sample avg dev_std = 0.359)
NEC for r=0.1 all KL = 0.333 +- 0.442 (in-sample avg dev_std = 0.359)
NEC for r=0.1 all L1 = 0.221 +- 0.332 (in-sample avg dev_std = 0.359)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.388652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.841
NEC for r=0.2 class 0.0 = 0.161 +- 0.414 (in-sample avg dev_std = 0.359)
NEC for r=0.2 class 1.0 = 0.167 +- 0.414 (in-sample avg dev_std = 0.359)
NEC for r=0.2 all KL = 0.26 +- 0.414 (in-sample avg dev_std = 0.359)
NEC for r=0.2 all L1 = 0.164 +- 0.296 (in-sample avg dev_std = 0.359)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.249828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.92
NEC for r=0.4 class 0.0 = 0.166 +- 0.366 (in-sample avg dev_std = 0.359)
NEC for r=0.4 class 1.0 = 0.045 +- 0.366 (in-sample avg dev_std = 0.359)
NEC for r=0.4 all KL = 0.194 +- 0.366 (in-sample avg dev_std = 0.359)
NEC for r=0.4 all L1 = 0.099 +- 0.214 (in-sample avg dev_std = 0.359)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.138484
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.946
NEC for r=0.8 class 0.0 = 0.147 +- 0.321 (in-sample avg dev_std = 0.330)
NEC for r=0.8 class 1.0 = 0.009 +- 0.321 (in-sample avg dev_std = 0.330)
NEC for r=0.8 all KL = 0.142 +- 0.321 (in-sample avg dev_std = 0.330)
NEC for r=0.8 all L1 = 0.07 +- 0.179 (in-sample avg dev_std = 0.330)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.957
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.29553720000000006
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.526
NEC for r=0.05 class 0.0 = 0.175 +- 0.476 (in-sample avg dev_std = 0.015)
NEC for r=0.05 class 1.0 = 0.608 +- 0.476 (in-sample avg dev_std = 0.015)
NEC for r=0.05 all KL = 0.456 +- 0.476 (in-sample avg dev_std = 0.015)
NEC for r=0.05 all L1 = 0.393 +- 0.408 (in-sample avg dev_std = 0.015)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.957
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.164454
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.617
NEC for r=0.1 class 0.0 = 0.324 +- 0.469 (in-sample avg dev_std = 0.322)
NEC for r=0.1 class 1.0 = 0.332 +- 0.469 (in-sample avg dev_std = 0.322)
NEC for r=0.1 all KL = 0.423 +- 0.469 (in-sample avg dev_std = 0.322)
NEC for r=0.1 all L1 = 0.328 +- 0.380 (in-sample avg dev_std = 0.322)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.957
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08715619999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.774
NEC for r=0.2 class 0.0 = 0.356 +- 0.433 (in-sample avg dev_std = 0.393)
NEC for r=0.2 class 1.0 = 0.031 +- 0.433 (in-sample avg dev_std = 0.393)
NEC for r=0.2 all KL = 0.284 +- 0.433 (in-sample avg dev_std = 0.393)
NEC for r=0.2 all L1 = 0.192 +- 0.317 (in-sample avg dev_std = 0.393)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.957
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04494
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.781
NEC for r=0.4 class 0.0 = 0.362 +- 0.430 (in-sample avg dev_std = 0.374)
NEC for r=0.4 class 1.0 = 0.003 +- 0.430 (in-sample avg dev_std = 0.374)
NEC for r=0.4 all KL = 0.251 +- 0.430 (in-sample avg dev_std = 0.374)
NEC for r=0.4 all L1 = 0.181 +- 0.321 (in-sample avg dev_std = 0.374)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.957
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0228408
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.796
NEC for r=0.8 class 0.0 = 0.348 +- 0.428 (in-sample avg dev_std = 0.408)
NEC for r=0.8 class 1.0 = 0.001 +- 0.428 (in-sample avg dev_std = 0.408)
NEC for r=0.8 all KL = 0.249 +- 0.428 (in-sample avg dev_std = 0.408)
NEC for r=0.8 all L1 = 0.173 +- 0.310 (in-sample avg dev_std = 0.408)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3669036
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.649
NEC for r=0.05 class 0.0 = 0.033 +- 0.478 (in-sample avg dev_std = 0.201)
NEC for r=0.05 class 1.0 = 0.588 +- 0.478 (in-sample avg dev_std = 0.201)
NEC for r=0.05 all KL = 0.364 +- 0.478 (in-sample avg dev_std = 0.201)
NEC for r=0.05 all L1 = 0.307 +- 0.406 (in-sample avg dev_std = 0.201)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3018496
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.701
NEC for r=0.1 class 0.0 = 0.045 +- 0.470 (in-sample avg dev_std = 0.373)
NEC for r=0.1 class 1.0 = 0.527 +- 0.470 (in-sample avg dev_std = 0.373)
NEC for r=0.1 all KL = 0.384 +- 0.470 (in-sample avg dev_std = 0.373)
NEC for r=0.1 all L1 = 0.283 +- 0.369 (in-sample avg dev_std = 0.373)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23168560000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.799
NEC for r=0.2 class 0.0 = 0.063 +- 0.419 (in-sample avg dev_std = 0.350)
NEC for r=0.2 class 1.0 = 0.324 +- 0.419 (in-sample avg dev_std = 0.350)
NEC for r=0.2 all KL = 0.299 +- 0.419 (in-sample avg dev_std = 0.350)
NEC for r=0.2 all L1 = 0.192 +- 0.307 (in-sample avg dev_std = 0.350)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.170355
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.902
NEC for r=0.4 class 0.0 = 0.086 +- 0.307 (in-sample avg dev_std = 0.238)
NEC for r=0.4 class 1.0 = 0.079 +- 0.307 (in-sample avg dev_std = 0.238)
NEC for r=0.4 all KL = 0.14 +- 0.307 (in-sample avg dev_std = 0.238)
NEC for r=0.4 all L1 = 0.083 +- 0.214 (in-sample avg dev_std = 0.238)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.12148319999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.905
NEC for r=0.8 class 0.0 = 0.087 +- 0.300 (in-sample avg dev_std = 0.191)
NEC for r=0.8 class 1.0 = 0.066 +- 0.300 (in-sample avg dev_std = 0.191)
NEC for r=0.8 all KL = 0.116 +- 0.300 (in-sample avg dev_std = 0.191)
NEC for r=0.8 all L1 = 0.077 +- 0.217 (in-sample avg dev_std = 0.191)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 09:40:25 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 09:40:25 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 09:40:25 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 09:40:25 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 09:40:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:40:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:40:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:40:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:40:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:40:25 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 09:40:25 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.507
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.427
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.289
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.185
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.108
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.250
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.137
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.073
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.038
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.020
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.265
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.211
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.154
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.121
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.097


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5074919999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.882
SUFF_SIMPLE for r=0.05 class 0.0 = 0.711 +- 0.392 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.997 +- 0.392 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.05 all KL = 0.794 +- 0.392 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.05 all L1 = 0.869 +- 0.269 (in-sample avg dev_std = 0.375)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.42704999999999993
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.878
SUFF_SIMPLE for r=0.1 class 0.0 = 0.704 +- 0.393 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.393 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.1 all KL = 0.802 +- 0.393 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.1 all L1 = 0.867 +- 0.276 (in-sample avg dev_std = 0.373)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.288848
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.877
SUFF_SIMPLE for r=0.2 class 0.0 = 0.703 +- 0.393 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.393 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.2 all KL = 0.8 +- 0.393 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.2 all L1 = 0.868 +- 0.276 (in-sample avg dev_std = 0.375)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.18531999999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.886
SUFF_SIMPLE for r=0.4 class 0.0 = 0.719 +- 0.385 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.385 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.4 all KL = 0.812 +- 0.385 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.4 all L1 = 0.874 +- 0.270 (in-sample avg dev_std = 0.375)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10813399999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.97
SUFF_SIMPLE for r=0.8 class 0.0 = 0.909 +- 0.263 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.263 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.8 all KL = 0.917 +- 0.263 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.8 all L1 = 0.959 +- 0.140 (in-sample avg dev_std = 0.262)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.682
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2501604
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.755
SUFF_SIMPLE for r=0.05 class 0.0 = 0.564 +- 0.487 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.443 +- 0.487 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.05 all KL = 0.429 +- 0.487 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.05 all L1 = 0.503 +- 0.418 (in-sample avg dev_std = 0.171)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.682
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.136849
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.757
SUFF_SIMPLE for r=0.1 class 0.0 = 0.566 +- 0.487 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.443 +- 0.487 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.1 all KL = 0.429 +- 0.487 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.1 all L1 = 0.504 +- 0.418 (in-sample avg dev_std = 0.185)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.682
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07258699999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.76
SUFF_SIMPLE for r=0.2 class 0.0 = 0.568 +- 0.487 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.443 +- 0.487 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.2 all KL = 0.429 +- 0.487 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.2 all L1 = 0.505 +- 0.417 (in-sample avg dev_std = 0.205)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.682
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.038020399999999996
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.766
SUFF_SIMPLE for r=0.4 class 0.0 = 0.573 +- 0.487 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.443 +- 0.487 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.4 all KL = 0.43 +- 0.487 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.4 all L1 = 0.508 +- 0.415 (in-sample avg dev_std = 0.240)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.682
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0199446
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.828
SUFF_SIMPLE for r=0.8 class 0.0 = 0.684 +- 0.489 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.443 +- 0.489 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.8 all KL = 0.489 +- 0.489 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.8 all L1 = 0.563 +- 0.419 (in-sample avg dev_std = 0.195)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.828
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2653514
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.803
SUFF_SIMPLE for r=0.05 class 0.0 = 0.885 +- 0.304 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.889 +- 0.304 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.05 all KL = 0.847 +- 0.304 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.05 all L1 = 0.887 +- 0.244 (in-sample avg dev_std = 0.205)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.828
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.210971
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.804
SUFF_SIMPLE for r=0.1 class 0.0 = 0.887 +- 0.304 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.893 +- 0.304 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.1 all KL = 0.853 +- 0.304 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.1 all L1 = 0.89 +- 0.244 (in-sample avg dev_std = 0.202)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.828
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1541828
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.804
SUFF_SIMPLE for r=0.2 class 0.0 = 0.888 +- 0.307 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.899 +- 0.307 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.2 all KL = 0.863 +- 0.307 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.2 all L1 = 0.893 +- 0.246 (in-sample avg dev_std = 0.213)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.828
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1210356
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.813
SUFF_SIMPLE for r=0.4 class 0.0 = 0.9 +- 0.304 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.894 +- 0.304 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.4 all KL = 0.868 +- 0.304 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.4 all L1 = 0.897 +- 0.243 (in-sample avg dev_std = 0.221)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.829
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0970336
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.89
SUFF_SIMPLE for r=0.8 class 0.0 = 0.99 +- 0.266 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.856 +- 0.266 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.8 all KL = 0.907 +- 0.266 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.8 all L1 = 0.924 +- 0.216 (in-sample avg dev_std = 0.167)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5074919999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.722
NEC for r=0.05 class 0.0 = 0.004 +- 0.458 (in-sample avg dev_std = 0.204)
NEC for r=0.05 class 1.0 = 0.453 +- 0.458 (in-sample avg dev_std = 0.204)
NEC for r=0.05 all KL = 0.308 +- 0.458 (in-sample avg dev_std = 0.204)
NEC for r=0.05 all L1 = 0.253 +- 0.382 (in-sample avg dev_std = 0.204)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.42704999999999993
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.886
NEC for r=0.1 class 0.0 = 0.014 +- 0.369 (in-sample avg dev_std = 0.311)
NEC for r=0.1 class 1.0 = 0.206 +- 0.369 (in-sample avg dev_std = 0.311)
NEC for r=0.1 all KL = 0.196 +- 0.369 (in-sample avg dev_std = 0.311)
NEC for r=0.1 all L1 = 0.12 +- 0.257 (in-sample avg dev_std = 0.311)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.288848
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.963
NEC for r=0.2 class 0.0 = 0.039 +- 0.241 (in-sample avg dev_std = 0.203)
NEC for r=0.2 class 1.0 = 0.045 +- 0.241 (in-sample avg dev_std = 0.203)
NEC for r=0.2 all KL = 0.081 +- 0.241 (in-sample avg dev_std = 0.203)
NEC for r=0.2 all L1 = 0.042 +- 0.150 (in-sample avg dev_std = 0.203)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.18531999999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.956
NEC for r=0.4 class 0.0 = 0.085 +- 0.263 (in-sample avg dev_std = 0.228)
NEC for r=0.4 class 1.0 = 0.021 +- 0.263 (in-sample avg dev_std = 0.228)
NEC for r=0.4 all KL = 0.084 +- 0.263 (in-sample avg dev_std = 0.228)
NEC for r=0.4 all L1 = 0.049 +- 0.172 (in-sample avg dev_std = 0.228)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10813399999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.967
NEC for r=0.8 class 0.0 = 0.093 +- 0.259 (in-sample avg dev_std = 0.244)
NEC for r=0.8 class 1.0 = 0.0 +- 0.259 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all KL = 0.085 +- 0.259 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all L1 = 0.042 +- 0.146 (in-sample avg dev_std = 0.244)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.682
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2501604
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.380 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.334 +- 0.380 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.187 +- 0.380 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.168 +- 0.334 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.682
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.136849
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.563
NEC for r=0.1 class 0.0 = 0.02 +- 0.444 (in-sample avg dev_std = 0.407)
NEC for r=0.1 class 1.0 = 0.445 +- 0.444 (in-sample avg dev_std = 0.407)
NEC for r=0.1 all KL = 0.327 +- 0.444 (in-sample avg dev_std = 0.407)
NEC for r=0.1 all L1 = 0.234 +- 0.337 (in-sample avg dev_std = 0.407)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.682
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07258699999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.887
NEC for r=0.2 class 0.0 = 0.125 +- 0.467 (in-sample avg dev_std = 0.516)
NEC for r=0.2 class 1.0 = 0.546 +- 0.467 (in-sample avg dev_std = 0.516)
NEC for r=0.2 all KL = 0.473 +- 0.467 (in-sample avg dev_std = 0.516)
NEC for r=0.2 all L1 = 0.337 +- 0.363 (in-sample avg dev_std = 0.516)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.682
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.038020399999999996
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.92
NEC for r=0.4 class 0.0 = 0.164 +- 0.476 (in-sample avg dev_std = 0.431)
NEC for r=0.4 class 1.0 = 0.543 +- 0.476 (in-sample avg dev_std = 0.431)
NEC for r=0.4 all KL = 0.485 +- 0.476 (in-sample avg dev_std = 0.431)
NEC for r=0.4 all L1 = 0.355 +- 0.379 (in-sample avg dev_std = 0.431)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.682
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0199446
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.942
NEC for r=0.8 class 0.0 = 0.139 +- 0.476 (in-sample avg dev_std = 0.384)
NEC for r=0.8 class 1.0 = 0.549 +- 0.476 (in-sample avg dev_std = 0.384)
NEC for r=0.8 all KL = 0.469 +- 0.476 (in-sample avg dev_std = 0.384)
NEC for r=0.8 all L1 = 0.346 +- 0.382 (in-sample avg dev_std = 0.384)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.828
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2653514
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.654
NEC for r=0.05 class 0.0 = 0.023 +- 0.389 (in-sample avg dev_std = 0.039)
NEC for r=0.05 class 1.0 = 0.342 +- 0.389 (in-sample avg dev_std = 0.039)
NEC for r=0.05 all KL = 0.208 +- 0.389 (in-sample avg dev_std = 0.039)
NEC for r=0.05 all L1 = 0.181 +- 0.337 (in-sample avg dev_std = 0.039)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.828
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.210971
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.663
NEC for r=0.1 class 0.0 = 0.028 +- 0.389 (in-sample avg dev_std = 0.152)
NEC for r=0.1 class 1.0 = 0.337 +- 0.389 (in-sample avg dev_std = 0.152)
NEC for r=0.1 all KL = 0.211 +- 0.389 (in-sample avg dev_std = 0.152)
NEC for r=0.1 all L1 = 0.18 +- 0.331 (in-sample avg dev_std = 0.152)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.828
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1541828
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.735
NEC for r=0.2 class 0.0 = 0.045 +- 0.352 (in-sample avg dev_std = 0.321)
NEC for r=0.2 class 1.0 = 0.23 +- 0.352 (in-sample avg dev_std = 0.321)
NEC for r=0.2 all KL = 0.184 +- 0.352 (in-sample avg dev_std = 0.321)
NEC for r=0.2 all L1 = 0.136 +- 0.260 (in-sample avg dev_std = 0.321)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.828
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1210356
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.781
NEC for r=0.4 class 0.0 = 0.071 +- 0.269 (in-sample avg dev_std = 0.238)
NEC for r=0.4 class 1.0 = 0.1 +- 0.269 (in-sample avg dev_std = 0.238)
NEC for r=0.4 all KL = 0.118 +- 0.269 (in-sample avg dev_std = 0.238)
NEC for r=0.4 all L1 = 0.085 +- 0.199 (in-sample avg dev_std = 0.238)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.828
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0970336
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.793
NEC for r=0.8 class 0.0 = 0.077 +- 0.238 (in-sample avg dev_std = 0.170)
NEC for r=0.8 class 1.0 = 0.061 +- 0.238 (in-sample avg dev_std = 0.170)
NEC for r=0.8 all KL = 0.088 +- 0.238 (in-sample avg dev_std = 0.170)
NEC for r=0.8 all L1 = 0.069 +- 0.184 (in-sample avg dev_std = 0.170)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 09:55:43 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 09:55:43 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 09:55:43 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 09:55:43 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 09:55:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:55:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:55:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:55:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:55:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:55:43 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 09:55:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 88 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0038
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0053
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0046
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0053
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0046

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0038
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0053
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0046
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0053
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0046

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.341
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.290
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.203
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.125
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.095
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.129
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.074
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.042
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.023
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.196
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.142
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.098
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.070
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.074


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.34084400000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.832
SUFF_SIMPLE for r=0.05 class 0.0 = 0.645 +- 0.414 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.914 +- 0.414 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.05 all KL = 0.683 +- 0.414 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.05 all L1 = 0.794 +- 0.293 (in-sample avg dev_std = 0.404)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.290016
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.834
SUFF_SIMPLE for r=0.1 class 0.0 = 0.652 +- 0.413 (in-sample avg dev_std = 0.396)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.922 +- 0.413 (in-sample avg dev_std = 0.396)
SUFF_SIMPLE for r=0.1 all KL = 0.697 +- 0.413 (in-sample avg dev_std = 0.396)
SUFF_SIMPLE for r=0.1 all L1 = 0.801 +- 0.292 (in-sample avg dev_std = 0.396)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20252599999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.863
SUFF_SIMPLE for r=0.2 class 0.0 = 0.682 +- 0.398 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.947 +- 0.398 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.2 all KL = 0.731 +- 0.398 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.2 all L1 = 0.829 +- 0.272 (in-sample avg dev_std = 0.383)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.12509399999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.908
SUFF_SIMPLE for r=0.4 class 0.0 = 0.741 +- 0.362 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.978 +- 0.362 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.4 all KL = 0.797 +- 0.362 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.4 all L1 = 0.873 +- 0.235 (in-sample avg dev_std = 0.346)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.094814
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.97
SUFF_SIMPLE for r=0.8 class 0.0 = 0.924 +- 0.225 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.985 +- 0.225 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.8 all KL = 0.932 +- 0.225 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.8 all L1 = 0.958 +- 0.139 (in-sample avg dev_std = 0.202)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1285566
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.619
SUFF_SIMPLE for r=0.05 class 0.0 = 0.337 +- 0.461 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.92 +- 0.461 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.05 all KL = 0.549 +- 0.461 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.05 all L1 = 0.631 +- 0.389 (in-sample avg dev_std = 0.198)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.07448060000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.613
SUFF_SIMPLE for r=0.1 class 0.0 = 0.325 +- 0.463 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.92 +- 0.463 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 all KL = 0.539 +- 0.463 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 all L1 = 0.625 +- 0.388 (in-sample avg dev_std = 0.208)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.041658799999999996
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.604
SUFF_SIMPLE for r=0.2 class 0.0 = 0.303 +- 0.466 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.92 +- 0.466 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.2 all KL = 0.525 +- 0.466 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.2 all L1 = 0.614 +- 0.387 (in-sample avg dev_std = 0.223)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.022569400000000003
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.594
SUFF_SIMPLE for r=0.4 class 0.0 = 0.287 +- 0.469 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.92 +- 0.469 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.4 all KL = 0.522 +- 0.469 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.4 all L1 = 0.606 +- 0.390 (in-sample avg dev_std = 0.231)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0124992
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.74
SUFF_SIMPLE for r=0.8 class 0.0 = 0.549 +- 0.423 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.423 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.8 all KL = 0.672 +- 0.423 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.8 all L1 = 0.731 +- 0.350 (in-sample avg dev_std = 0.177)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.657
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1956148
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.627
SUFF_SIMPLE for r=0.05 class 0.0 = 0.843 +- 0.419 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.57 +- 0.419 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.05 all KL = 0.654 +- 0.419 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.05 all L1 = 0.708 +- 0.343 (in-sample avg dev_std = 0.285)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.657
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1417826
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.639
SUFF_SIMPLE for r=0.1 class 0.0 = 0.844 +- 0.409 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.6 +- 0.409 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.1 all KL = 0.676 +- 0.409 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.1 all L1 = 0.723 +- 0.338 (in-sample avg dev_std = 0.256)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.657
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0976096
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.669
SUFF_SIMPLE for r=0.2 class 0.0 = 0.864 +- 0.387 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.66 +- 0.387 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.2 all KL = 0.72 +- 0.387 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.2 all L1 = 0.763 +- 0.316 (in-sample avg dev_std = 0.249)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.657
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06963079999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.718
SUFF_SIMPLE for r=0.4 class 0.0 = 0.915 +- 0.353 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.696 +- 0.353 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.4 all KL = 0.774 +- 0.353 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.4 all L1 = 0.807 +- 0.287 (in-sample avg dev_std = 0.246)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.658
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0743998
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.701
SUFF_SIMPLE for r=0.8 class 0.0 = 0.976 +- 0.254 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.789 +- 0.254 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.8 all KL = 0.886 +- 0.254 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.8 all L1 = 0.883 +- 0.225 (in-sample avg dev_std = 0.098)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.34084400000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.568
NEC for r=0.05 class 0.0 = 0.102 +- 0.475 (in-sample avg dev_std = 0.192)
NEC for r=0.05 class 1.0 = 0.65 +- 0.475 (in-sample avg dev_std = 0.192)
NEC for r=0.05 all KL = 0.495 +- 0.475 (in-sample avg dev_std = 0.192)
NEC for r=0.05 all L1 = 0.406 +- 0.404 (in-sample avg dev_std = 0.192)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.290016
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.645
NEC for r=0.1 class 0.0 = 0.235 +- 0.428 (in-sample avg dev_std = 0.465)
NEC for r=0.1 class 1.0 = 0.505 +- 0.428 (in-sample avg dev_std = 0.465)
NEC for r=0.1 all KL = 0.562 +- 0.428 (in-sample avg dev_std = 0.465)
NEC for r=0.1 all L1 = 0.385 +- 0.346 (in-sample avg dev_std = 0.465)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20252599999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.753
NEC for r=0.2 class 0.0 = 0.292 +- 0.426 (in-sample avg dev_std = 0.450)
NEC for r=0.2 class 1.0 = 0.277 +- 0.426 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all KL = 0.439 +- 0.426 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all L1 = 0.284 +- 0.319 (in-sample avg dev_std = 0.450)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.12509399999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.887
NEC for r=0.4 class 0.0 = 0.229 +- 0.366 (in-sample avg dev_std = 0.370)
NEC for r=0.4 class 1.0 = 0.083 +- 0.366 (in-sample avg dev_std = 0.370)
NEC for r=0.4 all KL = 0.246 +- 0.366 (in-sample avg dev_std = 0.370)
NEC for r=0.4 all L1 = 0.148 +- 0.245 (in-sample avg dev_std = 0.370)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.094814
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.933
NEC for r=0.8 class 0.0 = 0.182 +- 0.321 (in-sample avg dev_std = 0.326)
NEC for r=0.8 class 1.0 = 0.039 +- 0.321 (in-sample avg dev_std = 0.326)
NEC for r=0.8 all KL = 0.188 +- 0.321 (in-sample avg dev_std = 0.326)
NEC for r=0.8 all L1 = 0.103 +- 0.193 (in-sample avg dev_std = 0.326)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1285566
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.531
NEC for r=0.05 class 0.0 = 0.108 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.749 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.488 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.431 +- 0.404 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.07448060000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.58
NEC for r=0.1 class 0.0 = 0.2 +- 0.442 (in-sample avg dev_std = 0.455)
NEC for r=0.1 class 1.0 = 0.64 +- 0.442 (in-sample avg dev_std = 0.455)
NEC for r=0.1 all KL = 0.541 +- 0.442 (in-sample avg dev_std = 0.455)
NEC for r=0.1 all L1 = 0.422 +- 0.359 (in-sample avg dev_std = 0.455)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.041658799999999996
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.732
NEC for r=0.2 class 0.0 = 0.411 +- 0.407 (in-sample avg dev_std = 0.516)
NEC for r=0.2 class 1.0 = 0.201 +- 0.407 (in-sample avg dev_std = 0.516)
NEC for r=0.2 all KL = 0.44 +- 0.407 (in-sample avg dev_std = 0.516)
NEC for r=0.2 all L1 = 0.305 +- 0.307 (in-sample avg dev_std = 0.516)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.022569400000000003
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.768
NEC for r=0.4 class 0.0 = 0.415 +- 0.413 (in-sample avg dev_std = 0.382)
NEC for r=0.4 class 1.0 = 0.103 +- 0.413 (in-sample avg dev_std = 0.382)
NEC for r=0.4 all KL = 0.341 +- 0.413 (in-sample avg dev_std = 0.382)
NEC for r=0.4 all L1 = 0.258 +- 0.322 (in-sample avg dev_std = 0.382)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0124992
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.773
NEC for r=0.8 class 0.0 = 0.421 +- 0.421 (in-sample avg dev_std = 0.346)
NEC for r=0.8 class 1.0 = 0.084 +- 0.421 (in-sample avg dev_std = 0.346)
NEC for r=0.8 all KL = 0.329 +- 0.421 (in-sample avg dev_std = 0.346)
NEC for r=0.8 all L1 = 0.251 +- 0.326 (in-sample avg dev_std = 0.346)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.657
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1956148
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.564
NEC for r=0.05 class 0.0 = 0.059 +- 0.309 (in-sample avg dev_std = 0.011)
NEC for r=0.05 class 1.0 = 0.237 +- 0.309 (in-sample avg dev_std = 0.011)
NEC for r=0.05 all KL = 0.146 +- 0.309 (in-sample avg dev_std = 0.011)
NEC for r=0.05 all L1 = 0.147 +- 0.278 (in-sample avg dev_std = 0.011)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.657
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1417826
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.543
NEC for r=0.1 class 0.0 = 0.075 +- 0.335 (in-sample avg dev_std = 0.039)
NEC for r=0.1 class 1.0 = 0.264 +- 0.335 (in-sample avg dev_std = 0.039)
NEC for r=0.1 all KL = 0.174 +- 0.335 (in-sample avg dev_std = 0.039)
NEC for r=0.1 all L1 = 0.168 +- 0.295 (in-sample avg dev_std = 0.039)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.657
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0976096
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.54
NEC for r=0.2 class 0.0 = 0.102 +- 0.352 (in-sample avg dev_std = 0.122)
NEC for r=0.2 class 1.0 = 0.274 +- 0.352 (in-sample avg dev_std = 0.122)
NEC for r=0.2 all KL = 0.202 +- 0.352 (in-sample avg dev_std = 0.122)
NEC for r=0.2 all L1 = 0.187 +- 0.303 (in-sample avg dev_std = 0.122)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.657
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06963079999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.605
NEC for r=0.4 class 0.0 = 0.134 +- 0.350 (in-sample avg dev_std = 0.281)
NEC for r=0.4 class 1.0 = 0.245 +- 0.350 (in-sample avg dev_std = 0.281)
NEC for r=0.4 all KL = 0.225 +- 0.350 (in-sample avg dev_std = 0.281)
NEC for r=0.4 all L1 = 0.189 +- 0.279 (in-sample avg dev_std = 0.281)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.657
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0743998
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.621
NEC for r=0.8 class 0.0 = 0.152 +- 0.369 (in-sample avg dev_std = 0.296)
NEC for r=0.8 class 1.0 = 0.272 +- 0.369 (in-sample avg dev_std = 0.296)
NEC for r=0.8 all KL = 0.251 +- 0.369 (in-sample avg dev_std = 0.296)
NEC for r=0.8 all L1 = 0.211 +- 0.298 (in-sample avg dev_std = 0.296)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 10:10:57 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:10:57 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:10:57 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:10:57 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:10:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:10:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:10:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:10:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:10:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:10:57 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:10:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 66 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.9972
Train Loss: 0.0102
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0090
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0138
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0090
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.9972
Train Loss: 0.0102
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0090
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0138
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0090
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0138

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.453
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.377
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.248
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.149
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.100
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.152
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.083
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.045
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.025
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.014
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.252
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.189
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.130
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.091
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.084


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.453204
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.803
SUFF_SIMPLE for r=0.05 class 0.0 = 0.603 +- 0.426 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.918 +- 0.426 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.05 all KL = 0.67 +- 0.426 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.05 all L1 = 0.778 +- 0.317 (in-sample avg dev_std = 0.383)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.37665
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.799
SUFF_SIMPLE for r=0.1 class 0.0 = 0.607 +- 0.426 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.919 +- 0.426 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.1 all KL = 0.68 +- 0.426 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.1 all L1 = 0.78 +- 0.322 (in-sample avg dev_std = 0.364)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.248162
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.813
SUFF_SIMPLE for r=0.2 class 0.0 = 0.62 +- 0.421 (in-sample avg dev_std = 0.361)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.934 +- 0.421 (in-sample avg dev_std = 0.361)
SUFF_SIMPLE for r=0.2 all KL = 0.698 +- 0.421 (in-sample avg dev_std = 0.361)
SUFF_SIMPLE for r=0.2 all L1 = 0.794 +- 0.315 (in-sample avg dev_std = 0.361)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.149492
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.876
SUFF_SIMPLE for r=0.4 class 0.0 = 0.682 +- 0.392 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.972 +- 0.392 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.4 all KL = 0.75 +- 0.392 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.4 all L1 = 0.843 +- 0.268 (in-sample avg dev_std = 0.355)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10047
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.949
SUFF_SIMPLE for r=0.8 class 0.0 = 0.883 +- 0.267 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.968 +- 0.267 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.8 all KL = 0.897 +- 0.267 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.8 all L1 = 0.93 +- 0.192 (in-sample avg dev_std = 0.194)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.757
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1520886
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.704
SUFF_SIMPLE for r=0.05 class 0.0 = 0.425 +- 0.456 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.568 +- 0.456 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.05 all KL = 0.357 +- 0.456 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.05 all L1 = 0.497 +- 0.380 (in-sample avg dev_std = 0.381)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.757
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0831856
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.701
SUFF_SIMPLE for r=0.1 class 0.0 = 0.418 +- 0.455 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.568 +- 0.455 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.1 all KL = 0.353 +- 0.455 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.1 all L1 = 0.494 +- 0.378 (in-sample avg dev_std = 0.385)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.757
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.045058600000000004
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.695
SUFF_SIMPLE for r=0.2 class 0.0 = 0.407 +- 0.452 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.568 +- 0.452 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.2 all KL = 0.346 +- 0.452 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.2 all L1 = 0.488 +- 0.377 (in-sample avg dev_std = 0.388)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.757
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024718
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.677
SUFF_SIMPLE for r=0.4 class 0.0 = 0.375 +- 0.448 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.567 +- 0.448 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.4 all KL = 0.329 +- 0.448 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.4 all L1 = 0.472 +- 0.373 (in-sample avg dev_std = 0.382)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.757
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.014107600000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.708
SUFF_SIMPLE for r=0.8 class 0.0 = 0.456 +- 0.464 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.568 +- 0.464 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 all KL = 0.4 +- 0.464 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 all L1 = 0.512 +- 0.397 (in-sample avg dev_std = 0.189)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.658
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25195080000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.602
SUFF_SIMPLE for r=0.05 class 0.0 = 0.806 +- 0.440 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.612 +- 0.440 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.05 all KL = 0.62 +- 0.440 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.05 all L1 = 0.71 +- 0.354 (in-sample avg dev_std = 0.326)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.658
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1887576
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.605
SUFF_SIMPLE for r=0.1 class 0.0 = 0.804 +- 0.434 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.646 +- 0.434 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.1 all KL = 0.643 +- 0.434 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.1 all L1 = 0.726 +- 0.349 (in-sample avg dev_std = 0.293)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.658
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.129688
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.63
SUFF_SIMPLE for r=0.2 class 0.0 = 0.826 +- 0.412 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.721 +- 0.412 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.2 all KL = 0.702 +- 0.412 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.2 all L1 = 0.774 +- 0.326 (in-sample avg dev_std = 0.271)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.658
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09080840000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.667
SUFF_SIMPLE for r=0.4 class 0.0 = 0.862 +- 0.384 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.768 +- 0.384 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.4 all KL = 0.758 +- 0.384 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.4 all L1 = 0.816 +- 0.299 (in-sample avg dev_std = 0.262)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.659
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08438720000000001
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.7
SUFF_SIMPLE for r=0.8 class 0.0 = 0.971 +- 0.279 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.824 +- 0.279 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.8 all KL = 0.884 +- 0.279 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.8 all L1 = 0.898 +- 0.232 (in-sample avg dev_std = 0.133)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.453204
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.548
NEC for r=0.05 class 0.0 = 0.157 +- 0.479 (in-sample avg dev_std = 0.190)
NEC for r=0.05 class 1.0 = 0.62 +- 0.479 (in-sample avg dev_std = 0.190)
NEC for r=0.05 all KL = 0.51 +- 0.479 (in-sample avg dev_std = 0.190)
NEC for r=0.05 all L1 = 0.414 +- 0.404 (in-sample avg dev_std = 0.190)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.37665
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.647
NEC for r=0.1 class 0.0 = 0.282 +- 0.445 (in-sample avg dev_std = 0.439)
NEC for r=0.1 class 1.0 = 0.433 +- 0.445 (in-sample avg dev_std = 0.439)
NEC for r=0.1 all KL = 0.529 +- 0.445 (in-sample avg dev_std = 0.439)
NEC for r=0.1 all L1 = 0.365 +- 0.351 (in-sample avg dev_std = 0.439)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.248162
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.803
NEC for r=0.2 class 0.0 = 0.294 +- 0.421 (in-sample avg dev_std = 0.423)
NEC for r=0.2 class 1.0 = 0.175 +- 0.421 (in-sample avg dev_std = 0.423)
NEC for r=0.2 all KL = 0.362 +- 0.421 (in-sample avg dev_std = 0.423)
NEC for r=0.2 all L1 = 0.228 +- 0.301 (in-sample avg dev_std = 0.423)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.149492
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.88
NEC for r=0.4 class 0.0 = 0.268 +- 0.370 (in-sample avg dev_std = 0.340)
NEC for r=0.4 class 1.0 = 0.045 +- 0.370 (in-sample avg dev_std = 0.340)
NEC for r=0.4 all KL = 0.231 +- 0.370 (in-sample avg dev_std = 0.340)
NEC for r=0.4 all L1 = 0.144 +- 0.259 (in-sample avg dev_std = 0.340)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10047
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.913
NEC for r=0.8 class 0.0 = 0.215 +- 0.343 (in-sample avg dev_std = 0.326)
NEC for r=0.8 class 1.0 = 0.032 +- 0.343 (in-sample avg dev_std = 0.326)
NEC for r=0.8 all KL = 0.189 +- 0.343 (in-sample avg dev_std = 0.326)
NEC for r=0.8 all L1 = 0.113 +- 0.229 (in-sample avg dev_std = 0.326)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.757
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1520886
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.501
NEC for r=0.05 class 0.0 = 0.012 +- 0.427 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.457 +- 0.427 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.265 +- 0.427 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.236 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.757
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0831856
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.539
NEC for r=0.1 class 0.0 = 0.04 +- 0.439 (in-sample avg dev_std = 0.317)
NEC for r=0.1 class 1.0 = 0.469 +- 0.439 (in-sample avg dev_std = 0.317)
NEC for r=0.1 all KL = 0.334 +- 0.439 (in-sample avg dev_std = 0.317)
NEC for r=0.1 all L1 = 0.256 +- 0.356 (in-sample avg dev_std = 0.317)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.757
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.045058600000000004
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.77
NEC for r=0.2 class 0.0 = 0.166 +- 0.427 (in-sample avg dev_std = 0.585)
NEC for r=0.2 class 1.0 = 0.372 +- 0.427 (in-sample avg dev_std = 0.585)
NEC for r=0.2 all KL = 0.466 +- 0.427 (in-sample avg dev_std = 0.585)
NEC for r=0.2 all L1 = 0.27 +- 0.283 (in-sample avg dev_std = 0.585)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.757
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024718
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.826
NEC for r=0.4 class 0.0 = 0.169 +- 0.443 (in-sample avg dev_std = 0.479)
NEC for r=0.4 class 1.0 = 0.331 +- 0.443 (in-sample avg dev_std = 0.479)
NEC for r=0.4 all KL = 0.397 +- 0.443 (in-sample avg dev_std = 0.479)
NEC for r=0.4 all L1 = 0.251 +- 0.311 (in-sample avg dev_std = 0.479)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.757
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.014107600000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.844
NEC for r=0.8 class 0.0 = 0.147 +- 0.440 (in-sample avg dev_std = 0.416)
NEC for r=0.8 class 1.0 = 0.317 +- 0.440 (in-sample avg dev_std = 0.416)
NEC for r=0.8 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.416)
NEC for r=0.8 all L1 = 0.233 +- 0.315 (in-sample avg dev_std = 0.416)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.658
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25195080000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.565
NEC for r=0.05 class 0.0 = 0.049 +- 0.302 (in-sample avg dev_std = 0.010)
NEC for r=0.05 class 1.0 = 0.187 +- 0.302 (in-sample avg dev_std = 0.010)
NEC for r=0.05 all KL = 0.125 +- 0.302 (in-sample avg dev_std = 0.010)
NEC for r=0.05 all L1 = 0.117 +- 0.269 (in-sample avg dev_std = 0.010)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.658
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1887576
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.552
NEC for r=0.1 class 0.0 = 0.078 +- 0.346 (in-sample avg dev_std = 0.144)
NEC for r=0.1 class 1.0 = 0.22 +- 0.346 (in-sample avg dev_std = 0.144)
NEC for r=0.1 all KL = 0.195 +- 0.346 (in-sample avg dev_std = 0.144)
NEC for r=0.1 all L1 = 0.148 +- 0.280 (in-sample avg dev_std = 0.144)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.658
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.129688
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.548
NEC for r=0.2 class 0.0 = 0.117 +- 0.372 (in-sample avg dev_std = 0.245)
NEC for r=0.2 class 1.0 = 0.236 +- 0.372 (in-sample avg dev_std = 0.245)
NEC for r=0.2 all KL = 0.247 +- 0.372 (in-sample avg dev_std = 0.245)
NEC for r=0.2 all L1 = 0.176 +- 0.289 (in-sample avg dev_std = 0.245)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.658
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09080840000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.6
NEC for r=0.4 class 0.0 = 0.149 +- 0.363 (in-sample avg dev_std = 0.318)
NEC for r=0.4 class 1.0 = 0.203 +- 0.363 (in-sample avg dev_std = 0.318)
NEC for r=0.4 all KL = 0.258 +- 0.363 (in-sample avg dev_std = 0.318)
NEC for r=0.4 all L1 = 0.176 +- 0.270 (in-sample avg dev_std = 0.318)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.658
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08438720000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.61
NEC for r=0.8 class 0.0 = 0.172 +- 0.385 (in-sample avg dev_std = 0.317)
NEC for r=0.8 class 1.0 = 0.234 +- 0.385 (in-sample avg dev_std = 0.317)
NEC for r=0.8 all KL = 0.279 +- 0.385 (in-sample avg dev_std = 0.317)
NEC for r=0.8 all L1 = 0.203 +- 0.302 (in-sample avg dev_std = 0.317)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 10:25:52 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:25:52 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:25:52 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:25:52 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:25:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:25:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:25:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:25:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:25:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:25:52 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:25:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0000
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0000
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0000
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0000
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.510
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.426
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.318
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.208
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.121
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.241
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.132
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.069
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.037
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.019
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.307
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.241
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.190
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.146
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.106


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.51013
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.926
SUFF_SIMPLE for r=0.05 class 0.0 = 0.812 +- 0.354 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.984 +- 0.354 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.05 all KL = 0.831 +- 0.354 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.05 all L1 = 0.907 +- 0.217 (in-sample avg dev_std = 0.336)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.425676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.928
SUFF_SIMPLE for r=0.1 class 0.0 = 0.81 +- 0.343 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.997 +- 0.343 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 all KL = 0.847 +- 0.343 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 all L1 = 0.913 +- 0.215 (in-sample avg dev_std = 0.324)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.318306
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.938
SUFF_SIMPLE for r=0.2 class 0.0 = 0.833 +- 0.327 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.327 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.2 all KL = 0.859 +- 0.327 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.2 all L1 = 0.925 +- 0.195 (in-sample avg dev_std = 0.314)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.208474
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.964
SUFF_SIMPLE for r=0.4 class 0.0 = 0.898 +- 0.273 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.273 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.4 all KL = 0.904 +- 0.273 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.147 (in-sample avg dev_std = 0.256)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.120992
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.048 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.048 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.8 all KL = 0.997 +- 0.048 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.8 all L1 = 0.999 +- 0.014 (in-sample avg dev_std = 0.044)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.619
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.24126999999999998
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.795
SUFF_SIMPLE for r=0.05 class 0.0 = 0.643 +- 0.468 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.362 +- 0.468 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.05 all KL = 0.379 +- 0.468 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.05 all L1 = 0.501 +- 0.384 (in-sample avg dev_std = 0.350)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.619
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13151000000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.795
SUFF_SIMPLE for r=0.1 class 0.0 = 0.643 +- 0.468 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.362 +- 0.468 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 all KL = 0.379 +- 0.468 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 all L1 = 0.501 +- 0.384 (in-sample avg dev_std = 0.352)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.619
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06946799999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.802
SUFF_SIMPLE for r=0.2 class 0.0 = 0.652 +- 0.468 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.362 +- 0.468 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.2 all KL = 0.381 +- 0.468 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.2 all L1 = 0.506 +- 0.383 (in-sample avg dev_std = 0.364)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.619
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03662580000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.828
SUFF_SIMPLE for r=0.4 class 0.0 = 0.687 +- 0.468 (in-sample avg dev_std = 0.396)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.362 +- 0.468 (in-sample avg dev_std = 0.396)
SUFF_SIMPLE for r=0.4 all KL = 0.39 +- 0.468 (in-sample avg dev_std = 0.396)
SUFF_SIMPLE for r=0.4 all L1 = 0.523 +- 0.380 (in-sample avg dev_std = 0.396)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.619
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0193212
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.924
SUFF_SIMPLE for r=0.8 class 0.0 = 0.905 +- 0.481 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.362 +- 0.481 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.8 all KL = 0.556 +- 0.481 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.8 all L1 = 0.631 +- 0.402 (in-sample avg dev_std = 0.128)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.798
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3073686
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.768
SUFF_SIMPLE for r=0.05 class 0.0 = 0.877 +- 0.367 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.87 +- 0.367 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.05 all KL = 0.809 +- 0.367 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.05 all L1 = 0.874 +- 0.262 (in-sample avg dev_std = 0.185)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.798
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.240738
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.769
SUFF_SIMPLE for r=0.1 class 0.0 = 0.878 +- 0.342 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.897 +- 0.342 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.1 all KL = 0.844 +- 0.342 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.1 all L1 = 0.887 +- 0.261 (in-sample avg dev_std = 0.153)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.798
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1904696
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.775
SUFF_SIMPLE for r=0.2 class 0.0 = 0.889 +- 0.316 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.913 +- 0.316 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.2 all KL = 0.875 +- 0.316 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.2 all L1 = 0.901 +- 0.256 (in-sample avg dev_std = 0.123)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.798
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14586240000000003
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.79
SUFF_SIMPLE for r=0.4 class 0.0 = 0.912 +- 0.290 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.922 +- 0.290 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.4 all KL = 0.897 +- 0.290 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.4 all L1 = 0.917 +- 0.238 (in-sample avg dev_std = 0.110)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.799
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10550900000000002
len(reference) = 4991
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.837
SUFF_SIMPLE for r=0.8 class 0.0 = 0.994 +- 0.208 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.917 +- 0.208 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.8 all KL = 0.947 +- 0.208 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.8 all L1 = 0.956 +- 0.175 (in-sample avg dev_std = 0.036)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.51013
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.609
NEC for r=0.05 class 0.0 = 0.001 +- 0.489 (in-sample avg dev_std = 0.174)
NEC for r=0.05 class 1.0 = 0.622 +- 0.489 (in-sample avg dev_std = 0.174)
NEC for r=0.05 all KL = 0.413 +- 0.489 (in-sample avg dev_std = 0.174)
NEC for r=0.05 all L1 = 0.345 +- 0.415 (in-sample avg dev_std = 0.174)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.425676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.795
NEC for r=0.1 class 0.0 = 0.009 +- 0.451 (in-sample avg dev_std = 0.434)
NEC for r=0.1 class 1.0 = 0.393 +- 0.451 (in-sample avg dev_std = 0.434)
NEC for r=0.1 all KL = 0.36 +- 0.451 (in-sample avg dev_std = 0.434)
NEC for r=0.1 all L1 = 0.222 +- 0.318 (in-sample avg dev_std = 0.434)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.318306
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.883
NEC for r=0.2 class 0.0 = 0.056 +- 0.381 (in-sample avg dev_std = 0.319)
NEC for r=0.2 class 1.0 = 0.187 +- 0.381 (in-sample avg dev_std = 0.319)
NEC for r=0.2 all KL = 0.226 +- 0.381 (in-sample avg dev_std = 0.319)
NEC for r=0.2 all L1 = 0.129 +- 0.258 (in-sample avg dev_std = 0.319)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.208474
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.934
NEC for r=0.4 class 0.0 = 0.08 +- 0.319 (in-sample avg dev_std = 0.282)
NEC for r=0.4 class 1.0 = 0.072 +- 0.319 (in-sample avg dev_std = 0.282)
NEC for r=0.4 all KL = 0.139 +- 0.319 (in-sample avg dev_std = 0.282)
NEC for r=0.4 all L1 = 0.075 +- 0.201 (in-sample avg dev_std = 0.282)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.120992
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.975
NEC for r=0.8 class 0.0 = 0.065 +- 0.234 (in-sample avg dev_std = 0.232)
NEC for r=0.8 class 1.0 = 0.01 +- 0.234 (in-sample avg dev_std = 0.232)
NEC for r=0.8 all KL = 0.075 +- 0.234 (in-sample avg dev_std = 0.232)
NEC for r=0.8 all L1 = 0.034 +- 0.124 (in-sample avg dev_std = 0.232)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.619
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.24126999999999998
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.231 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.124 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.116 +- 0.281 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.619
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13151000000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.509
NEC for r=0.1 class 0.0 = 0.0 +- 0.335 (in-sample avg dev_std = 0.179)
NEC for r=0.1 class 1.0 = 0.256 +- 0.335 (in-sample avg dev_std = 0.179)
NEC for r=0.1 all KL = 0.162 +- 0.335 (in-sample avg dev_std = 0.179)
NEC for r=0.1 all L1 = 0.129 +- 0.280 (in-sample avg dev_std = 0.179)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.619
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06946799999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.798
NEC for r=0.2 class 0.0 = 0.008 +- 0.447 (in-sample avg dev_std = 0.542)
NEC for r=0.2 class 1.0 = 0.513 +- 0.447 (in-sample avg dev_std = 0.542)
NEC for r=0.2 all KL = 0.398 +- 0.447 (in-sample avg dev_std = 0.542)
NEC for r=0.2 all L1 = 0.263 +- 0.314 (in-sample avg dev_std = 0.542)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.619
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03662580000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.885
NEC for r=0.4 class 0.0 = 0.036 +- 0.463 (in-sample avg dev_std = 0.434)
NEC for r=0.4 class 1.0 = 0.57 +- 0.463 (in-sample avg dev_std = 0.434)
NEC for r=0.4 all KL = 0.423 +- 0.463 (in-sample avg dev_std = 0.434)
NEC for r=0.4 all L1 = 0.305 +- 0.357 (in-sample avg dev_std = 0.434)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.619
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0193212
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.907
NEC for r=0.8 class 0.0 = 0.044 +- 0.466 (in-sample avg dev_std = 0.377)
NEC for r=0.8 class 1.0 = 0.583 +- 0.466 (in-sample avg dev_std = 0.377)
NEC for r=0.8 all KL = 0.428 +- 0.466 (in-sample avg dev_std = 0.377)
NEC for r=0.8 all L1 = 0.315 +- 0.368 (in-sample avg dev_std = 0.377)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.798
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3073686
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.631
NEC for r=0.05 class 0.0 = 0.028 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.305 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.188 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.165 +- 0.332 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.798
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.240738
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.634
NEC for r=0.1 class 0.0 = 0.039 +- 0.399 (in-sample avg dev_std = 0.157)
NEC for r=0.1 class 1.0 = 0.324 +- 0.399 (in-sample avg dev_std = 0.157)
NEC for r=0.1 all KL = 0.225 +- 0.399 (in-sample avg dev_std = 0.157)
NEC for r=0.1 all L1 = 0.18 +- 0.333 (in-sample avg dev_std = 0.157)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.798
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1904696
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.676
NEC for r=0.2 class 0.0 = 0.06 +- 0.417 (in-sample avg dev_std = 0.368)
NEC for r=0.2 class 1.0 = 0.317 +- 0.417 (in-sample avg dev_std = 0.368)
NEC for r=0.2 all KL = 0.266 +- 0.417 (in-sample avg dev_std = 0.368)
NEC for r=0.2 all L1 = 0.187 +- 0.311 (in-sample avg dev_std = 0.368)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.798
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14586240000000003
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.721
NEC for r=0.4 class 0.0 = 0.092 +- 0.384 (in-sample avg dev_std = 0.350)
NEC for r=0.4 class 1.0 = 0.2 +- 0.384 (in-sample avg dev_std = 0.350)
NEC for r=0.4 all KL = 0.238 +- 0.384 (in-sample avg dev_std = 0.350)
NEC for r=0.4 all L1 = 0.145 +- 0.266 (in-sample avg dev_std = 0.350)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.798
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10550900000000002
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.751
NEC for r=0.8 class 0.0 = 0.094 +- 0.349 (in-sample avg dev_std = 0.273)
NEC for r=0.8 class 1.0 = 0.139 +- 0.349 (in-sample avg dev_std = 0.273)
NEC for r=0.8 all KL = 0.185 +- 0.349 (in-sample avg dev_std = 0.273)
NEC for r=0.8 all L1 = 0.116 +- 0.243 (in-sample avg dev_std = 0.273)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 10:40:32 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:40:32 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:40:32 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:40:32 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:40:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:40:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:40:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:40:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:40:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:40:32 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:40:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0002
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0002
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0002
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0002

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0002
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0002
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0002
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0002

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.535
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.500
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.370
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.241
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.147
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.238
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.130
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.070
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.037
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.020
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.349
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.292
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.223
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.168
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.127


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5350560000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.893
SUFF_SIMPLE for r=0.05 class 0.0 = 0.78 +- 0.372 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.968 +- 0.372 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.05 all KL = 0.817 +- 0.372 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.05 all L1 = 0.884 +- 0.259 (in-sample avg dev_std = 0.309)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.499676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.882
SUFF_SIMPLE for r=0.1 class 0.0 = 0.779 +- 0.374 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.963 +- 0.374 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.1 all KL = 0.818 +- 0.374 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.1 all L1 = 0.881 +- 0.267 (in-sample avg dev_std = 0.284)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.36993
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.893
SUFF_SIMPLE for r=0.2 class 0.0 = 0.763 +- 0.360 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.989 +- 0.360 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.2 all KL = 0.832 +- 0.360 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.2 all L1 = 0.888 +- 0.261 (in-sample avg dev_std = 0.283)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.240702
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.892
SUFF_SIMPLE for r=0.4 class 0.0 = 0.753 +- 0.369 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.993 +- 0.369 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.4 all KL = 0.824 +- 0.369 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.4 all L1 = 0.886 +- 0.262 (in-sample avg dev_std = 0.282)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.146824
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.952
SUFF_SIMPLE for r=0.8 class 0.0 = 0.883 +- 0.264 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.264 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.8 all KL = 0.918 +- 0.264 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.8 all L1 = 0.948 +- 0.183 (in-sample avg dev_std = 0.183)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.564
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.23845619999999998
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.769
SUFF_SIMPLE for r=0.05 class 0.0 = 0.699 +- 0.456 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.363 +- 0.456 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.05 all KL = 0.38 +- 0.456 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.05 all L1 = 0.529 +- 0.382 (in-sample avg dev_std = 0.350)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.564
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13016
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.763
SUFF_SIMPLE for r=0.1 class 0.0 = 0.692 +- 0.456 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.363 +- 0.456 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.1 all KL = 0.379 +- 0.456 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.1 all L1 = 0.526 +- 0.384 (in-sample avg dev_std = 0.337)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.564
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0701918
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.758
SUFF_SIMPLE for r=0.2 class 0.0 = 0.684 +- 0.455 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.363 +- 0.455 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.2 all KL = 0.376 +- 0.455 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.2 all L1 = 0.522 +- 0.384 (in-sample avg dev_std = 0.334)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.564
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.037450199999999996
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.757
SUFF_SIMPLE for r=0.4 class 0.0 = 0.684 +- 0.456 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.363 +- 0.456 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.4 all KL = 0.377 +- 0.456 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.4 all L1 = 0.522 +- 0.385 (in-sample avg dev_std = 0.327)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.564
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0201228
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.758
SUFF_SIMPLE for r=0.8 class 0.0 = 0.713 +- 0.465 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.365 +- 0.465 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.8 all KL = 0.414 +- 0.465 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.8 all L1 = 0.538 +- 0.398 (in-sample avg dev_std = 0.173)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.771
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.34878200000000004
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.698
SUFF_SIMPLE for r=0.05 class 0.0 = 0.882 +- 0.425 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.709 +- 0.425 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.05 all KL = 0.72 +- 0.425 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.05 all L1 = 0.797 +- 0.323 (in-sample avg dev_std = 0.301)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.771
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2917012
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.708
SUFF_SIMPLE for r=0.1 class 0.0 = 0.868 +- 0.413 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.751 +- 0.413 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.1 all KL = 0.739 +- 0.413 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.1 all L1 = 0.81 +- 0.317 (in-sample avg dev_std = 0.251)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.771
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.22268539999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.73
SUFF_SIMPLE for r=0.2 class 0.0 = 0.876 +- 0.375 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.827 +- 0.375 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.2 all KL = 0.796 +- 0.375 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.2 all L1 = 0.852 +- 0.291 (in-sample avg dev_std = 0.214)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.771
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1677538
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.753
SUFF_SIMPLE for r=0.4 class 0.0 = 0.882 +- 0.342 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.884 +- 0.342 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.4 all KL = 0.839 +- 0.342 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.4 all L1 = 0.883 +- 0.263 (in-sample avg dev_std = 0.201)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.772
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1269028
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.798
SUFF_SIMPLE for r=0.8 class 0.0 = 0.971 +- 0.238 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.907 +- 0.238 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.8 all KL = 0.928 +- 0.238 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.8 all L1 = 0.939 +- 0.197 (in-sample avg dev_std = 0.057)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5350560000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.608
NEC for r=0.05 class 0.0 = 0.0 +- 0.488 (in-sample avg dev_std = 0.140)
NEC for r=0.05 class 1.0 = 0.632 +- 0.488 (in-sample avg dev_std = 0.140)
NEC for r=0.05 all KL = 0.417 +- 0.488 (in-sample avg dev_std = 0.140)
NEC for r=0.05 all L1 = 0.35 +- 0.415 (in-sample avg dev_std = 0.140)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.499676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.722
NEC for r=0.1 class 0.0 = 0.0 +- 0.461 (in-sample avg dev_std = 0.434)
NEC for r=0.1 class 1.0 = 0.516 +- 0.461 (in-sample avg dev_std = 0.434)
NEC for r=0.1 all KL = 0.419 +- 0.461 (in-sample avg dev_std = 0.434)
NEC for r=0.1 all L1 = 0.286 +- 0.351 (in-sample avg dev_std = 0.434)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.36993
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.895
NEC for r=0.2 class 0.0 = 0.003 +- 0.357 (in-sample avg dev_std = 0.322)
NEC for r=0.2 class 1.0 = 0.212 +- 0.357 (in-sample avg dev_std = 0.322)
NEC for r=0.2 all KL = 0.205 +- 0.357 (in-sample avg dev_std = 0.322)
NEC for r=0.2 all L1 = 0.119 +- 0.242 (in-sample avg dev_std = 0.322)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.240702
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.966
NEC for r=0.4 class 0.0 = 0.028 +- 0.252 (in-sample avg dev_std = 0.228)
NEC for r=0.4 class 1.0 = 0.059 +- 0.252 (in-sample avg dev_std = 0.228)
NEC for r=0.4 all KL = 0.096 +- 0.252 (in-sample avg dev_std = 0.228)
NEC for r=0.4 all L1 = 0.045 +- 0.135 (in-sample avg dev_std = 0.228)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.146824
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.977
NEC for r=0.8 class 0.0 = 0.056 +- 0.228 (in-sample avg dev_std = 0.221)
NEC for r=0.8 class 1.0 = 0.014 +- 0.228 (in-sample avg dev_std = 0.221)
NEC for r=0.8 all KL = 0.071 +- 0.228 (in-sample avg dev_std = 0.221)
NEC for r=0.8 all L1 = 0.032 +- 0.117 (in-sample avg dev_std = 0.221)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.564
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.23845619999999998
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.232 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.13 +- 0.232 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.067 +- 0.232 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.065 +- 0.214 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.564
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13016
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.0 +- 0.235 (in-sample avg dev_std = 0.042)
NEC for r=0.1 class 1.0 = 0.131 +- 0.235 (in-sample avg dev_std = 0.042)
NEC for r=0.1 all KL = 0.07 +- 0.235 (in-sample avg dev_std = 0.042)
NEC for r=0.1 all L1 = 0.066 +- 0.214 (in-sample avg dev_std = 0.042)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.564
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0701918
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.624
NEC for r=0.2 class 0.0 = 0.001 +- 0.388 (in-sample avg dev_std = 0.465)
NEC for r=0.2 class 1.0 = 0.298 +- 0.388 (in-sample avg dev_std = 0.465)
NEC for r=0.2 all KL = 0.276 +- 0.388 (in-sample avg dev_std = 0.465)
NEC for r=0.2 all L1 = 0.151 +- 0.232 (in-sample avg dev_std = 0.465)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.564
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.037450199999999996
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.778
NEC for r=0.4 class 0.0 = 0.012 +- 0.450 (in-sample avg dev_std = 0.465)
NEC for r=0.4 class 1.0 = 0.489 +- 0.450 (in-sample avg dev_std = 0.465)
NEC for r=0.4 all KL = 0.377 +- 0.450 (in-sample avg dev_std = 0.465)
NEC for r=0.4 all L1 = 0.252 +- 0.328 (in-sample avg dev_std = 0.465)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.564
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0201228
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.834
NEC for r=0.8 class 0.0 = 0.015 +- 0.461 (in-sample avg dev_std = 0.385)
NEC for r=0.8 class 1.0 = 0.553 +- 0.461 (in-sample avg dev_std = 0.385)
NEC for r=0.8 all KL = 0.398 +- 0.461 (in-sample avg dev_std = 0.385)
NEC for r=0.8 all L1 = 0.286 +- 0.358 (in-sample avg dev_std = 0.385)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.771
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.34878200000000004
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.612
NEC for r=0.05 class 0.0 = 0.021 +- 0.376 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.304 +- 0.376 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.182 +- 0.376 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.161 +- 0.327 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.771
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2917012
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.595
NEC for r=0.1 class 0.0 = 0.022 +- 0.392 (in-sample avg dev_std = 0.039)
NEC for r=0.1 class 1.0 = 0.339 +- 0.392 (in-sample avg dev_std = 0.039)
NEC for r=0.1 all KL = 0.205 +- 0.392 (in-sample avg dev_std = 0.039)
NEC for r=0.1 all L1 = 0.179 +- 0.340 (in-sample avg dev_std = 0.039)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.771
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.22268539999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.622
NEC for r=0.2 class 0.0 = 0.026 +- 0.398 (in-sample avg dev_std = 0.271)
NEC for r=0.2 class 1.0 = 0.352 +- 0.398 (in-sample avg dev_std = 0.271)
NEC for r=0.2 all KL = 0.234 +- 0.398 (in-sample avg dev_std = 0.271)
NEC for r=0.2 all L1 = 0.187 +- 0.327 (in-sample avg dev_std = 0.271)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.771
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1677538
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.704
NEC for r=0.4 class 0.0 = 0.054 +- 0.370 (in-sample avg dev_std = 0.362)
NEC for r=0.4 class 1.0 = 0.243 +- 0.370 (in-sample avg dev_std = 0.362)
NEC for r=0.4 all KL = 0.229 +- 0.370 (in-sample avg dev_std = 0.362)
NEC for r=0.4 all L1 = 0.148 +- 0.257 (in-sample avg dev_std = 0.362)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.771
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1269028
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.719
NEC for r=0.8 class 0.0 = 0.088 +- 0.355 (in-sample avg dev_std = 0.301)
NEC for r=0.8 class 1.0 = 0.191 +- 0.355 (in-sample avg dev_std = 0.301)
NEC for r=0.8 all KL = 0.204 +- 0.355 (in-sample avg dev_std = 0.301)
NEC for r=0.8 all L1 = 0.139 +- 0.262 (in-sample avg dev_std = 0.301)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 10:55:35 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:55:35 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:55:35 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:55:35 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:55:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:55:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:55:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:55:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:55:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:55:35 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:55:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.389
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.320
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.224
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.135
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.170
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.095
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.030
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.015
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.246
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.191
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.139
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.103
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.38880200000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.899
SUFF_SIMPLE for r=0.05 class 0.0 = 0.755 +- 0.370 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.370 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.05 all KL = 0.821 +- 0.370 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.05 all L1 = 0.891 +- 0.251 (in-sample avg dev_std = 0.315)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.31998800000000005
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.906
SUFF_SIMPLE for r=0.1 class 0.0 = 0.768 +- 0.364 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.364 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.1 all KL = 0.827 +- 0.364 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.1 all L1 = 0.897 +- 0.242 (in-sample avg dev_std = 0.311)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.224438
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.906
SUFF_SIMPLE for r=0.2 class 0.0 = 0.771 +- 0.360 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.360 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.2 all KL = 0.834 +- 0.360 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.2 all L1 = 0.898 +- 0.244 (in-sample avg dev_std = 0.307)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.13499599999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.907
SUFF_SIMPLE for r=0.4 class 0.0 = 0.781 +- 0.349 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.349 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.4 all KL = 0.846 +- 0.349 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.4 all L1 = 0.902 +- 0.244 (in-sample avg dev_std = 0.283)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07880200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.992
SUFF_SIMPLE for r=0.8 class 0.0 = 0.979 +- 0.109 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.109 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.988 +- 0.109 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.991 +- 0.083 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.999
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.169573
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.755
SUFF_SIMPLE for r=0.05 class 0.0 = 0.564 +- 0.435 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.05 all KL = 0.745 +- 0.435 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.05 all L1 = 0.783 +- 0.371 (in-sample avg dev_std = 0.172)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0945816
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.759
SUFF_SIMPLE for r=0.1 class 0.0 = 0.566 +- 0.435 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.1 all KL = 0.745 +- 0.435 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.1 all L1 = 0.784 +- 0.369 (in-sample avg dev_std = 0.197)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.999
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05013100000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.76
SUFF_SIMPLE for r=0.2 class 0.0 = 0.568 +- 0.435 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.2 all KL = 0.745 +- 0.435 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.2 all L1 = 0.784 +- 0.369 (in-sample avg dev_std = 0.208)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.999
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.029687800000000004
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.769
SUFF_SIMPLE for r=0.4 class 0.0 = 0.576 +- 0.435 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.4 all KL = 0.746 +- 0.435 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.4 all L1 = 0.789 +- 0.363 (in-sample avg dev_std = 0.251)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.999
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.015123000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.966
SUFF_SIMPLE for r=0.8 class 0.0 = 0.958 +- 0.198 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.972 +- 0.198 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all KL = 0.953 +- 0.198 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all L1 = 0.965 +- 0.156 (in-sample avg dev_std = 0.002)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.975
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2455962
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.911
SUFF_SIMPLE for r=0.05 class 0.0 = 0.886 +- 0.252 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.252 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.05 all KL = 0.929 +- 0.252 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.05 all L1 = 0.942 +- 0.210 (in-sample avg dev_std = 0.094)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.975
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.191233
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.911
SUFF_SIMPLE for r=0.1 class 0.0 = 0.885 +- 0.252 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.252 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.1 all KL = 0.929 +- 0.252 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.1 all L1 = 0.942 +- 0.211 (in-sample avg dev_std = 0.092)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.975
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.138973
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.913
SUFF_SIMPLE for r=0.2 class 0.0 = 0.886 +- 0.254 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.254 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.2 all KL = 0.928 +- 0.254 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.2 all L1 = 0.942 +- 0.209 (in-sample avg dev_std = 0.107)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.975
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1028642
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.927
SUFF_SIMPLE for r=0.4 class 0.0 = 0.916 +- 0.215 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.215 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.4 all KL = 0.95 +- 0.215 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.4 all L1 = 0.957 +- 0.185 (in-sample avg dev_std = 0.023)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.977
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0797904
len(reference) = 4961
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.972
SUFF_SIMPLE for r=0.8 class 0.0 = 0.987 +- 0.076 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.076 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.993 +- 0.076 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.994 +- 0.066 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.38880200000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.758
NEC for r=0.05 class 0.0 = 0.069 +- 0.445 (in-sample avg dev_std = 0.273)
NEC for r=0.05 class 1.0 = 0.372 +- 0.445 (in-sample avg dev_std = 0.273)
NEC for r=0.05 all KL = 0.321 +- 0.445 (in-sample avg dev_std = 0.273)
NEC for r=0.05 all L1 = 0.237 +- 0.355 (in-sample avg dev_std = 0.273)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.31998800000000005
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.863
NEC for r=0.1 class 0.0 = 0.107 +- 0.400 (in-sample avg dev_std = 0.357)
NEC for r=0.1 class 1.0 = 0.186 +- 0.400 (in-sample avg dev_std = 0.357)
NEC for r=0.1 all KL = 0.255 +- 0.400 (in-sample avg dev_std = 0.357)
NEC for r=0.1 all L1 = 0.151 +- 0.273 (in-sample avg dev_std = 0.357)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.224438
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.901
NEC for r=0.2 class 0.0 = 0.155 +- 0.378 (in-sample avg dev_std = 0.335)
NEC for r=0.2 class 1.0 = 0.084 +- 0.378 (in-sample avg dev_std = 0.335)
NEC for r=0.2 all KL = 0.209 +- 0.378 (in-sample avg dev_std = 0.335)
NEC for r=0.2 all L1 = 0.116 +- 0.239 (in-sample avg dev_std = 0.335)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.13499599999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.947
NEC for r=0.4 class 0.0 = 0.142 +- 0.316 (in-sample avg dev_std = 0.296)
NEC for r=0.4 class 1.0 = 0.006 +- 0.316 (in-sample avg dev_std = 0.296)
NEC for r=0.4 all KL = 0.134 +- 0.316 (in-sample avg dev_std = 0.296)
NEC for r=0.4 all L1 = 0.067 +- 0.181 (in-sample avg dev_std = 0.296)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07880200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.965
NEC for r=0.8 class 0.0 = 0.097 +- 0.267 (in-sample avg dev_std = 0.236)
NEC for r=0.8 class 1.0 = 0.002 +- 0.267 (in-sample avg dev_std = 0.236)
NEC for r=0.8 all KL = 0.091 +- 0.267 (in-sample avg dev_std = 0.236)
NEC for r=0.8 all L1 = 0.044 +- 0.150 (in-sample avg dev_std = 0.236)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.999
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.169573
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.73
NEC for r=0.05 class 0.0 = 0.23 +- 0.447 (in-sample avg dev_std = 0.022)
NEC for r=0.05 class 1.0 = 0.25 +- 0.447 (in-sample avg dev_std = 0.022)
NEC for r=0.05 all KL = 0.288 +- 0.447 (in-sample avg dev_std = 0.022)
NEC for r=0.05 all L1 = 0.24 +- 0.380 (in-sample avg dev_std = 0.022)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0945816
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.791
NEC for r=0.1 class 0.0 = 0.347 +- 0.422 (in-sample avg dev_std = 0.226)
NEC for r=0.1 class 1.0 = 0.043 +- 0.422 (in-sample avg dev_std = 0.226)
NEC for r=0.1 all KL = 0.249 +- 0.422 (in-sample avg dev_std = 0.226)
NEC for r=0.1 all L1 = 0.194 +- 0.344 (in-sample avg dev_std = 0.226)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.999
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05013100000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.798
NEC for r=0.2 class 0.0 = 0.394 +- 0.435 (in-sample avg dev_std = 0.375)
NEC for r=0.2 class 1.0 = 0.008 +- 0.435 (in-sample avg dev_std = 0.375)
NEC for r=0.2 all KL = 0.263 +- 0.435 (in-sample avg dev_std = 0.375)
NEC for r=0.2 all L1 = 0.2 +- 0.341 (in-sample avg dev_std = 0.375)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.999
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.029687800000000004
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.867
NEC for r=0.4 class 0.0 = 0.308 +- 0.424 (in-sample avg dev_std = 0.455)
NEC for r=0.4 class 1.0 = 0.005 +- 0.424 (in-sample avg dev_std = 0.455)
NEC for r=0.4 all KL = 0.248 +- 0.424 (in-sample avg dev_std = 0.455)
NEC for r=0.4 all L1 = 0.155 +- 0.281 (in-sample avg dev_std = 0.455)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.999
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.015123000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.908
NEC for r=0.8 class 0.0 = 0.241 +- 0.408 (in-sample avg dev_std = 0.452)
NEC for r=0.8 class 1.0 = 0.003 +- 0.408 (in-sample avg dev_std = 0.452)
NEC for r=0.8 all KL = 0.229 +- 0.408 (in-sample avg dev_std = 0.452)
NEC for r=0.8 all L1 = 0.121 +- 0.232 (in-sample avg dev_std = 0.452)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.975
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2455962
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.752
NEC for r=0.05 class 0.0 = 0.033 +- 0.443 (in-sample avg dev_std = 0.316)
NEC for r=0.05 class 1.0 = 0.422 +- 0.443 (in-sample avg dev_std = 0.316)
NEC for r=0.05 all KL = 0.311 +- 0.443 (in-sample avg dev_std = 0.316)
NEC for r=0.05 all L1 = 0.225 +- 0.348 (in-sample avg dev_std = 0.316)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.975
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.191233
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.855
NEC for r=0.1 class 0.0 = 0.05 +- 0.380 (in-sample avg dev_std = 0.291)
NEC for r=0.1 class 1.0 = 0.222 +- 0.380 (in-sample avg dev_std = 0.291)
NEC for r=0.1 all KL = 0.206 +- 0.380 (in-sample avg dev_std = 0.291)
NEC for r=0.1 all L1 = 0.135 +- 0.275 (in-sample avg dev_std = 0.291)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.975
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.138973
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.928
NEC for r=0.2 class 0.0 = 0.063 +- 0.270 (in-sample avg dev_std = 0.208)
NEC for r=0.2 class 1.0 = 0.05 +- 0.270 (in-sample avg dev_std = 0.208)
NEC for r=0.2 all KL = 0.097 +- 0.270 (in-sample avg dev_std = 0.208)
NEC for r=0.2 all L1 = 0.057 +- 0.182 (in-sample avg dev_std = 0.208)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.975
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1028642
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.936
NEC for r=0.4 class 0.0 = 0.069 +- 0.224 (in-sample avg dev_std = 0.153)
NEC for r=0.4 class 1.0 = 0.011 +- 0.224 (in-sample avg dev_std = 0.153)
NEC for r=0.4 all KL = 0.061 +- 0.224 (in-sample avg dev_std = 0.153)
NEC for r=0.4 all L1 = 0.04 +- 0.164 (in-sample avg dev_std = 0.153)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.975
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0797904
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.932
NEC for r=0.8 class 0.0 = 0.078 +- 0.225 (in-sample avg dev_std = 0.121)
NEC for r=0.8 class 1.0 = 0.008 +- 0.225 (in-sample avg dev_std = 0.121)
NEC for r=0.8 all KL = 0.059 +- 0.225 (in-sample avg dev_std = 0.121)
NEC for r=0.8 all L1 = 0.043 +- 0.176 (in-sample avg dev_std = 0.121)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.757, 0.772, 0.771, 0.823, 0.921], 'all_L1': [0.835, 0.841, 0.843, 0.884, 0.949]}), defaultdict(<class 'list'>, {'all_KL': [0.801, 0.799, 0.794, 0.824, 0.935], 'all_L1': [0.869, 0.869, 0.868, 0.896, 0.969]}), defaultdict(<class 'list'>, {'all_KL': [0.808, 0.81, 0.801, 0.83, 0.941], 'all_L1': [0.883, 0.884, 0.884, 0.902, 0.97]}), defaultdict(<class 'list'>, {'all_KL': [0.773, 0.786, 0.796, 0.806, 0.905], 'all_L1': [0.841, 0.844, 0.851, 0.861, 0.94]}), defaultdict(<class 'list'>, {'all_KL': [0.794, 0.802, 0.8, 0.812, 0.917], 'all_L1': [0.869, 0.867, 0.868, 0.874, 0.959]}), defaultdict(<class 'list'>, {'all_KL': [0.683, 0.697, 0.731, 0.797, 0.932], 'all_L1': [0.794, 0.801, 0.829, 0.873, 0.958]}), defaultdict(<class 'list'>, {'all_KL': [0.67, 0.68, 0.698, 0.75, 0.897], 'all_L1': [0.778, 0.78, 0.794, 0.843, 0.93]}), defaultdict(<class 'list'>, {'all_KL': [0.831, 0.847, 0.859, 0.904, 0.997], 'all_L1': [0.907, 0.913, 0.925, 0.954, 0.999]}), defaultdict(<class 'list'>, {'all_KL': [0.817, 0.818, 0.832, 0.824, 0.918], 'all_L1': [0.884, 0.881, 0.888, 0.886, 0.948]}), defaultdict(<class 'list'>, {'all_KL': [0.821, 0.827, 0.834, 0.846, 0.988], 'all_L1': [0.891, 0.897, 0.898, 0.902, 0.991]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.465, 0.457, 0.306, 0.196, 0.114], 'all_L1': [0.384, 0.313, 0.192, 0.122, 0.07]}), defaultdict(<class 'list'>, {'all_KL': [0.199, 0.113, 0.094, 0.111, 0.111], 'all_L1': [0.163, 0.071, 0.058, 0.057, 0.052]}), defaultdict(<class 'list'>, {'all_KL': [0.264, 0.218, 0.156, 0.123, 0.121], 'all_L1': [0.217, 0.15, 0.091, 0.064, 0.052]}), defaultdict(<class 'list'>, {'all_KL': [0.374, 0.333, 0.26, 0.194, 0.142], 'all_L1': [0.303, 0.221, 0.164, 0.099, 0.07]}), defaultdict(<class 'list'>, {'all_KL': [0.308, 0.196, 0.081, 0.084, 0.085], 'all_L1': [0.253, 0.12, 0.042, 0.049, 0.042]}), defaultdict(<class 'list'>, {'all_KL': [0.495, 0.562, 0.439, 0.246, 0.188], 'all_L1': [0.406, 0.385, 0.284, 0.148, 0.103]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.529, 0.362, 0.231, 0.189], 'all_L1': [0.414, 0.365, 0.228, 0.144, 0.113]}), defaultdict(<class 'list'>, {'all_KL': [0.413, 0.36, 0.226, 0.139, 0.075], 'all_L1': [0.345, 0.222, 0.129, 0.075, 0.034]}), defaultdict(<class 'list'>, {'all_KL': [0.417, 0.419, 0.205, 0.096, 0.071], 'all_L1': [0.35, 0.286, 0.119, 0.045, 0.032]}), defaultdict(<class 'list'>, {'all_KL': [0.321, 0.255, 0.209, 0.134, 0.091], 'all_L1': [0.237, 0.151, 0.116, 0.067, 0.044]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.774, 0.775, 0.776, 0.778, 0.869], 'all_L1': [0.81, 0.811, 0.812, 0.814, 0.887]}), defaultdict(<class 'list'>, {'all_KL': [0.744, 0.744, 0.744, 0.745, 0.934], 'all_L1': [0.78, 0.78, 0.78, 0.783, 0.97]}), defaultdict(<class 'list'>, {'all_KL': [0.741, 0.741, 0.741, 0.741, 0.925], 'all_L1': [0.777, 0.777, 0.777, 0.779, 0.963]}), defaultdict(<class 'list'>, {'all_KL': [0.747, 0.747, 0.747, 0.747, 0.878], 'all_L1': [0.793, 0.793, 0.793, 0.793, 0.921]}), defaultdict(<class 'list'>, {'all_KL': [0.429, 0.429, 0.429, 0.43, 0.489], 'all_L1': [0.503, 0.504, 0.505, 0.508, 0.563]}), defaultdict(<class 'list'>, {'all_KL': [0.549, 0.539, 0.525, 0.522, 0.672], 'all_L1': [0.631, 0.625, 0.614, 0.606, 0.731]}), defaultdict(<class 'list'>, {'all_KL': [0.357, 0.353, 0.346, 0.329, 0.4], 'all_L1': [0.497, 0.494, 0.488, 0.472, 0.512]}), defaultdict(<class 'list'>, {'all_KL': [0.379, 0.379, 0.381, 0.39, 0.556], 'all_L1': [0.501, 0.501, 0.506, 0.523, 0.631]}), defaultdict(<class 'list'>, {'all_KL': [0.38, 0.379, 0.376, 0.377, 0.414], 'all_L1': [0.529, 0.526, 0.522, 0.522, 0.538]}), defaultdict(<class 'list'>, {'all_KL': [0.745, 0.745, 0.745, 0.746, 0.953], 'all_L1': [0.783, 0.784, 0.784, 0.789, 0.965]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.403, 0.465, 0.283, 0.196, 0.173], 'all_L1': [0.351, 0.371, 0.188, 0.143, 0.129]}), defaultdict(<class 'list'>, {'all_KL': [0.471, 0.407, 0.256, 0.243, 0.241], 'all_L1': [0.409, 0.302, 0.135, 0.145, 0.146]}), defaultdict(<class 'list'>, {'all_KL': [0.478, 0.476, 0.279, 0.248, 0.245], 'all_L1': [0.411, 0.36, 0.164, 0.155, 0.152]}), defaultdict(<class 'list'>, {'all_KL': [0.456, 0.423, 0.284, 0.251, 0.249], 'all_L1': [0.393, 0.328, 0.192, 0.181, 0.173]}), defaultdict(<class 'list'>, {'all_KL': [0.187, 0.327, 0.473, 0.485, 0.469], 'all_L1': [0.168, 0.234, 0.337, 0.355, 0.346]}), defaultdict(<class 'list'>, {'all_KL': [0.488, 0.541, 0.44, 0.341, 0.329], 'all_L1': [0.431, 0.422, 0.305, 0.258, 0.251]}), defaultdict(<class 'list'>, {'all_KL': [0.265, 0.334, 0.466, 0.397, 0.361], 'all_L1': [0.236, 0.256, 0.27, 0.251, 0.233]}), defaultdict(<class 'list'>, {'all_KL': [0.124, 0.162, 0.398, 0.423, 0.428], 'all_L1': [0.116, 0.129, 0.263, 0.305, 0.315]}), defaultdict(<class 'list'>, {'all_KL': [0.067, 0.07, 0.276, 0.377, 0.398], 'all_L1': [0.065, 0.066, 0.151, 0.252, 0.286]}), defaultdict(<class 'list'>, {'all_KL': [0.288, 0.249, 0.263, 0.248, 0.229], 'all_L1': [0.24, 0.194, 0.2, 0.155, 0.121]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.726, 0.747, 0.788, 0.825, 0.848], 'all_L1': [0.744, 0.761, 0.797, 0.831, 0.841]}), defaultdict(<class 'list'>, {'all_KL': [0.858, 0.858, 0.858, 0.877, 0.919], 'all_L1': [0.892, 0.891, 0.89, 0.911, 0.931]}), defaultdict(<class 'list'>, {'all_KL': [0.91, 0.914, 0.917, 0.929, 0.988], 'all_L1': [0.925, 0.927, 0.928, 0.939, 0.982]}), defaultdict(<class 'list'>, {'all_KL': [0.851, 0.888, 0.918, 0.937, 0.994], 'all_L1': [0.905, 0.922, 0.936, 0.952, 0.994]}), defaultdict(<class 'list'>, {'all_KL': [0.847, 0.853, 0.863, 0.868, 0.907], 'all_L1': [0.887, 0.89, 0.893, 0.897, 0.924]}), defaultdict(<class 'list'>, {'all_KL': [0.654, 0.676, 0.72, 0.774, 0.886], 'all_L1': [0.708, 0.723, 0.763, 0.807, 0.883]}), defaultdict(<class 'list'>, {'all_KL': [0.62, 0.643, 0.702, 0.758, 0.884], 'all_L1': [0.71, 0.726, 0.774, 0.816, 0.898]}), defaultdict(<class 'list'>, {'all_KL': [0.809, 0.844, 0.875, 0.897, 0.947], 'all_L1': [0.874, 0.887, 0.901, 0.917, 0.956]}), defaultdict(<class 'list'>, {'all_KL': [0.72, 0.739, 0.796, 0.839, 0.928], 'all_L1': [0.797, 0.81, 0.852, 0.883, 0.939]}), defaultdict(<class 'list'>, {'all_KL': [0.929, 0.929, 0.928, 0.95, 0.993], 'all_L1': [0.942, 0.942, 0.942, 0.957, 0.994]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.258, 0.295, 0.289, 0.246, 0.226], 'all_L1': [0.254, 0.278, 0.269, 0.219, 0.208]}), defaultdict(<class 'list'>, {'all_KL': [0.246, 0.239, 0.197, 0.13, 0.086], 'all_L1': [0.216, 0.204, 0.134, 0.091, 0.07]}), defaultdict(<class 'list'>, {'all_KL': [0.326, 0.313, 0.244, 0.151, 0.093], 'all_L1': [0.283, 0.261, 0.176, 0.106, 0.069]}), defaultdict(<class 'list'>, {'all_KL': [0.364, 0.384, 0.299, 0.14, 0.116], 'all_L1': [0.307, 0.283, 0.192, 0.083, 0.077]}), defaultdict(<class 'list'>, {'all_KL': [0.208, 0.211, 0.184, 0.118, 0.088], 'all_L1': [0.181, 0.18, 0.136, 0.085, 0.069]}), defaultdict(<class 'list'>, {'all_KL': [0.146, 0.174, 0.202, 0.225, 0.251], 'all_L1': [0.147, 0.168, 0.187, 0.189, 0.211]}), defaultdict(<class 'list'>, {'all_KL': [0.125, 0.195, 0.247, 0.258, 0.279], 'all_L1': [0.117, 0.148, 0.176, 0.176, 0.203]}), defaultdict(<class 'list'>, {'all_KL': [0.188, 0.225, 0.266, 0.238, 0.185], 'all_L1': [0.165, 0.18, 0.187, 0.145, 0.116]}), defaultdict(<class 'list'>, {'all_KL': [0.182, 0.205, 0.234, 0.229, 0.204], 'all_L1': [0.161, 0.179, 0.187, 0.148, 0.139]}), defaultdict(<class 'list'>, {'all_KL': [0.311, 0.206, 0.097, 0.061, 0.059], 'all_L1': [0.225, 0.135, 0.057, 0.04, 0.043]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.855 +- 0.040, 0.858 +- 0.040, 0.865 +- 0.036, 0.887 +- 0.028, 0.961 +- 0.021
suff_simple class all_KL  =  0.776 +- 0.054, 0.784 +- 0.052, 0.792 +- 0.046, 0.822 +- 0.037, 0.935 +- 0.031
[[0.8525000214576721, 0.8560000061988831, 0.8615000247955322, 0.9057499766349792, 0.9635000228881836], [0.8784999847412109, 0.8802499771118164, 0.8840000033378601, 0.9127500057220459, 0.9777500033378601], [0.8980000019073486, 0.8985000252723694, 0.8987500071525574, 0.9190000295639038, 0.9772499799728394], [0.8529999852180481, 0.8514999747276306, 0.8552500009536743, 0.8665000200271606, 0.9459999799728394], [0.8820000290870667, 0.878000020980835, 0.8772500157356262, 0.8855000138282776, 0.9702500104904175], [0.8320000171661377, 0.8335000276565552, 0.862500011920929, 0.9082499742507935, 0.9695000052452087], [0.8027499914169312, 0.7990000247955322, 0.812749981880188, 0.8759999871253967, 0.9487500190734863], [0.9262499809265137, 0.9275000095367432, 0.9384999871253967, 0.9635000228881836, 0.9994999766349792], [0.8930000066757202, 0.8822500109672546, 0.8932499885559082, 0.8917499780654907, 0.9522500038146973], [0.8992499709129333, 0.906499981880188, 0.9057499766349792, 0.9070000052452087, 0.9919999837875366]]
[[0.757, 0.772, 0.771, 0.823, 0.921], [0.801, 0.799, 0.794, 0.824, 0.935], [0.808, 0.81, 0.801, 0.83, 0.941], [0.773, 0.786, 0.796, 0.806, 0.905], [0.794, 0.802, 0.8, 0.812, 0.917], [0.683, 0.697, 0.731, 0.797, 0.932], [0.67, 0.68, 0.698, 0.75, 0.897], [0.831, 0.847, 0.859, 0.904, 0.997], [0.817, 0.818, 0.832, 0.824, 0.918], [0.821, 0.827, 0.834, 0.846, 0.988]]
suff_simple_acc_int  =  0.872 +- 0.035, 0.871 +- 0.036, 0.879 +- 0.032, 0.904 +- 0.026, 0.970 +- 0.017
nec class all_L1  =  0.307 +- 0.082, 0.228 +- 0.101, 0.142 +- 0.072, 0.087 +- 0.037, 0.061 +- 0.026
nec class all_KL  =  0.377 +- 0.097, 0.344 +- 0.141, 0.234 +- 0.107, 0.155 +- 0.054, 0.119 +- 0.041
[[0.5759999752044678, 0.7097499966621399, 0.8370000123977661, 0.9045000076293945, 0.953000009059906], [0.8169999718666077, 0.9332500100135803, 0.9449999928474426, 0.953249990940094, 0.9599999785423279], [0.7605000138282776, 0.8500000238418579, 0.9179999828338623, 0.9472500085830688, 0.9617499709129333], [0.6667500138282776, 0.78125, 0.8412500023841858, 0.9204999804496765, 0.9459999799728394], [0.722000002861023, 0.8857499957084656, 0.9632499814033508, 0.9555000066757202, 0.9670000076293945], [0.5684999823570251, 0.6452500224113464, 0.753000020980835, 0.8865000009536743, 0.9334999918937683], [0.5479999780654907, 0.6467499732971191, 0.8034999966621399, 0.8799999952316284, 0.9127500057220459], [0.609000027179718, 0.7950000166893005, 0.8830000162124634, 0.934499979019165, 0.9747499823570251], [0.6075000166893005, 0.721750020980835, 0.8949999809265137, 0.9664999842643738, 0.9769999980926514], [0.7577499747276306, 0.8634999990463257, 0.9014999866485596, 0.9474999904632568, 0.9645000100135803]]
[[0.465, 0.457, 0.306, 0.196, 0.114], [0.199, 0.113, 0.094, 0.111, 0.111], [0.264, 0.218, 0.156, 0.123, 0.121], [0.374, 0.333, 0.26, 0.194, 0.142], [0.308, 0.196, 0.081, 0.084, 0.085], [0.495, 0.562, 0.439, 0.246, 0.188], [0.51, 0.529, 0.362, 0.231, 0.189], [0.413, 0.36, 0.226, 0.139, 0.075], [0.417, 0.419, 0.205, 0.096, 0.071], [0.321, 0.255, 0.209, 0.134, 0.091]]
nec_acc_int  =  0.663 +- 0.090, 0.783 +- 0.095, 0.874 +- 0.062, 0.930 +- 0.029, 0.955 +- 0.019

Eval split val
suff_simple class all_L1  =  0.660 +- 0.133, 0.660 +- 0.134, 0.658 +- 0.135, 0.659 +- 0.137, 0.768 +- 0.183
suff_simple class all_KL  =  0.584 +- 0.173, 0.583 +- 0.174, 0.581 +- 0.176, 0.581 +- 0.177, 0.709 +- 0.216
[[0.680400013923645, 0.6815750002861023, 0.6807249784469604, 0.6822999715805054, 0.764549970626831], [0.7494000196456909, 0.7491499781608582, 0.7492499947547913, 0.7567750215530396, 0.9797750115394592], [0.7497000098228455, 0.75, 0.7511749863624573, 0.7551000118255615, 0.9760749936103821], [0.7270500063896179, 0.7269750237464905, 0.727150022983551, 0.7276250123977661, 0.8857750296592712], [0.7551500201225281, 0.7569500207901001, 0.759975016117096, 0.7659749984741211, 0.8275499939918518], [0.6188250184059143, 0.6132749915122986, 0.6038749814033508, 0.593625009059906, 0.7404500246047974], [0.7036749720573425, 0.701200008392334, 0.6948750019073486, 0.6772750020027161, 0.7075499892234802], [0.794950008392334, 0.7953749895095825, 0.8018749952316284, 0.828000009059906, 0.9241250157356262], [0.7688500285148621, 0.7627999782562256, 0.7578499913215637, 0.7573000192642212, 0.7581499814987183], [0.755424976348877, 0.7587000131607056, 0.7598749995231628, 0.7689250111579895, 0.9661999940872192]]
[[0.774, 0.775, 0.776, 0.778, 0.869], [0.744, 0.744, 0.744, 0.745, 0.934], [0.741, 0.741, 0.741, 0.741, 0.925], [0.747, 0.747, 0.747, 0.747, 0.878], [0.429, 0.429, 0.429, 0.43, 0.489], [0.549, 0.539, 0.525, 0.522, 0.672], [0.357, 0.353, 0.346, 0.329, 0.4], [0.379, 0.379, 0.381, 0.39, 0.556], [0.38, 0.379, 0.376, 0.377, 0.414], [0.745, 0.745, 0.745, 0.746, 0.953]]
suff_simple_acc_int  =  0.730 +- 0.048, 0.730 +- 0.049, 0.729 +- 0.053, 0.731 +- 0.062, 0.853 +- 0.101
nec class all_L1  =  0.282 +- 0.128, 0.266 +- 0.107, 0.221 +- 0.065, 0.220 +- 0.071, 0.215 +- 0.078
nec class all_KL  =  0.323 +- 0.150, 0.345 +- 0.141, 0.342 +- 0.086, 0.321 +- 0.092, 0.312 +- 0.094
[[0.46239998936653137, 0.4724000096321106, 0.6912000179290771, 0.7368500232696533, 0.7542250156402588], [0.525600016117096, 0.6976500153541565, 0.8955249786376953, 0.8787500262260437, 0.877174973487854], [0.5235999822616577, 0.6306250095367432, 0.8626999855041504, 0.8707249760627747, 0.8752999901771545], [0.5256749987602234, 0.6165750026702881, 0.7741000056266785, 0.7813500165939331, 0.7959750294685364], [0.4959999918937683, 0.5630750060081482, 0.8871250152587891, 0.9199749827384949, 0.9417250156402588], [0.5311999917030334, 0.5797749757766724, 0.7321749925613403, 0.7678499817848206, 0.7733749747276306], [0.5013999938964844, 0.5394750237464905, 0.7696999907493591, 0.8258000016212463, 0.844124972820282], [0.4959999918937683, 0.5091750025749207, 0.7977499961853027, 0.8852249979972839, 0.9068750143051147], [0.4959999918937683, 0.4965749979019165, 0.6241999864578247, 0.7778249979019165, 0.8341749906539917], [0.7297499775886536, 0.7911499738693237, 0.7979999780654907, 0.8665000200271606, 0.9083999991416931]]
[[0.403, 0.465, 0.283, 0.196, 0.173], [0.471, 0.407, 0.256, 0.243, 0.241], [0.478, 0.476, 0.279, 0.248, 0.245], [0.456, 0.423, 0.284, 0.251, 0.249], [0.187, 0.327, 0.473, 0.485, 0.469], [0.488, 0.541, 0.44, 0.341, 0.329], [0.265, 0.334, 0.466, 0.397, 0.361], [0.124, 0.162, 0.398, 0.423, 0.428], [0.067, 0.07, 0.276, 0.377, 0.398], [0.288, 0.249, 0.263, 0.248, 0.229]]
nec_acc_int  =  0.529 +- 0.070, 0.590 +- 0.093, 0.783 +- 0.082, 0.831 +- 0.058, 0.851 +- 0.059

Eval split test
suff_simple class all_L1  =  0.838 +- 0.086, 0.848 +- 0.081, 0.868 +- 0.064, 0.891 +- 0.053, 0.934 +- 0.048
suff_simple class all_KL  =  0.792 +- 0.101, 0.809 +- 0.096, 0.837 +- 0.077, 0.865 +- 0.063, 0.929 +- 0.048
[[0.7661846876144409, 0.7868220806121826, 0.810336172580719, 0.8468831181526184, 0.8670276999473572], [0.8657694458961487, 0.8649189472198486, 0.8633430004119873, 0.895412266254425, 0.9533571004867554], [0.9119471907615662, 0.9125975370407104, 0.9135481119155884, 0.9275065064430237, 0.9778079986572266], [0.9075695276260376, 0.9091705083847046, 0.9116719961166382, 0.9235290884971619, 0.9670814871788025], [0.8029067516326904, 0.8040574193000793, 0.8039073348045349, 0.8133130073547363, 0.8898785710334778], [0.6265759468078613, 0.6393085718154907, 0.6693015694618225, 0.7180558443069458, 0.7014989256858826], [0.6017860770225525, 0.6048128604888916, 0.6300280094146729, 0.6672503352165222, 0.7000651359558105], [0.7676355838775635, 0.7690364122390747, 0.7749649882316589, 0.789723813533783, 0.8366059064865112], [0.6981438994407654, 0.7075245380401611, 0.7298128604888916, 0.7528517246246338, 0.7978435158729553], [0.9113467931747437, 0.9109715819358826, 0.9125475287437439, 0.9265059232711792, 0.9717798829078674]]
[[0.726, 0.747, 0.788, 0.825, 0.848], [0.858, 0.858, 0.858, 0.877, 0.919], [0.91, 0.914, 0.917, 0.929, 0.988], [0.851, 0.888, 0.918, 0.937, 0.994], [0.847, 0.853, 0.863, 0.868, 0.907], [0.654, 0.676, 0.72, 0.774, 0.886], [0.62, 0.643, 0.702, 0.758, 0.884], [0.809, 0.844, 0.875, 0.897, 0.947], [0.72, 0.739, 0.796, 0.839, 0.928], [0.929, 0.929, 0.928, 0.95, 0.993]]
suff_simple_acc_int  =  0.786 +- 0.110, 0.791 +- 0.107, 0.802 +- 0.097, 0.826 +- 0.089, 0.866 +- 0.101
nec class all_L1  =  0.206 +- 0.059, 0.202 +- 0.051, 0.170 +- 0.051, 0.128 +- 0.053, 0.121 +- 0.062
nec class all_KL  =  0.235 +- 0.076, 0.245 +- 0.062, 0.226 +- 0.056, 0.180 +- 0.064, 0.159 +- 0.075
[[0.5857014060020447, 0.5971832871437073, 0.6389583945274353, 0.7329147458076477, 0.7541275024414062], [0.6730037927627563, 0.703772246837616, 0.8097858428955078, 0.8427556753158569, 0.8577896952629089], [0.6707023978233337, 0.7222333550453186, 0.8367520570755005, 0.8910596370697021, 0.9206774234771729], [0.6489644050598145, 0.7013708353042603, 0.7994546890258789, 0.9020411968231201, 0.9047929048538208], [0.653942346572876, 0.663197934627533, 0.734965980052948, 0.781193733215332, 0.7932759523391724], [0.5644887089729309, 0.5429507493972778, 0.539523720741272, 0.6045627593994141, 0.6214728951454163], [0.5648889541625977, 0.5519561767578125, 0.5480037927627563, 0.6002851724624634, 0.609965980052948], [0.6309785842895508, 0.6337552666664124, 0.6763057708740234, 0.7211576700210571, 0.7507004141807556], [0.611566960811615, 0.5949069261550903, 0.6216980218887329, 0.7040724158287048, 0.7190064191818237], [0.7516259551048279, 0.8553131818771362, 0.9278317093849182, 0.9357364177703857, 0.9315589070320129]]
[[0.258, 0.295, 0.289, 0.246, 0.226], [0.246, 0.239, 0.197, 0.13, 0.086], [0.326, 0.313, 0.244, 0.151, 0.093], [0.364, 0.384, 0.299, 0.14, 0.116], [0.208, 0.211, 0.184, 0.118, 0.088], [0.146, 0.174, 0.202, 0.225, 0.251], [0.125, 0.195, 0.247, 0.258, 0.279], [0.188, 0.225, 0.266, 0.238, 0.185], [0.182, 0.205, 0.234, 0.229, 0.204], [0.311, 0.206, 0.097, 0.061, 0.059]]
nec_acc_int  =  0.636 +- 0.055, 0.657 +- 0.089, 0.713 +- 0.123, 0.772 +- 0.114, 0.786 +- 0.111


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.581 +- 0.033, 0.543 +- 0.040, 0.504 +- 0.028, 0.487 +- 0.017, 0.511 +- 0.011
Faith. Armon (L1)= 		  =  0.444 +- 0.088, 0.347 +- 0.124, 0.236 +- 0.102, 0.156 +- 0.059, 0.114 +- 0.046
Faith. GMean (L1)= 	  =  0.506 +- 0.065, 0.429 +- 0.096, 0.338 +- 0.085, 0.271 +- 0.055, 0.237 +- 0.048
Faith. Aritm (KL)= 		  =  0.576 +- 0.037, 0.564 +- 0.057, 0.513 +- 0.043, 0.489 +- 0.024, 0.527 +- 0.019
Faith. Armon (KL)= 		  =  0.496 +- 0.084, 0.457 +- 0.133, 0.345 +- 0.122, 0.256 +- 0.074, 0.208 +- 0.062
Faith. GMean (KL)= 	  =  0.534 +- 0.062, 0.505 +- 0.102, 0.416 +- 0.094, 0.351 +- 0.058, 0.328 +- 0.053

Eval split val
Faith. Aritm (L1)= 		  =  0.471 +- 0.122, 0.463 +- 0.107, 0.439 +- 0.053, 0.439 +- 0.040, 0.492 +- 0.061
Faith. Armon (L1)= 		  =  0.385 +- 0.151, 0.369 +- 0.128, 0.317 +- 0.059, 0.313 +- 0.059, 0.316 +- 0.075
Faith. GMean (L1)= 	  =  0.424 +- 0.139, 0.412 +- 0.119, 0.371 +- 0.042, 0.368 +- 0.028, 0.389 +- 0.038
Faith. Aritm (KL)= 		  =  0.454 +- 0.152, 0.464 +- 0.140, 0.461 +- 0.064, 0.451 +- 0.050, 0.511 +- 0.071
Faith. Armon (KL)= 		  =  0.405 +- 0.167, 0.420 +- 0.152, 0.403 +- 0.040, 0.381 +- 0.036, 0.401 +- 0.054
Faith. GMean (KL)= 	  =  0.428 +- 0.160, 0.441 +- 0.146, 0.431 +- 0.045, 0.413 +- 0.028, 0.450 +- 0.039

Eval split test
Faith. Aritm (L1)= 		  =  0.522 +- 0.065, 0.525 +- 0.052, 0.519 +- 0.029, 0.510 +- 0.013, 0.527 +- 0.017
Faith. Armon (L1)= 		  =  0.327 +- 0.079, 0.323 +- 0.067, 0.280 +- 0.073, 0.219 +- 0.080, 0.207 +- 0.094
Faith. GMean (L1)= 	  =  0.412 +- 0.074, 0.410 +- 0.058, 0.377 +- 0.059, 0.328 +- 0.065, 0.322 +- 0.079
Faith. Aritm (KL)= 		  =  0.514 +- 0.084, 0.527 +- 0.068, 0.531 +- 0.043, 0.522 +- 0.023, 0.544 +- 0.027
Faith. Armon (KL)= 		  =  0.360 +- 0.098, 0.373 +- 0.076, 0.351 +- 0.074, 0.290 +- 0.088, 0.262 +- 0.107
Faith. GMean (KL)= 	  =  0.429 +- 0.092, 0.442 +- 0.071, 0.430 +- 0.060, 0.385 +- 0.067, 0.371 +- 0.087
Computed for split load_split = id



Completed in  2:30:40.513333  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GL-GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 11:10:57 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 11:10:57 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 11:10:57 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 11:10:57 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 11:10:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:10:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:10:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:10:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:10:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:10:57 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 11:10:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.617
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.703
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.741
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.749
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.747
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.700
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.696
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.695
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.695
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.695
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.589
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.631
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.656
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.671
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.676


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.617022
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.916
SUFF_SIMPLE for r=0.05 class 0.0 = 0.785 +- 0.333 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.333 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.05 all KL = 0.846 +- 0.333 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.05 all L1 = 0.904 +- 0.228 (in-sample avg dev_std = 0.327)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.702622
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.914
SUFF_SIMPLE for r=0.1 class 0.0 = 0.788 +- 0.327 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.327 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.1 all KL = 0.854 +- 0.327 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.1 all L1 = 0.905 +- 0.232 (in-sample avg dev_std = 0.302)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.74054
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.91
SUFF_SIMPLE for r=0.2 class 0.0 = 0.781 +- 0.332 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.332 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.2 all KL = 0.853 +- 0.332 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.2 all L1 = 0.902 +- 0.239 (in-sample avg dev_std = 0.295)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7490539999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.908
SUFF_SIMPLE for r=0.4 class 0.0 = 0.783 +- 0.326 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.326 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.4 all KL = 0.861 +- 0.326 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.4 all L1 = 0.903 +- 0.244 (in-sample avg dev_std = 0.263)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.746838
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.984
SUFF_SIMPLE for r=0.8 class 0.0 = 0.955 +- 0.150 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.150 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.8 all KL = 0.971 +- 0.150 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.8 all L1 = 0.98 +- 0.113 (in-sample avg dev_std = 0.084)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6998616
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.755
SUFF_SIMPLE for r=0.05 class 0.0 = 0.571 +- 0.434 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.434 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.05 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.05 all L1 = 0.787 +- 0.365 (in-sample avg dev_std = 0.151)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6956418000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.754
SUFF_SIMPLE for r=0.1 class 0.0 = 0.57 +- 0.435 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.435 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.1 all KL = 0.747 +- 0.435 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.1 all L1 = 0.787 +- 0.366 (in-sample avg dev_std = 0.135)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6948674
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.752
SUFF_SIMPLE for r=0.2 class 0.0 = 0.568 +- 0.435 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.435 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.2 all KL = 0.747 +- 0.435 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.2 all L1 = 0.786 +- 0.368 (in-sample avg dev_std = 0.116)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6948222
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.749
SUFF_SIMPLE for r=0.4 class 0.0 = 0.567 +- 0.435 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.435 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.4 all KL = 0.746 +- 0.435 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.4 all L1 = 0.785 +- 0.369 (in-sample avg dev_std = 0.085)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6948219999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.751
SUFF_SIMPLE for r=0.8 class 0.0 = 0.573 +- 0.432 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.432 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.8 all KL = 0.75 +- 0.432 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.8 all L1 = 0.788 +- 0.367 (in-sample avg dev_std = 0.044)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5890152
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.916
SUFF_SIMPLE for r=0.05 class 0.0 = 0.881 +- 0.263 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.995 +- 0.263 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.05 all KL = 0.922 +- 0.263 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.05 all L1 = 0.937 +- 0.216 (in-sample avg dev_std = 0.135)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6307624
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.915
SUFF_SIMPLE for r=0.1 class 0.0 = 0.88 +- 0.260 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.997 +- 0.260 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.1 all KL = 0.924 +- 0.260 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.1 all L1 = 0.938 +- 0.218 (in-sample avg dev_std = 0.102)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6556327999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.917
SUFF_SIMPLE for r=0.2 class 0.0 = 0.881 +- 0.255 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.255 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.2 all KL = 0.928 +- 0.255 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.2 all L1 = 0.939 +- 0.217 (in-sample avg dev_std = 0.083)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6706832
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.918
SUFF_SIMPLE for r=0.4 class 0.0 = 0.883 +- 0.252 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.252 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.4 all KL = 0.93 +- 0.252 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.4 all L1 = 0.941 +- 0.214 (in-sample avg dev_std = 0.084)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6757221999999999
len(reference) = 4905
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.973
SUFF_SIMPLE for r=0.8 class 0.0 = 0.978 +- 0.107 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.107 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.987 +- 0.107 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.989 +- 0.093 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.617022
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.638
NEC for r=0.05 class 0.0 = 0.002 +- 0.481 (in-sample avg dev_std = 0.198)
NEC for r=0.05 class 1.0 = 0.584 +- 0.481 (in-sample avg dev_std = 0.198)
NEC for r=0.05 all KL = 0.387 +- 0.481 (in-sample avg dev_std = 0.198)
NEC for r=0.05 all L1 = 0.324 +- 0.407 (in-sample avg dev_std = 0.198)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.702622
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.748
NEC for r=0.1 class 0.0 = 0.013 +- 0.443 (in-sample avg dev_std = 0.409)
NEC for r=0.1 class 1.0 = 0.445 +- 0.443 (in-sample avg dev_std = 0.409)
NEC for r=0.1 all KL = 0.36 +- 0.443 (in-sample avg dev_std = 0.409)
NEC for r=0.1 all L1 = 0.252 +- 0.344 (in-sample avg dev_std = 0.409)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.74054
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.867
NEC for r=0.2 class 0.0 = 0.018 +- 0.365 (in-sample avg dev_std = 0.314)
NEC for r=0.2 class 1.0 = 0.234 +- 0.365 (in-sample avg dev_std = 0.314)
NEC for r=0.2 all KL = 0.205 +- 0.365 (in-sample avg dev_std = 0.314)
NEC for r=0.2 all L1 = 0.137 +- 0.275 (in-sample avg dev_std = 0.314)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7490539999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.947
NEC for r=0.4 class 0.0 = 0.029 +- 0.278 (in-sample avg dev_std = 0.273)
NEC for r=0.4 class 1.0 = 0.092 +- 0.278 (in-sample avg dev_std = 0.273)
NEC for r=0.4 all KL = 0.108 +- 0.278 (in-sample avg dev_std = 0.273)
NEC for r=0.4 all L1 = 0.064 +- 0.182 (in-sample avg dev_std = 0.273)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.746838
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.985
NEC for r=0.8 class 0.0 = 0.039 +- 0.179 (in-sample avg dev_std = 0.201)
NEC for r=0.8 class 1.0 = 0.01 +- 0.179 (in-sample avg dev_std = 0.201)
NEC for r=0.8 all KL = 0.048 +- 0.179 (in-sample avg dev_std = 0.201)
NEC for r=0.8 all L1 = 0.023 +- 0.094 (in-sample avg dev_std = 0.201)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6998616
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.483 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.852 +- 0.483 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.485 +- 0.483 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.43 +- 0.426 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6956418000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.596
NEC for r=0.1 class 0.0 = 0.02 +- 0.465 (in-sample avg dev_std = 0.449)
NEC for r=0.1 class 1.0 = 0.741 +- 0.465 (in-sample avg dev_std = 0.449)
NEC for r=0.1 all KL = 0.476 +- 0.465 (in-sample avg dev_std = 0.449)
NEC for r=0.1 all L1 = 0.383 +- 0.386 (in-sample avg dev_std = 0.449)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6948674
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.91
NEC for r=0.2 class 0.0 = 0.164 +- 0.354 (in-sample avg dev_std = 0.474)
NEC for r=0.2 class 1.0 = 0.096 +- 0.354 (in-sample avg dev_std = 0.474)
NEC for r=0.2 all KL = 0.25 +- 0.354 (in-sample avg dev_std = 0.474)
NEC for r=0.2 all L1 = 0.13 +- 0.197 (in-sample avg dev_std = 0.474)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6948222
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.918
NEC for r=0.4 class 0.0 = 0.21 +- 0.357 (in-sample avg dev_std = 0.404)
NEC for r=0.4 class 1.0 = 0.01 +- 0.357 (in-sample avg dev_std = 0.404)
NEC for r=0.4 all KL = 0.198 +- 0.357 (in-sample avg dev_std = 0.404)
NEC for r=0.4 all L1 = 0.109 +- 0.211 (in-sample avg dev_std = 0.404)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6948219999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.926
NEC for r=0.8 class 0.0 = 0.203 +- 0.351 (in-sample avg dev_std = 0.391)
NEC for r=0.8 class 1.0 = 0.001 +- 0.351 (in-sample avg dev_std = 0.391)
NEC for r=0.8 all KL = 0.187 +- 0.351 (in-sample avg dev_std = 0.391)
NEC for r=0.8 all L1 = 0.102 +- 0.203 (in-sample avg dev_std = 0.391)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5890152
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.72
NEC for r=0.05 class 0.0 = 0.016 +- 0.448 (in-sample avg dev_std = 0.255)
NEC for r=0.05 class 1.0 = 0.506 +- 0.448 (in-sample avg dev_std = 0.255)
NEC for r=0.05 all KL = 0.327 +- 0.448 (in-sample avg dev_std = 0.255)
NEC for r=0.05 all L1 = 0.258 +- 0.373 (in-sample avg dev_std = 0.255)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6307624
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.768
NEC for r=0.1 class 0.0 = 0.018 +- 0.428 (in-sample avg dev_std = 0.286)
NEC for r=0.1 class 1.0 = 0.429 +- 0.428 (in-sample avg dev_std = 0.286)
NEC for r=0.1 all KL = 0.288 +- 0.428 (in-sample avg dev_std = 0.286)
NEC for r=0.1 all L1 = 0.221 +- 0.350 (in-sample avg dev_std = 0.286)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6556327999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.841
NEC for r=0.2 class 0.0 = 0.02 +- 0.383 (in-sample avg dev_std = 0.283)
NEC for r=0.2 class 1.0 = 0.301 +- 0.383 (in-sample avg dev_std = 0.283)
NEC for r=0.2 all KL = 0.22 +- 0.383 (in-sample avg dev_std = 0.283)
NEC for r=0.2 all L1 = 0.159 +- 0.303 (in-sample avg dev_std = 0.283)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6706832
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.877
NEC for r=0.4 class 0.0 = 0.036 +- 0.353 (in-sample avg dev_std = 0.243)
NEC for r=0.4 class 1.0 = 0.22 +- 0.353 (in-sample avg dev_std = 0.243)
NEC for r=0.4 all KL = 0.175 +- 0.353 (in-sample avg dev_std = 0.243)
NEC for r=0.4 all L1 = 0.127 +- 0.279 (in-sample avg dev_std = 0.243)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6757221999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.913
NEC for r=0.8 class 0.0 = 0.078 +- 0.301 (in-sample avg dev_std = 0.233)
NEC for r=0.8 class 1.0 = 0.088 +- 0.301 (in-sample avg dev_std = 0.233)
NEC for r=0.8 all KL = 0.116 +- 0.301 (in-sample avg dev_std = 0.233)
NEC for r=0.8 all L1 = 0.083 +- 0.231 (in-sample avg dev_std = 0.233)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 11:26:26 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 11:26:26 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 11:26:26 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 11:26:26 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 11:26:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:26:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:26:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:26:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:26:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:26:26 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 11:26:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.591
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.671
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.686
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.666
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.645
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.661
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.632
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.614
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.608
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.608
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.589
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.638
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.666
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.676
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.671


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.590782
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.952
SUFF_SIMPLE for r=0.05 class 0.0 = 0.87 +- 0.291 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.991 +- 0.291 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.05 all KL = 0.882 +- 0.291 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.05 all L1 = 0.937 +- 0.172 (in-sample avg dev_std = 0.322)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.67062
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.962
SUFF_SIMPLE for r=0.1 class 0.0 = 0.896 +- 0.263 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.995 +- 0.263 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.1 all KL = 0.904 +- 0.263 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.1 all L1 = 0.951 +- 0.152 (in-sample avg dev_std = 0.288)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.686376
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.952
SUFF_SIMPLE for r=0.2 class 0.0 = 0.876 +- 0.279 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.994 +- 0.279 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.2 all KL = 0.893 +- 0.279 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.2 all L1 = 0.941 +- 0.173 (in-sample avg dev_std = 0.292)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.665924
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.949
SUFF_SIMPLE for r=0.4 class 0.0 = 0.875 +- 0.284 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.99 +- 0.284 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.4 all KL = 0.89 +- 0.284 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.4 all L1 = 0.939 +- 0.178 (in-sample avg dev_std = 0.289)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6453420000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.981
SUFF_SIMPLE for r=0.8 class 0.0 = 0.981 +- 0.144 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.984 +- 0.144 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.8 all KL = 0.977 +- 0.144 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.8 all L1 = 0.983 +- 0.116 (in-sample avg dev_std = 0.072)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6606139999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.884
SUFF_SIMPLE for r=0.05 class 0.0 = 0.739 +- 0.403 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.958 +- 0.403 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.05 all KL = 0.733 +- 0.403 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.05 all L1 = 0.85 +- 0.247 (in-sample avg dev_std = 0.512)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.631517
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.883
SUFF_SIMPLE for r=0.1 class 0.0 = 0.737 +- 0.403 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.959 +- 0.403 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.1 all KL = 0.733 +- 0.403 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.1 all L1 = 0.849 +- 0.248 (in-sample avg dev_std = 0.511)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.613718
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.883
SUFF_SIMPLE for r=0.2 class 0.0 = 0.739 +- 0.402 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.957 +- 0.402 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.2 all KL = 0.732 +- 0.402 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.2 all L1 = 0.849 +- 0.247 (in-sample avg dev_std = 0.510)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6084058
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.885
SUFF_SIMPLE for r=0.4 class 0.0 = 0.749 +- 0.400 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.953 +- 0.400 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.4 all KL = 0.737 +- 0.400 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.4 all L1 = 0.852 +- 0.246 (in-sample avg dev_std = 0.504)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6081776
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.913
SUFF_SIMPLE for r=0.8 class 0.0 = 0.874 +- 0.311 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.953 +- 0.311 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 all KL = 0.882 +- 0.311 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 all L1 = 0.914 +- 0.239 (in-sample avg dev_std = 0.232)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5885536
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.932
SUFF_SIMPLE for r=0.05 class 0.0 = 0.891 +- 0.254 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.998 +- 0.254 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.05 all KL = 0.927 +- 0.254 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.05 all L1 = 0.944 +- 0.203 (in-sample avg dev_std = 0.163)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6379520000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.932
SUFF_SIMPLE for r=0.1 class 0.0 = 0.893 +- 0.252 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.997 +- 0.252 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.1 all KL = 0.929 +- 0.252 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.1 all L1 = 0.944 +- 0.204 (in-sample avg dev_std = 0.149)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6657922000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.933
SUFF_SIMPLE for r=0.2 class 0.0 = 0.895 +- 0.248 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.998 +- 0.248 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 all KL = 0.932 +- 0.248 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 all L1 = 0.946 +- 0.203 (in-sample avg dev_std = 0.129)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6764781999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.94
SUFF_SIMPLE for r=0.4 class 0.0 = 0.912 +- 0.227 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.997 +- 0.227 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.4 all KL = 0.944 +- 0.227 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.190 (in-sample avg dev_std = 0.091)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.991
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.67089
len(reference) = 4925
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.985
SUFF_SIMPLE for r=0.8 class 0.0 = 0.99 +- 0.090 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.996 +- 0.090 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.992 +- 0.090 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.993 +- 0.077 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.590782
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.609
NEC for r=0.05 class 0.0 = 0.0 +- 0.488 (in-sample avg dev_std = 0.201)
NEC for r=0.05 class 1.0 = 0.622 +- 0.488 (in-sample avg dev_std = 0.201)
NEC for r=0.05 all KL = 0.409 +- 0.488 (in-sample avg dev_std = 0.201)
NEC for r=0.05 all L1 = 0.345 +- 0.417 (in-sample avg dev_std = 0.201)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.67062
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.738
NEC for r=0.1 class 0.0 = 0.029 +- 0.444 (in-sample avg dev_std = 0.385)
NEC for r=0.1 class 1.0 = 0.44 +- 0.444 (in-sample avg dev_std = 0.385)
NEC for r=0.1 all KL = 0.359 +- 0.444 (in-sample avg dev_std = 0.385)
NEC for r=0.1 all L1 = 0.257 +- 0.354 (in-sample avg dev_std = 0.385)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.686376
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.85
NEC for r=0.2 class 0.0 = 0.039 +- 0.388 (in-sample avg dev_std = 0.366)
NEC for r=0.2 class 1.0 = 0.253 +- 0.388 (in-sample avg dev_std = 0.366)
NEC for r=0.2 all KL = 0.242 +- 0.388 (in-sample avg dev_std = 0.366)
NEC for r=0.2 all L1 = 0.157 +- 0.287 (in-sample avg dev_std = 0.366)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.665924
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.942
NEC for r=0.4 class 0.0 = 0.051 +- 0.304 (in-sample avg dev_std = 0.343)
NEC for r=0.4 class 1.0 = 0.096 +- 0.304 (in-sample avg dev_std = 0.343)
NEC for r=0.4 all KL = 0.148 +- 0.304 (in-sample avg dev_std = 0.343)
NEC for r=0.4 all L1 = 0.076 +- 0.179 (in-sample avg dev_std = 0.343)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6453420000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.967
NEC for r=0.8 class 0.0 = 0.044 +- 0.259 (in-sample avg dev_std = 0.313)
NEC for r=0.8 class 1.0 = 0.054 +- 0.259 (in-sample avg dev_std = 0.313)
NEC for r=0.8 all KL = 0.106 +- 0.259 (in-sample avg dev_std = 0.313)
NEC for r=0.8 all L1 = 0.05 +- 0.133 (in-sample avg dev_std = 0.313)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6606139999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.501
NEC for r=0.05 class 0.0 = 0.011 +- 0.497 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.843 +- 0.497 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.496 +- 0.497 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.43 +- 0.431 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.631517
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.609
NEC for r=0.1 class 0.0 = 0.064 +- 0.467 (in-sample avg dev_std = 0.506)
NEC for r=0.1 class 1.0 = 0.701 +- 0.467 (in-sample avg dev_std = 0.506)
NEC for r=0.1 all KL = 0.512 +- 0.467 (in-sample avg dev_std = 0.506)
NEC for r=0.1 all L1 = 0.385 +- 0.379 (in-sample avg dev_std = 0.506)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.613718
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.885
NEC for r=0.2 class 0.0 = 0.186 +- 0.386 (in-sample avg dev_std = 0.571)
NEC for r=0.2 class 1.0 = 0.15 +- 0.386 (in-sample avg dev_std = 0.571)
NEC for r=0.2 all KL = 0.332 +- 0.386 (in-sample avg dev_std = 0.571)
NEC for r=0.2 all L1 = 0.168 +- 0.216 (in-sample avg dev_std = 0.571)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6084058
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.93
NEC for r=0.4 class 0.0 = 0.162 +- 0.353 (in-sample avg dev_std = 0.460)
NEC for r=0.4 class 1.0 = 0.049 +- 0.353 (in-sample avg dev_std = 0.460)
NEC for r=0.4 all KL = 0.221 +- 0.353 (in-sample avg dev_std = 0.460)
NEC for r=0.4 all L1 = 0.105 +- 0.182 (in-sample avg dev_std = 0.460)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6081776
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.966
NEC for r=0.8 class 0.0 = 0.085 +- 0.278 (in-sample avg dev_std = 0.341)
NEC for r=0.8 class 1.0 = 0.026 +- 0.278 (in-sample avg dev_std = 0.341)
NEC for r=0.8 all KL = 0.132 +- 0.278 (in-sample avg dev_std = 0.341)
NEC for r=0.8 all L1 = 0.055 +- 0.123 (in-sample avg dev_std = 0.341)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5885536
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.635
NEC for r=0.05 class 0.0 = 0.016 +- 0.482 (in-sample avg dev_std = 0.262)
NEC for r=0.05 class 1.0 = 0.651 +- 0.482 (in-sample avg dev_std = 0.262)
NEC for r=0.05 all KL = 0.4 +- 0.482 (in-sample avg dev_std = 0.262)
NEC for r=0.05 all L1 = 0.329 +- 0.406 (in-sample avg dev_std = 0.262)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6379520000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.721
NEC for r=0.1 class 0.0 = 0.022 +- 0.451 (in-sample avg dev_std = 0.298)
NEC for r=0.1 class 1.0 = 0.504 +- 0.451 (in-sample avg dev_std = 0.298)
NEC for r=0.1 all KL = 0.335 +- 0.451 (in-sample avg dev_std = 0.298)
NEC for r=0.1 all L1 = 0.26 +- 0.373 (in-sample avg dev_std = 0.298)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6657922000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.801
NEC for r=0.2 class 0.0 = 0.03 +- 0.413 (in-sample avg dev_std = 0.284)
NEC for r=0.2 class 1.0 = 0.357 +- 0.413 (in-sample avg dev_std = 0.284)
NEC for r=0.2 all KL = 0.255 +- 0.413 (in-sample avg dev_std = 0.284)
NEC for r=0.2 all L1 = 0.191 +- 0.334 (in-sample avg dev_std = 0.284)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6764781999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.861
NEC for r=0.4 class 0.0 = 0.046 +- 0.370 (in-sample avg dev_std = 0.264)
NEC for r=0.4 class 1.0 = 0.233 +- 0.370 (in-sample avg dev_std = 0.264)
NEC for r=0.4 all KL = 0.191 +- 0.370 (in-sample avg dev_std = 0.264)
NEC for r=0.4 all L1 = 0.138 +- 0.292 (in-sample avg dev_std = 0.264)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.67089
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.919
NEC for r=0.8 class 0.0 = 0.066 +- 0.314 (in-sample avg dev_std = 0.300)
NEC for r=0.8 class 1.0 = 0.107 +- 0.314 (in-sample avg dev_std = 0.300)
NEC for r=0.8 all KL = 0.136 +- 0.314 (in-sample avg dev_std = 0.300)
NEC for r=0.8 all L1 = 0.086 +- 0.221 (in-sample avg dev_std = 0.300)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 11:41:58 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 11:41:58 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 11:41:58 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 11:41:58 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 11:41:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:41:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:41:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:41:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:41:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:41:58 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 11:41:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.568
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.647
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.663
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.643
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.624
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.625
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.593
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.578
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.575
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.575
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.577
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.632
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.662
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.673
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.667


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5684980000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.94
SUFF_SIMPLE for r=0.05 class 0.0 = 0.844 +- 0.293 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.99 +- 0.293 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.05 all KL = 0.874 +- 0.293 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.05 all L1 = 0.925 +- 0.191 (in-sample avg dev_std = 0.348)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6473920000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.95
SUFF_SIMPLE for r=0.1 class 0.0 = 0.858 +- 0.272 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.996 +- 0.272 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.1 all KL = 0.884 +- 0.272 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.1 all L1 = 0.934 +- 0.170 (in-sample avg dev_std = 0.331)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.662936
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.938
SUFF_SIMPLE for r=0.2 class 0.0 = 0.837 +- 0.294 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.991 +- 0.294 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.2 all KL = 0.867 +- 0.294 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.2 all L1 = 0.922 +- 0.190 (in-sample avg dev_std = 0.349)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6430600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.939
SUFF_SIMPLE for r=0.4 class 0.0 = 0.857 +- 0.282 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.985 +- 0.282 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.4 all KL = 0.882 +- 0.282 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.4 all L1 = 0.928 +- 0.192 (in-sample avg dev_std = 0.309)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.623514
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.97
SUFF_SIMPLE for r=0.8 class 0.0 = 0.968 +- 0.188 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.97 +- 0.188 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.8 all KL = 0.956 +- 0.188 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.8 all L1 = 0.969 +- 0.142 (in-sample avg dev_std = 0.149)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.929
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6247208000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.749
SUFF_SIMPLE for r=0.05 class 0.0 = 0.637 +- 0.409 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.999 +- 0.409 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.05 all KL = 0.769 +- 0.409 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.05 all L1 = 0.82 +- 0.325 (in-sample avg dev_std = 0.329)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.929
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5931344
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.75
SUFF_SIMPLE for r=0.1 class 0.0 = 0.638 +- 0.409 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.409 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.1 all KL = 0.769 +- 0.409 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.1 all L1 = 0.82 +- 0.325 (in-sample avg dev_std = 0.332)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.929
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5782348
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.749
SUFF_SIMPLE for r=0.2 class 0.0 = 0.638 +- 0.409 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.409 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.2 all KL = 0.769 +- 0.409 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.2 all L1 = 0.82 +- 0.325 (in-sample avg dev_std = 0.331)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.929
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5748004
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.754
SUFF_SIMPLE for r=0.4 class 0.0 = 0.645 +- 0.406 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.998 +- 0.406 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.4 all KL = 0.77 +- 0.406 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.4 all L1 = 0.823 +- 0.320 (in-sample avg dev_std = 0.341)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.929
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5746794
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.813
SUFF_SIMPLE for r=0.8 class 0.0 = 0.774 +- 0.338 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.997 +- 0.338 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.8 all KL = 0.854 +- 0.338 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.8 all L1 = 0.887 +- 0.272 (in-sample avg dev_std = 0.200)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5771316
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.928
SUFF_SIMPLE for r=0.05 class 0.0 = 0.883 +- 0.262 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.992 +- 0.262 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.05 all KL = 0.921 +- 0.262 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.05 all L1 = 0.937 +- 0.215 (in-sample avg dev_std = 0.157)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6318604
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.928
SUFF_SIMPLE for r=0.1 class 0.0 = 0.886 +- 0.259 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.992 +- 0.259 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.1 all KL = 0.924 +- 0.259 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.1 all L1 = 0.938 +- 0.215 (in-sample avg dev_std = 0.135)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6624736000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.93
SUFF_SIMPLE for r=0.2 class 0.0 = 0.892 +- 0.254 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.991 +- 0.254 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.2 all KL = 0.928 +- 0.254 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.2 all L1 = 0.941 +- 0.212 (in-sample avg dev_std = 0.124)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6730792
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.942
SUFF_SIMPLE for r=0.4 class 0.0 = 0.913 +- 0.230 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.991 +- 0.230 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.4 all KL = 0.941 +- 0.230 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.4 all L1 = 0.952 +- 0.193 (in-sample avg dev_std = 0.095)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6670904000000001
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.98
SUFF_SIMPLE for r=0.8 class 0.0 = 0.989 +- 0.118 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.986 +- 0.118 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.986 +- 0.118 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.987 +- 0.102 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5684980000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.614
NEC for r=0.05 class 0.0 = 0.006 +- 0.483 (in-sample avg dev_std = 0.213)
NEC for r=0.05 class 1.0 = 0.613 +- 0.483 (in-sample avg dev_std = 0.213)
NEC for r=0.05 all KL = 0.406 +- 0.483 (in-sample avg dev_std = 0.213)
NEC for r=0.05 all L1 = 0.342 +- 0.413 (in-sample avg dev_std = 0.213)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6473920000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.742
NEC for r=0.1 class 0.0 = 0.027 +- 0.433 (in-sample avg dev_std = 0.372)
NEC for r=0.1 class 1.0 = 0.432 +- 0.433 (in-sample avg dev_std = 0.372)
NEC for r=0.1 all KL = 0.337 +- 0.433 (in-sample avg dev_std = 0.372)
NEC for r=0.1 all L1 = 0.252 +- 0.353 (in-sample avg dev_std = 0.372)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.662936
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.851
NEC for r=0.2 class 0.0 = 0.045 +- 0.373 (in-sample avg dev_std = 0.332)
NEC for r=0.2 class 1.0 = 0.238 +- 0.373 (in-sample avg dev_std = 0.332)
NEC for r=0.2 all KL = 0.213 +- 0.373 (in-sample avg dev_std = 0.332)
NEC for r=0.2 all L1 = 0.152 +- 0.290 (in-sample avg dev_std = 0.332)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6430600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.933
NEC for r=0.4 class 0.0 = 0.062 +- 0.297 (in-sample avg dev_std = 0.344)
NEC for r=0.4 class 1.0 = 0.1 +- 0.297 (in-sample avg dev_std = 0.344)
NEC for r=0.4 all KL = 0.139 +- 0.297 (in-sample avg dev_std = 0.344)
NEC for r=0.4 all L1 = 0.083 +- 0.195 (in-sample avg dev_std = 0.344)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.623514
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.97
NEC for r=0.8 class 0.0 = 0.046 +- 0.235 (in-sample avg dev_std = 0.319)
NEC for r=0.8 class 1.0 = 0.05 +- 0.235 (in-sample avg dev_std = 0.319)
NEC for r=0.8 all KL = 0.096 +- 0.235 (in-sample avg dev_std = 0.319)
NEC for r=0.8 all L1 = 0.049 +- 0.124 (in-sample avg dev_std = 0.319)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.929
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6247208000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.471 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.776 +- 0.471 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.432 +- 0.471 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.392 +- 0.413 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.929
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5931344
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.571
NEC for r=0.1 class 0.0 = 0.047 +- 0.448 (in-sample avg dev_std = 0.433)
NEC for r=0.1 class 1.0 = 0.654 +- 0.448 (in-sample avg dev_std = 0.433)
NEC for r=0.1 all KL = 0.44 +- 0.448 (in-sample avg dev_std = 0.433)
NEC for r=0.1 all L1 = 0.353 +- 0.371 (in-sample avg dev_std = 0.433)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.929
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5782348
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.821
NEC for r=0.2 class 0.0 = 0.227 +- 0.357 (in-sample avg dev_std = 0.472)
NEC for r=0.2 class 1.0 = 0.059 +- 0.357 (in-sample avg dev_std = 0.472)
NEC for r=0.2 all KL = 0.234 +- 0.357 (in-sample avg dev_std = 0.472)
NEC for r=0.2 all L1 = 0.142 +- 0.235 (in-sample avg dev_std = 0.472)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.929
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5748004
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.825
NEC for r=0.4 class 0.0 = 0.252 +- 0.363 (in-sample avg dev_std = 0.432)
NEC for r=0.4 class 1.0 = 0.009 +- 0.363 (in-sample avg dev_std = 0.432)
NEC for r=0.4 all KL = 0.203 +- 0.363 (in-sample avg dev_std = 0.432)
NEC for r=0.4 all L1 = 0.129 +- 0.245 (in-sample avg dev_std = 0.432)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.929
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5746794
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.851
NEC for r=0.8 class 0.0 = 0.212 +- 0.339 (in-sample avg dev_std = 0.423)
NEC for r=0.8 class 1.0 = 0.003 +- 0.339 (in-sample avg dev_std = 0.423)
NEC for r=0.8 all KL = 0.181 +- 0.339 (in-sample avg dev_std = 0.423)
NEC for r=0.8 all L1 = 0.107 +- 0.211 (in-sample avg dev_std = 0.423)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5771316
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.644
NEC for r=0.05 class 0.0 = 0.009 +- 0.475 (in-sample avg dev_std = 0.263)
NEC for r=0.05 class 1.0 = 0.634 +- 0.475 (in-sample avg dev_std = 0.263)
NEC for r=0.05 all KL = 0.383 +- 0.475 (in-sample avg dev_std = 0.263)
NEC for r=0.05 all L1 = 0.318 +- 0.402 (in-sample avg dev_std = 0.263)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6318604
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.727
NEC for r=0.1 class 0.0 = 0.012 +- 0.441 (in-sample avg dev_std = 0.299)
NEC for r=0.1 class 1.0 = 0.501 +- 0.441 (in-sample avg dev_std = 0.299)
NEC for r=0.1 all KL = 0.321 +- 0.441 (in-sample avg dev_std = 0.299)
NEC for r=0.1 all L1 = 0.253 +- 0.368 (in-sample avg dev_std = 0.299)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6624736000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.806
NEC for r=0.2 class 0.0 = 0.014 +- 0.399 (in-sample avg dev_std = 0.273)
NEC for r=0.2 class 1.0 = 0.357 +- 0.399 (in-sample avg dev_std = 0.273)
NEC for r=0.2 all KL = 0.236 +- 0.399 (in-sample avg dev_std = 0.273)
NEC for r=0.2 all L1 = 0.183 +- 0.329 (in-sample avg dev_std = 0.273)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6730792
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.857
NEC for r=0.4 class 0.0 = 0.029 +- 0.359 (in-sample avg dev_std = 0.243)
NEC for r=0.4 class 1.0 = 0.246 +- 0.359 (in-sample avg dev_std = 0.243)
NEC for r=0.4 all KL = 0.177 +- 0.359 (in-sample avg dev_std = 0.243)
NEC for r=0.4 all L1 = 0.136 +- 0.292 (in-sample avg dev_std = 0.243)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.987
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6670904000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.902
NEC for r=0.8 class 0.0 = 0.063 +- 0.324 (in-sample avg dev_std = 0.312)
NEC for r=0.8 class 1.0 = 0.142 +- 0.324 (in-sample avg dev_std = 0.312)
NEC for r=0.8 all KL = 0.148 +- 0.324 (in-sample avg dev_std = 0.312)
NEC for r=0.8 all L1 = 0.102 +- 0.242 (in-sample avg dev_std = 0.312)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 11:57:45 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 11:57:45 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 11:57:45 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 11:57:45 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 11:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:57:45 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 11:57:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.578
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.642
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.656
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.646
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.635
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.538
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.490
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.468
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.463
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.462
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.575
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.622
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.646
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.657
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.659


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5778099999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.915
SUFF_SIMPLE for r=0.05 class 0.0 = 0.895 +- 0.306 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.859 +- 0.306 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.05 all KL = 0.793 +- 0.306 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.05 all L1 = 0.875 +- 0.196 (in-sample avg dev_std = 0.463)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.642428
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.915
SUFF_SIMPLE for r=0.1 class 0.0 = 0.892 +- 0.300 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.869 +- 0.300 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.1 all KL = 0.802 +- 0.300 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.1 all L1 = 0.879 +- 0.195 (in-sample avg dev_std = 0.445)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6555319999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.904
SUFF_SIMPLE for r=0.2 class 0.0 = 0.9 +- 0.319 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.846 +- 0.319 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.2 all KL = 0.793 +- 0.319 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.2 all L1 = 0.87 +- 0.214 (in-sample avg dev_std = 0.451)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.646244
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.879
SUFF_SIMPLE for r=0.4 class 0.0 = 0.899 +- 0.339 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.806 +- 0.339 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.4 all KL = 0.771 +- 0.339 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.4 all L1 = 0.848 +- 0.243 (in-sample avg dev_std = 0.447)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6348959999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.845
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.375 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.717 +- 0.375 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.8 all KL = 0.794 +- 0.375 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.8 all L1 = 0.838 +- 0.298 (in-sample avg dev_std = 0.315)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.537904
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.653
SUFF_SIMPLE for r=0.05 class 0.0 = 0.937 +- 0.402 (in-sample avg dev_std = 0.598)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.485 +- 0.402 (in-sample avg dev_std = 0.598)
SUFF_SIMPLE for r=0.05 all KL = 0.61 +- 0.402 (in-sample avg dev_std = 0.598)
SUFF_SIMPLE for r=0.05 all L1 = 0.709 +- 0.295 (in-sample avg dev_std = 0.598)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49017380000000005
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.646
SUFF_SIMPLE for r=0.1 class 0.0 = 0.937 +- 0.405 (in-sample avg dev_std = 0.593)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.474 +- 0.405 (in-sample avg dev_std = 0.593)
SUFF_SIMPLE for r=0.1 all KL = 0.607 +- 0.405 (in-sample avg dev_std = 0.593)
SUFF_SIMPLE for r=0.1 all L1 = 0.703 +- 0.300 (in-sample avg dev_std = 0.593)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46806099999999995
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.634
SUFF_SIMPLE for r=0.2 class 0.0 = 0.94 +- 0.410 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.456 +- 0.410 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.2 all KL = 0.603 +- 0.410 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.2 all L1 = 0.696 +- 0.308 (in-sample avg dev_std = 0.581)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.46268940000000003
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.614
SUFF_SIMPLE for r=0.4 class 0.0 = 0.95 +- 0.419 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.423 +- 0.419 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.4 all KL = 0.603 +- 0.419 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.4 all L1 = 0.684 +- 0.325 (in-sample avg dev_std = 0.545)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.4624746
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.533
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.446 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.335 +- 0.446 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.8 all KL = 0.637 +- 0.446 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.8 all L1 = 0.663 +- 0.389 (in-sample avg dev_std = 0.116)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.979
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5754468
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.925
SUFF_SIMPLE for r=0.05 class 0.0 = 0.886 +- 0.274 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.966 +- 0.274 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.05 all KL = 0.907 +- 0.274 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.05 all L1 = 0.925 +- 0.225 (in-sample avg dev_std = 0.185)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.979
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6217768
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.927
SUFF_SIMPLE for r=0.1 class 0.0 = 0.892 +- 0.268 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.967 +- 0.268 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.1 all KL = 0.911 +- 0.268 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.1 all L1 = 0.929 +- 0.221 (in-sample avg dev_std = 0.173)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.979
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6455696
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.928
SUFF_SIMPLE for r=0.2 class 0.0 = 0.895 +- 0.266 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.966 +- 0.266 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.2 all KL = 0.914 +- 0.266 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.2 all L1 = 0.93 +- 0.221 (in-sample avg dev_std = 0.154)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.979
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6570275999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.936
SUFF_SIMPLE for r=0.4 class 0.0 = 0.918 +- 0.255 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.954 +- 0.255 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.4 all KL = 0.923 +- 0.255 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.4 all L1 = 0.936 +- 0.213 (in-sample avg dev_std = 0.136)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.979
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6593992000000001
len(reference) = 4919
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.959
SUFF_SIMPLE for r=0.8 class 0.0 = 0.984 +- 0.182 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.949 +- 0.182 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.963 +- 0.182 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.967 +- 0.159 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5778099999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.65
NEC for r=0.05 class 0.0 = 0.009 +- 0.470 (in-sample avg dev_std = 0.199)
NEC for r=0.05 class 1.0 = 0.558 +- 0.470 (in-sample avg dev_std = 0.199)
NEC for r=0.05 all KL = 0.363 +- 0.470 (in-sample avg dev_std = 0.199)
NEC for r=0.05 all L1 = 0.313 +- 0.401 (in-sample avg dev_std = 0.199)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.642428
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.76
NEC for r=0.1 class 0.0 = 0.02 +- 0.415 (in-sample avg dev_std = 0.393)
NEC for r=0.1 class 1.0 = 0.425 +- 0.415 (in-sample avg dev_std = 0.393)
NEC for r=0.1 all KL = 0.32 +- 0.415 (in-sample avg dev_std = 0.393)
NEC for r=0.1 all L1 = 0.245 +- 0.338 (in-sample avg dev_std = 0.393)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6555319999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.862
NEC for r=0.2 class 0.0 = 0.03 +- 0.348 (in-sample avg dev_std = 0.339)
NEC for r=0.2 class 1.0 = 0.243 +- 0.348 (in-sample avg dev_std = 0.339)
NEC for r=0.2 all KL = 0.202 +- 0.348 (in-sample avg dev_std = 0.339)
NEC for r=0.2 all L1 = 0.148 +- 0.273 (in-sample avg dev_std = 0.339)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.646244
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.944
NEC for r=0.4 class 0.0 = 0.036 +- 0.252 (in-sample avg dev_std = 0.282)
NEC for r=0.4 class 1.0 = 0.097 +- 0.252 (in-sample avg dev_std = 0.282)
NEC for r=0.4 all KL = 0.104 +- 0.252 (in-sample avg dev_std = 0.282)
NEC for r=0.4 all L1 = 0.07 +- 0.179 (in-sample avg dev_std = 0.282)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6348959999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.972
NEC for r=0.8 class 0.0 = 0.032 +- 0.198 (in-sample avg dev_std = 0.271)
NEC for r=0.8 class 1.0 = 0.051 +- 0.198 (in-sample avg dev_std = 0.271)
NEC for r=0.8 all KL = 0.072 +- 0.198 (in-sample avg dev_std = 0.271)
NEC for r=0.8 all L1 = 0.043 +- 0.122 (in-sample avg dev_std = 0.271)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.537904
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.729 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.393 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.368 +- 0.397 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49017380000000005
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.559
NEC for r=0.1 class 0.0 = 0.02 +- 0.434 (in-sample avg dev_std = 0.390)
NEC for r=0.1 class 1.0 = 0.648 +- 0.434 (in-sample avg dev_std = 0.390)
NEC for r=0.1 all KL = 0.391 +- 0.434 (in-sample avg dev_std = 0.390)
NEC for r=0.1 all L1 = 0.337 +- 0.363 (in-sample avg dev_std = 0.390)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46806099999999995
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.76
NEC for r=0.2 class 0.0 = 0.056 +- 0.331 (in-sample avg dev_std = 0.530)
NEC for r=0.2 class 1.0 = 0.3 +- 0.331 (in-sample avg dev_std = 0.530)
NEC for r=0.2 all KL = 0.271 +- 0.331 (in-sample avg dev_std = 0.530)
NEC for r=0.2 all L1 = 0.179 +- 0.215 (in-sample avg dev_std = 0.530)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.46268940000000003
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.772
NEC for r=0.4 class 0.0 = 0.038 +- 0.323 (in-sample avg dev_std = 0.491)
NEC for r=0.4 class 1.0 = 0.284 +- 0.323 (in-sample avg dev_std = 0.491)
NEC for r=0.4 all KL = 0.239 +- 0.323 (in-sample avg dev_std = 0.491)
NEC for r=0.4 all L1 = 0.162 +- 0.214 (in-sample avg dev_std = 0.491)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.4624746
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.727
NEC for r=0.8 class 0.0 = 0.011 +- 0.364 (in-sample avg dev_std = 0.503)
NEC for r=0.8 class 1.0 = 0.397 +- 0.364 (in-sample avg dev_std = 0.503)
NEC for r=0.8 all KL = 0.271 +- 0.364 (in-sample avg dev_std = 0.503)
NEC for r=0.8 all L1 = 0.205 +- 0.263 (in-sample avg dev_std = 0.503)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.979
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5754468
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.678
NEC for r=0.05 class 0.0 = 0.017 +- 0.454 (in-sample avg dev_std = 0.214)
NEC for r=0.05 class 1.0 = 0.568 +- 0.454 (in-sample avg dev_std = 0.214)
NEC for r=0.05 all KL = 0.338 +- 0.454 (in-sample avg dev_std = 0.214)
NEC for r=0.05 all L1 = 0.289 +- 0.388 (in-sample avg dev_std = 0.214)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.979
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6217768
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.749
NEC for r=0.1 class 0.0 = 0.019 +- 0.421 (in-sample avg dev_std = 0.299)
NEC for r=0.1 class 1.0 = 0.462 +- 0.421 (in-sample avg dev_std = 0.299)
NEC for r=0.1 all KL = 0.292 +- 0.421 (in-sample avg dev_std = 0.299)
NEC for r=0.1 all L1 = 0.238 +- 0.352 (in-sample avg dev_std = 0.299)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.979
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6455696
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.809
NEC for r=0.2 class 0.0 = 0.022 +- 0.385 (in-sample avg dev_std = 0.287)
NEC for r=0.2 class 1.0 = 0.349 +- 0.385 (in-sample avg dev_std = 0.287)
NEC for r=0.2 all KL = 0.231 +- 0.385 (in-sample avg dev_std = 0.287)
NEC for r=0.2 all L1 = 0.184 +- 0.318 (in-sample avg dev_std = 0.287)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.979
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6570275999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.86
NEC for r=0.4 class 0.0 = 0.035 +- 0.343 (in-sample avg dev_std = 0.261)
NEC for r=0.4 class 1.0 = 0.239 +- 0.343 (in-sample avg dev_std = 0.261)
NEC for r=0.4 all KL = 0.174 +- 0.343 (in-sample avg dev_std = 0.261)
NEC for r=0.4 all L1 = 0.136 +- 0.281 (in-sample avg dev_std = 0.261)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.979
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6593992000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.904
NEC for r=0.8 class 0.0 = 0.064 +- 0.308 (in-sample avg dev_std = 0.302)
NEC for r=0.8 class 1.0 = 0.139 +- 0.308 (in-sample avg dev_std = 0.302)
NEC for r=0.8 all KL = 0.139 +- 0.308 (in-sample avg dev_std = 0.302)
NEC for r=0.8 all L1 = 0.101 +- 0.237 (in-sample avg dev_std = 0.302)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 12:13:40 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 12:13:40 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 12:13:40 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:13:40 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 12:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:13:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:13:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:13:40 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:13:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.606
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.698
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.738
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.747
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.745
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.686
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.678
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.676
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.676
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.676
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.588
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.636
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.665
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.683
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.688


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.605934
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.933
SUFF_SIMPLE for r=0.05 class 0.0 = 0.82 +- 0.310 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.310 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all KL = 0.868 +- 0.310 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all L1 = 0.92 +- 0.205 (in-sample avg dev_std = 0.340)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6984199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.938
SUFF_SIMPLE for r=0.1 class 0.0 = 0.838 +- 0.292 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.292 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.1 all KL = 0.884 +- 0.292 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.1 all L1 = 0.928 +- 0.200 (in-sample avg dev_std = 0.300)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.737992
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.928
SUFF_SIMPLE for r=0.2 class 0.0 = 0.812 +- 0.314 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.314 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.2 all KL = 0.865 +- 0.314 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.2 all L1 = 0.916 +- 0.212 (in-sample avg dev_std = 0.331)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.746616
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.934
SUFF_SIMPLE for r=0.4 class 0.0 = 0.828 +- 0.299 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.299 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.4 all KL = 0.878 +- 0.299 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.4 all L1 = 0.923 +- 0.206 (in-sample avg dev_std = 0.290)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.74456
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.985
SUFF_SIMPLE for r=0.8 class 0.0 = 0.964 +- 0.143 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.143 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.8 all KL = 0.975 +- 0.143 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.8 all L1 = 0.984 +- 0.102 (in-sample avg dev_std = 0.116)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6862308
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.812
SUFF_SIMPLE for r=0.05 class 0.0 = 0.694 +- 0.403 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.999 +- 0.403 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.05 all KL = 0.768 +- 0.403 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.05 all L1 = 0.848 +- 0.279 (in-sample avg dev_std = 0.415)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.678315
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.808
SUFF_SIMPLE for r=0.1 class 0.0 = 0.69 +- 0.404 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.404 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.1 all KL = 0.767 +- 0.404 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.1 all L1 = 0.846 +- 0.282 (in-sample avg dev_std = 0.410)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6761617999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.807
SUFF_SIMPLE for r=0.2 class 0.0 = 0.688 +- 0.405 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.405 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.2 all KL = 0.767 +- 0.405 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.2 all L1 = 0.845 +- 0.284 (in-sample avg dev_std = 0.406)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6759417999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.801
SUFF_SIMPLE for r=0.4 class 0.0 = 0.681 +- 0.407 (in-sample avg dev_std = 0.397)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.999 +- 0.407 (in-sample avg dev_std = 0.397)
SUFF_SIMPLE for r=0.4 all KL = 0.766 +- 0.407 (in-sample avg dev_std = 0.397)
SUFF_SIMPLE for r=0.4 all L1 = 0.842 +- 0.289 (in-sample avg dev_std = 0.397)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6759394
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.826
SUFF_SIMPLE for r=0.8 class 0.0 = 0.767 +- 0.351 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.351 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.8 all KL = 0.843 +- 0.351 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.8 all L1 = 0.884 +- 0.272 (in-sample avg dev_std = 0.197)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5882718000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.924
SUFF_SIMPLE for r=0.05 class 0.0 = 0.884 +- 0.256 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.256 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all KL = 0.927 +- 0.256 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all L1 = 0.941 +- 0.211 (in-sample avg dev_std = 0.139)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6363555999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.923
SUFF_SIMPLE for r=0.1 class 0.0 = 0.884 +- 0.254 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.254 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.1 all KL = 0.929 +- 0.254 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.1 all L1 = 0.941 +- 0.212 (in-sample avg dev_std = 0.112)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6654072
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.922
SUFF_SIMPLE for r=0.2 class 0.0 = 0.883 +- 0.255 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.255 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.2 all KL = 0.928 +- 0.255 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.2 all L1 = 0.941 +- 0.214 (in-sample avg dev_std = 0.103)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6832090000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.925
SUFF_SIMPLE for r=0.4 class 0.0 = 0.888 +- 0.250 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.250 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.4 all KL = 0.931 +- 0.250 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.4 all L1 = 0.943 +- 0.209 (in-sample avg dev_std = 0.108)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.989
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.687851
len(reference) = 4956
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.979
SUFF_SIMPLE for r=0.8 class 0.0 = 0.982 +- 0.100 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.100 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.989 +- 0.100 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.991 +- 0.086 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.605934
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.615
NEC for r=0.05 class 0.0 = 0.001 +- 0.486 (in-sample avg dev_std = 0.201)
NEC for r=0.05 class 1.0 = 0.616 +- 0.486 (in-sample avg dev_std = 0.201)
NEC for r=0.05 all KL = 0.405 +- 0.486 (in-sample avg dev_std = 0.201)
NEC for r=0.05 all L1 = 0.342 +- 0.414 (in-sample avg dev_std = 0.201)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6984199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.735
NEC for r=0.1 class 0.0 = 0.012 +- 0.444 (in-sample avg dev_std = 0.413)
NEC for r=0.1 class 1.0 = 0.466 +- 0.444 (in-sample avg dev_std = 0.413)
NEC for r=0.1 all KL = 0.37 +- 0.444 (in-sample avg dev_std = 0.413)
NEC for r=0.1 all L1 = 0.263 +- 0.351 (in-sample avg dev_std = 0.413)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.737992
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.862
NEC for r=0.2 class 0.0 = 0.017 +- 0.375 (in-sample avg dev_std = 0.333)
NEC for r=0.2 class 1.0 = 0.245 +- 0.375 (in-sample avg dev_std = 0.333)
NEC for r=0.2 all KL = 0.211 +- 0.375 (in-sample avg dev_std = 0.333)
NEC for r=0.2 all L1 = 0.143 +- 0.281 (in-sample avg dev_std = 0.333)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.746616
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.941
NEC for r=0.4 class 0.0 = 0.026 +- 0.292 (in-sample avg dev_std = 0.321)
NEC for r=0.4 class 1.0 = 0.112 +- 0.292 (in-sample avg dev_std = 0.321)
NEC for r=0.4 all KL = 0.133 +- 0.292 (in-sample avg dev_std = 0.321)
NEC for r=0.4 all L1 = 0.074 +- 0.184 (in-sample avg dev_std = 0.321)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.74456
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.985
NEC for r=0.8 class 0.0 = 0.027 +- 0.180 (in-sample avg dev_std = 0.217)
NEC for r=0.8 class 1.0 = 0.021 +- 0.180 (in-sample avg dev_std = 0.217)
NEC for r=0.8 all KL = 0.052 +- 0.180 (in-sample avg dev_std = 0.217)
NEC for r=0.8 all L1 = 0.024 +- 0.090 (in-sample avg dev_std = 0.217)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6862308
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.802 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.44 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.405 +- 0.411 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.678315
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.57
NEC for r=0.1 class 0.0 = 0.021 +- 0.453 (in-sample avg dev_std = 0.419)
NEC for r=0.1 class 1.0 = 0.695 +- 0.453 (in-sample avg dev_std = 0.419)
NEC for r=0.1 all KL = 0.44 +- 0.453 (in-sample avg dev_std = 0.419)
NEC for r=0.1 all L1 = 0.361 +- 0.375 (in-sample avg dev_std = 0.419)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6761617999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.863
NEC for r=0.2 class 0.0 = 0.13 +- 0.333 (in-sample avg dev_std = 0.459)
NEC for r=0.2 class 1.0 = 0.114 +- 0.333 (in-sample avg dev_std = 0.459)
NEC for r=0.2 all KL = 0.234 +- 0.333 (in-sample avg dev_std = 0.459)
NEC for r=0.2 all L1 = 0.122 +- 0.177 (in-sample avg dev_std = 0.459)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6759417999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.893
NEC for r=0.4 class 0.0 = 0.132 +- 0.299 (in-sample avg dev_std = 0.367)
NEC for r=0.4 class 1.0 = 0.025 +- 0.299 (in-sample avg dev_std = 0.367)
NEC for r=0.4 all KL = 0.16 +- 0.299 (in-sample avg dev_std = 0.367)
NEC for r=0.4 all L1 = 0.078 +- 0.155 (in-sample avg dev_std = 0.367)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6759394
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.906
NEC for r=0.8 class 0.0 = 0.115 +- 0.275 (in-sample avg dev_std = 0.328)
NEC for r=0.8 class 1.0 = 0.006 +- 0.275 (in-sample avg dev_std = 0.328)
NEC for r=0.8 all KL = 0.131 +- 0.275 (in-sample avg dev_std = 0.328)
NEC for r=0.8 all L1 = 0.06 +- 0.134 (in-sample avg dev_std = 0.328)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5882718000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.695
NEC for r=0.05 class 0.0 = 0.012 +- 0.458 (in-sample avg dev_std = 0.200)
NEC for r=0.05 class 1.0 = 0.538 +- 0.458 (in-sample avg dev_std = 0.200)
NEC for r=0.05 all KL = 0.331 +- 0.458 (in-sample avg dev_std = 0.200)
NEC for r=0.05 all L1 = 0.271 +- 0.388 (in-sample avg dev_std = 0.200)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6363555999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.752
NEC for r=0.1 class 0.0 = 0.014 +- 0.438 (in-sample avg dev_std = 0.303)
NEC for r=0.1 class 1.0 = 0.461 +- 0.438 (in-sample avg dev_std = 0.303)
NEC for r=0.1 all KL = 0.306 +- 0.438 (in-sample avg dev_std = 0.303)
NEC for r=0.1 all L1 = 0.235 +- 0.357 (in-sample avg dev_std = 0.303)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6654072
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.823
NEC for r=0.2 class 0.0 = 0.017 +- 0.399 (in-sample avg dev_std = 0.304)
NEC for r=0.2 class 1.0 = 0.34 +- 0.399 (in-sample avg dev_std = 0.304)
NEC for r=0.2 all KL = 0.243 +- 0.399 (in-sample avg dev_std = 0.304)
NEC for r=0.2 all L1 = 0.177 +- 0.317 (in-sample avg dev_std = 0.304)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6832090000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.859
NEC for r=0.4 class 0.0 = 0.03 +- 0.374 (in-sample avg dev_std = 0.282)
NEC for r=0.4 class 1.0 = 0.266 +- 0.374 (in-sample avg dev_std = 0.282)
NEC for r=0.4 all KL = 0.206 +- 0.374 (in-sample avg dev_std = 0.282)
NEC for r=0.4 all L1 = 0.147 +- 0.293 (in-sample avg dev_std = 0.282)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.687851
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.899
NEC for r=0.8 class 0.0 = 0.071 +- 0.335 (in-sample avg dev_std = 0.299)
NEC for r=0.8 class 1.0 = 0.14 +- 0.335 (in-sample avg dev_std = 0.299)
NEC for r=0.8 all KL = 0.155 +- 0.335 (in-sample avg dev_std = 0.299)
NEC for r=0.8 all L1 = 0.105 +- 0.249 (in-sample avg dev_std = 0.299)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 12:29:26 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 12:29:26 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 12:29:26 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:29:26 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 12:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:29:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:29:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:29:26 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:29:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.608
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.665
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.669
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.646
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.626
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.610
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.580
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.567
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.564
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.564
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.592
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.638
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.660
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.665
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.657


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.607754
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.951
SUFF_SIMPLE for r=0.05 class 0.0 = 0.891 +- 0.269 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.97 +- 0.269 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.05 all KL = 0.884 +- 0.269 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.05 all L1 = 0.935 +- 0.169 (in-sample avg dev_std = 0.333)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.665344
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.953
SUFF_SIMPLE for r=0.1 class 0.0 = 0.905 +- 0.267 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.961 +- 0.267 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.1 all KL = 0.884 +- 0.267 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.1 all L1 = 0.936 +- 0.164 (in-sample avg dev_std = 0.334)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.668788
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.954
SUFF_SIMPLE for r=0.2 class 0.0 = 0.905 +- 0.260 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.966 +- 0.260 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.2 all KL = 0.89 +- 0.260 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.2 all L1 = 0.939 +- 0.163 (in-sample avg dev_std = 0.320)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.646372
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.939
SUFF_SIMPLE for r=0.4 class 0.0 = 0.915 +- 0.279 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.937 +- 0.279 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.4 all KL = 0.88 +- 0.279 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.4 all L1 = 0.927 +- 0.191 (in-sample avg dev_std = 0.306)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6258859999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.944
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.237 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.909 +- 0.237 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.8 all KL = 0.938 +- 0.237 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.8 all L1 = 0.949 +- 0.198 (in-sample avg dev_std = 0.100)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6103658
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.825
SUFF_SIMPLE for r=0.05 class 0.0 = 0.892 +- 0.367 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.697 +- 0.367 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.05 all KL = 0.639 +- 0.367 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.05 all L1 = 0.794 +- 0.218 (in-sample avg dev_std = 0.611)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.57956
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.812
SUFF_SIMPLE for r=0.1 class 0.0 = 0.898 +- 0.373 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.665 +- 0.373 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.1 all KL = 0.627 +- 0.373 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.1 all L1 = 0.78 +- 0.229 (in-sample avg dev_std = 0.623)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5668784
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.79
SUFF_SIMPLE for r=0.2 class 0.0 = 0.909 +- 0.386 (in-sample avg dev_std = 0.640)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.611 +- 0.386 (in-sample avg dev_std = 0.640)
SUFF_SIMPLE for r=0.2 all KL = 0.609 +- 0.386 (in-sample avg dev_std = 0.640)
SUFF_SIMPLE for r=0.2 all L1 = 0.759 +- 0.247 (in-sample avg dev_std = 0.640)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5644142
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.74
SUFF_SIMPLE for r=0.4 class 0.0 = 0.942 +- 0.408 (in-sample avg dev_std = 0.653)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.491 +- 0.408 (in-sample avg dev_std = 0.653)
SUFF_SIMPLE for r=0.4 all KL = 0.578 +- 0.408 (in-sample avg dev_std = 0.653)
SUFF_SIMPLE for r=0.4 all L1 = 0.715 +- 0.284 (in-sample avg dev_std = 0.653)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5643466
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.601
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.455 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.345 +- 0.455 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.8 all KL = 0.627 +- 0.455 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.8 all L1 = 0.668 +- 0.399 (in-sample avg dev_std = 0.195)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.592398
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.931
SUFF_SIMPLE for r=0.05 class 0.0 = 0.891 +- 0.268 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.976 +- 0.268 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 all KL = 0.914 +- 0.268 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 all L1 = 0.933 +- 0.218 (in-sample avg dev_std = 0.178)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6381454
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.935
SUFF_SIMPLE for r=0.1 class 0.0 = 0.899 +- 0.262 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.975 +- 0.262 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.1 all KL = 0.919 +- 0.262 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.1 all L1 = 0.937 +- 0.213 (in-sample avg dev_std = 0.165)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6601752
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.936
SUFF_SIMPLE for r=0.2 class 0.0 = 0.902 +- 0.260 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.975 +- 0.260 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.2 all KL = 0.922 +- 0.260 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.2 all L1 = 0.938 +- 0.212 (in-sample avg dev_std = 0.155)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6654783999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.945
SUFF_SIMPLE for r=0.4 class 0.0 = 0.927 +- 0.239 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.968 +- 0.239 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.4 all KL = 0.935 +- 0.239 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.4 all L1 = 0.947 +- 0.199 (in-sample avg dev_std = 0.112)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6571288
len(reference) = 4912
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.969
SUFF_SIMPLE for r=0.8 class 0.0 = 0.987 +- 0.160 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.966 +- 0.160 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.973 +- 0.160 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.977 +- 0.138 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.607754
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.631
NEC for r=0.05 class 0.0 = 0.002 +- 0.482 (in-sample avg dev_std = 0.198)
NEC for r=0.05 class 1.0 = 0.589 +- 0.482 (in-sample avg dev_std = 0.198)
NEC for r=0.05 all KL = 0.387 +- 0.482 (in-sample avg dev_std = 0.198)
NEC for r=0.05 all L1 = 0.327 +- 0.410 (in-sample avg dev_std = 0.198)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.665344
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.751
NEC for r=0.1 class 0.0 = 0.023 +- 0.433 (in-sample avg dev_std = 0.400)
NEC for r=0.1 class 1.0 = 0.431 +- 0.433 (in-sample avg dev_std = 0.400)
NEC for r=0.1 all KL = 0.346 +- 0.433 (in-sample avg dev_std = 0.400)
NEC for r=0.1 all L1 = 0.249 +- 0.345 (in-sample avg dev_std = 0.400)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.668788
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.863
NEC for r=0.2 class 0.0 = 0.027 +- 0.366 (in-sample avg dev_std = 0.324)
NEC for r=0.2 class 1.0 = 0.233 +- 0.366 (in-sample avg dev_std = 0.324)
NEC for r=0.2 all KL = 0.202 +- 0.366 (in-sample avg dev_std = 0.324)
NEC for r=0.2 all L1 = 0.141 +- 0.280 (in-sample avg dev_std = 0.324)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.646372
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.942
NEC for r=0.4 class 0.0 = 0.032 +- 0.274 (in-sample avg dev_std = 0.282)
NEC for r=0.4 class 1.0 = 0.096 +- 0.274 (in-sample avg dev_std = 0.282)
NEC for r=0.4 all KL = 0.108 +- 0.274 (in-sample avg dev_std = 0.282)
NEC for r=0.4 all L1 = 0.067 +- 0.189 (in-sample avg dev_std = 0.282)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6258859999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.979
NEC for r=0.8 class 0.0 = 0.023 +- 0.196 (in-sample avg dev_std = 0.251)
NEC for r=0.8 class 1.0 = 0.04 +- 0.196 (in-sample avg dev_std = 0.251)
NEC for r=0.8 all KL = 0.066 +- 0.196 (in-sample avg dev_std = 0.251)
NEC for r=0.8 all L1 = 0.032 +- 0.104 (in-sample avg dev_std = 0.251)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6103658
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.824 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.457 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.415 +- 0.416 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.57956
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.583
NEC for r=0.1 class 0.0 = 0.027 +- 0.452 (in-sample avg dev_std = 0.431)
NEC for r=0.1 class 1.0 = 0.706 +- 0.452 (in-sample avg dev_std = 0.431)
NEC for r=0.1 all KL = 0.456 +- 0.452 (in-sample avg dev_std = 0.431)
NEC for r=0.1 all L1 = 0.369 +- 0.377 (in-sample avg dev_std = 0.431)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5668784
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.872
NEC for r=0.2 class 0.0 = 0.143 +- 0.342 (in-sample avg dev_std = 0.518)
NEC for r=0.2 class 1.0 = 0.143 +- 0.342 (in-sample avg dev_std = 0.518)
NEC for r=0.2 all KL = 0.27 +- 0.342 (in-sample avg dev_std = 0.518)
NEC for r=0.2 all L1 = 0.143 +- 0.190 (in-sample avg dev_std = 0.518)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5644142
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.917
NEC for r=0.4 class 0.0 = 0.097 +- 0.284 (in-sample avg dev_std = 0.403)
NEC for r=0.4 class 1.0 = 0.069 +- 0.284 (in-sample avg dev_std = 0.403)
NEC for r=0.4 all KL = 0.168 +- 0.284 (in-sample avg dev_std = 0.403)
NEC for r=0.4 all L1 = 0.083 +- 0.143 (in-sample avg dev_std = 0.403)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5643466
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.942
NEC for r=0.8 class 0.0 = 0.04 +- 0.216 (in-sample avg dev_std = 0.295)
NEC for r=0.8 class 1.0 = 0.049 +- 0.216 (in-sample avg dev_std = 0.295)
NEC for r=0.8 all KL = 0.092 +- 0.216 (in-sample avg dev_std = 0.295)
NEC for r=0.8 all L1 = 0.044 +- 0.106 (in-sample avg dev_std = 0.295)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.592398
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.665
NEC for r=0.05 class 0.0 = 0.011 +- 0.468 (in-sample avg dev_std = 0.223)
NEC for r=0.05 class 1.0 = 0.585 +- 0.468 (in-sample avg dev_std = 0.223)
NEC for r=0.05 all KL = 0.353 +- 0.468 (in-sample avg dev_std = 0.223)
NEC for r=0.05 all L1 = 0.294 +- 0.397 (in-sample avg dev_std = 0.223)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6381454
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.746
NEC for r=0.1 class 0.0 = 0.012 +- 0.435 (in-sample avg dev_std = 0.282)
NEC for r=0.1 class 1.0 = 0.456 +- 0.435 (in-sample avg dev_std = 0.282)
NEC for r=0.1 all KL = 0.295 +- 0.435 (in-sample avg dev_std = 0.282)
NEC for r=0.1 all L1 = 0.232 +- 0.359 (in-sample avg dev_std = 0.282)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6601752
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.813
NEC for r=0.2 class 0.0 = 0.015 +- 0.395 (in-sample avg dev_std = 0.266)
NEC for r=0.2 class 1.0 = 0.334 +- 0.395 (in-sample avg dev_std = 0.266)
NEC for r=0.2 all KL = 0.225 +- 0.395 (in-sample avg dev_std = 0.266)
NEC for r=0.2 all L1 = 0.173 +- 0.321 (in-sample avg dev_std = 0.266)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6654783999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.864
NEC for r=0.4 class 0.0 = 0.03 +- 0.352 (in-sample avg dev_std = 0.243)
NEC for r=0.4 class 1.0 = 0.228 +- 0.352 (in-sample avg dev_std = 0.243)
NEC for r=0.4 all KL = 0.17 +- 0.352 (in-sample avg dev_std = 0.243)
NEC for r=0.4 all L1 = 0.128 +- 0.283 (in-sample avg dev_std = 0.243)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6571288
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.91
NEC for r=0.8 class 0.0 = 0.061 +- 0.315 (in-sample avg dev_std = 0.300)
NEC for r=0.8 class 1.0 = 0.126 +- 0.315 (in-sample avg dev_std = 0.300)
NEC for r=0.8 all KL = 0.136 +- 0.315 (in-sample avg dev_std = 0.300)
NEC for r=0.8 all L1 = 0.093 +- 0.231 (in-sample avg dev_std = 0.300)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 12:45:13 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 12:45:13 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:13 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:13 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 12:45:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:13 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:45:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.606
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.696
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.729
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.725
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.715
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.706
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.695
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.691
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.691
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.691
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.595
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.640
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.671
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.684
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.682


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6056379999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.902
SUFF_SIMPLE for r=0.05 class 0.0 = 0.953 +- 0.365 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.794 +- 0.365 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.05 all KL = 0.754 +- 0.365 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.05 all L1 = 0.865 +- 0.219 (in-sample avg dev_std = 0.501)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.696192
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.932
SUFF_SIMPLE for r=0.1 class 0.0 = 0.964 +- 0.324 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.86 +- 0.324 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.1 all KL = 0.83 +- 0.324 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.1 all L1 = 0.906 +- 0.195 (in-sample avg dev_std = 0.417)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.729034
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.911
SUFF_SIMPLE for r=0.2 class 0.0 = 0.951 +- 0.346 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.836 +- 0.346 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.2 all KL = 0.809 +- 0.346 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.2 all L1 = 0.887 +- 0.224 (in-sample avg dev_std = 0.426)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7247560000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.877
SUFF_SIMPLE for r=0.4 class 0.0 = 0.958 +- 0.375 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.78 +- 0.375 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.4 all KL = 0.784 +- 0.375 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.4 all L1 = 0.859 +- 0.266 (in-sample avg dev_std = 0.426)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.715498
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.828
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.385 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.716 +- 0.385 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 all KL = 0.804 +- 0.385 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 all L1 = 0.843 +- 0.320 (in-sample avg dev_std = 0.203)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7063147999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.865
SUFF_SIMPLE for r=0.05 class 0.0 = 0.941 +- 0.372 (in-sample avg dev_std = 0.575)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.696 +- 0.372 (in-sample avg dev_std = 0.575)
SUFF_SIMPLE for r=0.05 all KL = 0.687 +- 0.372 (in-sample avg dev_std = 0.575)
SUFF_SIMPLE for r=0.05 all L1 = 0.818 +- 0.233 (in-sample avg dev_std = 0.575)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6954691999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.854
SUFF_SIMPLE for r=0.1 class 0.0 = 0.946 +- 0.378 (in-sample avg dev_std = 0.586)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.669 +- 0.378 (in-sample avg dev_std = 0.586)
SUFF_SIMPLE for r=0.1 all KL = 0.675 +- 0.378 (in-sample avg dev_std = 0.586)
SUFF_SIMPLE for r=0.1 all L1 = 0.806 +- 0.243 (in-sample avg dev_std = 0.586)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6913632
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.821
SUFF_SIMPLE for r=0.2 class 0.0 = 0.955 +- 0.396 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.596 +- 0.396 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.2 all KL = 0.64 +- 0.396 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.2 all L1 = 0.774 +- 0.268 (in-sample avg dev_std = 0.609)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6907478
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.734
SUFF_SIMPLE for r=0.4 class 0.0 = 0.979 +- 0.431 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.43 +- 0.431 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.4 all KL = 0.584 +- 0.431 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.4 all L1 = 0.702 +- 0.325 (in-sample avg dev_std = 0.618)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.690738
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.652
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.458 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.395 +- 0.458 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.8 all KL = 0.644 +- 0.458 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.8 all L1 = 0.693 +- 0.397 (in-sample avg dev_std = 0.238)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.98
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5945608
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.932
SUFF_SIMPLE for r=0.05 class 0.0 = 0.929 +- 0.309 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.901 +- 0.309 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.05 all KL = 0.871 +- 0.309 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.05 all L1 = 0.915 +- 0.217 (in-sample avg dev_std = 0.324)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.98
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6403356
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.938
SUFF_SIMPLE for r=0.1 class 0.0 = 0.924 +- 0.296 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.918 +- 0.296 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.1 all KL = 0.888 +- 0.296 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.1 all L1 = 0.921 +- 0.222 (in-sample avg dev_std = 0.260)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.98
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.670858
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.939
SUFF_SIMPLE for r=0.2 class 0.0 = 0.926 +- 0.281 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.93 +- 0.281 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 all KL = 0.906 +- 0.281 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 all L1 = 0.928 +- 0.224 (in-sample avg dev_std = 0.198)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.98
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6837898
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.95
SUFF_SIMPLE for r=0.4 class 0.0 = 0.958 +- 0.253 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.925 +- 0.253 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.4 all KL = 0.927 +- 0.253 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.4 all L1 = 0.942 +- 0.208 (in-sample avg dev_std = 0.146)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.98
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.681668
len(reference) = 4936
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.967
SUFF_SIMPLE for r=0.8 class 0.0 = 0.992 +- 0.181 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.946 +- 0.181 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.965 +- 0.181 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.97 +- 0.157 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6056379999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.545
NEC for r=0.05 class 0.0 = 0.002 +- 0.495 (in-sample avg dev_std = 0.175)
NEC for r=0.05 class 1.0 = 0.721 +- 0.495 (in-sample avg dev_std = 0.175)
NEC for r=0.05 all KL = 0.47 +- 0.495 (in-sample avg dev_std = 0.175)
NEC for r=0.05 all L1 = 0.4 +- 0.424 (in-sample avg dev_std = 0.175)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.696192
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.667
NEC for r=0.1 class 0.0 = 0.007 +- 0.466 (in-sample avg dev_std = 0.429)
NEC for r=0.1 class 1.0 = 0.578 +- 0.466 (in-sample avg dev_std = 0.429)
NEC for r=0.1 all KL = 0.427 +- 0.466 (in-sample avg dev_std = 0.429)
NEC for r=0.1 all L1 = 0.324 +- 0.378 (in-sample avg dev_std = 0.429)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.729034
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.794
NEC for r=0.2 class 0.0 = 0.019 +- 0.425 (in-sample avg dev_std = 0.450)
NEC for r=0.2 class 1.0 = 0.38 +- 0.425 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all KL = 0.319 +- 0.425 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all L1 = 0.219 +- 0.320 (in-sample avg dev_std = 0.450)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7247560000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.886
NEC for r=0.4 class 0.0 = 0.01 +- 0.369 (in-sample avg dev_std = 0.436)
NEC for r=0.4 class 1.0 = 0.24 +- 0.369 (in-sample avg dev_std = 0.436)
NEC for r=0.4 all KL = 0.227 +- 0.369 (in-sample avg dev_std = 0.436)
NEC for r=0.4 all L1 = 0.138 +- 0.248 (in-sample avg dev_std = 0.436)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.715498
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.929
NEC for r=0.8 class 0.0 = 0.005 +- 0.324 (in-sample avg dev_std = 0.401)
NEC for r=0.8 class 1.0 = 0.164 +- 0.324 (in-sample avg dev_std = 0.401)
NEC for r=0.8 all KL = 0.159 +- 0.324 (in-sample avg dev_std = 0.401)
NEC for r=0.8 all L1 = 0.093 +- 0.205 (in-sample avg dev_std = 0.401)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7063147999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.849 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.481 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.428 +- 0.425 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6954691999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.587
NEC for r=0.1 class 0.0 = 0.02 +- 0.462 (in-sample avg dev_std = 0.449)
NEC for r=0.1 class 1.0 = 0.751 +- 0.462 (in-sample avg dev_std = 0.449)
NEC for r=0.1 all KL = 0.477 +- 0.462 (in-sample avg dev_std = 0.449)
NEC for r=0.1 all L1 = 0.389 +- 0.387 (in-sample avg dev_std = 0.449)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6913632
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.851
NEC for r=0.2 class 0.0 = 0.07 +- 0.373 (in-sample avg dev_std = 0.610)
NEC for r=0.2 class 1.0 = 0.334 +- 0.373 (in-sample avg dev_std = 0.610)
NEC for r=0.2 all KL = 0.346 +- 0.373 (in-sample avg dev_std = 0.610)
NEC for r=0.2 all L1 = 0.203 +- 0.232 (in-sample avg dev_std = 0.610)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6907478
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.922
NEC for r=0.4 class 0.0 = 0.065 +- 0.317 (in-sample avg dev_std = 0.482)
NEC for r=0.4 class 1.0 = 0.167 +- 0.317 (in-sample avg dev_std = 0.482)
NEC for r=0.4 all KL = 0.223 +- 0.317 (in-sample avg dev_std = 0.482)
NEC for r=0.4 all L1 = 0.116 +- 0.172 (in-sample avg dev_std = 0.482)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.690738
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.95
NEC for r=0.8 class 0.0 = 0.031 +- 0.276 (in-sample avg dev_std = 0.389)
NEC for r=0.8 class 1.0 = 0.12 +- 0.276 (in-sample avg dev_std = 0.389)
NEC for r=0.8 all KL = 0.148 +- 0.276 (in-sample avg dev_std = 0.389)
NEC for r=0.8 all L1 = 0.076 +- 0.148 (in-sample avg dev_std = 0.389)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.98
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5945608
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.603
NEC for r=0.05 class 0.0 = 0.005 +- 0.482 (in-sample avg dev_std = 0.236)
NEC for r=0.05 class 1.0 = 0.683 +- 0.482 (in-sample avg dev_std = 0.236)
NEC for r=0.05 all KL = 0.406 +- 0.482 (in-sample avg dev_std = 0.236)
NEC for r=0.05 all L1 = 0.339 +- 0.410 (in-sample avg dev_std = 0.236)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.98
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6403356
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.705
NEC for r=0.1 class 0.0 = 0.005 +- 0.448 (in-sample avg dev_std = 0.301)
NEC for r=0.1 class 1.0 = 0.52 +- 0.448 (in-sample avg dev_std = 0.301)
NEC for r=0.1 all KL = 0.332 +- 0.448 (in-sample avg dev_std = 0.301)
NEC for r=0.1 all L1 = 0.26 +- 0.371 (in-sample avg dev_std = 0.301)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.98
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.670858
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.792
NEC for r=0.2 class 0.0 = 0.008 +- 0.403 (in-sample avg dev_std = 0.281)
NEC for r=0.2 class 1.0 = 0.363 +- 0.403 (in-sample avg dev_std = 0.281)
NEC for r=0.2 all KL = 0.241 +- 0.403 (in-sample avg dev_std = 0.281)
NEC for r=0.2 all L1 = 0.183 +- 0.328 (in-sample avg dev_std = 0.281)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.98
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6837898
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.847
NEC for r=0.4 class 0.0 = 0.019 +- 0.363 (in-sample avg dev_std = 0.274)
NEC for r=0.4 class 1.0 = 0.257 +- 0.363 (in-sample avg dev_std = 0.274)
NEC for r=0.4 all KL = 0.185 +- 0.363 (in-sample avg dev_std = 0.274)
NEC for r=0.4 all L1 = 0.137 +- 0.288 (in-sample avg dev_std = 0.274)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.98
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.681668
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.903
NEC for r=0.8 class 0.0 = 0.038 +- 0.337 (in-sample avg dev_std = 0.343)
NEC for r=0.8 class 1.0 = 0.178 +- 0.337 (in-sample avg dev_std = 0.343)
NEC for r=0.8 all KL = 0.16 +- 0.337 (in-sample avg dev_std = 0.343)
NEC for r=0.8 all L1 = 0.107 +- 0.243 (in-sample avg dev_std = 0.343)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 13:00:59 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 01:00:59 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 01:00:59 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:00:59 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 01:00:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:00:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:00:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:00:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:00:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:00:59 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:00:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.573
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.624
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.609
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.566
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.540
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.492
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.417
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.376
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.362
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.361
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.581
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.626
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.650
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.655
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.648


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5729839999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.937
SUFF_SIMPLE for r=0.05 class 0.0 = 0.926 +- 0.287 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.902 +- 0.287 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.05 all KL = 0.853 +- 0.287 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.05 all L1 = 0.913 +- 0.186 (in-sample avg dev_std = 0.390)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6235920000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.938
SUFF_SIMPLE for r=0.1 class 0.0 = 0.923 +- 0.284 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.907 +- 0.284 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.1 all KL = 0.857 +- 0.284 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.184 (in-sample avg dev_std = 0.387)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6085740000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.933
SUFF_SIMPLE for r=0.2 class 0.0 = 0.915 +- 0.290 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.915 +- 0.290 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.2 all KL = 0.867 +- 0.290 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.2 all L1 = 0.915 +- 0.199 (in-sample avg dev_std = 0.365)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.56628
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.905
SUFF_SIMPLE for r=0.4 class 0.0 = 0.908 +- 0.322 (in-sample avg dev_std = 0.378)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.874 +- 0.322 (in-sample avg dev_std = 0.378)
SUFF_SIMPLE for r=0.4 all KL = 0.832 +- 0.322 (in-sample avg dev_std = 0.378)
SUFF_SIMPLE for r=0.4 all L1 = 0.889 +- 0.233 (in-sample avg dev_std = 0.378)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5399259999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.905
SUFF_SIMPLE for r=0.8 class 0.0 = 0.978 +- 0.315 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.84 +- 0.315 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.8 all KL = 0.87 +- 0.315 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.8 all L1 = 0.902 +- 0.248 (in-sample avg dev_std = 0.267)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.818
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4918258
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.634
SUFF_SIMPLE for r=0.05 class 0.0 = 0.976 +- 0.405 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.584 +- 0.405 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.05 all KL = 0.697 +- 0.405 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.05 all L1 = 0.778 +- 0.307 (in-sample avg dev_std = 0.526)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.818
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4167548
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.629
SUFF_SIMPLE for r=0.1 class 0.0 = 0.977 +- 0.408 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.576 +- 0.408 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.1 all KL = 0.695 +- 0.408 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.1 all L1 = 0.775 +- 0.312 (in-sample avg dev_std = 0.518)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.818
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3760186
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.615
SUFF_SIMPLE for r=0.2 class 0.0 = 0.974 +- 0.414 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.564 +- 0.414 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.2 all KL = 0.69 +- 0.414 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.2 all L1 = 0.767 +- 0.322 (in-sample avg dev_std = 0.504)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3623914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.598
SUFF_SIMPLE for r=0.4 class 0.0 = 0.971 +- 0.421 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.552 +- 0.421 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.4 all KL = 0.689 +- 0.421 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.4 all L1 = 0.76 +- 0.335 (in-sample avg dev_std = 0.467)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.818
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.3613786
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.526
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.442 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.48 +- 0.442 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.8 all KL = 0.705 +- 0.442 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.8 all L1 = 0.737 +- 0.385 (in-sample avg dev_std = 0.085)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5808394
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.93
SUFF_SIMPLE for r=0.05 class 0.0 = 0.891 +- 0.259 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.982 +- 0.259 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 all KL = 0.919 +- 0.259 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 all L1 = 0.936 +- 0.213 (in-sample avg dev_std = 0.178)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6264194
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.933
SUFF_SIMPLE for r=0.1 class 0.0 = 0.898 +- 0.252 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.983 +- 0.252 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.1 all KL = 0.926 +- 0.252 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.1 all L1 = 0.94 +- 0.209 (in-sample avg dev_std = 0.154)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.64957
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.935
SUFF_SIMPLE for r=0.2 class 0.0 = 0.903 +- 0.248 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.982 +- 0.248 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.2 all KL = 0.929 +- 0.248 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.2 all L1 = 0.942 +- 0.207 (in-sample avg dev_std = 0.139)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6553962
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.947
SUFF_SIMPLE for r=0.4 class 0.0 = 0.928 +- 0.224 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.978 +- 0.224 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.4 all KL = 0.943 +- 0.224 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.4 all L1 = 0.953 +- 0.189 (in-sample avg dev_std = 0.104)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6484614
len(reference) = 4957
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.972
SUFF_SIMPLE for r=0.8 class 0.0 = 0.985 +- 0.154 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.971 +- 0.154 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.975 +- 0.154 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.978 +- 0.133 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5729839999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.604
NEC for r=0.05 class 0.0 = 0.01 +- 0.483 (in-sample avg dev_std = 0.144)
NEC for r=0.05 class 1.0 = 0.622 +- 0.483 (in-sample avg dev_std = 0.144)
NEC for r=0.05 all KL = 0.403 +- 0.483 (in-sample avg dev_std = 0.144)
NEC for r=0.05 all L1 = 0.349 +- 0.415 (in-sample avg dev_std = 0.144)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6235920000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.701
NEC for r=0.1 class 0.0 = 0.023 +- 0.443 (in-sample avg dev_std = 0.428)
NEC for r=0.1 class 1.0 = 0.526 +- 0.443 (in-sample avg dev_std = 0.428)
NEC for r=0.1 all KL = 0.389 +- 0.443 (in-sample avg dev_std = 0.428)
NEC for r=0.1 all L1 = 0.301 +- 0.360 (in-sample avg dev_std = 0.428)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6085740000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.831
NEC for r=0.2 class 0.0 = 0.032 +- 0.378 (in-sample avg dev_std = 0.415)
NEC for r=0.2 class 1.0 = 0.316 +- 0.378 (in-sample avg dev_std = 0.415)
NEC for r=0.2 all KL = 0.267 +- 0.378 (in-sample avg dev_std = 0.415)
NEC for r=0.2 all L1 = 0.19 +- 0.290 (in-sample avg dev_std = 0.415)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.56628
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.92
NEC for r=0.4 class 0.0 = 0.042 +- 0.307 (in-sample avg dev_std = 0.380)
NEC for r=0.4 class 1.0 = 0.154 +- 0.307 (in-sample avg dev_std = 0.380)
NEC for r=0.4 all KL = 0.159 +- 0.307 (in-sample avg dev_std = 0.380)
NEC for r=0.4 all L1 = 0.104 +- 0.213 (in-sample avg dev_std = 0.380)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5399259999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.965
NEC for r=0.8 class 0.0 = 0.024 +- 0.222 (in-sample avg dev_std = 0.311)
NEC for r=0.8 class 1.0 = 0.074 +- 0.222 (in-sample avg dev_std = 0.311)
NEC for r=0.8 all KL = 0.092 +- 0.222 (in-sample avg dev_std = 0.311)
NEC for r=0.8 all L1 = 0.052 +- 0.132 (in-sample avg dev_std = 0.311)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.818
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4918258
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.569 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.321 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.287 +- 0.394 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.818
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4167548
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.53
NEC for r=0.1 class 0.0 = 0.008 +- 0.443 (in-sample avg dev_std = 0.309)
NEC for r=0.1 class 1.0 = 0.541 +- 0.443 (in-sample avg dev_std = 0.309)
NEC for r=0.1 all KL = 0.321 +- 0.443 (in-sample avg dev_std = 0.309)
NEC for r=0.1 all L1 = 0.276 +- 0.375 (in-sample avg dev_std = 0.309)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.818
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3760186
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.683
NEC for r=0.2 class 0.0 = 0.019 +- 0.372 (in-sample avg dev_std = 0.526)
NEC for r=0.2 class 1.0 = 0.344 +- 0.372 (in-sample avg dev_std = 0.526)
NEC for r=0.2 all KL = 0.263 +- 0.372 (in-sample avg dev_std = 0.526)
NEC for r=0.2 all L1 = 0.182 +- 0.264 (in-sample avg dev_std = 0.526)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3623914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.709
NEC for r=0.4 class 0.0 = 0.01 +- 0.346 (in-sample avg dev_std = 0.486)
NEC for r=0.4 class 1.0 = 0.291 +- 0.346 (in-sample avg dev_std = 0.486)
NEC for r=0.4 all KL = 0.223 +- 0.346 (in-sample avg dev_std = 0.486)
NEC for r=0.4 all L1 = 0.152 +- 0.244 (in-sample avg dev_std = 0.486)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.818
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.3613786
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.662
NEC for r=0.8 class 0.0 = 0.003 +- 0.382 (in-sample avg dev_std = 0.468)
NEC for r=0.8 class 1.0 = 0.362 +- 0.382 (in-sample avg dev_std = 0.468)
NEC for r=0.8 all KL = 0.247 +- 0.382 (in-sample avg dev_std = 0.468)
NEC for r=0.8 all L1 = 0.184 +- 0.290 (in-sample avg dev_std = 0.468)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5808394
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.646
NEC for r=0.05 class 0.0 = 0.019 +- 0.467 (in-sample avg dev_std = 0.260)
NEC for r=0.05 class 1.0 = 0.622 +- 0.467 (in-sample avg dev_std = 0.260)
NEC for r=0.05 all KL = 0.375 +- 0.467 (in-sample avg dev_std = 0.260)
NEC for r=0.05 all L1 = 0.317 +- 0.396 (in-sample avg dev_std = 0.260)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6264194
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.741
NEC for r=0.1 class 0.0 = 0.022 +- 0.427 (in-sample avg dev_std = 0.291)
NEC for r=0.1 class 1.0 = 0.466 +- 0.427 (in-sample avg dev_std = 0.291)
NEC for r=0.1 all KL = 0.298 +- 0.427 (in-sample avg dev_std = 0.291)
NEC for r=0.1 all L1 = 0.241 +- 0.357 (in-sample avg dev_std = 0.291)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.64957
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.819
NEC for r=0.2 class 0.0 = 0.025 +- 0.381 (in-sample avg dev_std = 0.266)
NEC for r=0.2 class 1.0 = 0.324 +- 0.381 (in-sample avg dev_std = 0.266)
NEC for r=0.2 all KL = 0.217 +- 0.381 (in-sample avg dev_std = 0.266)
NEC for r=0.2 all L1 = 0.173 +- 0.314 (in-sample avg dev_std = 0.266)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6553962
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.857
NEC for r=0.4 class 0.0 = 0.035 +- 0.351 (in-sample avg dev_std = 0.243)
NEC for r=0.4 class 1.0 = 0.243 +- 0.351 (in-sample avg dev_std = 0.243)
NEC for r=0.4 all KL = 0.174 +- 0.351 (in-sample avg dev_std = 0.243)
NEC for r=0.4 all L1 = 0.138 +- 0.288 (in-sample avg dev_std = 0.243)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6484614
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.899
NEC for r=0.8 class 0.0 = 0.063 +- 0.320 (in-sample avg dev_std = 0.312)
NEC for r=0.8 class 1.0 = 0.15 +- 0.320 (in-sample avg dev_std = 0.312)
NEC for r=0.8 all KL = 0.146 +- 0.320 (in-sample avg dev_std = 0.312)
NEC for r=0.8 all L1 = 0.106 +- 0.243 (in-sample avg dev_std = 0.312)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 13:16:47 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 01:16:47 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 01:16:47 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:16:47 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 01:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:16:47 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:16:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.579
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.691
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.747
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.761
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.763
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.725
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.723
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.723
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.723
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.723
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.567
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.619
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.653
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.676
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.695


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5794159999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.935
SUFF_SIMPLE for r=0.05 class 0.0 = 0.865 +- 0.291 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.964 +- 0.291 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.05 all KL = 0.876 +- 0.291 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.05 all L1 = 0.92 +- 0.200 (in-sample avg dev_std = 0.334)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.691082
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.951
SUFF_SIMPLE for r=0.1 class 0.0 = 0.867 +- 0.261 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.995 +- 0.261 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.1 all KL = 0.899 +- 0.261 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.1 all L1 = 0.938 +- 0.175 (in-sample avg dev_std = 0.306)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.746906
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.945
SUFF_SIMPLE for r=0.2 class 0.0 = 0.854 +- 0.265 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.265 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.2 all KL = 0.897 +- 0.265 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.2 all L1 = 0.935 +- 0.184 (in-sample avg dev_std = 0.290)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7613
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.94
SUFF_SIMPLE for r=0.4 class 0.0 = 0.846 +- 0.273 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.273 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.4 all KL = 0.896 +- 0.273 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.4 all L1 = 0.932 +- 0.195 (in-sample avg dev_std = 0.291)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7630060000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.982
SUFF_SIMPLE for r=0.8 class 0.0 = 0.96 +- 0.143 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.143 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.8 all KL = 0.976 +- 0.143 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.8 all L1 = 0.982 +- 0.112 (in-sample avg dev_std = 0.103)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.864
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7245484000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.769
SUFF_SIMPLE for r=0.05 class 0.0 = 0.757 +- 0.356 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.356 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.05 all KL = 0.811 +- 0.356 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.05 all L1 = 0.88 +- 0.242 (in-sample avg dev_std = 0.387)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.864
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7230476
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.764
SUFF_SIMPLE for r=0.1 class 0.0 = 0.749 +- 0.361 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.361 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.1 all KL = 0.807 +- 0.361 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.1 all L1 = 0.876 +- 0.248 (in-sample avg dev_std = 0.386)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.864
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7227928
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.76
SUFF_SIMPLE for r=0.2 class 0.0 = 0.744 +- 0.363 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.363 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.2 all KL = 0.807 +- 0.363 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.2 all L1 = 0.873 +- 0.254 (in-sample avg dev_std = 0.379)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.864
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7227802
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.75
SUFF_SIMPLE for r=0.4 class 0.0 = 0.728 +- 0.372 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.372 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.4 all KL = 0.799 +- 0.372 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.4 all L1 = 0.865 +- 0.265 (in-sample avg dev_std = 0.369)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.864
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7227802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.783
SUFF_SIMPLE for r=0.8 class 0.0 = 0.825 +- 0.304 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.304 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.8 all KL = 0.881 +- 0.304 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.8 all L1 = 0.913 +- 0.235 (in-sample avg dev_std = 0.176)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5665304
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.917
SUFF_SIMPLE for r=0.05 class 0.0 = 0.904 +- 0.297 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.926 +- 0.297 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.05 all KL = 0.891 +- 0.297 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.05 all L1 = 0.915 +- 0.235 (in-sample avg dev_std = 0.252)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6188512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.926
SUFF_SIMPLE for r=0.1 class 0.0 = 0.899 +- 0.270 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.964 +- 0.270 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.1 all KL = 0.914 +- 0.270 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.1 all L1 = 0.931 +- 0.218 (in-sample avg dev_std = 0.198)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6533772
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.932
SUFF_SIMPLE for r=0.2 class 0.0 = 0.892 +- 0.242 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.242 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.2 all KL = 0.934 +- 0.242 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.2 all L1 = 0.945 +- 0.204 (in-sample avg dev_std = 0.107)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6760868
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.937
SUFF_SIMPLE for r=0.4 class 0.0 = 0.903 +- 0.229 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.229 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.4 all KL = 0.941 +- 0.229 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.4 all L1 = 0.951 +- 0.193 (in-sample avg dev_std = 0.092)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.991
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6949712
len(reference) = 4958
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.981
SUFF_SIMPLE for r=0.8 class 0.0 = 0.982 +- 0.096 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.096 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.99 +- 0.096 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.991 +- 0.083 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5794159999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.564
NEC for r=0.05 class 0.0 = 0.006 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.679 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.433 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.378 +- 0.425 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.691082
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.6
NEC for r=0.1 class 0.0 = 0.01 +- 0.468 (in-sample avg dev_std = 0.466)
NEC for r=0.1 class 1.0 = 0.695 +- 0.468 (in-sample avg dev_std = 0.466)
NEC for r=0.1 all KL = 0.487 +- 0.468 (in-sample avg dev_std = 0.466)
NEC for r=0.1 all L1 = 0.39 +- 0.385 (in-sample avg dev_std = 0.466)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.746906
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.755
NEC for r=0.2 class 0.0 = 0.015 +- 0.422 (in-sample avg dev_std = 0.508)
NEC for r=0.2 class 1.0 = 0.467 +- 0.422 (in-sample avg dev_std = 0.508)
NEC for r=0.2 all KL = 0.362 +- 0.422 (in-sample avg dev_std = 0.508)
NEC for r=0.2 all L1 = 0.265 +- 0.331 (in-sample avg dev_std = 0.508)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7613
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.87
NEC for r=0.4 class 0.0 = 0.019 +- 0.354 (in-sample avg dev_std = 0.447)
NEC for r=0.4 class 1.0 = 0.266 +- 0.354 (in-sample avg dev_std = 0.447)
NEC for r=0.4 all KL = 0.235 +- 0.354 (in-sample avg dev_std = 0.447)
NEC for r=0.4 all L1 = 0.156 +- 0.257 (in-sample avg dev_std = 0.447)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7630060000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.95
NEC for r=0.8 class 0.0 = 0.03 +- 0.257 (in-sample avg dev_std = 0.348)
NEC for r=0.8 class 1.0 = 0.102 +- 0.257 (in-sample avg dev_std = 0.348)
NEC for r=0.8 all KL = 0.117 +- 0.257 (in-sample avg dev_std = 0.348)
NEC for r=0.8 all L1 = 0.07 +- 0.165 (in-sample avg dev_std = 0.348)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.864
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7245484000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.456 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.704 +- 0.456 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.382 +- 0.456 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.355 +- 0.397 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.864
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7230476
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.508
NEC for r=0.1 class 0.0 = 0.001 +- 0.455 (in-sample avg dev_std = 0.206)
NEC for r=0.1 class 1.0 = 0.694 +- 0.455 (in-sample avg dev_std = 0.206)
NEC for r=0.1 all KL = 0.382 +- 0.455 (in-sample avg dev_std = 0.206)
NEC for r=0.1 all L1 = 0.35 +- 0.392 (in-sample avg dev_std = 0.206)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.864
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7227928
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.702
NEC for r=0.2 class 0.0 = 0.029 +- 0.384 (in-sample avg dev_std = 0.575)
NEC for r=0.2 class 1.0 = 0.411 +- 0.384 (in-sample avg dev_std = 0.575)
NEC for r=0.2 all KL = 0.316 +- 0.384 (in-sample avg dev_std = 0.575)
NEC for r=0.2 all L1 = 0.221 +- 0.265 (in-sample avg dev_std = 0.575)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.864
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7227802
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.802
NEC for r=0.4 class 0.0 = 0.064 +- 0.277 (in-sample avg dev_std = 0.428)
NEC for r=0.4 class 1.0 = 0.136 +- 0.277 (in-sample avg dev_std = 0.428)
NEC for r=0.4 all KL = 0.177 +- 0.277 (in-sample avg dev_std = 0.428)
NEC for r=0.4 all L1 = 0.1 +- 0.156 (in-sample avg dev_std = 0.428)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.864
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7227802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.831
NEC for r=0.8 class 0.0 = 0.068 +- 0.224 (in-sample avg dev_std = 0.321)
NEC for r=0.8 class 1.0 = 0.044 +- 0.224 (in-sample avg dev_std = 0.321)
NEC for r=0.8 all KL = 0.108 +- 0.224 (in-sample avg dev_std = 0.321)
NEC for r=0.8 all L1 = 0.056 +- 0.118 (in-sample avg dev_std = 0.321)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5665304
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.653
NEC for r=0.05 class 0.0 = 0.016 +- 0.470 (in-sample avg dev_std = 0.293)
NEC for r=0.05 class 1.0 = 0.626 +- 0.470 (in-sample avg dev_std = 0.293)
NEC for r=0.05 all KL = 0.375 +- 0.470 (in-sample avg dev_std = 0.293)
NEC for r=0.05 all L1 = 0.317 +- 0.398 (in-sample avg dev_std = 0.293)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6188512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.68
NEC for r=0.1 class 0.0 = 0.018 +- 0.456 (in-sample avg dev_std = 0.372)
NEC for r=0.1 class 1.0 = 0.603 +- 0.456 (in-sample avg dev_std = 0.372)
NEC for r=0.1 all KL = 0.378 +- 0.456 (in-sample avg dev_std = 0.372)
NEC for r=0.1 all L1 = 0.307 +- 0.380 (in-sample avg dev_std = 0.372)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6533772
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.737
NEC for r=0.2 class 0.0 = 0.022 +- 0.434 (in-sample avg dev_std = 0.436)
NEC for r=0.2 class 1.0 = 0.531 +- 0.434 (in-sample avg dev_std = 0.436)
NEC for r=0.2 all KL = 0.355 +- 0.434 (in-sample avg dev_std = 0.436)
NEC for r=0.2 all L1 = 0.273 +- 0.350 (in-sample avg dev_std = 0.436)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6760868
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.797
NEC for r=0.4 class 0.0 = 0.028 +- 0.404 (in-sample avg dev_std = 0.437)
NEC for r=0.4 class 1.0 = 0.429 +- 0.404 (in-sample avg dev_std = 0.437)
NEC for r=0.4 all KL = 0.308 +- 0.404 (in-sample avg dev_std = 0.437)
NEC for r=0.4 all L1 = 0.226 +- 0.319 (in-sample avg dev_std = 0.437)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6949712
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.852
NEC for r=0.8 class 0.0 = 0.06 +- 0.366 (in-sample avg dev_std = 0.436)
NEC for r=0.8 class 1.0 = 0.291 +- 0.366 (in-sample avg dev_std = 0.436)
NEC for r=0.8 all KL = 0.255 +- 0.366 (in-sample avg dev_std = 0.436)
NEC for r=0.8 all L1 = 0.174 +- 0.274 (in-sample avg dev_std = 0.436)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 13:32:26 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 01:32:26 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 01:32:26 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:32:26 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 01:32:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:32:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:32:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:32:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:32:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:32:26 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:32:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.588
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.658
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.672
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.658
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.641
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.531
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.453
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.404
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.386
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.384
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.588
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.633
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.660
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.672
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.673


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5881980000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.781
SUFF_SIMPLE for r=0.05 class 0.0 = 0.953 +- 0.435 (in-sample avg dev_std = 0.660)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.526 +- 0.435 (in-sample avg dev_std = 0.660)
SUFF_SIMPLE for r=0.05 all KL = 0.514 +- 0.435 (in-sample avg dev_std = 0.660)
SUFF_SIMPLE for r=0.05 all L1 = 0.716 +- 0.287 (in-sample avg dev_std = 0.660)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6579259999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.78
SUFF_SIMPLE for r=0.1 class 0.0 = 0.947 +- 0.433 (in-sample avg dev_std = 0.645)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.54 +- 0.433 (in-sample avg dev_std = 0.645)
SUFF_SIMPLE for r=0.1 all KL = 0.523 +- 0.433 (in-sample avg dev_std = 0.645)
SUFF_SIMPLE for r=0.1 all L1 = 0.721 +- 0.288 (in-sample avg dev_std = 0.645)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6717
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.771
SUFF_SIMPLE for r=0.2 class 0.0 = 0.937 +- 0.436 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.526 +- 0.436 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.2 all KL = 0.509 +- 0.436 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.2 all L1 = 0.709 +- 0.293 (in-sample avg dev_std = 0.649)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.657956
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.751
SUFF_SIMPLE for r=0.4 class 0.0 = 0.956 +- 0.450 (in-sample avg dev_std = 0.576)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.513 +- 0.450 (in-sample avg dev_std = 0.576)
SUFF_SIMPLE for r=0.4 all KL = 0.546 +- 0.450 (in-sample avg dev_std = 0.576)
SUFF_SIMPLE for r=0.4 all L1 = 0.711 +- 0.321 (in-sample avg dev_std = 0.576)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.641064
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.728
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.452 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.523 +- 0.452 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.8 all KL = 0.659 +- 0.452 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.8 all L1 = 0.735 +- 0.368 (in-sample avg dev_std = 0.231)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5309848
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.517
SUFF_SIMPLE for r=0.05 class 0.0 = 0.991 +- 0.448 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.314 +- 0.448 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.05 all KL = 0.609 +- 0.448 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.05 all L1 = 0.65 +- 0.391 (in-sample avg dev_std = 0.284)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4525552
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.516
SUFF_SIMPLE for r=0.1 class 0.0 = 0.994 +- 0.448 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.313 +- 0.448 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.1 all KL = 0.612 +- 0.448 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.1 all L1 = 0.651 +- 0.393 (in-sample avg dev_std = 0.267)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4042606
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.514
SUFF_SIMPLE for r=0.2 class 0.0 = 0.994 +- 0.449 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.313 +- 0.449 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.2 all KL = 0.613 +- 0.449 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.2 all L1 = 0.651 +- 0.394 (in-sample avg dev_std = 0.257)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3859232
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.506
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.450 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.309 +- 0.450 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.4 all KL = 0.616 +- 0.450 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.4 all L1 = 0.65 +- 0.397 (in-sample avg dev_std = 0.197)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.883
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.3839996
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.498
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.452 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.307 +- 0.452 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.8 all KL = 0.622 +- 0.452 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.8 all L1 = 0.65 +- 0.402 (in-sample avg dev_std = 0.041)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.969
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.587751
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.891
SUFF_SIMPLE for r=0.05 class 0.0 = 0.954 +- 0.355 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.809 +- 0.355 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.05 all KL = 0.826 +- 0.355 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.05 all L1 = 0.882 +- 0.254 (in-sample avg dev_std = 0.363)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.969
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6332434000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.911
SUFF_SIMPLE for r=0.1 class 0.0 = 0.945 +- 0.340 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.841 +- 0.340 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.1 all KL = 0.848 +- 0.340 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.1 all L1 = 0.894 +- 0.248 (in-sample avg dev_std = 0.325)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.969
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6602308
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.912
SUFF_SIMPLE for r=0.2 class 0.0 = 0.942 +- 0.333 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.847 +- 0.333 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.2 all KL = 0.858 +- 0.333 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.2 all L1 = 0.895 +- 0.256 (in-sample avg dev_std = 0.246)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.969
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6722484
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.909
SUFF_SIMPLE for r=0.4 class 0.0 = 0.953 +- 0.317 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.85 +- 0.317 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 all KL = 0.877 +- 0.317 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 all L1 = 0.902 +- 0.258 (in-sample avg dev_std = 0.174)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.969
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6725572
len(reference) = 4961
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.943
SUFF_SIMPLE for r=0.8 class 0.0 = 0.992 +- 0.222 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.222 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.944 +- 0.222 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.951 +- 0.191 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5881980000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.552
NEC for r=0.05 class 0.0 = 0.001 +- 0.497 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.701 +- 0.497 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.449 +- 0.497 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.389 +- 0.429 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6579259999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.576
NEC for r=0.1 class 0.0 = 0.001 +- 0.492 (in-sample avg dev_std = 0.462)
NEC for r=0.1 class 1.0 = 0.728 +- 0.492 (in-sample avg dev_std = 0.462)
NEC for r=0.1 all KL = 0.51 +- 0.492 (in-sample avg dev_std = 0.462)
NEC for r=0.1 all L1 = 0.404 +- 0.400 (in-sample avg dev_std = 0.462)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6717
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.709
NEC for r=0.2 class 0.0 = 0.005 +- 0.461 (in-sample avg dev_std = 0.562)
NEC for r=0.2 class 1.0 = 0.559 +- 0.461 (in-sample avg dev_std = 0.562)
NEC for r=0.2 all KL = 0.465 +- 0.461 (in-sample avg dev_std = 0.562)
NEC for r=0.2 all L1 = 0.312 +- 0.343 (in-sample avg dev_std = 0.562)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.657956
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.815
NEC for r=0.4 class 0.0 = 0.009 +- 0.427 (in-sample avg dev_std = 0.559)
NEC for r=0.4 class 1.0 = 0.395 +- 0.427 (in-sample avg dev_std = 0.559)
NEC for r=0.4 all KL = 0.381 +- 0.427 (in-sample avg dev_std = 0.559)
NEC for r=0.4 all L1 = 0.223 +- 0.284 (in-sample avg dev_std = 0.559)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.641064
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.905
NEC for r=0.8 class 0.0 = 0.012 +- 0.372 (in-sample avg dev_std = 0.498)
NEC for r=0.8 class 1.0 = 0.239 +- 0.372 (in-sample avg dev_std = 0.498)
NEC for r=0.8 all KL = 0.277 +- 0.372 (in-sample avg dev_std = 0.498)
NEC for r=0.8 all L1 = 0.137 +- 0.207 (in-sample avg dev_std = 0.498)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5309848
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.696 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.378 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.351 +- 0.403 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4525552
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.507
NEC for r=0.1 class 0.0 = 0.002 +- 0.449 (in-sample avg dev_std = 0.164)
NEC for r=0.1 class 1.0 = 0.7 +- 0.449 (in-sample avg dev_std = 0.164)
NEC for r=0.1 all KL = 0.388 +- 0.449 (in-sample avg dev_std = 0.164)
NEC for r=0.1 all L1 = 0.354 +- 0.398 (in-sample avg dev_std = 0.164)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4042606
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.59
NEC for r=0.2 class 0.0 = 0.015 +- 0.432 (in-sample avg dev_std = 0.490)
NEC for r=0.2 class 1.0 = 0.649 +- 0.432 (in-sample avg dev_std = 0.490)
NEC for r=0.2 all KL = 0.4 +- 0.432 (in-sample avg dev_std = 0.490)
NEC for r=0.2 all L1 = 0.334 +- 0.358 (in-sample avg dev_std = 0.490)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3859232
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.591
NEC for r=0.4 class 0.0 = 0.01 +- 0.433 (in-sample avg dev_std = 0.479)
NEC for r=0.4 class 1.0 = 0.638 +- 0.433 (in-sample avg dev_std = 0.479)
NEC for r=0.4 all KL = 0.39 +- 0.433 (in-sample avg dev_std = 0.479)
NEC for r=0.4 all L1 = 0.326 +- 0.358 (in-sample avg dev_std = 0.479)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.883
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.3839996
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.579
NEC for r=0.8 class 0.0 = 0.004 +- 0.438 (in-sample avg dev_std = 0.445)
NEC for r=0.8 class 1.0 = 0.64 +- 0.438 (in-sample avg dev_std = 0.445)
NEC for r=0.8 all KL = 0.379 +- 0.438 (in-sample avg dev_std = 0.445)
NEC for r=0.8 all L1 = 0.325 +- 0.364 (in-sample avg dev_std = 0.445)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.969
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.587751
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.592
NEC for r=0.05 class 0.0 = 0.006 +- 0.487 (in-sample avg dev_std = 0.205)
NEC for r=0.05 class 1.0 = 0.7 +- 0.487 (in-sample avg dev_std = 0.205)
NEC for r=0.05 all KL = 0.41 +- 0.487 (in-sample avg dev_std = 0.205)
NEC for r=0.05 all L1 = 0.349 +- 0.415 (in-sample avg dev_std = 0.205)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.969
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6332434000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.632
NEC for r=0.1 class 0.0 = 0.007 +- 0.480 (in-sample avg dev_std = 0.386)
NEC for r=0.1 class 1.0 = 0.657 +- 0.480 (in-sample avg dev_std = 0.386)
NEC for r=0.1 all KL = 0.415 +- 0.480 (in-sample avg dev_std = 0.386)
NEC for r=0.1 all L1 = 0.328 +- 0.390 (in-sample avg dev_std = 0.386)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.969
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6602308
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.7
NEC for r=0.2 class 0.0 = 0.009 +- 0.460 (in-sample avg dev_std = 0.454)
NEC for r=0.2 class 1.0 = 0.558 +- 0.460 (in-sample avg dev_std = 0.454)
NEC for r=0.2 all KL = 0.389 +- 0.460 (in-sample avg dev_std = 0.454)
NEC for r=0.2 all L1 = 0.28 +- 0.355 (in-sample avg dev_std = 0.454)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.969
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6722484
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.768
NEC for r=0.4 class 0.0 = 0.011 +- 0.432 (in-sample avg dev_std = 0.455)
NEC for r=0.4 class 1.0 = 0.439 +- 0.432 (in-sample avg dev_std = 0.455)
NEC for r=0.4 all KL = 0.335 +- 0.432 (in-sample avg dev_std = 0.455)
NEC for r=0.4 all L1 = 0.222 +- 0.318 (in-sample avg dev_std = 0.455)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.969
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6725572
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.828
NEC for r=0.8 class 0.0 = 0.034 +- 0.402 (in-sample avg dev_std = 0.449)
NEC for r=0.8 class 1.0 = 0.325 +- 0.402 (in-sample avg dev_std = 0.449)
NEC for r=0.8 all KL = 0.29 +- 0.402 (in-sample avg dev_std = 0.449)
NEC for r=0.8 all L1 = 0.178 +- 0.281 (in-sample avg dev_std = 0.449)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.846, 0.854, 0.853, 0.861, 0.971], 'all_L1': [0.904, 0.905, 0.902, 0.903, 0.98]}), defaultdict(<class 'list'>, {'all_KL': [0.882, 0.904, 0.893, 0.89, 0.977], 'all_L1': [0.937, 0.951, 0.941, 0.939, 0.983]}), defaultdict(<class 'list'>, {'all_KL': [0.874, 0.884, 0.867, 0.882, 0.956], 'all_L1': [0.925, 0.934, 0.922, 0.928, 0.969]}), defaultdict(<class 'list'>, {'all_KL': [0.793, 0.802, 0.793, 0.771, 0.794], 'all_L1': [0.875, 0.879, 0.87, 0.848, 0.838]}), defaultdict(<class 'list'>, {'all_KL': [0.868, 0.884, 0.865, 0.878, 0.975], 'all_L1': [0.92, 0.928, 0.916, 0.923, 0.984]}), defaultdict(<class 'list'>, {'all_KL': [0.884, 0.884, 0.89, 0.88, 0.938], 'all_L1': [0.935, 0.936, 0.939, 0.927, 0.949]}), defaultdict(<class 'list'>, {'all_KL': [0.754, 0.83, 0.809, 0.784, 0.804], 'all_L1': [0.865, 0.906, 0.887, 0.859, 0.843]}), defaultdict(<class 'list'>, {'all_KL': [0.853, 0.857, 0.867, 0.832, 0.87], 'all_L1': [0.913, 0.914, 0.915, 0.889, 0.902]}), defaultdict(<class 'list'>, {'all_KL': [0.876, 0.899, 0.897, 0.896, 0.976], 'all_L1': [0.92, 0.938, 0.935, 0.932, 0.982]}), defaultdict(<class 'list'>, {'all_KL': [0.514, 0.523, 0.509, 0.546, 0.659], 'all_L1': [0.716, 0.721, 0.709, 0.711, 0.735]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.387, 0.36, 0.205, 0.108, 0.048], 'all_L1': [0.324, 0.252, 0.137, 0.064, 0.023]}), defaultdict(<class 'list'>, {'all_KL': [0.409, 0.359, 0.242, 0.148, 0.106], 'all_L1': [0.345, 0.257, 0.157, 0.076, 0.05]}), defaultdict(<class 'list'>, {'all_KL': [0.406, 0.337, 0.213, 0.139, 0.096], 'all_L1': [0.342, 0.252, 0.152, 0.083, 0.049]}), defaultdict(<class 'list'>, {'all_KL': [0.363, 0.32, 0.202, 0.104, 0.072], 'all_L1': [0.313, 0.245, 0.148, 0.07, 0.043]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.37, 0.211, 0.133, 0.052], 'all_L1': [0.342, 0.263, 0.143, 0.074, 0.024]}), defaultdict(<class 'list'>, {'all_KL': [0.387, 0.346, 0.202, 0.108, 0.066], 'all_L1': [0.327, 0.249, 0.141, 0.067, 0.032]}), defaultdict(<class 'list'>, {'all_KL': [0.47, 0.427, 0.319, 0.227, 0.159], 'all_L1': [0.4, 0.324, 0.219, 0.138, 0.093]}), defaultdict(<class 'list'>, {'all_KL': [0.403, 0.389, 0.267, 0.159, 0.092], 'all_L1': [0.349, 0.301, 0.19, 0.104, 0.052]}), defaultdict(<class 'list'>, {'all_KL': [0.433, 0.487, 0.362, 0.235, 0.117], 'all_L1': [0.378, 0.39, 0.265, 0.156, 0.07]}), defaultdict(<class 'list'>, {'all_KL': [0.449, 0.51, 0.465, 0.381, 0.277], 'all_L1': [0.389, 0.404, 0.312, 0.223, 0.137]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.747, 0.747, 0.747, 0.746, 0.75], 'all_L1': [0.787, 0.787, 0.786, 0.785, 0.788]}), defaultdict(<class 'list'>, {'all_KL': [0.733, 0.733, 0.732, 0.737, 0.882], 'all_L1': [0.85, 0.849, 0.849, 0.852, 0.914]}), defaultdict(<class 'list'>, {'all_KL': [0.769, 0.769, 0.769, 0.77, 0.854], 'all_L1': [0.82, 0.82, 0.82, 0.823, 0.887]}), defaultdict(<class 'list'>, {'all_KL': [0.61, 0.607, 0.603, 0.603, 0.637], 'all_L1': [0.709, 0.703, 0.696, 0.684, 0.663]}), defaultdict(<class 'list'>, {'all_KL': [0.768, 0.767, 0.767, 0.766, 0.843], 'all_L1': [0.848, 0.846, 0.845, 0.842, 0.884]}), defaultdict(<class 'list'>, {'all_KL': [0.639, 0.627, 0.609, 0.578, 0.627], 'all_L1': [0.794, 0.78, 0.759, 0.715, 0.668]}), defaultdict(<class 'list'>, {'all_KL': [0.687, 0.675, 0.64, 0.584, 0.644], 'all_L1': [0.818, 0.806, 0.774, 0.702, 0.693]}), defaultdict(<class 'list'>, {'all_KL': [0.697, 0.695, 0.69, 0.689, 0.705], 'all_L1': [0.778, 0.775, 0.767, 0.76, 0.737]}), defaultdict(<class 'list'>, {'all_KL': [0.811, 0.807, 0.807, 0.799, 0.881], 'all_L1': [0.88, 0.876, 0.873, 0.865, 0.913]}), defaultdict(<class 'list'>, {'all_KL': [0.609, 0.612, 0.613, 0.616, 0.622], 'all_L1': [0.65, 0.651, 0.651, 0.65, 0.65]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.485, 0.476, 0.25, 0.198, 0.187], 'all_L1': [0.43, 0.383, 0.13, 0.109, 0.102]}), defaultdict(<class 'list'>, {'all_KL': [0.496, 0.512, 0.332, 0.221, 0.132], 'all_L1': [0.43, 0.385, 0.168, 0.105, 0.055]}), defaultdict(<class 'list'>, {'all_KL': [0.432, 0.44, 0.234, 0.203, 0.181], 'all_L1': [0.392, 0.353, 0.142, 0.129, 0.107]}), defaultdict(<class 'list'>, {'all_KL': [0.393, 0.391, 0.271, 0.239, 0.271], 'all_L1': [0.368, 0.337, 0.179, 0.162, 0.205]}), defaultdict(<class 'list'>, {'all_KL': [0.44, 0.44, 0.234, 0.16, 0.131], 'all_L1': [0.405, 0.361, 0.122, 0.078, 0.06]}), defaultdict(<class 'list'>, {'all_KL': [0.457, 0.456, 0.27, 0.168, 0.092], 'all_L1': [0.415, 0.369, 0.143, 0.083, 0.044]}), defaultdict(<class 'list'>, {'all_KL': [0.481, 0.477, 0.346, 0.223, 0.148], 'all_L1': [0.428, 0.389, 0.203, 0.116, 0.076]}), defaultdict(<class 'list'>, {'all_KL': [0.321, 0.321, 0.263, 0.223, 0.247], 'all_L1': [0.287, 0.276, 0.182, 0.152, 0.184]}), defaultdict(<class 'list'>, {'all_KL': [0.382, 0.382, 0.316, 0.177, 0.108], 'all_L1': [0.355, 0.35, 0.221, 0.1, 0.056]}), defaultdict(<class 'list'>, {'all_KL': [0.378, 0.388, 0.4, 0.39, 0.379], 'all_L1': [0.351, 0.354, 0.334, 0.326, 0.325]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.922, 0.924, 0.928, 0.93, 0.987], 'all_L1': [0.937, 0.938, 0.939, 0.941, 0.989]}), defaultdict(<class 'list'>, {'all_KL': [0.927, 0.929, 0.932, 0.944, 0.992], 'all_L1': [0.944, 0.944, 0.946, 0.954, 0.993]}), defaultdict(<class 'list'>, {'all_KL': [0.921, 0.924, 0.928, 0.941, 0.986], 'all_L1': [0.937, 0.938, 0.941, 0.952, 0.987]}), defaultdict(<class 'list'>, {'all_KL': [0.907, 0.911, 0.914, 0.923, 0.963], 'all_L1': [0.925, 0.929, 0.93, 0.936, 0.967]}), defaultdict(<class 'list'>, {'all_KL': [0.927, 0.929, 0.928, 0.931, 0.989], 'all_L1': [0.941, 0.941, 0.941, 0.943, 0.991]}), defaultdict(<class 'list'>, {'all_KL': [0.914, 0.919, 0.922, 0.935, 0.973], 'all_L1': [0.933, 0.937, 0.938, 0.947, 0.977]}), defaultdict(<class 'list'>, {'all_KL': [0.871, 0.888, 0.906, 0.927, 0.965], 'all_L1': [0.915, 0.921, 0.928, 0.942, 0.97]}), defaultdict(<class 'list'>, {'all_KL': [0.919, 0.926, 0.929, 0.943, 0.975], 'all_L1': [0.936, 0.94, 0.942, 0.953, 0.978]}), defaultdict(<class 'list'>, {'all_KL': [0.891, 0.914, 0.934, 0.941, 0.99], 'all_L1': [0.915, 0.931, 0.945, 0.951, 0.991]}), defaultdict(<class 'list'>, {'all_KL': [0.826, 0.848, 0.858, 0.877, 0.944], 'all_L1': [0.882, 0.894, 0.895, 0.902, 0.951]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.327, 0.288, 0.22, 0.175, 0.116], 'all_L1': [0.258, 0.221, 0.159, 0.127, 0.083]}), defaultdict(<class 'list'>, {'all_KL': [0.4, 0.335, 0.255, 0.191, 0.136], 'all_L1': [0.329, 0.26, 0.191, 0.138, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.383, 0.321, 0.236, 0.177, 0.148], 'all_L1': [0.318, 0.253, 0.183, 0.136, 0.102]}), defaultdict(<class 'list'>, {'all_KL': [0.338, 0.292, 0.231, 0.174, 0.139], 'all_L1': [0.289, 0.238, 0.184, 0.136, 0.101]}), defaultdict(<class 'list'>, {'all_KL': [0.331, 0.306, 0.243, 0.206, 0.155], 'all_L1': [0.271, 0.235, 0.177, 0.147, 0.105]}), defaultdict(<class 'list'>, {'all_KL': [0.353, 0.295, 0.225, 0.17, 0.136], 'all_L1': [0.294, 0.232, 0.173, 0.128, 0.093]}), defaultdict(<class 'list'>, {'all_KL': [0.406, 0.332, 0.241, 0.185, 0.16], 'all_L1': [0.339, 0.26, 0.183, 0.137, 0.107]}), defaultdict(<class 'list'>, {'all_KL': [0.375, 0.298, 0.217, 0.174, 0.146], 'all_L1': [0.317, 0.241, 0.173, 0.138, 0.106]}), defaultdict(<class 'list'>, {'all_KL': [0.375, 0.378, 0.355, 0.308, 0.255], 'all_L1': [0.317, 0.307, 0.273, 0.226, 0.174]}), defaultdict(<class 'list'>, {'all_KL': [0.41, 0.415, 0.389, 0.335, 0.29], 'all_L1': [0.349, 0.328, 0.28, 0.222, 0.178]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.891 +- 0.063, 0.901 +- 0.063, 0.894 +- 0.065, 0.886 +- 0.065, 0.916 +- 0.081
suff_simple class all_KL  =  0.814 +- 0.108, 0.832 +- 0.107, 0.824 +- 0.110, 0.822 +- 0.101, 0.892 +- 0.103
[[0.9164999723434448, 0.9135000109672546, 0.9100000262260437, 0.9082499742507935, 0.984000027179718], [0.9517499804496765, 0.9624999761581421, 0.9524999856948853, 0.9492499828338623, 0.9807500243186951], [0.9402499794960022, 0.949999988079071, 0.9384999871253967, 0.9390000104904175, 0.9702500104904175], [0.9147499799728394, 0.9154999852180481, 0.9037500023841858, 0.8794999718666077, 0.8450000286102295], [0.9330000281333923, 0.9375, 0.9279999732971191, 0.9340000152587891, 0.9850000143051147], [0.9505000114440918, 0.952750027179718, 0.9537500143051147, 0.9387500286102295, 0.9437500238418579], [0.9024999737739563, 0.9315000176429749, 0.9112499952316284, 0.8772500157356262, 0.827750027179718], [0.9365000128746033, 0.9380000233650208, 0.9330000281333923, 0.9052500128746033, 0.9047499895095825], [0.9350000023841858, 0.9505000114440918, 0.9452499747276306, 0.9402499794960022, 0.9819999933242798], [0.7807499766349792, 0.7802500128746033, 0.7705000042915344, 0.7505000233650208, 0.7275000214576721]]
[[0.846, 0.854, 0.853, 0.861, 0.971], [0.882, 0.904, 0.893, 0.89, 0.977], [0.874, 0.884, 0.867, 0.882, 0.956], [0.793, 0.802, 0.793, 0.771, 0.794], [0.868, 0.884, 0.865, 0.878, 0.975], [0.884, 0.884, 0.89, 0.88, 0.938], [0.754, 0.83, 0.809, 0.784, 0.804], [0.853, 0.857, 0.867, 0.832, 0.87], [0.876, 0.899, 0.897, 0.896, 0.976], [0.514, 0.523, 0.509, 0.546, 0.659]]
suff_simple_acc_int  =  0.916 +- 0.048, 0.923 +- 0.050, 0.915 +- 0.051, 0.902 +- 0.056, 0.915 +- 0.084
nec class all_L1  =  0.351 +- 0.027, 0.294 +- 0.057, 0.186 +- 0.057, 0.106 +- 0.049, 0.057 +- 0.033
nec class all_KL  =  0.411 +- 0.030, 0.391 +- 0.061, 0.269 +- 0.084, 0.174 +- 0.082, 0.108 +- 0.064
[[0.6384999752044678, 0.7482500076293945, 0.8669999837875366, 0.9472500085830688, 0.9854999780654907], [0.609499990940094, 0.7379999756813049, 0.8502500057220459, 0.9415000081062317, 0.9670000076293945], [0.6137499809265137, 0.7419999837875366, 0.8512499928474426, 0.9332500100135803, 0.9695000052452087], [0.6504999995231628, 0.7597500085830688, 0.8622499704360962, 0.9442499876022339, 0.972000002861023], [0.6154999732971191, 0.7354999780654907, 0.8615000247955322, 0.940500020980835, 0.984749972820282], [0.6312500238418579, 0.7507500052452087, 0.8629999756813049, 0.9415000081062317, 0.9789999723434448], [0.5450000166893005, 0.6672499775886536, 0.7940000295639038, 0.8857499957084656, 0.9287499785423279], [0.6042500138282776, 0.7012500166893005, 0.8314999938011169, 0.9197499752044678, 0.9652500152587891], [0.5640000104904175, 0.6004999876022339, 0.7549999952316284, 0.8700000047683716, 0.949999988079071], [0.5519999861717224, 0.5759999752044678, 0.7092499732971191, 0.8152499794960022, 0.9047499895095825]]
[[0.387, 0.36, 0.205, 0.108, 0.048], [0.409, 0.359, 0.242, 0.148, 0.106], [0.406, 0.337, 0.213, 0.139, 0.096], [0.363, 0.32, 0.202, 0.104, 0.072], [0.405, 0.37, 0.211, 0.133, 0.052], [0.387, 0.346, 0.202, 0.108, 0.066], [0.47, 0.427, 0.319, 0.227, 0.159], [0.403, 0.389, 0.267, 0.159, 0.092], [0.433, 0.487, 0.362, 0.235, 0.117], [0.449, 0.51, 0.465, 0.381, 0.277]]
nec_acc_int  =  0.602 +- 0.035, 0.702 +- 0.063, 0.824 +- 0.052, 0.914 +- 0.041, 0.961 +- 0.025

Eval split val
suff_simple class all_L1  =  0.793 +- 0.066, 0.789 +- 0.065, 0.782 +- 0.066, 0.768 +- 0.073, 0.780 +- 0.105
suff_simple class all_KL  =  0.707 +- 0.067, 0.704 +- 0.068, 0.698 +- 0.073, 0.689 +- 0.081, 0.745 +- 0.105
[[0.7554500102996826, 0.7535499930381775, 0.7516000270843506, 0.7493000030517578, 0.7512750029563904], [0.8843749761581421, 0.8833249807357788, 0.8832749724388123, 0.8850749731063843, 0.9128249883651733], [0.748924970626831, 0.7496500015258789, 0.7490749955177307, 0.7540000081062317, 0.8126000165939331], [0.6529499888420105, 0.645675003528595, 0.6342999935150146, 0.6139500141143799, 0.5327500104904175], [0.8115249872207642, 0.8084750175476074, 0.8069750070571899, 0.8011249899864197, 0.8264750242233276], [0.82464998960495, 0.8118500113487244, 0.7899500131607056, 0.7402250170707703, 0.6007500290870667], [0.8651999831199646, 0.8538249731063843, 0.8206499814987183, 0.7336750030517578, 0.6520249843597412], [0.6339250206947327, 0.6287000179290771, 0.6148750185966492, 0.5976750254631042, 0.5263500213623047], [0.7688999772071838, 0.7643749713897705, 0.7598249912261963, 0.7504000067710876, 0.7825000286102295], [0.5172250270843506, 0.5155500173568726, 0.51357501745224, 0.5059249997138977, 0.49802500009536743]]
[[0.747, 0.747, 0.747, 0.746, 0.75], [0.733, 0.733, 0.732, 0.737, 0.882], [0.769, 0.769, 0.769, 0.77, 0.854], [0.61, 0.607, 0.603, 0.603, 0.637], [0.768, 0.767, 0.767, 0.766, 0.843], [0.639, 0.627, 0.609, 0.578, 0.627], [0.687, 0.675, 0.64, 0.584, 0.644], [0.697, 0.695, 0.69, 0.689, 0.705], [0.811, 0.807, 0.807, 0.799, 0.881], [0.609, 0.612, 0.613, 0.616, 0.622]]
suff_simple_acc_int  =  0.746 +- 0.109, 0.741 +- 0.108, 0.732 +- 0.106, 0.713 +- 0.104, 0.690 +- 0.139
nec class all_L1  =  0.386 +- 0.044, 0.356 +- 0.031, 0.182 +- 0.059, 0.136 +- 0.068, 0.121 +- 0.086
nec class all_KL  =  0.426 +- 0.054, 0.428 +- 0.054, 0.292 +- 0.052, 0.220 +- 0.062, 0.188 +- 0.084
[[0.4959999918937683, 0.5958750247955322, 0.9099500179290771, 0.9184250235557556, 0.9259999990463257], [0.5013999938964844, 0.6090999841690063, 0.8846250176429749, 0.9296000003814697, 0.9659500122070312], [0.4959999918937683, 0.5710750222206116, 0.820900022983551, 0.8253250122070312, 0.850974977016449], [0.4959999918937683, 0.5587249994277954, 0.7595250010490417, 0.7715499997138977, 0.7267000079154968], [0.4959999918937683, 0.5701000094413757, 0.8634750247001648, 0.8933500051498413, 0.9061750173568726], [0.4959999918937683, 0.5826749801635742, 0.8718000054359436, 0.9165999889373779, 0.9415500164031982], [0.4959999918937683, 0.5874000191688538, 0.8514999747276306, 0.9223999977111816, 0.9495000243186951], [0.4959999918937683, 0.52982497215271, 0.6834250092506409, 0.7088249921798706, 0.6617500185966492], [0.4959999918937683, 0.5079500079154968, 0.7017750144004822, 0.8023250102996826, 0.8308749794960022], [0.4959999918937683, 0.5067750215530396, 0.589775025844574, 0.5910750031471252, 0.5790749788284302]]
[[0.485, 0.476, 0.25, 0.198, 0.187], [0.496, 0.512, 0.332, 0.221, 0.132], [0.432, 0.44, 0.234, 0.203, 0.181], [0.393, 0.391, 0.271, 0.239, 0.271], [0.44, 0.44, 0.234, 0.16, 0.131], [0.457, 0.456, 0.27, 0.168, 0.092], [0.481, 0.477, 0.346, 0.223, 0.148], [0.321, 0.321, 0.263, 0.223, 0.247], [0.382, 0.382, 0.316, 0.177, 0.108], [0.378, 0.388, 0.4, 0.39, 0.379]]
nec_acc_int  =  0.497 +- 0.002, 0.562 +- 0.034, 0.794 +- 0.100, 0.828 +- 0.107, 0.834 +- 0.127

Eval split test
suff_simple class all_L1  =  0.926 +- 0.018, 0.931 +- 0.014, 0.934 +- 0.014, 0.942 +- 0.015, 0.979 +- 0.013
suff_simple class all_KL  =  0.903 +- 0.031, 0.911 +- 0.024, 0.918 +- 0.022, 0.929 +- 0.019, 0.976 +- 0.015
[[0.9160496592521667, 0.9153992533683777, 0.9167250394821167, 0.9184510707855225, 0.9728848338127136], [0.9320341944694519, 0.9317590594291687, 0.9325094819068909, 0.9403141736984253, 0.9847715497016907], [0.9278066754341125, 0.9278567433357239, 0.930208146572113, 0.942040205001831, 0.9803568124771118], [0.9252551794052124, 0.9272313117980957, 0.9278317093849182, 0.9359115362167358, 0.9585281610488892], [0.9239543676376343, 0.9225285053253174, 0.9215279221534729, 0.9251551032066345, 0.9786117672920227], [0.9311336874961853, 0.9345357418060303, 0.9357114434242249, 0.9449920058250427, 0.9688518047332764], [0.932209312915802, 0.9381629228591919, 0.9389633536338806, 0.9495447278022766, 0.9667747020721436], [0.9304582476615906, 0.9334600567817688, 0.9353862404823303, 0.9470682144165039, 0.9715553522109985], [0.9172003269195557, 0.9261056780815125, 0.9319591522216797, 0.9365869760513306, 0.9814441204071045], [0.8906593918800354, 0.9110215902328491, 0.9121222496032715, 0.9088953137397766, 0.9429550766944885]]
[[0.922, 0.924, 0.928, 0.93, 0.987], [0.927, 0.929, 0.932, 0.944, 0.992], [0.921, 0.924, 0.928, 0.941, 0.986], [0.907, 0.911, 0.914, 0.923, 0.963], [0.927, 0.929, 0.928, 0.931, 0.989], [0.914, 0.919, 0.922, 0.935, 0.973], [0.871, 0.888, 0.906, 0.927, 0.965], [0.919, 0.926, 0.929, 0.943, 0.975], [0.891, 0.914, 0.934, 0.941, 0.99], [0.826, 0.848, 0.858, 0.877, 0.944]]
suff_simple_acc_int  =  0.923 +- 0.012, 0.927 +- 0.008, 0.928 +- 0.008, 0.935 +- 0.013, 0.971 +- 0.012
nec class all_L1  =  0.308 +- 0.028, 0.257 +- 0.033, 0.198 +- 0.040, 0.154 +- 0.036, 0.113 +- 0.032
nec class all_KL  =  0.370 +- 0.029, 0.326 +- 0.039, 0.261 +- 0.057, 0.209 +- 0.057, 0.168 +- 0.054
[[0.7199569940567017, 0.7682359218597412, 0.8409045338630676, 0.8766259551048279, 0.9131729006767273], [0.6352061033248901, 0.721257746219635, 0.8012307286262512, 0.8611166477203369, 0.9189513921737671], [0.6439613699913025, 0.726836085319519, 0.805883526802063, 0.8571142554283142, 0.9020162224769592], [0.6779067516326904, 0.7494496703147888, 0.8091855049133301, 0.8604663014411926, 0.904217541217804], [0.6953172087669373, 0.7523514032363892, 0.8234190344810486, 0.8587902784347534, 0.8993896245956421], [0.6650990843772888, 0.7458224892616272, 0.8129627704620361, 0.8637182116508484, 0.909795880317688], [0.6030117869377136, 0.7047978639602661, 0.7916249632835388, 0.8467830419540405, 0.9026666283607483], [0.6462877988815308, 0.7412447333335876, 0.819116473197937, 0.8567140102386475, 0.8994396924972534], [0.6532419323921204, 0.6800330281257629, 0.7366920113563538, 0.7971282601356506, 0.8517860770225525], [0.5919301509857178, 0.6320292353630066, 0.700445294380188, 0.7678607106208801, 0.8284220695495605]]
[[0.327, 0.288, 0.22, 0.175, 0.116], [0.4, 0.335, 0.255, 0.191, 0.136], [0.383, 0.321, 0.236, 0.177, 0.148], [0.338, 0.292, 0.231, 0.174, 0.139], [0.331, 0.306, 0.243, 0.206, 0.155], [0.353, 0.295, 0.225, 0.17, 0.136], [0.406, 0.332, 0.241, 0.185, 0.16], [0.375, 0.298, 0.217, 0.174, 0.146], [0.375, 0.378, 0.355, 0.308, 0.255], [0.41, 0.415, 0.389, 0.335, 0.29]]
nec_acc_int  =  0.653 +- 0.037, 0.722 +- 0.039, 0.794 +- 0.041, 0.845 +- 0.033, 0.893 +- 0.028


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.621 +- 0.027, 0.597 +- 0.028, 0.540 +- 0.025, 0.496 +- 0.022, 0.487 +- 0.029
Faith. Armon (L1)= 		  =  0.502 +- 0.024, 0.438 +- 0.056, 0.303 +- 0.069, 0.183 +- 0.071, 0.105 +- 0.055
Faith. GMean (L1)= 	  =  0.558 +- 0.021, 0.511 +- 0.040, 0.402 +- 0.049, 0.297 +- 0.055, 0.218 +- 0.052
Faith. Aritm (KL)= 		  =  0.613 +- 0.048, 0.611 +- 0.044, 0.547 +- 0.038, 0.498 +- 0.032, 0.500 +- 0.033
Faith. Armon (KL)= 		  =  0.542 +- 0.031, 0.523 +- 0.045, 0.391 +- 0.068, 0.273 +- 0.084, 0.184 +- 0.085
Faith. GMean (KL)= 	  =  0.576 +- 0.038, 0.565 +- 0.041, 0.461 +- 0.049, 0.365 +- 0.059, 0.296 +- 0.064

Eval split val
Faith. Aritm (L1)= 		  =  0.590 +- 0.045, 0.572 +- 0.039, 0.482 +- 0.029, 0.452 +- 0.030, 0.451 +- 0.045
Faith. Armon (L1)= 		  =  0.518 +- 0.048, 0.489 +- 0.036, 0.289 +- 0.066, 0.222 +- 0.080, 0.195 +- 0.110
Faith. GMean (L1)= 	  =  0.552 +- 0.045, 0.529 +- 0.036, 0.372 +- 0.047, 0.313 +- 0.057, 0.287 +- 0.084
Faith. Aritm (KL)= 		  =  0.567 +- 0.047, 0.566 +- 0.047, 0.495 +- 0.036, 0.455 +- 0.040, 0.466 +- 0.048
Faith. Armon (KL)= 		  =  0.529 +- 0.050, 0.530 +- 0.050, 0.407 +- 0.046, 0.327 +- 0.058, 0.287 +- 0.091
Faith. GMean (KL)= 	  =  0.548 +- 0.047, 0.548 +- 0.047, 0.448 +- 0.037, 0.384 +- 0.043, 0.362 +- 0.066

Eval split test
Faith. Aritm (L1)= 		  =  0.617 +- 0.011, 0.594 +- 0.012, 0.566 +- 0.017, 0.548 +- 0.015, 0.546 +- 0.015
Faith. Armon (L1)= 		  =  0.462 +- 0.030, 0.402 +- 0.038, 0.324 +- 0.052, 0.262 +- 0.050, 0.202 +- 0.050
Faith. GMean (L1)= 	  =  0.534 +- 0.022, 0.489 +- 0.027, 0.428 +- 0.040, 0.378 +- 0.040, 0.330 +- 0.043
Faith. Aritm (KL)= 		  =  0.636 +- 0.014, 0.619 +- 0.013, 0.590 +- 0.024, 0.569 +- 0.024, 0.572 +- 0.025
Faith. Armon (KL)= 		  =  0.523 +- 0.027, 0.478 +- 0.038, 0.403 +- 0.063, 0.338 +- 0.070, 0.283 +- 0.073
Faith. GMean (KL)= 	  =  0.577 +- 0.019, 0.544 +- 0.027, 0.487 +- 0.046, 0.437 +- 0.053, 0.400 +- 0.058
Computed for split load_split = id



Completed in  2:37:10.330792  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN simple_concept2temperature TopoFeature/basis/no_shift NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 13:48:11 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 01:48:11 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 01:48:11 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:48:11 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 01:48:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:48:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:48:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:48:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:48:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:48:11 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:48:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 94 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mChartInfo 0.9560 0.9560 0.9560 0.9560 0.9740 0.9740[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.564
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.612
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.582
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.515
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.455
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.459
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.330
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.232
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.174
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.156
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.573
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.621
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.641
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.645
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.640


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5639660000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.62
SUFF_SIMPLE for r=0.05 class 0.0 = 0.75 +- 0.374 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.394 +- 0.374 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.05 all KL = 0.469 +- 0.374 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.05 all L1 = 0.553 +- 0.298 (in-sample avg dev_std = 0.557)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6115419999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.6
SUFF_SIMPLE for r=0.1 class 0.0 = 0.737 +- 0.386 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.394 +- 0.386 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.1 all KL = 0.473 +- 0.386 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.1 all L1 = 0.547 +- 0.309 (in-sample avg dev_std = 0.521)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5823539999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.587
SUFF_SIMPLE for r=0.2 class 0.0 = 0.728 +- 0.399 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.395 +- 0.399 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.2 all KL = 0.474 +- 0.399 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.2 all L1 = 0.543 +- 0.324 (in-sample avg dev_std = 0.494)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.514786
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.541
SUFF_SIMPLE for r=0.4 class 0.0 = 0.74 +- 0.420 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.342 +- 0.420 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.4 all KL = 0.462 +- 0.420 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.4 all L1 = 0.52 +- 0.344 (in-sample avg dev_std = 0.417)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.45546
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.54
SUFF_SIMPLE for r=0.8 class 0.0 = 0.835 +- 0.442 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.311 +- 0.442 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.8 all KL = 0.516 +- 0.442 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.8 all L1 = 0.545 +- 0.373 (in-sample avg dev_std = 0.148)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45907420000000004
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.177 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.841 +- 0.177 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.05 all KL = 0.935 +- 0.177 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.05 all L1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.036)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32966680000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.177 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.841 +- 0.177 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.1 all KL = 0.935 +- 0.177 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.1 all L1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.033)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2324982
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.177 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.841 +- 0.177 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 all KL = 0.936 +- 0.177 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 all L1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.014)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1744924
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.178 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.841 +- 0.178 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.4 all KL = 0.935 +- 0.178 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.4 all L1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.016)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1557414
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.841 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.936 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5730348
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.69
SUFF_SIMPLE for r=0.05 class 0.0 = 0.746 +- 0.391 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.767 +- 0.391 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all KL = 0.718 +- 0.391 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all L1 = 0.756 +- 0.309 (in-sample avg dev_std = 0.340)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6207962
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.692
SUFF_SIMPLE for r=0.1 class 0.0 = 0.743 +- 0.385 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.786 +- 0.385 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.1 all KL = 0.737 +- 0.385 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.1 all L1 = 0.765 +- 0.318 (in-sample avg dev_std = 0.276)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.641156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.692
SUFF_SIMPLE for r=0.2 class 0.0 = 0.756 +- 0.379 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.799 +- 0.379 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all KL = 0.758 +- 0.379 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all L1 = 0.778 +- 0.320 (in-sample avg dev_std = 0.202)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6453472
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.682
SUFF_SIMPLE for r=0.4 class 0.0 = 0.777 +- 0.383 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.775 +- 0.383 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.4 all KL = 0.767 +- 0.383 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.4 all L1 = 0.776 +- 0.332 (in-sample avg dev_std = 0.128)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.764
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6398050000000001
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.728
SUFF_SIMPLE for r=0.8 class 0.0 = 0.863 +- 0.285 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.868 +- 0.285 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 all KL = 0.877 +- 0.285 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 all L1 = 0.865 +- 0.257 (in-sample avg dev_std = 0.013)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5639660000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.532
NEC for r=0.05 class 0.0 = 0.091 +- 0.448 (in-sample avg dev_std = 0.009)
NEC for r=0.05 class 1.0 = 0.734 +- 0.448 (in-sample avg dev_std = 0.009)
NEC for r=0.05 all KL = 0.489 +- 0.448 (in-sample avg dev_std = 0.009)
NEC for r=0.05 all L1 = 0.447 +- 0.380 (in-sample avg dev_std = 0.009)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6115419999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.537
NEC for r=0.1 class 0.0 = 0.093 +- 0.440 (in-sample avg dev_std = 0.321)
NEC for r=0.1 class 1.0 = 0.742 +- 0.440 (in-sample avg dev_std = 0.321)
NEC for r=0.1 all KL = 0.503 +- 0.440 (in-sample avg dev_std = 0.321)
NEC for r=0.1 all L1 = 0.453 +- 0.364 (in-sample avg dev_std = 0.321)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5823539999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.677
NEC for r=0.2 class 0.0 = 0.09 +- 0.390 (in-sample avg dev_std = 0.441)
NEC for r=0.2 class 1.0 = 0.584 +- 0.390 (in-sample avg dev_std = 0.441)
NEC for r=0.2 all KL = 0.414 +- 0.390 (in-sample avg dev_std = 0.441)
NEC for r=0.2 all L1 = 0.364 +- 0.312 (in-sample avg dev_std = 0.441)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.514786
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.776
NEC for r=0.4 class 0.0 = 0.095 +- 0.340 (in-sample avg dev_std = 0.458)
NEC for r=0.4 class 1.0 = 0.441 +- 0.340 (in-sample avg dev_std = 0.458)
NEC for r=0.4 all KL = 0.329 +- 0.340 (in-sample avg dev_std = 0.458)
NEC for r=0.4 all L1 = 0.287 +- 0.264 (in-sample avg dev_std = 0.458)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.45546
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.79
NEC for r=0.8 class 0.0 = 0.158 +- 0.317 (in-sample avg dev_std = 0.492)
NEC for r=0.8 class 1.0 = 0.393 +- 0.317 (in-sample avg dev_std = 0.492)
NEC for r=0.8 all KL = 0.332 +- 0.317 (in-sample avg dev_std = 0.492)
NEC for r=0.8 all L1 = 0.288 +- 0.241 (in-sample avg dev_std = 0.492)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45907420000000004
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.003 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.158 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.063 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.081 +- 0.196 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32966680000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.003 +- 0.172 (in-sample avg dev_std = 0.020)
NEC for r=0.1 class 1.0 = 0.158 +- 0.172 (in-sample avg dev_std = 0.020)
NEC for r=0.1 all KL = 0.063 +- 0.172 (in-sample avg dev_std = 0.020)
NEC for r=0.1 all L1 = 0.081 +- 0.195 (in-sample avg dev_std = 0.020)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2324982
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.509
NEC for r=0.2 class 0.0 = 0.003 +- 0.156 (in-sample avg dev_std = 0.130)
NEC for r=0.2 class 1.0 = 0.155 +- 0.156 (in-sample avg dev_std = 0.130)
NEC for r=0.2 all KL = 0.062 +- 0.156 (in-sample avg dev_std = 0.130)
NEC for r=0.2 all L1 = 0.08 +- 0.181 (in-sample avg dev_std = 0.130)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1744924
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.513
NEC for r=0.4 class 0.0 = 0.003 +- 0.144 (in-sample avg dev_std = 0.144)
NEC for r=0.4 class 1.0 = 0.147 +- 0.144 (in-sample avg dev_std = 0.144)
NEC for r=0.4 all KL = 0.057 +- 0.144 (in-sample avg dev_std = 0.144)
NEC for r=0.4 all L1 = 0.076 +- 0.172 (in-sample avg dev_std = 0.144)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1557414
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.503
NEC for r=0.8 class 0.0 = 0.002 +- 0.156 (in-sample avg dev_std = 0.106)
NEC for r=0.8 class 1.0 = 0.15 +- 0.156 (in-sample avg dev_std = 0.106)
NEC for r=0.8 all KL = 0.058 +- 0.156 (in-sample avg dev_std = 0.106)
NEC for r=0.8 all L1 = 0.077 +- 0.183 (in-sample avg dev_std = 0.106)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5730348
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.551
NEC for r=0.05 class 0.0 = 0.326 +- 0.440 (in-sample avg dev_std = 0.147)
NEC for r=0.05 class 1.0 = 0.684 +- 0.440 (in-sample avg dev_std = 0.147)
NEC for r=0.05 all KL = 0.554 +- 0.440 (in-sample avg dev_std = 0.147)
NEC for r=0.05 all L1 = 0.503 +- 0.383 (in-sample avg dev_std = 0.147)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6207962
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.565
NEC for r=0.1 class 0.0 = 0.298 +- 0.419 (in-sample avg dev_std = 0.370)
NEC for r=0.1 class 1.0 = 0.647 +- 0.419 (in-sample avg dev_std = 0.370)
NEC for r=0.1 all KL = 0.525 +- 0.419 (in-sample avg dev_std = 0.370)
NEC for r=0.1 all L1 = 0.47 +- 0.358 (in-sample avg dev_std = 0.370)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.641156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.597
NEC for r=0.2 class 0.0 = 0.244 +- 0.396 (in-sample avg dev_std = 0.444)
NEC for r=0.2 class 1.0 = 0.55 +- 0.396 (in-sample avg dev_std = 0.444)
NEC for r=0.2 all KL = 0.448 +- 0.396 (in-sample avg dev_std = 0.444)
NEC for r=0.2 all L1 = 0.395 +- 0.328 (in-sample avg dev_std = 0.444)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6453472
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.66
NEC for r=0.4 class 0.0 = 0.201 +- 0.353 (in-sample avg dev_std = 0.433)
NEC for r=0.4 class 1.0 = 0.383 +- 0.353 (in-sample avg dev_std = 0.433)
NEC for r=0.4 all KL = 0.332 +- 0.353 (in-sample avg dev_std = 0.433)
NEC for r=0.4 all L1 = 0.291 +- 0.284 (in-sample avg dev_std = 0.433)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6398050000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.703
NEC for r=0.8 class 0.0 = 0.214 +- 0.333 (in-sample avg dev_std = 0.406)
NEC for r=0.8 class 1.0 = 0.269 +- 0.333 (in-sample avg dev_std = 0.406)
NEC for r=0.8 all KL = 0.286 +- 0.333 (in-sample avg dev_std = 0.406)
NEC for r=0.8 all L1 = 0.241 +- 0.259 (in-sample avg dev_std = 0.406)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 14:03:59 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 02:03:59 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 02:03:59 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:03:59 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 02:03:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:03:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:03:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:03:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:03:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:03:59 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:03:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mChartInfo 0.9600 0.9600 0.9600 0.9600 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.524
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.564
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.554
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.515
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.480
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.398
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.297
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.232
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.200
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.193
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.565
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.604
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.624
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.632
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.636


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5240820000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.585
SUFF_SIMPLE for r=0.05 class 0.0 = 0.771 +- 0.403 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.339 +- 0.403 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.05 all KL = 0.405 +- 0.403 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.05 all L1 = 0.532 +- 0.319 (in-sample avg dev_std = 0.547)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5642619999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.594
SUFF_SIMPLE for r=0.1 class 0.0 = 0.779 +- 0.407 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.352 +- 0.407 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.1 all KL = 0.417 +- 0.407 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.1 all L1 = 0.542 +- 0.322 (in-sample avg dev_std = 0.541)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5535039999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.591
SUFF_SIMPLE for r=0.2 class 0.0 = 0.777 +- 0.409 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.335 +- 0.409 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.2 all KL = 0.406 +- 0.409 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.2 all L1 = 0.532 +- 0.319 (in-sample avg dev_std = 0.558)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5145619999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.573
SUFF_SIMPLE for r=0.4 class 0.0 = 0.811 +- 0.424 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.296 +- 0.424 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.4 all KL = 0.416 +- 0.424 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.4 all L1 = 0.526 +- 0.334 (in-sample avg dev_std = 0.505)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47984000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.591
SUFF_SIMPLE for r=0.8 class 0.0 = 0.847 +- 0.457 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.368 +- 0.457 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.8 all KL = 0.529 +- 0.457 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.8 all L1 = 0.582 +- 0.381 (in-sample avg dev_std = 0.229)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3980822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.503
SUFF_SIMPLE for r=0.05 class 0.0 = 0.993 +- 0.240 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.81 +- 0.240 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.05 all KL = 0.905 +- 0.240 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.05 all L1 = 0.901 +- 0.227 (in-sample avg dev_std = 0.150)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2967962
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.502
SUFF_SIMPLE for r=0.1 class 0.0 = 0.995 +- 0.238 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.81 +- 0.238 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.1 all KL = 0.907 +- 0.238 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.1 all L1 = 0.902 +- 0.228 (in-sample avg dev_std = 0.137)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.232206
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.5
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.238 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.81 +- 0.238 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 all KL = 0.908 +- 0.238 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 all L1 = 0.902 +- 0.229 (in-sample avg dev_std = 0.121)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2004564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.236 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.809 +- 0.236 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.4 all KL = 0.911 +- 0.236 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.4 all L1 = 0.903 +- 0.231 (in-sample avg dev_std = 0.080)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1929168
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.235 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.809 +- 0.235 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.8 all KL = 0.913 +- 0.235 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.8 all L1 = 0.903 +- 0.232 (in-sample avg dev_std = 0.010)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5646831999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.646
SUFF_SIMPLE for r=0.05 class 0.0 = 0.814 +- 0.444 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.607 +- 0.444 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.05 all KL = 0.58 +- 0.444 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.05 all L1 = 0.712 +- 0.325 (in-sample avg dev_std = 0.442)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6044842
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.653
SUFF_SIMPLE for r=0.1 class 0.0 = 0.832 +- 0.443 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.636 +- 0.443 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.1 all KL = 0.633 +- 0.443 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.1 all L1 = 0.735 +- 0.332 (in-sample avg dev_std = 0.389)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6237054
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.649
SUFF_SIMPLE for r=0.2 class 0.0 = 0.848 +- 0.431 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.661 +- 0.431 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.2 all KL = 0.688 +- 0.431 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.2 all L1 = 0.756 +- 0.337 (in-sample avg dev_std = 0.337)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6324598
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.653
SUFF_SIMPLE for r=0.4 class 0.0 = 0.852 +- 0.417 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.689 +- 0.417 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.4 all KL = 0.729 +- 0.417 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.4 all L1 = 0.772 +- 0.340 (in-sample avg dev_std = 0.262)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6358043999999999
len(reference) = 4964
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.707
SUFF_SIMPLE for r=0.8 class 0.0 = 0.888 +- 0.310 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.857 +- 0.310 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.8 all KL = 0.867 +- 0.310 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.8 all L1 = 0.872 +- 0.272 (in-sample avg dev_std = 0.040)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5240820000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.463
NEC for r=0.05 class 0.0 = 0.109 +- 0.463 (in-sample avg dev_std = 0.058)
NEC for r=0.05 class 1.0 = 0.819 +- 0.463 (in-sample avg dev_std = 0.058)
NEC for r=0.05 all KL = 0.567 +- 0.463 (in-sample avg dev_std = 0.058)
NEC for r=0.05 all L1 = 0.502 +- 0.390 (in-sample avg dev_std = 0.058)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5642619999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.477
NEC for r=0.1 class 0.0 = 0.133 +- 0.457 (in-sample avg dev_std = 0.302)
NEC for r=0.1 class 1.0 = 0.814 +- 0.457 (in-sample avg dev_std = 0.302)
NEC for r=0.1 all KL = 0.582 +- 0.457 (in-sample avg dev_std = 0.302)
NEC for r=0.1 all L1 = 0.51 +- 0.375 (in-sample avg dev_std = 0.302)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5535039999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.547
NEC for r=0.2 class 0.0 = 0.145 +- 0.445 (in-sample avg dev_std = 0.450)
NEC for r=0.2 class 1.0 = 0.747 +- 0.445 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all KL = 0.578 +- 0.445 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all L1 = 0.478 +- 0.351 (in-sample avg dev_std = 0.450)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5145619999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.621
NEC for r=0.4 class 0.0 = 0.16 +- 0.425 (in-sample avg dev_std = 0.555)
NEC for r=0.4 class 1.0 = 0.658 +- 0.425 (in-sample avg dev_std = 0.555)
NEC for r=0.4 all KL = 0.558 +- 0.425 (in-sample avg dev_std = 0.555)
NEC for r=0.4 all L1 = 0.436 +- 0.321 (in-sample avg dev_std = 0.555)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47984000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.674
NEC for r=0.8 class 0.0 = 0.195 +- 0.402 (in-sample avg dev_std = 0.602)
NEC for r=0.8 class 1.0 = 0.575 +- 0.402 (in-sample avg dev_std = 0.602)
NEC for r=0.8 all KL = 0.546 +- 0.402 (in-sample avg dev_std = 0.602)
NEC for r=0.8 all L1 = 0.405 +- 0.293 (in-sample avg dev_std = 0.602)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3980822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.005 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.187 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.088 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.097 +- 0.229 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2967962
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
NEC for r=0.1 class 0.0 = 0.008 +- 0.237 (in-sample avg dev_std = 0.056)
NEC for r=0.1 class 1.0 = 0.187 +- 0.237 (in-sample avg dev_std = 0.056)
NEC for r=0.1 all KL = 0.091 +- 0.237 (in-sample avg dev_std = 0.056)
NEC for r=0.1 all L1 = 0.098 +- 0.229 (in-sample avg dev_std = 0.056)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.232206
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.501
NEC for r=0.2 class 0.0 = 0.013 +- 0.245 (in-sample avg dev_std = 0.151)
NEC for r=0.2 class 1.0 = 0.19 +- 0.245 (in-sample avg dev_std = 0.151)
NEC for r=0.2 all KL = 0.101 +- 0.245 (in-sample avg dev_std = 0.151)
NEC for r=0.2 all L1 = 0.102 +- 0.228 (in-sample avg dev_std = 0.151)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2004564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.506
NEC for r=0.4 class 0.0 = 0.01 +- 0.241 (in-sample avg dev_std = 0.168)
NEC for r=0.4 class 1.0 = 0.189 +- 0.241 (in-sample avg dev_std = 0.168)
NEC for r=0.4 all KL = 0.098 +- 0.241 (in-sample avg dev_std = 0.168)
NEC for r=0.4 all L1 = 0.1 +- 0.225 (in-sample avg dev_std = 0.168)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1929168
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.508
NEC for r=0.8 class 0.0 = 0.007 +- 0.238 (in-sample avg dev_std = 0.168)
NEC for r=0.8 class 1.0 = 0.188 +- 0.238 (in-sample avg dev_std = 0.168)
NEC for r=0.8 all KL = 0.096 +- 0.238 (in-sample avg dev_std = 0.168)
NEC for r=0.8 all L1 = 0.099 +- 0.223 (in-sample avg dev_std = 0.168)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5646831999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.524
NEC for r=0.05 class 0.0 = 0.327 +- 0.465 (in-sample avg dev_std = 0.129)
NEC for r=0.05 class 1.0 = 0.744 +- 0.465 (in-sample avg dev_std = 0.129)
NEC for r=0.05 all KL = 0.623 +- 0.465 (in-sample avg dev_std = 0.129)
NEC for r=0.05 all L1 = 0.533 +- 0.395 (in-sample avg dev_std = 0.129)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6044842
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.557
NEC for r=0.1 class 0.0 = 0.326 +- 0.463 (in-sample avg dev_std = 0.337)
NEC for r=0.1 class 1.0 = 0.712 +- 0.463 (in-sample avg dev_std = 0.337)
NEC for r=0.1 all KL = 0.626 +- 0.463 (in-sample avg dev_std = 0.337)
NEC for r=0.1 all L1 = 0.517 +- 0.383 (in-sample avg dev_std = 0.337)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6237054
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.599
NEC for r=0.2 class 0.0 = 0.315 +- 0.458 (in-sample avg dev_std = 0.469)
NEC for r=0.2 class 1.0 = 0.638 +- 0.458 (in-sample avg dev_std = 0.469)
NEC for r=0.2 all KL = 0.615 +- 0.458 (in-sample avg dev_std = 0.469)
NEC for r=0.2 all L1 = 0.475 +- 0.364 (in-sample avg dev_std = 0.469)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6324598
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.641
NEC for r=0.4 class 0.0 = 0.296 +- 0.440 (in-sample avg dev_std = 0.540)
NEC for r=0.4 class 1.0 = 0.526 +- 0.440 (in-sample avg dev_std = 0.540)
NEC for r=0.4 all KL = 0.583 +- 0.440 (in-sample avg dev_std = 0.540)
NEC for r=0.4 all L1 = 0.41 +- 0.335 (in-sample avg dev_std = 0.540)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6358043999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.663
NEC for r=0.8 class 0.0 = 0.267 +- 0.419 (in-sample avg dev_std = 0.568)
NEC for r=0.8 class 1.0 = 0.441 +- 0.419 (in-sample avg dev_std = 0.568)
NEC for r=0.8 all KL = 0.544 +- 0.419 (in-sample avg dev_std = 0.568)
NEC for r=0.8 all L1 = 0.353 +- 0.308 (in-sample avg dev_std = 0.568)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 14:20:06 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 02:20:06 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:06 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:06 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 02:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:06 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:20:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mChartInfo 0.9620 0.9620 0.9620 0.9620 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.558
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.602
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.583
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.538
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.497
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.389
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.275
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.205
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.171
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.163
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.567
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.607
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.627
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.633
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.631


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.558236
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.61
SUFF_SIMPLE for r=0.05 class 0.0 = 0.798 +- 0.393 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.371 +- 0.393 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.05 all KL = 0.464 +- 0.393 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.05 all L1 = 0.562 +- 0.313 (in-sample avg dev_std = 0.536)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.601664
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.623
SUFF_SIMPLE for r=0.1 class 0.0 = 0.815 +- 0.399 (in-sample avg dev_std = 0.524)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.376 +- 0.399 (in-sample avg dev_std = 0.524)
SUFF_SIMPLE for r=0.1 all KL = 0.477 +- 0.399 (in-sample avg dev_std = 0.524)
SUFF_SIMPLE for r=0.1 all L1 = 0.572 +- 0.316 (in-sample avg dev_std = 0.524)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.582798
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.627
SUFF_SIMPLE for r=0.2 class 0.0 = 0.807 +- 0.397 (in-sample avg dev_std = 0.532)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.388 +- 0.397 (in-sample avg dev_std = 0.532)
SUFF_SIMPLE for r=0.2 all KL = 0.47 +- 0.397 (in-sample avg dev_std = 0.532)
SUFF_SIMPLE for r=0.2 all L1 = 0.575 +- 0.310 (in-sample avg dev_std = 0.532)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537856
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.612
SUFF_SIMPLE for r=0.4 class 0.0 = 0.827 +- 0.411 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.363 +- 0.411 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.4 all KL = 0.481 +- 0.411 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.4 all L1 = 0.57 +- 0.325 (in-sample avg dev_std = 0.480)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.497126
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.578
SUFF_SIMPLE for r=0.8 class 0.0 = 0.853 +- 0.447 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.369 +- 0.447 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 all KL = 0.543 +- 0.447 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 all L1 = 0.585 +- 0.376 (in-sample avg dev_std = 0.232)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.389181
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.216 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.848 +- 0.216 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.05 all KL = 0.927 +- 0.216 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.05 all L1 = 0.921 +- 0.211 (in-sample avg dev_std = 0.101)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2747986
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.499
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.216 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.848 +- 0.216 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.1 all KL = 0.927 +- 0.216 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.1 all L1 = 0.921 +- 0.211 (in-sample avg dev_std = 0.099)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20482960000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.216 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.848 +- 0.216 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.2 all KL = 0.928 +- 0.216 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.2 all L1 = 0.922 +- 0.212 (in-sample avg dev_std = 0.080)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.17085540000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.217 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.846 +- 0.217 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.4 all KL = 0.928 +- 0.217 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.4 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.046)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.16306579999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.846 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.928 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5668956
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.686
SUFF_SIMPLE for r=0.05 class 0.0 = 0.809 +- 0.385 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.711 +- 0.385 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.05 all KL = 0.734 +- 0.385 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.05 all L1 = 0.76 +- 0.319 (in-sample avg dev_std = 0.246)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6068646
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.688
SUFF_SIMPLE for r=0.1 class 0.0 = 0.813 +- 0.380 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.725 +- 0.380 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.1 all KL = 0.75 +- 0.380 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.1 all L1 = 0.77 +- 0.319 (in-sample avg dev_std = 0.236)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6267582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.693
SUFF_SIMPLE for r=0.2 class 0.0 = 0.822 +- 0.376 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.728 +- 0.376 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all KL = 0.76 +- 0.376 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all L1 = 0.775 +- 0.320 (in-sample avg dev_std = 0.195)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6328718000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.687
SUFF_SIMPLE for r=0.4 class 0.0 = 0.825 +- 0.376 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.727 +- 0.376 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.4 all KL = 0.763 +- 0.376 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.4 all L1 = 0.776 +- 0.324 (in-sample avg dev_std = 0.155)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6309754000000001
len(reference) = 4979
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.735
SUFF_SIMPLE for r=0.8 class 0.0 = 0.858 +- 0.284 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.868 +- 0.284 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.8 all KL = 0.868 +- 0.284 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.8 all L1 = 0.863 +- 0.256 (in-sample avg dev_std = 0.032)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.558236
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.472
NEC for r=0.05 class 0.0 = 0.086 +- 0.459 (in-sample avg dev_std = 0.094)
NEC for r=0.05 class 1.0 = 0.795 +- 0.459 (in-sample avg dev_std = 0.094)
NEC for r=0.05 all KL = 0.534 +- 0.459 (in-sample avg dev_std = 0.094)
NEC for r=0.05 all L1 = 0.479 +- 0.390 (in-sample avg dev_std = 0.094)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.601664
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.471
NEC for r=0.1 class 0.0 = 0.105 +- 0.455 (in-sample avg dev_std = 0.292)
NEC for r=0.1 class 1.0 = 0.803 +- 0.455 (in-sample avg dev_std = 0.292)
NEC for r=0.1 all KL = 0.555 +- 0.455 (in-sample avg dev_std = 0.292)
NEC for r=0.1 all L1 = 0.492 +- 0.377 (in-sample avg dev_std = 0.292)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.582798
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.531
NEC for r=0.2 class 0.0 = 0.115 +- 0.443 (in-sample avg dev_std = 0.457)
NEC for r=0.2 class 1.0 = 0.759 +- 0.443 (in-sample avg dev_std = 0.457)
NEC for r=0.2 all KL = 0.549 +- 0.443 (in-sample avg dev_std = 0.457)
NEC for r=0.2 all L1 = 0.472 +- 0.354 (in-sample avg dev_std = 0.457)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537856
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.608
NEC for r=0.4 class 0.0 = 0.14 +- 0.412 (in-sample avg dev_std = 0.526)
NEC for r=0.4 class 1.0 = 0.654 +- 0.412 (in-sample avg dev_std = 0.526)
NEC for r=0.4 all KL = 0.52 +- 0.412 (in-sample avg dev_std = 0.526)
NEC for r=0.4 all L1 = 0.425 +- 0.319 (in-sample avg dev_std = 0.526)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.497126
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.692
NEC for r=0.8 class 0.0 = 0.155 +- 0.383 (in-sample avg dev_std = 0.552)
NEC for r=0.8 class 1.0 = 0.538 +- 0.383 (in-sample avg dev_std = 0.552)
NEC for r=0.8 all KL = 0.467 +- 0.383 (in-sample avg dev_std = 0.552)
NEC for r=0.8 all L1 = 0.367 +- 0.289 (in-sample avg dev_std = 0.552)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.389181
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.495
NEC for r=0.05 class 0.0 = 0.017 +- 0.222 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.147 +- 0.222 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.077 +- 0.222 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.083 +- 0.215 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2747986
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.501
NEC for r=0.1 class 0.0 = 0.022 +- 0.224 (in-sample avg dev_std = 0.075)
NEC for r=0.1 class 1.0 = 0.145 +- 0.224 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all KL = 0.079 +- 0.224 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all L1 = 0.084 +- 0.213 (in-sample avg dev_std = 0.075)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20482960000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.499
NEC for r=0.2 class 0.0 = 0.018 +- 0.226 (in-sample avg dev_std = 0.160)
NEC for r=0.2 class 1.0 = 0.149 +- 0.226 (in-sample avg dev_std = 0.160)
NEC for r=0.2 all KL = 0.084 +- 0.226 (in-sample avg dev_std = 0.160)
NEC for r=0.2 all L1 = 0.084 +- 0.210 (in-sample avg dev_std = 0.160)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.17085540000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.504
NEC for r=0.4 class 0.0 = 0.014 +- 0.218 (in-sample avg dev_std = 0.176)
NEC for r=0.4 class 1.0 = 0.147 +- 0.218 (in-sample avg dev_std = 0.176)
NEC for r=0.4 all KL = 0.08 +- 0.218 (in-sample avg dev_std = 0.176)
NEC for r=0.4 all L1 = 0.081 +- 0.204 (in-sample avg dev_std = 0.176)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.16306579999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.508
NEC for r=0.8 class 0.0 = 0.008 +- 0.209 (in-sample avg dev_std = 0.164)
NEC for r=0.8 class 1.0 = 0.146 +- 0.209 (in-sample avg dev_std = 0.164)
NEC for r=0.8 all KL = 0.074 +- 0.209 (in-sample avg dev_std = 0.164)
NEC for r=0.8 all L1 = 0.078 +- 0.200 (in-sample avg dev_std = 0.164)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5668956
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.533
NEC for r=0.05 class 0.0 = 0.306 +- 0.452 (in-sample avg dev_std = 0.147)
NEC for r=0.05 class 1.0 = 0.729 +- 0.452 (in-sample avg dev_std = 0.147)
NEC for r=0.05 all KL = 0.576 +- 0.452 (in-sample avg dev_std = 0.147)
NEC for r=0.05 all L1 = 0.515 +- 0.385 (in-sample avg dev_std = 0.147)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6068646
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.56
NEC for r=0.1 class 0.0 = 0.308 +- 0.450 (in-sample avg dev_std = 0.317)
NEC for r=0.1 class 1.0 = 0.71 +- 0.450 (in-sample avg dev_std = 0.317)
NEC for r=0.1 all KL = 0.586 +- 0.450 (in-sample avg dev_std = 0.317)
NEC for r=0.1 all L1 = 0.507 +- 0.377 (in-sample avg dev_std = 0.317)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6267582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.606
NEC for r=0.2 class 0.0 = 0.295 +- 0.437 (in-sample avg dev_std = 0.443)
NEC for r=0.2 class 1.0 = 0.638 +- 0.437 (in-sample avg dev_std = 0.443)
NEC for r=0.2 all KL = 0.57 +- 0.437 (in-sample avg dev_std = 0.443)
NEC for r=0.2 all L1 = 0.464 +- 0.356 (in-sample avg dev_std = 0.443)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6328718000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.647
NEC for r=0.4 class 0.0 = 0.276 +- 0.414 (in-sample avg dev_std = 0.496)
NEC for r=0.4 class 1.0 = 0.517 +- 0.414 (in-sample avg dev_std = 0.496)
NEC for r=0.4 all KL = 0.514 +- 0.414 (in-sample avg dev_std = 0.496)
NEC for r=0.4 all L1 = 0.395 +- 0.328 (in-sample avg dev_std = 0.496)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6309754000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.682
NEC for r=0.8 class 0.0 = 0.247 +- 0.386 (in-sample avg dev_std = 0.506)
NEC for r=0.8 class 1.0 = 0.405 +- 0.386 (in-sample avg dev_std = 0.506)
NEC for r=0.8 all KL = 0.44 +- 0.386 (in-sample avg dev_std = 0.506)
NEC for r=0.8 all L1 = 0.325 +- 0.299 (in-sample avg dev_std = 0.506)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 14:36:23 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 02:36:23 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 02:36:23 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:36:23 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 02:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:36:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:36:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:36:23 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:36:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mChartInfo 0.9440 0.9440 0.9440 0.9440 0.9680 0.9680[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.586
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.607
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.567
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.506
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.464
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.388
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.263
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.182
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.140
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.130
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.583
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.617
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.629
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.632
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.635


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.586386
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.59
SUFF_SIMPLE for r=0.05 class 0.0 = 0.825 +- 0.410 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.311 +- 0.410 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.05 all KL = 0.459 +- 0.410 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.05 all L1 = 0.54 +- 0.325 (in-sample avg dev_std = 0.503)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.606532
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.599
SUFF_SIMPLE for r=0.1 class 0.0 = 0.821 +- 0.407 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.331 +- 0.407 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.1 all KL = 0.475 +- 0.407 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.1 all L1 = 0.55 +- 0.327 (in-sample avg dev_std = 0.469)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5667620000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.589
SUFF_SIMPLE for r=0.2 class 0.0 = 0.832 +- 0.410 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.306 +- 0.410 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.2 all KL = 0.463 +- 0.410 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.2 all L1 = 0.54 +- 0.328 (in-sample avg dev_std = 0.473)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.506066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.559
SUFF_SIMPLE for r=0.4 class 0.0 = 0.844 +- 0.424 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.271 +- 0.424 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.4 all KL = 0.458 +- 0.424 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.4 all L1 = 0.526 +- 0.343 (in-sample avg dev_std = 0.417)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.463508
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.598
SUFF_SIMPLE for r=0.8 class 0.0 = 0.84 +- 0.437 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.373 +- 0.437 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 all KL = 0.543 +- 0.437 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 all L1 = 0.581 +- 0.368 (in-sample avg dev_std = 0.203)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387676
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.05 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.05 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.017)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.26267599999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.1 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.1 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.009)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.181619
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.2 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.2 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.005)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.140123
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1298802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5830317999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.639
SUFF_SIMPLE for r=0.05 class 0.0 = 0.807 +- 0.412 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.574 +- 0.412 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.05 all KL = 0.6 +- 0.412 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.05 all L1 = 0.692 +- 0.328 (in-sample avg dev_std = 0.473)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6166992
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.644
SUFF_SIMPLE for r=0.1 class 0.0 = 0.821 +- 0.411 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.598 +- 0.411 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 all KL = 0.635 +- 0.411 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 all L1 = 0.711 +- 0.332 (in-sample avg dev_std = 0.427)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6291796000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.637
SUFF_SIMPLE for r=0.2 class 0.0 = 0.834 +- 0.405 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.625 +- 0.405 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.2 all KL = 0.669 +- 0.405 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.2 all L1 = 0.731 +- 0.333 (in-sample avg dev_std = 0.395)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6322397999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.635
SUFF_SIMPLE for r=0.4 class 0.0 = 0.837 +- 0.410 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.632 +- 0.410 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.4 all KL = 0.683 +- 0.410 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.4 all L1 = 0.736 +- 0.338 (in-sample avg dev_std = 0.379)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6347244000000001
len(reference) = 4962
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.671
SUFF_SIMPLE for r=0.8 class 0.0 = 0.881 +- 0.350 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.792 +- 0.350 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.8 all KL = 0.827 +- 0.350 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.8 all L1 = 0.837 +- 0.308 (in-sample avg dev_std = 0.116)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.586386
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.459
NEC for r=0.05 class 0.0 = 0.105 +- 0.461 (in-sample avg dev_std = 0.013)
NEC for r=0.05 class 1.0 = 0.813 +- 0.461 (in-sample avg dev_std = 0.013)
NEC for r=0.05 all KL = 0.548 +- 0.461 (in-sample avg dev_std = 0.013)
NEC for r=0.05 all L1 = 0.497 +- 0.388 (in-sample avg dev_std = 0.013)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.606532
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.45
NEC for r=0.1 class 0.0 = 0.115 +- 0.459 (in-sample avg dev_std = 0.158)
NEC for r=0.1 class 1.0 = 0.824 +- 0.459 (in-sample avg dev_std = 0.158)
NEC for r=0.1 all KL = 0.562 +- 0.459 (in-sample avg dev_std = 0.158)
NEC for r=0.1 all L1 = 0.508 +- 0.385 (in-sample avg dev_std = 0.158)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5667620000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.494
NEC for r=0.2 class 0.0 = 0.113 +- 0.454 (in-sample avg dev_std = 0.351)
NEC for r=0.2 class 1.0 = 0.791 +- 0.454 (in-sample avg dev_std = 0.351)
NEC for r=0.2 all KL = 0.551 +- 0.454 (in-sample avg dev_std = 0.351)
NEC for r=0.2 all L1 = 0.488 +- 0.373 (in-sample avg dev_std = 0.351)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.506066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.582
NEC for r=0.4 class 0.0 = 0.109 +- 0.439 (in-sample avg dev_std = 0.526)
NEC for r=0.4 class 1.0 = 0.712 +- 0.439 (in-sample avg dev_std = 0.526)
NEC for r=0.4 all KL = 0.524 +- 0.439 (in-sample avg dev_std = 0.526)
NEC for r=0.4 all L1 = 0.443 +- 0.345 (in-sample avg dev_std = 0.526)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.463508
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.664
NEC for r=0.8 class 0.0 = 0.141 +- 0.404 (in-sample avg dev_std = 0.603)
NEC for r=0.8 class 1.0 = 0.612 +- 0.404 (in-sample avg dev_std = 0.603)
NEC for r=0.8 all KL = 0.495 +- 0.404 (in-sample avg dev_std = 0.603)
NEC for r=0.8 all L1 = 0.402 +- 0.303 (in-sample avg dev_std = 0.603)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387676
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.11 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.047 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.056 +- 0.173 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.26267599999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.003 +- 0.161 (in-sample avg dev_std = 0.015)
NEC for r=0.1 class 1.0 = 0.109 +- 0.161 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all KL = 0.047 +- 0.161 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all L1 = 0.057 +- 0.172 (in-sample avg dev_std = 0.015)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.181619
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.002 +- 0.166 (in-sample avg dev_std = 0.048)
NEC for r=0.2 class 1.0 = 0.111 +- 0.166 (in-sample avg dev_std = 0.048)
NEC for r=0.2 all KL = 0.049 +- 0.166 (in-sample avg dev_std = 0.048)
NEC for r=0.2 all L1 = 0.057 +- 0.174 (in-sample avg dev_std = 0.048)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.140123
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.499
NEC for r=0.4 class 0.0 = 0.001 +- 0.161 (in-sample avg dev_std = 0.074)
NEC for r=0.4 class 1.0 = 0.108 +- 0.161 (in-sample avg dev_std = 0.074)
NEC for r=0.4 all KL = 0.046 +- 0.161 (in-sample avg dev_std = 0.074)
NEC for r=0.4 all L1 = 0.055 +- 0.170 (in-sample avg dev_std = 0.074)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1298802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.498
NEC for r=0.8 class 0.0 = 0.001 +- 0.160 (in-sample avg dev_std = 0.066)
NEC for r=0.8 class 1.0 = 0.109 +- 0.160 (in-sample avg dev_std = 0.066)
NEC for r=0.8 all KL = 0.046 +- 0.160 (in-sample avg dev_std = 0.066)
NEC for r=0.8 all L1 = 0.055 +- 0.170 (in-sample avg dev_std = 0.066)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5830317999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.519
NEC for r=0.05 class 0.0 = 0.33 +- 0.463 (in-sample avg dev_std = 0.085)
NEC for r=0.05 class 1.0 = 0.732 +- 0.463 (in-sample avg dev_std = 0.085)
NEC for r=0.05 all KL = 0.609 +- 0.463 (in-sample avg dev_std = 0.085)
NEC for r=0.05 all L1 = 0.529 +- 0.395 (in-sample avg dev_std = 0.085)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6166992
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.523
NEC for r=0.1 class 0.0 = 0.333 +- 0.459 (in-sample avg dev_std = 0.240)
NEC for r=0.1 class 1.0 = 0.728 +- 0.459 (in-sample avg dev_std = 0.240)
NEC for r=0.1 all KL = 0.613 +- 0.459 (in-sample avg dev_std = 0.240)
NEC for r=0.1 all L1 = 0.528 +- 0.390 (in-sample avg dev_std = 0.240)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6291796000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.548
NEC for r=0.2 class 0.0 = 0.324 +- 0.449 (in-sample avg dev_std = 0.405)
NEC for r=0.2 class 1.0 = 0.686 +- 0.449 (in-sample avg dev_std = 0.405)
NEC for r=0.2 all KL = 0.596 +- 0.449 (in-sample avg dev_std = 0.405)
NEC for r=0.2 all L1 = 0.503 +- 0.375 (in-sample avg dev_std = 0.405)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6322397999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.59
NEC for r=0.4 class 0.0 = 0.3 +- 0.430 (in-sample avg dev_std = 0.530)
NEC for r=0.4 class 1.0 = 0.591 +- 0.430 (in-sample avg dev_std = 0.530)
NEC for r=0.4 all KL = 0.548 +- 0.430 (in-sample avg dev_std = 0.530)
NEC for r=0.4 all L1 = 0.444 +- 0.350 (in-sample avg dev_std = 0.530)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6347244000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.621
NEC for r=0.8 class 0.0 = 0.276 +- 0.402 (in-sample avg dev_std = 0.604)
NEC for r=0.8 class 1.0 = 0.532 +- 0.402 (in-sample avg dev_std = 0.604)
NEC for r=0.8 all KL = 0.529 +- 0.402 (in-sample avg dev_std = 0.604)
NEC for r=0.8 all L1 = 0.403 +- 0.318 (in-sample avg dev_std = 0.604)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 14:53:04 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 02:53:04 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 02:53:04 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:53:04 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 02:53:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:53:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:53:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:53:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:53:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:53:04 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:53:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mChartInfo 0.9500 0.9500 0.9500 0.9500 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.545
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.589
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.571
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.528
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.491
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.419
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.308
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.237
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.203
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.196
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.563
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.600
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.619
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.626
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.634


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.544598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.575
SUFF_SIMPLE for r=0.05 class 0.0 = 0.819 +- 0.405 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.295 +- 0.405 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.05 all KL = 0.45 +- 0.405 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.05 all L1 = 0.529 +- 0.320 (in-sample avg dev_std = 0.507)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.589254
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.596
SUFF_SIMPLE for r=0.1 class 0.0 = 0.833 +- 0.403 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.311 +- 0.403 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.1 all KL = 0.468 +- 0.403 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.1 all L1 = 0.544 +- 0.319 (in-sample avg dev_std = 0.508)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.571346
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.593
SUFF_SIMPLE for r=0.2 class 0.0 = 0.841 +- 0.407 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.299 +- 0.407 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.2 all KL = 0.466 +- 0.407 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.2 all L1 = 0.541 +- 0.321 (in-sample avg dev_std = 0.509)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.52767
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.565
SUFF_SIMPLE for r=0.4 class 0.0 = 0.835 +- 0.414 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.279 +- 0.414 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.4 all KL = 0.456 +- 0.414 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.4 all L1 = 0.527 +- 0.333 (in-sample avg dev_std = 0.453)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.491084
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.566
SUFF_SIMPLE for r=0.8 class 0.0 = 0.846 +- 0.441 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.334 +- 0.441 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.8 all KL = 0.527 +- 0.441 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.8 all L1 = 0.562 +- 0.370 (in-sample avg dev_std = 0.219)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4193664000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.05 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.210 (in-sample avg dev_std = 0.020)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3080754
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.1 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.1 all L1 = 0.91 +- 0.210 (in-sample avg dev_std = 0.014)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23700439999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.2 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.2 all L1 = 0.91 +- 0.210 (in-sample avg dev_std = 0.013)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20296779999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1956944
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5627904
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.657
SUFF_SIMPLE for r=0.05 class 0.0 = 0.795 +- 0.412 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.603 +- 0.412 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.05 all KL = 0.641 +- 0.412 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.05 all L1 = 0.7 +- 0.322 (in-sample avg dev_std = 0.405)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.600358
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.664
SUFF_SIMPLE for r=0.1 class 0.0 = 0.82 +- 0.401 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.642 +- 0.401 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 all KL = 0.694 +- 0.401 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 all L1 = 0.732 +- 0.322 (in-sample avg dev_std = 0.352)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.618613
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.663
SUFF_SIMPLE for r=0.2 class 0.0 = 0.836 +- 0.383 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.687 +- 0.383 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.2 all KL = 0.745 +- 0.383 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.2 all L1 = 0.762 +- 0.320 (in-sample avg dev_std = 0.276)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6259155999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.663
SUFF_SIMPLE for r=0.4 class 0.0 = 0.836 +- 0.379 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.703 +- 0.379 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 all KL = 0.759 +- 0.379 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 all L1 = 0.77 +- 0.321 (in-sample avg dev_std = 0.236)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.759
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6338482
len(reference) = 4960
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.705
SUFF_SIMPLE for r=0.8 class 0.0 = 0.871 +- 0.292 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.85 +- 0.292 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all KL = 0.873 +- 0.292 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all L1 = 0.861 +- 0.265 (in-sample avg dev_std = 0.031)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.544598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.442
NEC for r=0.05 class 0.0 = 0.094 +- 0.459 (in-sample avg dev_std = 0.018)
NEC for r=0.05 class 1.0 = 0.831 +- 0.459 (in-sample avg dev_std = 0.018)
NEC for r=0.05 all KL = 0.548 +- 0.459 (in-sample avg dev_std = 0.018)
NEC for r=0.05 all L1 = 0.502 +- 0.389 (in-sample avg dev_std = 0.018)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.589254
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.458
NEC for r=0.1 class 0.0 = 0.097 +- 0.458 (in-sample avg dev_std = 0.162)
NEC for r=0.1 class 1.0 = 0.825 +- 0.458 (in-sample avg dev_std = 0.162)
NEC for r=0.1 all KL = 0.55 +- 0.458 (in-sample avg dev_std = 0.162)
NEC for r=0.1 all L1 = 0.5 +- 0.385 (in-sample avg dev_std = 0.162)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.571346
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.483
NEC for r=0.2 class 0.0 = 0.101 +- 0.454 (in-sample avg dev_std = 0.314)
NEC for r=0.2 class 1.0 = 0.805 +- 0.454 (in-sample avg dev_std = 0.314)
NEC for r=0.2 all KL = 0.545 +- 0.454 (in-sample avg dev_std = 0.314)
NEC for r=0.2 all L1 = 0.491 +- 0.377 (in-sample avg dev_std = 0.314)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.52767
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.562
NEC for r=0.4 class 0.0 = 0.116 +- 0.436 (in-sample avg dev_std = 0.500)
NEC for r=0.4 class 1.0 = 0.74 +- 0.436 (in-sample avg dev_std = 0.500)
NEC for r=0.4 all KL = 0.532 +- 0.436 (in-sample avg dev_std = 0.500)
NEC for r=0.4 all L1 = 0.462 +- 0.345 (in-sample avg dev_std = 0.500)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.491084
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.646
NEC for r=0.8 class 0.0 = 0.134 +- 0.408 (in-sample avg dev_std = 0.602)
NEC for r=0.8 class 1.0 = 0.647 +- 0.408 (in-sample avg dev_std = 0.602)
NEC for r=0.8 all KL = 0.505 +- 0.408 (in-sample avg dev_std = 0.602)
NEC for r=0.8 all L1 = 0.418 +- 0.307 (in-sample avg dev_std = 0.602)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4193664000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.004 +- 0.193 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.175 +- 0.193 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.072 +- 0.193 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.09 +- 0.208 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3080754
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.005 +- 0.192 (in-sample avg dev_std = 0.030)
NEC for r=0.1 class 1.0 = 0.175 +- 0.192 (in-sample avg dev_std = 0.030)
NEC for r=0.1 all KL = 0.072 +- 0.192 (in-sample avg dev_std = 0.030)
NEC for r=0.1 all L1 = 0.09 +- 0.208 (in-sample avg dev_std = 0.030)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23700439999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.005 +- 0.199 (in-sample avg dev_std = 0.065)
NEC for r=0.2 class 1.0 = 0.176 +- 0.199 (in-sample avg dev_std = 0.065)
NEC for r=0.2 all KL = 0.077 +- 0.199 (in-sample avg dev_std = 0.065)
NEC for r=0.2 all L1 = 0.092 +- 0.210 (in-sample avg dev_std = 0.065)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20296779999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
NEC for r=0.4 class 0.0 = 0.004 +- 0.195 (in-sample avg dev_std = 0.081)
NEC for r=0.4 class 1.0 = 0.175 +- 0.195 (in-sample avg dev_std = 0.081)
NEC for r=0.4 all KL = 0.075 +- 0.195 (in-sample avg dev_std = 0.081)
NEC for r=0.4 all L1 = 0.09 +- 0.207 (in-sample avg dev_std = 0.081)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1956944
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.499
NEC for r=0.8 class 0.0 = 0.003 +- 0.193 (in-sample avg dev_std = 0.083)
NEC for r=0.8 class 1.0 = 0.175 +- 0.193 (in-sample avg dev_std = 0.083)
NEC for r=0.8 all KL = 0.073 +- 0.193 (in-sample avg dev_std = 0.083)
NEC for r=0.8 all L1 = 0.089 +- 0.206 (in-sample avg dev_std = 0.083)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5627904
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.523
NEC for r=0.05 class 0.0 = 0.313 +- 0.447 (in-sample avg dev_std = 0.054)
NEC for r=0.05 class 1.0 = 0.729 +- 0.447 (in-sample avg dev_std = 0.054)
NEC for r=0.05 all KL = 0.582 +- 0.447 (in-sample avg dev_std = 0.054)
NEC for r=0.05 all L1 = 0.518 +- 0.393 (in-sample avg dev_std = 0.054)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.600358
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.528
NEC for r=0.1 class 0.0 = 0.318 +- 0.447 (in-sample avg dev_std = 0.187)
NEC for r=0.1 class 1.0 = 0.728 +- 0.447 (in-sample avg dev_std = 0.187)
NEC for r=0.1 all KL = 0.59 +- 0.447 (in-sample avg dev_std = 0.187)
NEC for r=0.1 all L1 = 0.521 +- 0.391 (in-sample avg dev_std = 0.187)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.618613
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.547
NEC for r=0.2 class 0.0 = 0.312 +- 0.441 (in-sample avg dev_std = 0.371)
NEC for r=0.2 class 1.0 = 0.698 +- 0.441 (in-sample avg dev_std = 0.371)
NEC for r=0.2 all KL = 0.576 +- 0.441 (in-sample avg dev_std = 0.371)
NEC for r=0.2 all L1 = 0.503 +- 0.381 (in-sample avg dev_std = 0.371)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6259155999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.585
NEC for r=0.4 class 0.0 = 0.288 +- 0.427 (in-sample avg dev_std = 0.528)
NEC for r=0.4 class 1.0 = 0.628 +- 0.427 (in-sample avg dev_std = 0.528)
NEC for r=0.4 all KL = 0.538 +- 0.427 (in-sample avg dev_std = 0.528)
NEC for r=0.4 all L1 = 0.456 +- 0.355 (in-sample avg dev_std = 0.528)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.758
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6338482
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.624
NEC for r=0.8 class 0.0 = 0.275 +- 0.408 (in-sample avg dev_std = 0.619)
NEC for r=0.8 class 1.0 = 0.553 +- 0.408 (in-sample avg dev_std = 0.619)
NEC for r=0.8 all KL = 0.522 +- 0.408 (in-sample avg dev_std = 0.619)
NEC for r=0.8 all L1 = 0.412 +- 0.320 (in-sample avg dev_std = 0.619)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 15:09:34 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 03:09:34 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 03:09:34 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:09:34 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 03:09:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:09:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:09:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:09:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:09:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:09:34 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:09:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mChartInfo 0.9460 0.9460 0.9460 0.9460 0.9560 0.9560[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.544
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.543
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.467
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.374
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.311
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.326
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.199
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.120
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.063
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.545
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.572
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.579
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.581
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.586


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.543858
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.478
SUFF_SIMPLE for r=0.05 class 0.0 = 0.837 +- 0.420 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.195 +- 0.420 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.05 all KL = 0.439 +- 0.420 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.05 all L1 = 0.481 +- 0.354 (in-sample avg dev_std = 0.302)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.54268
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.478
SUFF_SIMPLE for r=0.1 class 0.0 = 0.835 +- 0.421 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.199 +- 0.421 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.1 all KL = 0.442 +- 0.421 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.1 all L1 = 0.482 +- 0.355 (in-sample avg dev_std = 0.304)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46653999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.502
SUFF_SIMPLE for r=0.2 class 0.0 = 0.833 +- 0.418 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.226 +- 0.418 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.2 all KL = 0.456 +- 0.418 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.2 all L1 = 0.497 +- 0.352 (in-sample avg dev_std = 0.357)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.37388600000000005
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.474
SUFF_SIMPLE for r=0.4 class 0.0 = 0.816 +- 0.420 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.215 +- 0.420 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.4 all KL = 0.443 +- 0.420 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.4 all L1 = 0.483 +- 0.357 (in-sample avg dev_std = 0.278)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.310576
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.483
SUFF_SIMPLE for r=0.8 class 0.0 = 0.851 +- 0.436 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.227 +- 0.436 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.8 all KL = 0.481 +- 0.436 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.8 all L1 = 0.505 +- 0.376 (in-sample avg dev_std = 0.062)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3264632
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1992766
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.120321
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0774788
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06265060000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5448006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.667
SUFF_SIMPLE for r=0.05 class 0.0 = 0.835 +- 0.397 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.709 +- 0.397 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.05 all KL = 0.738 +- 0.397 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.05 all L1 = 0.773 +- 0.317 (in-sample avg dev_std = 0.214)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5719512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.668
SUFF_SIMPLE for r=0.1 class 0.0 = 0.84 +- 0.384 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.731 +- 0.384 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.1 all KL = 0.764 +- 0.384 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.1 all L1 = 0.786 +- 0.315 (in-sample avg dev_std = 0.184)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5790533999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.671
SUFF_SIMPLE for r=0.2 class 0.0 = 0.845 +- 0.365 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.748 +- 0.365 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.2 all KL = 0.792 +- 0.365 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.2 all L1 = 0.797 +- 0.315 (in-sample avg dev_std = 0.145)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5811682
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.672
SUFF_SIMPLE for r=0.4 class 0.0 = 0.856 +- 0.358 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.747 +- 0.358 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.4 all KL = 0.803 +- 0.358 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.4 all L1 = 0.802 +- 0.315 (in-sample avg dev_std = 0.123)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5863786
len(reference) = 4946
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.699
SUFF_SIMPLE for r=0.8 class 0.0 = 0.9 +- 0.272 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.857 +- 0.272 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.8 all KL = 0.894 +- 0.272 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.8 all L1 = 0.879 +- 0.248 (in-sample avg dev_std = 0.019)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.543858
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.467
NEC for r=0.05 class 0.0 = 0.12 +- 0.440 (in-sample avg dev_std = 0.022)
NEC for r=0.05 class 1.0 = 0.801 +- 0.440 (in-sample avg dev_std = 0.022)
NEC for r=0.05 all KL = 0.533 +- 0.440 (in-sample avg dev_std = 0.022)
NEC for r=0.05 all L1 = 0.497 +- 0.382 (in-sample avg dev_std = 0.022)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.54268
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
NEC for r=0.1 class 0.0 = 0.122 +- 0.443 (in-sample avg dev_std = 0.071)
NEC for r=0.1 class 1.0 = 0.827 +- 0.443 (in-sample avg dev_std = 0.071)
NEC for r=0.1 all KL = 0.546 +- 0.443 (in-sample avg dev_std = 0.071)
NEC for r=0.1 all L1 = 0.513 +- 0.382 (in-sample avg dev_std = 0.071)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46653999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.464
NEC for r=0.2 class 0.0 = 0.132 +- 0.438 (in-sample avg dev_std = 0.232)
NEC for r=0.2 class 1.0 = 0.815 +- 0.438 (in-sample avg dev_std = 0.232)
NEC for r=0.2 all KL = 0.543 +- 0.438 (in-sample avg dev_std = 0.232)
NEC for r=0.2 all L1 = 0.51 +- 0.372 (in-sample avg dev_std = 0.232)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.37388600000000005
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.51
NEC for r=0.4 class 0.0 = 0.148 +- 0.420 (in-sample avg dev_std = 0.392)
NEC for r=0.4 class 1.0 = 0.778 +- 0.420 (in-sample avg dev_std = 0.392)
NEC for r=0.4 all KL = 0.537 +- 0.420 (in-sample avg dev_std = 0.392)
NEC for r=0.4 all L1 = 0.497 +- 0.351 (in-sample avg dev_std = 0.392)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.310576
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.558
NEC for r=0.8 class 0.0 = 0.148 +- 0.406 (in-sample avg dev_std = 0.475)
NEC for r=0.8 class 1.0 = 0.73 +- 0.406 (in-sample avg dev_std = 0.475)
NEC for r=0.8 all KL = 0.514 +- 0.406 (in-sample avg dev_std = 0.475)
NEC for r=0.8 all L1 = 0.47 +- 0.335 (in-sample avg dev_std = 0.475)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3264632
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.09 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.031 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1992766
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.105 (in-sample avg dev_std = 0.004)
NEC for r=0.1 class 1.0 = 0.09 +- 0.105 (in-sample avg dev_std = 0.004)
NEC for r=0.1 all KL = 0.031 +- 0.105 (in-sample avg dev_std = 0.004)
NEC for r=0.1 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.004)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.120321
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.002)
NEC for r=0.2 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0774788
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.004)
NEC for r=0.4 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.004)
NEC for r=0.4 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.004)
NEC for r=0.4 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.004)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06265060000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.008)
NEC for r=0.8 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.008)
NEC for r=0.8 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.008)
NEC for r=0.8 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.008)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5448006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.535
NEC for r=0.05 class 0.0 = 0.329 +- 0.438 (in-sample avg dev_std = 0.023)
NEC for r=0.05 class 1.0 = 0.732 +- 0.438 (in-sample avg dev_std = 0.023)
NEC for r=0.05 all KL = 0.578 +- 0.438 (in-sample avg dev_std = 0.023)
NEC for r=0.05 all L1 = 0.528 +- 0.385 (in-sample avg dev_std = 0.023)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5719512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.524
NEC for r=0.1 class 0.0 = 0.334 +- 0.437 (in-sample avg dev_std = 0.181)
NEC for r=0.1 class 1.0 = 0.75 +- 0.437 (in-sample avg dev_std = 0.181)
NEC for r=0.1 all KL = 0.594 +- 0.437 (in-sample avg dev_std = 0.181)
NEC for r=0.1 all L1 = 0.54 +- 0.380 (in-sample avg dev_std = 0.181)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5790533999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.534
NEC for r=0.2 class 0.0 = 0.325 +- 0.430 (in-sample avg dev_std = 0.405)
NEC for r=0.2 class 1.0 = 0.71 +- 0.430 (in-sample avg dev_std = 0.405)
NEC for r=0.2 all KL = 0.579 +- 0.430 (in-sample avg dev_std = 0.405)
NEC for r=0.2 all L1 = 0.515 +- 0.369 (in-sample avg dev_std = 0.405)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5811682
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.577
NEC for r=0.4 class 0.0 = 0.29 +- 0.409 (in-sample avg dev_std = 0.543)
NEC for r=0.4 class 1.0 = 0.616 +- 0.409 (in-sample avg dev_std = 0.543)
NEC for r=0.4 all KL = 0.525 +- 0.409 (in-sample avg dev_std = 0.543)
NEC for r=0.4 all L1 = 0.451 +- 0.343 (in-sample avg dev_std = 0.543)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5863786
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.635
NEC for r=0.8 class 0.0 = 0.258 +- 0.380 (in-sample avg dev_std = 0.586)
NEC for r=0.8 class 1.0 = 0.498 +- 0.380 (in-sample avg dev_std = 0.586)
NEC for r=0.8 all KL = 0.47 +- 0.380 (in-sample avg dev_std = 0.586)
NEC for r=0.8 all L1 = 0.377 +- 0.307 (in-sample avg dev_std = 0.586)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 15:26:41 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 03:26:41 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 03:26:41 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:26:41 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 03:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:26:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:26:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mChartInfo 0.9660 0.9660 0.9660 0.9660 0.9720 0.9720[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.572
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.604
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.572
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.518
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.472
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.385
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.263
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.186
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.147
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.135
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.554
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.599
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.618
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.624
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.624


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5724199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.609
SUFF_SIMPLE for r=0.05 class 0.0 = 0.86 +- 0.404 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.335 +- 0.404 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.05 all KL = 0.504 +- 0.404 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.05 all L1 = 0.57 +- 0.330 (in-sample avg dev_std = 0.455)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6036300000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.628
SUFF_SIMPLE for r=0.1 class 0.0 = 0.862 +- 0.397 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.353 +- 0.397 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.1 all KL = 0.509 +- 0.397 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.1 all L1 = 0.58 +- 0.322 (in-sample avg dev_std = 0.461)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5717420000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.626
SUFF_SIMPLE for r=0.2 class 0.0 = 0.858 +- 0.402 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.347 +- 0.402 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.2 all KL = 0.503 +- 0.402 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.2 all L1 = 0.575 +- 0.323 (in-sample avg dev_std = 0.475)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.517828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.586
SUFF_SIMPLE for r=0.4 class 0.0 = 0.853 +- 0.411 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.311 +- 0.411 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 all KL = 0.481 +- 0.411 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 all L1 = 0.553 +- 0.336 (in-sample avg dev_std = 0.428)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47195
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.568
SUFF_SIMPLE for r=0.8 class 0.0 = 0.853 +- 0.444 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.351 +- 0.444 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.8 all KL = 0.541 +- 0.444 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.8 all L1 = 0.575 +- 0.377 (in-sample avg dev_std = 0.181)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3853108
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 all L1 = 0.954 +- 0.152 (in-sample avg dev_std = 0.014)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2630796
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1859616
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.2 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.2 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1471292
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.13548960000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5538407999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.683
SUFF_SIMPLE for r=0.05 class 0.0 = 0.857 +- 0.381 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.722 +- 0.381 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.05 all KL = 0.775 +- 0.381 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.05 all L1 = 0.79 +- 0.332 (in-sample avg dev_std = 0.166)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5990923999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.687
SUFF_SIMPLE for r=0.1 class 0.0 = 0.851 +- 0.378 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.735 +- 0.378 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.1 all KL = 0.779 +- 0.378 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.1 all L1 = 0.794 +- 0.328 (in-sample avg dev_std = 0.174)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6184592000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.686
SUFF_SIMPLE for r=0.2 class 0.0 = 0.844 +- 0.384 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.729 +- 0.384 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.2 all KL = 0.77 +- 0.384 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.2 all L1 = 0.787 +- 0.332 (in-sample avg dev_std = 0.150)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6244049999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.684
SUFF_SIMPLE for r=0.4 class 0.0 = 0.849 +- 0.383 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.728 +- 0.383 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all KL = 0.774 +- 0.383 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all L1 = 0.789 +- 0.333 (in-sample avg dev_std = 0.124)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6240072
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.724
SUFF_SIMPLE for r=0.8 class 0.0 = 0.883 +- 0.286 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.868 +- 0.286 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all KL = 0.879 +- 0.286 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all L1 = 0.876 +- 0.260 (in-sample avg dev_std = 0.005)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5724199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.448
NEC for r=0.05 class 0.0 = 0.078 +- 0.465 (in-sample avg dev_std = 0.021)
NEC for r=0.05 class 1.0 = 0.823 +- 0.465 (in-sample avg dev_std = 0.021)
NEC for r=0.05 all KL = 0.542 +- 0.465 (in-sample avg dev_std = 0.021)
NEC for r=0.05 all L1 = 0.491 +- 0.397 (in-sample avg dev_std = 0.021)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6036300000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.453
NEC for r=0.1 class 0.0 = 0.079 +- 0.464 (in-sample avg dev_std = 0.126)
NEC for r=0.1 class 1.0 = 0.82 +- 0.464 (in-sample avg dev_std = 0.126)
NEC for r=0.1 all KL = 0.542 +- 0.464 (in-sample avg dev_std = 0.126)
NEC for r=0.1 all L1 = 0.49 +- 0.394 (in-sample avg dev_std = 0.126)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5717420000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.486
NEC for r=0.2 class 0.0 = 0.087 +- 0.455 (in-sample avg dev_std = 0.329)
NEC for r=0.2 class 1.0 = 0.792 +- 0.455 (in-sample avg dev_std = 0.329)
NEC for r=0.2 all KL = 0.532 +- 0.455 (in-sample avg dev_std = 0.329)
NEC for r=0.2 all L1 = 0.478 +- 0.379 (in-sample avg dev_std = 0.329)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.517828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.579
NEC for r=0.4 class 0.0 = 0.091 +- 0.435 (in-sample avg dev_std = 0.494)
NEC for r=0.4 class 1.0 = 0.716 +- 0.435 (in-sample avg dev_std = 0.494)
NEC for r=0.4 all KL = 0.507 +- 0.435 (in-sample avg dev_std = 0.494)
NEC for r=0.4 all L1 = 0.437 +- 0.347 (in-sample avg dev_std = 0.494)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47195
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.655
NEC for r=0.8 class 0.0 = 0.112 +- 0.400 (in-sample avg dev_std = 0.551)
NEC for r=0.8 class 1.0 = 0.619 +- 0.400 (in-sample avg dev_std = 0.551)
NEC for r=0.8 all KL = 0.469 +- 0.400 (in-sample avg dev_std = 0.551)
NEC for r=0.8 all L1 = 0.393 +- 0.312 (in-sample avg dev_std = 0.551)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3853108
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.136 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.09 +- 0.136 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.036 +- 0.136 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2630796
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.137 (in-sample avg dev_std = 0.012)
NEC for r=0.1 class 1.0 = 0.09 +- 0.137 (in-sample avg dev_std = 0.012)
NEC for r=0.1 all KL = 0.036 +- 0.137 (in-sample avg dev_std = 0.012)
NEC for r=0.1 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.012)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1859616
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.137 (in-sample avg dev_std = 0.021)
NEC for r=0.2 class 1.0 = 0.09 +- 0.137 (in-sample avg dev_std = 0.021)
NEC for r=0.2 all KL = 0.036 +- 0.137 (in-sample avg dev_std = 0.021)
NEC for r=0.2 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.021)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1471292
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
NEC for r=0.4 class 0.0 = 0.001 +- 0.136 (in-sample avg dev_std = 0.040)
NEC for r=0.4 class 1.0 = 0.089 +- 0.136 (in-sample avg dev_std = 0.040)
NEC for r=0.4 all KL = 0.036 +- 0.136 (in-sample avg dev_std = 0.040)
NEC for r=0.4 all L1 = 0.045 +- 0.151 (in-sample avg dev_std = 0.040)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.13548960000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.497
NEC for r=0.8 class 0.0 = 0.001 +- 0.134 (in-sample avg dev_std = 0.038)
NEC for r=0.8 class 1.0 = 0.089 +- 0.134 (in-sample avg dev_std = 0.038)
NEC for r=0.8 all KL = 0.036 +- 0.134 (in-sample avg dev_std = 0.038)
NEC for r=0.8 all L1 = 0.045 +- 0.151 (in-sample avg dev_std = 0.038)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5538407999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.515
NEC for r=0.05 class 0.0 = 0.342 +- 0.454 (in-sample avg dev_std = 0.054)
NEC for r=0.05 class 1.0 = 0.767 +- 0.454 (in-sample avg dev_std = 0.054)
NEC for r=0.05 all KL = 0.624 +- 0.454 (in-sample avg dev_std = 0.054)
NEC for r=0.05 all L1 = 0.552 +- 0.381 (in-sample avg dev_std = 0.054)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5990923999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.517
NEC for r=0.1 class 0.0 = 0.337 +- 0.454 (in-sample avg dev_std = 0.222)
NEC for r=0.1 class 1.0 = 0.765 +- 0.454 (in-sample avg dev_std = 0.222)
NEC for r=0.1 all KL = 0.627 +- 0.454 (in-sample avg dev_std = 0.222)
NEC for r=0.1 all L1 = 0.549 +- 0.380 (in-sample avg dev_std = 0.222)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6184592000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.539
NEC for r=0.2 class 0.0 = 0.32 +- 0.448 (in-sample avg dev_std = 0.427)
NEC for r=0.2 class 1.0 = 0.721 +- 0.448 (in-sample avg dev_std = 0.427)
NEC for r=0.2 all KL = 0.613 +- 0.448 (in-sample avg dev_std = 0.427)
NEC for r=0.2 all L1 = 0.518 +- 0.367 (in-sample avg dev_std = 0.427)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6244049999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.583
NEC for r=0.4 class 0.0 = 0.285 +- 0.428 (in-sample avg dev_std = 0.538)
NEC for r=0.4 class 1.0 = 0.623 +- 0.428 (in-sample avg dev_std = 0.538)
NEC for r=0.4 all KL = 0.566 +- 0.428 (in-sample avg dev_std = 0.538)
NEC for r=0.4 all L1 = 0.452 +- 0.341 (in-sample avg dev_std = 0.538)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6240072
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.627
NEC for r=0.8 class 0.0 = 0.246 +- 0.400 (in-sample avg dev_std = 0.570)
NEC for r=0.8 class 1.0 = 0.506 +- 0.400 (in-sample avg dev_std = 0.570)
NEC for r=0.8 all KL = 0.495 +- 0.400 (in-sample avg dev_std = 0.570)
NEC for r=0.8 all L1 = 0.375 +- 0.314 (in-sample avg dev_std = 0.570)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 15:44:09 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 03:44:09 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 03:44:09 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:44:09 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 03:44:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:44:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:44:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:44:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:44:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:44:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:44:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mChartInfo 0.9320 0.9320 0.9320 0.9320 0.9260 0.9260[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.520
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.497
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.408
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.300
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.219
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.266
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.161
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.099
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.055
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.528
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.545
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.538
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.529
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.536


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.519802
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.484
SUFF_SIMPLE for r=0.05 class 0.0 = 0.784 +- 0.387 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.229 +- 0.387 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.05 all KL = 0.471 +- 0.387 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.05 all L1 = 0.477 +- 0.331 (in-sample avg dev_std = 0.227)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49693200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.485
SUFF_SIMPLE for r=0.1 class 0.0 = 0.786 +- 0.388 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.228 +- 0.388 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.1 all KL = 0.47 +- 0.388 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.1 all L1 = 0.477 +- 0.331 (in-sample avg dev_std = 0.240)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.407726
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.506
SUFF_SIMPLE for r=0.2 class 0.0 = 0.784 +- 0.382 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.254 +- 0.382 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.2 all KL = 0.483 +- 0.382 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.2 all L1 = 0.49 +- 0.328 (in-sample avg dev_std = 0.276)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.300044
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.491
SUFF_SIMPLE for r=0.4 class 0.0 = 0.763 +- 0.392 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.265 +- 0.392 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.4 all KL = 0.482 +- 0.392 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.4 all L1 = 0.487 +- 0.337 (in-sample avg dev_std = 0.201)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.218806
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.492
SUFF_SIMPLE for r=0.8 class 0.0 = 0.779 +- 0.406 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.273 +- 0.406 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.8 all KL = 0.499 +- 0.406 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.8 all L1 = 0.499 +- 0.353 (in-sample avg dev_std = 0.051)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2663822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1609544
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0992264
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661854
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.054928
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5278546000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.61
SUFF_SIMPLE for r=0.05 class 0.0 = 0.82 +- 0.351 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.641 +- 0.351 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.05 all KL = 0.765 +- 0.351 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.05 all L1 = 0.732 +- 0.301 (in-sample avg dev_std = 0.131)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5454656
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.612
SUFF_SIMPLE for r=0.1 class 0.0 = 0.823 +- 0.344 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.655 +- 0.344 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.1 all KL = 0.776 +- 0.344 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.1 all L1 = 0.74 +- 0.295 (in-sample avg dev_std = 0.140)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5384985999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.624
SUFF_SIMPLE for r=0.2 class 0.0 = 0.818 +- 0.348 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.657 +- 0.348 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.2 all KL = 0.779 +- 0.348 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.2 all L1 = 0.738 +- 0.297 (in-sample avg dev_std = 0.118)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5286824000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.622
SUFF_SIMPLE for r=0.4 class 0.0 = 0.818 +- 0.350 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.654 +- 0.350 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.4 all KL = 0.779 +- 0.350 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.4 all L1 = 0.737 +- 0.301 (in-sample avg dev_std = 0.103)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.535523
len(reference) = 4947
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.662
SUFF_SIMPLE for r=0.8 class 0.0 = 0.878 +- 0.260 (in-sample avg dev_std = 0.038)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.769 +- 0.260 (in-sample avg dev_std = 0.038)
SUFF_SIMPLE for r=0.8 all KL = 0.878 +- 0.260 (in-sample avg dev_std = 0.038)
SUFF_SIMPLE for r=0.8 all L1 = 0.824 +- 0.247 (in-sample avg dev_std = 0.038)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.519802
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.456
NEC for r=0.05 class 0.0 = 0.161 +- 0.416 (in-sample avg dev_std = 0.005)
NEC for r=0.05 class 1.0 = 0.779 +- 0.416 (in-sample avg dev_std = 0.005)
NEC for r=0.05 all KL = 0.513 +- 0.416 (in-sample avg dev_std = 0.005)
NEC for r=0.05 all L1 = 0.503 +- 0.365 (in-sample avg dev_std = 0.005)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49693200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.454
NEC for r=0.1 class 0.0 = 0.165 +- 0.416 (in-sample avg dev_std = 0.075)
NEC for r=0.1 class 1.0 = 0.79 +- 0.416 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all KL = 0.522 +- 0.416 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all L1 = 0.511 +- 0.361 (in-sample avg dev_std = 0.075)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.407726
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.47
NEC for r=0.2 class 0.0 = 0.184 +- 0.409 (in-sample avg dev_std = 0.260)
NEC for r=0.2 class 1.0 = 0.781 +- 0.409 (in-sample avg dev_std = 0.260)
NEC for r=0.2 all KL = 0.527 +- 0.409 (in-sample avg dev_std = 0.260)
NEC for r=0.2 all L1 = 0.515 +- 0.348 (in-sample avg dev_std = 0.260)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.300044
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.538
NEC for r=0.4 class 0.0 = 0.186 +- 0.388 (in-sample avg dev_std = 0.401)
NEC for r=0.4 class 1.0 = 0.726 +- 0.388 (in-sample avg dev_std = 0.401)
NEC for r=0.4 all KL = 0.495 +- 0.388 (in-sample avg dev_std = 0.401)
NEC for r=0.4 all L1 = 0.485 +- 0.326 (in-sample avg dev_std = 0.401)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.218806
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.594
NEC for r=0.8 class 0.0 = 0.191 +- 0.365 (in-sample avg dev_std = 0.443)
NEC for r=0.8 class 1.0 = 0.667 +- 0.365 (in-sample avg dev_std = 0.443)
NEC for r=0.8 all KL = 0.458 +- 0.365 (in-sample avg dev_std = 0.443)
NEC for r=0.8 all L1 = 0.455 +- 0.304 (in-sample avg dev_std = 0.443)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2663822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.005 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.165 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.058 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.085 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1609544
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.005 +- 0.137 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.164 +- 0.137 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.057 +- 0.137 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.085 +- 0.176 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0992264
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.004 +- 0.145 (in-sample avg dev_std = 0.017)
NEC for r=0.2 class 1.0 = 0.166 +- 0.145 (in-sample avg dev_std = 0.017)
NEC for r=0.2 all KL = 0.061 +- 0.145 (in-sample avg dev_std = 0.017)
NEC for r=0.2 all L1 = 0.086 +- 0.178 (in-sample avg dev_std = 0.017)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661854
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.005 +- 0.144 (in-sample avg dev_std = 0.022)
NEC for r=0.4 class 1.0 = 0.166 +- 0.144 (in-sample avg dev_std = 0.022)
NEC for r=0.4 all KL = 0.061 +- 0.144 (in-sample avg dev_std = 0.022)
NEC for r=0.4 all L1 = 0.086 +- 0.178 (in-sample avg dev_std = 0.022)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.054928
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.005 +- 0.144 (in-sample avg dev_std = 0.015)
NEC for r=0.8 class 1.0 = 0.166 +- 0.144 (in-sample avg dev_std = 0.015)
NEC for r=0.8 all KL = 0.061 +- 0.144 (in-sample avg dev_std = 0.015)
NEC for r=0.8 all L1 = 0.086 +- 0.178 (in-sample avg dev_std = 0.015)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5278546000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.538
NEC for r=0.05 class 0.0 = 0.321 +- 0.395 (in-sample avg dev_std = 0.015)
NEC for r=0.05 class 1.0 = 0.601 +- 0.395 (in-sample avg dev_std = 0.015)
NEC for r=0.05 all KL = 0.438 +- 0.395 (in-sample avg dev_std = 0.015)
NEC for r=0.05 all L1 = 0.459 +- 0.353 (in-sample avg dev_std = 0.015)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5454656
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.537
NEC for r=0.1 class 0.0 = 0.329 +- 0.392 (in-sample avg dev_std = 0.095)
NEC for r=0.1 class 1.0 = 0.615 +- 0.392 (in-sample avg dev_std = 0.095)
NEC for r=0.1 all KL = 0.458 +- 0.392 (in-sample avg dev_std = 0.095)
NEC for r=0.1 all L1 = 0.47 +- 0.349 (in-sample avg dev_std = 0.095)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5384985999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.533
NEC for r=0.2 class 0.0 = 0.324 +- 0.391 (in-sample avg dev_std = 0.247)
NEC for r=0.2 class 1.0 = 0.624 +- 0.391 (in-sample avg dev_std = 0.247)
NEC for r=0.2 all KL = 0.467 +- 0.391 (in-sample avg dev_std = 0.247)
NEC for r=0.2 all L1 = 0.472 +- 0.342 (in-sample avg dev_std = 0.247)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5286824000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.53
NEC for r=0.4 class 0.0 = 0.301 +- 0.387 (in-sample avg dev_std = 0.393)
NEC for r=0.4 class 1.0 = 0.599 +- 0.387 (in-sample avg dev_std = 0.393)
NEC for r=0.4 all KL = 0.448 +- 0.387 (in-sample avg dev_std = 0.393)
NEC for r=0.4 all L1 = 0.448 +- 0.331 (in-sample avg dev_std = 0.393)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.535523
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.553
NEC for r=0.8 class 0.0 = 0.263 +- 0.369 (in-sample avg dev_std = 0.474)
NEC for r=0.8 class 1.0 = 0.519 +- 0.369 (in-sample avg dev_std = 0.474)
NEC for r=0.8 all KL = 0.394 +- 0.369 (in-sample avg dev_std = 0.474)
NEC for r=0.8 all L1 = 0.389 +- 0.311 (in-sample avg dev_std = 0.474)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 16:00:39 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 04:00:39 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 04:00:39 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:00:39 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 04:00:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:00:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:00:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:00:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:00:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:00:39 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:00:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mChartInfo 0.9540 0.9540 0.9540 0.9540 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.523
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.545
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.492
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.418
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.361
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.345
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.225
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.146
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.102
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.087
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.556
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.592
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.607
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.612
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.609


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5233880000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.525
SUFF_SIMPLE for r=0.05 class 0.0 = 0.815 +- 0.410 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.226 +- 0.410 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.05 all KL = 0.418 +- 0.410 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.05 all L1 = 0.489 +- 0.331 (in-sample avg dev_std = 0.477)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5450740000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.52
SUFF_SIMPLE for r=0.1 class 0.0 = 0.804 +- 0.406 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.23 +- 0.406 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.1 all KL = 0.415 +- 0.406 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.1 all L1 = 0.486 +- 0.329 (in-sample avg dev_std = 0.476)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.49151599999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.526
SUFF_SIMPLE for r=0.2 class 0.0 = 0.805 +- 0.407 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.24 +- 0.407 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.2 all KL = 0.419 +- 0.407 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.2 all L1 = 0.492 +- 0.327 (in-sample avg dev_std = 0.485)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.41751
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.533
SUFF_SIMPLE for r=0.4 class 0.0 = 0.831 +- 0.426 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.25 +- 0.426 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.4 all KL = 0.453 +- 0.426 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.4 all L1 = 0.509 +- 0.348 (in-sample avg dev_std = 0.403)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.36093000000000003
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.559
SUFF_SIMPLE for r=0.8 class 0.0 = 0.847 +- 0.445 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.32 +- 0.445 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.8 all KL = 0.526 +- 0.445 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.8 all L1 = 0.555 +- 0.378 (in-sample avg dev_std = 0.146)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3449662
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.003)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22476139999999994
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.1 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.012)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459654
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.2 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.012)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10206439999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.001)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08663779999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5557373999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.653
SUFF_SIMPLE for r=0.05 class 0.0 = 0.831 +- 0.404 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.651 +- 0.404 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all KL = 0.683 +- 0.404 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.05 all L1 = 0.742 +- 0.328 (in-sample avg dev_std = 0.340)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5918868
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.658
SUFF_SIMPLE for r=0.1 class 0.0 = 0.839 +- 0.401 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.672 +- 0.401 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.1 all KL = 0.714 +- 0.401 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.1 all L1 = 0.756 +- 0.333 (in-sample avg dev_std = 0.286)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6069532
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.663
SUFF_SIMPLE for r=0.2 class 0.0 = 0.848 +- 0.398 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.685 +- 0.398 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 all KL = 0.738 +- 0.398 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 all L1 = 0.768 +- 0.336 (in-sample avg dev_std = 0.233)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6120368
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.67
SUFF_SIMPLE for r=0.4 class 0.0 = 0.849 +- 0.391 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.706 +- 0.391 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 all KL = 0.758 +- 0.391 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 all L1 = 0.778 +- 0.337 (in-sample avg dev_std = 0.162)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6086604
len(reference) = 4961
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.739
SUFF_SIMPLE for r=0.8 class 0.0 = 0.897 +- 0.274 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.873 +- 0.274 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all KL = 0.889 +- 0.274 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all L1 = 0.885 +- 0.247 (in-sample avg dev_std = 0.002)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5233880000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.463
NEC for r=0.05 class 0.0 = 0.112 +- 0.451 (in-sample avg dev_std = 0.034)
NEC for r=0.05 class 1.0 = 0.814 +- 0.451 (in-sample avg dev_std = 0.034)
NEC for r=0.05 all KL = 0.548 +- 0.451 (in-sample avg dev_std = 0.034)
NEC for r=0.05 all L1 = 0.501 +- 0.381 (in-sample avg dev_std = 0.034)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5450740000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.468
NEC for r=0.1 class 0.0 = 0.119 +- 0.450 (in-sample avg dev_std = 0.149)
NEC for r=0.1 class 1.0 = 0.822 +- 0.450 (in-sample avg dev_std = 0.149)
NEC for r=0.1 all KL = 0.556 +- 0.450 (in-sample avg dev_std = 0.149)
NEC for r=0.1 all L1 = 0.509 +- 0.376 (in-sample avg dev_std = 0.149)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.49151599999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.492
NEC for r=0.2 class 0.0 = 0.122 +- 0.445 (in-sample avg dev_std = 0.311)
NEC for r=0.2 class 1.0 = 0.806 +- 0.445 (in-sample avg dev_std = 0.311)
NEC for r=0.2 all KL = 0.555 +- 0.445 (in-sample avg dev_std = 0.311)
NEC for r=0.2 all L1 = 0.501 +- 0.365 (in-sample avg dev_std = 0.311)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.41751
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.544
NEC for r=0.4 class 0.0 = 0.135 +- 0.430 (in-sample avg dev_std = 0.454)
NEC for r=0.4 class 1.0 = 0.764 +- 0.430 (in-sample avg dev_std = 0.454)
NEC for r=0.4 all KL = 0.549 +- 0.430 (in-sample avg dev_std = 0.454)
NEC for r=0.4 all L1 = 0.484 +- 0.344 (in-sample avg dev_std = 0.454)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.36093000000000003
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.6
NEC for r=0.8 class 0.0 = 0.159 +- 0.404 (in-sample avg dev_std = 0.523)
NEC for r=0.8 class 1.0 = 0.699 +- 0.404 (in-sample avg dev_std = 0.523)
NEC for r=0.8 all KL = 0.534 +- 0.404 (in-sample avg dev_std = 0.523)
NEC for r=0.8 all L1 = 0.458 +- 0.314 (in-sample avg dev_std = 0.523)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3449662
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22476139999999994
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.002 +- 0.171 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.169 +- 0.171 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.066 +- 0.171 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459654
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.002 +- 0.171 (in-sample avg dev_std = 0.017)
NEC for r=0.2 class 1.0 = 0.169 +- 0.171 (in-sample avg dev_std = 0.017)
NEC for r=0.2 all KL = 0.066 +- 0.171 (in-sample avg dev_std = 0.017)
NEC for r=0.2 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.017)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10206439999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.013)
NEC for r=0.4 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.013)
NEC for r=0.4 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.013)
NEC for r=0.4 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.013)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08663779999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.015)
NEC for r=0.8 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.015)
NEC for r=0.8 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.015)
NEC for r=0.8 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.015)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5557373999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.534
NEC for r=0.05 class 0.0 = 0.326 +- 0.461 (in-sample avg dev_std = 0.057)
NEC for r=0.05 class 1.0 = 0.742 +- 0.461 (in-sample avg dev_std = 0.057)
NEC for r=0.05 all KL = 0.61 +- 0.461 (in-sample avg dev_std = 0.057)
NEC for r=0.05 all L1 = 0.532 +- 0.390 (in-sample avg dev_std = 0.057)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5918868
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.523
NEC for r=0.1 class 0.0 = 0.325 +- 0.458 (in-sample avg dev_std = 0.301)
NEC for r=0.1 class 1.0 = 0.757 +- 0.458 (in-sample avg dev_std = 0.301)
NEC for r=0.1 all KL = 0.626 +- 0.458 (in-sample avg dev_std = 0.301)
NEC for r=0.1 all L1 = 0.538 +- 0.381 (in-sample avg dev_std = 0.301)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6069532
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.554
NEC for r=0.2 class 0.0 = 0.305 +- 0.445 (in-sample avg dev_std = 0.476)
NEC for r=0.2 class 1.0 = 0.702 +- 0.445 (in-sample avg dev_std = 0.476)
NEC for r=0.2 all KL = 0.613 +- 0.445 (in-sample avg dev_std = 0.476)
NEC for r=0.2 all L1 = 0.501 +- 0.358 (in-sample avg dev_std = 0.476)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6120368
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.604
NEC for r=0.4 class 0.0 = 0.27 +- 0.421 (in-sample avg dev_std = 0.542)
NEC for r=0.4 class 1.0 = 0.597 +- 0.421 (in-sample avg dev_std = 0.542)
NEC for r=0.4 all KL = 0.561 +- 0.421 (in-sample avg dev_std = 0.542)
NEC for r=0.4 all L1 = 0.432 +- 0.331 (in-sample avg dev_std = 0.542)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6086604
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.642
NEC for r=0.8 class 0.0 = 0.246 +- 0.389 (in-sample avg dev_std = 0.547)
NEC for r=0.8 class 1.0 = 0.482 +- 0.389 (in-sample avg dev_std = 0.547)
NEC for r=0.8 all KL = 0.496 +- 0.389 (in-sample avg dev_std = 0.547)
NEC for r=0.8 all L1 = 0.362 +- 0.302 (in-sample avg dev_std = 0.547)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 16:17:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 04:17:20 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 04:17:20 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:17:20 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 04:17:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:17:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:17:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:17:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:17:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:17:20 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:17:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mChartInfo 0.9680 0.9680 0.9680 0.9680 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.570
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.615
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.591
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.537
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.487
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.427
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.297
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.204
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.151
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.132
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.577
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.617
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.634
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.638
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.637


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.570182
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.679
SUFF_SIMPLE for r=0.05 class 0.0 = 0.727 +- 0.385 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.503 +- 0.385 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.05 all KL = 0.482 +- 0.385 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.05 all L1 = 0.603 +- 0.295 (in-sample avg dev_std = 0.608)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6153200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.655
SUFF_SIMPLE for r=0.1 class 0.0 = 0.703 +- 0.385 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.503 +- 0.385 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.1 all KL = 0.479 +- 0.385 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.1 all L1 = 0.593 +- 0.304 (in-sample avg dev_std = 0.582)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.591372
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.627
SUFF_SIMPLE for r=0.2 class 0.0 = 0.702 +- 0.397 (in-sample avg dev_std = 0.585)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.466 +- 0.397 (in-sample avg dev_std = 0.585)
SUFF_SIMPLE for r=0.2 all KL = 0.456 +- 0.397 (in-sample avg dev_std = 0.585)
SUFF_SIMPLE for r=0.2 all L1 = 0.571 +- 0.312 (in-sample avg dev_std = 0.585)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537098
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.595
SUFF_SIMPLE for r=0.4 class 0.0 = 0.705 +- 0.411 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.423 +- 0.411 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.4 all KL = 0.444 +- 0.411 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.4 all L1 = 0.549 +- 0.324 (in-sample avg dev_std = 0.554)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.486506
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.625
SUFF_SIMPLE for r=0.8 class 0.0 = 0.833 +- 0.444 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.442 +- 0.444 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.8 all KL = 0.57 +- 0.444 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.8 all L1 = 0.616 +- 0.372 (in-sample avg dev_std = 0.257)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4265934
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.206 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.837 +- 0.206 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.05 all KL = 0.927 +- 0.206 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.05 all L1 = 0.917 +- 0.211 (in-sample avg dev_std = 0.073)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.296979
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.205 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.836 +- 0.205 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.1 all KL = 0.928 +- 0.205 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.1 all L1 = 0.917 +- 0.211 (in-sample avg dev_std = 0.060)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.204242
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.205 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.836 +- 0.205 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.2 all KL = 0.928 +- 0.205 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.2 all L1 = 0.917 +- 0.212 (in-sample avg dev_std = 0.044)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1510458
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.205 (in-sample avg dev_std = 0.026)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.836 +- 0.205 (in-sample avg dev_std = 0.026)
SUFF_SIMPLE for r=0.4 all KL = 0.928 +- 0.205 (in-sample avg dev_std = 0.026)
SUFF_SIMPLE for r=0.4 all L1 = 0.917 +- 0.212 (in-sample avg dev_std = 0.026)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1320686
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.836 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.928 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.917 +- 0.212 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5766038
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.699
SUFF_SIMPLE for r=0.05 class 0.0 = 0.746 +- 0.393 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.834 +- 0.393 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.05 all KL = 0.74 +- 0.393 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.05 all L1 = 0.789 +- 0.318 (in-sample avg dev_std = 0.362)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6165012
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.698
SUFF_SIMPLE for r=0.1 class 0.0 = 0.737 +- 0.387 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.852 +- 0.387 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.1 all KL = 0.757 +- 0.387 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.1 all L1 = 0.794 +- 0.326 (in-sample avg dev_std = 0.290)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6341762000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.689
SUFF_SIMPLE for r=0.2 class 0.0 = 0.744 +- 0.390 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.838 +- 0.390 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.2 all KL = 0.757 +- 0.390 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.2 all L1 = 0.79 +- 0.332 (in-sample avg dev_std = 0.243)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6379336
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.684
SUFF_SIMPLE for r=0.4 class 0.0 = 0.765 +- 0.396 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.809 +- 0.396 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 all KL = 0.76 +- 0.396 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 all L1 = 0.787 +- 0.339 (in-sample avg dev_std = 0.186)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6368773999999999
len(reference) = 4936
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.748
SUFF_SIMPLE for r=0.8 class 0.0 = 0.869 +- 0.289 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.906 +- 0.289 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.8 all KL = 0.883 +- 0.289 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.8 all L1 = 0.888 +- 0.259 (in-sample avg dev_std = 0.021)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.570182
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.54
NEC for r=0.05 class 0.0 = 0.081 +- 0.470 (in-sample avg dev_std = 0.007)
NEC for r=0.05 class 1.0 = 0.701 +- 0.470 (in-sample avg dev_std = 0.007)
NEC for r=0.05 all KL = 0.47 +- 0.470 (in-sample avg dev_std = 0.007)
NEC for r=0.05 all L1 = 0.425 +- 0.399 (in-sample avg dev_std = 0.007)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6153200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.573
NEC for r=0.1 class 0.0 = 0.077 +- 0.458 (in-sample avg dev_std = 0.419)
NEC for r=0.1 class 1.0 = 0.715 +- 0.458 (in-sample avg dev_std = 0.419)
NEC for r=0.1 all KL = 0.503 +- 0.458 (in-sample avg dev_std = 0.419)
NEC for r=0.1 all L1 = 0.43 +- 0.371 (in-sample avg dev_std = 0.419)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.591372
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.695
NEC for r=0.2 class 0.0 = 0.086 +- 0.412 (in-sample avg dev_std = 0.524)
NEC for r=0.2 class 1.0 = 0.549 +- 0.412 (in-sample avg dev_std = 0.524)
NEC for r=0.2 all KL = 0.433 +- 0.412 (in-sample avg dev_std = 0.524)
NEC for r=0.2 all L1 = 0.343 +- 0.320 (in-sample avg dev_std = 0.524)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537098
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.79
NEC for r=0.4 class 0.0 = 0.104 +- 0.371 (in-sample avg dev_std = 0.532)
NEC for r=0.4 class 1.0 = 0.395 +- 0.371 (in-sample avg dev_std = 0.532)
NEC for r=0.4 all KL = 0.351 +- 0.371 (in-sample avg dev_std = 0.532)
NEC for r=0.4 all L1 = 0.265 +- 0.269 (in-sample avg dev_std = 0.532)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.486506
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.845
NEC for r=0.8 class 0.0 = 0.149 +- 0.324 (in-sample avg dev_std = 0.513)
NEC for r=0.8 class 1.0 = 0.281 +- 0.324 (in-sample avg dev_std = 0.513)
NEC for r=0.8 all KL = 0.302 +- 0.324 (in-sample avg dev_std = 0.513)
NEC for r=0.8 all L1 = 0.222 +- 0.225 (in-sample avg dev_std = 0.513)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4265934
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.163 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.072 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.083 +- 0.212 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.296979
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.003 +- 0.204 (in-sample avg dev_std = 0.042)
NEC for r=0.1 class 1.0 = 0.163 +- 0.204 (in-sample avg dev_std = 0.042)
NEC for r=0.1 all KL = 0.073 +- 0.204 (in-sample avg dev_std = 0.042)
NEC for r=0.1 all L1 = 0.084 +- 0.211 (in-sample avg dev_std = 0.042)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.204242
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.522
NEC for r=0.2 class 0.0 = 0.005 +- 0.207 (in-sample avg dev_std = 0.208)
NEC for r=0.2 class 1.0 = 0.177 +- 0.207 (in-sample avg dev_std = 0.208)
NEC for r=0.2 all KL = 0.093 +- 0.207 (in-sample avg dev_std = 0.208)
NEC for r=0.2 all L1 = 0.092 +- 0.200 (in-sample avg dev_std = 0.208)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1510458
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.53
NEC for r=0.4 class 0.0 = 0.006 +- 0.189 (in-sample avg dev_std = 0.215)
NEC for r=0.4 class 1.0 = 0.162 +- 0.189 (in-sample avg dev_std = 0.215)
NEC for r=0.4 all KL = 0.084 +- 0.189 (in-sample avg dev_std = 0.215)
NEC for r=0.4 all L1 = 0.084 +- 0.184 (in-sample avg dev_std = 0.215)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1320686
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.515
NEC for r=0.8 class 0.0 = 0.003 +- 0.184 (in-sample avg dev_std = 0.169)
NEC for r=0.8 class 1.0 = 0.155 +- 0.184 (in-sample avg dev_std = 0.169)
NEC for r=0.8 all KL = 0.071 +- 0.184 (in-sample avg dev_std = 0.169)
NEC for r=0.8 all L1 = 0.08 +- 0.190 (in-sample avg dev_std = 0.169)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5766038
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.549
NEC for r=0.05 class 0.0 = 0.334 +- 0.471 (in-sample avg dev_std = 0.229)
NEC for r=0.05 class 1.0 = 0.689 +- 0.471 (in-sample avg dev_std = 0.229)
NEC for r=0.05 all KL = 0.595 +- 0.471 (in-sample avg dev_std = 0.229)
NEC for r=0.05 all L1 = 0.509 +- 0.395 (in-sample avg dev_std = 0.229)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6165012
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.562
NEC for r=0.1 class 0.0 = 0.305 +- 0.456 (in-sample avg dev_std = 0.454)
NEC for r=0.1 class 1.0 = 0.649 +- 0.456 (in-sample avg dev_std = 0.454)
NEC for r=0.1 all KL = 0.585 +- 0.456 (in-sample avg dev_std = 0.454)
NEC for r=0.1 all L1 = 0.475 +- 0.373 (in-sample avg dev_std = 0.454)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6341762000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.596
NEC for r=0.2 class 0.0 = 0.253 +- 0.433 (in-sample avg dev_std = 0.550)
NEC for r=0.2 class 1.0 = 0.547 +- 0.433 (in-sample avg dev_std = 0.550)
NEC for r=0.2 all KL = 0.527 +- 0.433 (in-sample avg dev_std = 0.550)
NEC for r=0.2 all L1 = 0.398 +- 0.344 (in-sample avg dev_std = 0.550)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6379336
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.65
NEC for r=0.4 class 0.0 = 0.209 +- 0.403 (in-sample avg dev_std = 0.549)
NEC for r=0.4 class 1.0 = 0.402 +- 0.403 (in-sample avg dev_std = 0.549)
NEC for r=0.4 all KL = 0.429 +- 0.403 (in-sample avg dev_std = 0.549)
NEC for r=0.4 all L1 = 0.304 +- 0.309 (in-sample avg dev_std = 0.549)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6368773999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.699
NEC for r=0.8 class 0.0 = 0.23 +- 0.381 (in-sample avg dev_std = 0.520)
NEC for r=0.8 class 1.0 = 0.269 +- 0.381 (in-sample avg dev_std = 0.520)
NEC for r=0.8 all KL = 0.367 +- 0.381 (in-sample avg dev_std = 0.520)
NEC for r=0.8 all L1 = 0.249 +- 0.282 (in-sample avg dev_std = 0.520)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.469, 0.473, 0.474, 0.462, 0.516], 'all_L1': [0.553, 0.547, 0.543, 0.52, 0.545]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.417, 0.406, 0.416, 0.529], 'all_L1': [0.532, 0.542, 0.532, 0.526, 0.582]}), defaultdict(<class 'list'>, {'all_KL': [0.464, 0.477, 0.47, 0.481, 0.543], 'all_L1': [0.562, 0.572, 0.575, 0.57, 0.585]}), defaultdict(<class 'list'>, {'all_KL': [0.459, 0.475, 0.463, 0.458, 0.543], 'all_L1': [0.54, 0.55, 0.54, 0.526, 0.581]}), defaultdict(<class 'list'>, {'all_KL': [0.45, 0.468, 0.466, 0.456, 0.527], 'all_L1': [0.529, 0.544, 0.541, 0.527, 0.562]}), defaultdict(<class 'list'>, {'all_KL': [0.439, 0.442, 0.456, 0.443, 0.481], 'all_L1': [0.481, 0.482, 0.497, 0.483, 0.505]}), defaultdict(<class 'list'>, {'all_KL': [0.504, 0.509, 0.503, 0.481, 0.541], 'all_L1': [0.57, 0.58, 0.575, 0.553, 0.575]}), defaultdict(<class 'list'>, {'all_KL': [0.471, 0.47, 0.483, 0.482, 0.499], 'all_L1': [0.477, 0.477, 0.49, 0.487, 0.499]}), defaultdict(<class 'list'>, {'all_KL': [0.418, 0.415, 0.419, 0.453, 0.526], 'all_L1': [0.489, 0.486, 0.492, 0.509, 0.555]}), defaultdict(<class 'list'>, {'all_KL': [0.482, 0.479, 0.456, 0.444, 0.57], 'all_L1': [0.603, 0.593, 0.571, 0.549, 0.616]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.489, 0.503, 0.414, 0.329, 0.332], 'all_L1': [0.447, 0.453, 0.364, 0.287, 0.288]}), defaultdict(<class 'list'>, {'all_KL': [0.567, 0.582, 0.578, 0.558, 0.546], 'all_L1': [0.502, 0.51, 0.478, 0.436, 0.405]}), defaultdict(<class 'list'>, {'all_KL': [0.534, 0.555, 0.549, 0.52, 0.467], 'all_L1': [0.479, 0.492, 0.472, 0.425, 0.367]}), defaultdict(<class 'list'>, {'all_KL': [0.548, 0.562, 0.551, 0.524, 0.495], 'all_L1': [0.497, 0.508, 0.488, 0.443, 0.402]}), defaultdict(<class 'list'>, {'all_KL': [0.548, 0.55, 0.545, 0.532, 0.505], 'all_L1': [0.502, 0.5, 0.491, 0.462, 0.418]}), defaultdict(<class 'list'>, {'all_KL': [0.533, 0.546, 0.543, 0.537, 0.514], 'all_L1': [0.497, 0.513, 0.51, 0.497, 0.47]}), defaultdict(<class 'list'>, {'all_KL': [0.542, 0.542, 0.532, 0.507, 0.469], 'all_L1': [0.491, 0.49, 0.478, 0.437, 0.393]}), defaultdict(<class 'list'>, {'all_KL': [0.513, 0.522, 0.527, 0.495, 0.458], 'all_L1': [0.503, 0.511, 0.515, 0.485, 0.455]}), defaultdict(<class 'list'>, {'all_KL': [0.548, 0.556, 0.555, 0.549, 0.534], 'all_L1': [0.501, 0.509, 0.501, 0.484, 0.458]}), defaultdict(<class 'list'>, {'all_KL': [0.47, 0.503, 0.433, 0.351, 0.302], 'all_L1': [0.425, 0.43, 0.343, 0.265, 0.222]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.935, 0.935, 0.936, 0.935, 0.936], 'all_L1': [0.919, 0.919, 0.919, 0.919, 0.919]}), defaultdict(<class 'list'>, {'all_KL': [0.905, 0.907, 0.908, 0.911, 0.913], 'all_L1': [0.901, 0.902, 0.902, 0.903, 0.903]}), defaultdict(<class 'list'>, {'all_KL': [0.927, 0.927, 0.928, 0.928, 0.928], 'all_L1': [0.921, 0.921, 0.922, 0.921, 0.921]}), defaultdict(<class 'list'>, {'all_KL': [0.953, 0.953, 0.953, 0.953, 0.953], 'all_L1': [0.944, 0.944, 0.944, 0.944, 0.944]}), defaultdict(<class 'list'>, {'all_KL': [0.926, 0.926, 0.926, 0.926, 0.926], 'all_L1': [0.91, 0.91, 0.91, 0.91, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.968, 0.968, 0.968, 0.968, 0.968], 'all_L1': [0.954, 0.954, 0.954, 0.954, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.964, 0.964, 0.964, 0.964, 0.964], 'all_L1': [0.954, 0.954, 0.954, 0.954, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.939, 0.939, 0.939, 0.939, 0.939], 'all_L1': [0.914, 0.914, 0.914, 0.914, 0.914]}), defaultdict(<class 'list'>, {'all_KL': [0.934, 0.934, 0.934, 0.934, 0.934], 'all_L1': [0.914, 0.914, 0.914, 0.914, 0.914]}), defaultdict(<class 'list'>, {'all_KL': [0.927, 0.928, 0.928, 0.928, 0.928], 'all_L1': [0.917, 0.917, 0.917, 0.917, 0.917]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.063, 0.063, 0.062, 0.057, 0.058], 'all_L1': [0.081, 0.081, 0.08, 0.076, 0.077]}), defaultdict(<class 'list'>, {'all_KL': [0.088, 0.091, 0.101, 0.098, 0.096], 'all_L1': [0.097, 0.098, 0.102, 0.1, 0.099]}), defaultdict(<class 'list'>, {'all_KL': [0.077, 0.079, 0.084, 0.08, 0.074], 'all_L1': [0.083, 0.084, 0.084, 0.081, 0.078]}), defaultdict(<class 'list'>, {'all_KL': [0.047, 0.047, 0.049, 0.046, 0.046], 'all_L1': [0.056, 0.057, 0.057, 0.055, 0.055]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.072, 0.077, 0.075, 0.073], 'all_L1': [0.09, 0.09, 0.092, 0.09, 0.089]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.031, 0.032, 0.032, 0.032], 'all_L1': [0.046, 0.046, 0.046, 0.046, 0.046]}), defaultdict(<class 'list'>, {'all_KL': [0.036, 0.036, 0.036, 0.036, 0.036], 'all_L1': [0.046, 0.046, 0.046, 0.045, 0.045]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.057, 0.061, 0.061, 0.061], 'all_L1': [0.085, 0.085, 0.086, 0.086, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.066, 0.066, 0.066, 0.066, 0.066], 'all_L1': [0.086, 0.086, 0.086, 0.086, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.073, 0.093, 0.084, 0.071], 'all_L1': [0.083, 0.084, 0.092, 0.084, 0.08]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.718, 0.737, 0.758, 0.767, 0.877], 'all_L1': [0.756, 0.765, 0.778, 0.776, 0.865]}), defaultdict(<class 'list'>, {'all_KL': [0.58, 0.633, 0.688, 0.729, 0.867], 'all_L1': [0.712, 0.735, 0.756, 0.772, 0.872]}), defaultdict(<class 'list'>, {'all_KL': [0.734, 0.75, 0.76, 0.763, 0.868], 'all_L1': [0.76, 0.77, 0.775, 0.776, 0.863]}), defaultdict(<class 'list'>, {'all_KL': [0.6, 0.635, 0.669, 0.683, 0.827], 'all_L1': [0.692, 0.711, 0.731, 0.736, 0.837]}), defaultdict(<class 'list'>, {'all_KL': [0.641, 0.694, 0.745, 0.759, 0.873], 'all_L1': [0.7, 0.732, 0.762, 0.77, 0.861]}), defaultdict(<class 'list'>, {'all_KL': [0.738, 0.764, 0.792, 0.803, 0.894], 'all_L1': [0.773, 0.786, 0.797, 0.802, 0.879]}), defaultdict(<class 'list'>, {'all_KL': [0.775, 0.779, 0.77, 0.774, 0.879], 'all_L1': [0.79, 0.794, 0.787, 0.789, 0.876]}), defaultdict(<class 'list'>, {'all_KL': [0.765, 0.776, 0.779, 0.779, 0.878], 'all_L1': [0.732, 0.74, 0.738, 0.737, 0.824]}), defaultdict(<class 'list'>, {'all_KL': [0.683, 0.714, 0.738, 0.758, 0.889], 'all_L1': [0.742, 0.756, 0.768, 0.778, 0.885]}), defaultdict(<class 'list'>, {'all_KL': [0.74, 0.757, 0.757, 0.76, 0.883], 'all_L1': [0.789, 0.794, 0.79, 0.787, 0.888]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.554, 0.525, 0.448, 0.332, 0.286], 'all_L1': [0.503, 0.47, 0.395, 0.291, 0.241]}), defaultdict(<class 'list'>, {'all_KL': [0.623, 0.626, 0.615, 0.583, 0.544], 'all_L1': [0.533, 0.517, 0.475, 0.41, 0.353]}), defaultdict(<class 'list'>, {'all_KL': [0.576, 0.586, 0.57, 0.514, 0.44], 'all_L1': [0.515, 0.507, 0.464, 0.395, 0.325]}), defaultdict(<class 'list'>, {'all_KL': [0.609, 0.613, 0.596, 0.548, 0.529], 'all_L1': [0.529, 0.528, 0.503, 0.444, 0.403]}), defaultdict(<class 'list'>, {'all_KL': [0.582, 0.59, 0.576, 0.538, 0.522], 'all_L1': [0.518, 0.521, 0.503, 0.456, 0.412]}), defaultdict(<class 'list'>, {'all_KL': [0.578, 0.594, 0.579, 0.525, 0.47], 'all_L1': [0.528, 0.54, 0.515, 0.451, 0.377]}), defaultdict(<class 'list'>, {'all_KL': [0.624, 0.627, 0.613, 0.566, 0.495], 'all_L1': [0.552, 0.549, 0.518, 0.452, 0.375]}), defaultdict(<class 'list'>, {'all_KL': [0.438, 0.458, 0.467, 0.448, 0.394], 'all_L1': [0.459, 0.47, 0.472, 0.448, 0.389]}), defaultdict(<class 'list'>, {'all_KL': [0.61, 0.626, 0.613, 0.561, 0.496], 'all_L1': [0.532, 0.538, 0.501, 0.432, 0.362]}), defaultdict(<class 'list'>, {'all_KL': [0.595, 0.585, 0.527, 0.429, 0.367], 'all_L1': [0.509, 0.475, 0.398, 0.304, 0.249]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.534 +- 0.039, 0.537 +- 0.040, 0.536 +- 0.032, 0.525 +- 0.026, 0.560 +- 0.035
suff_simple class all_KL  =  0.456 +- 0.028, 0.463 +- 0.028, 0.460 +- 0.027, 0.458 +- 0.020, 0.528 +- 0.024
[[0.6200000047683716, 0.6002500057220459, 0.5867499709129333, 0.5410000085830688, 0.5402500033378601], [0.5845000147819519, 0.593999981880188, 0.5912500023841858, 0.5727499723434448, 0.5914999842643738], [0.6100000143051147, 0.6227499842643738, 0.6267499923706055, 0.6119999885559082, 0.578499972820282], [0.590499997138977, 0.5985000133514404, 0.5887500047683716, 0.5587499737739563, 0.5982499718666077], [0.5747500061988831, 0.5960000157356262, 0.5929999947547913, 0.5649999976158142, 0.565750002861023], [0.47824999690055847, 0.4779999852180481, 0.5019999742507935, 0.4740000069141388, 0.4832499921321869], [0.609000027179718, 0.628000020980835, 0.6257500052452087, 0.5862500071525574, 0.5677499771118164], [0.48350000381469727, 0.48500001430511475, 0.5062500238418579, 0.49050000309944153, 0.49175000190734863], [0.5254999995231628, 0.5197499990463257, 0.5257499814033508, 0.5329999923706055, 0.5587499737739563], [0.6794999837875366, 0.6549999713897705, 0.6272500157356262, 0.5952500104904175, 0.625249981880188]]
[[0.469, 0.473, 0.474, 0.462, 0.516], [0.405, 0.417, 0.406, 0.416, 0.529], [0.464, 0.477, 0.47, 0.481, 0.543], [0.459, 0.475, 0.463, 0.458, 0.543], [0.45, 0.468, 0.466, 0.456, 0.527], [0.439, 0.442, 0.456, 0.443, 0.481], [0.504, 0.509, 0.503, 0.481, 0.541], [0.471, 0.47, 0.483, 0.482, 0.499], [0.418, 0.415, 0.419, 0.453, 0.526], [0.482, 0.479, 0.456, 0.444, 0.57]]
suff_simple_acc_int  =  0.576 +- 0.060, 0.578 +- 0.058, 0.577 +- 0.046, 0.553 +- 0.042, 0.560 +- 0.043
nec class all_L1  =  0.484 +- 0.026, 0.492 +- 0.027, 0.464 +- 0.057, 0.422 +- 0.077, 0.388 +- 0.075
nec class all_KL  =  0.529 +- 0.028, 0.542 +- 0.024, 0.523 +- 0.051, 0.490 +- 0.077, 0.462 +- 0.078
[[0.5320000052452087, 0.5372499823570251, 0.6765000224113464, 0.7760000228881836, 0.7904999852180481], [0.4632500112056732, 0.47749999165534973, 0.546999990940094, 0.6205000281333923, 0.6742500066757202], [0.4724999964237213, 0.47099998593330383, 0.531499981880188, 0.6082500219345093, 0.6924999952316284], [0.45875000953674316, 0.4502499997615814, 0.4937500059604645, 0.5820000171661377, 0.6637499928474426], [0.4417499899864197, 0.45750001072883606, 0.4832499921321869, 0.5615000128746033, 0.6455000042915344], [0.4672499895095825, 0.44600000977516174, 0.46399998664855957, 0.5099999904632568, 0.5577499866485596], [0.4482499957084656, 0.453000009059906, 0.4857499897480011, 0.5789999961853027, 0.6549999713897705], [0.4560000002384186, 0.4542500078678131, 0.4699999988079071, 0.5377500057220459, 0.5942500233650208], [0.46299999952316284, 0.46825000643730164, 0.492000013589859, 0.5444999933242798, 0.5997499823570251], [0.5400000214576721, 0.5727499723434448, 0.6947500109672546, 0.7900000214576721, 0.8454999923706055]]
[[0.489, 0.503, 0.414, 0.329, 0.332], [0.567, 0.582, 0.578, 0.558, 0.546], [0.534, 0.555, 0.549, 0.52, 0.467], [0.548, 0.562, 0.551, 0.524, 0.495], [0.548, 0.55, 0.545, 0.532, 0.505], [0.533, 0.546, 0.543, 0.537, 0.514], [0.542, 0.542, 0.532, 0.507, 0.469], [0.513, 0.522, 0.527, 0.495, 0.458], [0.548, 0.556, 0.555, 0.549, 0.534], [0.47, 0.503, 0.433, 0.351, 0.302]]
nec_acc_int  =  0.474 +- 0.032, 0.479 +- 0.040, 0.534 +- 0.080, 0.611 +- 0.091, 0.672 +- 0.084

Eval split val
suff_simple class all_L1  =  0.925 +- 0.018, 0.925 +- 0.018, 0.925 +- 0.018, 0.925 +- 0.018, 0.925 +- 0.018
suff_simple class all_KL  =  0.938 +- 0.018, 0.938 +- 0.018, 0.938 +- 0.018, 0.939 +- 0.017, 0.939 +- 0.017
[[0.4966750144958496, 0.49639999866485596, 0.4961250126361847, 0.4960249960422516, 0.4959999918937683], [0.503350019454956, 0.5024250149726868, 0.5002250075340271, 0.49777498841285706, 0.49605000019073486], [0.4991999864578247, 0.49924999475479126, 0.49822500348091125, 0.49662500619888306, 0.4959999918937683], [0.49617499113082886, 0.4960249960422516, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4961499869823456, 0.4960249960422516, 0.4961000084877014, 0.4959999918937683, 0.4959999918937683], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.49605000019073486, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4959999918937683, 0.4961000084877014, 0.49605000019073486, 0.4959999918937683, 0.4959999918937683], [0.49764999747276306, 0.4973750114440918, 0.4966999888420105, 0.49642500281333923, 0.4959999918937683]]
[[0.935, 0.935, 0.936, 0.935, 0.936], [0.905, 0.907, 0.908, 0.911, 0.913], [0.927, 0.927, 0.928, 0.928, 0.928], [0.953, 0.953, 0.953, 0.953, 0.953], [0.926, 0.926, 0.926, 0.926, 0.926], [0.968, 0.968, 0.968, 0.968, 0.968], [0.964, 0.964, 0.964, 0.964, 0.964], [0.939, 0.939, 0.939, 0.939, 0.939], [0.934, 0.934, 0.934, 0.934, 0.934], [0.927, 0.928, 0.928, 0.928, 0.928]]
suff_simple_acc_int  =  0.497 +- 0.002, 0.497 +- 0.002, 0.497 +- 0.001, 0.496 +- 0.001, 0.496 +- 0.000
nec class all_L1  =  0.075 +- 0.018, 0.076 +- 0.018, 0.077 +- 0.019, 0.075 +- 0.018, 0.074 +- 0.018
nec class all_KL  =  0.061 +- 0.017, 0.061 +- 0.018, 0.066 +- 0.022, 0.063 +- 0.020, 0.061 +- 0.018
[[0.4959999918937683, 0.49627500772476196, 0.5091750025749207, 0.5134249925613403, 0.5033249855041504], [0.49900001287460327, 0.498324990272522, 0.5007249712944031, 0.5055249929428101, 0.5078999996185303], [0.4952000081539154, 0.5013750195503235, 0.4988499879837036, 0.5044500231742859, 0.5076249837875366], [0.4959999918937683, 0.49595001339912415, 0.49627500772476196, 0.4985249936580658, 0.498199999332428], [0.49639999866485596, 0.49652498960494995, 0.4961000084877014, 0.4978500008583069, 0.49935001134872437], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.49607500433921814, 0.49605000019073486], [0.4957999885082245, 0.49619999527931213, 0.4961499869823456, 0.4965749979019165, 0.49674999713897705], [0.4959999918937683, 0.4959999918937683, 0.49607500433921814, 0.4961250126361847, 0.4960249960422516], [0.4959999918937683, 0.4959999918937683, 0.49605000019073486, 0.4960249960422516, 0.4961000084877014], [0.49559998512268066, 0.4962249994277954, 0.5223249793052673, 0.5295500159263611, 0.5147500038146973]]
[[0.063, 0.063, 0.062, 0.057, 0.058], [0.088, 0.091, 0.101, 0.098, 0.096], [0.077, 0.079, 0.084, 0.08, 0.074], [0.047, 0.047, 0.049, 0.046, 0.046], [0.072, 0.072, 0.077, 0.075, 0.073], [0.031, 0.031, 0.032, 0.032, 0.032], [0.036, 0.036, 0.036, 0.036, 0.036], [0.058, 0.057, 0.061, 0.061, 0.061], [0.066, 0.066, 0.066, 0.066, 0.066], [0.072, 0.073, 0.093, 0.084, 0.071]]
nec_acc_int  =  0.496 +- 0.001, 0.497 +- 0.002, 0.501 +- 0.008, 0.503 +- 0.010, 0.502 +- 0.006

Eval split test
suff_simple class all_L1  =  0.745 +- 0.033, 0.758 +- 0.027, 0.768 +- 0.021, 0.772 +- 0.020, 0.865 +- 0.019
suff_simple class all_KL  =  0.697 +- 0.065, 0.724 +- 0.051, 0.746 +- 0.037, 0.758 +- 0.030, 0.874 +- 0.017
[[0.6901390552520752, 0.6917400360107422, 0.6919651627540588, 0.6820592284202576, 0.7282935380935669], [0.6461126804351807, 0.6526666283607483, 0.6490644216537476, 0.6533420085906982, 0.7071917653083801], [0.6863868236541748, 0.6880127787590027, 0.6931408643722534, 0.6870872378349304, 0.7349618673324585], [0.6389833688735962, 0.6442365646362305, 0.6365819573402405, 0.6352811455726624, 0.6711759567260742], [0.6570942401885986, 0.664248526096344, 0.6631478667259216, 0.6631228923797607, 0.7050151228904724], [0.666700005531311, 0.6679507493972778, 0.6714779138565063, 0.6715529561042786, 0.699353039264679], [0.6828346848487854, 0.6868370771408081, 0.6864118576049805, 0.6841855049133301, 0.7239677309989929], [0.610166072845459, 0.6123424172401428, 0.6241495013237, 0.6215479373931885, 0.6619415879249573], [0.6527916789054871, 0.6583700180053711, 0.6630978584289551, 0.6702021360397339, 0.7387623190879822], [0.6990194320678711, 0.6977686882019043, 0.6893386244773865, 0.6835601329803467, 0.7482272982597351]]
[[0.718, 0.737, 0.758, 0.767, 0.877], [0.58, 0.633, 0.688, 0.729, 0.867], [0.734, 0.75, 0.76, 0.763, 0.868], [0.6, 0.635, 0.669, 0.683, 0.827], [0.641, 0.694, 0.745, 0.759, 0.873], [0.738, 0.764, 0.792, 0.803, 0.894], [0.775, 0.779, 0.77, 0.774, 0.879], [0.765, 0.776, 0.779, 0.779, 0.878], [0.683, 0.714, 0.738, 0.758, 0.889], [0.74, 0.757, 0.757, 0.76, 0.883]]
suff_simple_acc_int  =  0.663 +- 0.026, 0.666 +- 0.025, 0.667 +- 0.023, 0.665 +- 0.021, 0.712 +- 0.027
nec class all_L1  =  0.518 +- 0.024, 0.512 +- 0.028, 0.474 +- 0.043, 0.408 +- 0.059, 0.349 +- 0.057
nec class all_KL  =  0.579 +- 0.052, 0.583 +- 0.051, 0.560 +- 0.057, 0.504 +- 0.074, 0.454 +- 0.079
[[0.5510806441307068, 0.5647138357162476, 0.5971583127975464, 0.659795880317688, 0.7027466297149658], [0.523739218711853, 0.5569841861724854, 0.5992595553398132, 0.6409845948219299, 0.6634981036186218], [0.5325945615768433, 0.5601860880851746, 0.6061136722564697, 0.6470882296562195, 0.6820842623710632], [0.5189864039421082, 0.5232139229774475, 0.5478036999702454, 0.5903291702270508, 0.6211727261543274], [0.5227136015892029, 0.527616560459137, 0.5471532940864563, 0.5845007300376892, 0.623874306678772], [0.5354962944984436, 0.5238392949104309, 0.5341454744338989, 0.5767960548400879, 0.6347058415412903], [0.5148839354515076, 0.5167850852012634, 0.5389233827590942, 0.5830498337745667, 0.6274765133857727], [0.5382979512214661, 0.5366719961166382, 0.5330448150634766, 0.5303182005882263, 0.5533570051193237], [0.5343706011772156, 0.5233640074729919, 0.5539823770523071, 0.6039623618125916, 0.642110288143158], [0.5492295622825623, 0.5621622800827026, 0.5961576700210571, 0.65034019947052, 0.6990694403648376]]
[[0.554, 0.525, 0.448, 0.332, 0.286], [0.623, 0.626, 0.615, 0.583, 0.544], [0.576, 0.586, 0.57, 0.514, 0.44], [0.609, 0.613, 0.596, 0.548, 0.529], [0.582, 0.59, 0.576, 0.538, 0.522], [0.578, 0.594, 0.579, 0.525, 0.47], [0.624, 0.627, 0.613, 0.566, 0.495], [0.438, 0.458, 0.467, 0.448, 0.394], [0.61, 0.626, 0.613, 0.561, 0.496], [0.595, 0.585, 0.527, 0.429, 0.367]]
nec_acc_int  =  0.532 +- 0.012, 0.540 +- 0.018, 0.565 +- 0.029, 0.607 +- 0.039, 0.645 +- 0.042


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.509 +- 0.014, 0.514 +- 0.015, 0.500 +- 0.024, 0.474 +- 0.035, 0.474 +- 0.029
Faith. Armon (L1)= 		  =  0.506 +- 0.013, 0.512 +- 0.016, 0.494 +- 0.032, 0.462 +- 0.050, 0.452 +- 0.053
Faith. GMean (L1)= 	  =  0.508 +- 0.013, 0.513 +- 0.015, 0.497 +- 0.028, 0.468 +- 0.042, 0.463 +- 0.041
Faith. Aritm (KL)= 		  =  0.493 +- 0.013, 0.502 +- 0.013, 0.491 +- 0.025, 0.474 +- 0.039, 0.495 +- 0.036
Faith. Armon (KL)= 		  =  0.489 +- 0.015, 0.498 +- 0.015, 0.487 +- 0.025, 0.470 +- 0.041, 0.488 +- 0.047
Faith. GMean (KL)= 	  =  0.491 +- 0.014, 0.500 +- 0.014, 0.489 +- 0.025, 0.472 +- 0.040, 0.491 +- 0.042

Eval split val
Faith. Aritm (L1)= 		  =  0.500 +- 0.001, 0.500 +- 0.001, 0.501 +- 0.002, 0.500 +- 0.001, 0.500 +- 0.001
Faith. Armon (L1)= 		  =  0.139 +- 0.031, 0.139 +- 0.031, 0.142 +- 0.033, 0.138 +- 0.032, 0.137 +- 0.031
Faith. GMean (L1)= 	  =  0.261 +- 0.031, 0.262 +- 0.031, 0.264 +- 0.033, 0.261 +- 0.032, 0.259 +- 0.031
Faith. Aritm (KL)= 		  =  0.499 +- 0.001, 0.500 +- 0.001, 0.502 +- 0.003, 0.501 +- 0.003, 0.500 +- 0.002
Faith. Armon (KL)= 		  =  0.114 +- 0.031, 0.115 +- 0.032, 0.123 +- 0.038, 0.118 +- 0.036, 0.114 +- 0.032
Faith. GMean (KL)= 	  =  0.236 +- 0.034, 0.237 +- 0.035, 0.245 +- 0.041, 0.240 +- 0.038, 0.237 +- 0.035

Eval split test
Faith. Aritm (L1)= 		  =  0.631 +- 0.021, 0.635 +- 0.020, 0.621 +- 0.022, 0.590 +- 0.029, 0.607 +- 0.026
Faith. Armon (L1)= 		  =  0.610 +- 0.021, 0.610 +- 0.023, 0.585 +- 0.033, 0.531 +- 0.053, 0.494 +- 0.060
Faith. GMean (L1)= 	  =  0.621 +- 0.021, 0.622 +- 0.021, 0.603 +- 0.028, 0.560 +- 0.041, 0.547 +- 0.045
Faith. Aritm (KL)= 		  =  0.638 +- 0.031, 0.653 +- 0.027, 0.653 +- 0.027, 0.631 +- 0.036, 0.664 +- 0.037
Faith. Armon (KL)= 		  =  0.629 +- 0.036, 0.643 +- 0.032, 0.637 +- 0.036, 0.601 +- 0.056, 0.593 +- 0.071
Faith. GMean (KL)= 	  =  0.633 +- 0.033, 0.648 +- 0.029, 0.645 +- 0.031, 0.616 +- 0.046, 0.627 +- 0.055
Computed for split load_split = id



Completed in  2:45:51.735153  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN plain TopoFeature/basis/no_shift NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 16:34:07 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 04:34:07 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 04:34:07 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:34:07 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 04:34:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:34:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:34:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:34:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:34:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:34:07 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:34:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.9868
Train Loss: 0.0344
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0199
ID Test ACCURACY: 0.9860
ID Test Loss: 0.0461
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0199
OOD Test ACCURACY: 0.9860
OOD Test Loss: 0.0461

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.9868
Train Loss: 0.0344
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0199
ID Test ACCURACY: 0.9860
ID Test Loss: 0.0461
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0199
OOD Test ACCURACY: 0.9860
OOD Test Loss: 0.0461

[0m[1;37mINFO[0m: [1mChartInfo 0.9860 0.9860 0.9860 0.9860 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.377
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.358
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.256
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.168
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.114
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.259
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.146
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.078
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.041
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.023
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.261
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.199
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.143
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.108
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.098


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.37670399999999993
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.475
SUFF_SIMPLE for r=0.05 class 0.0 = 0.512 +- 0.383 (in-sample avg dev_std = 0.471)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.435 +- 0.383 (in-sample avg dev_std = 0.471)
SUFF_SIMPLE for r=0.05 all KL = 0.298 +- 0.383 (in-sample avg dev_std = 0.471)
SUFF_SIMPLE for r=0.05 all L1 = 0.469 +- 0.307 (in-sample avg dev_std = 0.471)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35792399999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.467
SUFF_SIMPLE for r=0.1 class 0.0 = 0.51 +- 0.393 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.446 +- 0.393 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.1 all KL = 0.309 +- 0.393 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.1 all L1 = 0.474 +- 0.316 (in-sample avg dev_std = 0.448)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.255554
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.451
SUFF_SIMPLE for r=0.2 class 0.0 = 0.5 +- 0.375 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.413 +- 0.375 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.2 all KL = 0.277 +- 0.375 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.2 all L1 = 0.452 +- 0.304 (in-sample avg dev_std = 0.452)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.167592
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.505
SUFF_SIMPLE for r=0.4 class 0.0 = 0.575 +- 0.400 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.401 +- 0.400 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.4 all KL = 0.325 +- 0.400 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.4 all L1 = 0.479 +- 0.315 (in-sample avg dev_std = 0.446)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11382400000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.532
SUFF_SIMPLE for r=0.8 class 0.0 = 0.664 +- 0.460 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.502 +- 0.460 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.486 +- 0.460 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.574 +- 0.384 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.849
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2589384
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.459
SUFF_SIMPLE for r=0.05 class 0.0 = 0.606 +- 0.410 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.151 +- 0.410 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.05 all KL = 0.244 +- 0.410 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.05 all L1 = 0.377 +- 0.360 (in-sample avg dev_std = 0.276)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.849
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.14558780000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.437
SUFF_SIMPLE for r=0.1 class 0.0 = 0.57 +- 0.399 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.15 +- 0.399 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.1 all KL = 0.224 +- 0.399 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.1 all L1 = 0.358 +- 0.349 (in-sample avg dev_std = 0.281)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.849
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0780266
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.412
SUFF_SIMPLE for r=0.2 class 0.0 = 0.531 +- 0.382 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.148 +- 0.382 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.2 all KL = 0.202 +- 0.382 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.2 all L1 = 0.338 +- 0.337 (in-sample avg dev_std = 0.268)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.849
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.041049199999999994
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.404
SUFF_SIMPLE for r=0.4 class 0.0 = 0.536 +- 0.391 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.14 +- 0.391 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.4 all KL = 0.212 +- 0.391 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.4 all L1 = 0.337 +- 0.342 (in-sample avg dev_std = 0.212)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.849
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.023097000000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.356
SUFF_SIMPLE for r=0.8 class 0.0 = 0.322 +- 0.351 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.272 +- 0.351 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.172 +- 0.351 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.297 +- 0.312 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.652
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2607398
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.508
SUFF_SIMPLE for r=0.05 class 0.0 = 0.718 +- 0.413 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.572 +- 0.413 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.05 all KL = 0.597 +- 0.413 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.05 all L1 = 0.646 +- 0.335 (in-sample avg dev_std = 0.248)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.652
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1991426
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.516
SUFF_SIMPLE for r=0.1 class 0.0 = 0.716 +- 0.411 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.58 +- 0.411 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.1 all KL = 0.599 +- 0.411 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.1 all L1 = 0.649 +- 0.336 (in-sample avg dev_std = 0.234)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.652
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1432844
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.513
SUFF_SIMPLE for r=0.2 class 0.0 = 0.73 +- 0.409 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.592 +- 0.409 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.2 all KL = 0.618 +- 0.409 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.2 all L1 = 0.662 +- 0.339 (in-sample avg dev_std = 0.216)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.652
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10787739999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.541
SUFF_SIMPLE for r=0.4 class 0.0 = 0.813 +- 0.392 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.611 +- 0.392 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.4 all KL = 0.685 +- 0.392 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.4 all L1 = 0.713 +- 0.331 (in-sample avg dev_std = 0.188)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.652
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0978094
len(reference) = 4963
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.587
SUFF_SIMPLE for r=0.8 class 0.0 = 0.885 +- 0.324 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.765 +- 0.324 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.826 +- 0.324 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.825 +- 0.285 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.37670399999999993
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.646
NEC for r=0.05 class 0.0 = 0.121 +- 0.462 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.486 +- 0.462 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.366 +- 0.462 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.323 +- 0.394 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35792399999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.513
NEC for r=0.1 class 0.0 = 0.19 +- 0.472 (in-sample avg dev_std = 0.119)
NEC for r=0.1 class 1.0 = 0.64 +- 0.472 (in-sample avg dev_std = 0.119)
NEC for r=0.1 all KL = 0.515 +- 0.472 (in-sample avg dev_std = 0.119)
NEC for r=0.1 all L1 = 0.439 +- 0.395 (in-sample avg dev_std = 0.119)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.255554
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.659
NEC for r=0.2 class 0.0 = 0.357 +- 0.438 (in-sample avg dev_std = 0.400)
NEC for r=0.2 class 1.0 = 0.346 +- 0.438 (in-sample avg dev_std = 0.400)
NEC for r=0.2 all KL = 0.47 +- 0.438 (in-sample avg dev_std = 0.400)
NEC for r=0.2 all L1 = 0.351 +- 0.343 (in-sample avg dev_std = 0.400)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.167592
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.743
NEC for r=0.4 class 0.0 = 0.41 +- 0.421 (in-sample avg dev_std = 0.368)
NEC for r=0.4 class 1.0 = 0.188 +- 0.421 (in-sample avg dev_std = 0.368)
NEC for r=0.4 all KL = 0.359 +- 0.421 (in-sample avg dev_std = 0.368)
NEC for r=0.4 all L1 = 0.287 +- 0.331 (in-sample avg dev_std = 0.368)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11382400000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.772
NEC for r=0.8 class 0.0 = 0.425 +- 0.412 (in-sample avg dev_std = 0.392)
NEC for r=0.8 class 1.0 = 0.154 +- 0.412 (in-sample avg dev_std = 0.392)
NEC for r=0.8 all KL = 0.349 +- 0.412 (in-sample avg dev_std = 0.392)
NEC for r=0.8 all L1 = 0.275 +- 0.319 (in-sample avg dev_std = 0.392)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.849
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2589384
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.443
NEC for r=0.05 class 0.0 = 0.245 +- 0.474 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.811 +- 0.474 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.609 +- 0.474 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.53 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.849
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.14558780000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.601
NEC for r=0.1 class 0.0 = 0.247 +- 0.473 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.525 +- 0.473 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.469 +- 0.473 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.387 +- 0.404 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.849
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0780266
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.831
NEC for r=0.2 class 0.0 = 0.311 +- 0.430 (in-sample avg dev_std = 0.266)
NEC for r=0.2 class 1.0 = 0.154 +- 0.430 (in-sample avg dev_std = 0.266)
NEC for r=0.2 all KL = 0.337 +- 0.430 (in-sample avg dev_std = 0.266)
NEC for r=0.2 all L1 = 0.232 +- 0.332 (in-sample avg dev_std = 0.266)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.849
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.041049199999999994
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.828
NEC for r=0.4 class 0.0 = 0.381 +- 0.452 (in-sample avg dev_std = 0.436)
NEC for r=0.4 class 1.0 = 0.153 +- 0.452 (in-sample avg dev_std = 0.436)
NEC for r=0.4 all KL = 0.425 +- 0.452 (in-sample avg dev_std = 0.436)
NEC for r=0.4 all L1 = 0.266 +- 0.326 (in-sample avg dev_std = 0.436)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.849
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.023097000000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.722
NEC for r=0.8 class 0.0 = 0.547 +- 0.462 (in-sample avg dev_std = 0.464)
NEC for r=0.8 class 1.0 = 0.241 +- 0.462 (in-sample avg dev_std = 0.464)
NEC for r=0.8 all KL = 0.553 +- 0.462 (in-sample avg dev_std = 0.464)
NEC for r=0.8 all L1 = 0.393 +- 0.367 (in-sample avg dev_std = 0.464)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.652
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2607398
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.588
NEC for r=0.05 class 0.0 = 0.067 +- 0.269 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.183 +- 0.269 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.109 +- 0.269 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.124 +- 0.251 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.652
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1991426
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.559
NEC for r=0.1 class 0.0 = 0.08 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.226 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.141 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.152 +- 0.278 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.652
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1432844
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.546
NEC for r=0.2 class 0.0 = 0.095 +- 0.311 (in-sample avg dev_std = 0.001)
NEC for r=0.2 class 1.0 = 0.233 +- 0.311 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all KL = 0.152 +- 0.311 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all L1 = 0.163 +- 0.283 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.652
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10787739999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.568
NEC for r=0.4 class 0.0 = 0.146 +- 0.347 (in-sample avg dev_std = 0.184)
NEC for r=0.4 class 1.0 = 0.283 +- 0.347 (in-sample avg dev_std = 0.184)
NEC for r=0.4 all KL = 0.215 +- 0.347 (in-sample avg dev_std = 0.184)
NEC for r=0.4 all L1 = 0.214 +- 0.308 (in-sample avg dev_std = 0.184)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.652
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0978094
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.621
NEC for r=0.8 class 0.0 = 0.184 +- 0.338 (in-sample avg dev_std = 0.216)
NEC for r=0.8 class 1.0 = 0.266 +- 0.338 (in-sample avg dev_std = 0.216)
NEC for r=0.8 all KL = 0.238 +- 0.338 (in-sample avg dev_std = 0.216)
NEC for r=0.8 all L1 = 0.224 +- 0.284 (in-sample avg dev_std = 0.216)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 16:50:58 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 04:50:58 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 04:50:58 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:50:58 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 04:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:50:58 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:50:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 89 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9952
Train Loss: 0.0252
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0215
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0308
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0215
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0308

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 89...
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9952
Train Loss: 0.0252
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0215
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0308
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0215
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0308

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.379
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.354
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.254
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.169
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.115
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.257
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.145
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.078
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.042
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.024
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.285
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.214
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.153
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.117
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.102


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.37894
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.538
SUFF_SIMPLE for r=0.05 class 0.0 = 0.484 +- 0.386 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.54 +- 0.386 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.05 all KL = 0.348 +- 0.386 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.05 all L1 = 0.515 +- 0.309 (in-sample avg dev_std = 0.449)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35417200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.535
SUFF_SIMPLE for r=0.1 class 0.0 = 0.483 +- 0.393 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.544 +- 0.393 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.1 all KL = 0.347 +- 0.393 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.1 all L1 = 0.517 +- 0.312 (in-sample avg dev_std = 0.451)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25360200000000005
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.551
SUFF_SIMPLE for r=0.2 class 0.0 = 0.481 +- 0.373 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.526 +- 0.373 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.2 all KL = 0.326 +- 0.373 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.2 all L1 = 0.506 +- 0.300 (in-sample avg dev_std = 0.458)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.169174
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.592
SUFF_SIMPLE for r=0.4 class 0.0 = 0.555 +- 0.395 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.512 +- 0.395 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.4 all KL = 0.37 +- 0.395 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.4 all L1 = 0.531 +- 0.310 (in-sample avg dev_std = 0.454)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11512199999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.616
SUFF_SIMPLE for r=0.8 class 0.0 = 0.65 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.6 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.545 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.622 +- 0.373 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25650019999999996
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.464
SUFF_SIMPLE for r=0.05 class 0.0 = 0.759 +- 0.439 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.313 +- 0.439 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.05 all KL = 0.421 +- 0.439 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.05 all L1 = 0.534 +- 0.361 (in-sample avg dev_std = 0.428)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1450794
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.44
SUFF_SIMPLE for r=0.1 class 0.0 = 0.73 +- 0.437 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.305 +- 0.437 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.1 all KL = 0.405 +- 0.437 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.1 all L1 = 0.516 +- 0.362 (in-sample avg dev_std = 0.414)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0784476
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.399
SUFF_SIMPLE for r=0.2 class 0.0 = 0.684 +- 0.436 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.294 +- 0.436 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.2 all KL = 0.387 +- 0.436 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.2 all L1 = 0.488 +- 0.365 (in-sample avg dev_std = 0.369)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0418752
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.351
SUFF_SIMPLE for r=0.4 class 0.0 = 0.655 +- 0.435 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.268 +- 0.435 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.4 all KL = 0.369 +- 0.435 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.4 all L1 = 0.46 +- 0.370 (in-sample avg dev_std = 0.285)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.024070800000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.461
SUFF_SIMPLE for r=0.8 class 0.0 = 0.697 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.423 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.489 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.559 +- 0.384 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.695
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2850872
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.556
SUFF_SIMPLE for r=0.05 class 0.0 = 0.725 +- 0.415 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.548 +- 0.415 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.05 all KL = 0.577 +- 0.415 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.05 all L1 = 0.638 +- 0.327 (in-sample avg dev_std = 0.251)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.695
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.213785
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.573
SUFF_SIMPLE for r=0.1 class 0.0 = 0.721 +- 0.416 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.555 +- 0.416 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.1 all KL = 0.577 +- 0.416 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.1 all L1 = 0.639 +- 0.329 (in-sample avg dev_std = 0.237)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.695
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.152517
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.58
SUFF_SIMPLE for r=0.2 class 0.0 = 0.736 +- 0.413 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.561 +- 0.413 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.2 all KL = 0.589 +- 0.413 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.2 all L1 = 0.65 +- 0.331 (in-sample avg dev_std = 0.229)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.695
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1165626
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.585
SUFF_SIMPLE for r=0.4 class 0.0 = 0.809 +- 0.407 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.566 +- 0.407 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.4 all KL = 0.645 +- 0.407 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.4 all L1 = 0.689 +- 0.336 (in-sample avg dev_std = 0.196)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.696
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1024266
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.644
SUFF_SIMPLE for r=0.8 class 0.0 = 0.9 +- 0.314 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.752 +- 0.314 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.83 +- 0.314 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.827 +- 0.275 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.37894
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.616
NEC for r=0.05 class 0.0 = 0.173 +- 0.473 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.499 +- 0.473 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.402 +- 0.473 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.354 +- 0.400 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35417200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.471
NEC for r=0.1 class 0.0 = 0.253 +- 0.470 (in-sample avg dev_std = 0.115)
NEC for r=0.1 class 1.0 = 0.662 +- 0.470 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all KL = 0.555 +- 0.470 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all L1 = 0.48 +- 0.394 (in-sample avg dev_std = 0.115)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25360200000000005
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.648
NEC for r=0.2 class 0.0 = 0.356 +- 0.434 (in-sample avg dev_std = 0.409)
NEC for r=0.2 class 1.0 = 0.378 +- 0.434 (in-sample avg dev_std = 0.409)
NEC for r=0.2 all KL = 0.491 +- 0.434 (in-sample avg dev_std = 0.409)
NEC for r=0.2 all L1 = 0.368 +- 0.339 (in-sample avg dev_std = 0.409)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.169174
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.757
NEC for r=0.4 class 0.0 = 0.399 +- 0.425 (in-sample avg dev_std = 0.422)
NEC for r=0.4 class 1.0 = 0.191 +- 0.425 (in-sample avg dev_std = 0.422)
NEC for r=0.4 all KL = 0.371 +- 0.425 (in-sample avg dev_std = 0.422)
NEC for r=0.4 all L1 = 0.284 +- 0.319 (in-sample avg dev_std = 0.422)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11512199999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.812
NEC for r=0.8 class 0.0 = 0.387 +- 0.405 (in-sample avg dev_std = 0.428)
NEC for r=0.8 class 1.0 = 0.122 +- 0.405 (in-sample avg dev_std = 0.428)
NEC for r=0.8 all KL = 0.328 +- 0.405 (in-sample avg dev_std = 0.428)
NEC for r=0.8 all L1 = 0.24 +- 0.291 (in-sample avg dev_std = 0.428)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25650019999999996
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.487
NEC for r=0.05 class 0.0 = 0.057 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.746 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.446 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.404 +- 0.399 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1450794
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.515
NEC for r=0.1 class 0.0 = 0.134 +- 0.442 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.676 +- 0.442 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.476 +- 0.442 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.407 +- 0.383 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0784476
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.68
NEC for r=0.2 class 0.0 = 0.218 +- 0.411 (in-sample avg dev_std = 0.308)
NEC for r=0.2 class 1.0 = 0.438 +- 0.411 (in-sample avg dev_std = 0.308)
NEC for r=0.2 all KL = 0.429 +- 0.411 (in-sample avg dev_std = 0.308)
NEC for r=0.2 all L1 = 0.329 +- 0.328 (in-sample avg dev_std = 0.308)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0418752
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.84
NEC for r=0.4 class 0.0 = 0.215 +- 0.377 (in-sample avg dev_std = 0.394)
NEC for r=0.4 class 1.0 = 0.235 +- 0.377 (in-sample avg dev_std = 0.394)
NEC for r=0.4 all KL = 0.317 +- 0.377 (in-sample avg dev_std = 0.394)
NEC for r=0.4 all L1 = 0.225 +- 0.261 (in-sample avg dev_std = 0.394)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.024070800000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.767
NEC for r=0.8 class 0.0 = 0.311 +- 0.416 (in-sample avg dev_std = 0.425)
NEC for r=0.8 class 1.0 = 0.264 +- 0.416 (in-sample avg dev_std = 0.425)
NEC for r=0.8 all KL = 0.38 +- 0.416 (in-sample avg dev_std = 0.425)
NEC for r=0.8 all L1 = 0.287 +- 0.305 (in-sample avg dev_std = 0.425)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.695
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2850872
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.584
NEC for r=0.05 class 0.0 = 0.067 +- 0.308 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.229 +- 0.308 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.138 +- 0.308 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.147 +- 0.280 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.695
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.213785
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.554
NEC for r=0.1 class 0.0 = 0.079 +- 0.337 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.27 +- 0.337 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.169 +- 0.337 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.174 +- 0.303 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.695
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.152517
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.54
NEC for r=0.2 class 0.0 = 0.1 +- 0.345 (in-sample avg dev_std = 0.023)
NEC for r=0.2 class 1.0 = 0.273 +- 0.345 (in-sample avg dev_std = 0.023)
NEC for r=0.2 all KL = 0.183 +- 0.345 (in-sample avg dev_std = 0.023)
NEC for r=0.2 all L1 = 0.186 +- 0.308 (in-sample avg dev_std = 0.023)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.695
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1165626
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.596
NEC for r=0.4 class 0.0 = 0.161 +- 0.358 (in-sample avg dev_std = 0.228)
NEC for r=0.4 class 1.0 = 0.298 +- 0.358 (in-sample avg dev_std = 0.228)
NEC for r=0.4 all KL = 0.24 +- 0.358 (in-sample avg dev_std = 0.228)
NEC for r=0.4 all L1 = 0.229 +- 0.311 (in-sample avg dev_std = 0.228)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.695
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1024266
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.659
NEC for r=0.8 class 0.0 = 0.196 +- 0.337 (in-sample avg dev_std = 0.227)
NEC for r=0.8 class 1.0 = 0.236 +- 0.337 (in-sample avg dev_std = 0.227)
NEC for r=0.8 all KL = 0.235 +- 0.337 (in-sample avg dev_std = 0.227)
NEC for r=0.8 all L1 = 0.216 +- 0.276 (in-sample avg dev_std = 0.227)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 17:07:38 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 05:07:38 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:38 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:38 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 05:07:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:38 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:07:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 77 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ACCURACY: 0.9888
Train Loss: 0.0367
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0348
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0351
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0348
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0351

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 77...
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ACCURACY: 0.9888
Train Loss: 0.0367
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0348
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0351
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0348
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0351

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.382
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.353
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.255
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.169
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.114
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.248
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.139
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.075
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.039
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.023
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.283
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.212
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.146
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.110
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.094


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381686
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.507
SUFF_SIMPLE for r=0.05 class 0.0 = 0.512 +- 0.389 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.483 +- 0.389 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.05 all KL = 0.362 +- 0.389 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.05 all L1 = 0.496 +- 0.312 (in-sample avg dev_std = 0.456)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35322
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.483
SUFF_SIMPLE for r=0.1 class 0.0 = 0.501 +- 0.387 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.462 +- 0.387 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.1 all KL = 0.343 +- 0.387 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.1 all L1 = 0.479 +- 0.313 (in-sample avg dev_std = 0.447)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254516
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.488
SUFF_SIMPLE for r=0.2 class 0.0 = 0.494 +- 0.377 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.45 +- 0.377 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.2 all KL = 0.329 +- 0.377 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.2 all L1 = 0.47 +- 0.306 (in-sample avg dev_std = 0.454)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.16855400000000004
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.568
SUFF_SIMPLE for r=0.4 class 0.0 = 0.586 +- 0.397 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.486 +- 0.397 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.4 all KL = 0.411 +- 0.397 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.4 all L1 = 0.531 +- 0.317 (in-sample avg dev_std = 0.409)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11422
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.63
SUFF_SIMPLE for r=0.8 class 0.0 = 0.753 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.545 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.571 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.638 +- 0.366 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.797
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2482062
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.476
SUFF_SIMPLE for r=0.05 class 0.0 = 0.915 +- 0.417 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.42 +- 0.417 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.05 all KL = 0.61 +- 0.417 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.05 all L1 = 0.666 +- 0.356 (in-sample avg dev_std = 0.220)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.797
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1390932
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.458
SUFF_SIMPLE for r=0.1 class 0.0 = 0.882 +- 0.422 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.419 +- 0.422 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.1 all KL = 0.588 +- 0.422 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.1 all L1 = 0.649 +- 0.358 (in-sample avg dev_std = 0.231)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.797
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07463979999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.438
SUFF_SIMPLE for r=0.2 class 0.0 = 0.848 +- 0.427 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.417 +- 0.427 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.2 all KL = 0.569 +- 0.427 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.2 all L1 = 0.631 +- 0.361 (in-sample avg dev_std = 0.223)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.797
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03945939999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.409
SUFF_SIMPLE for r=0.4 class 0.0 = 0.803 +- 0.431 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.414 +- 0.431 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.4 all KL = 0.542 +- 0.431 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.4 all L1 = 0.607 +- 0.365 (in-sample avg dev_std = 0.192)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.797
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.023059800000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.392
SUFF_SIMPLE for r=0.8 class 0.0 = 0.753 +- 0.431 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.433 +- 0.431 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.52 +- 0.431 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.592 +- 0.364 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.679
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.28305860000000005
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.53
SUFF_SIMPLE for r=0.05 class 0.0 = 0.726 +- 0.418 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.541 +- 0.418 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.05 all KL = 0.58 +- 0.418 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.05 all L1 = 0.635 +- 0.344 (in-sample avg dev_std = 0.272)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.679
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2117496
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.536
SUFF_SIMPLE for r=0.1 class 0.0 = 0.719 +- 0.417 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.549 +- 0.417 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.1 all KL = 0.581 +- 0.417 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.1 all L1 = 0.635 +- 0.347 (in-sample avg dev_std = 0.241)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.679
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.14642339999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.54
SUFF_SIMPLE for r=0.2 class 0.0 = 0.743 +- 0.411 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.563 +- 0.411 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.2 all KL = 0.607 +- 0.411 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.2 all L1 = 0.654 +- 0.345 (in-sample avg dev_std = 0.218)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10955660000000003
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.559
SUFF_SIMPLE for r=0.4 class 0.0 = 0.834 +- 0.397 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.583 +- 0.397 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 all KL = 0.68 +- 0.397 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 all L1 = 0.71 +- 0.338 (in-sample avg dev_std = 0.174)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.679
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0943582
len(reference) = 4946
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.647
SUFF_SIMPLE for r=0.8 class 0.0 = 0.934 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.751 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.845 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.844 +- 0.272 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.381686
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.604
NEC for r=0.05 class 0.0 = 0.217 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.462 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.389 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.353 +- 0.395 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35322
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.579
NEC for r=0.1 class 0.0 = 0.263 +- 0.463 (in-sample avg dev_std = 0.080)
NEC for r=0.1 class 1.0 = 0.493 +- 0.463 (in-sample avg dev_std = 0.080)
NEC for r=0.1 all KL = 0.439 +- 0.463 (in-sample avg dev_std = 0.080)
NEC for r=0.1 all L1 = 0.391 +- 0.390 (in-sample avg dev_std = 0.080)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254516
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.687
NEC for r=0.2 class 0.0 = 0.387 +- 0.427 (in-sample avg dev_std = 0.365)
NEC for r=0.2 class 1.0 = 0.294 +- 0.427 (in-sample avg dev_std = 0.365)
NEC for r=0.2 all KL = 0.411 +- 0.427 (in-sample avg dev_std = 0.365)
NEC for r=0.2 all L1 = 0.335 +- 0.337 (in-sample avg dev_std = 0.365)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.16855400000000004
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.719
NEC for r=0.4 class 0.0 = 0.404 +- 0.427 (in-sample avg dev_std = 0.387)
NEC for r=0.4 class 1.0 = 0.245 +- 0.427 (in-sample avg dev_std = 0.387)
NEC for r=0.4 all KL = 0.378 +- 0.427 (in-sample avg dev_std = 0.387)
NEC for r=0.4 all L1 = 0.316 +- 0.332 (in-sample avg dev_std = 0.387)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11422
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.753
NEC for r=0.8 class 0.0 = 0.43 +- 0.411 (in-sample avg dev_std = 0.384)
NEC for r=0.8 class 1.0 = 0.171 +- 0.411 (in-sample avg dev_std = 0.384)
NEC for r=0.8 all KL = 0.345 +- 0.411 (in-sample avg dev_std = 0.384)
NEC for r=0.8 all L1 = 0.286 +- 0.322 (in-sample avg dev_std = 0.384)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.797
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2482062
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
NEC for r=0.05 class 0.0 = 0.063 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.546 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.321 +- 0.400 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.307 +- 0.358 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.797
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1390932
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.568
NEC for r=0.1 class 0.0 = 0.062 +- 0.369 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.439 +- 0.369 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.258 +- 0.369 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.252 +- 0.325 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.797
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07463979999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.655
NEC for r=0.2 class 0.0 = 0.044 +- 0.307 (in-sample avg dev_std = 0.142)
NEC for r=0.2 class 1.0 = 0.324 +- 0.307 (in-sample avg dev_std = 0.142)
NEC for r=0.2 all KL = 0.18 +- 0.307 (in-sample avg dev_std = 0.142)
NEC for r=0.2 all L1 = 0.185 +- 0.264 (in-sample avg dev_std = 0.142)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.797
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03945939999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.684
NEC for r=0.4 class 0.0 = 0.12 +- 0.334 (in-sample avg dev_std = 0.297)
NEC for r=0.4 class 1.0 = 0.248 +- 0.334 (in-sample avg dev_std = 0.297)
NEC for r=0.4 all KL = 0.231 +- 0.334 (in-sample avg dev_std = 0.297)
NEC for r=0.4 all L1 = 0.185 +- 0.216 (in-sample avg dev_std = 0.297)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.797
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.023059800000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.633
NEC for r=0.8 class 0.0 = 0.216 +- 0.369 (in-sample avg dev_std = 0.327)
NEC for r=0.8 class 1.0 = 0.255 +- 0.369 (in-sample avg dev_std = 0.327)
NEC for r=0.8 all KL = 0.286 +- 0.369 (in-sample avg dev_std = 0.327)
NEC for r=0.8 all L1 = 0.236 +- 0.260 (in-sample avg dev_std = 0.327)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.679
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.28305860000000005
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.589
NEC for r=0.05 class 0.0 = 0.071 +- 0.306 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.225 +- 0.306 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.137 +- 0.306 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.147 +- 0.280 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.679
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2117496
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.562
NEC for r=0.1 class 0.0 = 0.085 +- 0.337 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.268 +- 0.337 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.169 +- 0.337 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.175 +- 0.304 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.679
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.14642339999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.552
NEC for r=0.2 class 0.0 = 0.1 +- 0.340 (in-sample avg dev_std = 0.009)
NEC for r=0.2 class 1.0 = 0.269 +- 0.340 (in-sample avg dev_std = 0.009)
NEC for r=0.2 all KL = 0.177 +- 0.340 (in-sample avg dev_std = 0.009)
NEC for r=0.2 all L1 = 0.184 +- 0.305 (in-sample avg dev_std = 0.009)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10955660000000003
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.563
NEC for r=0.4 class 0.0 = 0.155 +- 0.368 (in-sample avg dev_std = 0.224)
NEC for r=0.4 class 1.0 = 0.315 +- 0.368 (in-sample avg dev_std = 0.224)
NEC for r=0.4 all KL = 0.244 +- 0.368 (in-sample avg dev_std = 0.224)
NEC for r=0.4 all L1 = 0.234 +- 0.317 (in-sample avg dev_std = 0.224)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.679
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0943582
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.648
NEC for r=0.8 class 0.0 = 0.168 +- 0.329 (in-sample avg dev_std = 0.246)
NEC for r=0.8 class 1.0 = 0.248 +- 0.329 (in-sample avg dev_std = 0.246)
NEC for r=0.8 all KL = 0.223 +- 0.329 (in-sample avg dev_std = 0.246)
NEC for r=0.8 all L1 = 0.208 +- 0.278 (in-sample avg dev_std = 0.246)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 17:24:18 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 05:24:18 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 05:24:18 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:24:18 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 05:24:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:24:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:24:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:24:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:24:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:24:18 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:24:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9898
Train Loss: 0.0441
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0486
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0525
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0486
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0525

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9898
Train Loss: 0.0441
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0486
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0525
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0486
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0525

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.369
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.322
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.228
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.141
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.096
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.255
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.145
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.079
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.042
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.022
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.276
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.199
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.133
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.092


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.368644
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.508
SUFF_SIMPLE for r=0.05 class 0.0 = 0.533 +- 0.399 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.466 +- 0.399 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.05 all KL = 0.366 +- 0.399 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.05 all L1 = 0.496 +- 0.318 (in-sample avg dev_std = 0.445)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32156799999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.491
SUFF_SIMPLE for r=0.1 class 0.0 = 0.509 +- 0.416 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.493 +- 0.416 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.1 all KL = 0.383 +- 0.416 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.1 all L1 = 0.5 +- 0.332 (in-sample avg dev_std = 0.399)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.228022
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.503
SUFF_SIMPLE for r=0.2 class 0.0 = 0.489 +- 0.405 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.504 +- 0.405 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.2 all KL = 0.374 +- 0.405 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.2 all L1 = 0.498 +- 0.326 (in-sample avg dev_std = 0.393)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.549
SUFF_SIMPLE for r=0.4 class 0.0 = 0.555 +- 0.402 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.492 +- 0.402 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.4 all KL = 0.397 +- 0.402 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.4 all L1 = 0.52 +- 0.319 (in-sample avg dev_std = 0.389)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.096098
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.67
SUFF_SIMPLE for r=0.8 class 0.0 = 0.786 +- 0.428 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.562 +- 0.428 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.605 +- 0.428 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.662 +- 0.357 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.74
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25512219999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.484
SUFF_SIMPLE for r=0.05 class 0.0 = 0.896 +- 0.409 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.484 +- 0.409 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.05 all KL = 0.623 +- 0.409 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.05 all L1 = 0.689 +- 0.339 (in-sample avg dev_std = 0.249)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.74
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1447938
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.457
SUFF_SIMPLE for r=0.1 class 0.0 = 0.85 +- 0.417 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.485 +- 0.417 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.1 all KL = 0.596 +- 0.417 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.1 all L1 = 0.666 +- 0.344 (in-sample avg dev_std = 0.252)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.74
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07866580000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.421
SUFF_SIMPLE for r=0.2 class 0.0 = 0.803 +- 0.424 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.485 +- 0.424 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all KL = 0.577 +- 0.424 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all L1 = 0.643 +- 0.355 (in-sample avg dev_std = 0.195)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.74
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0417914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.408
SUFF_SIMPLE for r=0.4 class 0.0 = 0.796 +- 0.426 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.484 +- 0.426 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.4 all KL = 0.575 +- 0.426 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.4 all L1 = 0.639 +- 0.360 (in-sample avg dev_std = 0.149)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.74
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0224552
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.525
SUFF_SIMPLE for r=0.8 class 0.0 = 0.934 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.532 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.705 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.731 +- 0.330 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.626
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.27557080000000006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.513
SUFF_SIMPLE for r=0.05 class 0.0 = 0.785 +- 0.416 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.591 +- 0.416 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.05 all KL = 0.646 +- 0.416 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.05 all L1 = 0.689 +- 0.342 (in-sample avg dev_std = 0.240)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.626
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1988164
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.508
SUFF_SIMPLE for r=0.1 class 0.0 = 0.781 +- 0.418 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.598 +- 0.418 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.1 all KL = 0.65 +- 0.418 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.1 all L1 = 0.69 +- 0.347 (in-sample avg dev_std = 0.209)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.626
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1334
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.524
SUFF_SIMPLE for r=0.2 class 0.0 = 0.785 +- 0.412 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.615 +- 0.412 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.2 all KL = 0.662 +- 0.412 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.2 all L1 = 0.701 +- 0.343 (in-sample avg dev_std = 0.188)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.626
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.100493
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.559
SUFF_SIMPLE for r=0.4 class 0.0 = 0.875 +- 0.370 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.662 +- 0.370 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.4 all KL = 0.746 +- 0.370 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.4 all L1 = 0.77 +- 0.313 (in-sample avg dev_std = 0.130)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.63
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0916568
len(reference) = 4955
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.613
SUFF_SIMPLE for r=0.8 class 0.0 = 0.94 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.754 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.85 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.849 +- 0.268 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.368644
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.652
NEC for r=0.05 class 0.0 = 0.169 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.432 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.344 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.315 +- 0.384 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32156799999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.597
NEC for r=0.1 class 0.0 = 0.241 +- 0.462 (in-sample avg dev_std = 0.066)
NEC for r=0.1 class 1.0 = 0.474 +- 0.462 (in-sample avg dev_std = 0.066)
NEC for r=0.1 all KL = 0.422 +- 0.462 (in-sample avg dev_std = 0.066)
NEC for r=0.1 all L1 = 0.37 +- 0.386 (in-sample avg dev_std = 0.066)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.228022
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.686
NEC for r=0.2 class 0.0 = 0.321 +- 0.433 (in-sample avg dev_std = 0.412)
NEC for r=0.2 class 1.0 = 0.364 +- 0.433 (in-sample avg dev_std = 0.412)
NEC for r=0.2 all KL = 0.446 +- 0.433 (in-sample avg dev_std = 0.412)
NEC for r=0.2 all L1 = 0.345 +- 0.327 (in-sample avg dev_std = 0.412)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.772
NEC for r=0.4 class 0.0 = 0.366 +- 0.402 (in-sample avg dev_std = 0.398)
NEC for r=0.4 class 1.0 = 0.202 +- 0.402 (in-sample avg dev_std = 0.398)
NEC for r=0.4 all KL = 0.357 +- 0.402 (in-sample avg dev_std = 0.398)
NEC for r=0.4 all L1 = 0.275 +- 0.299 (in-sample avg dev_std = 0.398)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.096098
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.789
NEC for r=0.8 class 0.0 = 0.389 +- 0.407 (in-sample avg dev_std = 0.393)
NEC for r=0.8 class 1.0 = 0.152 +- 0.407 (in-sample avg dev_std = 0.393)
NEC for r=0.8 all KL = 0.326 +- 0.407 (in-sample avg dev_std = 0.393)
NEC for r=0.8 all L1 = 0.258 +- 0.303 (in-sample avg dev_std = 0.393)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.74
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25512219999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.475
NEC for r=0.05 class 0.0 = 0.054 +- 0.391 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.505 +- 0.391 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.293 +- 0.391 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.281 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.74
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1447938
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.473
NEC for r=0.1 class 0.0 = 0.063 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.503 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.305 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.285 +- 0.350 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.74
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07866580000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.523
NEC for r=0.2 class 0.0 = 0.017 +- 0.362 (in-sample avg dev_std = 0.135)
NEC for r=0.2 class 1.0 = 0.486 +- 0.362 (in-sample avg dev_std = 0.135)
NEC for r=0.2 all KL = 0.256 +- 0.362 (in-sample avg dev_std = 0.135)
NEC for r=0.2 all L1 = 0.253 +- 0.330 (in-sample avg dev_std = 0.135)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.74
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0417914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.621
NEC for r=0.4 class 0.0 = 0.082 +- 0.350 (in-sample avg dev_std = 0.370)
NEC for r=0.4 class 1.0 = 0.391 +- 0.350 (in-sample avg dev_std = 0.370)
NEC for r=0.4 all KL = 0.308 +- 0.350 (in-sample avg dev_std = 0.370)
NEC for r=0.4 all L1 = 0.238 +- 0.257 (in-sample avg dev_std = 0.370)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.74
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0224552
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.608
NEC for r=0.8 class 0.0 = 0.17 +- 0.368 (in-sample avg dev_std = 0.355)
NEC for r=0.8 class 1.0 = 0.348 +- 0.368 (in-sample avg dev_std = 0.355)
NEC for r=0.8 all KL = 0.333 +- 0.368 (in-sample avg dev_std = 0.355)
NEC for r=0.8 all L1 = 0.26 +- 0.264 (in-sample avg dev_std = 0.355)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.626
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.27557080000000006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.582
NEC for r=0.05 class 0.0 = 0.065 +- 0.234 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.13 +- 0.234 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.083 +- 0.234 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.097 +- 0.222 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.626
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1988164
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.564
NEC for r=0.1 class 0.0 = 0.072 +- 0.259 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.154 +- 0.259 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.1 +- 0.259 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.113 +- 0.241 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.626
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1334
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.557
NEC for r=0.2 class 0.0 = 0.085 +- 0.266 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.154 +- 0.266 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.109 +- 0.266 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.119 +- 0.244 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.626
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.100493
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.586
NEC for r=0.4 class 0.0 = 0.12 +- 0.273 (in-sample avg dev_std = 0.136)
NEC for r=0.4 class 1.0 = 0.138 +- 0.273 (in-sample avg dev_std = 0.136)
NEC for r=0.4 all KL = 0.128 +- 0.273 (in-sample avg dev_std = 0.136)
NEC for r=0.4 all L1 = 0.129 +- 0.235 (in-sample avg dev_std = 0.136)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.626
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0916568
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.604
NEC for r=0.8 class 0.0 = 0.132 +- 0.311 (in-sample avg dev_std = 0.258)
NEC for r=0.8 class 1.0 = 0.214 +- 0.311 (in-sample avg dev_std = 0.258)
NEC for r=0.8 all KL = 0.187 +- 0.311 (in-sample avg dev_std = 0.258)
NEC for r=0.8 all L1 = 0.172 +- 0.255 (in-sample avg dev_std = 0.258)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 17:40:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 05:40:30 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 05:40:30 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:40:30 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 05:40:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:40:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:40:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:40:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:40:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:40:30 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:40:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9718
Train Loss: 0.0708
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0692
ID Test ACCURACY: 0.9580
ID Test Loss: 0.0971
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0692
OOD Test ACCURACY: 0.9580
OOD Test Loss: 0.0971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9718
Train Loss: 0.0708
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0692
ID Test ACCURACY: 0.9580
ID Test Loss: 0.0971
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0692
OOD Test ACCURACY: 0.9580
OOD Test Loss: 0.0971

[0m[1;37mINFO[0m: [1mChartInfo 0.9580 0.9580 0.9580 0.9580 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.413
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.361
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.255
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.159
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.109
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.228
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.131
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.073
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.040
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.022
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.268
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.202
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.140
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.108
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.097


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.413274
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.527
SUFF_SIMPLE for r=0.05 class 0.0 = 0.527 +- 0.398 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.497 +- 0.398 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 all KL = 0.397 +- 0.398 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 all L1 = 0.51 +- 0.311 (in-sample avg dev_std = 0.434)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.361036
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.524
SUFF_SIMPLE for r=0.1 class 0.0 = 0.509 +- 0.405 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.516 +- 0.405 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.1 all KL = 0.402 +- 0.405 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.1 all L1 = 0.513 +- 0.319 (in-sample avg dev_std = 0.417)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254962
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.53
SUFF_SIMPLE for r=0.2 class 0.0 = 0.488 +- 0.400 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.528 +- 0.400 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.2 all KL = 0.394 +- 0.400 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.2 all L1 = 0.51 +- 0.318 (in-sample avg dev_std = 0.410)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.158738
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.624
SUFF_SIMPLE for r=0.4 class 0.0 = 0.564 +- 0.386 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.558 +- 0.386 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.4 all KL = 0.45 +- 0.386 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.4 all L1 = 0.56 +- 0.301 (in-sample avg dev_std = 0.399)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.109048
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.746
SUFF_SIMPLE for r=0.8 class 0.0 = 0.791 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.636 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.667 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.705 +- 0.329 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.791
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22811019999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.505
SUFF_SIMPLE for r=0.05 class 0.0 = 0.893 +- 0.429 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.464 +- 0.429 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.05 all KL = 0.601 +- 0.429 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.05 all L1 = 0.677 +- 0.352 (in-sample avg dev_std = 0.319)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.791
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1310016
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.878 +- 0.433 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.462 +- 0.433 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.1 all KL = 0.59 +- 0.433 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.1 all L1 = 0.668 +- 0.355 (in-sample avg dev_std = 0.320)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.791
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0726636
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.468
SUFF_SIMPLE for r=0.2 class 0.0 = 0.847 +- 0.437 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.457 +- 0.437 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.2 all KL = 0.574 +- 0.437 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.2 all L1 = 0.65 +- 0.362 (in-sample avg dev_std = 0.298)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.791
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0396364
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.418
SUFF_SIMPLE for r=0.4 class 0.0 = 0.799 +- 0.446 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.446 +- 0.446 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.4 all KL = 0.551 +- 0.446 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.4 all L1 = 0.621 +- 0.376 (in-sample avg dev_std = 0.244)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.791
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.022072
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.564
SUFF_SIMPLE for r=0.8 class 0.0 = 0.975 +- 0.376 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.544 +- 0.376 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.746 +- 0.376 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.758 +- 0.335 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.666
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.26781320000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.547
SUFF_SIMPLE for r=0.05 class 0.0 = 0.748 +- 0.421 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.51 +- 0.421 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 all KL = 0.599 +- 0.421 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 all L1 = 0.63 +- 0.352 (in-sample avg dev_std = 0.213)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.666
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2021102
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.552
SUFF_SIMPLE for r=0.1 class 0.0 = 0.739 +- 0.423 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.519 +- 0.423 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.1 all KL = 0.597 +- 0.423 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.1 all L1 = 0.63 +- 0.354 (in-sample avg dev_std = 0.192)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.666
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1403772
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.586
SUFF_SIMPLE for r=0.2 class 0.0 = 0.763 +- 0.410 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.539 +- 0.410 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.2 all KL = 0.623 +- 0.410 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.2 all L1 = 0.653 +- 0.345 (in-sample avg dev_std = 0.180)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.666
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10781439999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.637
SUFF_SIMPLE for r=0.4 class 0.0 = 0.844 +- 0.387 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.577 +- 0.387 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 all KL = 0.696 +- 0.387 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 all L1 = 0.712 +- 0.331 (in-sample avg dev_std = 0.125)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.665
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0974388
len(reference) = 4911
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.677
SUFF_SIMPLE for r=0.8 class 0.0 = 0.91 +- 0.313 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.732 +- 0.313 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.829 +- 0.313 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.822 +- 0.281 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.413274
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.616
NEC for r=0.05 class 0.0 = 0.201 +- 0.461 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.484 +- 0.461 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.387 +- 0.461 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.358 +- 0.389 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.361036
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.548
NEC for r=0.1 class 0.0 = 0.297 +- 0.455 (in-sample avg dev_std = 0.069)
NEC for r=0.1 class 1.0 = 0.535 +- 0.455 (in-sample avg dev_std = 0.069)
NEC for r=0.1 all KL = 0.477 +- 0.455 (in-sample avg dev_std = 0.069)
NEC for r=0.1 all L1 = 0.429 +- 0.378 (in-sample avg dev_std = 0.069)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254962
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.642
NEC for r=0.2 class 0.0 = 0.391 +- 0.424 (in-sample avg dev_std = 0.441)
NEC for r=0.2 class 1.0 = 0.4 +- 0.424 (in-sample avg dev_std = 0.441)
NEC for r=0.2 all KL = 0.496 +- 0.424 (in-sample avg dev_std = 0.441)
NEC for r=0.2 all L1 = 0.396 +- 0.322 (in-sample avg dev_std = 0.441)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.158738
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.761
NEC for r=0.4 class 0.0 = 0.397 +- 0.394 (in-sample avg dev_std = 0.425)
NEC for r=0.4 class 1.0 = 0.206 +- 0.394 (in-sample avg dev_std = 0.425)
NEC for r=0.4 all KL = 0.371 +- 0.394 (in-sample avg dev_std = 0.425)
NEC for r=0.4 all L1 = 0.291 +- 0.290 (in-sample avg dev_std = 0.425)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.109048
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.792
NEC for r=0.8 class 0.0 = 0.387 +- 0.389 (in-sample avg dev_std = 0.417)
NEC for r=0.8 class 1.0 = 0.156 +- 0.389 (in-sample avg dev_std = 0.417)
NEC for r=0.8 all KL = 0.32 +- 0.389 (in-sample avg dev_std = 0.417)
NEC for r=0.8 all L1 = 0.259 +- 0.286 (in-sample avg dev_std = 0.417)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.791
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22811019999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.493
NEC for r=0.05 class 0.0 = 0.014 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.561 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.303 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.29 +- 0.374 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.791
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1310016
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.493
NEC for r=0.1 class 0.0 = 0.019 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.559 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.307 +- 0.417 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.291 +- 0.374 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.791
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0726636
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.509
NEC for r=0.2 class 0.0 = 0.041 +- 0.413 (in-sample avg dev_std = 0.153)
NEC for r=0.2 class 1.0 = 0.543 +- 0.413 (in-sample avg dev_std = 0.153)
NEC for r=0.2 all KL = 0.326 +- 0.413 (in-sample avg dev_std = 0.153)
NEC for r=0.2 all L1 = 0.294 +- 0.362 (in-sample avg dev_std = 0.153)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.791
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0396364
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.604
NEC for r=0.4 class 0.0 = 0.118 +- 0.396 (in-sample avg dev_std = 0.444)
NEC for r=0.4 class 1.0 = 0.449 +- 0.396 (in-sample avg dev_std = 0.444)
NEC for r=0.4 all KL = 0.397 +- 0.396 (in-sample avg dev_std = 0.444)
NEC for r=0.4 all L1 = 0.285 +- 0.293 (in-sample avg dev_std = 0.444)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.791
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.022072
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.672
NEC for r=0.8 class 0.0 = 0.157 +- 0.372 (in-sample avg dev_std = 0.416)
NEC for r=0.8 class 1.0 = 0.328 +- 0.372 (in-sample avg dev_std = 0.416)
NEC for r=0.8 all KL = 0.333 +- 0.372 (in-sample avg dev_std = 0.416)
NEC for r=0.8 all L1 = 0.243 +- 0.265 (in-sample avg dev_std = 0.416)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.666
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.26781320000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.573
NEC for r=0.05 class 0.0 = 0.084 +- 0.292 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.2 +- 0.292 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.127 +- 0.292 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.141 +- 0.270 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.666
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2021102
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.555
NEC for r=0.1 class 0.0 = 0.099 +- 0.309 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.219 +- 0.309 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.145 +- 0.309 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.158 +- 0.282 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.666
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1403772
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.546
NEC for r=0.2 class 0.0 = 0.114 +- 0.313 (in-sample avg dev_std = 0.003)
NEC for r=0.2 class 1.0 = 0.222 +- 0.313 (in-sample avg dev_std = 0.003)
NEC for r=0.2 all KL = 0.154 +- 0.313 (in-sample avg dev_std = 0.003)
NEC for r=0.2 all L1 = 0.167 +- 0.285 (in-sample avg dev_std = 0.003)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.666
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10781439999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.553
NEC for r=0.4 class 0.0 = 0.142 +- 0.323 (in-sample avg dev_std = 0.179)
NEC for r=0.4 class 1.0 = 0.245 +- 0.323 (in-sample avg dev_std = 0.179)
NEC for r=0.4 all KL = 0.189 +- 0.323 (in-sample avg dev_std = 0.179)
NEC for r=0.4 all L1 = 0.193 +- 0.285 (in-sample avg dev_std = 0.179)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.666
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0974388
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.621
NEC for r=0.8 class 0.0 = 0.159 +- 0.310 (in-sample avg dev_std = 0.280)
NEC for r=0.8 class 1.0 = 0.238 +- 0.310 (in-sample avg dev_std = 0.280)
NEC for r=0.8 all KL = 0.204 +- 0.310 (in-sample avg dev_std = 0.280)
NEC for r=0.8 all L1 = 0.198 +- 0.261 (in-sample avg dev_std = 0.280)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 17:57:20 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 05:57:20 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 05:57:20 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:57:20 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 05:57:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:57:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:57:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:57:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:57:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:57:20 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:57:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0398
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0312
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0530
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0312
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0530

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0398
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0312
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0530
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0312
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0530

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9920 0.9920[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.361
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.338
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.242
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.153
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.110
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.228
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.128
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.069
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.036
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.022
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.271
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.201
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.139
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.107
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.100


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.36095000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.533
SUFF_SIMPLE for r=0.05 class 0.0 = 0.481 +- 0.385 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.536 +- 0.385 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.05 all KL = 0.333 +- 0.385 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.05 all L1 = 0.511 +- 0.303 (in-sample avg dev_std = 0.468)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.337952
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.531
SUFF_SIMPLE for r=0.1 class 0.0 = 0.479 +- 0.388 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.532 +- 0.388 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.1 all KL = 0.329 +- 0.388 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.1 all L1 = 0.508 +- 0.303 (in-sample avg dev_std = 0.454)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.242072
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.567
SUFF_SIMPLE for r=0.2 class 0.0 = 0.478 +- 0.382 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.54 +- 0.382 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.2 all KL = 0.33 +- 0.382 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.2 all L1 = 0.513 +- 0.302 (in-sample avg dev_std = 0.438)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.152696
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.512
SUFF_SIMPLE for r=0.4 class 0.0 = 0.499 +- 0.390 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.479 +- 0.390 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.4 all KL = 0.31 +- 0.390 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.4 all L1 = 0.488 +- 0.312 (in-sample avg dev_std = 0.446)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.110316
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.554
SUFF_SIMPLE for r=0.8 class 0.0 = 0.771 +- 0.465 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.454 +- 0.465 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.518 +- 0.465 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.595 +- 0.387 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.227644
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.432
SUFF_SIMPLE for r=0.05 class 0.0 = 0.519 +- 0.371 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.202 +- 0.371 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.05 all KL = 0.198 +- 0.371 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.05 all L1 = 0.359 +- 0.324 (in-sample avg dev_std = 0.409)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1283276
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.409
SUFF_SIMPLE for r=0.1 class 0.0 = 0.493 +- 0.366 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.197 +- 0.366 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.1 all KL = 0.19 +- 0.366 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.1 all L1 = 0.344 +- 0.319 (in-sample avg dev_std = 0.394)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0689638
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.384
SUFF_SIMPLE for r=0.2 class 0.0 = 0.469 +- 0.357 (in-sample avg dev_std = 0.366)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.187 +- 0.357 (in-sample avg dev_std = 0.366)
SUFF_SIMPLE for r=0.2 all KL = 0.179 +- 0.357 (in-sample avg dev_std = 0.366)
SUFF_SIMPLE for r=0.2 all L1 = 0.327 +- 0.312 (in-sample avg dev_std = 0.366)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0364488
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.336
SUFF_SIMPLE for r=0.4 class 0.0 = 0.431 +- 0.341 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.16 +- 0.341 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.4 all KL = 0.159 +- 0.341 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.4 all L1 = 0.295 +- 0.297 (in-sample avg dev_std = 0.286)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.022016200000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.312
SUFF_SIMPLE for r=0.8 class 0.0 = 0.361 +- 0.341 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.21 +- 0.341 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.161 +- 0.341 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.285 +- 0.298 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.708
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2708354
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.586
SUFF_SIMPLE for r=0.05 class 0.0 = 0.71 +- 0.406 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.539 +- 0.406 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.05 all KL = 0.569 +- 0.406 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.05 all L1 = 0.625 +- 0.316 (in-sample avg dev_std = 0.244)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.708
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2011656
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.604
SUFF_SIMPLE for r=0.1 class 0.0 = 0.706 +- 0.403 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.548 +- 0.403 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.1 all KL = 0.567 +- 0.403 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.1 all L1 = 0.628 +- 0.315 (in-sample avg dev_std = 0.236)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.708
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.13908579999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.603
SUFF_SIMPLE for r=0.2 class 0.0 = 0.729 +- 0.404 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.532 +- 0.404 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.2 all KL = 0.576 +- 0.404 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.2 all L1 = 0.632 +- 0.325 (in-sample avg dev_std = 0.216)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.708
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10683719999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.556
SUFF_SIMPLE for r=0.4 class 0.0 = 0.773 +- 0.412 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.52 +- 0.412 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all KL = 0.61 +- 0.412 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all L1 = 0.648 +- 0.341 (in-sample avg dev_std = 0.182)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.709
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1004552
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.698
SUFF_SIMPLE for r=0.8 class 0.0 = 0.923 +- 0.305 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.726 +- 0.305 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all KL = 0.835 +- 0.305 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all L1 = 0.825 +- 0.268 (in-sample avg dev_std = 0.001)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.36095000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.648
NEC for r=0.05 class 0.0 = 0.133 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.453 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.351 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.31 +- 0.393 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.337952
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.557
NEC for r=0.1 class 0.0 = 0.186 +- 0.476 (in-sample avg dev_std = 0.103)
NEC for r=0.1 class 1.0 = 0.573 +- 0.476 (in-sample avg dev_std = 0.103)
NEC for r=0.1 all KL = 0.458 +- 0.476 (in-sample avg dev_std = 0.103)
NEC for r=0.1 all L1 = 0.401 +- 0.398 (in-sample avg dev_std = 0.103)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.242072
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.719
NEC for r=0.2 class 0.0 = 0.355 +- 0.437 (in-sample avg dev_std = 0.383)
NEC for r=0.2 class 1.0 = 0.269 +- 0.437 (in-sample avg dev_std = 0.383)
NEC for r=0.2 all KL = 0.401 +- 0.437 (in-sample avg dev_std = 0.383)
NEC for r=0.2 all L1 = 0.308 +- 0.338 (in-sample avg dev_std = 0.383)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.152696
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.749
NEC for r=0.4 class 0.0 = 0.456 +- 0.426 (in-sample avg dev_std = 0.366)
NEC for r=0.4 class 1.0 = 0.122 +- 0.426 (in-sample avg dev_std = 0.366)
NEC for r=0.4 all KL = 0.338 +- 0.426 (in-sample avg dev_std = 0.366)
NEC for r=0.4 all L1 = 0.271 +- 0.332 (in-sample avg dev_std = 0.366)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.110316
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.796
NEC for r=0.8 class 0.0 = 0.453 +- 0.411 (in-sample avg dev_std = 0.380)
NEC for r=0.8 class 1.0 = 0.088 +- 0.411 (in-sample avg dev_std = 0.380)
NEC for r=0.8 all KL = 0.317 +- 0.411 (in-sample avg dev_std = 0.380)
NEC for r=0.8 all L1 = 0.251 +- 0.319 (in-sample avg dev_std = 0.380)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.227644
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.491
NEC for r=0.05 class 0.0 = 0.216 +- 0.482 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.736 +- 0.482 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.551 +- 0.482 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.478 +- 0.411 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1283276
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.592
NEC for r=0.1 class 0.0 = 0.208 +- 0.471 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.508 +- 0.471 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.439 +- 0.471 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.359 +- 0.397 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0689638
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.831
NEC for r=0.2 class 0.0 = 0.223 +- 0.387 (in-sample avg dev_std = 0.254)
NEC for r=0.2 class 1.0 = 0.105 +- 0.387 (in-sample avg dev_std = 0.254)
NEC for r=0.2 all KL = 0.249 +- 0.387 (in-sample avg dev_std = 0.254)
NEC for r=0.2 all L1 = 0.163 +- 0.279 (in-sample avg dev_std = 0.254)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0364488
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.802
NEC for r=0.4 class 0.0 = 0.371 +- 0.423 (in-sample avg dev_std = 0.391)
NEC for r=0.4 class 1.0 = 0.053 +- 0.423 (in-sample avg dev_std = 0.391)
NEC for r=0.4 all KL = 0.323 +- 0.423 (in-sample avg dev_std = 0.391)
NEC for r=0.4 all L1 = 0.211 +- 0.299 (in-sample avg dev_std = 0.391)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.022016200000000003
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.722
NEC for r=0.8 class 0.0 = 0.545 +- 0.462 (in-sample avg dev_std = 0.390)
NEC for r=0.8 class 1.0 = 0.129 +- 0.462 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all KL = 0.45 +- 0.462 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all L1 = 0.335 +- 0.367 (in-sample avg dev_std = 0.390)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.708
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2708354
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.587
NEC for r=0.05 class 0.0 = 0.074 +- 0.328 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.269 +- 0.328 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.161 +- 0.328 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.17 +- 0.296 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.708
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2011656
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.562
NEC for r=0.1 class 0.0 = 0.086 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.31 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.191 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.197 +- 0.314 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.708
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.13908579999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.556
NEC for r=0.2 class 0.0 = 0.106 +- 0.350 (in-sample avg dev_std = 0.052)
NEC for r=0.2 class 1.0 = 0.301 +- 0.350 (in-sample avg dev_std = 0.052)
NEC for r=0.2 all KL = 0.195 +- 0.350 (in-sample avg dev_std = 0.052)
NEC for r=0.2 all L1 = 0.202 +- 0.313 (in-sample avg dev_std = 0.052)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.708
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10683719999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.61
NEC for r=0.4 class 0.0 = 0.181 +- 0.357 (in-sample avg dev_std = 0.231)
NEC for r=0.4 class 1.0 = 0.288 +- 0.357 (in-sample avg dev_std = 0.231)
NEC for r=0.4 all KL = 0.241 +- 0.357 (in-sample avg dev_std = 0.231)
NEC for r=0.4 all L1 = 0.234 +- 0.308 (in-sample avg dev_std = 0.231)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.708
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1004552
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.665
NEC for r=0.8 class 0.0 = 0.219 +- 0.327 (in-sample avg dev_std = 0.225)
NEC for r=0.8 class 1.0 = 0.219 +- 0.327 (in-sample avg dev_std = 0.225)
NEC for r=0.8 all KL = 0.228 +- 0.327 (in-sample avg dev_std = 0.225)
NEC for r=0.8 all L1 = 0.219 +- 0.277 (in-sample avg dev_std = 0.225)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 18:15:45 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 06:15:45 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 06:15:45 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:15:45 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 06:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:15:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:15:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:15:45 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:15:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0298
ID Validation ACCURACY: 0.9880
ID Validation Loss: 0.0315
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0329
OOD Validation ACCURACY: 0.9880
OOD Validation Loss: 0.0315
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0329

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0298
ID Validation ACCURACY: 0.9880
ID Validation Loss: 0.0315
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0329
OOD Validation ACCURACY: 0.9880
OOD Validation Loss: 0.0315
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0329

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9880 0.9880[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.387
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.359
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.254
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.162
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.113
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.253
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.144
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.078
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.042
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.023
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.259
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.201
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.146
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.108
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.098


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387144
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.547
SUFF_SIMPLE for r=0.05 class 0.0 = 0.507 +- 0.390 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.542 +- 0.390 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 all KL = 0.389 +- 0.390 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 all L1 = 0.526 +- 0.307 (in-sample avg dev_std = 0.434)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35862
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.533
SUFF_SIMPLE for r=0.1 class 0.0 = 0.503 +- 0.382 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.525 +- 0.382 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.1 all KL = 0.373 +- 0.382 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.1 all L1 = 0.515 +- 0.304 (in-sample avg dev_std = 0.439)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254072
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.547
SUFF_SIMPLE for r=0.2 class 0.0 = 0.505 +- 0.385 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.521 +- 0.385 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.2 all KL = 0.376 +- 0.385 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.2 all L1 = 0.514 +- 0.303 (in-sample avg dev_std = 0.417)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.16170400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.571
SUFF_SIMPLE for r=0.4 class 0.0 = 0.562 +- 0.394 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.486 +- 0.394 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.4 all KL = 0.39 +- 0.394 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.4 all L1 = 0.52 +- 0.306 (in-sample avg dev_std = 0.410)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11291000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.664
SUFF_SIMPLE for r=0.8 class 0.0 = 0.714 +- 0.430 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.613 +- 0.430 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.598 +- 0.430 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.658 +- 0.357 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.902
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2534924
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.463
SUFF_SIMPLE for r=0.05 class 0.0 = 0.684 +- 0.408 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.256 +- 0.408 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.05 all KL = 0.364 +- 0.408 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.05 all L1 = 0.468 +- 0.343 (in-sample avg dev_std = 0.422)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.902
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1439618
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.434
SUFF_SIMPLE for r=0.1 class 0.0 = 0.649 +- 0.403 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.251 +- 0.403 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.1 all KL = 0.348 +- 0.403 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.1 all L1 = 0.448 +- 0.341 (in-sample avg dev_std = 0.406)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.902
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0783842
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.387
SUFF_SIMPLE for r=0.2 class 0.0 = 0.599 +- 0.399 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.24 +- 0.399 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.2 all KL = 0.325 +- 0.399 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.2 all L1 = 0.418 +- 0.338 (in-sample avg dev_std = 0.363)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.902
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0416024
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.337
SUFF_SIMPLE for r=0.4 class 0.0 = 0.567 +- 0.399 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.225 +- 0.399 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.4 all KL = 0.312 +- 0.399 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.4 all L1 = 0.395 +- 0.340 (in-sample avg dev_std = 0.248)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.902
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0228274
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.468
SUFF_SIMPLE for r=0.8 class 0.0 = 0.56 +- 0.419 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.437 +- 0.419 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.444 +- 0.419 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.498 +- 0.355 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.653
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2594706
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.554
SUFF_SIMPLE for r=0.05 class 0.0 = 0.754 +- 0.399 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.583 +- 0.399 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.05 all KL = 0.624 +- 0.399 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.05 all L1 = 0.67 +- 0.318 (in-sample avg dev_std = 0.236)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.653
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.201044
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.56
SUFF_SIMPLE for r=0.1 class 0.0 = 0.755 +- 0.396 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.587 +- 0.396 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.1 all KL = 0.627 +- 0.396 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.1 all L1 = 0.672 +- 0.320 (in-sample avg dev_std = 0.227)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.653
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459106
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.555
SUFF_SIMPLE for r=0.2 class 0.0 = 0.765 +- 0.393 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.597 +- 0.393 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all KL = 0.643 +- 0.393 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all L1 = 0.682 +- 0.323 (in-sample avg dev_std = 0.202)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.653
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1083908
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.554
SUFF_SIMPLE for r=0.4 class 0.0 = 0.799 +- 0.392 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.613 +- 0.392 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.4 all KL = 0.68 +- 0.392 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.4 all L1 = 0.707 +- 0.330 (in-sample avg dev_std = 0.154)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.653
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.097769
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.614
SUFF_SIMPLE for r=0.8 class 0.0 = 0.914 +- 0.291 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.777 +- 0.291 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.858 +- 0.291 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.846 +- 0.265 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387144
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.668
NEC for r=0.05 class 0.0 = 0.089 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.509 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.351 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.321 +- 0.381 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35862
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.52
NEC for r=0.1 class 0.0 = 0.178 +- 0.469 (in-sample avg dev_std = 0.106)
NEC for r=0.1 class 1.0 = 0.658 +- 0.469 (in-sample avg dev_std = 0.106)
NEC for r=0.1 all KL = 0.504 +- 0.469 (in-sample avg dev_std = 0.106)
NEC for r=0.1 all L1 = 0.444 +- 0.391 (in-sample avg dev_std = 0.106)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.254072
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.704
NEC for r=0.2 class 0.0 = 0.308 +- 0.423 (in-sample avg dev_std = 0.379)
NEC for r=0.2 class 1.0 = 0.347 +- 0.423 (in-sample avg dev_std = 0.379)
NEC for r=0.2 all KL = 0.426 +- 0.423 (in-sample avg dev_std = 0.379)
NEC for r=0.2 all L1 = 0.33 +- 0.323 (in-sample avg dev_std = 0.379)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.16170400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.803
NEC for r=0.4 class 0.0 = 0.356 +- 0.403 (in-sample avg dev_std = 0.358)
NEC for r=0.4 class 1.0 = 0.163 +- 0.403 (in-sample avg dev_std = 0.358)
NEC for r=0.4 all KL = 0.319 +- 0.403 (in-sample avg dev_std = 0.358)
NEC for r=0.4 all L1 = 0.249 +- 0.295 (in-sample avg dev_std = 0.358)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.11291000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.82
NEC for r=0.8 class 0.0 = 0.381 +- 0.393 (in-sample avg dev_std = 0.397)
NEC for r=0.8 class 1.0 = 0.119 +- 0.393 (in-sample avg dev_std = 0.397)
NEC for r=0.8 all KL = 0.307 +- 0.393 (in-sample avg dev_std = 0.397)
NEC for r=0.8 all L1 = 0.236 +- 0.283 (in-sample avg dev_std = 0.397)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.902
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2534924
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
NEC for r=0.05 class 0.0 = 0.113 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.781 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.477 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.449 +- 0.397 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.902
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1439618
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.508
NEC for r=0.1 class 0.0 = 0.13 +- 0.443 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.75 +- 0.443 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.475 +- 0.443 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.442 +- 0.392 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.902
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0783842
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.656
NEC for r=0.2 class 0.0 = 0.232 +- 0.410 (in-sample avg dev_std = 0.311)
NEC for r=0.2 class 1.0 = 0.529 +- 0.410 (in-sample avg dev_std = 0.311)
NEC for r=0.2 all KL = 0.455 +- 0.410 (in-sample avg dev_std = 0.311)
NEC for r=0.2 all L1 = 0.382 +- 0.342 (in-sample avg dev_std = 0.311)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.902
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0416024
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.829
NEC for r=0.4 class 0.0 = 0.304 +- 0.386 (in-sample avg dev_std = 0.375)
NEC for r=0.4 class 1.0 = 0.226 +- 0.386 (in-sample avg dev_std = 0.375)
NEC for r=0.4 all KL = 0.341 +- 0.386 (in-sample avg dev_std = 0.375)
NEC for r=0.4 all L1 = 0.265 +- 0.273 (in-sample avg dev_std = 0.375)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.902
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0228274
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.794
NEC for r=0.8 class 0.0 = 0.396 +- 0.411 (in-sample avg dev_std = 0.402)
NEC for r=0.8 class 1.0 = 0.234 +- 0.411 (in-sample avg dev_std = 0.402)
NEC for r=0.8 all KL = 0.38 +- 0.411 (in-sample avg dev_std = 0.402)
NEC for r=0.8 all L1 = 0.314 +- 0.305 (in-sample avg dev_std = 0.402)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.653
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2594706
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.597
NEC for r=0.05 class 0.0 = 0.063 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.171 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.096 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.116 +- 0.235 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.653
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.201044
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.571
NEC for r=0.1 class 0.0 = 0.074 +- 0.281 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.209 +- 0.281 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.124 +- 0.281 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.141 +- 0.264 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.653
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459106
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.555
NEC for r=0.2 class 0.0 = 0.089 +- 0.290 (in-sample avg dev_std = 0.002)
NEC for r=0.2 class 1.0 = 0.217 +- 0.290 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all KL = 0.135 +- 0.290 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all L1 = 0.152 +- 0.270 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.653
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1083908
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.569
NEC for r=0.4 class 0.0 = 0.142 +- 0.328 (in-sample avg dev_std = 0.148)
NEC for r=0.4 class 1.0 = 0.265 +- 0.328 (in-sample avg dev_std = 0.148)
NEC for r=0.4 all KL = 0.196 +- 0.328 (in-sample avg dev_std = 0.148)
NEC for r=0.4 all L1 = 0.203 +- 0.296 (in-sample avg dev_std = 0.148)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.653
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.097769
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.623
NEC for r=0.8 class 0.0 = 0.174 +- 0.328 (in-sample avg dev_std = 0.198)
NEC for r=0.8 class 1.0 = 0.255 +- 0.328 (in-sample avg dev_std = 0.198)
NEC for r=0.8 all KL = 0.223 +- 0.328 (in-sample avg dev_std = 0.198)
NEC for r=0.8 all L1 = 0.214 +- 0.281 (in-sample avg dev_std = 0.198)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 18:34:33 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 06:34:33 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 06:34:33 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:34:33 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 06:34:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:34:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:34:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:34:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:34:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:34:33 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:34:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0222
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0180
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0294
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0180
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0294

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0222
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0180
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0294
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0180
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0294

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9920 0.9920[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.372
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.356
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.258
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.160
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.109
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.146
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.081
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.044
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.024
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.014
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.187
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.154
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.117
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.094
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.087


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.372034
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.523
SUFF_SIMPLE for r=0.05 class 0.0 = 0.474 +- 0.393 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.535 +- 0.393 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.05 all KL = 0.299 +- 0.393 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.05 all L1 = 0.508 +- 0.310 (in-sample avg dev_std = 0.463)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.355744
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.565
SUFF_SIMPLE for r=0.1 class 0.0 = 0.477 +- 0.398 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.558 +- 0.398 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.1 all KL = 0.32 +- 0.398 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.1 all L1 = 0.522 +- 0.317 (in-sample avg dev_std = 0.434)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.258336
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.584
SUFF_SIMPLE for r=0.2 class 0.0 = 0.475 +- 0.393 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.59 +- 0.393 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.2 all KL = 0.337 +- 0.393 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.2 all L1 = 0.539 +- 0.319 (in-sample avg dev_std = 0.441)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.160152
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.532
SUFF_SIMPLE for r=0.4 class 0.0 = 0.479 +- 0.405 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.544 +- 0.405 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.4 all KL = 0.336 +- 0.405 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.4 all L1 = 0.515 +- 0.329 (in-sample avg dev_std = 0.438)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10936000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.612
SUFF_SIMPLE for r=0.8 class 0.0 = 0.698 +- 0.462 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.554 +- 0.462 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.525 +- 0.462 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.618 +- 0.379 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.959
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.14637360000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
SUFF_SIMPLE for r=0.05 class 0.0 = 0.89 +- 0.477 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.218 +- 0.477 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.05 all KL = 0.429 +- 0.477 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.05 all L1 = 0.551 +- 0.397 (in-sample avg dev_std = 0.352)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.959
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0810178
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.487
SUFF_SIMPLE for r=0.1 class 0.0 = 0.872 +- 0.475 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.217 +- 0.475 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.1 all KL = 0.419 +- 0.475 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.1 all L1 = 0.542 +- 0.396 (in-sample avg dev_std = 0.354)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.959
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.043623199999999994
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.476
SUFF_SIMPLE for r=0.2 class 0.0 = 0.866 +- 0.475 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.211 +- 0.475 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.2 all KL = 0.417 +- 0.475 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.2 all L1 = 0.536 +- 0.398 (in-sample avg dev_std = 0.338)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.959
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0235914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.459
SUFF_SIMPLE for r=0.4 class 0.0 = 0.866 +- 0.476 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.197 +- 0.476 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.4 all KL = 0.421 +- 0.476 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.4 all L1 = 0.529 +- 0.404 (in-sample avg dev_std = 0.267)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.959
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.014064600000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.429
SUFF_SIMPLE for r=0.8 class 0.0 = 0.742 +- 0.469 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.273 +- 0.469 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.405 +- 0.469 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.506 +- 0.407 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.66
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1865096
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.581
SUFF_SIMPLE for r=0.05 class 0.0 = 0.68 +- 0.424 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.583 +- 0.424 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.05 all KL = 0.543 +- 0.424 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.05 all L1 = 0.632 +- 0.327 (in-sample avg dev_std = 0.270)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.66
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.15397539999999998
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.592
SUFF_SIMPLE for r=0.1 class 0.0 = 0.683 +- 0.418 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.61 +- 0.418 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.1 all KL = 0.557 +- 0.418 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.1 all L1 = 0.647 +- 0.328 (in-sample avg dev_std = 0.264)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.66
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1173838
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.567
SUFF_SIMPLE for r=0.2 class 0.0 = 0.711 +- 0.410 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.621 +- 0.410 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.2 all KL = 0.589 +- 0.410 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.2 all L1 = 0.666 +- 0.333 (in-sample avg dev_std = 0.249)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.66
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0939026
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.543
SUFF_SIMPLE for r=0.4 class 0.0 = 0.748 +- 0.419 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.6 +- 0.419 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.4 all KL = 0.618 +- 0.419 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.4 all L1 = 0.675 +- 0.347 (in-sample avg dev_std = 0.213)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.661
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08671319999999999
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.618
SUFF_SIMPLE for r=0.8 class 0.0 = 0.93 +- 0.308 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.774 +- 0.308 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.851 +- 0.308 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.853 +- 0.267 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.372034
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.654
NEC for r=0.05 class 0.0 = 0.129 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.455 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.36 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.309 +- 0.394 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.355744
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.551
NEC for r=0.1 class 0.0 = 0.248 +- 0.475 (in-sample avg dev_std = 0.094)
NEC for r=0.1 class 1.0 = 0.54 +- 0.475 (in-sample avg dev_std = 0.094)
NEC for r=0.1 all KL = 0.492 +- 0.475 (in-sample avg dev_std = 0.094)
NEC for r=0.1 all L1 = 0.41 +- 0.400 (in-sample avg dev_std = 0.094)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.258336
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.644
NEC for r=0.2 class 0.0 = 0.422 +- 0.463 (in-sample avg dev_std = 0.358)
NEC for r=0.2 class 1.0 = 0.303 +- 0.463 (in-sample avg dev_std = 0.358)
NEC for r=0.2 all KL = 0.484 +- 0.463 (in-sample avg dev_std = 0.358)
NEC for r=0.2 all L1 = 0.356 +- 0.364 (in-sample avg dev_std = 0.358)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.160152
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.732
NEC for r=0.4 class 0.0 = 0.471 +- 0.439 (in-sample avg dev_std = 0.342)
NEC for r=0.4 class 1.0 = 0.12 +- 0.439 (in-sample avg dev_std = 0.342)
NEC for r=0.4 all KL = 0.365 +- 0.439 (in-sample avg dev_std = 0.342)
NEC for r=0.4 all L1 = 0.276 +- 0.347 (in-sample avg dev_std = 0.342)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10936000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.757
NEC for r=0.8 class 0.0 = 0.467 +- 0.434 (in-sample avg dev_std = 0.382)
NEC for r=0.8 class 1.0 = 0.114 +- 0.434 (in-sample avg dev_std = 0.382)
NEC for r=0.8 all KL = 0.363 +- 0.434 (in-sample avg dev_std = 0.382)
NEC for r=0.8 all L1 = 0.272 +- 0.335 (in-sample avg dev_std = 0.382)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.959
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.14637360000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.596
NEC for r=0.05 class 0.0 = 0.056 +- 0.469 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.637 +- 0.469 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.406 +- 0.469 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.349 +- 0.403 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.959
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0810178
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.58
NEC for r=0.1 class 0.0 = 0.205 +- 0.469 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.538 +- 0.469 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.463 +- 0.469 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.373 +- 0.397 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.959
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.043623199999999994
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.636
NEC for r=0.2 class 0.0 = 0.235 +- 0.465 (in-sample avg dev_std = 0.335)
NEC for r=0.2 class 1.0 = 0.452 +- 0.465 (in-sample avg dev_std = 0.335)
NEC for r=0.2 all KL = 0.472 +- 0.465 (in-sample avg dev_std = 0.335)
NEC for r=0.2 all L1 = 0.344 +- 0.372 (in-sample avg dev_std = 0.335)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.959
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0235914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.733
NEC for r=0.4 class 0.0 = 0.317 +- 0.451 (in-sample avg dev_std = 0.437)
NEC for r=0.4 class 1.0 = 0.235 +- 0.451 (in-sample avg dev_std = 0.437)
NEC for r=0.4 all KL = 0.418 +- 0.451 (in-sample avg dev_std = 0.437)
NEC for r=0.4 all L1 = 0.275 +- 0.334 (in-sample avg dev_std = 0.437)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.959
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.014064600000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.689
NEC for r=0.8 class 0.0 = 0.352 +- 0.467 (in-sample avg dev_std = 0.452)
NEC for r=0.8 class 1.0 = 0.285 +- 0.467 (in-sample avg dev_std = 0.452)
NEC for r=0.8 all KL = 0.465 +- 0.467 (in-sample avg dev_std = 0.452)
NEC for r=0.8 all L1 = 0.318 +- 0.353 (in-sample avg dev_std = 0.452)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.66
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1865096
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.578
NEC for r=0.05 class 0.0 = 0.065 +- 0.298 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.204 +- 0.298 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.127 +- 0.298 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.134 +- 0.272 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.66
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.15397539999999998
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.552
NEC for r=0.1 class 0.0 = 0.08 +- 0.333 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.251 +- 0.333 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.163 +- 0.333 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.165 +- 0.299 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.66
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1173838
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.543
NEC for r=0.2 class 0.0 = 0.101 +- 0.346 (in-sample avg dev_std = 0.013)
NEC for r=0.2 class 1.0 = 0.259 +- 0.346 (in-sample avg dev_std = 0.013)
NEC for r=0.2 all KL = 0.182 +- 0.346 (in-sample avg dev_std = 0.013)
NEC for r=0.2 all L1 = 0.179 +- 0.308 (in-sample avg dev_std = 0.013)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.66
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0939026
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.587
NEC for r=0.4 class 0.0 = 0.168 +- 0.362 (in-sample avg dev_std = 0.211)
NEC for r=0.4 class 1.0 = 0.252 +- 0.362 (in-sample avg dev_std = 0.211)
NEC for r=0.4 all KL = 0.226 +- 0.362 (in-sample avg dev_std = 0.211)
NEC for r=0.4 all L1 = 0.209 +- 0.313 (in-sample avg dev_std = 0.211)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.66
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08671319999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.623
NEC for r=0.8 class 0.0 = 0.219 +- 0.366 (in-sample avg dev_std = 0.224)
NEC for r=0.8 class 1.0 = 0.243 +- 0.366 (in-sample avg dev_std = 0.224)
NEC for r=0.8 all KL = 0.265 +- 0.366 (in-sample avg dev_std = 0.224)
NEC for r=0.8 all L1 = 0.231 +- 0.302 (in-sample avg dev_std = 0.224)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 18:53:23 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 06:53:23 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 06:53:23 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:53:23 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 06:53:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:53:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:53:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:53:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:53:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:53:23 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:53:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9865
Train Loss: 0.0472
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0524
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0595
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0524
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0595

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9865
Train Loss: 0.0472
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0524
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0595
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0524
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0595

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.367
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.347
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.254
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.164
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.113
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.243
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.140
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.077
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.042
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.024
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.285
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.216
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.151
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.114
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.101


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.36747199999999997
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.52
SUFF_SIMPLE for r=0.05 class 0.0 = 0.496 +- 0.388 (in-sample avg dev_std = 0.436)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.49 +- 0.388 (in-sample avg dev_std = 0.436)
SUFF_SIMPLE for r=0.05 all KL = 0.365 +- 0.388 (in-sample avg dev_std = 0.436)
SUFF_SIMPLE for r=0.05 all L1 = 0.493 +- 0.300 (in-sample avg dev_std = 0.436)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.34686
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.495
SUFF_SIMPLE for r=0.1 class 0.0 = 0.473 +- 0.382 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.484 +- 0.382 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.1 all KL = 0.347 +- 0.382 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.1 all L1 = 0.479 +- 0.303 (in-sample avg dev_std = 0.421)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25358600000000003
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.483
SUFF_SIMPLE for r=0.2 class 0.0 = 0.458 +- 0.381 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.482 +- 0.381 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.2 all KL = 0.339 +- 0.381 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.2 all L1 = 0.471 +- 0.303 (in-sample avg dev_std = 0.405)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.163798
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.516
SUFF_SIMPLE for r=0.4 class 0.0 = 0.5 +- 0.378 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.465 +- 0.378 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.4 all KL = 0.351 +- 0.378 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.4 all L1 = 0.48 +- 0.299 (in-sample avg dev_std = 0.403)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.113434
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.652
SUFF_SIMPLE for r=0.8 class 0.0 = 0.682 +- 0.425 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.596 +- 0.425 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.586 +- 0.425 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.635 +- 0.352 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.24262579999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.479
SUFF_SIMPLE for r=0.05 class 0.0 = 0.843 +- 0.431 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.3 +- 0.431 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.05 all KL = 0.491 +- 0.431 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.05 all L1 = 0.569 +- 0.362 (in-sample avg dev_std = 0.293)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13994340000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.452
SUFF_SIMPLE for r=0.1 class 0.0 = 0.804 +- 0.432 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.295 +- 0.432 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.1 all KL = 0.472 +- 0.432 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.1 all L1 = 0.548 +- 0.363 (in-sample avg dev_std = 0.275)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0773724
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.415
SUFF_SIMPLE for r=0.2 class 0.0 = 0.764 +- 0.430 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.285 +- 0.430 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 all KL = 0.446 +- 0.430 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 all L1 = 0.522 +- 0.365 (in-sample avg dev_std = 0.226)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0415842
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.36
SUFF_SIMPLE for r=0.4 class 0.0 = 0.7 +- 0.426 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.271 +- 0.426 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.4 all KL = 0.406 +- 0.426 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.4 all L1 = 0.484 +- 0.364 (in-sample avg dev_std = 0.152)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0236292
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.462
SUFF_SIMPLE for r=0.8 class 0.0 = 0.771 +- 0.429 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.362 +- 0.429 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.499 +- 0.429 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.565 +- 0.364 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.685
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2845954
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.547
SUFF_SIMPLE for r=0.05 class 0.0 = 0.753 +- 0.419 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.523 +- 0.419 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.05 all KL = 0.596 +- 0.419 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.05 all L1 = 0.639 +- 0.344 (in-sample avg dev_std = 0.236)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.685
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.21607020000000002
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.534
SUFF_SIMPLE for r=0.1 class 0.0 = 0.739 +- 0.421 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.526 +- 0.421 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.1 all KL = 0.589 +- 0.421 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.1 all L1 = 0.634 +- 0.348 (in-sample avg dev_std = 0.213)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.685
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15108020000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.534
SUFF_SIMPLE for r=0.2 class 0.0 = 0.748 +- 0.420 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.527 +- 0.420 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 all KL = 0.596 +- 0.420 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 all L1 = 0.639 +- 0.351 (in-sample avg dev_std = 0.198)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.685
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11358539999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.565
SUFF_SIMPLE for r=0.4 class 0.0 = 0.827 +- 0.402 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.559 +- 0.402 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.4 all KL = 0.663 +- 0.402 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.4 all L1 = 0.695 +- 0.339 (in-sample avg dev_std = 0.172)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.686
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1012918
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.659
SUFF_SIMPLE for r=0.8 class 0.0 = 0.915 +- 0.297 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.743 +- 0.297 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all KL = 0.841 +- 0.297 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all L1 = 0.83 +- 0.270 (in-sample avg dev_std = 0.001)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.36747199999999997
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.64
NEC for r=0.05 class 0.0 = 0.164 +- 0.447 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.472 +- 0.447 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.363 +- 0.447 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.334 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.34686
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.518
NEC for r=0.1 class 0.0 = 0.273 +- 0.459 (in-sample avg dev_std = 0.101)
NEC for r=0.1 class 1.0 = 0.594 +- 0.459 (in-sample avg dev_std = 0.101)
NEC for r=0.1 all KL = 0.505 +- 0.459 (in-sample avg dev_std = 0.101)
NEC for r=0.1 all L1 = 0.451 +- 0.385 (in-sample avg dev_std = 0.101)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25358600000000003
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.669
NEC for r=0.2 class 0.0 = 0.36 +- 0.423 (in-sample avg dev_std = 0.369)
NEC for r=0.2 class 1.0 = 0.36 +- 0.423 (in-sample avg dev_std = 0.369)
NEC for r=0.2 all KL = 0.439 +- 0.423 (in-sample avg dev_std = 0.369)
NEC for r=0.2 all L1 = 0.36 +- 0.331 (in-sample avg dev_std = 0.369)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.163798
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.739
NEC for r=0.4 class 0.0 = 0.407 +- 0.415 (in-sample avg dev_std = 0.362)
NEC for r=0.4 class 1.0 = 0.21 +- 0.415 (in-sample avg dev_std = 0.362)
NEC for r=0.4 all KL = 0.349 +- 0.415 (in-sample avg dev_std = 0.362)
NEC for r=0.4 all L1 = 0.298 +- 0.319 (in-sample avg dev_std = 0.362)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.113434
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.767
NEC for r=0.8 class 0.0 = 0.431 +- 0.405 (in-sample avg dev_std = 0.375)
NEC for r=0.8 class 1.0 = 0.15 +- 0.405 (in-sample avg dev_std = 0.375)
NEC for r=0.8 all KL = 0.322 +- 0.405 (in-sample avg dev_std = 0.375)
NEC for r=0.8 all L1 = 0.275 +- 0.314 (in-sample avg dev_std = 0.375)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.24262579999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.483
NEC for r=0.05 class 0.0 = 0.062 +- 0.436 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.724 +- 0.436 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.419 +- 0.436 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.396 +- 0.387 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13994340000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.495
NEC for r=0.1 class 0.0 = 0.063 +- 0.432 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.71 +- 0.432 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.415 +- 0.432 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.389 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0773724
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.627
NEC for r=0.2 class 0.0 = 0.058 +- 0.392 (in-sample avg dev_std = 0.250)
NEC for r=0.2 class 1.0 = 0.567 +- 0.392 (in-sample avg dev_std = 0.250)
NEC for r=0.2 all KL = 0.35 +- 0.392 (in-sample avg dev_std = 0.250)
NEC for r=0.2 all L1 = 0.314 +- 0.334 (in-sample avg dev_std = 0.250)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0415842
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.756
NEC for r=0.4 class 0.0 = 0.195 +- 0.368 (in-sample avg dev_std = 0.419)
NEC for r=0.4 class 1.0 = 0.305 +- 0.368 (in-sample avg dev_std = 0.419)
NEC for r=0.4 all KL = 0.334 +- 0.368 (in-sample avg dev_std = 0.419)
NEC for r=0.4 all L1 = 0.25 +- 0.238 (in-sample avg dev_std = 0.419)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0236292
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.697
NEC for r=0.8 class 0.0 = 0.307 +- 0.399 (in-sample avg dev_std = 0.370)
NEC for r=0.8 class 1.0 = 0.273 +- 0.399 (in-sample avg dev_std = 0.370)
NEC for r=0.8 all KL = 0.355 +- 0.399 (in-sample avg dev_std = 0.370)
NEC for r=0.8 all L1 = 0.29 +- 0.284 (in-sample avg dev_std = 0.370)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.685
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2845954
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.583
NEC for r=0.05 class 0.0 = 0.072 +- 0.299 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.22 +- 0.299 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.133 +- 0.299 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.145 +- 0.274 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.685
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.21607020000000002
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.55
NEC for r=0.1 class 0.0 = 0.083 +- 0.330 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.267 +- 0.330 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.165 +- 0.330 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.174 +- 0.298 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.685
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15108020000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.545
NEC for r=0.2 class 0.0 = 0.101 +- 0.335 (in-sample avg dev_std = 0.014)
NEC for r=0.2 class 1.0 = 0.265 +- 0.335 (in-sample avg dev_std = 0.014)
NEC for r=0.2 all KL = 0.174 +- 0.335 (in-sample avg dev_std = 0.014)
NEC for r=0.2 all L1 = 0.182 +- 0.300 (in-sample avg dev_std = 0.014)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.685
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11358539999999998
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.576
NEC for r=0.4 class 0.0 = 0.144 +- 0.339 (in-sample avg dev_std = 0.214)
NEC for r=0.4 class 1.0 = 0.261 +- 0.339 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all KL = 0.205 +- 0.339 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all L1 = 0.202 +- 0.290 (in-sample avg dev_std = 0.214)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.685
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1012918
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.655
NEC for r=0.8 class 0.0 = 0.159 +- 0.304 (in-sample avg dev_std = 0.223)
NEC for r=0.8 class 1.0 = 0.203 +- 0.304 (in-sample avg dev_std = 0.223)
NEC for r=0.8 all KL = 0.186 +- 0.304 (in-sample avg dev_std = 0.223)
NEC for r=0.8 all L1 = 0.181 +- 0.255 (in-sample avg dev_std = 0.223)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 19:12:13 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 07:12:13 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 07:12:13 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:12:13 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 07:12:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:12:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:12:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:12:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:12:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:12:13 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:12:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9830
Train Loss: 0.0549
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0538
ID Test ACCURACY: 0.9780
ID Test Loss: 0.0652
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0538
OOD Test ACCURACY: 0.9780
OOD Test Loss: 0.0652

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9830
Train Loss: 0.0549
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0538
ID Test ACCURACY: 0.9780
ID Test Loss: 0.0652
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0538
OOD Test ACCURACY: 0.9780
OOD Test Loss: 0.0652

[0m[1;37mINFO[0m: [1mChartInfo 0.9780 0.9780 0.9780 0.9780 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.395
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.364
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.259
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.159
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.109
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.294
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.169
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.092
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.049
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.026
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.304
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.229
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.157
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.116
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.102


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39454
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.519
SUFF_SIMPLE for r=0.05 class 0.0 = 0.536 +- 0.393 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.498 +- 0.393 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.05 all KL = 0.403 +- 0.393 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.05 all L1 = 0.515 +- 0.305 (in-sample avg dev_std = 0.433)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.364388
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.512 +- 0.399 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.504 +- 0.399 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.1 all KL = 0.398 +- 0.399 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.1 all L1 = 0.507 +- 0.315 (in-sample avg dev_std = 0.414)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25869400000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.486
SUFF_SIMPLE for r=0.2 class 0.0 = 0.498 +- 0.390 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.491 +- 0.390 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.2 all KL = 0.38 +- 0.390 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.2 all L1 = 0.494 +- 0.310 (in-sample avg dev_std = 0.406)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.159314
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.557
SUFF_SIMPLE for r=0.4 class 0.0 = 0.579 +- 0.407 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.493 +- 0.407 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.4 all KL = 0.434 +- 0.407 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.4 all L1 = 0.531 +- 0.321 (in-sample avg dev_std = 0.388)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10906999999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.644
SUFF_SIMPLE for r=0.8 class 0.0 = 0.747 +- 0.430 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.559 +- 0.430 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.601 +- 0.430 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.643 +- 0.364 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.615
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.294444
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.888 +- 0.368 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.675 +- 0.368 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.05 all KL = 0.729 +- 0.368 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.05 all L1 = 0.781 +- 0.294 (in-sample avg dev_std = 0.253)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.615
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.16908679999999998
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.462
SUFF_SIMPLE for r=0.1 class 0.0 = 0.847 +- 0.381 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.68 +- 0.381 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.1 all KL = 0.709 +- 0.381 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.1 all L1 = 0.763 +- 0.307 (in-sample avg dev_std = 0.249)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.615
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0923886
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.418
SUFF_SIMPLE for r=0.2 class 0.0 = 0.788 +- 0.399 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.687 +- 0.399 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 all KL = 0.679 +- 0.399 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 all L1 = 0.737 +- 0.324 (in-sample avg dev_std = 0.203)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.615
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0488908
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.381
SUFF_SIMPLE for r=0.4 class 0.0 = 0.752 +- 0.409 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.699 +- 0.409 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.4 all KL = 0.664 +- 0.409 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.4 all L1 = 0.725 +- 0.334 (in-sample avg dev_std = 0.130)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.615
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0262106
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.482
SUFF_SIMPLE for r=0.8 class 0.0 = 0.914 +- 0.329 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.734 +- 0.329 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.796 +- 0.329 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.824 +- 0.274 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.659
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3040794
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.532
SUFF_SIMPLE for r=0.05 class 0.0 = 0.76 +- 0.414 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.543 +- 0.414 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.05 all KL = 0.619 +- 0.414 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.05 all L1 = 0.653 +- 0.339 (in-sample avg dev_std = 0.223)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.659
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.228566
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.535
SUFF_SIMPLE for r=0.1 class 0.0 = 0.758 +- 0.414 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.549 +- 0.414 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.1 all KL = 0.622 +- 0.414 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.1 all L1 = 0.655 +- 0.341 (in-sample avg dev_std = 0.206)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.659
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15688000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.549
SUFF_SIMPLE for r=0.2 class 0.0 = 0.784 +- 0.406 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.56 +- 0.406 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.2 all KL = 0.646 +- 0.406 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.2 all L1 = 0.674 +- 0.337 (in-sample avg dev_std = 0.194)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11550140000000002
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.579
SUFF_SIMPLE for r=0.4 class 0.0 = 0.862 +- 0.384 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.587 +- 0.384 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.4 all KL = 0.707 +- 0.384 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.4 all L1 = 0.726 +- 0.322 (in-sample avg dev_std = 0.157)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.66
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10218020000000001
len(reference) = 4990
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.655
SUFF_SIMPLE for r=0.8 class 0.0 = 0.914 +- 0.305 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.726 +- 0.305 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all KL = 0.832 +- 0.305 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all L1 = 0.821 +- 0.277 (in-sample avg dev_std = 0.001)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.39454
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.622
NEC for r=0.05 class 0.0 = 0.143 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.505 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.372 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.343 +- 0.387 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.364388
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.523
NEC for r=0.1 class 0.0 = 0.234 +- 0.460 (in-sample avg dev_std = 0.095)
NEC for r=0.1 class 1.0 = 0.601 +- 0.460 (in-sample avg dev_std = 0.095)
NEC for r=0.1 all KL = 0.488 +- 0.460 (in-sample avg dev_std = 0.095)
NEC for r=0.1 all L1 = 0.437 +- 0.385 (in-sample avg dev_std = 0.095)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.25869400000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.699
NEC for r=0.2 class 0.0 = 0.296 +- 0.417 (in-sample avg dev_std = 0.364)
NEC for r=0.2 class 1.0 = 0.357 +- 0.417 (in-sample avg dev_std = 0.364)
NEC for r=0.2 all KL = 0.404 +- 0.417 (in-sample avg dev_std = 0.364)
NEC for r=0.2 all L1 = 0.33 +- 0.324 (in-sample avg dev_std = 0.364)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.159314
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.8
NEC for r=0.4 class 0.0 = 0.336 +- 0.395 (in-sample avg dev_std = 0.376)
NEC for r=0.4 class 1.0 = 0.163 +- 0.395 (in-sample avg dev_std = 0.376)
NEC for r=0.4 all KL = 0.293 +- 0.395 (in-sample avg dev_std = 0.376)
NEC for r=0.4 all L1 = 0.24 +- 0.284 (in-sample avg dev_std = 0.376)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10906999999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.797
NEC for r=0.8 class 0.0 = 0.371 +- 0.397 (in-sample avg dev_std = 0.391)
NEC for r=0.8 class 1.0 = 0.144 +- 0.397 (in-sample avg dev_std = 0.391)
NEC for r=0.8 all KL = 0.302 +- 0.397 (in-sample avg dev_std = 0.391)
NEC for r=0.8 all L1 = 0.245 +- 0.289 (in-sample avg dev_std = 0.391)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.615
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.294444
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.494
NEC for r=0.05 class 0.0 = 0.008 +- 0.273 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.29 +- 0.273 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.136 +- 0.273 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.15 +- 0.270 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.615
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.16908679999999998
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.493
NEC for r=0.1 class 0.0 = 0.014 +- 0.278 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.287 +- 0.278 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.142 +- 0.278 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.151 +- 0.269 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.615
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0923886
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.525
NEC for r=0.2 class 0.0 = 0.019 +- 0.268 (in-sample avg dev_std = 0.117)
NEC for r=0.2 class 1.0 = 0.274 +- 0.268 (in-sample avg dev_std = 0.117)
NEC for r=0.2 all KL = 0.147 +- 0.268 (in-sample avg dev_std = 0.117)
NEC for r=0.2 all L1 = 0.147 +- 0.251 (in-sample avg dev_std = 0.117)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.615
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0488908
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.608
NEC for r=0.4 class 0.0 = 0.068 +- 0.298 (in-sample avg dev_std = 0.294)
NEC for r=0.4 class 1.0 = 0.241 +- 0.298 (in-sample avg dev_std = 0.294)
NEC for r=0.4 all KL = 0.204 +- 0.298 (in-sample avg dev_std = 0.294)
NEC for r=0.4 all L1 = 0.155 +- 0.202 (in-sample avg dev_std = 0.294)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.615
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0262106
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.639
NEC for r=0.8 class 0.0 = 0.126 +- 0.338 (in-sample avg dev_std = 0.291)
NEC for r=0.8 class 1.0 = 0.263 +- 0.338 (in-sample avg dev_std = 0.291)
NEC for r=0.8 all KL = 0.252 +- 0.338 (in-sample avg dev_std = 0.291)
NEC for r=0.8 all L1 = 0.195 +- 0.235 (in-sample avg dev_std = 0.291)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.659
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3040794
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.574
NEC for r=0.05 class 0.0 = 0.077 +- 0.282 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.199 +- 0.282 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.123 +- 0.282 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.137 +- 0.262 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.659
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.228566
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.552
NEC for r=0.1 class 0.0 = 0.087 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.235 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.148 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.16 +- 0.284 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.659
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15688000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.543
NEC for r=0.2 class 0.0 = 0.102 +- 0.314 (in-sample avg dev_std = 0.002)
NEC for r=0.2 class 1.0 = 0.232 +- 0.314 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all KL = 0.155 +- 0.314 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all L1 = 0.166 +- 0.284 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11550140000000002
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.591
NEC for r=0.4 class 0.0 = 0.138 +- 0.292 (in-sample avg dev_std = 0.178)
NEC for r=0.4 class 1.0 = 0.196 +- 0.292 (in-sample avg dev_std = 0.178)
NEC for r=0.4 all KL = 0.156 +- 0.292 (in-sample avg dev_std = 0.178)
NEC for r=0.4 all L1 = 0.166 +- 0.257 (in-sample avg dev_std = 0.178)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.659
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10218020000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.64
NEC for r=0.8 class 0.0 = 0.159 +- 0.295 (in-sample avg dev_std = 0.229)
NEC for r=0.8 class 1.0 = 0.215 +- 0.295 (in-sample avg dev_std = 0.229)
NEC for r=0.8 all KL = 0.187 +- 0.295 (in-sample avg dev_std = 0.229)
NEC for r=0.8 all L1 = 0.186 +- 0.250 (in-sample avg dev_std = 0.229)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.298, 0.309, 0.277, 0.325, 0.486], 'all_L1': [0.469, 0.474, 0.452, 0.479, 0.574]}), defaultdict(<class 'list'>, {'all_KL': [0.348, 0.347, 0.326, 0.37, 0.545], 'all_L1': [0.515, 0.517, 0.506, 0.531, 0.622]}), defaultdict(<class 'list'>, {'all_KL': [0.362, 0.343, 0.329, 0.411, 0.571], 'all_L1': [0.496, 0.479, 0.47, 0.531, 0.638]}), defaultdict(<class 'list'>, {'all_KL': [0.366, 0.383, 0.374, 0.397, 0.605], 'all_L1': [0.496, 0.5, 0.498, 0.52, 0.662]}), defaultdict(<class 'list'>, {'all_KL': [0.397, 0.402, 0.394, 0.45, 0.667], 'all_L1': [0.51, 0.513, 0.51, 0.56, 0.705]}), defaultdict(<class 'list'>, {'all_KL': [0.333, 0.329, 0.33, 0.31, 0.518], 'all_L1': [0.511, 0.508, 0.513, 0.488, 0.595]}), defaultdict(<class 'list'>, {'all_KL': [0.389, 0.373, 0.376, 0.39, 0.598], 'all_L1': [0.526, 0.515, 0.514, 0.52, 0.658]}), defaultdict(<class 'list'>, {'all_KL': [0.299, 0.32, 0.337, 0.336, 0.525], 'all_L1': [0.508, 0.522, 0.539, 0.515, 0.618]}), defaultdict(<class 'list'>, {'all_KL': [0.365, 0.347, 0.339, 0.351, 0.586], 'all_L1': [0.493, 0.479, 0.471, 0.48, 0.635]}), defaultdict(<class 'list'>, {'all_KL': [0.403, 0.398, 0.38, 0.434, 0.601], 'all_L1': [0.515, 0.507, 0.494, 0.531, 0.643]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.366, 0.515, 0.47, 0.359, 0.349], 'all_L1': [0.323, 0.439, 0.351, 0.287, 0.275]}), defaultdict(<class 'list'>, {'all_KL': [0.402, 0.555, 0.491, 0.371, 0.328], 'all_L1': [0.354, 0.48, 0.368, 0.284, 0.24]}), defaultdict(<class 'list'>, {'all_KL': [0.389, 0.439, 0.411, 0.378, 0.345], 'all_L1': [0.353, 0.391, 0.335, 0.316, 0.286]}), defaultdict(<class 'list'>, {'all_KL': [0.344, 0.422, 0.446, 0.357, 0.326], 'all_L1': [0.315, 0.37, 0.345, 0.275, 0.258]}), defaultdict(<class 'list'>, {'all_KL': [0.387, 0.477, 0.496, 0.371, 0.32], 'all_L1': [0.358, 0.429, 0.396, 0.291, 0.259]}), defaultdict(<class 'list'>, {'all_KL': [0.351, 0.458, 0.401, 0.338, 0.317], 'all_L1': [0.31, 0.401, 0.308, 0.271, 0.251]}), defaultdict(<class 'list'>, {'all_KL': [0.351, 0.504, 0.426, 0.319, 0.307], 'all_L1': [0.321, 0.444, 0.33, 0.249, 0.236]}), defaultdict(<class 'list'>, {'all_KL': [0.36, 0.492, 0.484, 0.365, 0.363], 'all_L1': [0.309, 0.41, 0.356, 0.276, 0.272]}), defaultdict(<class 'list'>, {'all_KL': [0.363, 0.505, 0.439, 0.349, 0.322], 'all_L1': [0.334, 0.451, 0.36, 0.298, 0.275]}), defaultdict(<class 'list'>, {'all_KL': [0.372, 0.488, 0.404, 0.293, 0.302], 'all_L1': [0.343, 0.437, 0.33, 0.24, 0.245]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.244, 0.224, 0.202, 0.212, 0.172], 'all_L1': [0.377, 0.358, 0.338, 0.337, 0.297]}), defaultdict(<class 'list'>, {'all_KL': [0.421, 0.405, 0.387, 0.369, 0.489], 'all_L1': [0.534, 0.516, 0.488, 0.46, 0.559]}), defaultdict(<class 'list'>, {'all_KL': [0.61, 0.588, 0.569, 0.542, 0.52], 'all_L1': [0.666, 0.649, 0.631, 0.607, 0.592]}), defaultdict(<class 'list'>, {'all_KL': [0.623, 0.596, 0.577, 0.575, 0.705], 'all_L1': [0.689, 0.666, 0.643, 0.639, 0.731]}), defaultdict(<class 'list'>, {'all_KL': [0.601, 0.59, 0.574, 0.551, 0.746], 'all_L1': [0.677, 0.668, 0.65, 0.621, 0.758]}), defaultdict(<class 'list'>, {'all_KL': [0.198, 0.19, 0.179, 0.159, 0.161], 'all_L1': [0.359, 0.344, 0.327, 0.295, 0.285]}), defaultdict(<class 'list'>, {'all_KL': [0.364, 0.348, 0.325, 0.312, 0.444], 'all_L1': [0.468, 0.448, 0.418, 0.395, 0.498]}), defaultdict(<class 'list'>, {'all_KL': [0.429, 0.419, 0.417, 0.421, 0.405], 'all_L1': [0.551, 0.542, 0.536, 0.529, 0.506]}), defaultdict(<class 'list'>, {'all_KL': [0.491, 0.472, 0.446, 0.406, 0.499], 'all_L1': [0.569, 0.548, 0.522, 0.484, 0.565]}), defaultdict(<class 'list'>, {'all_KL': [0.729, 0.709, 0.679, 0.664, 0.796], 'all_L1': [0.781, 0.763, 0.737, 0.725, 0.824]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.609, 0.469, 0.337, 0.425, 0.553], 'all_L1': [0.53, 0.387, 0.232, 0.266, 0.393]}), defaultdict(<class 'list'>, {'all_KL': [0.446, 0.476, 0.429, 0.317, 0.38], 'all_L1': [0.404, 0.407, 0.329, 0.225, 0.287]}), defaultdict(<class 'list'>, {'all_KL': [0.321, 0.258, 0.18, 0.231, 0.286], 'all_L1': [0.307, 0.252, 0.185, 0.185, 0.236]}), defaultdict(<class 'list'>, {'all_KL': [0.293, 0.305, 0.256, 0.308, 0.333], 'all_L1': [0.281, 0.285, 0.253, 0.238, 0.26]}), defaultdict(<class 'list'>, {'all_KL': [0.303, 0.307, 0.326, 0.397, 0.333], 'all_L1': [0.29, 0.291, 0.294, 0.285, 0.243]}), defaultdict(<class 'list'>, {'all_KL': [0.551, 0.439, 0.249, 0.323, 0.45], 'all_L1': [0.478, 0.359, 0.163, 0.211, 0.335]}), defaultdict(<class 'list'>, {'all_KL': [0.477, 0.475, 0.455, 0.341, 0.38], 'all_L1': [0.449, 0.442, 0.382, 0.265, 0.314]}), defaultdict(<class 'list'>, {'all_KL': [0.406, 0.463, 0.472, 0.418, 0.465], 'all_L1': [0.349, 0.373, 0.344, 0.275, 0.318]}), defaultdict(<class 'list'>, {'all_KL': [0.419, 0.415, 0.35, 0.334, 0.355], 'all_L1': [0.396, 0.389, 0.314, 0.25, 0.29]}), defaultdict(<class 'list'>, {'all_KL': [0.136, 0.142, 0.147, 0.204, 0.252], 'all_L1': [0.15, 0.151, 0.147, 0.155, 0.195]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.597, 0.599, 0.618, 0.685, 0.826], 'all_L1': [0.646, 0.649, 0.662, 0.713, 0.825]}), defaultdict(<class 'list'>, {'all_KL': [0.577, 0.577, 0.589, 0.645, 0.83], 'all_L1': [0.638, 0.639, 0.65, 0.689, 0.827]}), defaultdict(<class 'list'>, {'all_KL': [0.58, 0.581, 0.607, 0.68, 0.845], 'all_L1': [0.635, 0.635, 0.654, 0.71, 0.844]}), defaultdict(<class 'list'>, {'all_KL': [0.646, 0.65, 0.662, 0.746, 0.85], 'all_L1': [0.689, 0.69, 0.701, 0.77, 0.849]}), defaultdict(<class 'list'>, {'all_KL': [0.599, 0.597, 0.623, 0.696, 0.829], 'all_L1': [0.63, 0.63, 0.653, 0.712, 0.822]}), defaultdict(<class 'list'>, {'all_KL': [0.569, 0.567, 0.576, 0.61, 0.835], 'all_L1': [0.625, 0.628, 0.632, 0.648, 0.825]}), defaultdict(<class 'list'>, {'all_KL': [0.624, 0.627, 0.643, 0.68, 0.858], 'all_L1': [0.67, 0.672, 0.682, 0.707, 0.846]}), defaultdict(<class 'list'>, {'all_KL': [0.543, 0.557, 0.589, 0.618, 0.851], 'all_L1': [0.632, 0.647, 0.666, 0.675, 0.853]}), defaultdict(<class 'list'>, {'all_KL': [0.596, 0.589, 0.596, 0.663, 0.841], 'all_L1': [0.639, 0.634, 0.639, 0.695, 0.83]}), defaultdict(<class 'list'>, {'all_KL': [0.619, 0.622, 0.646, 0.707, 0.832], 'all_L1': [0.653, 0.655, 0.674, 0.726, 0.821]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.109, 0.141, 0.152, 0.215, 0.238], 'all_L1': [0.124, 0.152, 0.163, 0.214, 0.224]}), defaultdict(<class 'list'>, {'all_KL': [0.138, 0.169, 0.183, 0.24, 0.235], 'all_L1': [0.147, 0.174, 0.186, 0.229, 0.216]}), defaultdict(<class 'list'>, {'all_KL': [0.137, 0.169, 0.177, 0.244, 0.223], 'all_L1': [0.147, 0.175, 0.184, 0.234, 0.208]}), defaultdict(<class 'list'>, {'all_KL': [0.083, 0.1, 0.109, 0.128, 0.187], 'all_L1': [0.097, 0.113, 0.119, 0.129, 0.172]}), defaultdict(<class 'list'>, {'all_KL': [0.127, 0.145, 0.154, 0.189, 0.204], 'all_L1': [0.141, 0.158, 0.167, 0.193, 0.198]}), defaultdict(<class 'list'>, {'all_KL': [0.161, 0.191, 0.195, 0.241, 0.228], 'all_L1': [0.17, 0.197, 0.202, 0.234, 0.219]}), defaultdict(<class 'list'>, {'all_KL': [0.096, 0.124, 0.135, 0.196, 0.223], 'all_L1': [0.116, 0.141, 0.152, 0.203, 0.214]}), defaultdict(<class 'list'>, {'all_KL': [0.127, 0.163, 0.182, 0.226, 0.265], 'all_L1': [0.134, 0.165, 0.179, 0.209, 0.231]}), defaultdict(<class 'list'>, {'all_KL': [0.133, 0.165, 0.174, 0.205, 0.186], 'all_L1': [0.145, 0.174, 0.182, 0.202, 0.181]}), defaultdict(<class 'list'>, {'all_KL': [0.123, 0.148, 0.155, 0.156, 0.187], 'all_L1': [0.137, 0.16, 0.166, 0.166, 0.186]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.504 +- 0.015, 0.501 +- 0.017, 0.497 +- 0.024, 0.516 +- 0.025, 0.635 +- 0.035
suff_simple class all_KL  =  0.356 +- 0.035, 0.355 +- 0.031, 0.346 +- 0.033, 0.377 +- 0.045, 0.570 +- 0.050
[[0.4752500057220459, 0.4672499895095825, 0.45124998688697815, 0.5052499771118164, 0.5320000052452087], [0.5382500290870667, 0.5354999899864197, 0.5507500171661377, 0.5917500257492065, 0.6159999966621399], [0.5074999928474426, 0.4827499985694885, 0.48774999380111694, 0.5684999823570251, 0.6299999952316284], [0.5077499747276306, 0.4909999966621399, 0.503250002861023, 0.5487499833106995, 0.6700000166893005], [0.5274999737739563, 0.5235000252723694, 0.5299999713897705, 0.6242499947547913, 0.7459999918937683], [0.5329999923706055, 0.531000018119812, 0.5674999952316284, 0.5115000009536743, 0.5540000200271606], [0.546999990940094, 0.5327500104904175, 0.546500027179718, 0.5709999799728394, 0.6639999747276306], [0.5227500200271606, 0.5647500157356262, 0.5837500095367432, 0.5322499871253967, 0.6119999885559082], [0.5202500224113464, 0.49524998664855957, 0.4832499921321869, 0.515500009059906, 0.6520000100135803], [0.5189999938011169, 0.4957500100135803, 0.48625001311302185, 0.5569999814033508, 0.6439999938011169]]
[[0.298, 0.309, 0.277, 0.325, 0.486], [0.348, 0.347, 0.326, 0.37, 0.545], [0.362, 0.343, 0.329, 0.411, 0.571], [0.366, 0.383, 0.374, 0.397, 0.605], [0.397, 0.402, 0.394, 0.45, 0.667], [0.333, 0.329, 0.33, 0.31, 0.518], [0.389, 0.373, 0.376, 0.39, 0.598], [0.299, 0.32, 0.337, 0.336, 0.525], [0.365, 0.347, 0.339, 0.351, 0.586], [0.403, 0.398, 0.38, 0.434, 0.601]]
suff_simple_acc_int  =  0.520 +- 0.019, 0.512 +- 0.028, 0.519 +- 0.041, 0.553 +- 0.036, 0.632 +- 0.057
nec class all_L1  =  0.332 +- 0.018, 0.425 +- 0.031, 0.348 +- 0.023, 0.279 +- 0.021, 0.260 +- 0.016
nec class all_KL  =  0.368 +- 0.018, 0.486 +- 0.037, 0.447 +- 0.035, 0.350 +- 0.025, 0.328 +- 0.018
[[0.6460000276565552, 0.5132499933242798, 0.6589999794960022, 0.7434999942779541, 0.7717499732971191], [0.6159999966621399, 0.47099998593330383, 0.6482499837875366, 0.7570000290870667, 0.8125], [0.6039999723434448, 0.5792499780654907, 0.6867499947547913, 0.7192500233650208, 0.7527499794960022], [0.6520000100135803, 0.5972499847412109, 0.6855000257492065, 0.7722499966621399, 0.7885000109672546], [0.6159999966621399, 0.5477499961853027, 0.6422500014305115, 0.7612500190734863, 0.7919999957084656], [0.6480000019073486, 0.5567499995231628, 0.718500018119812, 0.7492499947547913, 0.7962499856948853], [0.6679999828338623, 0.5195000171661377, 0.7039999961853027, 0.8029999732971191, 0.8195000290870667], [0.6539999842643738, 0.5509999990463257, 0.6439999938011169, 0.7317500114440918, 0.7572500109672546], [0.6399999856948853, 0.5177500247955322, 0.6694999933242798, 0.7390000224113464, 0.7670000195503235], [0.621999979019165, 0.5232499837875366, 0.6990000009536743, 0.800000011920929, 0.797249972820282]]
[[0.366, 0.515, 0.47, 0.359, 0.349], [0.402, 0.555, 0.491, 0.371, 0.328], [0.389, 0.439, 0.411, 0.378, 0.345], [0.344, 0.422, 0.446, 0.357, 0.326], [0.387, 0.477, 0.496, 0.371, 0.32], [0.351, 0.458, 0.401, 0.338, 0.317], [0.351, 0.504, 0.426, 0.319, 0.307], [0.36, 0.492, 0.484, 0.365, 0.363], [0.363, 0.505, 0.439, 0.349, 0.322], [0.372, 0.488, 0.404, 0.293, 0.302]]
nec_acc_int  =  0.637 +- 0.020, 0.538 +- 0.034, 0.676 +- 0.026, 0.758 +- 0.026, 0.785 +- 0.021

Eval split val
suff_simple class all_L1  =  0.567 +- 0.132, 0.550 +- 0.132, 0.529 +- 0.131, 0.509 +- 0.133, 0.561 +- 0.171
suff_simple class all_KL  =  0.471 +- 0.164, 0.454 +- 0.161, 0.435 +- 0.159, 0.421 +- 0.155, 0.494 +- 0.206
[[0.45855000615119934, 0.43709999322891235, 0.41165000200271606, 0.40415000915527344, 0.35580000281333923], [0.46377500891685486, 0.4404500126838684, 0.39932501316070557, 0.3511500060558319, 0.460999995470047], [0.4764750003814697, 0.4583750069141388, 0.4379749894142151, 0.4094749987125397, 0.39239999651908875], [0.483599990606308, 0.4571250081062317, 0.4207499921321869, 0.4077000021934509, 0.5252000093460083], [0.505299985408783, 0.49607500433921814, 0.4681749939918518, 0.4183749854564667, 0.5640000104904175], [0.4317750036716461, 0.4094749987125397, 0.38427498936653137, 0.3357749879360199, 0.3124000132083893], [0.4629499912261963, 0.4335249960422516, 0.38737499713897705, 0.33675000071525574, 0.4675999879837036], [0.49779999256134033, 0.48704999685287476, 0.47597500681877136, 0.4587250053882599, 0.42899999022483826], [0.4786500036716461, 0.45159998536109924, 0.4146749973297119, 0.3600499927997589, 0.4618000090122223], [0.49217501282691956, 0.461775004863739, 0.4180999994277954, 0.380825012922287, 0.4819999933242798]]
[[0.244, 0.224, 0.202, 0.212, 0.172], [0.421, 0.405, 0.387, 0.369, 0.489], [0.61, 0.588, 0.569, 0.542, 0.52], [0.623, 0.596, 0.577, 0.575, 0.705], [0.601, 0.59, 0.574, 0.551, 0.746], [0.198, 0.19, 0.179, 0.159, 0.161], [0.364, 0.348, 0.325, 0.312, 0.444], [0.429, 0.419, 0.417, 0.421, 0.405], [0.491, 0.472, 0.446, 0.406, 0.499], [0.729, 0.709, 0.679, 0.664, 0.796]]
suff_simple_acc_int  =  0.475 +- 0.021, 0.453 +- 0.024, 0.422 +- 0.029, 0.386 +- 0.038, 0.445 +- 0.072
nec class all_L1  =  0.363 +- 0.106, 0.334 +- 0.083, 0.264 +- 0.077, 0.235 +- 0.040, 0.287 +- 0.054
nec class all_KL  =  0.396 +- 0.131, 0.375 +- 0.110, 0.320 +- 0.106, 0.330 +- 0.069, 0.379 +- 0.085
[[0.4431999921798706, 0.6010000109672546, 0.8306499719619751, 0.8280249834060669, 0.7218000292778015], [0.48739999532699585, 0.5145999789237976, 0.6801750063896179, 0.8401749730110168, 0.7668250203132629], [0.4966000020503998, 0.567799985408783, 0.6548749804496765, 0.6840999722480774, 0.6330999732017517], [0.47540000081062317, 0.4733999967575073, 0.5231249928474426, 0.6206499934196472, 0.607824981212616], [0.4927999973297119, 0.4925999939441681, 0.5091249942779541, 0.6041749715805054, 0.6716750264167786], [0.49079999327659607, 0.5916000008583069, 0.8313500285148621, 0.8024500012397766, 0.7221500277519226], [0.4968000054359436, 0.5080000162124634, 0.6559500098228455, 0.8287500143051147, 0.793749988079071], [0.5956000089645386, 0.5803999900817871, 0.6358500123023987, 0.7334499955177307, 0.6894000172615051], [0.4828000068664551, 0.4950000047683716, 0.6269999742507935, 0.7556750178337097, 0.6966249942779541], [0.49380001425743103, 0.4934000074863434, 0.5254999995231628, 0.6078749895095825, 0.6392750144004822]]
[[0.609, 0.469, 0.337, 0.425, 0.553], [0.446, 0.476, 0.429, 0.317, 0.38], [0.321, 0.258, 0.18, 0.231, 0.286], [0.293, 0.305, 0.256, 0.308, 0.333], [0.303, 0.307, 0.326, 0.397, 0.333], [0.551, 0.439, 0.249, 0.323, 0.45], [0.477, 0.475, 0.455, 0.341, 0.38], [0.406, 0.463, 0.472, 0.418, 0.465], [0.419, 0.415, 0.35, 0.334, 0.355], [0.136, 0.142, 0.147, 0.204, 0.252]]
nec_acc_int  =  0.496 +- 0.037, 0.532 +- 0.045, 0.647 +- 0.109, 0.731 +- 0.091, 0.694 +- 0.056

Eval split test
suff_simple class all_L1  =  0.646 +- 0.019, 0.648 +- 0.019, 0.661 +- 0.019, 0.705 +- 0.031, 0.834 +- 0.012
suff_simple class all_KL  =  0.595 +- 0.028, 0.597 +- 0.027, 0.615 +- 0.027, 0.673 +- 0.039, 0.840 +- 0.010
[[0.5083550214767456, 0.515509307384491, 0.5127576589584351, 0.5406994223594666, 0.5869433879852295], [0.5559335350990295, 0.5732189416885376, 0.5797978639602661, 0.5845757722854614, 0.6444177031517029], [0.529867947101593, 0.5364468693733215, 0.5403491854667664, 0.5586101412773132, 0.6469874382019043], [0.5130828619003296, 0.5084550976753235, 0.524014413356781, 0.5592605471611023, 0.6129162311553955], [0.5473284125328064, 0.5515308976173401, 0.586426854133606, 0.6367820501327515, 0.6772551536560059], [0.5857264399528503, 0.6044877171516418, 0.603061854839325, 0.5563337802886963, 0.6975345611572266], [0.5535070896148682, 0.5600860714912415, 0.555208146572113, 0.5537072420120239, 0.6139506697654724], [0.5810736417770386, 0.5916799902915955, 0.5669901967048645, 0.5429757833480835, 0.6175586581230164], [0.5472033023834229, 0.5342205166816711, 0.5344957113265991, 0.5652141571044922, 0.6594507694244385], [0.5319691896438599, 0.5353962182998657, 0.5488793253898621, 0.5793726444244385, 0.6545090079307556]]
[[0.597, 0.599, 0.618, 0.685, 0.826], [0.577, 0.577, 0.589, 0.645, 0.83], [0.58, 0.581, 0.607, 0.68, 0.845], [0.646, 0.65, 0.662, 0.746, 0.85], [0.599, 0.597, 0.623, 0.696, 0.829], [0.569, 0.567, 0.576, 0.61, 0.835], [0.624, 0.627, 0.643, 0.68, 0.858], [0.543, 0.557, 0.589, 0.618, 0.851], [0.596, 0.589, 0.596, 0.663, 0.841], [0.619, 0.622, 0.646, 0.707, 0.832]]
suff_simple_acc_int  =  0.545 +- 0.024, 0.551 +- 0.030, 0.555 +- 0.027, 0.568 +- 0.026, 0.641 +- 0.032
nec class all_L1  =  0.136 +- 0.019, 0.161 +- 0.022, 0.170 +- 0.022, 0.201 +- 0.031, 0.205 +- 0.019
nec class all_KL  =  0.123 +- 0.021, 0.152 +- 0.025, 0.162 +- 0.025, 0.204 +- 0.036, 0.218 +- 0.025
[[0.5883530378341675, 0.5587352514266968, 0.5457274317741394, 0.5677406191825867, 0.6205723285675049], [0.584150493144989, 0.5537322163581848, 0.540374219417572, 0.5960075855255127, 0.6589203476905823], [0.589353621006012, 0.5621373057365417, 0.5519311428070068, 0.5625125169754028, 0.6479637622833252], [0.582349419593811, 0.563738226890564, 0.5573344230651855, 0.5858265161514282, 0.6042125225067139], [0.5731438994407654, 0.5549329519271851, 0.5457274317741394, 0.5527816414833069, 0.6208475232124329], [0.5869521498680115, 0.5615369081497192, 0.5564338564872742, 0.6101160645484924, 0.6647738814353943], [0.5969581604003906, 0.5705423355102539, 0.5547328591346741, 0.5693916082382202, 0.6232489347457886], [0.5777466297149658, 0.5519311428070068, 0.543300986289978, 0.5865269303321838, 0.6234740614891052], [0.582549512386322, 0.5501300692558289, 0.5452521443367004, 0.5761457085609436, 0.655343234539032], [0.5741444826126099, 0.5521312952041626, 0.5429257750511169, 0.5907544493675232, 0.6399339437484741]]
[[0.109, 0.141, 0.152, 0.215, 0.238], [0.138, 0.169, 0.183, 0.24, 0.235], [0.137, 0.169, 0.177, 0.244, 0.223], [0.083, 0.1, 0.109, 0.128, 0.187], [0.127, 0.145, 0.154, 0.189, 0.204], [0.161, 0.191, 0.195, 0.241, 0.228], [0.096, 0.124, 0.135, 0.196, 0.223], [0.127, 0.163, 0.182, 0.226, 0.265], [0.133, 0.165, 0.174, 0.205, 0.186], [0.123, 0.148, 0.155, 0.156, 0.187]]
nec_acc_int  =  0.584 +- 0.007, 0.558 +- 0.006, 0.548 +- 0.006, 0.580 +- 0.016, 0.636 +- 0.019


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.418 +- 0.012, 0.463 +- 0.018, 0.422 +- 0.017, 0.397 +- 0.016, 0.447 +- 0.017
Faith. Armon (L1)= 		  =  0.400 +- 0.014, 0.460 +- 0.020, 0.409 +- 0.018, 0.361 +- 0.019, 0.368 +- 0.016
Faith. GMean (L1)= 	  =  0.409 +- 0.013, 0.461 +- 0.019, 0.415 +- 0.017, 0.379 +- 0.017, 0.406 +- 0.015
Faith. Aritm (KL)= 		  =  0.362 +- 0.021, 0.420 +- 0.021, 0.396 +- 0.023, 0.364 +- 0.024, 0.449 +- 0.021
Faith. Armon (KL)= 		  =  0.361 +- 0.022, 0.409 +- 0.021, 0.388 +- 0.024, 0.361 +- 0.024, 0.415 +- 0.013
Faith. GMean (KL)= 	  =  0.362 +- 0.021, 0.414 +- 0.021, 0.392 +- 0.023, 0.362 +- 0.024, 0.432 +- 0.016

Eval split val
Faith. Aritm (L1)= 		  =  0.465 +- 0.020, 0.442 +- 0.041, 0.397 +- 0.070, 0.372 +- 0.062, 0.424 +- 0.062
Faith. Armon (L1)= 		  =  0.414 +- 0.059, 0.394 +- 0.060, 0.340 +- 0.072, 0.313 +- 0.043, 0.359 +- 0.030
Faith. GMean (L1)= 	  =  0.437 +- 0.035, 0.416 +- 0.044, 0.366 +- 0.065, 0.340 +- 0.046, 0.389 +- 0.037
Faith. Aritm (KL)= 		  =  0.434 +- 0.025, 0.414 +- 0.044, 0.378 +- 0.072, 0.375 +- 0.067, 0.436 +- 0.070
Faith. Armon (KL)= 		  =  0.381 +- 0.067, 0.369 +- 0.072, 0.337 +- 0.080, 0.345 +- 0.068, 0.385 +- 0.073
Faith. GMean (KL)= 	  =  0.405 +- 0.045, 0.390 +- 0.055, 0.356 +- 0.072, 0.359 +- 0.065, 0.409 +- 0.068

Eval split test
Faith. Aritm (L1)= 		  =  0.391 +- 0.004, 0.404 +- 0.005, 0.416 +- 0.004, 0.453 +- 0.009, 0.520 +- 0.011
Faith. Armon (L1)= 		  =  0.224 +- 0.025, 0.257 +- 0.027, 0.269 +- 0.027, 0.311 +- 0.038, 0.329 +- 0.025
Faith. GMean (L1)= 	  =  0.295 +- 0.018, 0.322 +- 0.018, 0.334 +- 0.018, 0.375 +- 0.025, 0.413 +- 0.020
Faith. Aritm (KL)= 		  =  0.359 +- 0.009, 0.374 +- 0.006, 0.388 +- 0.005, 0.439 +- 0.011, 0.529 +- 0.014
Faith. Armon (KL)= 		  =  0.203 +- 0.028, 0.240 +- 0.030, 0.254 +- 0.030, 0.310 +- 0.042, 0.345 +- 0.031
Faith. GMean (KL)= 	  =  0.269 +- 0.020, 0.299 +- 0.020, 0.314 +- 0.019, 0.368 +- 0.027, 0.427 +- 0.025
Computed for split load_split = id



Completed in  2:56:07.087646  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.1

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 19:30:18 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 07:30:18 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 07:30:18 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:30:18 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 07:30:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:30:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:30:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:30:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:30:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:30:18 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:30:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0013
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0013
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0013
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0013
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.415
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.365
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.247
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.159
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.105
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.263
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.147
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.078
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.040
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.021
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.297
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.213
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.138
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.094
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.085


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.41488200000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.7
SUFF_SIMPLE for r=0.05 class 0.0 = 0.594 +- 0.456 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.821 +- 0.456 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.05 all KL = 0.655 +- 0.456 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.05 all L1 = 0.72 +- 0.383 (in-sample avg dev_std = 0.201)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.364978
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.717
SUFF_SIMPLE for r=0.1 class 0.0 = 0.607 +- 0.452 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.832 +- 0.452 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.1 all KL = 0.67 +- 0.452 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.1 all L1 = 0.731 +- 0.379 (in-sample avg dev_std = 0.199)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24656
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.785
SUFF_SIMPLE for r=0.2 class 0.0 = 0.64 +- 0.417 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.911 +- 0.417 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 all KL = 0.738 +- 0.417 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 all L1 = 0.79 +- 0.346 (in-sample avg dev_std = 0.197)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.15886799999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.86
SUFF_SIMPLE for r=0.4 class 0.0 = 0.714 +- 0.371 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.97 +- 0.371 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.4 all KL = 0.817 +- 0.371 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.4 all L1 = 0.856 +- 0.297 (in-sample avg dev_std = 0.231)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10517
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.974
SUFF_SIMPLE for r=0.8 class 0.0 = 0.939 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.987 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.958 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.966 +- 0.143 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.839
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.26289359999999995
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.674
SUFF_SIMPLE for r=0.05 class 0.0 = 0.654 +- 0.388 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.944 +- 0.388 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 all KL = 0.761 +- 0.388 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 all L1 = 0.8 +- 0.322 (in-sample avg dev_std = 0.003)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.839
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1465422
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.674
SUFF_SIMPLE for r=0.1 class 0.0 = 0.654 +- 0.389 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.944 +- 0.389 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.1 all KL = 0.761 +- 0.389 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.1 all L1 = 0.8 +- 0.322 (in-sample avg dev_std = 0.003)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.839
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.078009
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.674
SUFF_SIMPLE for r=0.2 class 0.0 = 0.654 +- 0.389 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.944 +- 0.389 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.2 all KL = 0.762 +- 0.389 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.2 all L1 = 0.8 +- 0.322 (in-sample avg dev_std = 0.003)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.839
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04044640000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.677
SUFF_SIMPLE for r=0.4 class 0.0 = 0.657 +- 0.388 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.944 +- 0.388 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.4 all KL = 0.763 +- 0.388 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.4 all L1 = 0.801 +- 0.321 (in-sample avg dev_std = 0.037)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.839
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.021063
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.77
SUFF_SIMPLE for r=0.8 class 0.0 = 0.84 +- 0.284 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.949 +- 0.284 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.887 +- 0.284 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.895 +- 0.237 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.831
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.296562
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.744
SUFF_SIMPLE for r=0.05 class 0.0 = 0.84 +- 0.434 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.469 +- 0.434 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.05 all KL = 0.621 +- 0.434 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.05 all L1 = 0.657 +- 0.357 (in-sample avg dev_std = 0.184)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.831
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.21277920000000003
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.796
SUFF_SIMPLE for r=0.1 class 0.0 = 0.848 +- 0.411 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.555 +- 0.411 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 all KL = 0.672 +- 0.411 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 all L1 = 0.703 +- 0.337 (in-sample avg dev_std = 0.176)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.831
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1383178
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.838
SUFF_SIMPLE for r=0.2 class 0.0 = 0.87 +- 0.379 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.638 +- 0.379 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.2 all KL = 0.734 +- 0.379 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.2 all L1 = 0.755 +- 0.313 (in-sample avg dev_std = 0.162)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0936346
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.862
SUFF_SIMPLE for r=0.4 class 0.0 = 0.911 +- 0.356 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.659 +- 0.356 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.4 all KL = 0.772 +- 0.356 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.4 all L1 = 0.787 +- 0.300 (in-sample avg dev_std = 0.161)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.833
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08455240000000001
len(reference) = 4986
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.888
SUFF_SIMPLE for r=0.8 class 0.0 = 0.918 +- 0.331 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.716 +- 0.331 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.8 all KL = 0.823 +- 0.331 (in-sample avg dev_std = 0.034)
SUFF_SIMPLE for r=0.8 all L1 = 0.818 +- 0.292 (in-sample avg dev_std = 0.034)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.41488200000000003
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.56
NEC for r=0.05 class 0.0 = 0.084 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.643 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.466 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.394 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.364978
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.429
NEC for r=0.1 class 0.0 = 0.222 +- 0.461 (in-sample avg dev_std = 0.107)
NEC for r=0.1 class 1.0 = 0.759 +- 0.461 (in-sample avg dev_std = 0.107)
NEC for r=0.1 all KL = 0.629 +- 0.461 (in-sample avg dev_std = 0.107)
NEC for r=0.1 all L1 = 0.52 +- 0.395 (in-sample avg dev_std = 0.107)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24656
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.577
NEC for r=0.2 class 0.0 = 0.341 +- 0.455 (in-sample avg dev_std = 0.425)
NEC for r=0.2 class 1.0 = 0.485 +- 0.455 (in-sample avg dev_std = 0.425)
NEC for r=0.2 all KL = 0.573 +- 0.455 (in-sample avg dev_std = 0.425)
NEC for r=0.2 all L1 = 0.421 +- 0.372 (in-sample avg dev_std = 0.425)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.15886799999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.765
NEC for r=0.4 class 0.0 = 0.322 +- 0.430 (in-sample avg dev_std = 0.363)
NEC for r=0.4 class 1.0 = 0.187 +- 0.430 (in-sample avg dev_std = 0.363)
NEC for r=0.4 all KL = 0.358 +- 0.430 (in-sample avg dev_std = 0.363)
NEC for r=0.4 all L1 = 0.247 +- 0.335 (in-sample avg dev_std = 0.363)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10517
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.836
NEC for r=0.8 class 0.0 = 0.316 +- 0.401 (in-sample avg dev_std = 0.336)
NEC for r=0.8 class 1.0 = 0.075 +- 0.401 (in-sample avg dev_std = 0.336)
NEC for r=0.8 all KL = 0.268 +- 0.401 (in-sample avg dev_std = 0.336)
NEC for r=0.8 all L1 = 0.182 +- 0.298 (in-sample avg dev_std = 0.336)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.839
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.26289359999999995
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.462
NEC for r=0.05 class 0.0 = 0.085 +- 0.469 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.613 +- 0.469 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.403 +- 0.469 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.351 +- 0.402 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.839
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1465422
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.401
NEC for r=0.1 class 0.0 = 0.223 +- 0.477 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.584 +- 0.477 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.473 +- 0.477 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.405 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.839
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.078009
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.512
NEC for r=0.2 class 0.0 = 0.316 +- 0.448 (in-sample avg dev_std = 0.261)
NEC for r=0.2 class 1.0 = 0.346 +- 0.448 (in-sample avg dev_std = 0.261)
NEC for r=0.2 all KL = 0.414 +- 0.448 (in-sample avg dev_std = 0.261)
NEC for r=0.2 all L1 = 0.331 +- 0.374 (in-sample avg dev_std = 0.261)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.839
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04044640000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.671
NEC for r=0.4 class 0.0 = 0.34 +- 0.389 (in-sample avg dev_std = 0.098)
NEC for r=0.4 class 1.0 = 0.058 +- 0.389 (in-sample avg dev_std = 0.098)
NEC for r=0.4 all KL = 0.24 +- 0.389 (in-sample avg dev_std = 0.098)
NEC for r=0.4 all L1 = 0.198 +- 0.320 (in-sample avg dev_std = 0.098)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.839
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.021063
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.677
NEC for r=0.8 class 0.0 = 0.337 +- 0.389 (in-sample avg dev_std = 0.083)
NEC for r=0.8 class 1.0 = 0.054 +- 0.389 (in-sample avg dev_std = 0.083)
NEC for r=0.8 all KL = 0.231 +- 0.389 (in-sample avg dev_std = 0.083)
NEC for r=0.8 all L1 = 0.194 +- 0.320 (in-sample avg dev_std = 0.083)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.831
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.296562
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.584
NEC for r=0.05 class 0.0 = 0.041 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.47 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.257 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.253 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.831
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.21277920000000003
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.57
NEC for r=0.1 class 0.0 = 0.055 +- 0.393 (in-sample avg dev_std = 0.048)
NEC for r=0.1 class 1.0 = 0.493 +- 0.393 (in-sample avg dev_std = 0.048)
NEC for r=0.1 all KL = 0.282 +- 0.393 (in-sample avg dev_std = 0.048)
NEC for r=0.1 all L1 = 0.271 +- 0.361 (in-sample avg dev_std = 0.048)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.831
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1383178
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.588
NEC for r=0.2 class 0.0 = 0.074 +- 0.394 (in-sample avg dev_std = 0.192)
NEC for r=0.2 class 1.0 = 0.509 +- 0.394 (in-sample avg dev_std = 0.192)
NEC for r=0.2 all KL = 0.312 +- 0.394 (in-sample avg dev_std = 0.192)
NEC for r=0.2 all L1 = 0.289 +- 0.355 (in-sample avg dev_std = 0.192)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0936346
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.646
NEC for r=0.4 class 0.0 = 0.12 +- 0.385 (in-sample avg dev_std = 0.326)
NEC for r=0.4 class 1.0 = 0.483 +- 0.385 (in-sample avg dev_std = 0.326)
NEC for r=0.4 all KL = 0.333 +- 0.385 (in-sample avg dev_std = 0.326)
NEC for r=0.4 all L1 = 0.299 +- 0.332 (in-sample avg dev_std = 0.326)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.831
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08455240000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.716
NEC for r=0.8 class 0.0 = 0.137 +- 0.376 (in-sample avg dev_std = 0.310)
NEC for r=0.8 class 1.0 = 0.416 +- 0.376 (in-sample avg dev_std = 0.310)
NEC for r=0.8 all KL = 0.309 +- 0.376 (in-sample avg dev_std = 0.310)
NEC for r=0.8 all L1 = 0.275 +- 0.311 (in-sample avg dev_std = 0.310)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 19:47:14 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 07:47:14 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 07:47:14 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:47:14 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 07:47:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:47:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:47:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:47:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:47:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:47:14 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:47:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 54 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 54...
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.458
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.365
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.241
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.141
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.088
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.226
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.123
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.035
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.020
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.260
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.193
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.134
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.094
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45770400000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.796
SUFF_SIMPLE for r=0.05 class 0.0 = 0.595 +- 0.410 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.410 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 all KL = 0.786 +- 0.410 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 all L1 = 0.819 +- 0.347 (in-sample avg dev_std = 0.178)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.365004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.798
SUFF_SIMPLE for r=0.1 class 0.0 = 0.599 +- 0.408 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.408 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.1 all KL = 0.79 +- 0.408 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.1 all L1 = 0.821 +- 0.347 (in-sample avg dev_std = 0.172)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24081
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.815
SUFF_SIMPLE for r=0.2 class 0.0 = 0.621 +- 0.405 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.998 +- 0.405 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.2 all KL = 0.793 +- 0.405 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.2 all L1 = 0.83 +- 0.335 (in-sample avg dev_std = 0.238)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14131799999999997
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.883
SUFF_SIMPLE for r=0.4 class 0.0 = 0.752 +- 0.353 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.996 +- 0.353 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.4 all KL = 0.852 +- 0.353 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.4 all L1 = 0.887 +- 0.277 (in-sample avg dev_std = 0.261)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.087738
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22572780000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.746
SUFF_SIMPLE for r=0.05 class 0.0 = 0.559 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.779 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1234076
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.746
SUFF_SIMPLE for r=0.1 class 0.0 = 0.559 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.779 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06595659999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.746
SUFF_SIMPLE for r=0.2 class 0.0 = 0.559 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.779 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0353154
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.747
SUFF_SIMPLE for r=0.4 class 0.0 = 0.56 +- 0.436 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.4 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.4 all L1 = 0.779 +- 0.375 (in-sample avg dev_std = 0.063)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.019738599999999995
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.996
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.059 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.988 +- 0.059 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.995 +- 0.059 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.994 +- 0.053 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.896
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2604718
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.86
SUFF_SIMPLE for r=0.05 class 0.0 = 0.836 +- 0.374 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.864 +- 0.374 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.05 all KL = 0.815 +- 0.374 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.05 all L1 = 0.85 +- 0.305 (in-sample avg dev_std = 0.209)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.896
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1929138
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.859
SUFF_SIMPLE for r=0.1 class 0.0 = 0.836 +- 0.375 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.863 +- 0.375 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.1 all KL = 0.815 +- 0.375 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.1 all L1 = 0.85 +- 0.306 (in-sample avg dev_std = 0.207)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.896
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1335818
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.86
SUFF_SIMPLE for r=0.2 class 0.0 = 0.84 +- 0.375 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.86 +- 0.375 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.2 all KL = 0.816 +- 0.375 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.2 all L1 = 0.85 +- 0.306 (in-sample avg dev_std = 0.211)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.896
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09350420000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.923
SUFF_SIMPLE for r=0.4 class 0.0 = 0.942 +- 0.317 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.856 +- 0.317 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.4 all KL = 0.872 +- 0.317 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.4 all L1 = 0.9 +- 0.250 (in-sample avg dev_std = 0.217)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0805062
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.971
SUFF_SIMPLE for r=0.8 class 0.0 = 0.993 +- 0.262 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.852 +- 0.262 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.8 all KL = 0.918 +- 0.262 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.8 all L1 = 0.923 +- 0.234 (in-sample avg dev_std = 0.059)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45770400000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.804
NEC for r=0.05 class 0.0 = 0.0 +- 0.399 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.307 +- 0.399 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.2 +- 0.399 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.17 +- 0.341 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.365004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.795
NEC for r=0.1 class 0.0 = 0.03 +- 0.410 (in-sample avg dev_std = 0.083)
NEC for r=0.1 class 1.0 = 0.306 +- 0.410 (in-sample avg dev_std = 0.083)
NEC for r=0.1 all KL = 0.222 +- 0.410 (in-sample avg dev_std = 0.083)
NEC for r=0.1 all L1 = 0.182 +- 0.346 (in-sample avg dev_std = 0.083)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.24081
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.864
NEC for r=0.2 class 0.0 = 0.204 +- 0.395 (in-sample avg dev_std = 0.322)
NEC for r=0.2 class 1.0 = 0.094 +- 0.395 (in-sample avg dev_std = 0.322)
NEC for r=0.2 all KL = 0.228 +- 0.395 (in-sample avg dev_std = 0.322)
NEC for r=0.2 all L1 = 0.143 +- 0.280 (in-sample avg dev_std = 0.322)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14131799999999997
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.86
NEC for r=0.4 class 0.0 = 0.308 +- 0.398 (in-sample avg dev_std = 0.323)
NEC for r=0.4 class 1.0 = 0.007 +- 0.398 (in-sample avg dev_std = 0.323)
NEC for r=0.4 all KL = 0.211 +- 0.398 (in-sample avg dev_std = 0.323)
NEC for r=0.4 all L1 = 0.141 +- 0.290 (in-sample avg dev_std = 0.323)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.087738
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.873
NEC for r=0.8 class 0.0 = 0.297 +- 0.394 (in-sample avg dev_std = 0.338)
NEC for r=0.8 class 1.0 = 0.0 +- 0.394 (in-sample avg dev_std = 0.338)
NEC for r=0.8 all KL = 0.2 +- 0.394 (in-sample avg dev_std = 0.338)
NEC for r=0.8 all L1 = 0.132 +- 0.279 (in-sample avg dev_std = 0.338)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22572780000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.526
NEC for r=0.05 class 0.0 = 0.0 +- 0.493 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.811 +- 0.493 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.471 +- 0.493 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.409 +- 0.429 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1234076
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.63
NEC for r=0.1 class 0.0 = 0.106 +- 0.476 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.546 +- 0.476 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.388 +- 0.476 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.328 +- 0.409 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06595659999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.748
NEC for r=0.2 class 0.0 = 0.439 +- 0.436 (in-sample avg dev_std = 0.080)
NEC for r=0.2 class 1.0 = 0.006 +- 0.436 (in-sample avg dev_std = 0.080)
NEC for r=0.2 all KL = 0.257 +- 0.436 (in-sample avg dev_std = 0.080)
NEC for r=0.2 all L1 = 0.221 +- 0.374 (in-sample avg dev_std = 0.080)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0353154
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.747
NEC for r=0.4 class 0.0 = 0.441 +- 0.436 (in-sample avg dev_std = 0.054)
NEC for r=0.4 class 1.0 = 0.005 +- 0.436 (in-sample avg dev_std = 0.054)
NEC for r=0.4 all KL = 0.256 +- 0.436 (in-sample avg dev_std = 0.054)
NEC for r=0.4 all L1 = 0.221 +- 0.375 (in-sample avg dev_std = 0.054)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.019738599999999995
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.747
NEC for r=0.8 class 0.0 = 0.44 +- 0.436 (in-sample avg dev_std = 0.064)
NEC for r=0.8 class 1.0 = 0.005 +- 0.436 (in-sample avg dev_std = 0.064)
NEC for r=0.8 all KL = 0.256 +- 0.436 (in-sample avg dev_std = 0.064)
NEC for r=0.8 all L1 = 0.221 +- 0.375 (in-sample avg dev_std = 0.064)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.896
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2604718
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.673
NEC for r=0.05 class 0.0 = 0.026 +- 0.420 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.41 +- 0.420 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.246 +- 0.420 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.216 +- 0.365 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.896
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1929138
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.678
NEC for r=0.1 class 0.0 = 0.034 +- 0.417 (in-sample avg dev_std = 0.002)
NEC for r=0.1 class 1.0 = 0.393 +- 0.417 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all KL = 0.241 +- 0.417 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all L1 = 0.211 +- 0.362 (in-sample avg dev_std = 0.002)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.896
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1335818
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.721
NEC for r=0.2 class 0.0 = 0.043 +- 0.397 (in-sample avg dev_std = 0.261)
NEC for r=0.2 class 1.0 = 0.334 +- 0.397 (in-sample avg dev_std = 0.261)
NEC for r=0.2 all KL = 0.222 +- 0.397 (in-sample avg dev_std = 0.261)
NEC for r=0.2 all L1 = 0.187 +- 0.332 (in-sample avg dev_std = 0.261)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.896
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09350420000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.801
NEC for r=0.4 class 0.0 = 0.091 +- 0.357 (in-sample avg dev_std = 0.349)
NEC for r=0.4 class 1.0 = 0.192 +- 0.357 (in-sample avg dev_std = 0.349)
NEC for r=0.4 all KL = 0.204 +- 0.357 (in-sample avg dev_std = 0.349)
NEC for r=0.4 all L1 = 0.141 +- 0.259 (in-sample avg dev_std = 0.349)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.896
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0805062
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.833
NEC for r=0.8 class 0.0 = 0.113 +- 0.306 (in-sample avg dev_std = 0.243)
NEC for r=0.8 class 1.0 = 0.107 +- 0.306 (in-sample avg dev_std = 0.243)
NEC for r=0.8 all KL = 0.15 +- 0.306 (in-sample avg dev_std = 0.243)
NEC for r=0.8 all L1 = 0.11 +- 0.241 (in-sample avg dev_std = 0.243)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 20:04:04 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:04:04 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:04:04 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:04:04 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:04:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:04:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:04:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:04:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:04:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:04:04 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:04:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.478
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.410
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.291
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.179
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.103
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.226
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.122
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.064
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.033
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.018
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.255
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.201
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.153
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.118
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.092


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.47767000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.803
SUFF_SIMPLE for r=0.05 class 0.0 = 0.6 +- 0.409 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.998 +- 0.409 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.05 all KL = 0.783 +- 0.409 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.05 all L1 = 0.82 +- 0.342 (in-sample avg dev_std = 0.238)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.409704
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.807
SUFF_SIMPLE for r=0.1 class 0.0 = 0.607 +- 0.408 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.408 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.1 all KL = 0.788 +- 0.408 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.1 all L1 = 0.824 +- 0.341 (in-sample avg dev_std = 0.231)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.29106600000000005
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.806
SUFF_SIMPLE for r=0.2 class 0.0 = 0.605 +- 0.409 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.409 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.2 all KL = 0.788 +- 0.409 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.2 all L1 = 0.824 +- 0.341 (in-sample avg dev_std = 0.241)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.178766
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.853
SUFF_SIMPLE for r=0.4 class 0.0 = 0.684 +- 0.381 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.381 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.4 all KL = 0.824 +- 0.381 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.4 all L1 = 0.859 +- 0.307 (in-sample avg dev_std = 0.278)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.102912
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.995
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22569260000000005
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.746
SUFF_SIMPLE for r=0.05 class 0.0 = 0.558 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.776 +- 0.378 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.995
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1222672
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.746
SUFF_SIMPLE for r=0.1 class 0.0 = 0.558 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.776 +- 0.378 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.995
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0640396
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.746
SUFF_SIMPLE for r=0.2 class 0.0 = 0.558 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.776 +- 0.378 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.995
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.033169599999999994
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.747
SUFF_SIMPLE for r=0.4 class 0.0 = 0.558 +- 0.437 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.4 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.4 all L1 = 0.776 +- 0.378 (in-sample avg dev_std = 0.037)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.995
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0176382
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.99
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.109 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.976 +- 0.109 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.985 +- 0.109 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.988 +- 0.090 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2546228
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.883
SUFF_SIMPLE for r=0.05 class 0.0 = 0.829 +- 0.301 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.966 +- 0.301 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.05 all KL = 0.88 +- 0.301 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.05 all L1 = 0.897 +- 0.253 (in-sample avg dev_std = 0.119)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.20126739999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.883
SUFF_SIMPLE for r=0.1 class 0.0 = 0.83 +- 0.302 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.968 +- 0.302 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.1 all KL = 0.883 +- 0.302 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.1 all L1 = 0.898 +- 0.253 (in-sample avg dev_std = 0.118)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15335919999999997
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.884
SUFF_SIMPLE for r=0.2 class 0.0 = 0.831 +- 0.303 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.969 +- 0.303 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.2 all KL = 0.886 +- 0.303 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.2 all L1 = 0.899 +- 0.254 (in-sample avg dev_std = 0.127)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11829880000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.918
SUFF_SIMPLE for r=0.4 class 0.0 = 0.89 +- 0.254 (in-sample avg dev_std = 0.114)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.969 +- 0.254 (in-sample avg dev_std = 0.114)
SUFF_SIMPLE for r=0.4 all KL = 0.919 +- 0.254 (in-sample avg dev_std = 0.114)
SUFF_SIMPLE for r=0.4 all L1 = 0.929 +- 0.209 (in-sample avg dev_std = 0.114)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0920228
len(reference) = 4968
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.978
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.064 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.966 +- 0.064 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all KL = 0.987 +- 0.064 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all L1 = 0.981 +- 0.078 (in-sample avg dev_std = 0.005)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.47767000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.742
NEC for r=0.05 class 0.0 = 0.03 +- 0.439 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.386 +- 0.439 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.265 +- 0.439 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.227 +- 0.378 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.409704
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.658
NEC for r=0.1 class 0.0 = 0.077 +- 0.475 (in-sample avg dev_std = 0.102)
NEC for r=0.1 class 1.0 = 0.479 +- 0.475 (in-sample avg dev_std = 0.102)
NEC for r=0.1 all KL = 0.352 +- 0.475 (in-sample avg dev_std = 0.102)
NEC for r=0.1 all L1 = 0.3 +- 0.408 (in-sample avg dev_std = 0.102)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.29106600000000005
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.801
NEC for r=0.2 class 0.0 = 0.166 +- 0.433 (in-sample avg dev_std = 0.352)
NEC for r=0.2 class 1.0 = 0.228 +- 0.433 (in-sample avg dev_std = 0.352)
NEC for r=0.2 all KL = 0.292 +- 0.433 (in-sample avg dev_std = 0.352)
NEC for r=0.2 all L1 = 0.2 +- 0.329 (in-sample avg dev_std = 0.352)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.178766
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.858
NEC for r=0.4 class 0.0 = 0.27 +- 0.404 (in-sample avg dev_std = 0.351)
NEC for r=0.4 class 1.0 = 0.05 +- 0.404 (in-sample avg dev_std = 0.351)
NEC for r=0.4 all KL = 0.232 +- 0.404 (in-sample avg dev_std = 0.351)
NEC for r=0.4 all L1 = 0.148 +- 0.287 (in-sample avg dev_std = 0.351)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.102912
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.882
NEC for r=0.8 class 0.0 = 0.282 +- 0.388 (in-sample avg dev_std = 0.353)
NEC for r=0.8 class 1.0 = 0.001 +- 0.388 (in-sample avg dev_std = 0.353)
NEC for r=0.8 all KL = 0.198 +- 0.388 (in-sample avg dev_std = 0.353)
NEC for r=0.8 all L1 = 0.126 +- 0.269 (in-sample avg dev_std = 0.353)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.995
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.22569260000000005
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.524
NEC for r=0.05 class 0.0 = 0.03 +- 0.496 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.785 +- 0.496 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.478 +- 0.496 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.411 +- 0.429 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.995
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1222672
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.559
NEC for r=0.1 class 0.0 = 0.218 +- 0.492 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.55 +- 0.492 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.454 +- 0.492 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.385 +- 0.424 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.995
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0640396
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.73
NEC for r=0.2 class 0.0 = 0.441 +- 0.448 (in-sample avg dev_std = 0.154)
NEC for r=0.2 class 1.0 = 0.05 +- 0.448 (in-sample avg dev_std = 0.154)
NEC for r=0.2 all KL = 0.293 +- 0.448 (in-sample avg dev_std = 0.154)
NEC for r=0.2 all L1 = 0.244 +- 0.381 (in-sample avg dev_std = 0.154)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.995
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.033169599999999994
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.747
NEC for r=0.4 class 0.0 = 0.442 +- 0.437 (in-sample avg dev_std = 0.041)
NEC for r=0.4 class 1.0 = 0.01 +- 0.437 (in-sample avg dev_std = 0.041)
NEC for r=0.4 all KL = 0.259 +- 0.437 (in-sample avg dev_std = 0.041)
NEC for r=0.4 all L1 = 0.224 +- 0.378 (in-sample avg dev_std = 0.041)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.995
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0176382
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.748
NEC for r=0.8 class 0.0 = 0.442 +- 0.437 (in-sample avg dev_std = 0.067)
NEC for r=0.8 class 1.0 = 0.01 +- 0.437 (in-sample avg dev_std = 0.067)
NEC for r=0.8 all KL = 0.259 +- 0.437 (in-sample avg dev_std = 0.067)
NEC for r=0.8 all L1 = 0.224 +- 0.377 (in-sample avg dev_std = 0.067)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2546228
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.668
NEC for r=0.05 class 0.0 = 0.027 +- 0.457 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.548 +- 0.457 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.327 +- 0.457 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.284 +- 0.399 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.20126739999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.67
NEC for r=0.1 class 0.0 = 0.037 +- 0.456 (in-sample avg dev_std = 0.081)
NEC for r=0.1 class 1.0 = 0.541 +- 0.456 (in-sample avg dev_std = 0.081)
NEC for r=0.1 all KL = 0.33 +- 0.456 (in-sample avg dev_std = 0.081)
NEC for r=0.1 all L1 = 0.286 +- 0.398 (in-sample avg dev_std = 0.081)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.15335919999999997
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.723
NEC for r=0.2 class 0.0 = 0.051 +- 0.434 (in-sample avg dev_std = 0.326)
NEC for r=0.2 class 1.0 = 0.458 +- 0.434 (in-sample avg dev_std = 0.326)
NEC for r=0.2 all KL = 0.302 +- 0.434 (in-sample avg dev_std = 0.326)
NEC for r=0.2 all L1 = 0.252 +- 0.363 (in-sample avg dev_std = 0.326)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11829880000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.831
NEC for r=0.4 class 0.0 = 0.091 +- 0.364 (in-sample avg dev_std = 0.386)
NEC for r=0.4 class 1.0 = 0.253 +- 0.364 (in-sample avg dev_std = 0.386)
NEC for r=0.4 all KL = 0.234 +- 0.364 (in-sample avg dev_std = 0.386)
NEC for r=0.4 all L1 = 0.171 +- 0.276 (in-sample avg dev_std = 0.386)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.977
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0920228
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.882
NEC for r=0.8 class 0.0 = 0.119 +- 0.296 (in-sample avg dev_std = 0.275)
NEC for r=0.8 class 1.0 = 0.107 +- 0.296 (in-sample avg dev_std = 0.275)
NEC for r=0.8 all KL = 0.153 +- 0.296 (in-sample avg dev_std = 0.275)
NEC for r=0.8 all L1 = 0.113 +- 0.231 (in-sample avg dev_std = 0.275)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 20:21:07 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:21:07 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:21:07 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:21:07 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:21:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:21:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:21:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:21:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:21:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:21:07 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:21:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.553
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.511
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.389
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.250
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.138
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.296
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.164
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.087
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.045
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.023
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.367
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.302
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.232
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.170
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.121


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.552706
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.796
SUFF_SIMPLE for r=0.05 class 0.0 = 0.602 +- 0.419 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.974 +- 0.419 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.05 all KL = 0.759 +- 0.419 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.05 all L1 = 0.808 +- 0.346 (in-sample avg dev_std = 0.152)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5110319999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.799
SUFF_SIMPLE for r=0.1 class 0.0 = 0.603 +- 0.406 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.997 +- 0.406 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.1 all KL = 0.788 +- 0.406 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.1 all L1 = 0.821 +- 0.346 (in-sample avg dev_std = 0.125)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.388652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.799
SUFF_SIMPLE for r=0.2 class 0.0 = 0.606 +- 0.405 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.405 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.2 all KL = 0.794 +- 0.405 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.2 all L1 = 0.824 +- 0.346 (in-sample avg dev_std = 0.128)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.249828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.821
SUFF_SIMPLE for r=0.4 class 0.0 = 0.641 +- 0.392 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.392 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 all KL = 0.81 +- 0.392 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 all L1 = 0.84 +- 0.332 (in-sample avg dev_std = 0.174)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.138484
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.022 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.022 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.999 +- 0.022 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.999 +- 0.008 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.957
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.29553720000000006
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.727
SUFF_SIMPLE for r=0.05 class 0.0 = 0.584 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.999 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.957
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.164454
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.727
SUFF_SIMPLE for r=0.1 class 0.0 = 0.584 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.957
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08715619999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.727
SUFF_SIMPLE for r=0.2 class 0.0 = 0.584 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.957
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04494
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.727
SUFF_SIMPLE for r=0.4 class 0.0 = 0.584 +- 0.434 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.999 +- 0.434 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.4 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.4 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.016)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.957
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0228408
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.933
SUFF_SIMPLE for r=0.8 class 0.0 = 0.959 +- 0.160 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.99 +- 0.160 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.971 +- 0.160 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.975 +- 0.127 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.366908
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.88
SUFF_SIMPLE for r=0.05 class 0.0 = 0.828 +- 0.360 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.936 +- 0.360 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.05 all KL = 0.824 +- 0.360 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.05 all L1 = 0.881 +- 0.261 (in-sample avg dev_std = 0.194)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3018496
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.883
SUFF_SIMPLE for r=0.1 class 0.0 = 0.831 +- 0.330 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.969 +- 0.330 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.1 all KL = 0.862 +- 0.330 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.1 all L1 = 0.899 +- 0.256 (in-sample avg dev_std = 0.151)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23168560000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.885
SUFF_SIMPLE for r=0.2 class 0.0 = 0.84 +- 0.303 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.989 +- 0.303 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.2 all KL = 0.893 +- 0.303 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.249 (in-sample avg dev_std = 0.116)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.170355
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.91
SUFF_SIMPLE for r=0.4 class 0.0 = 0.884 +- 0.255 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.255 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.4 all KL = 0.926 +- 0.255 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.4 all L1 = 0.941 +- 0.209 (in-sample avg dev_std = 0.103)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.973
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.12148319999999999
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.967
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.994 +- 0.071 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.994 +- 0.065 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.552706
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.638
NEC for r=0.05 class 0.0 = 0.117 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.48 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.376 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.318 +- 0.412 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5110319999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.512
NEC for r=0.1 class 0.0 = 0.191 +- 0.494 (in-sample avg dev_std = 0.106)
NEC for r=0.1 class 1.0 = 0.621 +- 0.494 (in-sample avg dev_std = 0.106)
NEC for r=0.1 all KL = 0.51 +- 0.494 (in-sample avg dev_std = 0.106)
NEC for r=0.1 all L1 = 0.429 +- 0.423 (in-sample avg dev_std = 0.106)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.388652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.658
NEC for r=0.2 class 0.0 = 0.277 +- 0.478 (in-sample avg dev_std = 0.407)
NEC for r=0.2 class 1.0 = 0.385 +- 0.478 (in-sample avg dev_std = 0.407)
NEC for r=0.2 all KL = 0.468 +- 0.478 (in-sample avg dev_std = 0.407)
NEC for r=0.2 all L1 = 0.337 +- 0.379 (in-sample avg dev_std = 0.407)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.249828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.82
NEC for r=0.4 class 0.0 = 0.339 +- 0.432 (in-sample avg dev_std = 0.368)
NEC for r=0.4 class 1.0 = 0.069 +- 0.432 (in-sample avg dev_std = 0.368)
NEC for r=0.4 all KL = 0.274 +- 0.432 (in-sample avg dev_std = 0.368)
NEC for r=0.4 all L1 = 0.189 +- 0.320 (in-sample avg dev_std = 0.368)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.138484
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.844
NEC for r=0.8 class 0.0 = 0.332 +- 0.415 (in-sample avg dev_std = 0.358)
NEC for r=0.8 class 1.0 = 0.026 +- 0.415 (in-sample avg dev_std = 0.358)
NEC for r=0.8 all KL = 0.23 +- 0.415 (in-sample avg dev_std = 0.358)
NEC for r=0.8 all L1 = 0.162 +- 0.306 (in-sample avg dev_std = 0.358)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.957
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.29553720000000006
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.526
NEC for r=0.05 class 0.0 = 0.175 +- 0.476 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.608 +- 0.476 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.456 +- 0.476 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.393 +- 0.408 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.957
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.164454
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.584
NEC for r=0.1 class 0.0 = 0.333 +- 0.475 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.348 +- 0.475 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.402 +- 0.475 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.34 +- 0.402 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.957
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08715619999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.698
NEC for r=0.2 class 0.0 = 0.415 +- 0.448 (in-sample avg dev_std = 0.122)
NEC for r=0.2 class 1.0 = 0.059 +- 0.448 (in-sample avg dev_std = 0.122)
NEC for r=0.2 all KL = 0.292 +- 0.448 (in-sample avg dev_std = 0.122)
NEC for r=0.2 all L1 = 0.236 +- 0.370 (in-sample avg dev_std = 0.122)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.957
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.04494
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.726
NEC for r=0.4 class 0.0 = 0.416 +- 0.434 (in-sample avg dev_std = 0.042)
NEC for r=0.4 class 1.0 = 0.003 +- 0.434 (in-sample avg dev_std = 0.042)
NEC for r=0.4 all KL = 0.254 +- 0.434 (in-sample avg dev_std = 0.042)
NEC for r=0.4 all L1 = 0.208 +- 0.360 (in-sample avg dev_std = 0.042)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.957
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0228408
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.727
NEC for r=0.8 class 0.0 = 0.415 +- 0.433 (in-sample avg dev_std = 0.039)
NEC for r=0.8 class 1.0 = 0.001 +- 0.433 (in-sample avg dev_std = 0.039)
NEC for r=0.8 all KL = 0.253 +- 0.433 (in-sample avg dev_std = 0.039)
NEC for r=0.8 all L1 = 0.207 +- 0.360 (in-sample avg dev_std = 0.039)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.366908
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.636
NEC for r=0.05 class 0.0 = 0.033 +- 0.478 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.598 +- 0.478 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.362 +- 0.478 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.312 +- 0.412 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3018496
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.605
NEC for r=0.1 class 0.0 = 0.046 +- 0.488 (in-sample avg dev_std = 0.186)
NEC for r=0.1 class 1.0 = 0.65 +- 0.488 (in-sample avg dev_std = 0.186)
NEC for r=0.1 all KL = 0.406 +- 0.488 (in-sample avg dev_std = 0.186)
NEC for r=0.1 all L1 = 0.344 +- 0.416 (in-sample avg dev_std = 0.186)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23168560000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.669
NEC for r=0.2 class 0.0 = 0.064 +- 0.473 (in-sample avg dev_std = 0.364)
NEC for r=0.2 class 1.0 = 0.541 +- 0.473 (in-sample avg dev_std = 0.364)
NEC for r=0.2 all KL = 0.403 +- 0.473 (in-sample avg dev_std = 0.364)
NEC for r=0.2 all L1 = 0.3 +- 0.375 (in-sample avg dev_std = 0.364)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.170355
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.825
NEC for r=0.4 class 0.0 = 0.101 +- 0.404 (in-sample avg dev_std = 0.358)
NEC for r=0.4 class 1.0 = 0.238 +- 0.404 (in-sample avg dev_std = 0.358)
NEC for r=0.4 all KL = 0.28 +- 0.404 (in-sample avg dev_std = 0.358)
NEC for r=0.4 all L1 = 0.169 +- 0.283 (in-sample avg dev_std = 0.358)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.12148319999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.876
NEC for r=0.8 class 0.0 = 0.129 +- 0.342 (in-sample avg dev_std = 0.238)
NEC for r=0.8 class 1.0 = 0.084 +- 0.342 (in-sample avg dev_std = 0.238)
NEC for r=0.8 all KL = 0.166 +- 0.342 (in-sample avg dev_std = 0.238)
NEC for r=0.8 all L1 = 0.107 +- 0.248 (in-sample avg dev_std = 0.238)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 20:38:10 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:38:10 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:38:10 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:38:10 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:38:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:38:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:38:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:38:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:38:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:38:10 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:38:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.507
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.427
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.289
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.185
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.108
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.250
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.137
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.073
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.038
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.020
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.265
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.211
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.154
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.121
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.097


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5074919999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.797
SUFF_SIMPLE for r=0.05 class 0.0 = 0.597 +- 0.408 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.995 +- 0.408 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.05 all KL = 0.779 +- 0.408 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.05 all L1 = 0.817 +- 0.345 (in-sample avg dev_std = 0.164)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.42704999999999993
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.796
SUFF_SIMPLE for r=0.1 class 0.0 = 0.597 +- 0.408 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.408 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.1 all KL = 0.787 +- 0.408 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.1 all L1 = 0.82 +- 0.348 (in-sample avg dev_std = 0.144)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.288848
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.795
SUFF_SIMPLE for r=0.2 class 0.0 = 0.592 +- 0.410 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.410 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.2 all KL = 0.786 +- 0.410 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.2 all L1 = 0.818 +- 0.349 (in-sample avg dev_std = 0.162)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.18531999999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.817
SUFF_SIMPLE for r=0.4 class 0.0 = 0.63 +- 0.397 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.397 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all KL = 0.803 +- 0.397 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all L1 = 0.835 +- 0.335 (in-sample avg dev_std = 0.182)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10813399999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.998
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.045 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.045 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.998 +- 0.045 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.998 +- 0.039 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.682
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2501604
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.746
SUFF_SIMPLE for r=0.05 class 0.0 = 0.558 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.443 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.429 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.5 +- 0.420 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.682
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.136849
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.746
SUFF_SIMPLE for r=0.1 class 0.0 = 0.558 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.443 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.429 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.5 +- 0.420 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.682
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07258699999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.746
SUFF_SIMPLE for r=0.2 class 0.0 = 0.558 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.443 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.429 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.5 +- 0.420 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.682
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.038020399999999996
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.746
SUFF_SIMPLE for r=0.4 class 0.0 = 0.558 +- 0.487 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.443 +- 0.487 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all KL = 0.429 +- 0.487 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all L1 = 0.5 +- 0.420 (in-sample avg dev_std = 0.001)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.682
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0199446
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.822
SUFF_SIMPLE for r=0.8 class 0.0 = 0.688 +- 0.490 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.443 +- 0.490 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.501 +- 0.490 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.565 +- 0.424 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.828
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2653514
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.806
SUFF_SIMPLE for r=0.05 class 0.0 = 0.837 +- 0.374 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.831 +- 0.374 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.05 all KL = 0.777 +- 0.374 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.05 all L1 = 0.834 +- 0.300 (in-sample avg dev_std = 0.223)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.828
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.210971
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.804
SUFF_SIMPLE for r=0.1 class 0.0 = 0.84 +- 0.372 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.839 +- 0.372 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 all KL = 0.788 +- 0.372 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 all L1 = 0.839 +- 0.299 (in-sample avg dev_std = 0.218)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.828
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1541828
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.806
SUFF_SIMPLE for r=0.2 class 0.0 = 0.842 +- 0.375 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.844 +- 0.375 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.2 all KL = 0.801 +- 0.375 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.2 all L1 = 0.843 +- 0.303 (in-sample avg dev_std = 0.221)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.828
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1210356
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.817
SUFF_SIMPLE for r=0.4 class 0.0 = 0.854 +- 0.374 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.839 +- 0.374 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.4 all KL = 0.806 +- 0.374 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.4 all L1 = 0.846 +- 0.302 (in-sample avg dev_std = 0.221)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.829
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0970336
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.911
SUFF_SIMPLE for r=0.8 class 0.0 = 0.99 +- 0.288 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.826 +- 0.288 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.8 all KL = 0.894 +- 0.288 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.8 all L1 = 0.909 +- 0.244 (in-sample avg dev_std = 0.077)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5074919999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.702
NEC for r=0.05 class 0.0 = 0.004 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.47 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.309 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.262 +- 0.394 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.42704999999999993
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.672
NEC for r=0.1 class 0.0 = 0.019 +- 0.471 (in-sample avg dev_std = 0.087)
NEC for r=0.1 class 1.0 = 0.507 +- 0.471 (in-sample avg dev_std = 0.087)
NEC for r=0.1 all KL = 0.342 +- 0.471 (in-sample avg dev_std = 0.087)
NEC for r=0.1 all L1 = 0.289 +- 0.403 (in-sample avg dev_std = 0.087)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.288848
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.865
NEC for r=0.2 class 0.0 = 0.103 +- 0.401 (in-sample avg dev_std = 0.369)
NEC for r=0.2 class 1.0 = 0.186 +- 0.401 (in-sample avg dev_std = 0.369)
NEC for r=0.2 all KL = 0.248 +- 0.401 (in-sample avg dev_std = 0.369)
NEC for r=0.2 all L1 = 0.149 +- 0.274 (in-sample avg dev_std = 0.369)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.18531999999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.893
NEC for r=0.4 class 0.0 = 0.229 +- 0.369 (in-sample avg dev_std = 0.313)
NEC for r=0.4 class 1.0 = 0.02 +- 0.369 (in-sample avg dev_std = 0.313)
NEC for r=0.4 all KL = 0.182 +- 0.369 (in-sample avg dev_std = 0.313)
NEC for r=0.4 all L1 = 0.113 +- 0.256 (in-sample avg dev_std = 0.313)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10813399999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.886
NEC for r=0.8 class 0.0 = 0.275 +- 0.385 (in-sample avg dev_std = 0.351)
NEC for r=0.8 class 1.0 = 0.003 +- 0.385 (in-sample avg dev_std = 0.351)
NEC for r=0.8 all KL = 0.196 +- 0.385 (in-sample avg dev_std = 0.351)
NEC for r=0.8 all L1 = 0.124 +- 0.266 (in-sample avg dev_std = 0.351)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.682
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2501604
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.380 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.334 +- 0.380 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.187 +- 0.380 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.168 +- 0.334 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.682
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.136849
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.492
NEC for r=0.1 class 0.0 = 0.027 +- 0.388 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.325 +- 0.388 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.199 +- 0.388 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.177 +- 0.340 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.682
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07258699999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.654
NEC for r=0.2 class 0.0 = 0.415 +- 0.486 (in-sample avg dev_std = 0.317)
NEC for r=0.2 class 1.0 = 0.47 +- 0.486 (in-sample avg dev_std = 0.317)
NEC for r=0.2 all KL = 0.532 +- 0.486 (in-sample avg dev_std = 0.317)
NEC for r=0.2 all L1 = 0.442 +- 0.409 (in-sample avg dev_std = 0.317)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.682
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.038020399999999996
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.748
NEC for r=0.4 class 0.0 = 0.438 +- 0.486 (in-sample avg dev_std = 0.188)
NEC for r=0.4 class 1.0 = 0.554 +- 0.486 (in-sample avg dev_std = 0.188)
NEC for r=0.4 all KL = 0.572 +- 0.486 (in-sample avg dev_std = 0.188)
NEC for r=0.4 all L1 = 0.497 +- 0.417 (in-sample avg dev_std = 0.188)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.682
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0199446
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.758
NEC for r=0.8 class 0.0 = 0.434 +- 0.487 (in-sample avg dev_std = 0.195)
NEC for r=0.8 class 1.0 = 0.556 +- 0.487 (in-sample avg dev_std = 0.195)
NEC for r=0.8 all KL = 0.57 +- 0.487 (in-sample avg dev_std = 0.195)
NEC for r=0.8 all L1 = 0.496 +- 0.417 (in-sample avg dev_std = 0.195)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.828
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2653514
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.653
NEC for r=0.05 class 0.0 = 0.023 +- 0.388 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.34 +- 0.388 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.205 +- 0.388 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.18 +- 0.337 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.828
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.210971
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.652
NEC for r=0.1 class 0.0 = 0.028 +- 0.392 (in-sample avg dev_std = 0.051)
NEC for r=0.1 class 1.0 = 0.343 +- 0.392 (in-sample avg dev_std = 0.051)
NEC for r=0.1 all KL = 0.213 +- 0.392 (in-sample avg dev_std = 0.051)
NEC for r=0.1 all L1 = 0.184 +- 0.337 (in-sample avg dev_std = 0.051)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.828
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1541828
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.659
NEC for r=0.2 class 0.0 = 0.045 +- 0.391 (in-sample avg dev_std = 0.164)
NEC for r=0.2 class 1.0 = 0.328 +- 0.391 (in-sample avg dev_std = 0.164)
NEC for r=0.2 all KL = 0.218 +- 0.391 (in-sample avg dev_std = 0.164)
NEC for r=0.2 all L1 = 0.185 +- 0.331 (in-sample avg dev_std = 0.164)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.828
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1210356
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.742
NEC for r=0.4 class 0.0 = 0.084 +- 0.343 (in-sample avg dev_std = 0.308)
NEC for r=0.4 class 1.0 = 0.194 +- 0.343 (in-sample avg dev_std = 0.308)
NEC for r=0.4 all KL = 0.185 +- 0.343 (in-sample avg dev_std = 0.308)
NEC for r=0.4 all L1 = 0.138 +- 0.263 (in-sample avg dev_std = 0.308)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.828
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0970336
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.774
NEC for r=0.8 class 0.0 = 0.116 +- 0.300 (in-sample avg dev_std = 0.241)
NEC for r=0.8 class 1.0 = 0.107 +- 0.300 (in-sample avg dev_std = 0.241)
NEC for r=0.8 all KL = 0.152 +- 0.300 (in-sample avg dev_std = 0.241)
NEC for r=0.8 all L1 = 0.112 +- 0.234 (in-sample avg dev_std = 0.241)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 20:55:17 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:55:17 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:55:17 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:55:17 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:55:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:55:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:55:17 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:55:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 88 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0038
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0053
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0046
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0053
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0046

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0038
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0053
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0046
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0053
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0046

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.341
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.290
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.203
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.125
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.095
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.129
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.074
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.042
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.023
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.196
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.142
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.098
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.070
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.074


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.34084400000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.639
SUFF_SIMPLE for r=0.05 class 0.0 = 0.486 +- 0.473 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.802 +- 0.473 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.05 all KL = 0.573 +- 0.473 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.05 all L1 = 0.661 +- 0.389 (in-sample avg dev_std = 0.311)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.290016
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.67
SUFF_SIMPLE for r=0.1 class 0.0 = 0.501 +- 0.469 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.837 +- 0.469 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.1 all KL = 0.611 +- 0.469 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.1 all L1 = 0.687 +- 0.387 (in-sample avg dev_std = 0.275)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20252599999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.743
SUFF_SIMPLE for r=0.2 class 0.0 = 0.531 +- 0.451 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.909 +- 0.451 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.2 all KL = 0.669 +- 0.451 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.2 all L1 = 0.741 +- 0.361 (in-sample avg dev_std = 0.295)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.12509399999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.84
SUFF_SIMPLE for r=0.4 class 0.0 = 0.638 +- 0.395 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.976 +- 0.395 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.4 all KL = 0.769 +- 0.395 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.4 all L1 = 0.825 +- 0.307 (in-sample avg dev_std = 0.262)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.094814
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.978
SUFF_SIMPLE for r=0.8 class 0.0 = 0.956 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.978 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.962 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.968 +- 0.129 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1285566
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.504
SUFF_SIMPLE for r=0.05 class 0.0 = 0.174 +- 0.478 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.92 +- 0.478 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 all KL = 0.501 +- 0.478 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 all L1 = 0.55 +- 0.413 (in-sample avg dev_std = 0.003)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.07448060000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.504
SUFF_SIMPLE for r=0.1 class 0.0 = 0.174 +- 0.478 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.92 +- 0.478 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.1 all KL = 0.501 +- 0.478 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.1 all L1 = 0.55 +- 0.413 (in-sample avg dev_std = 0.007)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.041658799999999996
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.504
SUFF_SIMPLE for r=0.2 class 0.0 = 0.174 +- 0.478 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.92 +- 0.478 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.2 all KL = 0.501 +- 0.478 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.2 all L1 = 0.55 +- 0.413 (in-sample avg dev_std = 0.005)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.022569400000000003
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.504
SUFF_SIMPLE for r=0.4 class 0.0 = 0.174 +- 0.478 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.92 +- 0.478 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 all KL = 0.5 +- 0.478 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 all L1 = 0.55 +- 0.413 (in-sample avg dev_std = 0.032)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012499000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.75
SUFF_SIMPLE for r=0.8 class 0.0 = 0.574 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.697 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.743 +- 0.349 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.657
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1956148
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.638
SUFF_SIMPLE for r=0.05 class 0.0 = 0.81 +- 0.448 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.418 +- 0.448 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.05 all KL = 0.546 +- 0.448 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.05 all L1 = 0.617 +- 0.372 (in-sample avg dev_std = 0.273)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.657
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1417826
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.671
SUFF_SIMPLE for r=0.1 class 0.0 = 0.815 +- 0.441 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.474 +- 0.441 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.1 all KL = 0.582 +- 0.441 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.1 all L1 = 0.647 +- 0.367 (in-sample avg dev_std = 0.249)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.657
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09757640000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.727
SUFF_SIMPLE for r=0.2 class 0.0 = 0.859 +- 0.420 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.554 +- 0.420 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.2 all KL = 0.654 +- 0.420 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.2 all L1 = 0.708 +- 0.349 (in-sample avg dev_std = 0.240)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.657
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06960620000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.777
SUFF_SIMPLE for r=0.4 class 0.0 = 0.926 +- 0.383 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.612 +- 0.383 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.4 all KL = 0.735 +- 0.383 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.4 all L1 = 0.771 +- 0.322 (in-sample avg dev_std = 0.214)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.658
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0743998
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.714
SUFF_SIMPLE for r=0.8 class 0.0 = 0.976 +- 0.267 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.778 +- 0.267 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.8 all KL = 0.88 +- 0.267 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.8 all L1 = 0.878 +- 0.237 (in-sample avg dev_std = 0.057)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.34084400000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.554
NEC for r=0.05 class 0.0 = 0.095 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.663 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.487 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.41 +- 0.412 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.290016
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.426
NEC for r=0.1 class 0.0 = 0.253 +- 0.457 (in-sample avg dev_std = 0.126)
NEC for r=0.1 class 1.0 = 0.752 +- 0.457 (in-sample avg dev_std = 0.126)
NEC for r=0.1 all KL = 0.642 +- 0.457 (in-sample avg dev_std = 0.126)
NEC for r=0.1 all L1 = 0.529 +- 0.393 (in-sample avg dev_std = 0.126)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20252599999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.534
NEC for r=0.2 class 0.0 = 0.413 +- 0.427 (in-sample avg dev_std = 0.459)
NEC for r=0.2 class 1.0 = 0.525 +- 0.427 (in-sample avg dev_std = 0.459)
NEC for r=0.2 all KL = 0.644 +- 0.427 (in-sample avg dev_std = 0.459)
NEC for r=0.2 all L1 = 0.475 +- 0.357 (in-sample avg dev_std = 0.459)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.12509399999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.725
NEC for r=0.4 class 0.0 = 0.456 +- 0.438 (in-sample avg dev_std = 0.443)
NEC for r=0.4 class 1.0 = 0.185 +- 0.438 (in-sample avg dev_std = 0.443)
NEC for r=0.4 all KL = 0.45 +- 0.438 (in-sample avg dev_std = 0.443)
NEC for r=0.4 all L1 = 0.306 +- 0.335 (in-sample avg dev_std = 0.443)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.094814
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.784
NEC for r=0.8 class 0.0 = 0.411 +- 0.431 (in-sample avg dev_std = 0.412)
NEC for r=0.8 class 1.0 = 0.111 +- 0.431 (in-sample avg dev_std = 0.412)
NEC for r=0.8 all KL = 0.364 +- 0.431 (in-sample avg dev_std = 0.412)
NEC for r=0.8 all L1 = 0.245 +- 0.320 (in-sample avg dev_std = 0.412)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1285566
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.531
NEC for r=0.05 class 0.0 = 0.108 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.749 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.488 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.431 +- 0.404 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.07448060000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.556
NEC for r=0.1 class 0.0 = 0.118 +- 0.468 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.702 +- 0.468 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.467 +- 0.468 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.413 +- 0.403 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.041658799999999996
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.64
NEC for r=0.2 class 0.0 = 0.305 +- 0.442 (in-sample avg dev_std = 0.417)
NEC for r=0.2 class 1.0 = 0.439 +- 0.442 (in-sample avg dev_std = 0.417)
NEC for r=0.2 all KL = 0.479 +- 0.442 (in-sample avg dev_std = 0.417)
NEC for r=0.2 all L1 = 0.372 +- 0.356 (in-sample avg dev_std = 0.417)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.022569400000000003
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.656
NEC for r=0.4 class 0.0 = 0.584 +- 0.448 (in-sample avg dev_std = 0.308)
NEC for r=0.4 class 1.0 = 0.1 +- 0.448 (in-sample avg dev_std = 0.308)
NEC for r=0.4 all KL = 0.415 +- 0.448 (in-sample avg dev_std = 0.308)
NEC for r=0.4 all L1 = 0.34 +- 0.375 (in-sample avg dev_std = 0.308)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012499000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.632
NEC for r=0.8 class 0.0 = 0.642 +- 0.459 (in-sample avg dev_std = 0.239)
NEC for r=0.8 class 1.0 = 0.081 +- 0.459 (in-sample avg dev_std = 0.239)
NEC for r=0.8 all KL = 0.436 +- 0.459 (in-sample avg dev_std = 0.239)
NEC for r=0.8 all L1 = 0.36 +- 0.386 (in-sample avg dev_std = 0.239)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.657
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1956148
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.564
NEC for r=0.05 class 0.0 = 0.059 +- 0.309 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.236 +- 0.309 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.146 +- 0.309 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.146 +- 0.278 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.657
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1417826
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.542
NEC for r=0.1 class 0.0 = 0.075 +- 0.335 (in-sample avg dev_std = 0.010)
NEC for r=0.1 class 1.0 = 0.264 +- 0.335 (in-sample avg dev_std = 0.010)
NEC for r=0.1 all KL = 0.174 +- 0.335 (in-sample avg dev_std = 0.010)
NEC for r=0.1 all L1 = 0.168 +- 0.296 (in-sample avg dev_std = 0.010)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.657
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09757640000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.532
NEC for r=0.2 class 0.0 = 0.103 +- 0.355 (in-sample avg dev_std = 0.070)
NEC for r=0.2 class 1.0 = 0.276 +- 0.355 (in-sample avg dev_std = 0.070)
NEC for r=0.2 all KL = 0.202 +- 0.355 (in-sample avg dev_std = 0.070)
NEC for r=0.2 all L1 = 0.188 +- 0.306 (in-sample avg dev_std = 0.070)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.657
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06960620000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.575
NEC for r=0.4 class 0.0 = 0.147 +- 0.371 (in-sample avg dev_std = 0.228)
NEC for r=0.4 class 1.0 = 0.295 +- 0.371 (in-sample avg dev_std = 0.228)
NEC for r=0.4 all KL = 0.26 +- 0.371 (in-sample avg dev_std = 0.228)
NEC for r=0.4 all L1 = 0.22 +- 0.306 (in-sample avg dev_std = 0.228)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.657
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0743998
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.618
NEC for r=0.8 class 0.0 = 0.168 +- 0.408 (in-sample avg dev_std = 0.320)
NEC for r=0.8 class 1.0 = 0.393 +- 0.408 (in-sample avg dev_std = 0.320)
NEC for r=0.8 all KL = 0.338 +- 0.408 (in-sample avg dev_std = 0.320)
NEC for r=0.8 all L1 = 0.279 +- 0.331 (in-sample avg dev_std = 0.320)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 21:12:17 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 09:12:17 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 09:12:17 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 09:12:17 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 09:12:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:12:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:12:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:12:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:12:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:12:17 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 09:12:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 66 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.9972
Train Loss: 0.0102
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0090
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0138
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0090
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.9972
Train Loss: 0.0102
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0090
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0138
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0090
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0138

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.453
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.377
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.248
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.149
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.100
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.152
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.083
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.045
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.025
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.014
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.252
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.189
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.130
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.091
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.084


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.453204
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.614
SUFF_SIMPLE for r=0.05 class 0.0 = 0.423 +- 0.477 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.796 +- 0.477 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.05 all KL = 0.527 +- 0.477 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.05 all L1 = 0.629 +- 0.395 (in-sample avg dev_std = 0.318)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.37665
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.603
SUFF_SIMPLE for r=0.1 class 0.0 = 0.414 +- 0.480 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.802 +- 0.480 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.1 all KL = 0.533 +- 0.480 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.1 all L1 = 0.629 +- 0.400 (in-sample avg dev_std = 0.286)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.248162
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.681
SUFF_SIMPLE for r=0.2 class 0.0 = 0.428 +- 0.467 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.913 +- 0.467 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 all KL = 0.618 +- 0.467 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 all L1 = 0.697 +- 0.384 (in-sample avg dev_std = 0.269)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.149492
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.752
SUFF_SIMPLE for r=0.4 class 0.0 = 0.486 +- 0.446 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.968 +- 0.446 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.4 all KL = 0.678 +- 0.446 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.4 all L1 = 0.753 +- 0.358 (in-sample avg dev_std = 0.268)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10047
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.904
SUFF_SIMPLE for r=0.8 class 0.0 = 0.83 +- 0.314 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.95 +- 0.314 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.867 +- 0.314 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.896 +- 0.252 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.757
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1520886
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.504
SUFF_SIMPLE for r=0.05 class 0.0 = 0.137 +- 0.427 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.565 +- 0.427 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.05 all KL = 0.263 +- 0.427 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.05 all L1 = 0.353 +- 0.363 (in-sample avg dev_std = 0.017)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.757
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0831856
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.504
SUFF_SIMPLE for r=0.1 class 0.0 = 0.137 +- 0.427 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.565 +- 0.427 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.1 all KL = 0.263 +- 0.427 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.1 all L1 = 0.353 +- 0.363 (in-sample avg dev_std = 0.019)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.757
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.045058600000000004
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.504
SUFF_SIMPLE for r=0.2 class 0.0 = 0.137 +- 0.427 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.565 +- 0.427 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.2 all KL = 0.263 +- 0.427 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.2 all L1 = 0.353 +- 0.363 (in-sample avg dev_std = 0.011)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.757
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024718
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.504
SUFF_SIMPLE for r=0.4 class 0.0 = 0.137 +- 0.427 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.565 +- 0.427 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.4 all KL = 0.263 +- 0.427 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.4 all L1 = 0.353 +- 0.363 (in-sample avg dev_std = 0.020)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.757
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.014107600000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.674
SUFF_SIMPLE for r=0.8 class 0.0 = 0.409 +- 0.464 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.568 +- 0.464 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.388 +- 0.464 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.489 +- 0.400 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.658
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25195080000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.577
SUFF_SIMPLE for r=0.05 class 0.0 = 0.768 +- 0.462 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.458 +- 0.462 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.05 all KL = 0.503 +- 0.462 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.05 all L1 = 0.615 +- 0.378 (in-sample avg dev_std = 0.324)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.658
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1887576
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.612
SUFF_SIMPLE for r=0.1 class 0.0 = 0.765 +- 0.457 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.535 +- 0.457 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.1 all KL = 0.549 +- 0.457 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.1 all L1 = 0.651 +- 0.373 (in-sample avg dev_std = 0.286)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.658
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.129688
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.65
SUFF_SIMPLE for r=0.2 class 0.0 = 0.789 +- 0.446 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.631 +- 0.446 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.2 all KL = 0.619 +- 0.446 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.2 all L1 = 0.711 +- 0.357 (in-sample avg dev_std = 0.266)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.658
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09080840000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.706
SUFF_SIMPLE for r=0.4 class 0.0 = 0.864 +- 0.414 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.688 +- 0.414 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.4 all KL = 0.712 +- 0.414 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.4 all L1 = 0.777 +- 0.331 (in-sample avg dev_std = 0.225)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.659
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08438720000000001
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.702
SUFF_SIMPLE for r=0.8 class 0.0 = 0.971 +- 0.286 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.813 +- 0.286 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.8 all KL = 0.872 +- 0.286 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.8 all L1 = 0.892 +- 0.238 (in-sample avg dev_std = 0.044)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.453204
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.534
NEC for r=0.05 class 0.0 = 0.158 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.632 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.507 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.421 +- 0.410 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.37665
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.408
NEC for r=0.1 class 0.0 = 0.313 +- 0.462 (in-sample avg dev_std = 0.107)
NEC for r=0.1 class 1.0 = 0.703 +- 0.462 (in-sample avg dev_std = 0.107)
NEC for r=0.1 all KL = 0.636 +- 0.462 (in-sample avg dev_std = 0.107)
NEC for r=0.1 all L1 = 0.529 +- 0.395 (in-sample avg dev_std = 0.107)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.248162
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.642
NEC for r=0.2 class 0.0 = 0.4 +- 0.446 (in-sample avg dev_std = 0.453)
NEC for r=0.2 class 1.0 = 0.359 +- 0.446 (in-sample avg dev_std = 0.453)
NEC for r=0.2 all KL = 0.538 +- 0.446 (in-sample avg dev_std = 0.453)
NEC for r=0.2 all L1 = 0.378 +- 0.354 (in-sample avg dev_std = 0.453)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.149492
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.762
NEC for r=0.4 class 0.0 = 0.461 +- 0.437 (in-sample avg dev_std = 0.396)
NEC for r=0.4 class 1.0 = 0.1 +- 0.437 (in-sample avg dev_std = 0.396)
NEC for r=0.4 all KL = 0.386 +- 0.437 (in-sample avg dev_std = 0.396)
NEC for r=0.4 all L1 = 0.261 +- 0.332 (in-sample avg dev_std = 0.396)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10047
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.8
NEC for r=0.8 class 0.0 = 0.416 +- 0.430 (in-sample avg dev_std = 0.397)
NEC for r=0.8 class 1.0 = 0.076 +- 0.430 (in-sample avg dev_std = 0.397)
NEC for r=0.8 all KL = 0.336 +- 0.430 (in-sample avg dev_std = 0.397)
NEC for r=0.8 all L1 = 0.227 +- 0.320 (in-sample avg dev_std = 0.397)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.757
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1520886
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.501
NEC for r=0.05 class 0.0 = 0.012 +- 0.427 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.457 +- 0.427 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.265 +- 0.427 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.236 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.757
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0831856
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.517
NEC for r=0.1 class 0.0 = 0.015 +- 0.428 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.458 +- 0.428 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.271 +- 0.428 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.239 +- 0.372 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.757
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.045058600000000004
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.611
NEC for r=0.2 class 0.0 = 0.167 +- 0.458 (in-sample avg dev_std = 0.431)
NEC for r=0.2 class 1.0 = 0.518 +- 0.458 (in-sample avg dev_std = 0.431)
NEC for r=0.2 all KL = 0.485 +- 0.458 (in-sample avg dev_std = 0.431)
NEC for r=0.2 all L1 = 0.344 +- 0.359 (in-sample avg dev_std = 0.431)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.757
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024718
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.725
NEC for r=0.4 class 0.0 = 0.492 +- 0.461 (in-sample avg dev_std = 0.502)
NEC for r=0.4 class 1.0 = 0.421 +- 0.461 (in-sample avg dev_std = 0.502)
NEC for r=0.4 all KL = 0.604 +- 0.461 (in-sample avg dev_std = 0.502)
NEC for r=0.4 all L1 = 0.456 +- 0.371 (in-sample avg dev_std = 0.502)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.757
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.014107600000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.727
NEC for r=0.8 class 0.0 = 0.507 +- 0.468 (in-sample avg dev_std = 0.428)
NEC for r=0.8 class 1.0 = 0.422 +- 0.468 (in-sample avg dev_std = 0.428)
NEC for r=0.8 all KL = 0.599 +- 0.468 (in-sample avg dev_std = 0.428)
NEC for r=0.8 all L1 = 0.464 +- 0.382 (in-sample avg dev_std = 0.428)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.658
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.25195080000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.565
NEC for r=0.05 class 0.0 = 0.049 +- 0.302 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.187 +- 0.302 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.124 +- 0.302 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.117 +- 0.269 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.658
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1887576
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.552
NEC for r=0.1 class 0.0 = 0.062 +- 0.321 (in-sample avg dev_std = 0.018)
NEC for r=0.1 class 1.0 = 0.202 +- 0.321 (in-sample avg dev_std = 0.018)
NEC for r=0.1 all KL = 0.144 +- 0.321 (in-sample avg dev_std = 0.018)
NEC for r=0.1 all L1 = 0.131 +- 0.281 (in-sample avg dev_std = 0.018)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.658
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.129688
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.541
NEC for r=0.2 class 0.0 = 0.108 +- 0.366 (in-sample avg dev_std = 0.170)
NEC for r=0.2 class 1.0 = 0.224 +- 0.366 (in-sample avg dev_std = 0.170)
NEC for r=0.2 all KL = 0.224 +- 0.366 (in-sample avg dev_std = 0.170)
NEC for r=0.2 all L1 = 0.165 +- 0.291 (in-sample avg dev_std = 0.170)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.658
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09080840000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.568
NEC for r=0.4 class 0.0 = 0.167 +- 0.391 (in-sample avg dev_std = 0.305)
NEC for r=0.4 class 1.0 = 0.249 +- 0.391 (in-sample avg dev_std = 0.305)
NEC for r=0.4 all KL = 0.302 +- 0.391 (in-sample avg dev_std = 0.305)
NEC for r=0.4 all L1 = 0.207 +- 0.297 (in-sample avg dev_std = 0.305)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.658
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08438720000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.615
NEC for r=0.8 class 0.0 = 0.185 +- 0.413 (in-sample avg dev_std = 0.344)
NEC for r=0.8 class 1.0 = 0.322 +- 0.413 (in-sample avg dev_std = 0.344)
NEC for r=0.8 all KL = 0.362 +- 0.413 (in-sample avg dev_std = 0.344)
NEC for r=0.8 all L1 = 0.253 +- 0.323 (in-sample avg dev_std = 0.344)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 21:29:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 09:29:30 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 09:29:30 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 09:29:30 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 09:29:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:29:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:29:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:29:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:29:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:29:30 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 09:29:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0000
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0000
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0000
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0000
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.510
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.426
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.318
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.208
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.121
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.241
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.132
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.069
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.037
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.019
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.307
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.241
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.190
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.146
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.106


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.51013
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.817
SUFF_SIMPLE for r=0.05 class 0.0 = 0.622 +- 0.421 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.974 +- 0.421 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.05 all KL = 0.754 +- 0.421 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.05 all L1 = 0.817 +- 0.329 (in-sample avg dev_std = 0.289)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.425676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.822
SUFF_SIMPLE for r=0.1 class 0.0 = 0.624 +- 0.408 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.996 +- 0.408 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.1 all KL = 0.785 +- 0.408 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.1 all L1 = 0.831 +- 0.328 (in-sample avg dev_std = 0.287)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.318306
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.854
SUFF_SIMPLE for r=0.2 class 0.0 = 0.67 +- 0.397 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.397 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.2 all KL = 0.799 +- 0.397 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.2 all L1 = 0.853 +- 0.301 (in-sample avg dev_std = 0.333)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.208474
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.924
SUFF_SIMPLE for r=0.4 class 0.0 = 0.807 +- 0.336 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.336 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.4 all KL = 0.865 +- 0.336 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.225 (in-sample avg dev_std = 0.326)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.120992
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.619
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.24126999999999998
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.732
SUFF_SIMPLE for r=0.05 class 0.0 = 0.574 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.361 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.37 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.467 +- 0.395 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.619
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13151000000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.732
SUFF_SIMPLE for r=0.1 class 0.0 = 0.574 +- 0.470 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.361 +- 0.470 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.1 all KL = 0.37 +- 0.470 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.1 all L1 = 0.467 +- 0.395 (in-sample avg dev_std = 0.013)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.619
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06946799999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.732
SUFF_SIMPLE for r=0.2 class 0.0 = 0.574 +- 0.470 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.361 +- 0.470 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.2 all KL = 0.37 +- 0.470 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.2 all L1 = 0.467 +- 0.395 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.619
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03662580000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.737
SUFF_SIMPLE for r=0.4 class 0.0 = 0.577 +- 0.470 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.361 +- 0.470 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.4 all KL = 0.37 +- 0.470 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.4 all L1 = 0.468 +- 0.394 (in-sample avg dev_std = 0.117)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.619
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0193212
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.911
SUFF_SIMPLE for r=0.8 class 0.0 = 0.886 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.362 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.552 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.622 +- 0.406 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.798
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3073686
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.768
SUFF_SIMPLE for r=0.05 class 0.0 = 0.827 +- 0.411 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.815 +- 0.411 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 all KL = 0.749 +- 0.411 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 all L1 = 0.821 +- 0.314 (in-sample avg dev_std = 0.178)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.798
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.240738
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.771
SUFF_SIMPLE for r=0.1 class 0.0 = 0.829 +- 0.393 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.841 +- 0.393 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.1 all KL = 0.784 +- 0.393 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.1 all L1 = 0.835 +- 0.315 (in-sample avg dev_std = 0.145)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.798
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1904696
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.777
SUFF_SIMPLE for r=0.2 class 0.0 = 0.839 +- 0.378 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.856 +- 0.378 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.2 all KL = 0.814 +- 0.378 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.2 all L1 = 0.847 +- 0.314 (in-sample avg dev_std = 0.112)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.798
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14582580000000003
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.806
SUFF_SIMPLE for r=0.4 class 0.0 = 0.885 +- 0.347 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.864 +- 0.347 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.4 all KL = 0.849 +- 0.347 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.4 all L1 = 0.875 +- 0.292 (in-sample avg dev_std = 0.080)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.799
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10550900000000002
len(reference) = 4991
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.853
SUFF_SIMPLE for r=0.8 class 0.0 = 0.994 +- 0.239 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.89 +- 0.239 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.931 +- 0.239 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.942 +- 0.202 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.51013
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.596
NEC for r=0.05 class 0.0 = 0.001 +- 0.489 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.633 +- 0.489 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.414 +- 0.489 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.351 +- 0.421 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.425676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.598
NEC for r=0.1 class 0.0 = 0.009 +- 0.490 (in-sample avg dev_std = 0.077)
NEC for r=0.1 class 1.0 = 0.633 +- 0.490 (in-sample avg dev_std = 0.077)
NEC for r=0.1 all KL = 0.421 +- 0.490 (in-sample avg dev_std = 0.077)
NEC for r=0.1 all L1 = 0.355 +- 0.419 (in-sample avg dev_std = 0.077)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.318306
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.771
NEC for r=0.2 class 0.0 = 0.14 +- 0.452 (in-sample avg dev_std = 0.398)
NEC for r=0.2 class 1.0 = 0.32 +- 0.452 (in-sample avg dev_std = 0.398)
NEC for r=0.2 all KL = 0.377 +- 0.452 (in-sample avg dev_std = 0.398)
NEC for r=0.2 all L1 = 0.239 +- 0.333 (in-sample avg dev_std = 0.398)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.208474
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.798
NEC for r=0.4 class 0.0 = 0.242 +- 0.437 (in-sample avg dev_std = 0.362)
NEC for r=0.4 class 1.0 = 0.178 +- 0.437 (in-sample avg dev_std = 0.362)
NEC for r=0.4 all KL = 0.327 +- 0.437 (in-sample avg dev_std = 0.362)
NEC for r=0.4 all L1 = 0.207 +- 0.323 (in-sample avg dev_std = 0.362)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.120992
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.881
NEC for r=0.8 class 0.0 = 0.228 +- 0.387 (in-sample avg dev_std = 0.337)
NEC for r=0.8 class 1.0 = 0.049 +- 0.387 (in-sample avg dev_std = 0.337)
NEC for r=0.8 all KL = 0.209 +- 0.387 (in-sample avg dev_std = 0.337)
NEC for r=0.8 all L1 = 0.129 +- 0.267 (in-sample avg dev_std = 0.337)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.619
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.24126999999999998
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.231 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.124 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.116 +- 0.281 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.619
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13151000000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
NEC for r=0.1 class 0.0 = 0.0 +- 0.310 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.228 +- 0.310 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.122 +- 0.310 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.115 +- 0.279 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.619
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06946799999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.627
NEC for r=0.2 class 0.0 = 0.364 +- 0.473 (in-sample avg dev_std = 0.357)
NEC for r=0.2 class 1.0 = 0.505 +- 0.473 (in-sample avg dev_std = 0.357)
NEC for r=0.2 all KL = 0.56 +- 0.473 (in-sample avg dev_std = 0.357)
NEC for r=0.2 all L1 = 0.435 +- 0.384 (in-sample avg dev_std = 0.357)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.619
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03662580000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.756
NEC for r=0.4 class 0.0 = 0.384 +- 0.467 (in-sample avg dev_std = 0.326)
NEC for r=0.4 class 1.0 = 0.628 +- 0.467 (in-sample avg dev_std = 0.326)
NEC for r=0.4 all KL = 0.624 +- 0.467 (in-sample avg dev_std = 0.326)
NEC for r=0.4 all L1 = 0.507 +- 0.386 (in-sample avg dev_std = 0.326)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.619
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0193212
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.785
NEC for r=0.8 class 0.0 = 0.367 +- 0.468 (in-sample avg dev_std = 0.347)
NEC for r=0.8 class 1.0 = 0.636 +- 0.468 (in-sample avg dev_std = 0.347)
NEC for r=0.8 all KL = 0.622 +- 0.468 (in-sample avg dev_std = 0.347)
NEC for r=0.8 all L1 = 0.502 +- 0.385 (in-sample avg dev_std = 0.347)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.798
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3073686
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.631
NEC for r=0.05 class 0.0 = 0.028 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.305 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.188 +- 0.382 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.165 +- 0.332 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.798
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.240738
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.626
NEC for r=0.1 class 0.0 = 0.039 +- 0.388 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.303 +- 0.388 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.196 +- 0.388 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.169 +- 0.335 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.798
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1904696
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.626
NEC for r=0.2 class 0.0 = 0.061 +- 0.403 (in-sample avg dev_std = 0.170)
NEC for r=0.2 class 1.0 = 0.313 +- 0.403 (in-sample avg dev_std = 0.170)
NEC for r=0.2 all KL = 0.232 +- 0.403 (in-sample avg dev_std = 0.170)
NEC for r=0.2 all L1 = 0.185 +- 0.336 (in-sample avg dev_std = 0.170)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.798
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.14582580000000003
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.698
NEC for r=0.4 class 0.0 = 0.11 +- 0.415 (in-sample avg dev_std = 0.377)
NEC for r=0.4 class 1.0 = 0.255 +- 0.415 (in-sample avg dev_std = 0.377)
NEC for r=0.4 all KL = 0.268 +- 0.415 (in-sample avg dev_std = 0.377)
NEC for r=0.4 all L1 = 0.182 +- 0.304 (in-sample avg dev_std = 0.377)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.798
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10550900000000002
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.724
NEC for r=0.8 class 0.0 = 0.13 +- 0.402 (in-sample avg dev_std = 0.330)
NEC for r=0.8 class 1.0 = 0.207 +- 0.402 (in-sample avg dev_std = 0.330)
NEC for r=0.8 all KL = 0.263 +- 0.402 (in-sample avg dev_std = 0.330)
NEC for r=0.8 all L1 = 0.168 +- 0.289 (in-sample avg dev_std = 0.330)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 21:46:48 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 09:46:48 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 09:46:48 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 09:46:48 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 09:46:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:46:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:46:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:46:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:46:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:46:48 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 09:46:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0002
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0002
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0002
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0002

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0002
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0002
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0002
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0002

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.535
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.500
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.370
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.241
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.147
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.238
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.130
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.070
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.037
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.020
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.349
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.292
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.223
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.168
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.127


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5350560000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.747
SUFF_SIMPLE for r=0.05 class 0.0 = 0.647 +- 0.454 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.859 +- 0.454 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.05 all KL = 0.697 +- 0.454 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.05 all L1 = 0.765 +- 0.363 (in-sample avg dev_std = 0.263)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.499676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.785
SUFF_SIMPLE for r=0.1 class 0.0 = 0.63 +- 0.423 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.931 +- 0.423 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.1 all KL = 0.743 +- 0.423 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.1 all L1 = 0.797 +- 0.347 (in-sample avg dev_std = 0.217)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.36993
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.796
SUFF_SIMPLE for r=0.2 class 0.0 = 0.6 +- 0.415 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.987 +- 0.415 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.2 all KL = 0.775 +- 0.415 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.2 all L1 = 0.814 +- 0.346 (in-sample avg dev_std = 0.201)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.240702
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.798
SUFF_SIMPLE for r=0.4 class 0.0 = 0.596 +- 0.414 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.993 +- 0.414 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 all KL = 0.78 +- 0.414 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 all L1 = 0.816 +- 0.348 (in-sample avg dev_std = 0.179)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.146824
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.914
SUFF_SIMPLE for r=0.8 class 0.0 = 0.82 +- 0.294 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.294 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.9 +- 0.294 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.92 +- 0.245 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.564
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.23845619999999998
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.704
SUFF_SIMPLE for r=0.05 class 0.0 = 0.622 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.362 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.364 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.491 +- 0.395 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.564
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13016
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.704
SUFF_SIMPLE for r=0.1 class 0.0 = 0.622 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.362 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.364 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.491 +- 0.395 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.564
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0701918
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.704
SUFF_SIMPLE for r=0.2 class 0.0 = 0.622 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.362 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.364 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.491 +- 0.395 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.564
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.037450199999999996
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.704
SUFF_SIMPLE for r=0.4 class 0.0 = 0.622 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.362 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.364 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.491 +- 0.395 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.564
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0201228
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.745
SUFF_SIMPLE for r=0.8 class 0.0 = 0.696 +- 0.465 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.363 +- 0.465 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.41 +- 0.465 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.528 +- 0.401 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.771
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.34878200000000004
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.701
SUFF_SIMPLE for r=0.05 class 0.0 = 0.836 +- 0.458 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.612 +- 0.458 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all KL = 0.623 +- 0.458 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all L1 = 0.726 +- 0.353 (in-sample avg dev_std = 0.323)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.771
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2917014
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.716
SUFF_SIMPLE for r=0.1 class 0.0 = 0.82 +- 0.450 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.674 +- 0.450 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.1 all KL = 0.659 +- 0.450 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.1 all L1 = 0.748 +- 0.352 (in-sample avg dev_std = 0.280)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.771
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.22268539999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.739
SUFF_SIMPLE for r=0.2 class 0.0 = 0.827 +- 0.427 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.754 +- 0.427 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.2 all KL = 0.721 +- 0.427 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.2 all L1 = 0.791 +- 0.336 (in-sample avg dev_std = 0.251)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.771
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1677538
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.765
SUFF_SIMPLE for r=0.4 class 0.0 = 0.839 +- 0.403 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.809 +- 0.403 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.4 all KL = 0.767 +- 0.403 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.4 all L1 = 0.824 +- 0.318 (in-sample avg dev_std = 0.238)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.772
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1269028
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.806
SUFF_SIMPLE for r=0.8 class 0.0 = 0.971 +- 0.255 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.89 +- 0.255 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 all KL = 0.917 +- 0.255 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 all L1 = 0.931 +- 0.211 (in-sample avg dev_std = 0.013)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5350560000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.6
NEC for r=0.05 class 0.0 = 0.0 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.638 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.418 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.354 +- 0.419 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.499676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.507
NEC for r=0.1 class 0.0 = 0.0 +- 0.495 (in-sample avg dev_std = 0.064)
NEC for r=0.1 class 1.0 = 0.779 +- 0.495 (in-sample avg dev_std = 0.064)
NEC for r=0.1 all KL = 0.506 +- 0.495 (in-sample avg dev_std = 0.064)
NEC for r=0.1 all L1 = 0.431 +- 0.427 (in-sample avg dev_std = 0.064)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.36993
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.701
NEC for r=0.2 class 0.0 = 0.009 +- 0.464 (in-sample avg dev_std = 0.448)
NEC for r=0.2 class 1.0 = 0.539 +- 0.464 (in-sample avg dev_std = 0.448)
NEC for r=0.2 all KL = 0.443 +- 0.464 (in-sample avg dev_std = 0.448)
NEC for r=0.2 all L1 = 0.303 +- 0.357 (in-sample avg dev_std = 0.448)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.240702
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.914
NEC for r=0.4 class 0.0 = 0.089 +- 0.362 (in-sample avg dev_std = 0.355)
NEC for r=0.4 class 1.0 = 0.119 +- 0.362 (in-sample avg dev_std = 0.355)
NEC for r=0.4 all KL = 0.204 +- 0.362 (in-sample avg dev_std = 0.355)
NEC for r=0.4 all L1 = 0.106 +- 0.215 (in-sample avg dev_std = 0.355)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.146824
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.908
NEC for r=0.8 class 0.0 = 0.19 +- 0.363 (in-sample avg dev_std = 0.330)
NEC for r=0.8 class 1.0 = 0.039 +- 0.363 (in-sample avg dev_std = 0.330)
NEC for r=0.8 all KL = 0.179 +- 0.363 (in-sample avg dev_std = 0.330)
NEC for r=0.8 all L1 = 0.106 +- 0.239 (in-sample avg dev_std = 0.330)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.564
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.23845619999999998
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.232 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.13 +- 0.232 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.067 +- 0.232 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.065 +- 0.214 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.564
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.13016
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.0 +- 0.232 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.13 +- 0.232 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.067 +- 0.232 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.065 +- 0.214 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.564
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0701918
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.515
NEC for r=0.2 class 0.0 = 0.0 +- 0.263 (in-sample avg dev_std = 0.149)
NEC for r=0.2 class 1.0 = 0.147 +- 0.263 (in-sample avg dev_std = 0.149)
NEC for r=0.2 all KL = 0.095 +- 0.263 (in-sample avg dev_std = 0.149)
NEC for r=0.2 all L1 = 0.074 +- 0.214 (in-sample avg dev_std = 0.149)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.564
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.037450199999999996
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.805
NEC for r=0.4 class 0.0 = 0.145 +- 0.460 (in-sample avg dev_std = 0.495)
NEC for r=0.4 class 1.0 = 0.594 +- 0.460 (in-sample avg dev_std = 0.495)
NEC for r=0.4 all KL = 0.541 +- 0.460 (in-sample avg dev_std = 0.495)
NEC for r=0.4 all L1 = 0.372 +- 0.359 (in-sample avg dev_std = 0.495)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.564
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0201228
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.789
NEC for r=0.8 class 0.0 = 0.264 +- 0.457 (in-sample avg dev_std = 0.390)
NEC for r=0.8 class 1.0 = 0.633 +- 0.457 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all KL = 0.606 +- 0.457 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all L1 = 0.45 +- 0.379 (in-sample avg dev_std = 0.390)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.771
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.34878200000000004
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.612
NEC for r=0.05 class 0.0 = 0.021 +- 0.376 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.304 +- 0.376 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.182 +- 0.376 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.161 +- 0.327 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.771
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2917014
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.594
NEC for r=0.1 class 0.0 = 0.022 +- 0.391 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.337 +- 0.391 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.202 +- 0.391 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.178 +- 0.340 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.771
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.22268539999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.589
NEC for r=0.2 class 0.0 = 0.026 +- 0.396 (in-sample avg dev_std = 0.073)
NEC for r=0.2 class 1.0 = 0.347 +- 0.396 (in-sample avg dev_std = 0.073)
NEC for r=0.2 all KL = 0.216 +- 0.396 (in-sample avg dev_std = 0.073)
NEC for r=0.2 all L1 = 0.184 +- 0.341 (in-sample avg dev_std = 0.073)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.771
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1677538
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.642
NEC for r=0.4 class 0.0 = 0.055 +- 0.411 (in-sample avg dev_std = 0.336)
NEC for r=0.4 class 1.0 = 0.344 +- 0.411 (in-sample avg dev_std = 0.336)
NEC for r=0.4 all KL = 0.265 +- 0.411 (in-sample avg dev_std = 0.336)
NEC for r=0.4 all L1 = 0.197 +- 0.320 (in-sample avg dev_std = 0.336)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.771
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1269028
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.715
NEC for r=0.8 class 0.0 = 0.111 +- 0.391 (in-sample avg dev_std = 0.349)
NEC for r=0.8 class 1.0 = 0.231 +- 0.391 (in-sample avg dev_std = 0.349)
NEC for r=0.8 all KL = 0.255 +- 0.391 (in-sample avg dev_std = 0.349)
NEC for r=0.8 all L1 = 0.171 +- 0.285 (in-sample avg dev_std = 0.349)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 22:03:16 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:03:16 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:03:16 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:03:16 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:03:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:03:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:03:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:03:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:03:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:03:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:03:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.389
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.320
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.224
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.135
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.170
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.095
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.030
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.015
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.246
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.191
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.139
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.103
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.38880200000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.796
SUFF_SIMPLE for r=0.05 class 0.0 = 0.593 +- 0.410 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.410 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.05 all KL = 0.786 +- 0.410 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.05 all L1 = 0.818 +- 0.349 (in-sample avg dev_std = 0.164)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.31998800000000005
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.799
SUFF_SIMPLE for r=0.1 class 0.0 = 0.597 +- 0.410 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.410 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.1 all KL = 0.786 +- 0.410 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.1 all L1 = 0.82 +- 0.346 (in-sample avg dev_std = 0.187)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.224438
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.794
SUFF_SIMPLE for r=0.2 class 0.0 = 0.592 +- 0.410 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.410 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.2 all KL = 0.786 +- 0.410 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.2 all L1 = 0.818 +- 0.349 (in-sample avg dev_std = 0.161)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.13499599999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.806
SUFF_SIMPLE for r=0.4 class 0.0 = 0.613 +- 0.404 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.404 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 all KL = 0.794 +- 0.404 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 all L1 = 0.827 +- 0.341 (in-sample avg dev_std = 0.162)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07880200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.992
SUFF_SIMPLE for r=0.8 class 0.0 = 0.979 +- 0.109 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.109 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.988 +- 0.109 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.991 +- 0.083 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.999
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1695728
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.746
SUFF_SIMPLE for r=0.05 class 0.0 = 0.558 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.745 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.78 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0945816
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.746
SUFF_SIMPLE for r=0.1 class 0.0 = 0.558 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.745 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.78 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.999
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05013100000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.746
SUFF_SIMPLE for r=0.2 class 0.0 = 0.558 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.745 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.78 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.999
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.029687800000000004
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.746
SUFF_SIMPLE for r=0.4 class 0.0 = 0.558 +- 0.435 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.997 +- 0.435 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.4 all KL = 0.745 +- 0.435 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.4 all L1 = 0.779 +- 0.376 (in-sample avg dev_std = 0.007)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.999
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.015123000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.966
SUFF_SIMPLE for r=0.8 class 0.0 = 0.958 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.972 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.953 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.965 +- 0.157 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.975
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2455962
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.884
SUFF_SIMPLE for r=0.05 class 0.0 = 0.838 +- 0.295 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.295 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.05 all KL = 0.901 +- 0.295 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.05 all L1 = 0.918 +- 0.248 (in-sample avg dev_std = 0.099)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.975
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.191233
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.886
SUFF_SIMPLE for r=0.1 class 0.0 = 0.841 +- 0.293 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.293 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.1 all KL = 0.902 +- 0.293 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.1 all L1 = 0.92 +- 0.245 (in-sample avg dev_std = 0.108)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.975
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.138973
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.904
SUFF_SIMPLE for r=0.2 class 0.0 = 0.87 +- 0.269 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.269 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.2 all KL = 0.918 +- 0.269 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.2 all L1 = 0.934 +- 0.222 (in-sample avg dev_std = 0.093)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.975
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1028642
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.926
SUFF_SIMPLE for r=0.4 class 0.0 = 0.916 +- 0.214 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.214 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.4 all KL = 0.951 +- 0.214 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.4 all L1 = 0.957 +- 0.185 (in-sample avg dev_std = 0.006)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.977
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0797904
len(reference) = 4961
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.972
SUFF_SIMPLE for r=0.8 class 0.0 = 0.987 +- 0.076 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.076 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.993 +- 0.076 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.994 +- 0.066 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.38880200000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.718
NEC for r=0.05 class 0.0 = 0.073 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.407 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.32 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.258 +- 0.381 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.31998800000000005
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.773
NEC for r=0.1 class 0.0 = 0.16 +- 0.431 (in-sample avg dev_std = 0.189)
NEC for r=0.1 class 1.0 = 0.254 +- 0.431 (in-sample avg dev_std = 0.189)
NEC for r=0.1 all KL = 0.277 +- 0.431 (in-sample avg dev_std = 0.189)
NEC for r=0.1 all L1 = 0.212 +- 0.350 (in-sample avg dev_std = 0.189)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.224438
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.821
NEC for r=0.2 class 0.0 = 0.279 +- 0.411 (in-sample avg dev_std = 0.263)
NEC for r=0.2 class 1.0 = 0.095 +- 0.411 (in-sample avg dev_std = 0.263)
NEC for r=0.2 all KL = 0.251 +- 0.411 (in-sample avg dev_std = 0.263)
NEC for r=0.2 all L1 = 0.177 +- 0.319 (in-sample avg dev_std = 0.263)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.13499599999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.858
NEC for r=0.4 class 0.0 = 0.313 +- 0.397 (in-sample avg dev_std = 0.328)
NEC for r=0.4 class 1.0 = 0.008 +- 0.397 (in-sample avg dev_std = 0.328)
NEC for r=0.4 all KL = 0.208 +- 0.397 (in-sample avg dev_std = 0.328)
NEC for r=0.4 all L1 = 0.144 +- 0.294 (in-sample avg dev_std = 0.328)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07880200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.886
NEC for r=0.8 class 0.0 = 0.272 +- 0.385 (in-sample avg dev_std = 0.324)
NEC for r=0.8 class 1.0 = 0.0 +- 0.385 (in-sample avg dev_std = 0.324)
NEC for r=0.8 all KL = 0.194 +- 0.385 (in-sample avg dev_std = 0.324)
NEC for r=0.8 all L1 = 0.121 +- 0.264 (in-sample avg dev_std = 0.324)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.999
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.1695728
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.73
NEC for r=0.05 class 0.0 = 0.23 +- 0.447 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.25 +- 0.447 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.288 +- 0.447 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.24 +- 0.380 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0945816
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.796
NEC for r=0.1 class 0.0 = 0.334 +- 0.406 (in-sample avg dev_std = 0.010)
NEC for r=0.1 class 1.0 = 0.028 +- 0.406 (in-sample avg dev_std = 0.010)
NEC for r=0.1 all KL = 0.212 +- 0.406 (in-sample avg dev_std = 0.010)
NEC for r=0.1 all L1 = 0.18 +- 0.347 (in-sample avg dev_std = 0.010)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.999
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05013100000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.854
NEC for r=0.2 class 0.0 = 0.277 +- 0.380 (in-sample avg dev_std = 0.231)
NEC for r=0.2 class 1.0 = 0.002 +- 0.380 (in-sample avg dev_std = 0.231)
NEC for r=0.2 all KL = 0.179 +- 0.380 (in-sample avg dev_std = 0.231)
NEC for r=0.2 all L1 = 0.138 +- 0.303 (in-sample avg dev_std = 0.231)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.999
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.029687800000000004
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.751
NEC for r=0.4 class 0.0 = 0.439 +- 0.435 (in-sample avg dev_std = 0.124)
NEC for r=0.4 class 1.0 = 0.002 +- 0.435 (in-sample avg dev_std = 0.124)
NEC for r=0.4 all KL = 0.255 +- 0.435 (in-sample avg dev_std = 0.124)
NEC for r=0.4 all L1 = 0.219 +- 0.374 (in-sample avg dev_std = 0.124)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.999
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.015123000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.752
NEC for r=0.8 class 0.0 = 0.439 +- 0.435 (in-sample avg dev_std = 0.134)
NEC for r=0.8 class 1.0 = 0.002 +- 0.435 (in-sample avg dev_std = 0.134)
NEC for r=0.8 all KL = 0.255 +- 0.435 (in-sample avg dev_std = 0.134)
NEC for r=0.8 all L1 = 0.219 +- 0.373 (in-sample avg dev_std = 0.134)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.975
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2455962
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.638
NEC for r=0.05 class 0.0 = 0.033 +- 0.480 (in-sample avg dev_std = 0.222)
NEC for r=0.05 class 1.0 = 0.598 +- 0.480 (in-sample avg dev_std = 0.222)
NEC for r=0.05 all KL = 0.376 +- 0.480 (in-sample avg dev_std = 0.222)
NEC for r=0.05 all L1 = 0.312 +- 0.403 (in-sample avg dev_std = 0.222)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.975
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.191233
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.755
NEC for r=0.1 class 0.0 = 0.052 +- 0.444 (in-sample avg dev_std = 0.329)
NEC for r=0.1 class 1.0 = 0.404 +- 0.444 (in-sample avg dev_std = 0.329)
NEC for r=0.1 all KL = 0.319 +- 0.444 (in-sample avg dev_std = 0.329)
NEC for r=0.1 all L1 = 0.226 +- 0.343 (in-sample avg dev_std = 0.329)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.975
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.138973
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.881
NEC for r=0.2 class 0.0 = 0.064 +- 0.355 (in-sample avg dev_std = 0.302)
NEC for r=0.2 class 1.0 = 0.153 +- 0.355 (in-sample avg dev_std = 0.302)
NEC for r=0.2 all KL = 0.177 +- 0.355 (in-sample avg dev_std = 0.302)
NEC for r=0.2 all L1 = 0.108 +- 0.243 (in-sample avg dev_std = 0.302)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.975
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1028642
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.923
NEC for r=0.4 class 0.0 = 0.084 +- 0.272 (in-sample avg dev_std = 0.220)
NEC for r=0.4 class 1.0 = 0.03 +- 0.272 (in-sample avg dev_std = 0.220)
NEC for r=0.4 all KL = 0.097 +- 0.272 (in-sample avg dev_std = 0.220)
NEC for r=0.4 all L1 = 0.057 +- 0.184 (in-sample avg dev_std = 0.220)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.975
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0797904
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.907
NEC for r=0.8 class 0.0 = 0.116 +- 0.274 (in-sample avg dev_std = 0.148)
NEC for r=0.8 class 1.0 = 0.015 +- 0.274 (in-sample avg dev_std = 0.148)
NEC for r=0.8 all KL = 0.092 +- 0.274 (in-sample avg dev_std = 0.148)
NEC for r=0.8 all L1 = 0.066 +- 0.214 (in-sample avg dev_std = 0.148)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.655, 0.67, 0.738, 0.817, 0.958], 'all_L1': [0.72, 0.731, 0.79, 0.856, 0.966]}), defaultdict(<class 'list'>, {'all_KL': [0.786, 0.79, 0.793, 0.852, 1.0], 'all_L1': [0.819, 0.821, 0.83, 0.887, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.783, 0.788, 0.788, 0.824, 1.0], 'all_L1': [0.82, 0.824, 0.824, 0.859, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.759, 0.788, 0.794, 0.81, 0.999], 'all_L1': [0.808, 0.821, 0.824, 0.84, 0.999]}), defaultdict(<class 'list'>, {'all_KL': [0.779, 0.787, 0.786, 0.803, 0.998], 'all_L1': [0.817, 0.82, 0.818, 0.835, 0.998]}), defaultdict(<class 'list'>, {'all_KL': [0.573, 0.611, 0.669, 0.769, 0.962], 'all_L1': [0.661, 0.687, 0.741, 0.825, 0.968]}), defaultdict(<class 'list'>, {'all_KL': [0.527, 0.533, 0.618, 0.678, 0.867], 'all_L1': [0.629, 0.629, 0.697, 0.753, 0.896]}), defaultdict(<class 'list'>, {'all_KL': [0.754, 0.785, 0.799, 0.865, 1.0], 'all_L1': [0.817, 0.831, 0.853, 0.914, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.697, 0.743, 0.775, 0.78, 0.9], 'all_L1': [0.765, 0.797, 0.814, 0.816, 0.92]}), defaultdict(<class 'list'>, {'all_KL': [0.786, 0.786, 0.786, 0.794, 0.988], 'all_L1': [0.818, 0.82, 0.818, 0.827, 0.991]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.466, 0.629, 0.573, 0.358, 0.268], 'all_L1': [0.394, 0.52, 0.421, 0.247, 0.182]}), defaultdict(<class 'list'>, {'all_KL': [0.2, 0.222, 0.228, 0.211, 0.2], 'all_L1': [0.17, 0.182, 0.143, 0.141, 0.132]}), defaultdict(<class 'list'>, {'all_KL': [0.265, 0.352, 0.292, 0.232, 0.198], 'all_L1': [0.227, 0.3, 0.2, 0.148, 0.126]}), defaultdict(<class 'list'>, {'all_KL': [0.376, 0.51, 0.468, 0.274, 0.23], 'all_L1': [0.318, 0.429, 0.337, 0.189, 0.162]}), defaultdict(<class 'list'>, {'all_KL': [0.309, 0.342, 0.248, 0.182, 0.196], 'all_L1': [0.262, 0.289, 0.149, 0.113, 0.124]}), defaultdict(<class 'list'>, {'all_KL': [0.487, 0.642, 0.644, 0.45, 0.364], 'all_L1': [0.41, 0.529, 0.475, 0.306, 0.245]}), defaultdict(<class 'list'>, {'all_KL': [0.507, 0.636, 0.538, 0.386, 0.336], 'all_L1': [0.421, 0.529, 0.378, 0.261, 0.227]}), defaultdict(<class 'list'>, {'all_KL': [0.414, 0.421, 0.377, 0.327, 0.209], 'all_L1': [0.351, 0.355, 0.239, 0.207, 0.129]}), defaultdict(<class 'list'>, {'all_KL': [0.418, 0.506, 0.443, 0.204, 0.179], 'all_L1': [0.354, 0.431, 0.303, 0.106, 0.106]}), defaultdict(<class 'list'>, {'all_KL': [0.32, 0.277, 0.251, 0.208, 0.194], 'all_L1': [0.258, 0.212, 0.177, 0.144, 0.121]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.761, 0.761, 0.762, 0.763, 0.887], 'all_L1': [0.8, 0.8, 0.8, 0.801, 0.895]}), defaultdict(<class 'list'>, {'all_KL': [0.744, 0.744, 0.744, 0.744, 0.995], 'all_L1': [0.779, 0.779, 0.779, 0.779, 0.994]}), defaultdict(<class 'list'>, {'all_KL': [0.741, 0.741, 0.741, 0.741, 0.985], 'all_L1': [0.776, 0.776, 0.776, 0.776, 0.988]}), defaultdict(<class 'list'>, {'all_KL': [0.747, 0.747, 0.747, 0.747, 0.971], 'all_L1': [0.793, 0.793, 0.793, 0.793, 0.975]}), defaultdict(<class 'list'>, {'all_KL': [0.429, 0.429, 0.429, 0.429, 0.501], 'all_L1': [0.5, 0.5, 0.5, 0.5, 0.565]}), defaultdict(<class 'list'>, {'all_KL': [0.501, 0.501, 0.501, 0.5, 0.697], 'all_L1': [0.55, 0.55, 0.55, 0.55, 0.743]}), defaultdict(<class 'list'>, {'all_KL': [0.263, 0.263, 0.263, 0.263, 0.388], 'all_L1': [0.353, 0.353, 0.353, 0.353, 0.489]}), defaultdict(<class 'list'>, {'all_KL': [0.37, 0.37, 0.37, 0.37, 0.552], 'all_L1': [0.467, 0.467, 0.467, 0.468, 0.622]}), defaultdict(<class 'list'>, {'all_KL': [0.364, 0.364, 0.364, 0.364, 0.41], 'all_L1': [0.491, 0.491, 0.491, 0.491, 0.528]}), defaultdict(<class 'list'>, {'all_KL': [0.745, 0.745, 0.745, 0.745, 0.953], 'all_L1': [0.78, 0.78, 0.78, 0.779, 0.965]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.403, 0.473, 0.414, 0.24, 0.231], 'all_L1': [0.351, 0.405, 0.331, 0.198, 0.194]}), defaultdict(<class 'list'>, {'all_KL': [0.471, 0.388, 0.257, 0.256, 0.256], 'all_L1': [0.409, 0.328, 0.221, 0.221, 0.221]}), defaultdict(<class 'list'>, {'all_KL': [0.478, 0.454, 0.293, 0.259, 0.259], 'all_L1': [0.411, 0.385, 0.244, 0.224, 0.224]}), defaultdict(<class 'list'>, {'all_KL': [0.456, 0.402, 0.292, 0.254, 0.253], 'all_L1': [0.393, 0.34, 0.236, 0.208, 0.207]}), defaultdict(<class 'list'>, {'all_KL': [0.187, 0.199, 0.532, 0.572, 0.57], 'all_L1': [0.168, 0.177, 0.442, 0.497, 0.496]}), defaultdict(<class 'list'>, {'all_KL': [0.488, 0.467, 0.479, 0.415, 0.436], 'all_L1': [0.431, 0.413, 0.372, 0.34, 0.36]}), defaultdict(<class 'list'>, {'all_KL': [0.265, 0.271, 0.485, 0.604, 0.599], 'all_L1': [0.236, 0.239, 0.344, 0.456, 0.464]}), defaultdict(<class 'list'>, {'all_KL': [0.124, 0.122, 0.56, 0.624, 0.622], 'all_L1': [0.116, 0.115, 0.435, 0.507, 0.502]}), defaultdict(<class 'list'>, {'all_KL': [0.067, 0.067, 0.095, 0.541, 0.606], 'all_L1': [0.065, 0.065, 0.074, 0.372, 0.45]}), defaultdict(<class 'list'>, {'all_KL': [0.288, 0.212, 0.179, 0.255, 0.255], 'all_L1': [0.24, 0.18, 0.138, 0.219, 0.219]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.621, 0.672, 0.734, 0.772, 0.823], 'all_L1': [0.657, 0.703, 0.755, 0.787, 0.818]}), defaultdict(<class 'list'>, {'all_KL': [0.815, 0.815, 0.816, 0.872, 0.918], 'all_L1': [0.85, 0.85, 0.85, 0.9, 0.923]}), defaultdict(<class 'list'>, {'all_KL': [0.88, 0.883, 0.886, 0.919, 0.987], 'all_L1': [0.897, 0.898, 0.899, 0.929, 0.981]}), defaultdict(<class 'list'>, {'all_KL': [0.824, 0.862, 0.893, 0.926, 0.994], 'all_L1': [0.881, 0.899, 0.914, 0.941, 0.994]}), defaultdict(<class 'list'>, {'all_KL': [0.777, 0.788, 0.801, 0.806, 0.894], 'all_L1': [0.834, 0.839, 0.843, 0.846, 0.909]}), defaultdict(<class 'list'>, {'all_KL': [0.546, 0.582, 0.654, 0.735, 0.88], 'all_L1': [0.617, 0.647, 0.708, 0.771, 0.878]}), defaultdict(<class 'list'>, {'all_KL': [0.503, 0.549, 0.619, 0.712, 0.872], 'all_L1': [0.615, 0.651, 0.711, 0.777, 0.892]}), defaultdict(<class 'list'>, {'all_KL': [0.749, 0.784, 0.814, 0.849, 0.931], 'all_L1': [0.821, 0.835, 0.847, 0.875, 0.942]}), defaultdict(<class 'list'>, {'all_KL': [0.623, 0.659, 0.721, 0.767, 0.917], 'all_L1': [0.726, 0.748, 0.791, 0.824, 0.931]}), defaultdict(<class 'list'>, {'all_KL': [0.901, 0.902, 0.918, 0.951, 0.993], 'all_L1': [0.918, 0.92, 0.934, 0.957, 0.994]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.257, 0.282, 0.312, 0.333, 0.309], 'all_L1': [0.253, 0.271, 0.289, 0.299, 0.275]}), defaultdict(<class 'list'>, {'all_KL': [0.246, 0.241, 0.222, 0.204, 0.15], 'all_L1': [0.216, 0.211, 0.187, 0.141, 0.11]}), defaultdict(<class 'list'>, {'all_KL': [0.327, 0.33, 0.302, 0.234, 0.153], 'all_L1': [0.284, 0.286, 0.252, 0.171, 0.113]}), defaultdict(<class 'list'>, {'all_KL': [0.362, 0.406, 0.403, 0.28, 0.166], 'all_L1': [0.312, 0.344, 0.3, 0.169, 0.107]}), defaultdict(<class 'list'>, {'all_KL': [0.205, 0.213, 0.218, 0.185, 0.152], 'all_L1': [0.18, 0.184, 0.185, 0.138, 0.112]}), defaultdict(<class 'list'>, {'all_KL': [0.146, 0.174, 0.202, 0.26, 0.338], 'all_L1': [0.146, 0.168, 0.188, 0.22, 0.279]}), defaultdict(<class 'list'>, {'all_KL': [0.124, 0.144, 0.224, 0.302, 0.362], 'all_L1': [0.117, 0.131, 0.165, 0.207, 0.253]}), defaultdict(<class 'list'>, {'all_KL': [0.188, 0.196, 0.232, 0.268, 0.263], 'all_L1': [0.165, 0.169, 0.185, 0.182, 0.168]}), defaultdict(<class 'list'>, {'all_KL': [0.182, 0.202, 0.216, 0.265, 0.255], 'all_L1': [0.161, 0.178, 0.184, 0.197, 0.171]}), defaultdict(<class 'list'>, {'all_KL': [0.376, 0.319, 0.177, 0.097, 0.092], 'all_L1': [0.312, 0.226, 0.108, 0.057, 0.066]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.767 +- 0.069, 0.778 +- 0.067, 0.801 +- 0.045, 0.841 +- 0.041, 0.974 +- 0.036
suff_simple class all_KL  =  0.710 +- 0.090, 0.728 +- 0.087, 0.755 +- 0.059, 0.799 +- 0.049, 0.967 +- 0.045
[[0.6997500061988831, 0.7172499895095825, 0.7854999899864197, 0.8600000143051147, 0.9739999771118164], [0.7957500219345093, 0.7979999780654907, 0.8149999976158142, 0.8832499980926514, 1.0], [0.8034999966621399, 0.8069999814033508, 0.8059999942779541, 0.8527500033378601, 1.0], [0.7960000038146973, 0.7994999885559082, 0.7994999885559082, 0.8212500214576721, 1.0], [0.796750009059906, 0.7962499856948853, 0.7947499752044678, 0.8174999952316284, 0.9980000257492065], [0.6389999985694885, 0.6704999804496765, 0.7427499890327454, 0.8402500152587891, 0.9779999852180481], [0.6140000224113464, 0.6027500033378601, 0.6807500123977661, 0.7517499923706055, 0.9039999842643738], [0.8169999718666077, 0.8222500085830688, 0.8542500138282776, 0.9235000014305115, 1.0], [0.746749997138977, 0.784500002861023, 0.7957500219345093, 0.7979999780654907, 0.9139999747276306], [0.7962499856948853, 0.7994999885559082, 0.7942500114440918, 0.8062499761581421, 0.9919999837875366]]
[[0.655, 0.67, 0.738, 0.817, 0.958], [0.786, 0.79, 0.793, 0.852, 1.0], [0.783, 0.788, 0.788, 0.824, 1.0], [0.759, 0.788, 0.794, 0.81, 0.999], [0.779, 0.787, 0.786, 0.803, 0.998], [0.573, 0.611, 0.669, 0.769, 0.962], [0.527, 0.533, 0.618, 0.678, 0.867], [0.754, 0.785, 0.799, 0.865, 1.0], [0.697, 0.743, 0.775, 0.78, 0.9], [0.786, 0.786, 0.786, 0.794, 0.988]]
suff_simple_acc_int  =  0.750 +- 0.070, 0.760 +- 0.069, 0.787 +- 0.044, 0.835 +- 0.046, 0.976 +- 0.035
nec class all_L1  =  0.317 +- 0.080, 0.378 +- 0.123, 0.282 +- 0.112, 0.186 +- 0.064, 0.155 +- 0.045
nec class all_KL  =  0.376 +- 0.096, 0.454 +- 0.146, 0.406 +- 0.142, 0.283 +- 0.087, 0.237 +- 0.061
[[0.5600000023841858, 0.42925000190734863, 0.5770000219345093, 0.765250027179718, 0.8364999890327454], [0.8040000200271606, 0.7952499985694885, 0.8640000224113464, 0.8604999780654907, 0.8730000257492065], [0.7419999837875366, 0.6577500104904175, 0.8009999990463257, 0.8579999804496765, 0.8820000290870667], [0.6380000114440918, 0.5122500061988831, 0.6579999923706055, 0.8195000290870667, 0.8442500233650208], [0.7020000219345093, 0.672249972820282, 0.8652499914169312, 0.8930000066757202, 0.8857499957084656], [0.5540000200271606, 0.4259999990463257, 0.5337499976158142, 0.7250000238418579, 0.7837499976158142], [0.5339999794960022, 0.40825000405311584, 0.6422500014305115, 0.7620000243186951, 0.800000011920929], [0.5960000157356262, 0.5979999899864197, 0.7710000276565552, 0.7982500195503235, 0.8805000185966492], [0.6000000238418579, 0.5072500109672546, 0.7005000114440918, 0.9144999980926514, 0.9079999923706055], [0.7179999947547913, 0.7730000019073486, 0.8205000162124634, 0.8577499985694885, 0.8855000138282776]]
[[0.466, 0.629, 0.573, 0.358, 0.268], [0.2, 0.222, 0.228, 0.211, 0.2], [0.265, 0.352, 0.292, 0.232, 0.198], [0.376, 0.51, 0.468, 0.274, 0.23], [0.309, 0.342, 0.248, 0.182, 0.196], [0.487, 0.642, 0.644, 0.45, 0.364], [0.507, 0.636, 0.538, 0.386, 0.336], [0.414, 0.421, 0.377, 0.327, 0.209], [0.418, 0.506, 0.443, 0.204, 0.179], [0.32, 0.277, 0.251, 0.208, 0.194]]
nec_acc_int  =  0.645 +- 0.087, 0.578 +- 0.136, 0.723 +- 0.112, 0.825 +- 0.059, 0.858 +- 0.039

Eval split val
suff_simple class all_L1  =  0.629 +- 0.164, 0.629 +- 0.164, 0.629 +- 0.164, 0.629 +- 0.163, 0.776 +- 0.199
suff_simple class all_KL  =  0.567 +- 0.190, 0.567 +- 0.190, 0.567 +- 0.190, 0.567 +- 0.190, 0.734 +- 0.239
[[0.6741499900817871, 0.6742249727249146, 0.6741999983787537, 0.6774749755859375, 0.7698000073432922], [0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.7472749948501587, 0.9962000250816345], [0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.7465500235557556, 0.989799976348877], [0.7268000245094299, 0.7268000245094299, 0.7268000245094299, 0.7268750071525574, 0.9333999752998352], [0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.8223999738693237], [0.5040000081062317, 0.5040249824523926, 0.5040249824523926, 0.5042499899864197, 0.7498000264167786], [0.5040749907493591, 0.5041499733924866, 0.5040249824523926, 0.5041000247001648, 0.6740000247955322], [0.732200026512146, 0.7322499752044678, 0.7322250008583069, 0.7366499900817871, 0.9114000201225281], [0.7035999894142151, 0.7035999894142151, 0.7035999894142151, 0.7035999894142151, 0.7447999715805054], [0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.7461749911308289, 0.9660000205039978]]
[[0.761, 0.761, 0.762, 0.763, 0.887], [0.744, 0.744, 0.744, 0.744, 0.995], [0.741, 0.741, 0.741, 0.741, 0.985], [0.747, 0.747, 0.747, 0.747, 0.971], [0.429, 0.429, 0.429, 0.429, 0.501], [0.501, 0.501, 0.501, 0.5, 0.697], [0.263, 0.263, 0.263, 0.263, 0.388], [0.37, 0.37, 0.37, 0.37, 0.552], [0.364, 0.364, 0.364, 0.364, 0.41], [0.745, 0.745, 0.745, 0.745, 0.953]]
suff_simple_acc_int  =  0.683 +- 0.092, 0.683 +- 0.092, 0.683 +- 0.092, 0.684 +- 0.092, 0.856 +- 0.111
nec class all_L1  =  0.282 +- 0.128, 0.265 +- 0.120, 0.284 +- 0.116, 0.324 +- 0.120, 0.334 +- 0.126
nec class all_KL  =  0.323 +- 0.150, 0.305 +- 0.143, 0.359 +- 0.150, 0.402 +- 0.158, 0.409 +- 0.165
[[0.46239998936653137, 0.40139999985694885, 0.5115749835968018, 0.6706749796867371, 0.6769750118255615], [0.525600016117096, 0.6295999884605408, 0.74795001745224, 0.7470499873161316, 0.7473999857902527], [0.5235999822616577, 0.5594000220298767, 0.7300999760627747, 0.74652498960495, 0.7475000023841858], [0.5257999897003174, 0.5843999981880188, 0.6982250213623047, 0.7264999747276306, 0.7273749709129333], [0.4959999918937683, 0.492000013589859, 0.6539250016212463, 0.7476750016212463, 0.7579249739646912], [0.5311999917030334, 0.5555999875068665, 0.6399499773979187, 0.6556500196456909, 0.6317499876022339], [0.5013999938964844, 0.5166000127792358, 0.6113250255584717, 0.7249000072479248, 0.7266250252723694], [0.4959999918937683, 0.498199999332428, 0.6268749833106995, 0.7555999755859375, 0.7846750020980835], [0.4959999918937683, 0.4959999918937683, 0.514549970626831, 0.8048250079154968, 0.7887499928474426], [0.7296000123023987, 0.7961750030517578, 0.8537999987602234, 0.7508249878883362, 0.7516499757766724]]
[[0.403, 0.473, 0.414, 0.24, 0.231], [0.471, 0.388, 0.257, 0.256, 0.256], [0.478, 0.454, 0.293, 0.259, 0.259], [0.456, 0.402, 0.292, 0.254, 0.253], [0.187, 0.199, 0.532, 0.572, 0.57], [0.488, 0.467, 0.479, 0.415, 0.436], [0.265, 0.271, 0.485, 0.604, 0.599], [0.124, 0.122, 0.56, 0.624, 0.622], [0.067, 0.067, 0.095, 0.541, 0.606], [0.288, 0.212, 0.179, 0.255, 0.255]]
nec_acc_int  =  0.529 +- 0.070, 0.553 +- 0.100, 0.659 +- 0.099, 0.733 +- 0.041, 0.734 +- 0.045

Eval split test
suff_simple class all_L1  =  0.782 +- 0.111, 0.799 +- 0.098, 0.825 +- 0.077, 0.861 +- 0.066, 0.926 +- 0.053
suff_simple class all_KL  =  0.724 +- 0.134, 0.750 +- 0.120, 0.786 +- 0.096, 0.831 +- 0.080, 0.921 +- 0.054
[[0.7439963817596436, 0.7959025502204895, 0.838127851486206, 0.8620672225952148, 0.8878610134124756], [0.8598659038543701, 0.8592405319213867, 0.8602161407470703, 0.9226536154747009, 0.9711461067199707], [0.8829798102378845, 0.8833800554275513, 0.8843055963516235, 0.9183260202407837, 0.977858304977417], [0.8795527219772339, 0.882854700088501, 0.8852811455726624, 0.9104212522506714, 0.9670814871788025], [0.8060085773468018, 0.8044576644897461, 0.805683434009552, 0.8171152472496033, 0.9112304449081421], [0.6377576589584351, 0.6713277697563171, 0.7265359163284302, 0.7768160700798035, 0.7135552167892456], [0.5769962072372437, 0.6122673749923706, 0.6496648192405701, 0.7059985995292664, 0.702445387840271], [0.768436074256897, 0.7705122828483582, 0.7773414254188538, 0.806358814239502, 0.8525345325469971], [0.701295793056488, 0.715679407119751, 0.7386431694030762, 0.7647588849067688, 0.8058174252510071], [0.8835301399230957, 0.8861817121505737, 0.9035671353340149, 0.9263308048248291, 0.9717798829078674]]
[[0.621, 0.672, 0.734, 0.772, 0.823], [0.815, 0.815, 0.816, 0.872, 0.918], [0.88, 0.883, 0.886, 0.919, 0.987], [0.824, 0.862, 0.893, 0.926, 0.994], [0.777, 0.788, 0.801, 0.806, 0.894], [0.546, 0.582, 0.654, 0.735, 0.88], [0.503, 0.549, 0.619, 0.712, 0.872], [0.749, 0.784, 0.814, 0.849, 0.931], [0.623, 0.659, 0.721, 0.767, 0.917], [0.901, 0.902, 0.918, 0.951, 0.993]]
suff_simple_acc_int  =  0.774 +- 0.103, 0.788 +- 0.091, 0.807 +- 0.079, 0.841 +- 0.074, 0.876 +- 0.100
nec class all_L1  =  0.215 +- 0.068, 0.217 +- 0.062, 0.204 +- 0.056, 0.178 +- 0.059, 0.165 +- 0.074
nec class all_KL  =  0.241 +- 0.084, 0.251 +- 0.078, 0.251 +- 0.064, 0.243 +- 0.064, 0.224 +- 0.088
[[0.5843505859375, 0.5697168111801147, 0.5877776741981506, 0.6456624269485474, 0.71632981300354], [0.6730037927627563, 0.6776065826416016, 0.7205823659896851, 0.8013308048248291, 0.8327496647834778], [0.6676005721092224, 0.6704272627830505, 0.7234090566635132, 0.8305233120918274, 0.8819791674613953], [0.635981559753418, 0.6053631901741028, 0.6689263582229614, 0.8245697617530823, 0.8759505748748779], [0.6533920168876648, 0.6522663831710815, 0.6586201786994934, 0.7424454689025879, 0.773739218711853], [0.5643386244773865, 0.54217529296875, 0.5324944853782654, 0.5747198462486267, 0.6179957985877991], [0.5647388696670532, 0.5518811345100403, 0.5406743884086609, 0.5678406953811646, 0.6147688627243042], [0.6309785842895508, 0.6257754564285278, 0.6263508200645447, 0.6981438994407654, 0.7241594791412354], [0.611566960811615, 0.5943565964698792, 0.5890284180641174, 0.6422853469848633, 0.7154542803764343], [0.6378827095031738, 0.7548528909683228, 0.8808785080909729, 0.922753632068634, 0.9073944091796875]]
[[0.257, 0.282, 0.312, 0.333, 0.309], [0.246, 0.241, 0.222, 0.204, 0.15], [0.327, 0.33, 0.302, 0.234, 0.153], [0.362, 0.406, 0.403, 0.28, 0.166], [0.205, 0.213, 0.218, 0.185, 0.152], [0.146, 0.174, 0.202, 0.26, 0.338], [0.124, 0.144, 0.224, 0.302, 0.362], [0.188, 0.196, 0.232, 0.268, 0.263], [0.182, 0.202, 0.216, 0.265, 0.255], [0.376, 0.319, 0.177, 0.097, 0.092]]
nec_acc_int  =  0.622 +- 0.038, 0.624 +- 0.062, 0.653 +- 0.099, 0.725 +- 0.113, 0.766 +- 0.101


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.542 +- 0.024, 0.578 +- 0.042, 0.542 +- 0.044, 0.514 +- 0.034, 0.565 +- 0.022
Faith. Armon (L1)= 		  =  0.438 +- 0.074, 0.490 +- 0.105, 0.402 +- 0.116, 0.299 +- 0.083, 0.265 +- 0.064
Faith. GMean (L1)= 	  =  0.486 +- 0.050, 0.531 +- 0.077, 0.464 +- 0.087, 0.390 +- 0.066, 0.385 +- 0.051
Faith. Aritm (KL)= 		  =  0.543 +- 0.026, 0.591 +- 0.046, 0.580 +- 0.054, 0.541 +- 0.041, 0.602 +- 0.028
Faith. Armon (KL)= 		  =  0.476 +- 0.069, 0.534 +- 0.096, 0.508 +- 0.109, 0.409 +- 0.088, 0.377 +- 0.072
Faith. GMean (KL)= 	  =  0.507 +- 0.047, 0.561 +- 0.073, 0.542 +- 0.084, 0.469 +- 0.067, 0.475 +- 0.054

Eval split val
Faith. Aritm (L1)= 		  =  0.455 +- 0.132, 0.447 +- 0.125, 0.456 +- 0.079, 0.477 +- 0.034, 0.555 +- 0.044
Faith. Armon (L1)= 		  =  0.377 +- 0.151, 0.360 +- 0.142, 0.362 +- 0.104, 0.391 +- 0.062, 0.428 +- 0.082
Faith. GMean (L1)= 	  =  0.413 +- 0.143, 0.399 +- 0.135, 0.404 +- 0.088, 0.430 +- 0.033, 0.483 +- 0.039
Faith. Aritm (KL)= 		  =  0.445 +- 0.157, 0.436 +- 0.151, 0.463 +- 0.093, 0.484 +- 0.025, 0.571 +- 0.045
Faith. Armon (KL)= 		  =  0.398 +- 0.168, 0.383 +- 0.161, 0.395 +- 0.106, 0.410 +- 0.044, 0.460 +- 0.070
Faith. GMean (KL)= 	  =  0.420 +- 0.164, 0.407 +- 0.156, 0.426 +- 0.098, 0.445 +- 0.026, 0.510 +- 0.036

Eval split test
Faith. Aritm (L1)= 		  =  0.498 +- 0.083, 0.508 +- 0.071, 0.515 +- 0.048, 0.519 +- 0.023, 0.546 +- 0.021
Faith. Armon (L1)= 		  =  0.333 +- 0.091, 0.338 +- 0.080, 0.323 +- 0.073, 0.289 +- 0.080, 0.272 +- 0.101
Faith. GMean (L1)= 	  =  0.407 +- 0.088, 0.413 +- 0.076, 0.406 +- 0.061, 0.383 +- 0.061, 0.379 +- 0.077
Faith. Aritm (KL)= 		  =  0.483 +- 0.105, 0.500 +- 0.093, 0.518 +- 0.066, 0.537 +- 0.034, 0.572 +- 0.030
Faith. Armon (KL)= 		  =  0.359 +- 0.108, 0.373 +- 0.097, 0.376 +- 0.077, 0.369 +- 0.079, 0.349 +- 0.111
Faith. GMean (KL)= 	  =  0.416 +- 0.107, 0.431 +- 0.095, 0.441 +- 0.069, 0.442 +- 0.058, 0.443 +- 0.082
Computed for split load_split = id



Completed in  2:48:36.903038  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GL-GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.1

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 22:18:58 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:18:58 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:18:58 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:18:58 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:18:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:18:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:18:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:18:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:18:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:18:58 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:18:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.617
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.703
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.741
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.749
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.747
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.700
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.696
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.695
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.695
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.695
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.589
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.631
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.656
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.671
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.676


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.617022
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.805
SUFF_SIMPLE for r=0.05 class 0.0 = 0.604 +- 0.408 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.408 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 all KL = 0.787 +- 0.408 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 all L1 = 0.823 +- 0.341 (in-sample avg dev_std = 0.213)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.702622
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.808
SUFF_SIMPLE for r=0.1 class 0.0 = 0.607 +- 0.407 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.407 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.1 all KL = 0.788 +- 0.407 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.1 all L1 = 0.825 +- 0.339 (in-sample avg dev_std = 0.224)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.74054
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.8
SUFF_SIMPLE for r=0.2 class 0.0 = 0.598 +- 0.409 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.409 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.2 all KL = 0.787 +- 0.409 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.2 all L1 = 0.821 +- 0.345 (in-sample avg dev_std = 0.185)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7490539999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.799
SUFF_SIMPLE for r=0.4 class 0.0 = 0.6 +- 0.408 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.408 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.4 all KL = 0.788 +- 0.408 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.4 all L1 = 0.821 +- 0.345 (in-sample avg dev_std = 0.165)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.746838
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.93
SUFF_SIMPLE for r=0.8 class 0.0 = 0.842 +- 0.274 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.274 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.912 +- 0.274 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.929 +- 0.224 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6998616
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.746
SUFF_SIMPLE for r=0.05 class 0.0 = 0.564 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.746 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.784 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6956418000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.746
SUFF_SIMPLE for r=0.1 class 0.0 = 0.564 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.746 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.784 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6948674
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.746
SUFF_SIMPLE for r=0.2 class 0.0 = 0.564 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.746 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.784 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6948222
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.746
SUFF_SIMPLE for r=0.4 class 0.0 = 0.564 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.746 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.784 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6948219999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.75
SUFF_SIMPLE for r=0.8 class 0.0 = 0.572 +- 0.432 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.432 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.75 +- 0.432 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.787 +- 0.368 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5890152
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.887
SUFF_SIMPLE for r=0.05 class 0.0 = 0.833 +- 0.302 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.995 +- 0.302 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.05 all KL = 0.895 +- 0.302 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.05 all L1 = 0.913 +- 0.254 (in-sample avg dev_std = 0.122)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6307624
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.886
SUFF_SIMPLE for r=0.1 class 0.0 = 0.83 +- 0.302 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.997 +- 0.302 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.1 all KL = 0.896 +- 0.302 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.1 all L1 = 0.913 +- 0.256 (in-sample avg dev_std = 0.097)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6556327999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.887
SUFF_SIMPLE for r=0.2 class 0.0 = 0.831 +- 0.299 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.299 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.2 all KL = 0.899 +- 0.299 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.255 (in-sample avg dev_std = 0.082)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6706832
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.904
SUFF_SIMPLE for r=0.4 class 0.0 = 0.858 +- 0.276 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.276 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.4 all KL = 0.914 +- 0.276 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.4 all L1 = 0.928 +- 0.234 (in-sample avg dev_std = 0.076)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6757221999999999
len(reference) = 4905
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.973
SUFF_SIMPLE for r=0.8 class 0.0 = 0.978 +- 0.107 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.107 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.987 +- 0.107 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.989 +- 0.093 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.617022
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.618
NEC for r=0.05 class 0.0 = 0.002 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.603 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.39 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.335 +- 0.416 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.702622
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.502
NEC for r=0.1 class 0.0 = 0.002 +- 0.499 (in-sample avg dev_std = 0.091)
NEC for r=0.1 class 1.0 = 0.778 +- 0.499 (in-sample avg dev_std = 0.091)
NEC for r=0.1 all KL = 0.5 +- 0.499 (in-sample avg dev_std = 0.091)
NEC for r=0.1 all L1 = 0.432 +- 0.430 (in-sample avg dev_std = 0.091)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.74054
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.673
NEC for r=0.2 class 0.0 = 0.031 +- 0.461 (in-sample avg dev_std = 0.415)
NEC for r=0.2 class 1.0 = 0.549 +- 0.461 (in-sample avg dev_std = 0.415)
NEC for r=0.2 all KL = 0.433 +- 0.461 (in-sample avg dev_std = 0.415)
NEC for r=0.2 all L1 = 0.318 +- 0.374 (in-sample avg dev_std = 0.415)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7490539999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.829
NEC for r=0.4 class 0.0 = 0.081 +- 0.405 (in-sample avg dev_std = 0.401)
NEC for r=0.4 class 1.0 = 0.265 +- 0.405 (in-sample avg dev_std = 0.401)
NEC for r=0.4 all KL = 0.282 +- 0.405 (in-sample avg dev_std = 0.401)
NEC for r=0.4 all L1 = 0.183 +- 0.297 (in-sample avg dev_std = 0.401)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.746838
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.909
NEC for r=0.8 class 0.0 = 0.172 +- 0.354 (in-sample avg dev_std = 0.392)
NEC for r=0.8 class 1.0 = 0.065 +- 0.354 (in-sample avg dev_std = 0.392)
NEC for r=0.8 all KL = 0.197 +- 0.354 (in-sample avg dev_std = 0.392)
NEC for r=0.8 all L1 = 0.113 +- 0.226 (in-sample avg dev_std = 0.392)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6998616
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.483 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.852 +- 0.483 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.485 +- 0.483 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.43 +- 0.426 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6956418000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.483 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.852 +- 0.483 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.485 +- 0.483 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.43 +- 0.426 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6948674
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.595
NEC for r=0.2 class 0.0 = 0.083 +- 0.454 (in-sample avg dev_std = 0.501)
NEC for r=0.2 class 1.0 = 0.703 +- 0.454 (in-sample avg dev_std = 0.501)
NEC for r=0.2 all KL = 0.518 +- 0.454 (in-sample avg dev_std = 0.501)
NEC for r=0.2 all L1 = 0.396 +- 0.371 (in-sample avg dev_std = 0.501)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6948222
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.792
NEC for r=0.4 class 0.0 = 0.391 +- 0.430 (in-sample avg dev_std = 0.375)
NEC for r=0.4 class 1.0 = 0.023 +- 0.430 (in-sample avg dev_std = 0.375)
NEC for r=0.4 all KL = 0.275 +- 0.430 (in-sample avg dev_std = 0.375)
NEC for r=0.4 all L1 = 0.206 +- 0.334 (in-sample avg dev_std = 0.375)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6948219999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.765
NEC for r=0.8 class 0.0 = 0.422 +- 0.434 (in-sample avg dev_std = 0.216)
NEC for r=0.8 class 1.0 = 0.001 +- 0.434 (in-sample avg dev_std = 0.216)
NEC for r=0.8 all KL = 0.253 +- 0.434 (in-sample avg dev_std = 0.216)
NEC for r=0.8 all L1 = 0.209 +- 0.360 (in-sample avg dev_std = 0.216)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5890152
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.641
NEC for r=0.05 class 0.0 = 0.017 +- 0.480 (in-sample avg dev_std = 0.196)
NEC for r=0.05 class 1.0 = 0.628 +- 0.480 (in-sample avg dev_std = 0.196)
NEC for r=0.05 all KL = 0.376 +- 0.480 (in-sample avg dev_std = 0.196)
NEC for r=0.05 all L1 = 0.319 +- 0.409 (in-sample avg dev_std = 0.196)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6307624
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.699
NEC for r=0.1 class 0.0 = 0.019 +- 0.457 (in-sample avg dev_std = 0.261)
NEC for r=0.1 class 1.0 = 0.544 +- 0.457 (in-sample avg dev_std = 0.261)
NEC for r=0.1 all KL = 0.351 +- 0.457 (in-sample avg dev_std = 0.261)
NEC for r=0.1 all L1 = 0.278 +- 0.381 (in-sample avg dev_std = 0.261)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6556327999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.741
NEC for r=0.2 class 0.0 = 0.02 +- 0.440 (in-sample avg dev_std = 0.271)
NEC for r=0.2 class 1.0 = 0.473 +- 0.440 (in-sample avg dev_std = 0.271)
NEC for r=0.2 all KL = 0.312 +- 0.440 (in-sample avg dev_std = 0.271)
NEC for r=0.2 all L1 = 0.244 +- 0.365 (in-sample avg dev_std = 0.271)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6706832
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.803
NEC for r=0.4 class 0.0 = 0.033 +- 0.411 (in-sample avg dev_std = 0.284)
NEC for r=0.4 class 1.0 = 0.362 +- 0.411 (in-sample avg dev_std = 0.284)
NEC for r=0.4 all KL = 0.261 +- 0.411 (in-sample avg dev_std = 0.284)
NEC for r=0.4 all L1 = 0.195 +- 0.333 (in-sample avg dev_std = 0.284)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6757221999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.865
NEC for r=0.8 class 0.0 = 0.093 +- 0.357 (in-sample avg dev_std = 0.260)
NEC for r=0.8 class 1.0 = 0.166 +- 0.357 (in-sample avg dev_std = 0.260)
NEC for r=0.8 all KL = 0.179 +- 0.357 (in-sample avg dev_std = 0.260)
NEC for r=0.8 all L1 = 0.129 +- 0.280 (in-sample avg dev_std = 0.260)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 22:34:02 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:34:02 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:34:02 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:34:02 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:34:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:34:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:34:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:34:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:34:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:34:02 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:34:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.591
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.671
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.686
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.666
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.645
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.661
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.632
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.614
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.608
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.608
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.589
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.638
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.666
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.676
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.671


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.590782
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.873
SUFF_SIMPLE for r=0.05 class 0.0 = 0.704 +- 0.389 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.989 +- 0.389 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.05 all KL = 0.795 +- 0.389 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.05 all L1 = 0.862 +- 0.277 (in-sample avg dev_std = 0.386)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.67062
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.876
SUFF_SIMPLE for r=0.1 class 0.0 = 0.719 +- 0.382 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.984 +- 0.382 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.1 all KL = 0.797 +- 0.382 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.1 all L1 = 0.866 +- 0.273 (in-sample avg dev_std = 0.370)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.686376
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.864
SUFF_SIMPLE for r=0.2 class 0.0 = 0.703 +- 0.385 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.985 +- 0.385 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.2 all KL = 0.796 +- 0.385 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.2 all L1 = 0.859 +- 0.285 (in-sample avg dev_std = 0.351)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.665924
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.865
SUFF_SIMPLE for r=0.4 class 0.0 = 0.711 +- 0.382 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.984 +- 0.382 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.4 all KL = 0.802 +- 0.382 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.4 all L1 = 0.862 +- 0.285 (in-sample avg dev_std = 0.333)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6453420000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.962
SUFF_SIMPLE for r=0.8 class 0.0 = 0.971 +- 0.194 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.963 +- 0.194 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.96 +- 0.194 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.967 +- 0.164 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6606141999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.748
SUFF_SIMPLE for r=0.05 class 0.0 = 0.559 +- 0.435 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.435 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.05 all KL = 0.746 +- 0.435 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.05 all L1 = 0.781 +- 0.375 (in-sample avg dev_std = 0.080)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.631517
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.748
SUFF_SIMPLE for r=0.1 class 0.0 = 0.559 +- 0.435 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.435 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.1 all KL = 0.746 +- 0.435 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.1 all L1 = 0.781 +- 0.375 (in-sample avg dev_std = 0.071)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.613718
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.747
SUFF_SIMPLE for r=0.2 class 0.0 = 0.559 +- 0.435 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.435 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.2 all KL = 0.746 +- 0.435 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.2 all L1 = 0.781 +- 0.375 (in-sample avg dev_std = 0.056)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6084058
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.747
SUFF_SIMPLE for r=0.4 class 0.0 = 0.559 +- 0.435 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.435 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.4 all KL = 0.746 +- 0.435 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.4 all L1 = 0.781 +- 0.375 (in-sample avg dev_std = 0.048)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6081776
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.898
SUFF_SIMPLE for r=0.8 class 0.0 = 0.862 +- 0.304 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.959 +- 0.304 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.896 +- 0.304 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.911 +- 0.261 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5885536
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.905
SUFF_SIMPLE for r=0.05 class 0.0 = 0.847 +- 0.292 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.997 +- 0.292 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.05 all KL = 0.902 +- 0.292 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.05 all L1 = 0.921 +- 0.241 (in-sample avg dev_std = 0.144)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6379520000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.906
SUFF_SIMPLE for r=0.1 class 0.0 = 0.85 +- 0.289 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.997 +- 0.289 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 all KL = 0.905 +- 0.289 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 all L1 = 0.923 +- 0.241 (in-sample avg dev_std = 0.134)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6657922000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.907
SUFF_SIMPLE for r=0.2 class 0.0 = 0.852 +- 0.286 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.997 +- 0.286 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.2 all KL = 0.907 +- 0.286 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.2 all L1 = 0.924 +- 0.240 (in-sample avg dev_std = 0.115)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6764781999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.931
SUFF_SIMPLE for r=0.4 class 0.0 = 0.901 +- 0.241 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.993 +- 0.241 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.4 all KL = 0.937 +- 0.241 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.4 all L1 = 0.947 +- 0.206 (in-sample avg dev_std = 0.054)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.991
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.67089
len(reference) = 4925
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.985
SUFF_SIMPLE for r=0.8 class 0.0 = 0.99 +- 0.090 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.996 +- 0.090 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.992 +- 0.090 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.993 +- 0.077 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.590782
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.586
NEC for r=0.05 class 0.0 = 0.0 +- 0.492 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.646 +- 0.492 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.414 +- 0.492 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.358 +- 0.426 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.67062
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.485
NEC for r=0.1 class 0.0 = 0.005 +- 0.499 (in-sample avg dev_std = 0.115)
NEC for r=0.1 class 1.0 = 0.804 +- 0.499 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all KL = 0.521 +- 0.499 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all L1 = 0.448 +- 0.430 (in-sample avg dev_std = 0.115)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.686376
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.666
NEC for r=0.2 class 0.0 = 0.061 +- 0.458 (in-sample avg dev_std = 0.451)
NEC for r=0.2 class 1.0 = 0.547 +- 0.458 (in-sample avg dev_std = 0.451)
NEC for r=0.2 all KL = 0.461 +- 0.458 (in-sample avg dev_std = 0.451)
NEC for r=0.2 all L1 = 0.33 +- 0.369 (in-sample avg dev_std = 0.451)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.665924
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.818
NEC for r=0.4 class 0.0 = 0.088 +- 0.414 (in-sample avg dev_std = 0.456)
NEC for r=0.4 class 1.0 = 0.292 +- 0.414 (in-sample avg dev_std = 0.456)
NEC for r=0.4 all KL = 0.326 +- 0.414 (in-sample avg dev_std = 0.456)
NEC for r=0.4 all L1 = 0.201 +- 0.297 (in-sample avg dev_std = 0.456)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6453420000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.898
NEC for r=0.8 class 0.0 = 0.107 +- 0.370 (in-sample avg dev_std = 0.440)
NEC for r=0.8 class 1.0 = 0.146 +- 0.370 (in-sample avg dev_std = 0.440)
NEC for r=0.8 all KL = 0.234 +- 0.370 (in-sample avg dev_std = 0.440)
NEC for r=0.8 all L1 = 0.128 +- 0.231 (in-sample avg dev_std = 0.440)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6606141999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.501
NEC for r=0.05 class 0.0 = 0.011 +- 0.497 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.843 +- 0.497 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.496 +- 0.497 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.43 +- 0.431 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.631517
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.508
NEC for r=0.1 class 0.0 = 0.02 +- 0.497 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.824 +- 0.497 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.49 +- 0.497 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.425 +- 0.431 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.613718
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.607
NEC for r=0.2 class 0.0 = 0.147 +- 0.463 (in-sample avg dev_std = 0.535)
NEC for r=0.2 class 1.0 = 0.636 +- 0.463 (in-sample avg dev_std = 0.535)
NEC for r=0.2 all KL = 0.534 +- 0.463 (in-sample avg dev_std = 0.535)
NEC for r=0.2 all L1 = 0.393 +- 0.371 (in-sample avg dev_std = 0.535)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6084058
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.807
NEC for r=0.4 class 0.0 = 0.361 +- 0.430 (in-sample avg dev_std = 0.534)
NEC for r=0.4 class 1.0 = 0.079 +- 0.430 (in-sample avg dev_std = 0.534)
NEC for r=0.4 all KL = 0.336 +- 0.430 (in-sample avg dev_std = 0.534)
NEC for r=0.4 all L1 = 0.219 +- 0.309 (in-sample avg dev_std = 0.534)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6081776
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.855
NEC for r=0.8 class 0.0 = 0.3 +- 0.417 (in-sample avg dev_std = 0.545)
NEC for r=0.8 class 1.0 = 0.067 +- 0.417 (in-sample avg dev_std = 0.545)
NEC for r=0.8 all KL = 0.308 +- 0.417 (in-sample avg dev_std = 0.545)
NEC for r=0.8 all L1 = 0.182 +- 0.269 (in-sample avg dev_std = 0.545)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5885536
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.585
NEC for r=0.05 class 0.0 = 0.02 +- 0.492 (in-sample avg dev_std = 0.061)
NEC for r=0.05 class 1.0 = 0.711 +- 0.492 (in-sample avg dev_std = 0.061)
NEC for r=0.05 all KL = 0.418 +- 0.492 (in-sample avg dev_std = 0.061)
NEC for r=0.05 all L1 = 0.361 +- 0.425 (in-sample avg dev_std = 0.061)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6379520000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.596
NEC for r=0.1 class 0.0 = 0.03 +- 0.489 (in-sample avg dev_std = 0.240)
NEC for r=0.1 class 1.0 = 0.7 +- 0.489 (in-sample avg dev_std = 0.240)
NEC for r=0.1 all KL = 0.433 +- 0.489 (in-sample avg dev_std = 0.240)
NEC for r=0.1 all L1 = 0.361 +- 0.415 (in-sample avg dev_std = 0.240)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6657922000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.699
NEC for r=0.2 class 0.0 = 0.044 +- 0.459 (in-sample avg dev_std = 0.303)
NEC for r=0.2 class 1.0 = 0.526 +- 0.459 (in-sample avg dev_std = 0.303)
NEC for r=0.2 all KL = 0.361 +- 0.459 (in-sample avg dev_std = 0.303)
NEC for r=0.2 all L1 = 0.282 +- 0.382 (in-sample avg dev_std = 0.303)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6764781999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.791
NEC for r=0.4 class 0.0 = 0.056 +- 0.420 (in-sample avg dev_std = 0.302)
NEC for r=0.4 class 1.0 = 0.354 +- 0.420 (in-sample avg dev_std = 0.302)
NEC for r=0.4 all KL = 0.274 +- 0.420 (in-sample avg dev_std = 0.302)
NEC for r=0.4 all L1 = 0.203 +- 0.339 (in-sample avg dev_std = 0.302)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.67089
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.874
NEC for r=0.8 class 0.0 = 0.089 +- 0.361 (in-sample avg dev_std = 0.312)
NEC for r=0.8 class 1.0 = 0.166 +- 0.361 (in-sample avg dev_std = 0.312)
NEC for r=0.8 all KL = 0.186 +- 0.361 (in-sample avg dev_std = 0.312)
NEC for r=0.8 all L1 = 0.127 +- 0.272 (in-sample avg dev_std = 0.312)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 22:49:24 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:49:24 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:49:24 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:49:24 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:49:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:49:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:49:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:49:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:49:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:49:24 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:49:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.568
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.647
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.663
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.643
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.624
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.625
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.593
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.578
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.575
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.575
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.577
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.632
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.662
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.673
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.667


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5684980000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.848
SUFF_SIMPLE for r=0.05 class 0.0 = 0.663 +- 0.389 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.993 +- 0.389 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.05 all KL = 0.794 +- 0.389 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.05 all L1 = 0.846 +- 0.302 (in-sample avg dev_std = 0.360)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6473920000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.848
SUFF_SIMPLE for r=0.1 class 0.0 = 0.667 +- 0.390 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.989 +- 0.390 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.1 all KL = 0.794 +- 0.390 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.1 all L1 = 0.845 +- 0.303 (in-sample avg dev_std = 0.362)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.662936
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.847
SUFF_SIMPLE for r=0.2 class 0.0 = 0.667 +- 0.387 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.996 +- 0.387 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.2 all KL = 0.805 +- 0.387 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.2 all L1 = 0.849 +- 0.306 (in-sample avg dev_std = 0.331)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6430600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.844
SUFF_SIMPLE for r=0.4 class 0.0 = 0.669 +- 0.384 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.995 +- 0.384 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.4 all KL = 0.81 +- 0.384 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.4 all L1 = 0.85 +- 0.310 (in-sample avg dev_std = 0.299)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.623514
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.944
SUFF_SIMPLE for r=0.8 class 0.0 = 0.933 +- 0.229 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.966 +- 0.229 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.944 +- 0.229 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.951 +- 0.199 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.929
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6247208000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.712
SUFF_SIMPLE for r=0.05 class 0.0 = 0.604 +- 0.415 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.415 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.765 +- 0.415 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.804 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.929
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5931344
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.712
SUFF_SIMPLE for r=0.1 class 0.0 = 0.604 +- 0.415 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.415 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.765 +- 0.415 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.804 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.929
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5782348
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.712
SUFF_SIMPLE for r=0.2 class 0.0 = 0.604 +- 0.415 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.415 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.765 +- 0.415 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.804 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.929
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5748004
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.712
SUFF_SIMPLE for r=0.4 class 0.0 = 0.604 +- 0.415 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.415 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.765 +- 0.415 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.804 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.929
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5746794
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.801
SUFF_SIMPLE for r=0.8 class 0.0 = 0.765 +- 0.340 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.999 +- 0.340 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.859 +- 0.340 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.883 +- 0.286 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5771316
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.901
SUFF_SIMPLE for r=0.05 class 0.0 = 0.839 +- 0.298 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.993 +- 0.298 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.05 all KL = 0.897 +- 0.298 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.05 all L1 = 0.915 +- 0.252 (in-sample avg dev_std = 0.135)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6318604
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.9
SUFF_SIMPLE for r=0.1 class 0.0 = 0.84 +- 0.297 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.992 +- 0.297 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.1 all KL = 0.898 +- 0.297 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.1 all L1 = 0.915 +- 0.252 (in-sample avg dev_std = 0.119)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6624736000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.904
SUFF_SIMPLE for r=0.2 class 0.0 = 0.847 +- 0.292 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.992 +- 0.292 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.2 all KL = 0.903 +- 0.292 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.2 all L1 = 0.919 +- 0.248 (in-sample avg dev_std = 0.110)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6730792
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.929
SUFF_SIMPLE for r=0.4 class 0.0 = 0.893 +- 0.252 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.989 +- 0.252 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.4 all KL = 0.929 +- 0.252 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.4 all L1 = 0.941 +- 0.214 (in-sample avg dev_std = 0.082)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6670904000000001
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.98
SUFF_SIMPLE for r=0.8 class 0.0 = 0.989 +- 0.118 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.986 +- 0.118 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.986 +- 0.118 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.987 +- 0.102 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5684980000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.59
NEC for r=0.05 class 0.0 = 0.001 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.639 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.409 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.354 +- 0.424 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6473920000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.483
NEC for r=0.1 class 0.0 = 0.009 +- 0.495 (in-sample avg dev_std = 0.123)
NEC for r=0.1 class 1.0 = 0.804 +- 0.495 (in-sample avg dev_std = 0.123)
NEC for r=0.1 all KL = 0.523 +- 0.495 (in-sample avg dev_std = 0.123)
NEC for r=0.1 all L1 = 0.45 +- 0.428 (in-sample avg dev_std = 0.123)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.662936
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.664
NEC for r=0.2 class 0.0 = 0.05 +- 0.455 (in-sample avg dev_std = 0.424)
NEC for r=0.2 class 1.0 = 0.55 +- 0.455 (in-sample avg dev_std = 0.424)
NEC for r=0.2 all KL = 0.431 +- 0.455 (in-sample avg dev_std = 0.424)
NEC for r=0.2 all L1 = 0.327 +- 0.374 (in-sample avg dev_std = 0.424)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6430600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.814
NEC for r=0.4 class 0.0 = 0.109 +- 0.404 (in-sample avg dev_std = 0.429)
NEC for r=0.4 class 1.0 = 0.27 +- 0.404 (in-sample avg dev_std = 0.429)
NEC for r=0.4 all KL = 0.287 +- 0.404 (in-sample avg dev_std = 0.429)
NEC for r=0.4 all L1 = 0.199 +- 0.307 (in-sample avg dev_std = 0.429)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.623514
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.876
NEC for r=0.8 class 0.0 = 0.168 +- 0.371 (in-sample avg dev_std = 0.475)
NEC for r=0.8 class 1.0 = 0.143 +- 0.371 (in-sample avg dev_std = 0.475)
NEC for r=0.8 all KL = 0.251 +- 0.371 (in-sample avg dev_std = 0.475)
NEC for r=0.8 all L1 = 0.154 +- 0.252 (in-sample avg dev_std = 0.475)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.929
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6247208000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.471 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.776 +- 0.471 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.432 +- 0.471 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.392 +- 0.413 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.929
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5931344
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.471 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.776 +- 0.471 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.432 +- 0.471 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.392 +- 0.413 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.929
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5782348
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.566
NEC for r=0.2 class 0.0 = 0.097 +- 0.445 (in-sample avg dev_std = 0.450)
NEC for r=0.2 class 1.0 = 0.62 +- 0.445 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all KL = 0.457 +- 0.445 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all L1 = 0.361 +- 0.368 (in-sample avg dev_std = 0.450)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.929
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5748004
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.746
NEC for r=0.4 class 0.0 = 0.359 +- 0.409 (in-sample avg dev_std = 0.370)
NEC for r=0.4 class 1.0 = 0.024 +- 0.409 (in-sample avg dev_std = 0.370)
NEC for r=0.4 all KL = 0.253 +- 0.409 (in-sample avg dev_std = 0.370)
NEC for r=0.4 all L1 = 0.19 +- 0.320 (in-sample avg dev_std = 0.370)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.929
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5746794
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.744
NEC for r=0.8 class 0.0 = 0.367 +- 0.410 (in-sample avg dev_std = 0.322)
NEC for r=0.8 class 1.0 = 0.004 +- 0.410 (in-sample avg dev_std = 0.322)
NEC for r=0.8 all KL = 0.236 +- 0.410 (in-sample avg dev_std = 0.322)
NEC for r=0.8 all L1 = 0.184 +- 0.328 (in-sample avg dev_std = 0.322)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5771316
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.594
NEC for r=0.05 class 0.0 = 0.009 +- 0.488 (in-sample avg dev_std = 0.039)
NEC for r=0.05 class 1.0 = 0.696 +- 0.488 (in-sample avg dev_std = 0.039)
NEC for r=0.05 all KL = 0.402 +- 0.488 (in-sample avg dev_std = 0.039)
NEC for r=0.05 all L1 = 0.348 +- 0.422 (in-sample avg dev_std = 0.039)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6318604
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.598
NEC for r=0.1 class 0.0 = 0.012 +- 0.485 (in-sample avg dev_std = 0.249)
NEC for r=0.1 class 1.0 = 0.712 +- 0.485 (in-sample avg dev_std = 0.249)
NEC for r=0.1 all KL = 0.426 +- 0.485 (in-sample avg dev_std = 0.249)
NEC for r=0.1 all L1 = 0.358 +- 0.413 (in-sample avg dev_std = 0.249)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6624736000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.7
NEC for r=0.2 class 0.0 = 0.013 +- 0.452 (in-sample avg dev_std = 0.299)
NEC for r=0.2 class 1.0 = 0.547 +- 0.452 (in-sample avg dev_std = 0.299)
NEC for r=0.2 all KL = 0.347 +- 0.452 (in-sample avg dev_std = 0.299)
NEC for r=0.2 all L1 = 0.277 +- 0.379 (in-sample avg dev_std = 0.299)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6730792
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.783
NEC for r=0.4 class 0.0 = 0.025 +- 0.413 (in-sample avg dev_std = 0.286)
NEC for r=0.4 class 1.0 = 0.39 +- 0.413 (in-sample avg dev_std = 0.286)
NEC for r=0.4 all KL = 0.264 +- 0.413 (in-sample avg dev_std = 0.286)
NEC for r=0.4 all L1 = 0.205 +- 0.341 (in-sample avg dev_std = 0.286)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.987
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6670904000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.856
NEC for r=0.8 class 0.0 = 0.078 +- 0.367 (in-sample avg dev_std = 0.321)
NEC for r=0.8 class 1.0 = 0.209 +- 0.367 (in-sample avg dev_std = 0.321)
NEC for r=0.8 all KL = 0.196 +- 0.367 (in-sample avg dev_std = 0.321)
NEC for r=0.8 all L1 = 0.143 +- 0.287 (in-sample avg dev_std = 0.321)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 23:04:31 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 11:04:31 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 11:04:31 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 11:04:31 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 11:04:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:04:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:04:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:04:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:04:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:04:31 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 11:04:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.578
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.642
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.656
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.646
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.635
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.538
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.490
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.468
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.463
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.462
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.575
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.622
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.646
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.657
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.659


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5778099999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.834
SUFF_SIMPLE for r=0.05 class 0.0 = 0.749 +- 0.382 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.842 +- 0.382 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.05 all KL = 0.7 +- 0.382 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.05 all L1 = 0.801 +- 0.277 (in-sample avg dev_std = 0.518)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.642428
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.828
SUFF_SIMPLE for r=0.1 class 0.0 = 0.752 +- 0.383 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.837 +- 0.383 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.1 all KL = 0.703 +- 0.383 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.1 all L1 = 0.799 +- 0.285 (in-sample avg dev_std = 0.500)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6555319999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.83
SUFF_SIMPLE for r=0.2 class 0.0 = 0.746 +- 0.391 (in-sample avg dev_std = 0.482)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.852 +- 0.391 (in-sample avg dev_std = 0.482)
SUFF_SIMPLE for r=0.2 all KL = 0.717 +- 0.391 (in-sample avg dev_std = 0.482)
SUFF_SIMPLE for r=0.2 all L1 = 0.805 +- 0.290 (in-sample avg dev_std = 0.482)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.646244
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.815
SUFF_SIMPLE for r=0.4 class 0.0 = 0.761 +- 0.399 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.831 +- 0.399 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.4 all KL = 0.721 +- 0.399 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.4 all L1 = 0.8 +- 0.306 (in-sample avg dev_std = 0.442)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6348959999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.798
SUFF_SIMPLE for r=0.8 class 0.0 = 0.985 +- 0.398 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.683 +- 0.398 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.79 +- 0.398 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.818 +- 0.342 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.537904
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.694
SUFF_SIMPLE for r=0.05 class 0.0 = 0.639 +- 0.409 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.975 +- 0.409 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.05 all KL = 0.747 +- 0.409 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.05 all L1 = 0.808 +- 0.326 (in-sample avg dev_std = 0.240)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4901736
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.692
SUFF_SIMPLE for r=0.1 class 0.0 = 0.635 +- 0.410 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.98 +- 0.410 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.1 all KL = 0.75 +- 0.410 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.1 all L1 = 0.809 +- 0.329 (in-sample avg dev_std = 0.211)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46806099999999995
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.692
SUFF_SIMPLE for r=0.2 class 0.0 = 0.632 +- 0.410 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.987 +- 0.410 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.2 all KL = 0.756 +- 0.410 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.2 all L1 = 0.811 +- 0.331 (in-sample avg dev_std = 0.172)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.46268940000000003
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.689
SUFF_SIMPLE for r=0.4 class 0.0 = 0.629 +- 0.411 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.993 +- 0.411 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.4 all KL = 0.76 +- 0.411 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.4 all L1 = 0.812 +- 0.334 (in-sample avg dev_std = 0.101)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.4624746
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.538
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.35 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.648 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.67 +- 0.390 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.979
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5754468
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.898
SUFF_SIMPLE for r=0.05 class 0.0 = 0.842 +- 0.309 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.965 +- 0.309 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.05 all KL = 0.882 +- 0.309 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.05 all L1 = 0.903 +- 0.259 (in-sample avg dev_std = 0.172)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.979
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6217768
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.9
SUFF_SIMPLE for r=0.1 class 0.0 = 0.848 +- 0.304 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.967 +- 0.304 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.1 all KL = 0.887 +- 0.304 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.1 all L1 = 0.906 +- 0.256 (in-sample avg dev_std = 0.156)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.979
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6455696
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.901
SUFF_SIMPLE for r=0.2 class 0.0 = 0.852 +- 0.303 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.963 +- 0.303 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.2 all KL = 0.888 +- 0.303 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.2 all L1 = 0.907 +- 0.255 (in-sample avg dev_std = 0.154)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.979
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6570275999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.92
SUFF_SIMPLE for r=0.4 class 0.0 = 0.906 +- 0.275 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.943 +- 0.275 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.4 all KL = 0.912 +- 0.275 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.4 all L1 = 0.924 +- 0.235 (in-sample avg dev_std = 0.091)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.979
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6593992000000001
len(reference) = 4919
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.959
SUFF_SIMPLE for r=0.8 class 0.0 = 0.984 +- 0.182 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.949 +- 0.182 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.963 +- 0.182 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.967 +- 0.159 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5778099999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.63
NEC for r=0.05 class 0.0 = 0.009 +- 0.475 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.577 +- 0.475 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.369 +- 0.475 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.324 +- 0.411 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.642428
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.512
NEC for r=0.1 class 0.0 = 0.017 +- 0.490 (in-sample avg dev_std = 0.098)
NEC for r=0.1 class 1.0 = 0.761 +- 0.490 (in-sample avg dev_std = 0.098)
NEC for r=0.1 all KL = 0.492 +- 0.490 (in-sample avg dev_std = 0.098)
NEC for r=0.1 all L1 = 0.429 +- 0.422 (in-sample avg dev_std = 0.098)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6555319999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.672
NEC for r=0.2 class 0.0 = 0.039 +- 0.438 (in-sample avg dev_std = 0.429)
NEC for r=0.2 class 1.0 = 0.561 +- 0.438 (in-sample avg dev_std = 0.429)
NEC for r=0.2 all KL = 0.421 +- 0.438 (in-sample avg dev_std = 0.429)
NEC for r=0.2 all L1 = 0.328 +- 0.362 (in-sample avg dev_std = 0.429)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.646244
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.82
NEC for r=0.4 class 0.0 = 0.071 +- 0.377 (in-sample avg dev_std = 0.433)
NEC for r=0.4 class 1.0 = 0.309 +- 0.377 (in-sample avg dev_std = 0.433)
NEC for r=0.4 all KL = 0.286 +- 0.377 (in-sample avg dev_std = 0.433)
NEC for r=0.4 all L1 = 0.203 +- 0.291 (in-sample avg dev_std = 0.433)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6348959999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.891
NEC for r=0.8 class 0.0 = 0.099 +- 0.330 (in-sample avg dev_std = 0.447)
NEC for r=0.8 class 1.0 = 0.177 +- 0.330 (in-sample avg dev_std = 0.447)
NEC for r=0.8 all KL = 0.222 +- 0.330 (in-sample avg dev_std = 0.447)
NEC for r=0.8 all L1 = 0.142 +- 0.229 (in-sample avg dev_std = 0.447)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.537904
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.729 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.393 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.368 +- 0.397 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4901736
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.729 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.393 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.368 +- 0.396 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46806099999999995
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.556
NEC for r=0.2 class 0.0 = 0.055 +- 0.428 (in-sample avg dev_std = 0.430)
NEC for r=0.2 class 1.0 = 0.634 +- 0.428 (in-sample avg dev_std = 0.430)
NEC for r=0.2 all KL = 0.415 +- 0.428 (in-sample avg dev_std = 0.430)
NEC for r=0.2 all L1 = 0.346 +- 0.355 (in-sample avg dev_std = 0.430)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.46268940000000003
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.726
NEC for r=0.4 class 0.0 = 0.164 +- 0.358 (in-sample avg dev_std = 0.603)
NEC for r=0.4 class 1.0 = 0.288 +- 0.358 (in-sample avg dev_std = 0.603)
NEC for r=0.4 all KL = 0.356 +- 0.358 (in-sample avg dev_std = 0.603)
NEC for r=0.4 all L1 = 0.227 +- 0.229 (in-sample avg dev_std = 0.603)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.4624746
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.706
NEC for r=0.8 class 0.0 = 0.093 +- 0.373 (in-sample avg dev_std = 0.608)
NEC for r=0.8 class 1.0 = 0.398 +- 0.373 (in-sample avg dev_std = 0.608)
NEC for r=0.8 all KL = 0.364 +- 0.373 (in-sample avg dev_std = 0.608)
NEC for r=0.8 all L1 = 0.247 +- 0.252 (in-sample avg dev_std = 0.608)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.979
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5754468
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.629
NEC for r=0.05 class 0.0 = 0.018 +- 0.472 (in-sample avg dev_std = 0.165)
NEC for r=0.05 class 1.0 = 0.645 +- 0.472 (in-sample avg dev_std = 0.165)
NEC for r=0.05 all KL = 0.376 +- 0.472 (in-sample avg dev_std = 0.165)
NEC for r=0.05 all L1 = 0.328 +- 0.405 (in-sample avg dev_std = 0.165)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.979
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6217768
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.644
NEC for r=0.1 class 0.0 = 0.021 +- 0.463 (in-sample avg dev_std = 0.194)
NEC for r=0.1 class 1.0 = 0.624 +- 0.463 (in-sample avg dev_std = 0.194)
NEC for r=0.1 all KL = 0.371 +- 0.463 (in-sample avg dev_std = 0.194)
NEC for r=0.1 all L1 = 0.319 +- 0.398 (in-sample avg dev_std = 0.194)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.979
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6455696
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.705
NEC for r=0.2 class 0.0 = 0.025 +- 0.440 (in-sample avg dev_std = 0.294)
NEC for r=0.2 class 1.0 = 0.531 +- 0.440 (in-sample avg dev_std = 0.294)
NEC for r=0.2 all KL = 0.333 +- 0.440 (in-sample avg dev_std = 0.294)
NEC for r=0.2 all L1 = 0.275 +- 0.371 (in-sample avg dev_std = 0.294)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.979
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6570275999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.787
NEC for r=0.4 class 0.0 = 0.035 +- 0.398 (in-sample avg dev_std = 0.300)
NEC for r=0.4 class 1.0 = 0.378 +- 0.398 (in-sample avg dev_std = 0.300)
NEC for r=0.4 all KL = 0.257 +- 0.398 (in-sample avg dev_std = 0.300)
NEC for r=0.4 all L1 = 0.204 +- 0.331 (in-sample avg dev_std = 0.300)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.979
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6593992000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.857
NEC for r=0.8 class 0.0 = 0.081 +- 0.355 (in-sample avg dev_std = 0.321)
NEC for r=0.8 class 1.0 = 0.214 +- 0.355 (in-sample avg dev_std = 0.321)
NEC for r=0.8 all KL = 0.195 +- 0.355 (in-sample avg dev_std = 0.321)
NEC for r=0.8 all L1 = 0.147 +- 0.282 (in-sample avg dev_std = 0.321)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 23:19:38 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 11:19:38 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 11:19:38 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 11:19:38 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 11:19:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:19:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:19:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:19:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:19:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:19:38 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 11:19:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.606
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.698
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.738
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.747
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.745
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.686
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.678
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.676
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.676
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.676
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.588
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.636
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.665
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.683
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.688


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.605934
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.838
SUFF_SIMPLE for r=0.05 class 0.0 = 0.647 +- 0.397 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.397 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.05 all KL = 0.795 +- 0.397 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.05 all L1 = 0.843 +- 0.312 (in-sample avg dev_std = 0.312)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6984199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.837
SUFF_SIMPLE for r=0.1 class 0.0 = 0.648 +- 0.396 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.396 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.1 all KL = 0.798 +- 0.396 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.1 all L1 = 0.843 +- 0.314 (in-sample avg dev_std = 0.304)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.737992
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.834
SUFF_SIMPLE for r=0.2 class 0.0 = 0.647 +- 0.395 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.395 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.2 all KL = 0.8 +- 0.395 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.2 all L1 = 0.842 +- 0.318 (in-sample avg dev_std = 0.284)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.746616
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.831
SUFF_SIMPLE for r=0.4 class 0.0 = 0.643 +- 0.395 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.395 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.4 all KL = 0.8 +- 0.395 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.4 all L1 = 0.841 +- 0.320 (in-sample avg dev_std = 0.258)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.74456
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.962
SUFF_SIMPLE for r=0.8 class 0.0 = 0.916 +- 0.204 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.204 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.954 +- 0.204 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.962 +- 0.168 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6862308
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.722
SUFF_SIMPLE for r=0.05 class 0.0 = 0.59 +- 0.431 (in-sample avg dev_std = 0.029)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.431 (in-sample avg dev_std = 0.029)
SUFF_SIMPLE for r=0.05 all KL = 0.749 +- 0.431 (in-sample avg dev_std = 0.029)
SUFF_SIMPLE for r=0.05 all L1 = 0.797 +- 0.354 (in-sample avg dev_std = 0.029)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.678315
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.721
SUFF_SIMPLE for r=0.1 class 0.0 = 0.59 +- 0.431 (in-sample avg dev_std = 0.018)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.431 (in-sample avg dev_std = 0.018)
SUFF_SIMPLE for r=0.1 all KL = 0.749 +- 0.431 (in-sample avg dev_std = 0.018)
SUFF_SIMPLE for r=0.1 all L1 = 0.797 +- 0.354 (in-sample avg dev_std = 0.018)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6761617999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.721
SUFF_SIMPLE for r=0.2 class 0.0 = 0.59 +- 0.431 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.431 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.2 all KL = 0.749 +- 0.431 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.2 all L1 = 0.797 +- 0.354 (in-sample avg dev_std = 0.016)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6759417999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.721
SUFF_SIMPLE for r=0.4 class 0.0 = 0.59 +- 0.431 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.431 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.749 +- 0.431 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.797 +- 0.354 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6759394
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.805
SUFF_SIMPLE for r=0.8 class 0.0 = 0.737 +- 0.365 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.365 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.836 +- 0.365 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.87 +- 0.297 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5882718000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.895
SUFF_SIMPLE for r=0.05 class 0.0 = 0.836 +- 0.297 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.297 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.05 all KL = 0.9 +- 0.297 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.05 all L1 = 0.917 +- 0.249 (in-sample avg dev_std = 0.127)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6363555999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.893
SUFF_SIMPLE for r=0.1 class 0.0 = 0.835 +- 0.297 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.297 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.1 all KL = 0.9 +- 0.297 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.1 all L1 = 0.916 +- 0.252 (in-sample avg dev_std = 0.106)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6654072
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.892
SUFF_SIMPLE for r=0.2 class 0.0 = 0.833 +- 0.298 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.298 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.2 all KL = 0.899 +- 0.298 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.2 all L1 = 0.915 +- 0.254 (in-sample avg dev_std = 0.098)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6832090000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.913
SUFF_SIMPLE for r=0.4 class 0.0 = 0.869 +- 0.267 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.267 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.4 all KL = 0.921 +- 0.267 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.4 all L1 = 0.934 +- 0.226 (in-sample avg dev_std = 0.082)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.989
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.687851
len(reference) = 4956
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.979
SUFF_SIMPLE for r=0.8 class 0.0 = 0.982 +- 0.100 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.100 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.989 +- 0.100 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.991 +- 0.086 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.605934
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.594
NEC for r=0.05 class 0.0 = 0.002 +- 0.489 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.637 +- 0.489 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.409 +- 0.489 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.353 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6984199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.49
NEC for r=0.1 class 0.0 = 0.003 +- 0.498 (in-sample avg dev_std = 0.091)
NEC for r=0.1 class 1.0 = 0.797 +- 0.498 (in-sample avg dev_std = 0.091)
NEC for r=0.1 all KL = 0.513 +- 0.498 (in-sample avg dev_std = 0.091)
NEC for r=0.1 all L1 = 0.443 +- 0.430 (in-sample avg dev_std = 0.091)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.737992
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.663
NEC for r=0.2 class 0.0 = 0.035 +- 0.461 (in-sample avg dev_std = 0.449)
NEC for r=0.2 class 1.0 = 0.571 +- 0.461 (in-sample avg dev_std = 0.449)
NEC for r=0.2 all KL = 0.454 +- 0.461 (in-sample avg dev_std = 0.449)
NEC for r=0.2 all L1 = 0.332 +- 0.372 (in-sample avg dev_std = 0.449)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.746616
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.826
NEC for r=0.4 class 0.0 = 0.065 +- 0.405 (in-sample avg dev_std = 0.416)
NEC for r=0.4 class 1.0 = 0.285 +- 0.405 (in-sample avg dev_std = 0.416)
NEC for r=0.4 all KL = 0.288 +- 0.405 (in-sample avg dev_std = 0.416)
NEC for r=0.4 all L1 = 0.187 +- 0.299 (in-sample avg dev_std = 0.416)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.74456
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.907
NEC for r=0.8 class 0.0 = 0.141 +- 0.349 (in-sample avg dev_std = 0.415)
NEC for r=0.8 class 1.0 = 0.099 +- 0.349 (in-sample avg dev_std = 0.415)
NEC for r=0.8 all KL = 0.213 +- 0.349 (in-sample avg dev_std = 0.415)
NEC for r=0.8 all L1 = 0.118 +- 0.220 (in-sample avg dev_std = 0.415)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6862308
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.802 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.44 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.405 +- 0.411 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.678315
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.0 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.802 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.44 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.405 +- 0.411 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6761617999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.569
NEC for r=0.2 class 0.0 = 0.069 +- 0.445 (in-sample avg dev_std = 0.457)
NEC for r=0.2 class 1.0 = 0.668 +- 0.445 (in-sample avg dev_std = 0.457)
NEC for r=0.2 all KL = 0.473 +- 0.445 (in-sample avg dev_std = 0.457)
NEC for r=0.2 all L1 = 0.371 +- 0.363 (in-sample avg dev_std = 0.457)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6759417999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.796
NEC for r=0.4 class 0.0 = 0.289 +- 0.400 (in-sample avg dev_std = 0.497)
NEC for r=0.4 class 1.0 = 0.087 +- 0.400 (in-sample avg dev_std = 0.497)
NEC for r=0.4 all KL = 0.307 +- 0.400 (in-sample avg dev_std = 0.497)
NEC for r=0.4 all L1 = 0.187 +- 0.262 (in-sample avg dev_std = 0.497)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6759394
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.809
NEC for r=0.8 class 0.0 = 0.302 +- 0.404 (in-sample avg dev_std = 0.437)
NEC for r=0.8 class 1.0 = 0.019 +- 0.404 (in-sample avg dev_std = 0.437)
NEC for r=0.8 all KL = 0.249 +- 0.404 (in-sample avg dev_std = 0.437)
NEC for r=0.8 all L1 = 0.16 +- 0.274 (in-sample avg dev_std = 0.437)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5882718000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.632
NEC for r=0.05 class 0.0 = 0.012 +- 0.482 (in-sample avg dev_std = 0.199)
NEC for r=0.05 class 1.0 = 0.646 +- 0.482 (in-sample avg dev_std = 0.199)
NEC for r=0.05 all KL = 0.384 +- 0.482 (in-sample avg dev_std = 0.199)
NEC for r=0.05 all L1 = 0.325 +- 0.410 (in-sample avg dev_std = 0.199)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6363555999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.67
NEC for r=0.1 class 0.0 = 0.014 +- 0.466 (in-sample avg dev_std = 0.210)
NEC for r=0.1 class 1.0 = 0.585 +- 0.466 (in-sample avg dev_std = 0.210)
NEC for r=0.1 all KL = 0.361 +- 0.466 (in-sample avg dev_std = 0.210)
NEC for r=0.1 all L1 = 0.296 +- 0.396 (in-sample avg dev_std = 0.210)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6654072
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.723
NEC for r=0.2 class 0.0 = 0.018 +- 0.452 (in-sample avg dev_std = 0.296)
NEC for r=0.2 class 1.0 = 0.512 +- 0.452 (in-sample avg dev_std = 0.296)
NEC for r=0.2 all KL = 0.333 +- 0.452 (in-sample avg dev_std = 0.296)
NEC for r=0.2 all L1 = 0.262 +- 0.373 (in-sample avg dev_std = 0.296)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6832090000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.785
NEC for r=0.4 class 0.0 = 0.026 +- 0.424 (in-sample avg dev_std = 0.315)
NEC for r=0.4 class 1.0 = 0.407 +- 0.424 (in-sample avg dev_std = 0.315)
NEC for r=0.4 all KL = 0.289 +- 0.424 (in-sample avg dev_std = 0.315)
NEC for r=0.4 all L1 = 0.214 +- 0.342 (in-sample avg dev_std = 0.315)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.687851
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.851
NEC for r=0.8 class 0.0 = 0.082 +- 0.379 (in-sample avg dev_std = 0.320)
NEC for r=0.8 class 1.0 = 0.219 +- 0.379 (in-sample avg dev_std = 0.320)
NEC for r=0.8 all KL = 0.215 +- 0.379 (in-sample avg dev_std = 0.320)
NEC for r=0.8 all L1 = 0.15 +- 0.292 (in-sample avg dev_std = 0.320)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 23:34:39 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 11:34:39 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 11:34:39 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 11:34:39 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 11:34:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:34:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:34:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:34:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:34:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:34:39 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 11:34:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.608
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.665
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.669
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.646
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.626
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.610
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.580
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.567
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.564
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.564
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.592
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.638
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.660
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.665
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.657


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.607754
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.876
SUFF_SIMPLE for r=0.05 class 0.0 = 0.747 +- 0.366 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.947 +- 0.366 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.05 all KL = 0.775 +- 0.366 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.05 all L1 = 0.857 +- 0.260 (in-sample avg dev_std = 0.419)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.665344
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.869
SUFF_SIMPLE for r=0.1 class 0.0 = 0.75 +- 0.372 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.927 +- 0.372 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 all KL = 0.757 +- 0.372 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 all L1 = 0.848 +- 0.263 (in-sample avg dev_std = 0.438)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.668788
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.873
SUFF_SIMPLE for r=0.2 class 0.0 = 0.758 +- 0.363 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.937 +- 0.363 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.2 all KL = 0.774 +- 0.363 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.2 all L1 = 0.857 +- 0.261 (in-sample avg dev_std = 0.402)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.646372
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.865
SUFF_SIMPLE for r=0.4 class 0.0 = 0.79 +- 0.372 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.901 +- 0.372 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.4 all KL = 0.771 +- 0.372 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.4 all L1 = 0.852 +- 0.271 (in-sample avg dev_std = 0.384)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6258859999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.894
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.307 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.835 +- 0.307 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.893 +- 0.307 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.908 +- 0.264 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6103658
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.744
SUFF_SIMPLE for r=0.05 class 0.0 = 0.594 +- 0.432 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.986 +- 0.432 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.05 all KL = 0.733 +- 0.432 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.05 all L1 = 0.791 +- 0.348 (in-sample avg dev_std = 0.253)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.57956
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.741
SUFF_SIMPLE for r=0.1 class 0.0 = 0.591 +- 0.432 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.989 +- 0.432 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.1 all KL = 0.737 +- 0.432 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.1 all L1 = 0.792 +- 0.351 (in-sample avg dev_std = 0.226)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5668784
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.739
SUFF_SIMPLE for r=0.2 class 0.0 = 0.588 +- 0.432 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.991 +- 0.432 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 all KL = 0.738 +- 0.432 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 all L1 = 0.791 +- 0.353 (in-sample avg dev_std = 0.203)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5644142
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.738
SUFF_SIMPLE for r=0.4 class 0.0 = 0.587 +- 0.432 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.994 +- 0.432 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.4 all KL = 0.743 +- 0.432 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.4 all L1 = 0.792 +- 0.355 (in-sample avg dev_std = 0.170)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5643466
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.605
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.454 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.366 +- 0.454 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.647 +- 0.454 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.679 +- 0.404 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.592398
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.906
SUFF_SIMPLE for r=0.05 class 0.0 = 0.851 +- 0.301 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.975 +- 0.301 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.05 all KL = 0.891 +- 0.301 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.05 all L1 = 0.912 +- 0.250 (in-sample avg dev_std = 0.163)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6381454
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.906
SUFF_SIMPLE for r=0.1 class 0.0 = 0.851 +- 0.300 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.976 +- 0.300 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.1 all KL = 0.893 +- 0.300 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.1 all L1 = 0.913 +- 0.251 (in-sample avg dev_std = 0.151)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6601752
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.911
SUFF_SIMPLE for r=0.2 class 0.0 = 0.864 +- 0.294 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.971 +- 0.294 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.2 all KL = 0.898 +- 0.294 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.2 all L1 = 0.917 +- 0.246 (in-sample avg dev_std = 0.144)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6654783999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.932
SUFF_SIMPLE for r=0.4 class 0.0 = 0.916 +- 0.257 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.959 +- 0.257 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.4 all KL = 0.926 +- 0.257 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.4 all L1 = 0.937 +- 0.220 (in-sample avg dev_std = 0.071)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6571288
len(reference) = 4912
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.969
SUFF_SIMPLE for r=0.8 class 0.0 = 0.987 +- 0.160 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.966 +- 0.160 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.973 +- 0.160 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.977 +- 0.138 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.607754
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.608
NEC for r=0.05 class 0.0 = 0.002 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.612 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.393 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.34 +- 0.420 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.665344
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.507
NEC for r=0.1 class 0.0 = 0.005 +- 0.497 (in-sample avg dev_std = 0.096)
NEC for r=0.1 class 1.0 = 0.771 +- 0.497 (in-sample avg dev_std = 0.096)
NEC for r=0.1 all KL = 0.497 +- 0.497 (in-sample avg dev_std = 0.096)
NEC for r=0.1 all L1 = 0.429 +- 0.429 (in-sample avg dev_std = 0.096)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.668788
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.669
NEC for r=0.2 class 0.0 = 0.044 +- 0.457 (in-sample avg dev_std = 0.429)
NEC for r=0.2 class 1.0 = 0.547 +- 0.457 (in-sample avg dev_std = 0.429)
NEC for r=0.2 all KL = 0.433 +- 0.457 (in-sample avg dev_std = 0.429)
NEC for r=0.2 all L1 = 0.323 +- 0.371 (in-sample avg dev_std = 0.429)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.646372
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.824
NEC for r=0.4 class 0.0 = 0.072 +- 0.396 (in-sample avg dev_std = 0.410)
NEC for r=0.4 class 1.0 = 0.281 +- 0.396 (in-sample avg dev_std = 0.410)
NEC for r=0.4 all KL = 0.28 +- 0.396 (in-sample avg dev_std = 0.410)
NEC for r=0.4 all L1 = 0.188 +- 0.299 (in-sample avg dev_std = 0.410)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6258859999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.904
NEC for r=0.8 class 0.0 = 0.099 +- 0.341 (in-sample avg dev_std = 0.421)
NEC for r=0.8 class 1.0 = 0.137 +- 0.341 (in-sample avg dev_std = 0.421)
NEC for r=0.8 all KL = 0.203 +- 0.341 (in-sample avg dev_std = 0.421)
NEC for r=0.8 all L1 = 0.12 +- 0.225 (in-sample avg dev_std = 0.421)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6103658
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.824 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.457 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.415 +- 0.416 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.57956
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.0 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.824 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.457 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.415 +- 0.416 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5668784
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.581
NEC for r=0.2 class 0.0 = 0.09 +- 0.444 (in-sample avg dev_std = 0.481)
NEC for r=0.2 class 1.0 = 0.667 +- 0.444 (in-sample avg dev_std = 0.481)
NEC for r=0.2 all KL = 0.494 +- 0.444 (in-sample avg dev_std = 0.481)
NEC for r=0.2 all L1 = 0.381 +- 0.364 (in-sample avg dev_std = 0.481)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5644142
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.812
NEC for r=0.4 class 0.0 = 0.283 +- 0.396 (in-sample avg dev_std = 0.551)
NEC for r=0.4 class 1.0 = 0.117 +- 0.396 (in-sample avg dev_std = 0.551)
NEC for r=0.4 all KL = 0.333 +- 0.396 (in-sample avg dev_std = 0.551)
NEC for r=0.4 all L1 = 0.199 +- 0.258 (in-sample avg dev_std = 0.551)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5643466
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.849
NEC for r=0.8 class 0.0 = 0.181 +- 0.364 (in-sample avg dev_std = 0.561)
NEC for r=0.8 class 1.0 = 0.162 +- 0.364 (in-sample avg dev_std = 0.561)
NEC for r=0.8 all KL = 0.314 +- 0.364 (in-sample avg dev_std = 0.561)
NEC for r=0.8 all L1 = 0.172 +- 0.209 (in-sample avg dev_std = 0.561)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.592398
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.617
NEC for r=0.05 class 0.0 = 0.011 +- 0.483 (in-sample avg dev_std = 0.159)
NEC for r=0.05 class 1.0 = 0.659 +- 0.483 (in-sample avg dev_std = 0.159)
NEC for r=0.05 all KL = 0.388 +- 0.483 (in-sample avg dev_std = 0.159)
NEC for r=0.05 all L1 = 0.331 +- 0.413 (in-sample avg dev_std = 0.159)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6381454
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.632
NEC for r=0.1 class 0.0 = 0.013 +- 0.477 (in-sample avg dev_std = 0.181)
NEC for r=0.1 class 1.0 = 0.635 +- 0.477 (in-sample avg dev_std = 0.181)
NEC for r=0.1 all KL = 0.38 +- 0.477 (in-sample avg dev_std = 0.181)
NEC for r=0.1 all L1 = 0.32 +- 0.408 (in-sample avg dev_std = 0.181)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6601752
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.708
NEC for r=0.2 class 0.0 = 0.016 +- 0.452 (in-sample avg dev_std = 0.290)
NEC for r=0.2 class 1.0 = 0.523 +- 0.452 (in-sample avg dev_std = 0.290)
NEC for r=0.2 all KL = 0.335 +- 0.452 (in-sample avg dev_std = 0.290)
NEC for r=0.2 all L1 = 0.266 +- 0.375 (in-sample avg dev_std = 0.290)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6654783999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.792
NEC for r=0.4 class 0.0 = 0.025 +- 0.409 (in-sample avg dev_std = 0.282)
NEC for r=0.4 class 1.0 = 0.369 +- 0.409 (in-sample avg dev_std = 0.282)
NEC for r=0.4 all KL = 0.254 +- 0.409 (in-sample avg dev_std = 0.282)
NEC for r=0.4 all L1 = 0.195 +- 0.334 (in-sample avg dev_std = 0.282)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6571288
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.864
NEC for r=0.8 class 0.0 = 0.077 +- 0.362 (in-sample avg dev_std = 0.321)
NEC for r=0.8 class 1.0 = 0.195 +- 0.362 (in-sample avg dev_std = 0.321)
NEC for r=0.8 all KL = 0.19 +- 0.362 (in-sample avg dev_std = 0.321)
NEC for r=0.8 all L1 = 0.135 +- 0.278 (in-sample avg dev_std = 0.321)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 23:50:05 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 11:50:05 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 11:50:05 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 11:50:05 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 11:50:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:50:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:50:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:50:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:50:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:50:05 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 11:50:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.606
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.696
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.729
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.725
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.715
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.706
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.695
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.691
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.691
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.691
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.595
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.640
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.671
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.684
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.682


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6056379999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.844
SUFF_SIMPLE for r=0.05 class 0.0 = 0.859 +- 0.410 (in-sample avg dev_std = 0.580)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.753 +- 0.410 (in-sample avg dev_std = 0.580)
SUFF_SIMPLE for r=0.05 all KL = 0.663 +- 0.410 (in-sample avg dev_std = 0.580)
SUFF_SIMPLE for r=0.05 all L1 = 0.8 +- 0.267 (in-sample avg dev_std = 0.580)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.696192
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.848
SUFF_SIMPLE for r=0.1 class 0.0 = 0.859 +- 0.404 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.786 +- 0.404 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.1 all KL = 0.71 +- 0.404 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.1 all L1 = 0.818 +- 0.278 (in-sample avg dev_std = 0.508)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.729034
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.834
SUFF_SIMPLE for r=0.2 class 0.0 = 0.841 +- 0.409 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.782 +- 0.409 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.2 all KL = 0.699 +- 0.409 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.2 all L1 = 0.809 +- 0.288 (in-sample avg dev_std = 0.499)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7247560000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.795
SUFF_SIMPLE for r=0.4 class 0.0 = 0.89 +- 0.431 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.685 +- 0.431 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.4 all KL = 0.674 +- 0.431 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.4 all L1 = 0.776 +- 0.321 (in-sample avg dev_std = 0.506)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.715498
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.768
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.421 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.637 +- 0.421 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.766 +- 0.421 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.799 +- 0.363 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7063147999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.792
SUFF_SIMPLE for r=0.05 class 0.0 = 0.688 +- 0.416 (in-sample avg dev_std = 0.598)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.818 +- 0.416 (in-sample avg dev_std = 0.598)
SUFF_SIMPLE for r=0.05 all KL = 0.613 +- 0.416 (in-sample avg dev_std = 0.598)
SUFF_SIMPLE for r=0.05 all L1 = 0.753 +- 0.288 (in-sample avg dev_std = 0.598)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6954691999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.787
SUFF_SIMPLE for r=0.1 class 0.0 = 0.689 +- 0.418 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.812 +- 0.418 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.1 all KL = 0.614 +- 0.418 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.1 all L1 = 0.751 +- 0.292 (in-sample avg dev_std = 0.592)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6913632
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.774
SUFF_SIMPLE for r=0.2 class 0.0 = 0.706 +- 0.419 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.764 +- 0.419 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.2 all KL = 0.593 +- 0.419 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.2 all L1 = 0.735 +- 0.294 (in-sample avg dev_std = 0.611)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6907478
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.736
SUFF_SIMPLE for r=0.4 class 0.0 = 0.767 +- 0.425 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.649 +- 0.425 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.4 all KL = 0.579 +- 0.425 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.4 all L1 = 0.708 +- 0.317 (in-sample avg dev_std = 0.600)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.690738
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.641
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.462 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.398 +- 0.462 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.656 +- 0.462 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.695 +- 0.407 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.98
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5945608
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.907
SUFF_SIMPLE for r=0.05 class 0.0 = 0.889 +- 0.336 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.898 +- 0.336 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.05 all KL = 0.848 +- 0.336 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.05 all L1 = 0.894 +- 0.249 (in-sample avg dev_std = 0.321)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.98
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6403356
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.909
SUFF_SIMPLE for r=0.1 class 0.0 = 0.883 +- 0.329 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.329 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.1 all KL = 0.861 +- 0.329 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.1 all L1 = 0.896 +- 0.258 (in-sample avg dev_std = 0.257)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.98
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.670858
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.921
SUFF_SIMPLE for r=0.2 class 0.0 = 0.905 +- 0.304 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.92 +- 0.304 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 all KL = 0.889 +- 0.304 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.2 all L1 = 0.913 +- 0.247 (in-sample avg dev_std = 0.198)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.98
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6837898
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.929
SUFF_SIMPLE for r=0.4 class 0.0 = 0.956 +- 0.279 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.895 +- 0.279 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.4 all KL = 0.911 +- 0.279 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.4 all L1 = 0.926 +- 0.237 (in-sample avg dev_std = 0.097)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.98
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6816638
len(reference) = 4936
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.967
SUFF_SIMPLE for r=0.8 class 0.0 = 0.992 +- 0.181 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.946 +- 0.181 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.965 +- 0.181 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.97 +- 0.157 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6056379999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.526
NEC for r=0.05 class 0.0 = 0.002 +- 0.498 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.74 +- 0.498 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.475 +- 0.498 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.411 +- 0.430 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.696192
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.462
NEC for r=0.1 class 0.0 = 0.003 +- 0.497 (in-sample avg dev_std = 0.087)
NEC for r=0.1 class 1.0 = 0.84 +- 0.497 (in-sample avg dev_std = 0.087)
NEC for r=0.1 all KL = 0.539 +- 0.497 (in-sample avg dev_std = 0.087)
NEC for r=0.1 all L1 = 0.467 +- 0.428 (in-sample avg dev_std = 0.087)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.729034
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.62
NEC for r=0.2 class 0.0 = 0.022 +- 0.468 (in-sample avg dev_std = 0.483)
NEC for r=0.2 class 1.0 = 0.656 +- 0.468 (in-sample avg dev_std = 0.483)
NEC for r=0.2 all KL = 0.497 +- 0.468 (in-sample avg dev_std = 0.483)
NEC for r=0.2 all L1 = 0.373 +- 0.378 (in-sample avg dev_std = 0.483)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7247560000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.76
NEC for r=0.4 class 0.0 = 0.035 +- 0.428 (in-sample avg dev_std = 0.519)
NEC for r=0.4 class 1.0 = 0.444 +- 0.428 (in-sample avg dev_std = 0.519)
NEC for r=0.4 all KL = 0.395 +- 0.428 (in-sample avg dev_std = 0.519)
NEC for r=0.4 all L1 = 0.261 +- 0.322 (in-sample avg dev_std = 0.519)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.715498
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.825
NEC for r=0.8 class 0.0 = 0.038 +- 0.411 (in-sample avg dev_std = 0.528)
NEC for r=0.8 class 1.0 = 0.341 +- 0.411 (in-sample avg dev_std = 0.528)
NEC for r=0.8 all KL = 0.328 +- 0.411 (in-sample avg dev_std = 0.528)
NEC for r=0.8 all L1 = 0.206 +- 0.289 (in-sample avg dev_std = 0.528)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7063147999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.849 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.481 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.428 +- 0.425 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6954691999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.0 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.849 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.481 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.428 +- 0.425 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6913632
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.577
NEC for r=0.2 class 0.0 = 0.063 +- 0.454 (in-sample avg dev_std = 0.492)
NEC for r=0.2 class 1.0 = 0.743 +- 0.454 (in-sample avg dev_std = 0.492)
NEC for r=0.2 all KL = 0.513 +- 0.454 (in-sample avg dev_std = 0.492)
NEC for r=0.2 all L1 = 0.406 +- 0.376 (in-sample avg dev_std = 0.492)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6907478
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.808
NEC for r=0.4 class 0.0 = 0.195 +- 0.385 (in-sample avg dev_std = 0.693)
NEC for r=0.4 class 1.0 = 0.324 +- 0.385 (in-sample avg dev_std = 0.693)
NEC for r=0.4 all KL = 0.447 +- 0.385 (in-sample avg dev_std = 0.693)
NEC for r=0.4 all L1 = 0.26 +- 0.239 (in-sample avg dev_std = 0.693)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.690738
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.83
NEC for r=0.8 class 0.0 = 0.108 +- 0.379 (in-sample avg dev_std = 0.659)
NEC for r=0.8 class 1.0 = 0.356 +- 0.379 (in-sample avg dev_std = 0.659)
NEC for r=0.8 all KL = 0.402 +- 0.379 (in-sample avg dev_std = 0.659)
NEC for r=0.8 all L1 = 0.233 +- 0.235 (in-sample avg dev_std = 0.659)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.98
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5945608
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.555
NEC for r=0.05 class 0.0 = 0.005 +- 0.493 (in-sample avg dev_std = 0.122)
NEC for r=0.05 class 1.0 = 0.75 +- 0.493 (in-sample avg dev_std = 0.122)
NEC for r=0.05 all KL = 0.434 +- 0.493 (in-sample avg dev_std = 0.122)
NEC for r=0.05 all L1 = 0.373 +- 0.423 (in-sample avg dev_std = 0.122)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.98
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6403356
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.588
NEC for r=0.1 class 0.0 = 0.005 +- 0.485 (in-sample avg dev_std = 0.207)
NEC for r=0.1 class 1.0 = 0.705 +- 0.485 (in-sample avg dev_std = 0.207)
NEC for r=0.1 all KL = 0.417 +- 0.485 (in-sample avg dev_std = 0.207)
NEC for r=0.1 all L1 = 0.351 +- 0.414 (in-sample avg dev_std = 0.207)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.98
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.670858
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.688
NEC for r=0.2 class 0.0 = 0.008 +- 0.456 (in-sample avg dev_std = 0.296)
NEC for r=0.2 class 1.0 = 0.548 +- 0.456 (in-sample avg dev_std = 0.296)
NEC for r=0.2 all KL = 0.346 +- 0.456 (in-sample avg dev_std = 0.296)
NEC for r=0.2 all L1 = 0.274 +- 0.379 (in-sample avg dev_std = 0.296)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.98
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6837898
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.781
NEC for r=0.4 class 0.0 = 0.016 +- 0.411 (in-sample avg dev_std = 0.297)
NEC for r=0.4 class 1.0 = 0.381 +- 0.411 (in-sample avg dev_std = 0.297)
NEC for r=0.4 all KL = 0.259 +- 0.411 (in-sample avg dev_std = 0.297)
NEC for r=0.4 all L1 = 0.196 +- 0.333 (in-sample avg dev_std = 0.297)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.98
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6816638
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.858
NEC for r=0.8 class 0.0 = 0.043 +- 0.377 (in-sample avg dev_std = 0.351)
NEC for r=0.8 class 1.0 = 0.251 +- 0.377 (in-sample avg dev_std = 0.351)
NEC for r=0.8 all KL = 0.207 +- 0.377 (in-sample avg dev_std = 0.351)
NEC for r=0.8 all L1 = 0.146 +- 0.286 (in-sample avg dev_std = 0.351)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 00:05:10 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 12:05:10 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 12:05:10 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 12:05:10 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 12:05:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:05:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:05:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:05:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:05:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:05:10 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 12:05:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.573
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.624
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.609
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.566
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.540
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.492
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.417
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.376
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.362
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.361
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.581
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.626
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.650
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.655
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.648


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5729839999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.874
SUFF_SIMPLE for r=0.05 class 0.0 = 0.78 +- 0.356 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.909 +- 0.356 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.05 all KL = 0.775 +- 0.356 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.05 all L1 = 0.852 +- 0.259 (in-sample avg dev_std = 0.445)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6235920000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.876
SUFF_SIMPLE for r=0.1 class 0.0 = 0.784 +- 0.352 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.916 +- 0.352 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.1 all KL = 0.787 +- 0.352 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.1 all L1 = 0.857 +- 0.259 (in-sample avg dev_std = 0.419)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6085740000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.871
SUFF_SIMPLE for r=0.2 class 0.0 = 0.773 +- 0.354 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.925 +- 0.354 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.2 all KL = 0.792 +- 0.354 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.2 all L1 = 0.857 +- 0.266 (in-sample avg dev_std = 0.394)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.56628
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.853
SUFF_SIMPLE for r=0.4 class 0.0 = 0.767 +- 0.367 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.367 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.4 all KL = 0.785 +- 0.367 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.4 all L1 = 0.846 +- 0.285 (in-sample avg dev_std = 0.363)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5399259999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.93
SUFF_SIMPLE for r=0.8 class 0.0 = 0.971 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.908 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.925 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.936 +- 0.223 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.818
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4918258
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.681
SUFF_SIMPLE for r=0.05 class 0.0 = 0.711 +- 0.386 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.943 +- 0.386 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.05 all KL = 0.784 +- 0.386 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.05 all L1 = 0.828 +- 0.318 (in-sample avg dev_std = 0.266)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.818
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4167548
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.679
SUFF_SIMPLE for r=0.1 class 0.0 = 0.706 +- 0.386 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.95 +- 0.386 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 all KL = 0.789 +- 0.386 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 all L1 = 0.829 +- 0.323 (in-sample avg dev_std = 0.218)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.818
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3760186
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.674
SUFF_SIMPLE for r=0.2 class 0.0 = 0.7 +- 0.388 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.957 +- 0.388 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.2 all KL = 0.794 +- 0.388 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.2 all L1 = 0.83 +- 0.329 (in-sample avg dev_std = 0.157)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3623914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.67
SUFF_SIMPLE for r=0.4 class 0.0 = 0.695 +- 0.388 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.962 +- 0.388 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.4 all KL = 0.798 +- 0.388 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.4 all L1 = 0.83 +- 0.333 (in-sample avg dev_std = 0.060)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.818
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.3613786
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.528
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.486 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.71 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.74 +- 0.385 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5808394
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.907
SUFF_SIMPLE for r=0.05 class 0.0 = 0.853 +- 0.291 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.983 +- 0.291 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.05 all KL = 0.9 +- 0.291 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.05 all L1 = 0.917 +- 0.245 (in-sample avg dev_std = 0.151)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6264194
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.906
SUFF_SIMPLE for r=0.1 class 0.0 = 0.855 +- 0.291 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.981 +- 0.291 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all KL = 0.901 +- 0.291 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all L1 = 0.917 +- 0.247 (in-sample avg dev_std = 0.139)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.64957
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.912
SUFF_SIMPLE for r=0.2 class 0.0 = 0.866 +- 0.283 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.979 +- 0.283 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.2 all KL = 0.906 +- 0.283 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.2 all L1 = 0.922 +- 0.240 (in-sample avg dev_std = 0.133)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6553962
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.935
SUFF_SIMPLE for r=0.4 class 0.0 = 0.914 +- 0.244 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.972 +- 0.244 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.4 all KL = 0.933 +- 0.244 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.4 all L1 = 0.943 +- 0.209 (in-sample avg dev_std = 0.075)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6484614
len(reference) = 4957
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.972
SUFF_SIMPLE for r=0.8 class 0.0 = 0.985 +- 0.154 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.971 +- 0.154 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.975 +- 0.154 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.978 +- 0.133 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5729839999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.594
NEC for r=0.05 class 0.0 = 0.01 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.632 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.406 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.354 +- 0.419 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6235920000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.492
NEC for r=0.1 class 0.0 = 0.02 +- 0.492 (in-sample avg dev_std = 0.070)
NEC for r=0.1 class 1.0 = 0.791 +- 0.492 (in-sample avg dev_std = 0.070)
NEC for r=0.1 all KL = 0.51 +- 0.492 (in-sample avg dev_std = 0.070)
NEC for r=0.1 all L1 = 0.447 +- 0.422 (in-sample avg dev_std = 0.070)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6085740000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.639
NEC for r=0.2 class 0.0 = 0.048 +- 0.450 (in-sample avg dev_std = 0.460)
NEC for r=0.2 class 1.0 = 0.615 +- 0.450 (in-sample avg dev_std = 0.460)
NEC for r=0.2 all KL = 0.462 +- 0.450 (in-sample avg dev_std = 0.460)
NEC for r=0.2 all L1 = 0.362 +- 0.369 (in-sample avg dev_std = 0.460)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.56628
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.798
NEC for r=0.4 class 0.0 = 0.067 +- 0.389 (in-sample avg dev_std = 0.486)
NEC for r=0.4 class 1.0 = 0.367 +- 0.389 (in-sample avg dev_std = 0.486)
NEC for r=0.4 all KL = 0.333 +- 0.389 (in-sample avg dev_std = 0.486)
NEC for r=0.4 all L1 = 0.233 +- 0.299 (in-sample avg dev_std = 0.486)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5399259999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.868
NEC for r=0.8 class 0.0 = 0.074 +- 0.358 (in-sample avg dev_std = 0.507)
NEC for r=0.8 class 1.0 = 0.244 +- 0.358 (in-sample avg dev_std = 0.507)
NEC for r=0.8 all KL = 0.268 +- 0.358 (in-sample avg dev_std = 0.507)
NEC for r=0.8 all L1 = 0.169 +- 0.246 (in-sample avg dev_std = 0.507)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.818
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4918258
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.569 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.321 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.287 +- 0.394 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.818
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4167548
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.569 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.321 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.287 +- 0.394 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.818
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3760186
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.542
NEC for r=0.2 class 0.0 = 0.028 +- 0.437 (in-sample avg dev_std = 0.379)
NEC for r=0.2 class 1.0 = 0.527 +- 0.437 (in-sample avg dev_std = 0.379)
NEC for r=0.2 all KL = 0.337 +- 0.437 (in-sample avg dev_std = 0.379)
NEC for r=0.2 all L1 = 0.279 +- 0.363 (in-sample avg dev_std = 0.379)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3623914
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.684
NEC for r=0.4 class 0.0 = 0.087 +- 0.371 (in-sample avg dev_std = 0.577)
NEC for r=0.4 class 1.0 = 0.315 +- 0.371 (in-sample avg dev_std = 0.577)
NEC for r=0.4 all KL = 0.306 +- 0.371 (in-sample avg dev_std = 0.577)
NEC for r=0.4 all L1 = 0.202 +- 0.255 (in-sample avg dev_std = 0.577)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.818
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.3613786
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.653
NEC for r=0.8 class 0.0 = 0.039 +- 0.392 (in-sample avg dev_std = 0.553)
NEC for r=0.8 class 1.0 = 0.387 +- 0.392 (in-sample avg dev_std = 0.553)
NEC for r=0.8 all KL = 0.305 +- 0.392 (in-sample avg dev_std = 0.553)
NEC for r=0.8 all L1 = 0.214 +- 0.287 (in-sample avg dev_std = 0.553)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5808394
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.595
NEC for r=0.05 class 0.0 = 0.019 +- 0.482 (in-sample avg dev_std = 0.043)
NEC for r=0.05 class 1.0 = 0.685 +- 0.482 (in-sample avg dev_std = 0.043)
NEC for r=0.05 all KL = 0.398 +- 0.482 (in-sample avg dev_std = 0.043)
NEC for r=0.05 all L1 = 0.348 +- 0.416 (in-sample avg dev_std = 0.043)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6264194
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.612
NEC for r=0.1 class 0.0 = 0.024 +- 0.475 (in-sample avg dev_std = 0.244)
NEC for r=0.1 class 1.0 = 0.678 +- 0.475 (in-sample avg dev_std = 0.244)
NEC for r=0.1 all KL = 0.407 +- 0.475 (in-sample avg dev_std = 0.244)
NEC for r=0.1 all L1 = 0.347 +- 0.404 (in-sample avg dev_std = 0.244)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.64957
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.712
NEC for r=0.2 class 0.0 = 0.027 +- 0.438 (in-sample avg dev_std = 0.292)
NEC for r=0.2 class 1.0 = 0.516 +- 0.438 (in-sample avg dev_std = 0.292)
NEC for r=0.2 all KL = 0.329 +- 0.438 (in-sample avg dev_std = 0.292)
NEC for r=0.2 all L1 = 0.269 +- 0.368 (in-sample avg dev_std = 0.292)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6553962
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.784
NEC for r=0.4 class 0.0 = 0.037 +- 0.405 (in-sample avg dev_std = 0.284)
NEC for r=0.4 class 1.0 = 0.381 +- 0.405 (in-sample avg dev_std = 0.284)
NEC for r=0.4 all KL = 0.258 +- 0.405 (in-sample avg dev_std = 0.284)
NEC for r=0.4 all L1 = 0.207 +- 0.336 (in-sample avg dev_std = 0.284)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6484614
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.853
NEC for r=0.8 class 0.0 = 0.074 +- 0.366 (in-sample avg dev_std = 0.338)
NEC for r=0.8 class 1.0 = 0.23 +- 0.366 (in-sample avg dev_std = 0.338)
NEC for r=0.8 all KL = 0.203 +- 0.366 (in-sample avg dev_std = 0.338)
NEC for r=0.8 all L1 = 0.151 +- 0.286 (in-sample avg dev_std = 0.338)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 00:20:37 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 12:20:38 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 12:20:38 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 12:20:38 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 12:20:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:20:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:20:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:20:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:20:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:20:38 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 12:20:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.579
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.691
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.747
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.761
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.763
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.725
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.723
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.723
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.723
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.723
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.567
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.619
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.653
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.676
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.695


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5794159999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.85
SUFF_SIMPLE for r=0.05 class 0.0 = 0.699 +- 0.388 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.961 +- 0.388 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.05 all KL = 0.794 +- 0.388 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.05 all L1 = 0.844 +- 0.299 (in-sample avg dev_std = 0.375)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.691082
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.863
SUFF_SIMPLE for r=0.1 class 0.0 = 0.692 +- 0.376 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.995 +- 0.376 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.1 all KL = 0.814 +- 0.376 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.1 all L1 = 0.86 +- 0.291 (in-sample avg dev_std = 0.346)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.746906
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.847
SUFF_SIMPLE for r=0.2 class 0.0 = 0.666 +- 0.382 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.382 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.2 all KL = 0.808 +- 0.382 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.2 all L1 = 0.851 +- 0.304 (in-sample avg dev_std = 0.302)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7613
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.84
SUFF_SIMPLE for r=0.4 class 0.0 = 0.658 +- 0.384 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.384 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.4 all KL = 0.807 +- 0.384 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.4 all L1 = 0.847 +- 0.311 (in-sample avg dev_std = 0.278)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7630060000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.954
SUFF_SIMPLE for r=0.8 class 0.0 = 0.912 +- 0.207 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.207 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.954 +- 0.207 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.961 +- 0.177 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.864
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7245484000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.681
SUFF_SIMPLE for r=0.05 class 0.0 = 0.644 +- 0.403 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.403 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.05 all KL = 0.773 +- 0.403 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.05 all L1 = 0.823 +- 0.330 (in-sample avg dev_std = 0.091)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.864
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7230476
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.681
SUFF_SIMPLE for r=0.1 class 0.0 = 0.643 +- 0.404 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.404 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.1 all KL = 0.773 +- 0.404 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.1 all L1 = 0.823 +- 0.331 (in-sample avg dev_std = 0.077)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.864
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7227928
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.68
SUFF_SIMPLE for r=0.2 class 0.0 = 0.642 +- 0.404 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.404 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.2 all KL = 0.773 +- 0.404 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.2 all L1 = 0.822 +- 0.331 (in-sample avg dev_std = 0.046)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.864
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7227802
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.679
SUFF_SIMPLE for r=0.4 class 0.0 = 0.642 +- 0.404 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.404 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.4 all KL = 0.773 +- 0.404 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.4 all L1 = 0.822 +- 0.332 (in-sample avg dev_std = 0.021)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.864
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7227802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.774
SUFF_SIMPLE for r=0.8 class 0.0 = 0.819 +- 0.305 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.305 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.884 +- 0.305 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.248 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5665304
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.891
SUFF_SIMPLE for r=0.05 class 0.0 = 0.861 +- 0.328 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.926 +- 0.328 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.05 all KL = 0.867 +- 0.328 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.05 all L1 = 0.893 +- 0.265 (in-sample avg dev_std = 0.246)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6188512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.897
SUFF_SIMPLE for r=0.1 class 0.0 = 0.851 +- 0.307 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.964 +- 0.307 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.1 all KL = 0.888 +- 0.307 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.1 all L1 = 0.907 +- 0.255 (in-sample avg dev_std = 0.184)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6533772
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.905
SUFF_SIMPLE for r=0.2 class 0.0 = 0.846 +- 0.285 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.285 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.2 all KL = 0.907 +- 0.285 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.2 all L1 = 0.921 +- 0.242 (in-sample avg dev_std = 0.107)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6760868
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.931
SUFF_SIMPLE for r=0.4 class 0.0 = 0.894 +- 0.237 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.237 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.4 all KL = 0.938 +- 0.237 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.4 all L1 = 0.947 +- 0.204 (in-sample avg dev_std = 0.052)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.991
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6949712
len(reference) = 4958
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.981
SUFF_SIMPLE for r=0.8 class 0.0 = 0.982 +- 0.096 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.096 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.99 +- 0.096 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.991 +- 0.083 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5794159999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.564
NEC for r=0.05 class 0.0 = 0.006 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.679 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.433 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.378 +- 0.425 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.691082
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.478
NEC for r=0.1 class 0.0 = 0.01 +- 0.492 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.815 +- 0.492 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.522 +- 0.492 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.456 +- 0.425 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.746906
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.545
NEC for r=0.2 class 0.0 = 0.024 +- 0.473 (in-sample avg dev_std = 0.460)
NEC for r=0.2 class 1.0 = 0.765 +- 0.473 (in-sample avg dev_std = 0.460)
NEC for r=0.2 all KL = 0.532 +- 0.473 (in-sample avg dev_std = 0.460)
NEC for r=0.2 all L1 = 0.434 +- 0.392 (in-sample avg dev_std = 0.460)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7613
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.728
NEC for r=0.4 class 0.0 = 0.039 +- 0.419 (in-sample avg dev_std = 0.531)
NEC for r=0.4 class 1.0 = 0.5 +- 0.419 (in-sample avg dev_std = 0.531)
NEC for r=0.4 all KL = 0.408 +- 0.419 (in-sample avg dev_std = 0.531)
NEC for r=0.4 all L1 = 0.294 +- 0.332 (in-sample avg dev_std = 0.531)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7630060000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.86
NEC for r=0.8 class 0.0 = 0.099 +- 0.362 (in-sample avg dev_std = 0.485)
NEC for r=0.8 class 1.0 = 0.232 +- 0.362 (in-sample avg dev_std = 0.485)
NEC for r=0.8 all KL = 0.266 +- 0.362 (in-sample avg dev_std = 0.485)
NEC for r=0.8 all L1 = 0.172 +- 0.258 (in-sample avg dev_std = 0.485)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.864
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7245484000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.456 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.704 +- 0.456 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.382 +- 0.456 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.355 +- 0.397 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.864
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7230476
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.0 +- 0.456 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.704 +- 0.456 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.382 +- 0.456 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.355 +- 0.397 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.864
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7227928
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.508
NEC for r=0.2 class 0.0 = 0.005 +- 0.454 (in-sample avg dev_std = 0.217)
NEC for r=0.2 class 1.0 = 0.693 +- 0.454 (in-sample avg dev_std = 0.217)
NEC for r=0.2 all KL = 0.386 +- 0.454 (in-sample avg dev_std = 0.217)
NEC for r=0.2 all L1 = 0.352 +- 0.391 (in-sample avg dev_std = 0.217)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.864
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7227802
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.689
NEC for r=0.4 class 0.0 = 0.131 +- 0.375 (in-sample avg dev_std = 0.620)
NEC for r=0.4 class 1.0 = 0.366 +- 0.375 (in-sample avg dev_std = 0.620)
NEC for r=0.4 all KL = 0.38 +- 0.375 (in-sample avg dev_std = 0.620)
NEC for r=0.4 all L1 = 0.25 +- 0.248 (in-sample avg dev_std = 0.620)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.864
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7227802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.756
NEC for r=0.8 class 0.0 = 0.217 +- 0.351 (in-sample avg dev_std = 0.485)
NEC for r=0.8 class 1.0 = 0.096 +- 0.351 (in-sample avg dev_std = 0.485)
NEC for r=0.8 all KL = 0.258 +- 0.351 (in-sample avg dev_std = 0.485)
NEC for r=0.8 all L1 = 0.156 +- 0.224 (in-sample avg dev_std = 0.485)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5665304
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.615
NEC for r=0.05 class 0.0 = 0.016 +- 0.479 (in-sample avg dev_std = 0.084)
NEC for r=0.05 class 1.0 = 0.664 +- 0.479 (in-sample avg dev_std = 0.084)
NEC for r=0.05 all KL = 0.384 +- 0.479 (in-sample avg dev_std = 0.084)
NEC for r=0.05 all L1 = 0.336 +- 0.415 (in-sample avg dev_std = 0.084)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6188512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.623
NEC for r=0.1 class 0.0 = 0.019 +- 0.476 (in-sample avg dev_std = 0.313)
NEC for r=0.1 class 1.0 = 0.684 +- 0.476 (in-sample avg dev_std = 0.313)
NEC for r=0.1 all KL = 0.412 +- 0.476 (in-sample avg dev_std = 0.313)
NEC for r=0.1 all L1 = 0.347 +- 0.402 (in-sample avg dev_std = 0.313)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6533772
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.654
NEC for r=0.2 class 0.0 = 0.023 +- 0.461 (in-sample avg dev_std = 0.373)
NEC for r=0.2 class 1.0 = 0.654 +- 0.461 (in-sample avg dev_std = 0.373)
NEC for r=0.2 all KL = 0.411 +- 0.461 (in-sample avg dev_std = 0.373)
NEC for r=0.2 all L1 = 0.334 +- 0.385 (in-sample avg dev_std = 0.373)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6760868
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.712
NEC for r=0.4 class 0.0 = 0.028 +- 0.441 (in-sample avg dev_std = 0.437)
NEC for r=0.4 class 1.0 = 0.575 +- 0.441 (in-sample avg dev_std = 0.437)
NEC for r=0.4 all KL = 0.384 +- 0.441 (in-sample avg dev_std = 0.437)
NEC for r=0.4 all L1 = 0.298 +- 0.359 (in-sample avg dev_std = 0.437)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6949712
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.786
NEC for r=0.8 class 0.0 = 0.065 +- 0.403 (in-sample avg dev_std = 0.485)
NEC for r=0.8 class 1.0 = 0.421 +- 0.403 (in-sample avg dev_std = 0.485)
NEC for r=0.8 all KL = 0.339 +- 0.403 (in-sample avg dev_std = 0.485)
NEC for r=0.8 all L1 = 0.241 +- 0.312 (in-sample avg dev_std = 0.485)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 00:36:06 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.588
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.658
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.672
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.658
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.641
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.531
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.453
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.404
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.386
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.384
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.588
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.633
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.660
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.672
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.673


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5881980000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.649
SUFF_SIMPLE for r=0.05 class 0.0 = 0.893 +- 0.466 (in-sample avg dev_std = 0.666)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.393 +- 0.466 (in-sample avg dev_std = 0.666)
SUFF_SIMPLE for r=0.05 all KL = 0.446 +- 0.466 (in-sample avg dev_std = 0.666)
SUFF_SIMPLE for r=0.05 all L1 = 0.616 +- 0.350 (in-sample avg dev_std = 0.666)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6579259999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.691
SUFF_SIMPLE for r=0.1 class 0.0 = 0.895 +- 0.469 (in-sample avg dev_std = 0.657)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.457 +- 0.469 (in-sample avg dev_std = 0.657)
SUFF_SIMPLE for r=0.1 all KL = 0.489 +- 0.469 (in-sample avg dev_std = 0.657)
SUFF_SIMPLE for r=0.1 all L1 = 0.652 +- 0.345 (in-sample avg dev_std = 0.657)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6717
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.654
SUFF_SIMPLE for r=0.2 class 0.0 = 0.884 +- 0.469 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.427 +- 0.469 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.2 all KL = 0.475 +- 0.469 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.2 all L1 = 0.631 +- 0.359 (in-sample avg dev_std = 0.618)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.657956
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.646
SUFF_SIMPLE for r=0.4 class 0.0 = 0.892 +- 0.477 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.447 +- 0.477 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.4 all KL = 0.523 +- 0.477 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.4 all L1 = 0.646 +- 0.378 (in-sample avg dev_std = 0.511)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.641064
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.622
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.399 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.607 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.666 +- 0.413 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5309848
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.555
SUFF_SIMPLE for r=0.05 class 0.0 = 0.917 +- 0.428 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.34 +- 0.428 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.05 all KL = 0.524 +- 0.428 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.05 all L1 = 0.626 +- 0.351 (in-sample avg dev_std = 0.528)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4525552
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.567
SUFF_SIMPLE for r=0.1 class 0.0 = 0.911 +- 0.426 (in-sample avg dev_std = 0.542)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.352 +- 0.426 (in-sample avg dev_std = 0.542)
SUFF_SIMPLE for r=0.1 all KL = 0.524 +- 0.426 (in-sample avg dev_std = 0.542)
SUFF_SIMPLE for r=0.1 all L1 = 0.629 +- 0.347 (in-sample avg dev_std = 0.542)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4042606
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.571
SUFF_SIMPLE for r=0.2 class 0.0 = 0.905 +- 0.428 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.372 +- 0.428 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.2 all KL = 0.537 +- 0.428 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.2 all L1 = 0.637 +- 0.348 (in-sample avg dev_std = 0.528)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3859232
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.574
SUFF_SIMPLE for r=0.4 class 0.0 = 0.915 +- 0.433 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.406 +- 0.433 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.4 all KL = 0.582 +- 0.433 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.4 all L1 = 0.658 +- 0.360 (in-sample avg dev_std = 0.444)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.883
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.3839996
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.498
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.452 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.307 +- 0.452 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.623 +- 0.452 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.65 +- 0.402 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.969
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.587751
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.87
SUFF_SIMPLE for r=0.05 class 0.0 = 0.93 +- 0.376 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.794 +- 0.376 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.05 all KL = 0.806 +- 0.376 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.05 all L1 = 0.863 +- 0.278 (in-sample avg dev_std = 0.369)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.969
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6332434000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.868
SUFF_SIMPLE for r=0.1 class 0.0 = 0.918 +- 0.376 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.796 +- 0.376 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.1 all KL = 0.808 +- 0.376 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.1 all L1 = 0.858 +- 0.291 (in-sample avg dev_std = 0.314)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.969
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6602308
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.877
SUFF_SIMPLE for r=0.2 class 0.0 = 0.916 +- 0.366 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.814 +- 0.366 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 all KL = 0.827 +- 0.366 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 all L1 = 0.866 +- 0.292 (in-sample avg dev_std = 0.233)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.969
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6722484
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.871
SUFF_SIMPLE for r=0.4 class 0.0 = 0.95 +- 0.356 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.787 +- 0.356 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.4 all KL = 0.84 +- 0.356 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.4 all L1 = 0.87 +- 0.296 (in-sample avg dev_std = 0.142)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.969
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6725572
len(reference) = 4961
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.943
SUFF_SIMPLE for r=0.8 class 0.0 = 0.992 +- 0.222 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.222 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.944 +- 0.222 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.951 +- 0.191 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5881980000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.552
NEC for r=0.05 class 0.0 = 0.001 +- 0.497 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.701 +- 0.497 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.449 +- 0.497 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.389 +- 0.429 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6579259999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.48
NEC for r=0.1 class 0.0 = 0.002 +- 0.499 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.812 +- 0.499 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.521 +- 0.499 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.451 +- 0.431 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6717
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.529
NEC for r=0.2 class 0.0 = 0.007 +- 0.492 (in-sample avg dev_std = 0.450)
NEC for r=0.2 class 1.0 = 0.79 +- 0.492 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all KL = 0.547 +- 0.492 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all L1 = 0.441 +- 0.404 (in-sample avg dev_std = 0.450)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.657956
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.659
NEC for r=0.4 class 0.0 = 0.01 +- 0.471 (in-sample avg dev_std = 0.599)
NEC for r=0.4 class 1.0 = 0.646 +- 0.471 (in-sample avg dev_std = 0.599)
NEC for r=0.4 all KL = 0.519 +- 0.471 (in-sample avg dev_std = 0.599)
NEC for r=0.4 all L1 = 0.362 +- 0.356 (in-sample avg dev_std = 0.599)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.641064
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.738
NEC for r=0.8 class 0.0 = 0.049 +- 0.443 (in-sample avg dev_std = 0.667)
NEC for r=0.8 class 1.0 = 0.531 +- 0.443 (in-sample avg dev_std = 0.667)
NEC for r=0.8 all KL = 0.516 +- 0.443 (in-sample avg dev_std = 0.667)
NEC for r=0.8 all L1 = 0.316 +- 0.307 (in-sample avg dev_std = 0.667)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5309848
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.696 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.378 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.351 +- 0.403 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4525552
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.0 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.696 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.378 +- 0.453 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.351 +- 0.403 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4042606
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.503
NEC for r=0.2 class 0.0 = 0.006 +- 0.449 (in-sample avg dev_std = 0.159)
NEC for r=0.2 class 1.0 = 0.697 +- 0.449 (in-sample avg dev_std = 0.159)
NEC for r=0.2 all KL = 0.389 +- 0.449 (in-sample avg dev_std = 0.159)
NEC for r=0.2 all L1 = 0.354 +- 0.398 (in-sample avg dev_std = 0.159)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3859232
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.53
NEC for r=0.4 class 0.0 = 0.018 +- 0.441 (in-sample avg dev_std = 0.355)
NEC for r=0.4 class 1.0 = 0.685 +- 0.441 (in-sample avg dev_std = 0.355)
NEC for r=0.4 all KL = 0.408 +- 0.441 (in-sample avg dev_std = 0.355)
NEC for r=0.4 all L1 = 0.354 +- 0.382 (in-sample avg dev_std = 0.355)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.883
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.3839996
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.538
NEC for r=0.8 class 0.0 = 0.017 +- 0.440 (in-sample avg dev_std = 0.384)
NEC for r=0.8 class 1.0 = 0.681 +- 0.440 (in-sample avg dev_std = 0.384)
NEC for r=0.8 all KL = 0.407 +- 0.440 (in-sample avg dev_std = 0.384)
NEC for r=0.8 all L1 = 0.352 +- 0.379 (in-sample avg dev_std = 0.384)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.969
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.587751
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.575
NEC for r=0.05 class 0.0 = 0.006 +- 0.489 (in-sample avg dev_std = 0.056)
NEC for r=0.05 class 1.0 = 0.717 +- 0.489 (in-sample avg dev_std = 0.056)
NEC for r=0.05 all KL = 0.412 +- 0.489 (in-sample avg dev_std = 0.056)
NEC for r=0.05 all L1 = 0.358 +- 0.422 (in-sample avg dev_std = 0.056)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.969
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6332434000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.57
NEC for r=0.1 class 0.0 = 0.007 +- 0.491 (in-sample avg dev_std = 0.222)
NEC for r=0.1 class 1.0 = 0.731 +- 0.491 (in-sample avg dev_std = 0.222)
NEC for r=0.1 all KL = 0.43 +- 0.491 (in-sample avg dev_std = 0.222)
NEC for r=0.1 all L1 = 0.364 +- 0.416 (in-sample avg dev_std = 0.222)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.969
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6602308
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.613
NEC for r=0.2 class 0.0 = 0.009 +- 0.482 (in-sample avg dev_std = 0.374)
NEC for r=0.2 class 1.0 = 0.684 +- 0.482 (in-sample avg dev_std = 0.374)
NEC for r=0.2 all KL = 0.43 +- 0.482 (in-sample avg dev_std = 0.374)
NEC for r=0.2 all L1 = 0.342 +- 0.396 (in-sample avg dev_std = 0.374)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.969
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6722484
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.682
NEC for r=0.4 class 0.0 = 0.01 +- 0.463 (in-sample avg dev_std = 0.443)
NEC for r=0.4 class 1.0 = 0.581 +- 0.463 (in-sample avg dev_std = 0.443)
NEC for r=0.4 all KL = 0.4 +- 0.463 (in-sample avg dev_std = 0.443)
NEC for r=0.4 all L1 = 0.292 +- 0.362 (in-sample avg dev_std = 0.443)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.969
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6725572
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.762
NEC for r=0.8 class 0.0 = 0.037 +- 0.436 (in-sample avg dev_std = 0.478)
NEC for r=0.8 class 1.0 = 0.446 +- 0.436 (in-sample avg dev_std = 0.478)
NEC for r=0.8 all KL = 0.365 +- 0.436 (in-sample avg dev_std = 0.478)
NEC for r=0.8 all L1 = 0.239 +- 0.321 (in-sample avg dev_std = 0.478)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.787, 0.788, 0.787, 0.788, 0.912], 'all_L1': [0.823, 0.825, 0.821, 0.821, 0.929]}), defaultdict(<class 'list'>, {'all_KL': [0.795, 0.797, 0.796, 0.802, 0.96], 'all_L1': [0.862, 0.866, 0.859, 0.862, 0.967]}), defaultdict(<class 'list'>, {'all_KL': [0.794, 0.794, 0.805, 0.81, 0.944], 'all_L1': [0.846, 0.845, 0.849, 0.85, 0.951]}), defaultdict(<class 'list'>, {'all_KL': [0.7, 0.703, 0.717, 0.721, 0.79], 'all_L1': [0.801, 0.799, 0.805, 0.8, 0.818]}), defaultdict(<class 'list'>, {'all_KL': [0.795, 0.798, 0.8, 0.8, 0.954], 'all_L1': [0.843, 0.843, 0.842, 0.841, 0.962]}), defaultdict(<class 'list'>, {'all_KL': [0.775, 0.757, 0.774, 0.771, 0.893], 'all_L1': [0.857, 0.848, 0.857, 0.852, 0.908]}), defaultdict(<class 'list'>, {'all_KL': [0.663, 0.71, 0.699, 0.674, 0.766], 'all_L1': [0.8, 0.818, 0.809, 0.776, 0.799]}), defaultdict(<class 'list'>, {'all_KL': [0.775, 0.787, 0.792, 0.785, 0.925], 'all_L1': [0.852, 0.857, 0.857, 0.846, 0.936]}), defaultdict(<class 'list'>, {'all_KL': [0.794, 0.814, 0.808, 0.807, 0.954], 'all_L1': [0.844, 0.86, 0.851, 0.847, 0.961]}), defaultdict(<class 'list'>, {'all_KL': [0.446, 0.489, 0.475, 0.523, 0.607], 'all_L1': [0.616, 0.652, 0.631, 0.646, 0.666]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.39, 0.5, 0.433, 0.282, 0.197], 'all_L1': [0.335, 0.432, 0.318, 0.183, 0.113]}), defaultdict(<class 'list'>, {'all_KL': [0.414, 0.521, 0.461, 0.326, 0.234], 'all_L1': [0.358, 0.448, 0.33, 0.201, 0.128]}), defaultdict(<class 'list'>, {'all_KL': [0.409, 0.523, 0.431, 0.287, 0.251], 'all_L1': [0.354, 0.45, 0.327, 0.199, 0.154]}), defaultdict(<class 'list'>, {'all_KL': [0.369, 0.492, 0.421, 0.286, 0.222], 'all_L1': [0.324, 0.429, 0.328, 0.203, 0.142]}), defaultdict(<class 'list'>, {'all_KL': [0.409, 0.513, 0.454, 0.288, 0.213], 'all_L1': [0.353, 0.443, 0.332, 0.187, 0.118]}), defaultdict(<class 'list'>, {'all_KL': [0.393, 0.497, 0.433, 0.28, 0.203], 'all_L1': [0.34, 0.429, 0.323, 0.188, 0.12]}), defaultdict(<class 'list'>, {'all_KL': [0.475, 0.539, 0.497, 0.395, 0.328], 'all_L1': [0.411, 0.467, 0.373, 0.261, 0.206]}), defaultdict(<class 'list'>, {'all_KL': [0.406, 0.51, 0.462, 0.333, 0.268], 'all_L1': [0.354, 0.447, 0.362, 0.233, 0.169]}), defaultdict(<class 'list'>, {'all_KL': [0.433, 0.522, 0.532, 0.408, 0.266], 'all_L1': [0.378, 0.456, 0.434, 0.294, 0.172]}), defaultdict(<class 'list'>, {'all_KL': [0.449, 0.521, 0.547, 0.519, 0.516], 'all_L1': [0.389, 0.451, 0.441, 0.362, 0.316]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.746, 0.746, 0.746, 0.746, 0.75], 'all_L1': [0.784, 0.784, 0.784, 0.784, 0.787]}), defaultdict(<class 'list'>, {'all_KL': [0.746, 0.746, 0.746, 0.746, 0.896], 'all_L1': [0.781, 0.781, 0.781, 0.781, 0.911]}), defaultdict(<class 'list'>, {'all_KL': [0.765, 0.765, 0.765, 0.765, 0.859], 'all_L1': [0.804, 0.804, 0.804, 0.804, 0.883]}), defaultdict(<class 'list'>, {'all_KL': [0.747, 0.75, 0.756, 0.76, 0.648], 'all_L1': [0.808, 0.809, 0.811, 0.812, 0.67]}), defaultdict(<class 'list'>, {'all_KL': [0.749, 0.749, 0.749, 0.749, 0.836], 'all_L1': [0.797, 0.797, 0.797, 0.797, 0.87]}), defaultdict(<class 'list'>, {'all_KL': [0.733, 0.737, 0.738, 0.743, 0.647], 'all_L1': [0.791, 0.792, 0.791, 0.792, 0.679]}), defaultdict(<class 'list'>, {'all_KL': [0.613, 0.614, 0.593, 0.579, 0.656], 'all_L1': [0.753, 0.751, 0.735, 0.708, 0.695]}), defaultdict(<class 'list'>, {'all_KL': [0.784, 0.789, 0.794, 0.798, 0.71], 'all_L1': [0.828, 0.829, 0.83, 0.83, 0.74]}), defaultdict(<class 'list'>, {'all_KL': [0.773, 0.773, 0.773, 0.773, 0.884], 'all_L1': [0.823, 0.823, 0.822, 0.822, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.524, 0.524, 0.537, 0.582, 0.623], 'all_L1': [0.626, 0.629, 0.637, 0.658, 0.65]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.485, 0.485, 0.518, 0.275, 0.253], 'all_L1': [0.43, 0.43, 0.396, 0.206, 0.209]}), defaultdict(<class 'list'>, {'all_KL': [0.496, 0.49, 0.534, 0.336, 0.308], 'all_L1': [0.43, 0.425, 0.393, 0.219, 0.182]}), defaultdict(<class 'list'>, {'all_KL': [0.432, 0.432, 0.457, 0.253, 0.236], 'all_L1': [0.392, 0.392, 0.361, 0.19, 0.184]}), defaultdict(<class 'list'>, {'all_KL': [0.393, 0.393, 0.415, 0.356, 0.364], 'all_L1': [0.368, 0.368, 0.346, 0.227, 0.247]}), defaultdict(<class 'list'>, {'all_KL': [0.44, 0.44, 0.473, 0.307, 0.249], 'all_L1': [0.405, 0.405, 0.371, 0.187, 0.16]}), defaultdict(<class 'list'>, {'all_KL': [0.457, 0.457, 0.494, 0.333, 0.314], 'all_L1': [0.415, 0.415, 0.381, 0.199, 0.172]}), defaultdict(<class 'list'>, {'all_KL': [0.481, 0.481, 0.513, 0.447, 0.402], 'all_L1': [0.428, 0.428, 0.406, 0.26, 0.233]}), defaultdict(<class 'list'>, {'all_KL': [0.321, 0.321, 0.337, 0.306, 0.305], 'all_L1': [0.287, 0.287, 0.279, 0.202, 0.214]}), defaultdict(<class 'list'>, {'all_KL': [0.382, 0.382, 0.386, 0.38, 0.258], 'all_L1': [0.355, 0.355, 0.352, 0.25, 0.156]}), defaultdict(<class 'list'>, {'all_KL': [0.378, 0.378, 0.389, 0.408, 0.407], 'all_L1': [0.351, 0.351, 0.354, 0.354, 0.352]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.895, 0.896, 0.899, 0.914, 0.987], 'all_L1': [0.913, 0.913, 0.914, 0.928, 0.989]}), defaultdict(<class 'list'>, {'all_KL': [0.902, 0.905, 0.907, 0.937, 0.992], 'all_L1': [0.921, 0.923, 0.924, 0.947, 0.993]}), defaultdict(<class 'list'>, {'all_KL': [0.897, 0.898, 0.903, 0.929, 0.986], 'all_L1': [0.915, 0.915, 0.919, 0.941, 0.987]}), defaultdict(<class 'list'>, {'all_KL': [0.882, 0.887, 0.888, 0.912, 0.963], 'all_L1': [0.903, 0.906, 0.907, 0.924, 0.967]}), defaultdict(<class 'list'>, {'all_KL': [0.9, 0.9, 0.899, 0.921, 0.989], 'all_L1': [0.917, 0.916, 0.915, 0.934, 0.991]}), defaultdict(<class 'list'>, {'all_KL': [0.891, 0.893, 0.898, 0.926, 0.973], 'all_L1': [0.912, 0.913, 0.917, 0.937, 0.977]}), defaultdict(<class 'list'>, {'all_KL': [0.848, 0.861, 0.889, 0.911, 0.965], 'all_L1': [0.894, 0.896, 0.913, 0.926, 0.97]}), defaultdict(<class 'list'>, {'all_KL': [0.9, 0.901, 0.906, 0.933, 0.975], 'all_L1': [0.917, 0.917, 0.922, 0.943, 0.978]}), defaultdict(<class 'list'>, {'all_KL': [0.867, 0.888, 0.907, 0.938, 0.99], 'all_L1': [0.893, 0.907, 0.921, 0.947, 0.991]}), defaultdict(<class 'list'>, {'all_KL': [0.806, 0.808, 0.827, 0.84, 0.944], 'all_L1': [0.863, 0.858, 0.866, 0.87, 0.951]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.376, 0.351, 0.312, 0.261, 0.179], 'all_L1': [0.319, 0.278, 0.244, 0.195, 0.129]}), defaultdict(<class 'list'>, {'all_KL': [0.418, 0.433, 0.361, 0.274, 0.186], 'all_L1': [0.361, 0.361, 0.282, 0.203, 0.127]}), defaultdict(<class 'list'>, {'all_KL': [0.402, 0.426, 0.347, 0.264, 0.196], 'all_L1': [0.348, 0.358, 0.277, 0.205, 0.143]}), defaultdict(<class 'list'>, {'all_KL': [0.376, 0.371, 0.333, 0.257, 0.195], 'all_L1': [0.328, 0.319, 0.275, 0.204, 0.147]}), defaultdict(<class 'list'>, {'all_KL': [0.384, 0.361, 0.333, 0.289, 0.215], 'all_L1': [0.325, 0.296, 0.262, 0.214, 0.15]}), defaultdict(<class 'list'>, {'all_KL': [0.388, 0.38, 0.335, 0.254, 0.19], 'all_L1': [0.331, 0.32, 0.266, 0.195, 0.135]}), defaultdict(<class 'list'>, {'all_KL': [0.434, 0.417, 0.346, 0.259, 0.207], 'all_L1': [0.373, 0.351, 0.274, 0.196, 0.146]}), defaultdict(<class 'list'>, {'all_KL': [0.398, 0.407, 0.329, 0.258, 0.203], 'all_L1': [0.348, 0.347, 0.269, 0.207, 0.151]}), defaultdict(<class 'list'>, {'all_KL': [0.384, 0.412, 0.411, 0.384, 0.339], 'all_L1': [0.336, 0.347, 0.334, 0.298, 0.241]}), defaultdict(<class 'list'>, {'all_KL': [0.412, 0.43, 0.43, 0.4, 0.365], 'all_L1': [0.358, 0.364, 0.342, 0.292, 0.239]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.814 +- 0.069, 0.821 +- 0.060, 0.818 +- 0.065, 0.814 +- 0.061, 0.890 +- 0.094
suff_simple class all_KL  =  0.732 +- 0.105, 0.744 +- 0.092, 0.745 +- 0.097, 0.748 +- 0.086, 0.870 +- 0.109
[[0.8054999709129333, 0.8082500100135803, 0.800000011920929, 0.7994999885559082, 0.9300000071525574], [0.8725000023841858, 0.8755000233650208, 0.8644999861717224, 0.8647500276565552, 0.9620000123977661], [0.8477500081062317, 0.8475000262260437, 0.847000002861023, 0.84375, 0.9440000057220459], [0.8337500095367432, 0.827750027179718, 0.8297500014305115, 0.8149999976158142, 0.7979999780654907], [0.8382499814033508, 0.8372499942779541, 0.8342499732971191, 0.8314999938011169, 0.9620000123977661], [0.8757500052452087, 0.8690000176429749, 0.8727499842643738, 0.8652499914169312, 0.8939999938011169], [0.8442500233650208, 0.8475000262260437, 0.8342499732971191, 0.7954999804496765, 0.7680000066757202], [0.8744999766349792, 0.8762500286102295, 0.8712499737739563, 0.8532500267028809, 0.9300000071525574], [0.8502500057220459, 0.8627499938011169, 0.847000002861023, 0.8397499918937683, 0.9539999961853027], [0.6487500071525574, 0.690750002861023, 0.6537500023841858, 0.6464999914169312, 0.621999979019165]]
[[0.787, 0.788, 0.787, 0.788, 0.912], [0.795, 0.797, 0.796, 0.802, 0.96], [0.794, 0.794, 0.805, 0.81, 0.944], [0.7, 0.703, 0.717, 0.721, 0.79], [0.795, 0.798, 0.8, 0.8, 0.954], [0.775, 0.757, 0.774, 0.771, 0.893], [0.663, 0.71, 0.699, 0.674, 0.766], [0.775, 0.787, 0.792, 0.785, 0.925], [0.794, 0.814, 0.808, 0.807, 0.954], [0.446, 0.489, 0.475, 0.523, 0.607]]
suff_simple_acc_int  =  0.829 +- 0.064, 0.834 +- 0.052, 0.825 +- 0.061, 0.815 +- 0.061, 0.876 +- 0.107
nec class all_L1  =  0.360 +- 0.025, 0.445 +- 0.012, 0.357 +- 0.044, 0.231 +- 0.056, 0.164 +- 0.058
nec class all_KL  =  0.415 +- 0.029, 0.514 +- 0.014, 0.467 +- 0.042, 0.340 +- 0.074, 0.270 +- 0.090
[[0.6179999709129333, 0.5024999976158142, 0.6725000143051147, 0.8287500143051147, 0.9087499976158142], [0.5860000252723694, 0.48475000262260437, 0.6657500267028809, 0.8182500004768372, 0.8977500200271606], [0.5899999737739563, 0.4832499921321869, 0.6635000109672546, 0.8142499923706055, 0.8755000233650208], [0.6299999952316284, 0.5115000009536743, 0.671999990940094, 0.8197500109672546, 0.890500009059906], [0.593999981880188, 0.49000000953674316, 0.6625000238418579, 0.8255000114440918, 0.9067500233650208], [0.6079999804496765, 0.5065000057220459, 0.6694999933242798, 0.8240000009536743, 0.9039999842643738], [0.5260000228881836, 0.4622499942779541, 0.6202499866485596, 0.7602499723434448, 0.824999988079071], [0.593999981880188, 0.49175000190734863, 0.6392499804496765, 0.7982500195503235, 0.8684999942779541], [0.5640000104904175, 0.4779999852180481, 0.5450000166893005, 0.7279999852180481, 0.859749972820282], [0.5519999861717224, 0.47999998927116394, 0.5292500257492065, 0.659250020980835, 0.7382500171661377]]
[[0.39, 0.5, 0.433, 0.282, 0.197], [0.414, 0.521, 0.461, 0.326, 0.234], [0.409, 0.523, 0.431, 0.287, 0.251], [0.369, 0.492, 0.421, 0.286, 0.222], [0.409, 0.513, 0.454, 0.288, 0.213], [0.393, 0.497, 0.433, 0.28, 0.203], [0.475, 0.539, 0.497, 0.395, 0.328], [0.406, 0.51, 0.462, 0.333, 0.268], [0.433, 0.522, 0.532, 0.408, 0.266], [0.449, 0.521, 0.547, 0.519, 0.516]]
nec_acc_int  =  0.586 +- 0.030, 0.489 +- 0.014, 0.634 +- 0.051, 0.788 +- 0.053, 0.867 +- 0.050

Eval split val
suff_simple class all_L1  =  0.780 +- 0.055, 0.780 +- 0.055, 0.779 +- 0.054, 0.779 +- 0.051, 0.780 +- 0.100
suff_simple class all_KL  =  0.718 +- 0.079, 0.719 +- 0.079, 0.720 +- 0.080, 0.724 +- 0.073, 0.751 +- 0.103
[[0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.7504000067710876], [0.7476000189781189, 0.7475000023841858, 0.7469249963760376, 0.746749997138977, 0.8980000019073486], [0.7116000056266785, 0.7116000056266785, 0.7116000056266785, 0.7116000056266785, 0.8011999726295471], [0.6940500140190125, 0.6918249726295471, 0.6915500164031982, 0.6889749765396118, 0.5379999876022339], [0.7216249704360962, 0.7214999794960022, 0.7214750051498413, 0.7214000225067139, 0.8050000071525574], [0.7439000010490417, 0.7413250207901001, 0.7393249869346619, 0.7379999756813049, 0.6046000123023987], [0.7916499972343445, 0.7872750163078308, 0.7738999724388123, 0.7362750172615051, 0.6412000060081482], [0.6814749836921692, 0.6785249710083008, 0.6739749908447266, 0.6699000000953674, 0.527999997138977], [0.6812999844551086, 0.6806750297546387, 0.6796249747276306, 0.6791250109672546, 0.7738000154495239], [0.5550249814987183, 0.5669999718666077, 0.5708000063896179, 0.5738499760627747, 0.49799999594688416]]
[[0.746, 0.746, 0.746, 0.746, 0.75], [0.746, 0.746, 0.746, 0.746, 0.896], [0.765, 0.765, 0.765, 0.765, 0.859], [0.747, 0.75, 0.756, 0.76, 0.648], [0.749, 0.749, 0.749, 0.749, 0.836], [0.733, 0.737, 0.738, 0.743, 0.647], [0.613, 0.614, 0.593, 0.579, 0.656], [0.784, 0.789, 0.794, 0.798, 0.71], [0.773, 0.773, 0.773, 0.773, 0.884], [0.524, 0.524, 0.537, 0.582, 0.623]]
suff_simple_acc_int  =  0.707 +- 0.060, 0.707 +- 0.057, 0.706 +- 0.054, 0.701 +- 0.050, 0.684 +- 0.132
nec class all_L1  =  0.386 +- 0.044, 0.386 +- 0.043, 0.364 +- 0.034, 0.229 +- 0.048, 0.211 +- 0.055
nec class all_KL  =  0.426 +- 0.054, 0.426 +- 0.053, 0.452 +- 0.063, 0.340 +- 0.057, 0.310 +- 0.060
[[0.4959999918937683, 0.4959999918937683, 0.5947750210762024, 0.7916499972343445, 0.7651749849319458], [0.5013999938964844, 0.5076000094413757, 0.6069750189781189, 0.8073750138282776, 0.8550000190734863], [0.4959999918937683, 0.4959999918937683, 0.566100001335144, 0.7457249760627747, 0.7437999844551086], [0.4959999918937683, 0.4959999918937683, 0.5556750297546387, 0.7260500192642212, 0.7055249810218811], [0.4959999918937683, 0.4959999918937683, 0.5691499710083008, 0.7963500022888184, 0.808899998664856], [0.4959999918937683, 0.4959999918937683, 0.5811499953269958, 0.8115000128746033, 0.8488749861717224], [0.4959999918937683, 0.4959999918937683, 0.5771750211715698, 0.8083999752998352, 0.8299499750137329], [0.4959999918937683, 0.4959999918937683, 0.5415999889373779, 0.6838250160217285, 0.6528499722480774], [0.4959999918937683, 0.4959999918937683, 0.5075500011444092, 0.6892499923706055, 0.7555999755859375], [0.4959999918937683, 0.4957999885082245, 0.5029000043869019, 0.5303249955177307, 0.5380749702453613]]
[[0.485, 0.485, 0.518, 0.275, 0.253], [0.496, 0.49, 0.534, 0.336, 0.308], [0.432, 0.432, 0.457, 0.253, 0.236], [0.393, 0.393, 0.415, 0.356, 0.364], [0.44, 0.44, 0.473, 0.307, 0.249], [0.457, 0.457, 0.494, 0.333, 0.314], [0.481, 0.481, 0.513, 0.447, 0.402], [0.321, 0.321, 0.337, 0.306, 0.305], [0.382, 0.382, 0.386, 0.38, 0.258], [0.378, 0.378, 0.389, 0.408, 0.407]]
nec_acc_int  =  0.497 +- 0.002, 0.497 +- 0.003, 0.560 +- 0.033, 0.739 +- 0.084, 0.750 +- 0.093

Eval split test
suff_simple class all_L1  =  0.905 +- 0.017, 0.906 +- 0.018, 0.912 +- 0.016, 0.930 +- 0.021, 0.979 +- 0.013
suff_simple class all_KL  =  0.879 +- 0.029, 0.884 +- 0.028, 0.892 +- 0.023, 0.916 +- 0.027, 0.976 +- 0.015
[[0.8874324560165405, 0.8861817121505737, 0.8873323798179626, 0.9038423299789429, 0.9728848338127136], [0.9051681160926819, 0.9059435725212097, 0.9066189527511597, 0.9307084083557129, 0.9847715497016907], [0.9005153179168701, 0.900140106678009, 0.9039673805236816, 0.9290074110031128, 0.9803568124771118], [0.8982889652252197, 0.8998149037361145, 0.9007404446601868, 0.9200520515441895, 0.9585281610488892], [0.8954873085021973, 0.8933610320091248, 0.8918601274490356, 0.9131228923797607, 0.9786117672920227], [0.9061186909675598, 0.9059686064720154, 0.9109715819358826, 0.9320842623710632, 0.9688518047332764], [0.9070442318916321, 0.909045398235321, 0.9213277697563171, 0.9289073348045349, 0.9667747020721436], [0.9067190289497375, 0.9059935808181763, 0.9117720723152161, 0.9348359107971191, 0.9715553522109985], [0.8909095525741577, 0.8974635004997253, 0.9046677947044373, 0.9306584000587463, 0.9814441204071045], [0.8703472018241882, 0.8679207563400269, 0.8768510818481445, 0.8705973625183105, 0.9429550766944885]]
[[0.895, 0.896, 0.899, 0.914, 0.987], [0.902, 0.905, 0.907, 0.937, 0.992], [0.897, 0.898, 0.903, 0.929, 0.986], [0.882, 0.887, 0.888, 0.912, 0.963], [0.9, 0.9, 0.899, 0.921, 0.989], [0.891, 0.893, 0.898, 0.926, 0.973], [0.848, 0.861, 0.889, 0.911, 0.965], [0.9, 0.901, 0.906, 0.933, 0.975], [0.867, 0.888, 0.907, 0.938, 0.99], [0.806, 0.808, 0.827, 0.84, 0.944]]
suff_simple_acc_int  =  0.897 +- 0.011, 0.897 +- 0.012, 0.902 +- 0.012, 0.919 +- 0.019, 0.971 +- 0.012
nec class all_L1  =  0.343 +- 0.017, 0.334 +- 0.028, 0.283 +- 0.030, 0.221 +- 0.037, 0.161 +- 0.040
nec class all_KL  =  0.397 +- 0.018, 0.399 +- 0.029, 0.354 +- 0.036, 0.290 +- 0.052, 0.228 +- 0.063
[[0.6406343579292297, 0.6992695331573486, 0.74081951379776, 0.8025565147399902, 0.864893913269043], [0.5846007466316223, 0.5963828563690186, 0.6986691951751709, 0.7907244563102722, 0.8739994168281555], [0.594081461429596, 0.5980338454246521, 0.7001951336860657, 0.7825695276260376, 0.855713427066803], [0.6288523077964783, 0.6438863277435303, 0.7051981091499329, 0.7873224020004272, 0.8567640781402588], [0.6317290663719177, 0.6704272627830505, 0.7231088876724243, 0.7850210070610046, 0.8512357473373413], [0.6173204183578491, 0.6322293281555176, 0.7076495885848999, 0.7916750311851501, 0.8641434907913208], [0.555408239364624, 0.5879027247428894, 0.6877626776695251, 0.7811186909675598, 0.8576645851135254], [0.5954822897911072, 0.6123673915863037, 0.7121772766113281, 0.7840204238891602, 0.8528116941452026], [0.6151440739631653, 0.6232239603996277, 0.6540924310684204, 0.7119521498680115, 0.7856714129447937], [0.5747698545455933, 0.5702671408653259, 0.6127426624298096, 0.6819841861724854, 0.7617820501327515]]
[[0.376, 0.351, 0.312, 0.261, 0.179], [0.418, 0.433, 0.361, 0.274, 0.186], [0.402, 0.426, 0.347, 0.264, 0.196], [0.376, 0.371, 0.333, 0.257, 0.195], [0.384, 0.361, 0.333, 0.289, 0.215], [0.388, 0.38, 0.335, 0.254, 0.19], [0.434, 0.417, 0.346, 0.259, 0.207], [0.398, 0.407, 0.329, 0.258, 0.203], [0.384, 0.412, 0.411, 0.384, 0.339], [0.412, 0.43, 0.43, 0.4, 0.365]]
nec_acc_int  =  0.604 +- 0.026, 0.623 +- 0.037, 0.694 +- 0.035, 0.770 +- 0.038, 0.842 +- 0.035


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.587 +- 0.032, 0.633 +- 0.030, 0.587 +- 0.026, 0.523 +- 0.020, 0.527 +- 0.028
Faith. Armon (L1)= 		  =  0.497 +- 0.022, 0.576 +- 0.019, 0.493 +- 0.034, 0.354 +- 0.055, 0.269 +- 0.066
Faith. GMean (L1)= 	  =  0.540 +- 0.024, 0.604 +- 0.024, 0.538 +- 0.027, 0.429 +- 0.036, 0.374 +- 0.042
Faith. Aritm (KL)= 		  =  0.574 +- 0.047, 0.629 +- 0.046, 0.606 +- 0.040, 0.544 +- 0.027, 0.570 +- 0.031
Faith. Armon (KL)= 		  =  0.525 +- 0.033, 0.605 +- 0.037, 0.568 +- 0.034, 0.458 +- 0.046, 0.397 +- 0.067
Faith. GMean (KL)= 	  =  0.548 +- 0.039, 0.617 +- 0.041, 0.587 +- 0.036, 0.499 +- 0.034, 0.474 +- 0.043

Eval split val
Faith. Aritm (L1)= 		  =  0.583 +- 0.034, 0.583 +- 0.034, 0.572 +- 0.027, 0.504 +- 0.015, 0.495 +- 0.037
Faith. Armon (L1)= 		  =  0.514 +- 0.043, 0.514 +- 0.042, 0.494 +- 0.033, 0.350 +- 0.045, 0.325 +- 0.054
Faith. GMean (L1)= 	  =  0.547 +- 0.037, 0.547 +- 0.036, 0.531 +- 0.028, 0.419 +- 0.029, 0.399 +- 0.033
Faith. Aritm (KL)= 		  =  0.572 +- 0.047, 0.573 +- 0.046, 0.586 +- 0.049, 0.532 +- 0.024, 0.530 +- 0.034
Faith. Armon (KL)= 		  =  0.531 +- 0.049, 0.531 +- 0.049, 0.550 +- 0.054, 0.456 +- 0.040, 0.430 +- 0.045
Faith. GMean (KL)= 	  =  0.551 +- 0.046, 0.551 +- 0.046, 0.568 +- 0.050, 0.492 +- 0.028, 0.476 +- 0.029

Eval split test
Faith. Aritm (L1)= 		  =  0.624 +- 0.010, 0.620 +- 0.014, 0.597 +- 0.012, 0.575 +- 0.017, 0.570 +- 0.019
Faith. Armon (L1)= 		  =  0.497 +- 0.017, 0.487 +- 0.030, 0.430 +- 0.032, 0.355 +- 0.046, 0.274 +- 0.057
Faith. GMean (L1)= 	  =  0.557 +- 0.013, 0.550 +- 0.022, 0.507 +- 0.024, 0.451 +- 0.034, 0.394 +- 0.046
Faith. Aritm (KL)= 		  =  0.638 +- 0.014, 0.641 +- 0.016, 0.623 +- 0.014, 0.603 +- 0.022, 0.602 +- 0.029
Faith. Armon (KL)= 		  =  0.547 +- 0.016, 0.549 +- 0.026, 0.505 +- 0.033, 0.438 +- 0.054, 0.365 +- 0.077
Faith. GMean (KL)= 	  =  0.590 +- 0.013, 0.593 +- 0.020, 0.561 +- 0.024, 0.513 +- 0.040, 0.467 +- 0.059
Computed for split load_split = id



Completed in  2:32:35.667432  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN simple_concept2temperature TopoFeature/basis/no_shift NEC_ALPHA 0.1

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 00:51:37 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 12:51:38 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 12:51:38 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 12:51:38 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 12:51:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:51:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:51:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:51:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:51:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:51:38 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 12:51:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 94 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mChartInfo 0.9560 0.9560 0.9560 0.9560 0.9740 0.9740[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.564
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.612
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.582
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.515
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.455
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.459
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.330
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.232
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.174
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.156
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.573
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.621
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.641
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.645
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.640


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5639660000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.518
SUFF_SIMPLE for r=0.05 class 0.0 = 0.665 +- 0.394 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.359 +- 0.394 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.05 all KL = 0.424 +- 0.394 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.05 all L1 = 0.495 +- 0.326 (in-sample avg dev_std = 0.473)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6115419999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.504
SUFF_SIMPLE for r=0.1 class 0.0 = 0.627 +- 0.416 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.402 +- 0.416 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 all KL = 0.439 +- 0.416 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 all L1 = 0.502 +- 0.345 (in-sample avg dev_std = 0.438)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5823539999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.506
SUFF_SIMPLE for r=0.2 class 0.0 = 0.641 +- 0.424 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.405 +- 0.424 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.2 all KL = 0.453 +- 0.424 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.2 all L1 = 0.51 +- 0.356 (in-sample avg dev_std = 0.384)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.514786
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.477
SUFF_SIMPLE for r=0.4 class 0.0 = 0.676 +- 0.437 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.355 +- 0.437 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.4 all KL = 0.455 +- 0.437 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.4 all L1 = 0.498 +- 0.368 (in-sample avg dev_std = 0.243)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.45546
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.52
SUFF_SIMPLE for r=0.8 class 0.0 = 0.835 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.291 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.506 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.534 +- 0.379 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45907420000000004
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.182 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.84 +- 0.182 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.05 all KL = 0.932 +- 0.182 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.05 all L1 = 0.918 +- 0.197 (in-sample avg dev_std = 0.058)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32966680000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.995 +- 0.188 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.839 +- 0.188 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.1 all KL = 0.929 +- 0.188 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.1 all L1 = 0.916 +- 0.198 (in-sample avg dev_std = 0.073)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2324982
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.993 +- 0.194 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.839 +- 0.194 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.2 all KL = 0.926 +- 0.194 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.2 all L1 = 0.916 +- 0.198 (in-sample avg dev_std = 0.083)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1744924
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.494
SUFF_SIMPLE for r=0.4 class 0.0 = 0.989 +- 0.204 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.838 +- 0.204 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.4 all KL = 0.922 +- 0.204 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.4 all L1 = 0.913 +- 0.201 (in-sample avg dev_std = 0.099)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1557414
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.841 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.936 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5730348
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.658
SUFF_SIMPLE for r=0.05 class 0.0 = 0.702 +- 0.399 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.751 +- 0.399 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.05 all KL = 0.692 +- 0.399 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.05 all L1 = 0.727 +- 0.318 (in-sample avg dev_std = 0.335)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6207962
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.665
SUFF_SIMPLE for r=0.1 class 0.0 = 0.703 +- 0.397 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.759 +- 0.397 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 all KL = 0.705 +- 0.397 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 all L1 = 0.731 +- 0.328 (in-sample avg dev_std = 0.269)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.641156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.658
SUFF_SIMPLE for r=0.2 class 0.0 = 0.729 +- 0.399 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.74 +- 0.399 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.2 all KL = 0.717 +- 0.399 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.2 all L1 = 0.734 +- 0.337 (in-sample avg dev_std = 0.173)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6453472
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.645
SUFF_SIMPLE for r=0.4 class 0.0 = 0.729 +- 0.422 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.669 +- 0.422 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.4 all KL = 0.685 +- 0.422 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.4 all L1 = 0.699 +- 0.361 (in-sample avg dev_std = 0.117)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.764
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6398050000000001
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.728
SUFF_SIMPLE for r=0.8 class 0.0 = 0.861 +- 0.285 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.863 +- 0.285 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.8 all KL = 0.875 +- 0.285 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.8 all L1 = 0.862 +- 0.256 (in-sample avg dev_std = 0.004)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5639660000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.532
NEC for r=0.05 class 0.0 = 0.091 +- 0.448 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.734 +- 0.448 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.489 +- 0.448 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.447 +- 0.380 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6115419999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.466
NEC for r=0.1 class 0.0 = 0.098 +- 0.456 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.801 +- 0.456 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.532 +- 0.456 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.487 +- 0.384 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5823539999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.51
NEC for r=0.2 class 0.0 = 0.104 +- 0.443 (in-sample avg dev_std = 0.317)
NEC for r=0.2 class 1.0 = 0.773 +- 0.443 (in-sample avg dev_std = 0.317)
NEC for r=0.2 all KL = 0.525 +- 0.443 (in-sample avg dev_std = 0.317)
NEC for r=0.2 all L1 = 0.475 +- 0.363 (in-sample avg dev_std = 0.317)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.514786
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.616
NEC for r=0.4 class 0.0 = 0.114 +- 0.406 (in-sample avg dev_std = 0.443)
NEC for r=0.4 class 1.0 = 0.658 +- 0.406 (in-sample avg dev_std = 0.443)
NEC for r=0.4 all KL = 0.471 +- 0.406 (in-sample avg dev_std = 0.443)
NEC for r=0.4 all L1 = 0.415 +- 0.323 (in-sample avg dev_std = 0.443)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.45546
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.633
NEC for r=0.8 class 0.0 = 0.214 +- 0.379 (in-sample avg dev_std = 0.519)
NEC for r=0.8 class 1.0 = 0.6 +- 0.379 (in-sample avg dev_std = 0.519)
NEC for r=0.8 all KL = 0.497 +- 0.379 (in-sample avg dev_std = 0.519)
NEC for r=0.8 all L1 = 0.428 +- 0.300 (in-sample avg dev_std = 0.519)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45907420000000004
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.003 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.158 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.063 +- 0.175 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.081 +- 0.196 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.32966680000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.003 +- 0.173 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.158 +- 0.173 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.063 +- 0.173 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.081 +- 0.196 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2324982
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.005 +- 0.172 (in-sample avg dev_std = 0.031)
NEC for r=0.2 class 1.0 = 0.157 +- 0.172 (in-sample avg dev_std = 0.031)
NEC for r=0.2 all KL = 0.064 +- 0.172 (in-sample avg dev_std = 0.031)
NEC for r=0.2 all L1 = 0.082 +- 0.195 (in-sample avg dev_std = 0.031)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1744924
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.506
NEC for r=0.4 class 0.0 = 0.009 +- 0.184 (in-sample avg dev_std = 0.148)
NEC for r=0.4 class 1.0 = 0.169 +- 0.184 (in-sample avg dev_std = 0.148)
NEC for r=0.4 all KL = 0.084 +- 0.184 (in-sample avg dev_std = 0.148)
NEC for r=0.4 all L1 = 0.089 +- 0.191 (in-sample avg dev_std = 0.148)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1557414
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.499
NEC for r=0.8 class 0.0 = 0.003 +- 0.175 (in-sample avg dev_std = 0.079)
NEC for r=0.8 class 1.0 = 0.16 +- 0.175 (in-sample avg dev_std = 0.079)
NEC for r=0.8 all KL = 0.066 +- 0.175 (in-sample avg dev_std = 0.079)
NEC for r=0.8 all L1 = 0.082 +- 0.195 (in-sample avg dev_std = 0.079)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5730348
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.55
NEC for r=0.05 class 0.0 = 0.33 +- 0.443 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.688 +- 0.443 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.557 +- 0.443 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.507 +- 0.385 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6207962
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.538
NEC for r=0.1 class 0.0 = 0.334 +- 0.439 (in-sample avg dev_std = 0.139)
NEC for r=0.1 class 1.0 = 0.704 +- 0.439 (in-sample avg dev_std = 0.139)
NEC for r=0.1 all KL = 0.572 +- 0.439 (in-sample avg dev_std = 0.139)
NEC for r=0.1 all L1 = 0.517 +- 0.380 (in-sample avg dev_std = 0.139)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.641156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.548
NEC for r=0.2 class 0.0 = 0.306 +- 0.419 (in-sample avg dev_std = 0.373)
NEC for r=0.2 class 1.0 = 0.671 +- 0.419 (in-sample avg dev_std = 0.373)
NEC for r=0.2 all KL = 0.546 +- 0.419 (in-sample avg dev_std = 0.373)
NEC for r=0.2 all L1 = 0.486 +- 0.356 (in-sample avg dev_std = 0.373)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6453472
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.602
NEC for r=0.4 class 0.0 = 0.264 +- 0.394 (in-sample avg dev_std = 0.444)
NEC for r=0.4 class 1.0 = 0.536 +- 0.394 (in-sample avg dev_std = 0.444)
NEC for r=0.4 all KL = 0.45 +- 0.394 (in-sample avg dev_std = 0.444)
NEC for r=0.4 all L1 = 0.399 +- 0.324 (in-sample avg dev_std = 0.444)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6398050000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.663
NEC for r=0.8 class 0.0 = 0.267 +- 0.361 (in-sample avg dev_std = 0.440)
NEC for r=0.8 class 1.0 = 0.386 +- 0.361 (in-sample avg dev_std = 0.440)
NEC for r=0.8 all KL = 0.377 +- 0.361 (in-sample avg dev_std = 0.440)
NEC for r=0.8 all L1 = 0.326 +- 0.288 (in-sample avg dev_std = 0.440)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 01:06:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 01:06:30 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 01:06:30 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 01:06:30 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 01:06:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:06:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:06:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:06:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:06:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:06:30 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 01:06:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mChartInfo 0.9600 0.9600 0.9600 0.9600 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.524
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.564
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.554
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.515
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.480
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.398
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.297
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.232
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.200
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.193
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.565
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.604
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.624
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.632
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.636


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5240820000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.802 +- 0.428 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.208 +- 0.428 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.05 all KL = 0.383 +- 0.428 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.05 all L1 = 0.473 +- 0.343 (in-sample avg dev_std = 0.463)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5642619999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.506
SUFF_SIMPLE for r=0.1 class 0.0 = 0.819 +- 0.434 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.214 +- 0.434 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.1 all KL = 0.396 +- 0.434 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.1 all L1 = 0.484 +- 0.350 (in-sample avg dev_std = 0.457)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5535039999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.829 +- 0.438 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.199 +- 0.438 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.2 all KL = 0.398 +- 0.438 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.2 all L1 = 0.48 +- 0.356 (in-sample avg dev_std = 0.413)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5145619999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.484
SUFF_SIMPLE for r=0.4 class 0.0 = 0.861 +- 0.453 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.186 +- 0.453 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.4 all KL = 0.424 +- 0.453 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.4 all L1 = 0.487 +- 0.373 (in-sample avg dev_std = 0.304)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47984000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.572
SUFF_SIMPLE for r=0.8 class 0.0 = 0.854 +- 0.459 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.356 +- 0.459 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.537 +- 0.459 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.578 +- 0.391 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3980822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
SUFF_SIMPLE for r=0.05 class 0.0 = 0.994 +- 0.242 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.807 +- 0.242 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all KL = 0.904 +- 0.242 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all L1 = 0.9 +- 0.231 (in-sample avg dev_std = 0.126)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2967962
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.499
SUFF_SIMPLE for r=0.1 class 0.0 = 0.994 +- 0.242 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.807 +- 0.242 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.1 all KL = 0.905 +- 0.242 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.1 all L1 = 0.9 +- 0.231 (in-sample avg dev_std = 0.116)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.232206
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.238 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.808 +- 0.238 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.2 all KL = 0.909 +- 0.238 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.2 all L1 = 0.902 +- 0.231 (in-sample avg dev_std = 0.085)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2004564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.237 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.809 +- 0.237 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.4 all KL = 0.911 +- 0.237 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.4 all L1 = 0.903 +- 0.232 (in-sample avg dev_std = 0.035)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1929168
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.809 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.913 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.903 +- 0.232 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5646831999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.606
SUFF_SIMPLE for r=0.05 class 0.0 = 0.766 +- 0.459 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.488 +- 0.459 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.05 all KL = 0.502 +- 0.459 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.05 all L1 = 0.629 +- 0.353 (in-sample avg dev_std = 0.437)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6044842
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.611
SUFF_SIMPLE for r=0.1 class 0.0 = 0.783 +- 0.464 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.521 +- 0.464 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.1 all KL = 0.557 +- 0.464 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.1 all L1 = 0.654 +- 0.364 (in-sample avg dev_std = 0.371)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6237054
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.611
SUFF_SIMPLE for r=0.2 class 0.0 = 0.799 +- 0.458 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.556 +- 0.458 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.2 all KL = 0.614 +- 0.458 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.2 all L1 = 0.679 +- 0.372 (in-sample avg dev_std = 0.307)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6324598
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.62
SUFF_SIMPLE for r=0.4 class 0.0 = 0.8 +- 0.448 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.595 +- 0.448 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.4 all KL = 0.655 +- 0.448 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.4 all L1 = 0.698 +- 0.374 (in-sample avg dev_std = 0.230)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6358043999999999
len(reference) = 4964
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.707
SUFF_SIMPLE for r=0.8 class 0.0 = 0.885 +- 0.310 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.856 +- 0.310 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.8 all KL = 0.865 +- 0.310 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.8 all L1 = 0.871 +- 0.273 (in-sample avg dev_std = 0.015)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5240820000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.466
NEC for r=0.05 class 0.0 = 0.108 +- 0.464 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.816 +- 0.464 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.565 +- 0.464 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.501 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5642619999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.452
NEC for r=0.1 class 0.0 = 0.121 +- 0.462 (in-sample avg dev_std = 0.044)
NEC for r=0.1 class 1.0 = 0.824 +- 0.462 (in-sample avg dev_std = 0.044)
NEC for r=0.1 all KL = 0.573 +- 0.462 (in-sample avg dev_std = 0.044)
NEC for r=0.1 all L1 = 0.51 +- 0.385 (in-sample avg dev_std = 0.044)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5535039999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.481
NEC for r=0.2 class 0.0 = 0.15 +- 0.449 (in-sample avg dev_std = 0.309)
NEC for r=0.2 class 1.0 = 0.8 +- 0.449 (in-sample avg dev_std = 0.309)
NEC for r=0.2 all KL = 0.588 +- 0.449 (in-sample avg dev_std = 0.309)
NEC for r=0.2 all L1 = 0.51 +- 0.366 (in-sample avg dev_std = 0.309)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5145619999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.51
NEC for r=0.4 class 0.0 = 0.194 +- 0.432 (in-sample avg dev_std = 0.482)
NEC for r=0.4 class 1.0 = 0.761 +- 0.432 (in-sample avg dev_std = 0.482)
NEC for r=0.4 all KL = 0.609 +- 0.432 (in-sample avg dev_std = 0.482)
NEC for r=0.4 all L1 = 0.508 +- 0.341 (in-sample avg dev_std = 0.482)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47984000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.561
NEC for r=0.8 class 0.0 = 0.24 +- 0.414 (in-sample avg dev_std = 0.572)
NEC for r=0.8 class 1.0 = 0.696 +- 0.414 (in-sample avg dev_std = 0.572)
NEC for r=0.8 all KL = 0.613 +- 0.414 (in-sample avg dev_std = 0.572)
NEC for r=0.8 all L1 = 0.493 +- 0.320 (in-sample avg dev_std = 0.572)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3980822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.005 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.187 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.088 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.097 +- 0.229 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2967962
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
NEC for r=0.1 class 0.0 = 0.007 +- 0.236 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.187 +- 0.236 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.09 +- 0.236 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.098 +- 0.230 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.232206
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.501
NEC for r=0.2 class 0.0 = 0.01 +- 0.242 (in-sample avg dev_std = 0.079)
NEC for r=0.2 class 1.0 = 0.191 +- 0.242 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all KL = 0.096 +- 0.242 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all L1 = 0.101 +- 0.231 (in-sample avg dev_std = 0.079)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2004564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.503
NEC for r=0.4 class 0.0 = 0.019 +- 0.254 (in-sample avg dev_std = 0.188)
NEC for r=0.4 class 1.0 = 0.19 +- 0.254 (in-sample avg dev_std = 0.188)
NEC for r=0.4 all KL = 0.108 +- 0.254 (in-sample avg dev_std = 0.188)
NEC for r=0.4 all L1 = 0.105 +- 0.229 (in-sample avg dev_std = 0.188)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1929168
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.505
NEC for r=0.8 class 0.0 = 0.014 +- 0.248 (in-sample avg dev_std = 0.170)
NEC for r=0.8 class 1.0 = 0.189 +- 0.248 (in-sample avg dev_std = 0.170)
NEC for r=0.8 all KL = 0.102 +- 0.248 (in-sample avg dev_std = 0.170)
NEC for r=0.8 all L1 = 0.102 +- 0.228 (in-sample avg dev_std = 0.170)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5646831999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.518
NEC for r=0.05 class 0.0 = 0.327 +- 0.464 (in-sample avg dev_std = 0.014)
NEC for r=0.05 class 1.0 = 0.747 +- 0.464 (in-sample avg dev_std = 0.014)
NEC for r=0.05 all KL = 0.622 +- 0.464 (in-sample avg dev_std = 0.014)
NEC for r=0.05 all L1 = 0.535 +- 0.395 (in-sample avg dev_std = 0.014)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6044842
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.515
NEC for r=0.1 class 0.0 = 0.329 +- 0.464 (in-sample avg dev_std = 0.116)
NEC for r=0.1 class 1.0 = 0.752 +- 0.464 (in-sample avg dev_std = 0.116)
NEC for r=0.1 all KL = 0.627 +- 0.464 (in-sample avg dev_std = 0.116)
NEC for r=0.1 all L1 = 0.538 +- 0.394 (in-sample avg dev_std = 0.116)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6237054
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.542
NEC for r=0.2 class 0.0 = 0.335 +- 0.463 (in-sample avg dev_std = 0.328)
NEC for r=0.2 class 1.0 = 0.726 +- 0.463 (in-sample avg dev_std = 0.328)
NEC for r=0.2 all KL = 0.63 +- 0.463 (in-sample avg dev_std = 0.328)
NEC for r=0.2 all L1 = 0.528 +- 0.383 (in-sample avg dev_std = 0.328)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6324598
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.595
NEC for r=0.4 class 0.0 = 0.333 +- 0.451 (in-sample avg dev_std = 0.478)
NEC for r=0.4 class 1.0 = 0.64 +- 0.451 (in-sample avg dev_std = 0.478)
NEC for r=0.4 all KL = 0.622 +- 0.451 (in-sample avg dev_std = 0.478)
NEC for r=0.4 all L1 = 0.485 +- 0.358 (in-sample avg dev_std = 0.478)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6358043999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.632
NEC for r=0.8 class 0.0 = 0.326 +- 0.427 (in-sample avg dev_std = 0.560)
NEC for r=0.8 class 1.0 = 0.558 +- 0.427 (in-sample avg dev_std = 0.560)
NEC for r=0.8 all KL = 0.62 +- 0.427 (in-sample avg dev_std = 0.560)
NEC for r=0.8 all L1 = 0.44 +- 0.329 (in-sample avg dev_std = 0.560)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 01:21:49 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 01:21:49 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 01:21:49 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 01:21:49 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 01:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:21:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:21:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:21:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 01:21:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mChartInfo 0.9620 0.9620 0.9620 0.9620 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.558
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.602
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.583
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.538
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.497
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.389
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.275
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.205
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.171
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.163
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.567
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.607
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.627
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.633
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.631


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.558236
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.505
SUFF_SIMPLE for r=0.05 class 0.0 = 0.831 +- 0.429 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.222 +- 0.429 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 all KL = 0.42 +- 0.429 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 all L1 = 0.494 +- 0.347 (in-sample avg dev_std = 0.440)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.601664
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.498
SUFF_SIMPLE for r=0.1 class 0.0 = 0.831 +- 0.430 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.216 +- 0.430 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.1 all KL = 0.417 +- 0.430 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.1 all L1 = 0.491 +- 0.348 (in-sample avg dev_std = 0.446)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.582798
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.516
SUFF_SIMPLE for r=0.2 class 0.0 = 0.817 +- 0.429 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.253 +- 0.429 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.2 all KL = 0.433 +- 0.429 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.2 all L1 = 0.505 +- 0.349 (in-sample avg dev_std = 0.414)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537856
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.5
SUFF_SIMPLE for r=0.4 class 0.0 = 0.852 +- 0.447 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.23 +- 0.447 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 all KL = 0.456 +- 0.447 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 all L1 = 0.508 +- 0.371 (in-sample avg dev_std = 0.276)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.497126
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.556
SUFF_SIMPLE for r=0.8 class 0.0 = 0.852 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.353 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.543 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.575 +- 0.387 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.389181
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.217 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.846 +- 0.217 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.05 all KL = 0.928 +- 0.217 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.05 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.057)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2747986
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.217 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.846 +- 0.217 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.1 all KL = 0.928 +- 0.217 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.1 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.039)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20482960000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.217 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.846 +- 0.217 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.2 all KL = 0.928 +- 0.217 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.2 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.019)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.17085540000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.846 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.928 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.16306579999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.846 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.928 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5668956
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.652
SUFF_SIMPLE for r=0.05 class 0.0 = 0.769 +- 0.413 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.617 +- 0.413 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.05 all KL = 0.66 +- 0.413 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.05 all L1 = 0.694 +- 0.345 (in-sample avg dev_std = 0.232)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6068646
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.65
SUFF_SIMPLE for r=0.1 class 0.0 = 0.763 +- 0.415 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.622 +- 0.415 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.1 all KL = 0.665 +- 0.415 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.1 all L1 = 0.693 +- 0.350 (in-sample avg dev_std = 0.198)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6267582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.656
SUFF_SIMPLE for r=0.2 class 0.0 = 0.773 +- 0.414 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.619 +- 0.414 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.2 all KL = 0.671 +- 0.414 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.2 all L1 = 0.697 +- 0.353 (in-sample avg dev_std = 0.163)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6328718000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.653
SUFF_SIMPLE for r=0.4 class 0.0 = 0.771 +- 0.414 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.62 +- 0.414 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 all KL = 0.67 +- 0.414 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 all L1 = 0.696 +- 0.354 (in-sample avg dev_std = 0.162)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6309754000000001
len(reference) = 4979
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.734
SUFF_SIMPLE for r=0.8 class 0.0 = 0.852 +- 0.287 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.864 +- 0.287 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.8 all KL = 0.863 +- 0.287 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.8 all L1 = 0.858 +- 0.258 (in-sample avg dev_std = 0.014)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.558236
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.472
NEC for r=0.05 class 0.0 = 0.086 +- 0.458 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.793 +- 0.458 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.532 +- 0.458 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.478 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.601664
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.46
NEC for r=0.1 class 0.0 = 0.094 +- 0.458 (in-sample avg dev_std = 0.030)
NEC for r=0.1 class 1.0 = 0.806 +- 0.458 (in-sample avg dev_std = 0.030)
NEC for r=0.1 all KL = 0.543 +- 0.458 (in-sample avg dev_std = 0.030)
NEC for r=0.1 all L1 = 0.488 +- 0.385 (in-sample avg dev_std = 0.030)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.582798
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.467
NEC for r=0.2 class 0.0 = 0.12 +- 0.449 (in-sample avg dev_std = 0.279)
NEC for r=0.2 class 1.0 = 0.806 +- 0.449 (in-sample avg dev_std = 0.279)
NEC for r=0.2 all KL = 0.561 +- 0.449 (in-sample avg dev_std = 0.279)
NEC for r=0.2 all L1 = 0.5 +- 0.373 (in-sample avg dev_std = 0.279)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537856
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.503
NEC for r=0.4 class 0.0 = 0.149 +- 0.435 (in-sample avg dev_std = 0.440)
NEC for r=0.4 class 1.0 = 0.769 +- 0.435 (in-sample avg dev_std = 0.440)
NEC for r=0.4 all KL = 0.569 +- 0.435 (in-sample avg dev_std = 0.440)
NEC for r=0.4 all L1 = 0.492 +- 0.351 (in-sample avg dev_std = 0.440)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.497126
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.57
NEC for r=0.8 class 0.0 = 0.208 +- 0.404 (in-sample avg dev_std = 0.543)
NEC for r=0.8 class 1.0 = 0.684 +- 0.404 (in-sample avg dev_std = 0.543)
NEC for r=0.8 all KL = 0.572 +- 0.404 (in-sample avg dev_std = 0.543)
NEC for r=0.8 all L1 = 0.472 +- 0.316 (in-sample avg dev_std = 0.543)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.389181
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.495
NEC for r=0.05 class 0.0 = 0.017 +- 0.222 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.147 +- 0.222 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.077 +- 0.222 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.083 +- 0.215 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2747986
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.502
NEC for r=0.1 class 0.0 = 0.024 +- 0.225 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.143 +- 0.225 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.079 +- 0.225 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.084 +- 0.216 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.20482960000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.505
NEC for r=0.2 class 0.0 = 0.026 +- 0.233 (in-sample avg dev_std = 0.106)
NEC for r=0.2 class 1.0 = 0.148 +- 0.233 (in-sample avg dev_std = 0.106)
NEC for r=0.2 all KL = 0.087 +- 0.233 (in-sample avg dev_std = 0.106)
NEC for r=0.2 all L1 = 0.088 +- 0.216 (in-sample avg dev_std = 0.106)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.17085540000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.499
NEC for r=0.4 class 0.0 = 0.021 +- 0.230 (in-sample avg dev_std = 0.178)
NEC for r=0.4 class 1.0 = 0.149 +- 0.230 (in-sample avg dev_std = 0.178)
NEC for r=0.4 all KL = 0.087 +- 0.230 (in-sample avg dev_std = 0.178)
NEC for r=0.4 all L1 = 0.085 +- 0.211 (in-sample avg dev_std = 0.178)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.16306579999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.502
NEC for r=0.8 class 0.0 = 0.012 +- 0.220 (in-sample avg dev_std = 0.158)
NEC for r=0.8 class 1.0 = 0.149 +- 0.220 (in-sample avg dev_std = 0.158)
NEC for r=0.8 all KL = 0.079 +- 0.220 (in-sample avg dev_std = 0.158)
NEC for r=0.8 all L1 = 0.081 +- 0.207 (in-sample avg dev_std = 0.158)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5668956
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.524
NEC for r=0.05 class 0.0 = 0.305 +- 0.452 (in-sample avg dev_std = 0.029)
NEC for r=0.05 class 1.0 = 0.733 +- 0.452 (in-sample avg dev_std = 0.029)
NEC for r=0.05 all KL = 0.574 +- 0.452 (in-sample avg dev_std = 0.029)
NEC for r=0.05 all L1 = 0.516 +- 0.386 (in-sample avg dev_std = 0.029)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6068646
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.527
NEC for r=0.1 class 0.0 = 0.309 +- 0.451 (in-sample avg dev_std = 0.161)
NEC for r=0.1 class 1.0 = 0.741 +- 0.451 (in-sample avg dev_std = 0.161)
NEC for r=0.1 all KL = 0.586 +- 0.451 (in-sample avg dev_std = 0.161)
NEC for r=0.1 all L1 = 0.522 +- 0.383 (in-sample avg dev_std = 0.161)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6267582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.559
NEC for r=0.2 class 0.0 = 0.314 +- 0.447 (in-sample avg dev_std = 0.316)
NEC for r=0.2 class 1.0 = 0.717 +- 0.447 (in-sample avg dev_std = 0.316)
NEC for r=0.2 all KL = 0.596 +- 0.447 (in-sample avg dev_std = 0.316)
NEC for r=0.2 all L1 = 0.513 +- 0.373 (in-sample avg dev_std = 0.316)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6328718000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.6
NEC for r=0.4 class 0.0 = 0.315 +- 0.431 (in-sample avg dev_std = 0.449)
NEC for r=0.4 class 1.0 = 0.638 +- 0.431 (in-sample avg dev_std = 0.449)
NEC for r=0.4 all KL = 0.58 +- 0.431 (in-sample avg dev_std = 0.449)
NEC for r=0.4 all L1 = 0.474 +- 0.349 (in-sample avg dev_std = 0.449)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6309754000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.643
NEC for r=0.8 class 0.0 = 0.305 +- 0.406 (in-sample avg dev_std = 0.518)
NEC for r=0.8 class 1.0 = 0.535 +- 0.406 (in-sample avg dev_std = 0.518)
NEC for r=0.8 all KL = 0.543 +- 0.406 (in-sample avg dev_std = 0.518)
NEC for r=0.8 all L1 = 0.419 +- 0.320 (in-sample avg dev_std = 0.518)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 01:37:12 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 01:37:12 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 01:37:12 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 01:37:12 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 01:37:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:37:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:37:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:37:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:37:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:37:12 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 01:37:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mChartInfo 0.9440 0.9440 0.9440 0.9440 0.9680 0.9680[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.586
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.607
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.567
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.506
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.464
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.388
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.263
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.182
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.140
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.130
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.583
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.617
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.629
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.632
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.635


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.586386
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.461
SUFF_SIMPLE for r=0.05 class 0.0 = 0.832 +- 0.440 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.178 +- 0.440 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.05 all KL = 0.414 +- 0.440 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.05 all L1 = 0.47 +- 0.362 (in-sample avg dev_std = 0.311)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.606532
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.453
SUFF_SIMPLE for r=0.1 class 0.0 = 0.837 +- 0.444 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.169 +- 0.444 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.1 all KL = 0.417 +- 0.444 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.1 all L1 = 0.467 +- 0.367 (in-sample avg dev_std = 0.254)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5667620000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.458
SUFF_SIMPLE for r=0.2 class 0.0 = 0.855 +- 0.449 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.166 +- 0.449 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.2 all KL = 0.426 +- 0.449 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.2 all L1 = 0.473 +- 0.372 (in-sample avg dev_std = 0.221)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.506066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.451
SUFF_SIMPLE for r=0.4 class 0.0 = 0.858 +- 0.450 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.164 +- 0.450 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.4 all KL = 0.429 +- 0.450 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.4 all L1 = 0.474 +- 0.376 (in-sample avg dev_std = 0.108)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.463508
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.56
SUFF_SIMPLE for r=0.8 class 0.0 = 0.841 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.335 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.529 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.561 +- 0.381 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387676
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.26267599999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.181619
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.140123
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1298802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5830317999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.596
SUFF_SIMPLE for r=0.05 class 0.0 = 0.749 +- 0.428 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.447 +- 0.428 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.05 all KL = 0.502 +- 0.428 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.05 all L1 = 0.6 +- 0.349 (in-sample avg dev_std = 0.480)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6166992
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.596
SUFF_SIMPLE for r=0.1 class 0.0 = 0.767 +- 0.436 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.463 +- 0.436 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.1 all KL = 0.534 +- 0.436 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.1 all L1 = 0.617 +- 0.357 (in-sample avg dev_std = 0.442)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6291796000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.591
SUFF_SIMPLE for r=0.2 class 0.0 = 0.781 +- 0.437 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.496 +- 0.437 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.2 all KL = 0.573 +- 0.437 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.2 all L1 = 0.641 +- 0.363 (in-sample avg dev_std = 0.404)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6322397999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.585
SUFF_SIMPLE for r=0.4 class 0.0 = 0.784 +- 0.447 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.507 +- 0.447 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.4 all KL = 0.592 +- 0.447 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.4 all L1 = 0.647 +- 0.373 (in-sample avg dev_std = 0.371)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6347246
len(reference) = 4962
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.669
SUFF_SIMPLE for r=0.8 class 0.0 = 0.879 +- 0.353 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.788 +- 0.353 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.826 +- 0.353 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.834 +- 0.312 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.586386
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.458
NEC for r=0.05 class 0.0 = 0.106 +- 0.461 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.812 +- 0.461 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.548 +- 0.461 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.497 +- 0.388 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.606532
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.448
NEC for r=0.1 class 0.0 = 0.118 +- 0.457 (in-sample avg dev_std = 0.002)
NEC for r=0.1 class 1.0 = 0.816 +- 0.457 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all KL = 0.558 +- 0.457 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all L1 = 0.505 +- 0.380 (in-sample avg dev_std = 0.002)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5667620000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.46
NEC for r=0.2 class 0.0 = 0.121 +- 0.456 (in-sample avg dev_std = 0.160)
NEC for r=0.2 class 1.0 = 0.811 +- 0.456 (in-sample avg dev_std = 0.160)
NEC for r=0.2 all KL = 0.559 +- 0.456 (in-sample avg dev_std = 0.160)
NEC for r=0.2 all L1 = 0.503 +- 0.380 (in-sample avg dev_std = 0.160)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.506066
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.488
NEC for r=0.4 class 0.0 = 0.128 +- 0.451 (in-sample avg dev_std = 0.317)
NEC for r=0.4 class 1.0 = 0.795 +- 0.451 (in-sample avg dev_std = 0.317)
NEC for r=0.4 all KL = 0.557 +- 0.451 (in-sample avg dev_std = 0.317)
NEC for r=0.4 all L1 = 0.497 +- 0.371 (in-sample avg dev_std = 0.317)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.463508
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.532
NEC for r=0.8 class 0.0 = 0.176 +- 0.428 (in-sample avg dev_std = 0.498)
NEC for r=0.8 class 1.0 = 0.753 +- 0.428 (in-sample avg dev_std = 0.498)
NEC for r=0.8 all KL = 0.57 +- 0.428 (in-sample avg dev_std = 0.498)
NEC for r=0.8 all L1 = 0.495 +- 0.340 (in-sample avg dev_std = 0.498)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.387676
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.11 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.047 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.056 +- 0.173 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.26267599999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.004 +- 0.159 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.108 +- 0.159 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.046 +- 0.159 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.056 +- 0.171 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.181619
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.006 +- 0.159 (in-sample avg dev_std = 0.026)
NEC for r=0.2 class 1.0 = 0.106 +- 0.159 (in-sample avg dev_std = 0.026)
NEC for r=0.2 all KL = 0.047 +- 0.159 (in-sample avg dev_std = 0.026)
NEC for r=0.2 all L1 = 0.056 +- 0.170 (in-sample avg dev_std = 0.026)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.140123
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.002 +- 0.166 (in-sample avg dev_std = 0.031)
NEC for r=0.4 class 1.0 = 0.111 +- 0.166 (in-sample avg dev_std = 0.031)
NEC for r=0.4 all KL = 0.048 +- 0.166 (in-sample avg dev_std = 0.031)
NEC for r=0.4 all L1 = 0.057 +- 0.174 (in-sample avg dev_std = 0.031)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1298802
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.166 (in-sample avg dev_std = 0.023)
NEC for r=0.8 class 1.0 = 0.111 +- 0.166 (in-sample avg dev_std = 0.023)
NEC for r=0.8 all KL = 0.047 +- 0.166 (in-sample avg dev_std = 0.023)
NEC for r=0.8 all L1 = 0.056 +- 0.174 (in-sample avg dev_std = 0.023)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5830317999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.517
NEC for r=0.05 class 0.0 = 0.329 +- 0.462 (in-sample avg dev_std = 0.012)
NEC for r=0.05 class 1.0 = 0.732 +- 0.462 (in-sample avg dev_std = 0.012)
NEC for r=0.05 all KL = 0.608 +- 0.462 (in-sample avg dev_std = 0.012)
NEC for r=0.05 all L1 = 0.528 +- 0.395 (in-sample avg dev_std = 0.012)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6166992
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.511
NEC for r=0.1 class 0.0 = 0.334 +- 0.461 (in-sample avg dev_std = 0.100)
NEC for r=0.1 class 1.0 = 0.74 +- 0.461 (in-sample avg dev_std = 0.100)
NEC for r=0.1 all KL = 0.616 +- 0.461 (in-sample avg dev_std = 0.100)
NEC for r=0.1 all L1 = 0.535 +- 0.393 (in-sample avg dev_std = 0.100)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6291796000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.524
NEC for r=0.2 class 0.0 = 0.337 +- 0.458 (in-sample avg dev_std = 0.247)
NEC for r=0.2 class 1.0 = 0.727 +- 0.458 (in-sample avg dev_std = 0.247)
NEC for r=0.2 all KL = 0.614 +- 0.458 (in-sample avg dev_std = 0.247)
NEC for r=0.2 all L1 = 0.529 +- 0.388 (in-sample avg dev_std = 0.247)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6322397999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.557
NEC for r=0.4 class 0.0 = 0.331 +- 0.448 (in-sample avg dev_std = 0.413)
NEC for r=0.4 class 1.0 = 0.672 +- 0.448 (in-sample avg dev_std = 0.413)
NEC for r=0.4 all KL = 0.591 +- 0.448 (in-sample avg dev_std = 0.413)
NEC for r=0.4 all L1 = 0.499 +- 0.374 (in-sample avg dev_std = 0.413)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6347246
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.586
NEC for r=0.8 class 0.0 = 0.336 +- 0.416 (in-sample avg dev_std = 0.548)
NEC for r=0.8 class 1.0 = 0.636 +- 0.416 (in-sample avg dev_std = 0.548)
NEC for r=0.8 all KL = 0.599 +- 0.416 (in-sample avg dev_std = 0.548)
NEC for r=0.8 all L1 = 0.484 +- 0.338 (in-sample avg dev_std = 0.548)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 01:52:20 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 01:52:20 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 01:52:20 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 01:52:20 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 01:52:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:52:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:52:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:52:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:52:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:52:20 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 01:52:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mChartInfo 0.9500 0.9500 0.9500 0.9500 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.545
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.589
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.571
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.528
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.491
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.419
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.308
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.237
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.203
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.196
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.563
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.600
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.619
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.626
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.634


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.544598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.459
SUFF_SIMPLE for r=0.05 class 0.0 = 0.831 +- 0.432 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.176 +- 0.432 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all KL = 0.414 +- 0.432 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all L1 = 0.468 +- 0.356 (in-sample avg dev_std = 0.323)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.589254
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.472
SUFF_SIMPLE for r=0.1 class 0.0 = 0.851 +- 0.441 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.177 +- 0.441 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.1 all KL = 0.43 +- 0.441 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.1 all L1 = 0.478 +- 0.363 (in-sample avg dev_std = 0.312)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.571346
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.47
SUFF_SIMPLE for r=0.2 class 0.0 = 0.86 +- 0.443 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.172 +- 0.443 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.2 all KL = 0.433 +- 0.443 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.2 all L1 = 0.479 +- 0.366 (in-sample avg dev_std = 0.275)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.52767
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.454
SUFF_SIMPLE for r=0.4 class 0.0 = 0.857 +- 0.446 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.168 +- 0.446 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 all KL = 0.432 +- 0.446 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 all L1 = 0.475 +- 0.371 (in-sample avg dev_std = 0.184)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.491084
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.546
SUFF_SIMPLE for r=0.8 class 0.0 = 0.85 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.315 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.526 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.554 +- 0.380 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4193664000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3080754
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23700439999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20296779999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1956944
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5627904
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.618
SUFF_SIMPLE for r=0.05 class 0.0 = 0.744 +- 0.430 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.484 +- 0.430 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.05 all KL = 0.557 +- 0.430 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.05 all L1 = 0.615 +- 0.343 (in-sample avg dev_std = 0.400)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.600358
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.623
SUFF_SIMPLE for r=0.1 class 0.0 = 0.767 +- 0.429 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.524 +- 0.429 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.1 all KL = 0.609 +- 0.429 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.1 all L1 = 0.647 +- 0.350 (in-sample avg dev_std = 0.338)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.618613
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.621
SUFF_SIMPLE for r=0.2 class 0.0 = 0.783 +- 0.421 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.565 +- 0.421 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.2 all KL = 0.655 +- 0.421 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.2 all L1 = 0.676 +- 0.354 (in-sample avg dev_std = 0.266)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6259155999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.625
SUFF_SIMPLE for r=0.4 class 0.0 = 0.781 +- 0.422 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.589 +- 0.422 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.4 all KL = 0.669 +- 0.422 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.4 all L1 = 0.686 +- 0.354 (in-sample avg dev_std = 0.237)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.759
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6338482
len(reference) = 4960
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.705
SUFF_SIMPLE for r=0.8 class 0.0 = 0.869 +- 0.292 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.849 +- 0.292 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all KL = 0.872 +- 0.292 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all L1 = 0.859 +- 0.265 (in-sample avg dev_std = 0.002)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.544598
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.442
NEC for r=0.05 class 0.0 = 0.093 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.831 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.547 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.502 +- 0.389 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.589254
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.464
NEC for r=0.1 class 0.0 = 0.096 +- 0.455 (in-sample avg dev_std = 0.003)
NEC for r=0.1 class 1.0 = 0.816 +- 0.455 (in-sample avg dev_std = 0.003)
NEC for r=0.1 all KL = 0.542 +- 0.455 (in-sample avg dev_std = 0.003)
NEC for r=0.1 all L1 = 0.495 +- 0.383 (in-sample avg dev_std = 0.003)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.571346
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.46
NEC for r=0.2 class 0.0 = 0.109 +- 0.452 (in-sample avg dev_std = 0.151)
NEC for r=0.2 class 1.0 = 0.813 +- 0.452 (in-sample avg dev_std = 0.151)
NEC for r=0.2 all KL = 0.548 +- 0.452 (in-sample avg dev_std = 0.151)
NEC for r=0.2 all L1 = 0.499 +- 0.380 (in-sample avg dev_std = 0.151)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.52767
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.47
NEC for r=0.4 class 0.0 = 0.13 +- 0.445 (in-sample avg dev_std = 0.300)
NEC for r=0.4 class 1.0 = 0.811 +- 0.445 (in-sample avg dev_std = 0.300)
NEC for r=0.4 all KL = 0.56 +- 0.445 (in-sample avg dev_std = 0.300)
NEC for r=0.4 all L1 = 0.507 +- 0.368 (in-sample avg dev_std = 0.300)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.491084
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.528
NEC for r=0.8 class 0.0 = 0.178 +- 0.423 (in-sample avg dev_std = 0.475)
NEC for r=0.8 class 1.0 = 0.751 +- 0.423 (in-sample avg dev_std = 0.475)
NEC for r=0.8 all KL = 0.561 +- 0.423 (in-sample avg dev_std = 0.475)
NEC for r=0.8 all L1 = 0.496 +- 0.340 (in-sample avg dev_std = 0.475)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4193664000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.004 +- 0.193 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.175 +- 0.193 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.072 +- 0.193 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.09 +- 0.208 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3080754
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.005 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.173 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.071 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.09 +- 0.207 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.23700439999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.007 +- 0.191 (in-sample avg dev_std = 0.030)
NEC for r=0.2 class 1.0 = 0.173 +- 0.191 (in-sample avg dev_std = 0.030)
NEC for r=0.2 all KL = 0.073 +- 0.191 (in-sample avg dev_std = 0.030)
NEC for r=0.2 all L1 = 0.09 +- 0.207 (in-sample avg dev_std = 0.030)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20296779999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.004 +- 0.198 (in-sample avg dev_std = 0.045)
NEC for r=0.4 class 1.0 = 0.177 +- 0.198 (in-sample avg dev_std = 0.045)
NEC for r=0.4 all KL = 0.076 +- 0.198 (in-sample avg dev_std = 0.045)
NEC for r=0.4 all L1 = 0.091 +- 0.210 (in-sample avg dev_std = 0.045)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1956944
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.003 +- 0.198 (in-sample avg dev_std = 0.023)
NEC for r=0.8 class 1.0 = 0.177 +- 0.198 (in-sample avg dev_std = 0.023)
NEC for r=0.8 all KL = 0.074 +- 0.198 (in-sample avg dev_std = 0.023)
NEC for r=0.8 all L1 = 0.09 +- 0.210 (in-sample avg dev_std = 0.023)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5627904
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.522
NEC for r=0.05 class 0.0 = 0.312 +- 0.445 (in-sample avg dev_std = 0.007)
NEC for r=0.05 class 1.0 = 0.728 +- 0.445 (in-sample avg dev_std = 0.007)
NEC for r=0.05 all KL = 0.579 +- 0.445 (in-sample avg dev_std = 0.007)
NEC for r=0.05 all L1 = 0.517 +- 0.392 (in-sample avg dev_std = 0.007)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.600358
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.52
NEC for r=0.1 class 0.0 = 0.316 +- 0.445 (in-sample avg dev_std = 0.056)
NEC for r=0.1 class 1.0 = 0.73 +- 0.445 (in-sample avg dev_std = 0.056)
NEC for r=0.1 all KL = 0.587 +- 0.445 (in-sample avg dev_std = 0.056)
NEC for r=0.1 all L1 = 0.521 +- 0.391 (in-sample avg dev_std = 0.056)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.618613
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.527
NEC for r=0.2 class 0.0 = 0.321 +- 0.447 (in-sample avg dev_std = 0.184)
NEC for r=0.2 class 1.0 = 0.724 +- 0.447 (in-sample avg dev_std = 0.184)
NEC for r=0.2 all KL = 0.589 +- 0.447 (in-sample avg dev_std = 0.184)
NEC for r=0.2 all L1 = 0.52 +- 0.390 (in-sample avg dev_std = 0.184)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6259155999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.553
NEC for r=0.4 class 0.0 = 0.316 +- 0.439 (in-sample avg dev_std = 0.373)
NEC for r=0.4 class 1.0 = 0.696 +- 0.439 (in-sample avg dev_std = 0.373)
NEC for r=0.4 all KL = 0.575 +- 0.439 (in-sample avg dev_std = 0.373)
NEC for r=0.4 all L1 = 0.504 +- 0.376 (in-sample avg dev_std = 0.373)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.758
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6338482
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.584
NEC for r=0.8 class 0.0 = 0.328 +- 0.416 (in-sample avg dev_std = 0.544)
NEC for r=0.8 class 1.0 = 0.654 +- 0.416 (in-sample avg dev_std = 0.544)
NEC for r=0.8 all KL = 0.583 +- 0.416 (in-sample avg dev_std = 0.544)
NEC for r=0.8 all L1 = 0.489 +- 0.343 (in-sample avg dev_std = 0.544)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 02:08:09 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 02:08:09 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 02:08:09 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 02:08:09 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 02:08:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:08:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:08:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:08:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:08:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:08:09 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 02:08:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mChartInfo 0.9460 0.9460 0.9460 0.9460 0.9560 0.9560[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.544
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.543
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.467
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.374
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.311
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.326
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.199
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.120
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.063
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.545
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.572
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.579
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.581
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.586


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.543858
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.452
SUFF_SIMPLE for r=0.05 class 0.0 = 0.842 +- 0.429 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.173 +- 0.429 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 all KL = 0.435 +- 0.429 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 all L1 = 0.471 +- 0.365 (in-sample avg dev_std = 0.142)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.54268
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.444
SUFF_SIMPLE for r=0.1 class 0.0 = 0.831 +- 0.429 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.172 +- 0.429 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.1 all KL = 0.429 +- 0.429 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.1 all L1 = 0.466 +- 0.365 (in-sample avg dev_std = 0.156)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46653999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.486
SUFF_SIMPLE for r=0.2 class 0.0 = 0.821 +- 0.427 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.244 +- 0.427 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 all KL = 0.471 +- 0.427 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 all L1 = 0.501 +- 0.366 (in-sample avg dev_std = 0.148)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.37388600000000005
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.45
SUFF_SIMPLE for r=0.4 class 0.0 = 0.82 +- 0.432 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.197 +- 0.432 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 all KL = 0.442 +- 0.432 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 all L1 = 0.475 +- 0.368 (in-sample avg dev_std = 0.065)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.310576
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.48
SUFF_SIMPLE for r=0.8 class 0.0 = 0.851 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.224 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.48 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.504 +- 0.377 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3264632
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1992766
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.120321
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0774788
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06265060000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5448006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.636
SUFF_SIMPLE for r=0.05 class 0.0 = 0.797 +- 0.422 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.63 +- 0.422 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.05 all KL = 0.679 +- 0.422 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.05 all L1 = 0.715 +- 0.341 (in-sample avg dev_std = 0.206)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5719512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.633
SUFF_SIMPLE for r=0.1 class 0.0 = 0.793 +- 0.413 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.643 +- 0.413 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.1 all KL = 0.696 +- 0.413 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.1 all L1 = 0.719 +- 0.343 (in-sample avg dev_std = 0.161)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5790533999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.636
SUFF_SIMPLE for r=0.2 class 0.0 = 0.793 +- 0.411 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.642 +- 0.411 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.2 all KL = 0.709 +- 0.411 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.2 all L1 = 0.719 +- 0.354 (in-sample avg dev_std = 0.125)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5811682
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.637
SUFF_SIMPLE for r=0.4 class 0.0 = 0.802 +- 0.407 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.641 +- 0.407 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.4 all KL = 0.719 +- 0.407 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.4 all L1 = 0.723 +- 0.354 (in-sample avg dev_std = 0.126)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5863786
len(reference) = 4946
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.699
SUFF_SIMPLE for r=0.8 class 0.0 = 0.893 +- 0.272 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.856 +- 0.272 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all KL = 0.893 +- 0.272 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all L1 = 0.874 +- 0.249 (in-sample avg dev_std = 0.005)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.543858
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.468
NEC for r=0.05 class 0.0 = 0.119 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.801 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.532 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.497 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.54268
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
NEC for r=0.1 class 0.0 = 0.115 +- 0.443 (in-sample avg dev_std = 0.006)
NEC for r=0.1 class 1.0 = 0.822 +- 0.443 (in-sample avg dev_std = 0.006)
NEC for r=0.1 all KL = 0.541 +- 0.443 (in-sample avg dev_std = 0.006)
NEC for r=0.1 all L1 = 0.507 +- 0.383 (in-sample avg dev_std = 0.006)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.46653999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
NEC for r=0.2 class 0.0 = 0.129 +- 0.441 (in-sample avg dev_std = 0.064)
NEC for r=0.2 class 1.0 = 0.824 +- 0.441 (in-sample avg dev_std = 0.064)
NEC for r=0.2 all KL = 0.546 +- 0.441 (in-sample avg dev_std = 0.064)
NEC for r=0.2 all L1 = 0.514 +- 0.377 (in-sample avg dev_std = 0.064)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.37388600000000005
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.456
NEC for r=0.4 class 0.0 = 0.143 +- 0.435 (in-sample avg dev_std = 0.158)
NEC for r=0.4 class 1.0 = 0.82 +- 0.435 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all KL = 0.551 +- 0.435 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all L1 = 0.518 +- 0.371 (in-sample avg dev_std = 0.158)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.310576
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.479
NEC for r=0.8 class 0.0 = 0.16 +- 0.426 (in-sample avg dev_std = 0.255)
NEC for r=0.8 class 1.0 = 0.799 +- 0.426 (in-sample avg dev_std = 0.255)
NEC for r=0.8 all KL = 0.548 +- 0.426 (in-sample avg dev_std = 0.255)
NEC for r=0.8 all L1 = 0.514 +- 0.361 (in-sample avg dev_std = 0.255)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3264632
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.09 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.031 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1992766
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.09 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.031 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.120321
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.104 (in-sample avg dev_std = 0.004)
NEC for r=0.2 class 1.0 = 0.09 +- 0.104 (in-sample avg dev_std = 0.004)
NEC for r=0.2 all KL = 0.031 +- 0.104 (in-sample avg dev_std = 0.004)
NEC for r=0.2 all L1 = 0.046 +- 0.132 (in-sample avg dev_std = 0.004)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0774788
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06265060000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5448006
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.536
NEC for r=0.05 class 0.0 = 0.329 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.73 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.576 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.527 +- 0.384 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5719512
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.52
NEC for r=0.1 class 0.0 = 0.338 +- 0.435 (in-sample avg dev_std = 0.025)
NEC for r=0.1 class 1.0 = 0.751 +- 0.435 (in-sample avg dev_std = 0.025)
NEC for r=0.1 all KL = 0.592 +- 0.435 (in-sample avg dev_std = 0.025)
NEC for r=0.1 all L1 = 0.542 +- 0.378 (in-sample avg dev_std = 0.025)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5790533999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.511
NEC for r=0.2 class 0.0 = 0.343 +- 0.436 (in-sample avg dev_std = 0.179)
NEC for r=0.2 class 1.0 = 0.74 +- 0.436 (in-sample avg dev_std = 0.179)
NEC for r=0.2 all KL = 0.592 +- 0.436 (in-sample avg dev_std = 0.179)
NEC for r=0.2 all L1 = 0.539 +- 0.378 (in-sample avg dev_std = 0.179)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5811682
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.54
NEC for r=0.4 class 0.0 = 0.327 +- 0.429 (in-sample avg dev_std = 0.399)
NEC for r=0.4 class 1.0 = 0.696 +- 0.429 (in-sample avg dev_std = 0.399)
NEC for r=0.4 all KL = 0.572 +- 0.429 (in-sample avg dev_std = 0.399)
NEC for r=0.4 all L1 = 0.509 +- 0.366 (in-sample avg dev_std = 0.399)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5863786
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.597
NEC for r=0.8 class 0.0 = 0.312 +- 0.400 (in-sample avg dev_std = 0.537)
NEC for r=0.8 class 1.0 = 0.614 +- 0.400 (in-sample avg dev_std = 0.537)
NEC for r=0.8 all KL = 0.55 +- 0.400 (in-sample avg dev_std = 0.537)
NEC for r=0.8 all L1 = 0.461 +- 0.333 (in-sample avg dev_std = 0.537)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 02:23:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 02:23:30 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 02:23:30 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 02:23:30 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 02:23:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:23:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:23:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:23:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:23:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:23:30 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 02:23:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mChartInfo 0.9660 0.9660 0.9660 0.9660 0.9720 0.9720[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.572
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.604
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.572
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.518
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.472
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.385
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.263
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.186
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.147
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.135
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.554
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.599
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.618
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.624
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.624


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5724199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.483
SUFF_SIMPLE for r=0.05 class 0.0 = 0.875 +- 0.442 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.189 +- 0.442 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.05 all KL = 0.441 +- 0.442 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.05 all L1 = 0.495 +- 0.368 (in-sample avg dev_std = 0.321)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6036300000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.488
SUFF_SIMPLE for r=0.1 class 0.0 = 0.869 +- 0.437 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.194 +- 0.437 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 all KL = 0.436 +- 0.437 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 all L1 = 0.495 +- 0.364 (in-sample avg dev_std = 0.352)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5717420000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.51
SUFF_SIMPLE for r=0.2 class 0.0 = 0.842 +- 0.434 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.238 +- 0.434 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.2 all KL = 0.45 +- 0.434 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.2 all L1 = 0.508 +- 0.362 (in-sample avg dev_std = 0.296)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.517828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.469
SUFF_SIMPLE for r=0.4 class 0.0 = 0.863 +- 0.446 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.192 +- 0.446 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.4 all KL = 0.44 +- 0.446 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.4 all L1 = 0.491 +- 0.375 (in-sample avg dev_std = 0.194)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47195
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.54
SUFF_SIMPLE for r=0.8 class 0.0 = 0.852 +- 0.452 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.325 +- 0.452 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.53 +- 0.452 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.56 +- 0.386 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3853108
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2630796
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1859616
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1471292
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.13548960000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5538407999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.654
SUFF_SIMPLE for r=0.05 class 0.0 = 0.814 +- 0.421 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.633 +- 0.421 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.05 all KL = 0.704 +- 0.421 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.05 all L1 = 0.725 +- 0.363 (in-sample avg dev_std = 0.148)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5990923999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.655
SUFF_SIMPLE for r=0.1 class 0.0 = 0.801 +- 0.422 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.64 +- 0.422 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all KL = 0.699 +- 0.422 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all L1 = 0.722 +- 0.361 (in-sample avg dev_std = 0.138)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6184592000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.648
SUFF_SIMPLE for r=0.2 class 0.0 = 0.795 +- 0.430 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.621 +- 0.430 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.2 all KL = 0.683 +- 0.430 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.2 all L1 = 0.709 +- 0.369 (in-sample avg dev_std = 0.118)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6244049999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.652
SUFF_SIMPLE for r=0.4 class 0.0 = 0.797 +- 0.426 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.628 +- 0.426 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.4 all KL = 0.69 +- 0.426 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.4 all L1 = 0.714 +- 0.367 (in-sample avg dev_std = 0.113)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6240072
len(reference) = 4989
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.724
SUFF_SIMPLE for r=0.8 class 0.0 = 0.881 +- 0.287 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.868 +- 0.287 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all KL = 0.879 +- 0.287 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all L1 = 0.874 +- 0.260 (in-sample avg dev_std = 0.002)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5724199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.448
NEC for r=0.05 class 0.0 = 0.078 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.823 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.542 +- 0.465 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.491 +- 0.396 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6036300000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.45
NEC for r=0.1 class 0.0 = 0.081 +- 0.462 (in-sample avg dev_std = 0.004)
NEC for r=0.1 class 1.0 = 0.814 +- 0.462 (in-sample avg dev_std = 0.004)
NEC for r=0.1 all KL = 0.54 +- 0.462 (in-sample avg dev_std = 0.004)
NEC for r=0.1 all L1 = 0.487 +- 0.393 (in-sample avg dev_std = 0.004)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5717420000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.455
NEC for r=0.2 class 0.0 = 0.094 +- 0.458 (in-sample avg dev_std = 0.148)
NEC for r=0.2 class 1.0 = 0.812 +- 0.458 (in-sample avg dev_std = 0.148)
NEC for r=0.2 all KL = 0.542 +- 0.458 (in-sample avg dev_std = 0.148)
NEC for r=0.2 all L1 = 0.492 +- 0.387 (in-sample avg dev_std = 0.148)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.517828
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.477
NEC for r=0.4 class 0.0 = 0.106 +- 0.451 (in-sample avg dev_std = 0.307)
NEC for r=0.4 class 1.0 = 0.805 +- 0.451 (in-sample avg dev_std = 0.307)
NEC for r=0.4 all KL = 0.548 +- 0.451 (in-sample avg dev_std = 0.307)
NEC for r=0.4 all L1 = 0.493 +- 0.374 (in-sample avg dev_std = 0.307)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.47195
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.547
NEC for r=0.8 class 0.0 = 0.132 +- 0.434 (in-sample avg dev_std = 0.459)
NEC for r=0.8 class 1.0 = 0.743 +- 0.434 (in-sample avg dev_std = 0.459)
NEC for r=0.8 all KL = 0.536 +- 0.434 (in-sample avg dev_std = 0.459)
NEC for r=0.8 all L1 = 0.471 +- 0.351 (in-sample avg dev_std = 0.459)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3853108
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.136 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.09 +- 0.136 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.036 +- 0.136 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.2630796
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.002 +- 0.137 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.089 +- 0.137 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.036 +- 0.137 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1859616
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.136 (in-sample avg dev_std = 0.002)
NEC for r=0.2 class 1.0 = 0.09 +- 0.136 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all KL = 0.036 +- 0.136 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1471292
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.001 +- 0.138 (in-sample avg dev_std = 0.014)
NEC for r=0.4 class 1.0 = 0.09 +- 0.138 (in-sample avg dev_std = 0.014)
NEC for r=0.4 all KL = 0.036 +- 0.138 (in-sample avg dev_std = 0.014)
NEC for r=0.4 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.014)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.13548960000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.138 (in-sample avg dev_std = 0.028)
NEC for r=0.8 class 1.0 = 0.09 +- 0.138 (in-sample avg dev_std = 0.028)
NEC for r=0.8 all KL = 0.037 +- 0.138 (in-sample avg dev_std = 0.028)
NEC for r=0.8 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.028)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5538407999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.515
NEC for r=0.05 class 0.0 = 0.346 +- 0.452 (in-sample avg dev_std = 0.004)
NEC for r=0.05 class 1.0 = 0.765 +- 0.452 (in-sample avg dev_std = 0.004)
NEC for r=0.05 all KL = 0.624 +- 0.452 (in-sample avg dev_std = 0.004)
NEC for r=0.05 all L1 = 0.553 +- 0.377 (in-sample avg dev_std = 0.004)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5990923999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.513
NEC for r=0.1 class 0.0 = 0.354 +- 0.450 (in-sample avg dev_std = 0.063)
NEC for r=0.1 class 1.0 = 0.768 +- 0.450 (in-sample avg dev_std = 0.063)
NEC for r=0.1 all KL = 0.63 +- 0.450 (in-sample avg dev_std = 0.063)
NEC for r=0.1 all L1 = 0.559 +- 0.374 (in-sample avg dev_std = 0.063)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6184592000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.516
NEC for r=0.2 class 0.0 = 0.346 +- 0.453 (in-sample avg dev_std = 0.213)
NEC for r=0.2 class 1.0 = 0.761 +- 0.453 (in-sample avg dev_std = 0.213)
NEC for r=0.2 all KL = 0.627 +- 0.453 (in-sample avg dev_std = 0.213)
NEC for r=0.2 all L1 = 0.551 +- 0.377 (in-sample avg dev_std = 0.213)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6244049999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.548
NEC for r=0.4 class 0.0 = 0.33 +- 0.446 (in-sample avg dev_std = 0.422)
NEC for r=0.4 class 1.0 = 0.711 +- 0.446 (in-sample avg dev_std = 0.422)
NEC for r=0.4 all KL = 0.61 +- 0.446 (in-sample avg dev_std = 0.422)
NEC for r=0.4 all L1 = 0.518 +- 0.364 (in-sample avg dev_std = 0.422)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6240072
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.584
NEC for r=0.8 class 0.0 = 0.307 +- 0.423 (in-sample avg dev_std = 0.540)
NEC for r=0.8 class 1.0 = 0.629 +- 0.423 (in-sample avg dev_std = 0.540)
NEC for r=0.8 all KL = 0.579 +- 0.423 (in-sample avg dev_std = 0.540)
NEC for r=0.8 all L1 = 0.466 +- 0.338 (in-sample avg dev_std = 0.540)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 02:38:42 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 02:38:42 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 02:38:42 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 02:38:42 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 02:38:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:38:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:38:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:38:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:38:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:38:42 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 02:38:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mChartInfo 0.9320 0.9320 0.9320 0.9320 0.9260 0.9260[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.520
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.497
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.408
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.300
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.219
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.266
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.161
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.099
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.055
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.528
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.545
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.538
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.529
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.536


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.519802
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.447
SUFF_SIMPLE for r=0.05 class 0.0 = 0.787 +- 0.404 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.192 +- 0.404 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.05 all KL = 0.45 +- 0.404 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.05 all L1 = 0.457 +- 0.345 (in-sample avg dev_std = 0.058)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49693200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.449
SUFF_SIMPLE for r=0.1 class 0.0 = 0.783 +- 0.401 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.195 +- 0.401 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.1 all KL = 0.449 +- 0.401 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.1 all L1 = 0.457 +- 0.343 (in-sample avg dev_std = 0.111)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.407726
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.481
SUFF_SIMPLE for r=0.2 class 0.0 = 0.78 +- 0.402 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.257 +- 0.402 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.2 all KL = 0.49 +- 0.402 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.2 all L1 = 0.49 +- 0.346 (in-sample avg dev_std = 0.094)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.300044
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.474
SUFF_SIMPLE for r=0.4 class 0.0 = 0.762 +- 0.402 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.251 +- 0.402 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.4 all KL = 0.475 +- 0.402 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.4 all L1 = 0.479 +- 0.346 (in-sample avg dev_std = 0.064)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.218806
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.49
SUFF_SIMPLE for r=0.8 class 0.0 = 0.779 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.271 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.497 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.497 +- 0.354 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2663822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1609544
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0992264
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661854
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.054928
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5278546000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.611
SUFF_SIMPLE for r=0.05 class 0.0 = 0.769 +- 0.374 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.517 +- 0.374 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all KL = 0.684 +- 0.374 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all L1 = 0.644 +- 0.319 (in-sample avg dev_std = 0.139)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5454658
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.61
SUFF_SIMPLE for r=0.1 class 0.0 = 0.77 +- 0.369 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.529 +- 0.369 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.1 all KL = 0.694 +- 0.369 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.1 all L1 = 0.651 +- 0.315 (in-sample avg dev_std = 0.121)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5384985999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.62
SUFF_SIMPLE for r=0.2 class 0.0 = 0.756 +- 0.381 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.51 +- 0.381 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.2 all KL = 0.678 +- 0.381 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.2 all L1 = 0.635 +- 0.323 (in-sample avg dev_std = 0.111)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5286824000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.617
SUFF_SIMPLE for r=0.4 class 0.0 = 0.755 +- 0.384 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.505 +- 0.384 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.4 all KL = 0.676 +- 0.384 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.4 all L1 = 0.631 +- 0.326 (in-sample avg dev_std = 0.105)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.535523
len(reference) = 4947
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.666
SUFF_SIMPLE for r=0.8 class 0.0 = 0.869 +- 0.263 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.753 +- 0.263 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all KL = 0.869 +- 0.263 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all L1 = 0.811 +- 0.254 (in-sample avg dev_std = 0.005)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.519802
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.456
NEC for r=0.05 class 0.0 = 0.161 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.778 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.513 +- 0.416 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.503 +- 0.364 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.49693200000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.452
NEC for r=0.1 class 0.0 = 0.164 +- 0.411 (in-sample avg dev_std = 0.002)
NEC for r=0.1 class 1.0 = 0.782 +- 0.411 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all KL = 0.515 +- 0.411 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all L1 = 0.506 +- 0.358 (in-sample avg dev_std = 0.002)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.407726
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.447
NEC for r=0.2 class 0.0 = 0.187 +- 0.410 (in-sample avg dev_std = 0.051)
NEC for r=0.2 class 1.0 = 0.792 +- 0.410 (in-sample avg dev_std = 0.051)
NEC for r=0.2 all KL = 0.532 +- 0.410 (in-sample avg dev_std = 0.051)
NEC for r=0.2 all L1 = 0.522 +- 0.351 (in-sample avg dev_std = 0.051)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.300044
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.473
NEC for r=0.4 class 0.0 = 0.199 +- 0.404 (in-sample avg dev_std = 0.192)
NEC for r=0.4 class 1.0 = 0.782 +- 0.404 (in-sample avg dev_std = 0.192)
NEC for r=0.4 all KL = 0.531 +- 0.404 (in-sample avg dev_std = 0.192)
NEC for r=0.4 all L1 = 0.522 +- 0.344 (in-sample avg dev_std = 0.192)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.218806
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.486
NEC for r=0.8 class 0.0 = 0.215 +- 0.391 (in-sample avg dev_std = 0.251)
NEC for r=0.8 class 1.0 = 0.769 +- 0.391 (in-sample avg dev_std = 0.251)
NEC for r=0.8 all KL = 0.531 +- 0.391 (in-sample avg dev_std = 0.251)
NEC for r=0.8 all L1 = 0.522 +- 0.333 (in-sample avg dev_std = 0.251)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.2663822
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.005 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.165 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.058 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.085 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1609544
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.006 +- 0.137 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.163 +- 0.137 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.057 +- 0.137 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.085 +- 0.175 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0992264
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.006 +- 0.137 (in-sample avg dev_std = 0.002)
NEC for r=0.2 class 1.0 = 0.162 +- 0.137 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all KL = 0.057 +- 0.137 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all L1 = 0.085 +- 0.175 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661854
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.005 +- 0.146 (in-sample avg dev_std = 0.002)
NEC for r=0.4 class 1.0 = 0.167 +- 0.146 (in-sample avg dev_std = 0.002)
NEC for r=0.4 all KL = 0.061 +- 0.146 (in-sample avg dev_std = 0.002)
NEC for r=0.4 all L1 = 0.086 +- 0.179 (in-sample avg dev_std = 0.002)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.054928
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.005 +- 0.146 (in-sample avg dev_std = 0.001)
NEC for r=0.8 class 1.0 = 0.167 +- 0.146 (in-sample avg dev_std = 0.001)
NEC for r=0.8 all KL = 0.061 +- 0.146 (in-sample avg dev_std = 0.001)
NEC for r=0.8 all L1 = 0.086 +- 0.179 (in-sample avg dev_std = 0.001)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5278546000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.538
NEC for r=0.05 class 0.0 = 0.321 +- 0.396 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.597 +- 0.396 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.433 +- 0.396 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.457 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5454658
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.536
NEC for r=0.1 class 0.0 = 0.33 +- 0.393 (in-sample avg dev_std = 0.015)
NEC for r=0.1 class 1.0 = 0.606 +- 0.393 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all KL = 0.445 +- 0.393 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all L1 = 0.466 +- 0.347 (in-sample avg dev_std = 0.015)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5384985999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.527
NEC for r=0.2 class 0.0 = 0.339 +- 0.390 (in-sample avg dev_std = 0.079)
NEC for r=0.2 class 1.0 = 0.636 +- 0.390 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all KL = 0.474 +- 0.390 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all L1 = 0.486 +- 0.344 (in-sample avg dev_std = 0.079)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5286824000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.518
NEC for r=0.4 class 0.0 = 0.341 +- 0.391 (in-sample avg dev_std = 0.234)
NEC for r=0.4 class 1.0 = 0.653 +- 0.391 (in-sample avg dev_std = 0.234)
NEC for r=0.4 all KL = 0.488 +- 0.391 (in-sample avg dev_std = 0.234)
NEC for r=0.4 all L1 = 0.495 +- 0.339 (in-sample avg dev_std = 0.234)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.535523
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.537
NEC for r=0.8 class 0.0 = 0.321 +- 0.382 (in-sample avg dev_std = 0.377)
NEC for r=0.8 class 1.0 = 0.61 +- 0.382 (in-sample avg dev_std = 0.377)
NEC for r=0.8 all KL = 0.46 +- 0.382 (in-sample avg dev_std = 0.377)
NEC for r=0.8 all L1 = 0.464 +- 0.325 (in-sample avg dev_std = 0.377)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 02:53:55 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 02:53:56 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 02:53:56 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 02:53:56 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 02:53:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:53:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:53:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:53:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:53:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:53:56 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 02:53:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mChartInfo 0.9540 0.9540 0.9540 0.9540 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.523
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.545
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.492
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.418
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.361
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.345
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.225
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.146
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.102
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.087
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.556
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.592
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.607
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.612
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.609


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5233880000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.461
SUFF_SIMPLE for r=0.05 class 0.0 = 0.821 +- 0.427 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.173 +- 0.427 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.05 all KL = 0.407 +- 0.427 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.05 all L1 = 0.462 +- 0.353 (in-sample avg dev_std = 0.333)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5450740000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.465
SUFF_SIMPLE for r=0.1 class 0.0 = 0.821 +- 0.424 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.176 +- 0.424 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.1 all KL = 0.408 +- 0.424 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.1 all L1 = 0.464 +- 0.352 (in-sample avg dev_std = 0.350)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.49151599999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.456
SUFF_SIMPLE for r=0.2 class 0.0 = 0.816 +- 0.428 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.177 +- 0.428 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.2 all KL = 0.408 +- 0.428 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.2 all L1 = 0.462 +- 0.355 (in-sample avg dev_std = 0.314)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.41751
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.485
SUFF_SIMPLE for r=0.4 class 0.0 = 0.842 +- 0.441 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.214 +- 0.441 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.4 all KL = 0.454 +- 0.441 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.4 all L1 = 0.494 +- 0.371 (in-sample avg dev_std = 0.208)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.36093000000000003
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.552
SUFF_SIMPLE for r=0.8 class 0.0 = 0.847 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.313 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.525 +- 0.447 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.551 +- 0.381 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3449662
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.171 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.831 +- 0.171 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 all KL = 0.934 +- 0.171 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.014)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22476139999999994
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.1 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.015)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459654
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.171 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.83 +- 0.171 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.2 all KL = 0.934 +- 0.171 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.022)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10206439999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.4 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.003)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08663779999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5557373999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.618
SUFF_SIMPLE for r=0.05 class 0.0 = 0.787 +- 0.435 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.556 +- 0.435 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.05 all KL = 0.613 +- 0.435 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.05 all L1 = 0.673 +- 0.359 (in-sample avg dev_std = 0.310)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5918868
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.621
SUFF_SIMPLE for r=0.1 class 0.0 = 0.793 +- 0.436 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.575 +- 0.436 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.1 all KL = 0.641 +- 0.436 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.1 all L1 = 0.685 +- 0.367 (in-sample avg dev_std = 0.237)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6069532
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.629
SUFF_SIMPLE for r=0.2 class 0.0 = 0.802 +- 0.435 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.59 +- 0.435 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.2 all KL = 0.663 +- 0.435 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.2 all L1 = 0.697 +- 0.370 (in-sample avg dev_std = 0.187)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6120368
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.637
SUFF_SIMPLE for r=0.4 class 0.0 = 0.802 +- 0.431 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.605 +- 0.431 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.4 all KL = 0.675 +- 0.431 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.4 all L1 = 0.705 +- 0.370 (in-sample avg dev_std = 0.142)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6086604
len(reference) = 4961
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.739
SUFF_SIMPLE for r=0.8 class 0.0 = 0.897 +- 0.274 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.872 +- 0.274 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all KL = 0.889 +- 0.274 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all L1 = 0.885 +- 0.247 (in-sample avg dev_std = 0.001)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5233880000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.464
NEC for r=0.05 class 0.0 = 0.11 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.814 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.547 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.5 +- 0.381 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5450740000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.464
NEC for r=0.1 class 0.0 = 0.119 +- 0.450 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.822 +- 0.450 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.554 +- 0.450 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.509 +- 0.377 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.49151599999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.458
NEC for r=0.2 class 0.0 = 0.124 +- 0.450 (in-sample avg dev_std = 0.133)
NEC for r=0.2 class 1.0 = 0.826 +- 0.450 (in-sample avg dev_std = 0.133)
NEC for r=0.2 all KL = 0.56 +- 0.450 (in-sample avg dev_std = 0.133)
NEC for r=0.2 all L1 = 0.513 +- 0.376 (in-sample avg dev_std = 0.133)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.41751
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.473
NEC for r=0.4 class 0.0 = 0.133 +- 0.445 (in-sample avg dev_std = 0.270)
NEC for r=0.4 class 1.0 = 0.821 +- 0.445 (in-sample avg dev_std = 0.270)
NEC for r=0.4 all KL = 0.564 +- 0.445 (in-sample avg dev_std = 0.270)
NEC for r=0.4 all L1 = 0.514 +- 0.369 (in-sample avg dev_std = 0.270)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.36093000000000003
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.483
NEC for r=0.8 class 0.0 = 0.193 +- 0.421 (in-sample avg dev_std = 0.408)
NEC for r=0.8 class 1.0 = 0.797 +- 0.421 (in-sample avg dev_std = 0.408)
NEC for r=0.8 all KL = 0.59 +- 0.421 (in-sample avg dev_std = 0.408)
NEC for r=0.8 all L1 = 0.528 +- 0.342 (in-sample avg dev_std = 0.408)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3449662
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22476139999999994
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.002 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.169 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.066 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.1459654
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.008)
NEC for r=0.2 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.008)
NEC for r=0.2 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.008)
NEC for r=0.2 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.008)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10206439999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.002 +- 0.171 (in-sample avg dev_std = 0.011)
NEC for r=0.4 class 1.0 = 0.169 +- 0.171 (in-sample avg dev_std = 0.011)
NEC for r=0.4 all KL = 0.066 +- 0.171 (in-sample avg dev_std = 0.011)
NEC for r=0.4 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.011)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08663779999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.002 +- 0.171 (in-sample avg dev_std = 0.017)
NEC for r=0.8 class 1.0 = 0.169 +- 0.171 (in-sample avg dev_std = 0.017)
NEC for r=0.8 all KL = 0.066 +- 0.171 (in-sample avg dev_std = 0.017)
NEC for r=0.8 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.017)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5557373999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.534
NEC for r=0.05 class 0.0 = 0.327 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.742 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.61 +- 0.460 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.532 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5918868
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.509
NEC for r=0.1 class 0.0 = 0.334 +- 0.459 (in-sample avg dev_std = 0.058)
NEC for r=0.1 class 1.0 = 0.77 +- 0.459 (in-sample avg dev_std = 0.058)
NEC for r=0.1 all KL = 0.628 +- 0.459 (in-sample avg dev_std = 0.058)
NEC for r=0.1 all L1 = 0.549 +- 0.386 (in-sample avg dev_std = 0.058)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6069532
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.519
NEC for r=0.2 class 0.0 = 0.336 +- 0.455 (in-sample avg dev_std = 0.291)
NEC for r=0.2 class 1.0 = 0.764 +- 0.455 (in-sample avg dev_std = 0.291)
NEC for r=0.2 all KL = 0.632 +- 0.455 (in-sample avg dev_std = 0.291)
NEC for r=0.2 all L1 = 0.547 +- 0.377 (in-sample avg dev_std = 0.291)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6120368
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.558
NEC for r=0.4 class 0.0 = 0.32 +- 0.441 (in-sample avg dev_std = 0.473)
NEC for r=0.4 class 1.0 = 0.702 +- 0.441 (in-sample avg dev_std = 0.473)
NEC for r=0.4 all KL = 0.619 +- 0.441 (in-sample avg dev_std = 0.473)
NEC for r=0.4 all L1 = 0.509 +- 0.353 (in-sample avg dev_std = 0.473)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6086604
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.596
NEC for r=0.8 class 0.0 = 0.3 +- 0.407 (in-sample avg dev_std = 0.542)
NEC for r=0.8 class 1.0 = 0.609 +- 0.407 (in-sample avg dev_std = 0.542)
NEC for r=0.8 all KL = 0.588 +- 0.407 (in-sample avg dev_std = 0.542)
NEC for r=0.8 all L1 = 0.452 +- 0.321 (in-sample avg dev_std = 0.542)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 03:09:17 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 03:09:17 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 03:09:17 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 03:09:17 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 03:09:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 03:09:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 03:09:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 03:09:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 03:09:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 03:09:17 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 03:09:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mChartInfo 0.9680 0.9680 0.9680 0.9680 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.570
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.615
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.591
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.537
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.487
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.427
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.297
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.204
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.151
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.132
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.577
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.617
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.634
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.638
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.637


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.570182
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.535
SUFF_SIMPLE for r=0.05 class 0.0 = 0.589 +- 0.407 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.437 +- 0.407 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.05 all KL = 0.395 +- 0.407 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.05 all L1 = 0.505 +- 0.331 (in-sample avg dev_std = 0.569)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6153200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.537
SUFF_SIMPLE for r=0.1 class 0.0 = 0.58 +- 0.425 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.464 +- 0.425 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.1 all KL = 0.42 +- 0.425 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.1 all L1 = 0.516 +- 0.344 (in-sample avg dev_std = 0.543)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.591372
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.51
SUFF_SIMPLE for r=0.2 class 0.0 = 0.584 +- 0.429 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.445 +- 0.429 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.2 all KL = 0.42 +- 0.429 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.2 all L1 = 0.507 +- 0.353 (in-sample avg dev_std = 0.479)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537098
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.506
SUFF_SIMPLE for r=0.4 class 0.0 = 0.631 +- 0.443 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.405 +- 0.443 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.4 all KL = 0.435 +- 0.443 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.4 all L1 = 0.506 +- 0.365 (in-sample avg dev_std = 0.400)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.486506
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.588
SUFF_SIMPLE for r=0.8 class 0.0 = 0.836 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.409 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.565 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.6 +- 0.388 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4265934
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
SUFF_SIMPLE for r=0.05 class 0.0 = 0.99 +- 0.231 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.831 +- 0.231 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.05 all KL = 0.907 +- 0.231 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.212 (in-sample avg dev_std = 0.147)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.296979
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
SUFF_SIMPLE for r=0.1 class 0.0 = 0.986 +- 0.243 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.828 +- 0.243 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.1 all KL = 0.898 +- 0.243 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.1 all L1 = 0.906 +- 0.214 (in-sample avg dev_std = 0.167)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.204242
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.495
SUFF_SIMPLE for r=0.2 class 0.0 = 0.974 +- 0.264 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.825 +- 0.264 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 all KL = 0.884 +- 0.264 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 all L1 = 0.899 +- 0.220 (in-sample avg dev_std = 0.197)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1510458
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.491
SUFF_SIMPLE for r=0.4 class 0.0 = 0.96 +- 0.280 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.821 +- 0.280 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 all KL = 0.876 +- 0.280 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 all L1 = 0.89 +- 0.235 (in-sample avg dev_std = 0.211)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1320686
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.836 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.928 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.917 +- 0.212 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5766038
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.664
SUFF_SIMPLE for r=0.05 class 0.0 = 0.699 +- 0.410 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.82 +- 0.410 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.05 all KL = 0.707 +- 0.410 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.05 all L1 = 0.759 +- 0.335 (in-sample avg dev_std = 0.358)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6165012
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.668
SUFF_SIMPLE for r=0.1 class 0.0 = 0.699 +- 0.403 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.83 +- 0.403 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.1 all KL = 0.727 +- 0.403 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.1 all L1 = 0.763 +- 0.342 (in-sample avg dev_std = 0.277)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6341762000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.656
SUFF_SIMPLE for r=0.2 class 0.0 = 0.714 +- 0.414 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.788 +- 0.414 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.2 all KL = 0.716 +- 0.414 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.2 all L1 = 0.751 +- 0.353 (in-sample avg dev_std = 0.220)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6379336
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.654
SUFF_SIMPLE for r=0.4 class 0.0 = 0.715 +- 0.431 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.722 +- 0.431 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.4 all KL = 0.682 +- 0.431 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.4 all L1 = 0.719 +- 0.369 (in-sample avg dev_std = 0.173)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6368773999999999
len(reference) = 4936
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.748
SUFF_SIMPLE for r=0.8 class 0.0 = 0.869 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.907 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.884 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.888 +- 0.259 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.570182
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.54
NEC for r=0.05 class 0.0 = 0.081 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.701 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.47 +- 0.470 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.424 +- 0.398 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6153200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.486
NEC for r=0.1 class 0.0 = 0.079 +- 0.473 (in-sample avg dev_std = 0.002)
NEC for r=0.1 class 1.0 = 0.782 +- 0.473 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all KL = 0.524 +- 0.473 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all L1 = 0.468 +- 0.397 (in-sample avg dev_std = 0.002)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.591372
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.524
NEC for r=0.2 class 0.0 = 0.092 +- 0.457 (in-sample avg dev_std = 0.390)
NEC for r=0.2 class 1.0 = 0.76 +- 0.457 (in-sample avg dev_std = 0.390)
NEC for r=0.2 all KL = 0.536 +- 0.457 (in-sample avg dev_std = 0.390)
NEC for r=0.2 all L1 = 0.462 +- 0.374 (in-sample avg dev_std = 0.390)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.537098
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.633
NEC for r=0.4 class 0.0 = 0.124 +- 0.419 (in-sample avg dev_std = 0.537)
NEC for r=0.4 class 1.0 = 0.625 +- 0.419 (in-sample avg dev_std = 0.537)
NEC for r=0.4 all KL = 0.5 +- 0.419 (in-sample avg dev_std = 0.537)
NEC for r=0.4 all L1 = 0.402 +- 0.332 (in-sample avg dev_std = 0.537)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.486506
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.71
NEC for r=0.8 class 0.0 = 0.234 +- 0.373 (in-sample avg dev_std = 0.614)
NEC for r=0.8 class 1.0 = 0.486 +- 0.373 (in-sample avg dev_std = 0.614)
NEC for r=0.8 all KL = 0.494 +- 0.373 (in-sample avg dev_std = 0.614)
NEC for r=0.8 all L1 = 0.373 +- 0.280 (in-sample avg dev_std = 0.614)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4265934
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.163 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.072 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.083 +- 0.212 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.296979
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.495
NEC for r=0.1 class 0.0 = 0.003 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.162 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.072 +- 0.204 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.084 +- 0.212 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.204242
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
NEC for r=0.2 class 0.0 = 0.005 +- 0.212 (in-sample avg dev_std = 0.065)
NEC for r=0.2 class 1.0 = 0.166 +- 0.212 (in-sample avg dev_std = 0.065)
NEC for r=0.2 all KL = 0.079 +- 0.212 (in-sample avg dev_std = 0.065)
NEC for r=0.2 all L1 = 0.086 +- 0.213 (in-sample avg dev_std = 0.065)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1510458
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.509
NEC for r=0.4 class 0.0 = 0.012 +- 0.232 (in-sample avg dev_std = 0.202)
NEC for r=0.4 class 1.0 = 0.178 +- 0.232 (in-sample avg dev_std = 0.202)
NEC for r=0.4 all KL = 0.108 +- 0.232 (in-sample avg dev_std = 0.202)
NEC for r=0.4 all L1 = 0.096 +- 0.208 (in-sample avg dev_std = 0.202)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1320686
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.503
NEC for r=0.8 class 0.0 = 0.004 +- 0.211 (in-sample avg dev_std = 0.134)
NEC for r=0.8 class 1.0 = 0.168 +- 0.211 (in-sample avg dev_std = 0.134)
NEC for r=0.8 all KL = 0.082 +- 0.211 (in-sample avg dev_std = 0.134)
NEC for r=0.8 all L1 = 0.087 +- 0.209 (in-sample avg dev_std = 0.134)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5766038
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.538
NEC for r=0.05 class 0.0 = 0.337 +- 0.473 (in-sample avg dev_std = 0.047)
NEC for r=0.05 class 1.0 = 0.702 +- 0.473 (in-sample avg dev_std = 0.047)
NEC for r=0.05 all KL = 0.598 +- 0.473 (in-sample avg dev_std = 0.047)
NEC for r=0.05 all L1 = 0.517 +- 0.399 (in-sample avg dev_std = 0.047)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6165012
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.541
NEC for r=0.1 class 0.0 = 0.34 +- 0.466 (in-sample avg dev_std = 0.235)
NEC for r=0.1 class 1.0 = 0.709 +- 0.466 (in-sample avg dev_std = 0.235)
NEC for r=0.1 all KL = 0.612 +- 0.466 (in-sample avg dev_std = 0.235)
NEC for r=0.1 all L1 = 0.522 +- 0.391 (in-sample avg dev_std = 0.235)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6341762000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.559
NEC for r=0.2 class 0.0 = 0.314 +- 0.451 (in-sample avg dev_std = 0.452)
NEC for r=0.2 class 1.0 = 0.658 +- 0.451 (in-sample avg dev_std = 0.452)
NEC for r=0.2 all KL = 0.597 +- 0.451 (in-sample avg dev_std = 0.452)
NEC for r=0.2 all L1 = 0.484 +- 0.370 (in-sample avg dev_std = 0.452)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6379336
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.604
NEC for r=0.4 class 0.0 = 0.271 +- 0.427 (in-sample avg dev_std = 0.548)
NEC for r=0.4 class 1.0 = 0.542 +- 0.427 (in-sample avg dev_std = 0.548)
NEC for r=0.4 all KL = 0.537 +- 0.427 (in-sample avg dev_std = 0.548)
NEC for r=0.4 all L1 = 0.405 +- 0.343 (in-sample avg dev_std = 0.548)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6368773999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.663
NEC for r=0.8 class 0.0 = 0.288 +- 0.397 (in-sample avg dev_std = 0.571)
NEC for r=0.8 class 1.0 = 0.379 +- 0.397 (in-sample avg dev_std = 0.571)
NEC for r=0.8 all KL = 0.472 +- 0.397 (in-sample avg dev_std = 0.571)
NEC for r=0.8 all L1 = 0.333 +- 0.307 (in-sample avg dev_std = 0.571)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.424, 0.439, 0.453, 0.455, 0.506], 'all_L1': [0.495, 0.502, 0.51, 0.498, 0.534]}), defaultdict(<class 'list'>, {'all_KL': [0.383, 0.396, 0.398, 0.424, 0.537], 'all_L1': [0.473, 0.484, 0.48, 0.487, 0.578]}), defaultdict(<class 'list'>, {'all_KL': [0.42, 0.417, 0.433, 0.456, 0.543], 'all_L1': [0.494, 0.491, 0.505, 0.508, 0.575]}), defaultdict(<class 'list'>, {'all_KL': [0.414, 0.417, 0.426, 0.429, 0.529], 'all_L1': [0.47, 0.467, 0.473, 0.474, 0.561]}), defaultdict(<class 'list'>, {'all_KL': [0.414, 0.43, 0.433, 0.432, 0.526], 'all_L1': [0.468, 0.478, 0.479, 0.475, 0.554]}), defaultdict(<class 'list'>, {'all_KL': [0.435, 0.429, 0.471, 0.442, 0.48], 'all_L1': [0.471, 0.466, 0.501, 0.475, 0.504]}), defaultdict(<class 'list'>, {'all_KL': [0.441, 0.436, 0.45, 0.44, 0.53], 'all_L1': [0.495, 0.495, 0.508, 0.491, 0.56]}), defaultdict(<class 'list'>, {'all_KL': [0.45, 0.449, 0.49, 0.475, 0.497], 'all_L1': [0.457, 0.457, 0.49, 0.479, 0.497]}), defaultdict(<class 'list'>, {'all_KL': [0.407, 0.408, 0.408, 0.454, 0.525], 'all_L1': [0.462, 0.464, 0.462, 0.494, 0.551]}), defaultdict(<class 'list'>, {'all_KL': [0.395, 0.42, 0.42, 0.435, 0.565], 'all_L1': [0.505, 0.516, 0.507, 0.506, 0.6]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.489, 0.532, 0.525, 0.471, 0.497], 'all_L1': [0.447, 0.487, 0.475, 0.415, 0.428]}), defaultdict(<class 'list'>, {'all_KL': [0.565, 0.573, 0.588, 0.609, 0.613], 'all_L1': [0.501, 0.51, 0.51, 0.508, 0.493]}), defaultdict(<class 'list'>, {'all_KL': [0.532, 0.543, 0.561, 0.569, 0.572], 'all_L1': [0.478, 0.488, 0.5, 0.492, 0.472]}), defaultdict(<class 'list'>, {'all_KL': [0.548, 0.558, 0.559, 0.557, 0.57], 'all_L1': [0.497, 0.505, 0.503, 0.497, 0.495]}), defaultdict(<class 'list'>, {'all_KL': [0.547, 0.542, 0.548, 0.56, 0.561], 'all_L1': [0.502, 0.495, 0.499, 0.507, 0.496]}), defaultdict(<class 'list'>, {'all_KL': [0.532, 0.541, 0.546, 0.551, 0.548], 'all_L1': [0.497, 0.507, 0.514, 0.518, 0.514]}), defaultdict(<class 'list'>, {'all_KL': [0.542, 0.54, 0.542, 0.548, 0.536], 'all_L1': [0.491, 0.487, 0.492, 0.493, 0.471]}), defaultdict(<class 'list'>, {'all_KL': [0.513, 0.515, 0.532, 0.531, 0.531], 'all_L1': [0.503, 0.506, 0.522, 0.522, 0.522]}), defaultdict(<class 'list'>, {'all_KL': [0.547, 0.554, 0.56, 0.564, 0.59], 'all_L1': [0.5, 0.509, 0.513, 0.514, 0.528]}), defaultdict(<class 'list'>, {'all_KL': [0.47, 0.524, 0.536, 0.5, 0.494], 'all_L1': [0.424, 0.468, 0.462, 0.402, 0.373]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.932, 0.929, 0.926, 0.922, 0.936], 'all_L1': [0.918, 0.916, 0.916, 0.913, 0.919]}), defaultdict(<class 'list'>, {'all_KL': [0.904, 0.905, 0.909, 0.911, 0.913], 'all_L1': [0.9, 0.9, 0.902, 0.903, 0.903]}), defaultdict(<class 'list'>, {'all_KL': [0.928, 0.928, 0.928, 0.928, 0.928], 'all_L1': [0.921, 0.921, 0.921, 0.921, 0.921]}), defaultdict(<class 'list'>, {'all_KL': [0.953, 0.953, 0.953, 0.953, 0.953], 'all_L1': [0.944, 0.944, 0.944, 0.944, 0.944]}), defaultdict(<class 'list'>, {'all_KL': [0.926, 0.926, 0.926, 0.926, 0.926], 'all_L1': [0.91, 0.91, 0.91, 0.91, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.968, 0.968, 0.968, 0.968, 0.968], 'all_L1': [0.954, 0.954, 0.954, 0.954, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.964, 0.964, 0.964, 0.964, 0.964], 'all_L1': [0.954, 0.954, 0.954, 0.954, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.939, 0.939, 0.939, 0.939, 0.939], 'all_L1': [0.914, 0.914, 0.914, 0.914, 0.914]}), defaultdict(<class 'list'>, {'all_KL': [0.934, 0.934, 0.934, 0.934, 0.934], 'all_L1': [0.914, 0.914, 0.914, 0.914, 0.914]}), defaultdict(<class 'list'>, {'all_KL': [0.907, 0.898, 0.884, 0.876, 0.928], 'all_L1': [0.91, 0.906, 0.899, 0.89, 0.917]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.063, 0.063, 0.064, 0.084, 0.066], 'all_L1': [0.081, 0.081, 0.082, 0.089, 0.082]}), defaultdict(<class 'list'>, {'all_KL': [0.088, 0.09, 0.096, 0.108, 0.102], 'all_L1': [0.097, 0.098, 0.101, 0.105, 0.102]}), defaultdict(<class 'list'>, {'all_KL': [0.077, 0.079, 0.087, 0.087, 0.079], 'all_L1': [0.083, 0.084, 0.088, 0.085, 0.081]}), defaultdict(<class 'list'>, {'all_KL': [0.047, 0.046, 0.047, 0.048, 0.047], 'all_L1': [0.056, 0.056, 0.056, 0.057, 0.056]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.071, 0.073, 0.076, 0.074], 'all_L1': [0.09, 0.09, 0.09, 0.091, 0.09]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.031, 0.031, 0.032, 0.032], 'all_L1': [0.046, 0.046, 0.046, 0.046, 0.046]}), defaultdict(<class 'list'>, {'all_KL': [0.036, 0.036, 0.036, 0.036, 0.037], 'all_L1': [0.046, 0.046, 0.046, 0.046, 0.046]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.057, 0.057, 0.061, 0.061], 'all_L1': [0.085, 0.085, 0.085, 0.086, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.066, 0.066, 0.066, 0.066, 0.066], 'all_L1': [0.086, 0.086, 0.086, 0.086, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.072, 0.079, 0.108, 0.082], 'all_L1': [0.083, 0.084, 0.086, 0.096, 0.087]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.692, 0.705, 0.717, 0.685, 0.875], 'all_L1': [0.727, 0.731, 0.734, 0.699, 0.862]}), defaultdict(<class 'list'>, {'all_KL': [0.502, 0.557, 0.614, 0.655, 0.865], 'all_L1': [0.629, 0.654, 0.679, 0.698, 0.871]}), defaultdict(<class 'list'>, {'all_KL': [0.66, 0.665, 0.671, 0.67, 0.863], 'all_L1': [0.694, 0.693, 0.697, 0.696, 0.858]}), defaultdict(<class 'list'>, {'all_KL': [0.502, 0.534, 0.573, 0.592, 0.826], 'all_L1': [0.6, 0.617, 0.641, 0.647, 0.834]}), defaultdict(<class 'list'>, {'all_KL': [0.557, 0.609, 0.655, 0.669, 0.872], 'all_L1': [0.615, 0.647, 0.676, 0.686, 0.859]}), defaultdict(<class 'list'>, {'all_KL': [0.679, 0.696, 0.709, 0.719, 0.893], 'all_L1': [0.715, 0.719, 0.719, 0.723, 0.874]}), defaultdict(<class 'list'>, {'all_KL': [0.704, 0.699, 0.683, 0.69, 0.879], 'all_L1': [0.725, 0.722, 0.709, 0.714, 0.874]}), defaultdict(<class 'list'>, {'all_KL': [0.684, 0.694, 0.678, 0.676, 0.869], 'all_L1': [0.644, 0.651, 0.635, 0.631, 0.811]}), defaultdict(<class 'list'>, {'all_KL': [0.613, 0.641, 0.663, 0.675, 0.889], 'all_L1': [0.673, 0.685, 0.697, 0.705, 0.885]}), defaultdict(<class 'list'>, {'all_KL': [0.707, 0.727, 0.716, 0.682, 0.884], 'all_L1': [0.759, 0.763, 0.751, 0.719, 0.888]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.557, 0.572, 0.546, 0.45, 0.377], 'all_L1': [0.507, 0.517, 0.486, 0.399, 0.326]}), defaultdict(<class 'list'>, {'all_KL': [0.622, 0.627, 0.63, 0.622, 0.62], 'all_L1': [0.535, 0.538, 0.528, 0.485, 0.44]}), defaultdict(<class 'list'>, {'all_KL': [0.574, 0.586, 0.596, 0.58, 0.543], 'all_L1': [0.516, 0.522, 0.513, 0.474, 0.419]}), defaultdict(<class 'list'>, {'all_KL': [0.608, 0.616, 0.614, 0.591, 0.599], 'all_L1': [0.528, 0.535, 0.529, 0.499, 0.484]}), defaultdict(<class 'list'>, {'all_KL': [0.579, 0.587, 0.589, 0.575, 0.583], 'all_L1': [0.517, 0.521, 0.52, 0.504, 0.489]}), defaultdict(<class 'list'>, {'all_KL': [0.576, 0.592, 0.592, 0.572, 0.55], 'all_L1': [0.527, 0.542, 0.539, 0.509, 0.461]}), defaultdict(<class 'list'>, {'all_KL': [0.624, 0.63, 0.627, 0.61, 0.579], 'all_L1': [0.553, 0.559, 0.551, 0.518, 0.466]}), defaultdict(<class 'list'>, {'all_KL': [0.433, 0.445, 0.474, 0.488, 0.46], 'all_L1': [0.457, 0.466, 0.486, 0.495, 0.464]}), defaultdict(<class 'list'>, {'all_KL': [0.61, 0.628, 0.632, 0.619, 0.588], 'all_L1': [0.532, 0.549, 0.547, 0.509, 0.452]}), defaultdict(<class 'list'>, {'all_KL': [0.598, 0.612, 0.597, 0.537, 0.472], 'all_L1': [0.517, 0.522, 0.484, 0.405, 0.333]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.479 +- 0.016, 0.482 +- 0.018, 0.491 +- 0.016, 0.489 +- 0.012, 0.551 +- 0.031
suff_simple class all_KL  =  0.418 +- 0.019, 0.424 +- 0.015, 0.438 +- 0.027, 0.444 +- 0.015, 0.524 +- 0.023
[[0.5182499885559082, 0.5040000081062317, 0.5055000185966492, 0.47749999165534973, 0.5199999809265137], [0.4962500035762787, 0.5055000185966492, 0.49125000834465027, 0.484499990940094, 0.5720000267028809], [0.5052499771118164, 0.49825000762939453, 0.515500009059906, 0.5, 0.5559999942779541], [0.46050000190734863, 0.453249990940094, 0.45750001072883606, 0.45124998688697815, 0.5600000023841858], [0.45899999141693115, 0.4715000092983246, 0.4699999988079071, 0.4542500078678131, 0.5460000038146973], [0.45225000381469727, 0.44449999928474426, 0.4857499897480011, 0.44999998807907104, 0.47999998927116394], [0.4827499985694885, 0.48774999380111694, 0.5102499723434448, 0.46875, 0.5400000214576721], [0.44699999690055847, 0.4490000009536743, 0.4814999997615814, 0.4742499887943268, 0.49000000953674316], [0.460999995470047, 0.4645000100135803, 0.45649999380111694, 0.48524999618530273, 0.5519999861717224], [0.5352500081062317, 0.5370000004768372, 0.5102499723434448, 0.5059999823570251, 0.5879999995231628]]
[[0.424, 0.439, 0.453, 0.455, 0.506], [0.383, 0.396, 0.398, 0.424, 0.537], [0.42, 0.417, 0.433, 0.456, 0.543], [0.414, 0.417, 0.426, 0.429, 0.529], [0.414, 0.43, 0.433, 0.432, 0.526], [0.435, 0.429, 0.471, 0.442, 0.48], [0.441, 0.436, 0.45, 0.44, 0.53], [0.45, 0.449, 0.49, 0.475, 0.497], [0.407, 0.408, 0.408, 0.454, 0.525], [0.395, 0.42, 0.42, 0.435, 0.565]]
suff_simple_acc_int  =  0.482 +- 0.029, 0.482 +- 0.028, 0.488 +- 0.021, 0.475 +- 0.019, 0.540 +- 0.033
nec class all_L1  =  0.484 +- 0.026, 0.496 +- 0.013, 0.499 +- 0.018, 0.487 +- 0.040, 0.479 +- 0.045
nec class all_KL  =  0.528 +- 0.028, 0.542 +- 0.016, 0.550 +- 0.017, 0.546 +- 0.036, 0.551 +- 0.036
[[0.5320000052452087, 0.4659999907016754, 0.5102499723434448, 0.6159999966621399, 0.6330000162124634], [0.4659999907016754, 0.4519999921321869, 0.4805000126361847, 0.5102499723434448, 0.5609999895095825], [0.47200000286102295, 0.46024999022483826, 0.4672499895095825, 0.503000020980835, 0.5697500109672546], [0.4580000042915344, 0.4480000138282776, 0.4597499966621399, 0.48750001192092896, 0.5317500233650208], [0.44200000166893005, 0.46399998664855957, 0.4597499966621399, 0.4702500104904175, 0.5277500152587891], [0.46799999475479126, 0.44600000977516174, 0.44624999165534973, 0.45649999380111694, 0.4794999957084656], [0.4480000138282776, 0.44999998807907104, 0.4547500014305115, 0.476749986410141, 0.546750009059906], [0.4560000002384186, 0.4519999921321869, 0.44699999690055847, 0.47325000166893005, 0.48649999499320984], [0.46399998664855957, 0.46399998664855957, 0.45774999260902405, 0.4729999899864197, 0.4832499921321869], [0.5400000214576721, 0.4860000014305115, 0.5239999890327454, 0.6327499747276306, 0.7097499966621399]]
[[0.489, 0.532, 0.525, 0.471, 0.497], [0.565, 0.573, 0.588, 0.609, 0.613], [0.532, 0.543, 0.561, 0.569, 0.572], [0.548, 0.558, 0.559, 0.557, 0.57], [0.547, 0.542, 0.548, 0.56, 0.561], [0.532, 0.541, 0.546, 0.551, 0.548], [0.542, 0.54, 0.542, 0.548, 0.536], [0.513, 0.515, 0.532, 0.531, 0.531], [0.547, 0.554, 0.56, 0.564, 0.59], [0.47, 0.524, 0.536, 0.5, 0.494]]
nec_acc_int  =  0.475 +- 0.032, 0.459 +- 0.011, 0.471 +- 0.025, 0.510 +- 0.059, 0.553 +- 0.069

Eval split val
suff_simple class all_L1  =  0.924 +- 0.018, 0.923 +- 0.019, 0.923 +- 0.019, 0.922 +- 0.021, 0.925 +- 0.018
suff_simple class all_KL  =  0.935 +- 0.020, 0.934 +- 0.022, 0.933 +- 0.024, 0.932 +- 0.026, 0.939 +- 0.017
[[0.4969249963760376, 0.4964500069618225, 0.4955500066280365, 0.49412500858306885, 0.4959999918937683], [0.4991750121116638, 0.4987500011920929, 0.4977250099182129, 0.49595001339912415, 0.4959999918937683], [0.49662500619888306, 0.4963499903678894, 0.49617499113082886, 0.4959999918937683, 0.4959999918937683], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4959999918937683, 0.4961250126361847, 0.49607500433921814, 0.4960249960422516, 0.4959999918937683], [0.4986000061035156, 0.4982750117778778, 0.4947749972343445, 0.4910750091075897, 0.4959999918937683]]
[[0.932, 0.929, 0.926, 0.922, 0.936], [0.904, 0.905, 0.909, 0.911, 0.913], [0.928, 0.928, 0.928, 0.928, 0.928], [0.953, 0.953, 0.953, 0.953, 0.953], [0.926, 0.926, 0.926, 0.926, 0.926], [0.968, 0.968, 0.968, 0.968, 0.968], [0.964, 0.964, 0.964, 0.964, 0.964], [0.939, 0.939, 0.939, 0.939, 0.939], [0.934, 0.934, 0.934, 0.934, 0.934], [0.907, 0.898, 0.884, 0.876, 0.928]]
suff_simple_acc_int  =  0.497 +- 0.001, 0.497 +- 0.001, 0.496 +- 0.001, 0.495 +- 0.002, 0.496 +- 0.000
nec class all_L1  =  0.075 +- 0.018, 0.076 +- 0.018, 0.077 +- 0.019, 0.079 +- 0.020, 0.076 +- 0.019
nec class all_KL  =  0.061 +- 0.017, 0.061 +- 0.018, 0.064 +- 0.020, 0.071 +- 0.026, 0.065 +- 0.020
[[0.4959999918937683, 0.4959999918937683, 0.4961499869823456, 0.5062249898910522, 0.499224990606308], [0.49900001287460327, 0.49799999594688416, 0.5010250210762024, 0.5033000111579895, 0.505424976348877], [0.4952000081539154, 0.5016000270843506, 0.5051500201225281, 0.4991750121116638, 0.5015000104904175], [0.4959999918937683, 0.49619999527931213, 0.4957999885082245, 0.4961000084877014, 0.49617499113082886], [0.49639999866485596, 0.49619999527931213, 0.4959999918937683, 0.4960249960422516, 0.49607500433921814], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4957999885082245, 0.4959999918937683, 0.4959999918937683, 0.4961000084877014, 0.49619999527931213], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4959999918937683, 0.4959999918937683, 0.49597498774528503, 0.4960249960422516, 0.49607500433921814], [0.49559998512268066, 0.4952000081539154, 0.4984250068664551, 0.5088750123977661, 0.5027999877929688]]
[[0.063, 0.063, 0.064, 0.084, 0.066], [0.088, 0.09, 0.096, 0.108, 0.102], [0.077, 0.079, 0.087, 0.087, 0.079], [0.047, 0.046, 0.047, 0.048, 0.047], [0.072, 0.071, 0.073, 0.076, 0.074], [0.031, 0.031, 0.031, 0.032, 0.032], [0.036, 0.036, 0.036, 0.036, 0.037], [0.058, 0.057, 0.057, 0.061, 0.061], [0.066, 0.066, 0.066, 0.066, 0.066], [0.072, 0.072, 0.079, 0.108, 0.082]]
nec_acc_int  =  0.496 +- 0.001, 0.497 +- 0.002, 0.498 +- 0.003, 0.499 +- 0.005, 0.499 +- 0.003

Eval split test
suff_simple class all_L1  =  0.678 +- 0.051, 0.688 +- 0.043, 0.694 +- 0.035, 0.692 +- 0.029, 0.862 +- 0.022
suff_simple class all_KL  =  0.630 +- 0.077, 0.653 +- 0.063, 0.668 +- 0.043, 0.671 +- 0.031, 0.871 +- 0.018
[[0.6584200263023376, 0.6650490164756775, 0.65799480676651, 0.6448369026184082, 0.7282935380935669], [0.6056634187698364, 0.6111166477203369, 0.6112667322158813, 0.6200970411300659, 0.7066125869750977], [0.6521913409233093, 0.6499399542808533, 0.6556183695793152, 0.6525415182113647, 0.7340831756591797], [0.5957074165344238, 0.5960075855255127, 0.590679407119751, 0.5852011442184448, 0.6686819791793823], [0.6176455616950989, 0.6232990026473999, 0.6212977766990662, 0.6252251267433167, 0.7048386931419373], [0.6359565854072571, 0.6334050297737122, 0.6358065009117126, 0.6369321346282959, 0.699353039264679], [0.6540924310684204, 0.6554682850837708, 0.6484891176223755, 0.6523914337158203, 0.723792314529419], [0.6108665466308594, 0.6096407771110535, 0.6195467114448547, 0.6165949702262878, 0.6659086346626282], [0.6179957985877991, 0.6210976839065552, 0.6292775869369507, 0.6365318894386292, 0.7387623190879822], [0.6642235517501831, 0.6677506566047668, 0.6561436653137207, 0.6540924310684204, 0.7483792304992676]]
[[0.692, 0.705, 0.717, 0.685, 0.875], [0.502, 0.557, 0.614, 0.655, 0.865], [0.66, 0.665, 0.671, 0.67, 0.863], [0.502, 0.534, 0.573, 0.592, 0.826], [0.557, 0.609, 0.655, 0.669, 0.872], [0.679, 0.696, 0.709, 0.719, 0.893], [0.704, 0.699, 0.683, 0.69, 0.879], [0.684, 0.694, 0.678, 0.676, 0.869], [0.613, 0.641, 0.663, 0.675, 0.889], [0.707, 0.727, 0.716, 0.682, 0.884]]
suff_simple_acc_int  =  0.631 +- 0.023, 0.633 +- 0.024, 0.633 +- 0.021, 0.632 +- 0.020, 0.712 +- 0.027
nec class all_L1  =  0.519 +- 0.024, 0.527 +- 0.024, 0.518 +- 0.024, 0.480 +- 0.041, 0.433 +- 0.055
nec class all_KL  =  0.578 +- 0.053, 0.590 +- 0.052, 0.590 +- 0.046, 0.564 +- 0.054, 0.537 +- 0.073
[[0.5499299764633179, 0.5384981036186218, 0.5475285053253174, 0.6017610430717468, 0.662722647190094], [0.5177856683731079, 0.5154092311859131, 0.5424004197120667, 0.594731867313385, 0.6321292519569397], [0.5238643288612366, 0.5273663997650146, 0.5585101246833801, 0.5999349355697632, 0.6431359052658081], [0.517310380935669, 0.5105063319206238, 0.5238392949104309, 0.5571593046188354, 0.5860015749931335], [0.5219131708145142, 0.5196368098258972, 0.5273663997650146, 0.553231954574585, 0.5840754508972168], [0.5355213284492493, 0.5196868181228638, 0.5114818811416626, 0.5400740504264832, 0.596532940864563], [0.5147088170051575, 0.5130327939987183, 0.5163097977638245, 0.5476035475730896, 0.5836251974105835], [0.5383229851722717, 0.536121666431427, 0.5272413492202759, 0.51768559217453, 0.537447452545166], [0.5337202548980713, 0.5090054273605347, 0.519011378288269, 0.5580348372459412, 0.5961576700210571], [0.5380228161811829, 0.5409745573997498, 0.5588603019714355, 0.6040124297142029, 0.6630478501319885]]
[[0.557, 0.572, 0.546, 0.45, 0.377], [0.622, 0.627, 0.63, 0.622, 0.62], [0.574, 0.586, 0.596, 0.58, 0.543], [0.608, 0.616, 0.614, 0.591, 0.599], [0.579, 0.587, 0.589, 0.575, 0.583], [0.576, 0.592, 0.592, 0.572, 0.55], [0.624, 0.63, 0.627, 0.61, 0.579], [0.433, 0.445, 0.474, 0.488, 0.46], [0.61, 0.628, 0.632, 0.619, 0.588], [0.598, 0.612, 0.597, 0.537, 0.472]]
nec_acc_int  =  0.529 +- 0.011, 0.523 +- 0.011, 0.533 +- 0.016, 0.567 +- 0.029, 0.608 +- 0.038


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.481 +- 0.008, 0.489 +- 0.004, 0.495 +- 0.008, 0.488 +- 0.017, 0.515 +- 0.018
Faith. Armon (L1)= 		  =  0.481 +- 0.009, 0.489 +- 0.005, 0.495 +- 0.008, 0.486 +- 0.019, 0.510 +- 0.024
Faith. GMean (L1)= 	  =  0.481 +- 0.008, 0.489 +- 0.004, 0.495 +- 0.008, 0.487 +- 0.018, 0.513 +- 0.021
Faith. Aritm (KL)= 		  =  0.473 +- 0.016, 0.483 +- 0.004, 0.494 +- 0.010, 0.495 +- 0.017, 0.537 +- 0.022
Faith. Armon (KL)= 		  =  0.466 +- 0.016, 0.475 +- 0.006, 0.487 +- 0.013, 0.489 +- 0.014, 0.536 +- 0.022
Faith. GMean (KL)= 	  =  0.470 +- 0.016, 0.479 +- 0.005, 0.490 +- 0.011, 0.492 +- 0.015, 0.537 +- 0.022

Eval split val
Faith. Aritm (L1)= 		  =  0.500 +- 0.001, 0.499 +- 0.002, 0.500 +- 0.003, 0.500 +- 0.003, 0.501 +- 0.001
Faith. Armon (L1)= 		  =  0.139 +- 0.031, 0.139 +- 0.031, 0.141 +- 0.032, 0.144 +- 0.034, 0.140 +- 0.032
Faith. GMean (L1)= 	  =  0.261 +- 0.031, 0.262 +- 0.031, 0.263 +- 0.032, 0.266 +- 0.034, 0.263 +- 0.032
Faith. Aritm (KL)= 		  =  0.498 +- 0.003, 0.498 +- 0.005, 0.498 +- 0.006, 0.501 +- 0.005, 0.502 +- 0.003
Faith. Armon (KL)= 		  =  0.114 +- 0.031, 0.114 +- 0.031, 0.118 +- 0.035, 0.130 +- 0.044, 0.120 +- 0.036
Faith. GMean (KL)= 	  =  0.236 +- 0.033, 0.236 +- 0.034, 0.240 +- 0.038, 0.251 +- 0.045, 0.243 +- 0.038

Eval split test
Faith. Aritm (L1)= 		  =  0.599 +- 0.030, 0.608 +- 0.027, 0.606 +- 0.020, 0.586 +- 0.022, 0.647 +- 0.026
Faith. Armon (L1)= 		  =  0.587 +- 0.027, 0.596 +- 0.025, 0.593 +- 0.019, 0.565 +- 0.030, 0.574 +- 0.050
Faith. GMean (L1)= 	  =  0.593 +- 0.028, 0.602 +- 0.026, 0.599 +- 0.019, 0.575 +- 0.026, 0.609 +- 0.039
Faith. Aritm (KL)= 		  =  0.604 +- 0.038, 0.621 +- 0.034, 0.629 +- 0.025, 0.618 +- 0.028, 0.704 +- 0.035
Faith. Armon (KL)= 		  =  0.598 +- 0.042, 0.616 +- 0.038, 0.624 +- 0.028, 0.611 +- 0.033, 0.661 +- 0.058
Faith. GMean (KL)= 	  =  0.601 +- 0.040, 0.618 +- 0.036, 0.626 +- 0.027, 0.614 +- 0.031, 0.682 +- 0.047
Computed for split load_split = id



Completed in  2:32:14.295910  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN plain TopoFeature/basis/no_shift NEC_ALPHA 0.1
DONE all :)
