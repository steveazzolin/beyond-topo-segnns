nohup: ignoring input
I'm the stability of the DET :))
The PID of this script is: 3392230
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:06:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:06:58 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:10 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:12 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:14 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:16 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:07:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9035
Train Loss: 0.4128
ID Validation ACCURACY: 0.9023
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4215
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4795
OOD Test ACCURACY: 0.6793
OOD Test Loss: 0.8040

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8663
Train Loss: 0.4837
ID Validation ACCURACY: 0.8677
ID Validation Loss: 0.4913
ID Test ACCURACY: 0.8707
ID Test Loss: 0.4812
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4154
OOD Test ACCURACY: 0.7697
OOD Test Loss: 0.6769

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6793 0.8707 0.7697 0.8677 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.666
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.754


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.087928
Plausibility completed in  0:00:19.927636
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5972, device='cuda:1')  +-  tensor(0.2697, device='cuda:1') (0.088)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6715, device='cuda:1')  +-  tensor(0.1496, device='cuda:1') (0.095)
Original Stability MCC for r=0.3 = 0.996 +- 0.030
Intervened Stability MCC for r=0.3 = 0.551 +- 0.338
Original Stability F1 for r=0.3 = 0.997 +- 0.020
Intervened Stability F1 for r=0.3 = 0.747 +- 0.180
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.245523
Plausibility completed in  0:00:22.551520
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5737, device='cuda:1')  +-  tensor(0.2677, device='cuda:1') (0.060)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8838, device='cuda:1')  +-  tensor(0.1071, device='cuda:1') (0.048)
Original Stability MCC for r=0.6 = 0.993 +- 0.032
Intervened Stability MCC for r=0.6 = 0.407 +- 0.379
Original Stability F1 for r=0.6 = 0.997 +- 0.012
Intervened Stability F1 for r=0.6 = 0.858 +- 0.094
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:08:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:30 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:42 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:44 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:46 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:48 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:08:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.8972
Train Loss: 0.4272
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.4477
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.3677
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.7662

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8812
Train Loss: 0.4545
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4837
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4477
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3667
OOD Test ACCURACY: 0.6257
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9030 0.6950 0.8840 0.6257 0.8767 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.640
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.747


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.081873
Plausibility completed in  0:00:20.687961
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5990, device='cuda:1')  +-  tensor(0.2816, device='cuda:1') (0.100)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6692, device='cuda:1')  +-  tensor(0.1596, device='cuda:1') (0.106)
Original Stability MCC for r=0.3 = 0.991 +- 0.040
Intervened Stability MCC for r=0.3 = 0.558 +- 0.349
Original Stability F1 for r=0.3 = 0.994 +- 0.027
Intervened Stability F1 for r=0.3 = 0.741 +- 0.200
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.908018
Plausibility completed in  0:00:19.768910
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5698, device='cuda:1')  +-  tensor(0.2719, device='cuda:1') (0.086)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8812, device='cuda:1')  +-  tensor(0.1092, device='cuda:1') (0.056)
Original Stability MCC for r=0.6 = 0.993 +- 0.033
Intervened Stability MCC for r=0.6 = 0.506 +- 0.386
Original Stability F1 for r=0.6 = 0.997 +- 0.012
Intervened Stability F1 for r=0.6 = 0.862 +- 0.111
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:09:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:09:59 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:11 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:13 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:15 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:17 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:18 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:10:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:10:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4207
ID Validation ACCURACY: 0.8973
ID Validation Loss: 0.4417
ID Test ACCURACY: 0.8983
ID Test Loss: 0.4343
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.4566
OOD Test ACCURACY: 0.7470
OOD Test Loss: 0.7194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.4455
ID Validation ACCURACY: 0.8893
ID Validation Loss: 0.4661
ID Test ACCURACY: 0.8897
ID Test Loss: 0.4398
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.7320
OOD Test Loss: 0.7218

[0m[1;37mINFO[0m: [1mChartInfo 0.8983 0.7470 0.8897 0.7320 0.8893 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.714
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.789


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.274265
Plausibility completed in  0:00:20.076751
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6221, device='cuda:1')  +-  tensor(0.2830, device='cuda:1') (0.086)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6674, device='cuda:1')  +-  tensor(0.1618, device='cuda:1') (0.097)
Original Stability MCC for r=0.3 = 0.986 +- 0.055
Intervened Stability MCC for r=0.3 = 0.512 +- 0.332
Original Stability F1 for r=0.3 = 0.990 +- 0.037
Intervened Stability F1 for r=0.3 = 0.707 +- 0.193
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.895189
Plausibility completed in  0:00:19.646171
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6118, device='cuda:1')  +-  tensor(0.2825, device='cuda:1') (0.085)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8764, device='cuda:1')  +-  tensor(0.1168, device='cuda:1') (0.054)
Original Stability MCC for r=0.6 = 0.980 +- 0.059
Intervened Stability MCC for r=0.6 = 0.406 +- 0.421
Original Stability F1 for r=0.6 = 0.993 +- 0.022
Intervened Stability F1 for r=0.6 = 0.822 +- 0.133
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:11:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:30 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:43 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:45 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:47 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:49 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:50 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:50 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:11:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:50 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:11:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9111
Train Loss: 0.4118
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4282
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4292
OOD Validation ACCURACY: 0.8720
OOD Validation Loss: 0.4700
OOD Test ACCURACY: 0.6660
OOD Test Loss: 0.8918

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.8854
Train Loss: 0.4498
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.4694
ID Test ACCURACY: 0.8770
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3373
OOD Test ACCURACY: 0.5787
OOD Test Loss: 1.0425

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.6660 0.8770 0.5787 0.8820 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.734
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.830


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.083767
Plausibility completed in  0:00:19.945644
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6207, device='cuda:1')  +-  tensor(0.2605, device='cuda:1') (0.115)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6737, device='cuda:1')  +-  tensor(0.1610, device='cuda:1') (0.123)
Original Stability MCC for r=0.3 = 0.987 +- 0.048
Intervened Stability MCC for r=0.3 = 0.564 +- 0.374
Original Stability F1 for r=0.3 = 0.991 +- 0.033
Intervened Stability F1 for r=0.3 = 0.740 +- 0.212
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.895931
Plausibility completed in  0:00:20.655797
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6140, device='cuda:1')  +-  tensor(0.2484, device='cuda:1') (0.107)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8800, device='cuda:1')  +-  tensor(0.1049, device='cuda:1') (0.065)
Original Stability MCC for r=0.6 = 0.988 +- 0.044
Intervened Stability MCC for r=0.6 = 0.476 +- 0.398
Original Stability F1 for r=0.6 = 0.996 +- 0.017
Intervened Stability F1 for r=0.6 = 0.849 +- 0.115
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:13:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:00 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:12 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:14 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:17 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:18 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:13:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9082
Train Loss: 0.4161
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4276
ID Test ACCURACY: 0.9077
ID Test Loss: 0.4175
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3282
OOD Test ACCURACY: 0.8457
OOD Test Loss: 0.4898

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8790
Train Loss: 0.4656
ID Validation ACCURACY: 0.8803
ID Validation Loss: 0.4735
ID Test ACCURACY: 0.8743
ID Test Loss: 0.4768
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3354
OOD Test ACCURACY: 0.8413
OOD Test Loss: 0.5178

[0m[1;37mINFO[0m: [1mChartInfo 0.9077 0.8457 0.8743 0.8413 0.8803 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.708
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.802


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.069862
Plausibility completed in  0:00:20.462631
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6170, device='cuda:1')  +-  tensor(0.2643, device='cuda:1') (0.102)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6875, device='cuda:1')  +-  tensor(0.1479, device='cuda:1') (0.124)
Original Stability MCC for r=0.3 = 0.991 +- 0.037
Intervened Stability MCC for r=0.3 = 0.581 +- 0.319
Original Stability F1 for r=0.3 = 0.994 +- 0.025
Intervened Stability F1 for r=0.3 = 0.749 +- 0.180
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.940772
Plausibility completed in  0:00:20.069223
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6052, device='cuda:1')  +-  tensor(0.2719, device='cuda:1') (0.095)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8868, device='cuda:1')  +-  tensor(0.1073, device='cuda:1') (0.062)
Original Stability MCC for r=0.6 = 0.988 +- 0.058
Intervened Stability MCC for r=0.6 = 0.402 +- 0.391
Original Stability F1 for r=0.6 = 0.996 +- 0.020
Intervened Stability F1 for r=0.6 = 0.831 +- 0.107
Intervened samples: 3000

\FINISHED GOODMotif - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.78548733 0.78548733] +- [0.02587127 0.02587127] (mean across ratios: 0.79 +- 0.02)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.61120812 0.59490069] +- [0.01084996 0.0191599 ] (mean across ratios: 0.60 +- 0.01)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.81338583 0.98091561] +- [0.02208139 0.00503851] (mean across ratios: 0.90 +- 0.01)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.67385865 0.88162642] +- [0.00715564 0.00353129] (mean across ratios: 0.78 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99338599 0.9957705 ] +- [0.00237704 0.00173357] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.73686893 0.84440331] +- [0.01530172 0.01555044] (mean across ratios: 0.79 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99027159 0.98868788] +- [0.00349422 0.00467382] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.5532065  0.43926358] +- [0.022811   0.04308488] (mean across ratios: 0.50 +- 0.02)

Overall time of execution:  0:07:33.457456
DONE LECI GOODMotif/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:14:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:14:40 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:14:52 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:14:55 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:14:57 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:14:58 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:15:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9035
Train Loss: 0.4128
ID Validation ACCURACY: 0.9023
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4215
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4795
OOD Test ACCURACY: 0.6793
OOD Test Loss: 0.8040

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8663
Train Loss: 0.4837
ID Validation ACCURACY: 0.8677
ID Validation Loss: 0.4913
ID Test ACCURACY: 0.8707
ID Test Loss: 0.4812
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4154
OOD Test ACCURACY: 0.7697
OOD Test Loss: 0.6769

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6793 0.8707 0.7697 0.8677 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.666
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.754


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:07.816329
Plausibility completed in  0:00:20.819508
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5612, device='cuda:1')  +-  tensor(0.2655, device='cuda:1') (0.094)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6274, device='cuda:1')  +-  tensor(0.1468, device='cuda:1') (0.094)
Original Stability MCC for r=0.3 = 0.995 +- 0.032
Intervened Stability MCC for r=0.3 = 0.451 +- 0.382
Original Stability F1 for r=0.3 = 0.996 +- 0.022
Intervened Stability F1 for r=0.3 = 0.715 +- 0.194
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.249515
Plausibility completed in  0:00:20.368627
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5447, device='cuda:1')  +-  tensor(0.2860, device='cuda:1') (0.043)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8892, device='cuda:1')  +-  tensor(0.1092, device='cuda:1') (0.033)
Original Stability MCC for r=0.6 = 0.994 +- 0.028
Intervened Stability MCC for r=0.6 = 0.257 +- 0.372
Original Stability F1 for r=0.6 = 0.998 +- 0.011
Intervened Stability F1 for r=0.6 = 0.882 +- 0.094
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:16:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:14 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:27 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:29 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:31 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:34 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:16:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.8972
Train Loss: 0.4272
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.4477
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.3677
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.7662

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8812
Train Loss: 0.4545
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4837
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4477
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3667
OOD Test ACCURACY: 0.6257
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9030 0.6950 0.8840 0.6257 0.8767 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.640
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.747


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.413969
Plausibility completed in  0:00:20.216018
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5758, device='cuda:1')  +-  tensor(0.3012, device='cuda:1') (0.094)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6448, device='cuda:1')  +-  tensor(0.1774, device='cuda:1') (0.095)
Original Stability MCC for r=0.3 = 0.992 +- 0.035
Intervened Stability MCC for r=0.3 = 0.482 +- 0.422
Original Stability F1 for r=0.3 = 0.995 +- 0.024
Intervened Stability F1 for r=0.3 = 0.719 +- 0.225
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.216394
Plausibility completed in  0:00:20.623660
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5255, device='cuda:1')  +-  tensor(0.3003, device='cuda:1') (0.062)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8833, device='cuda:1')  +-  tensor(0.1131, device='cuda:1') (0.044)
Original Stability MCC for r=0.6 = 0.994 +- 0.031
Intervened Stability MCC for r=0.6 = 0.233 +- 0.390
Original Stability F1 for r=0.6 = 0.998 +- 0.011
Intervened Stability F1 for r=0.6 = 0.867 +- 0.110
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:17:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:17:48 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:01 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:03 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:05 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:06 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:18:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4207
ID Validation ACCURACY: 0.8973
ID Validation Loss: 0.4417
ID Test ACCURACY: 0.8983
ID Test Loss: 0.4343
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.4566
OOD Test ACCURACY: 0.7470
OOD Test Loss: 0.7194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.4455
ID Validation ACCURACY: 0.8893
ID Validation Loss: 0.4661
ID Test ACCURACY: 0.8897
ID Test Loss: 0.4398
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.7320
OOD Test Loss: 0.7218

[0m[1;37mINFO[0m: [1mChartInfo 0.8983 0.7470 0.8897 0.7320 0.8893 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.714
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.789


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.394070
Plausibility completed in  0:00:20.466277
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5959, device='cuda:1')  +-  tensor(0.3170, device='cuda:1') (0.063)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6290, device='cuda:1')  +-  tensor(0.1866, device='cuda:1') (0.071)
Original Stability MCC for r=0.3 = 0.985 +- 0.055
Intervened Stability MCC for r=0.3 = 0.413 +- 0.385
Original Stability F1 for r=0.3 = 0.990 +- 0.037
Intervened Stability F1 for r=0.3 = 0.680 +- 0.209
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:07.140279
Plausibility completed in  0:00:20.728888
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5832, device='cuda:1')  +-  tensor(0.3220, device='cuda:1') (0.060)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8542, device='cuda:1')  +-  tensor(0.1421, device='cuda:1') (0.044)
Original Stability MCC for r=0.6 = 0.982 +- 0.057
Intervened Stability MCC for r=0.6 = 0.183 +- 0.395
Original Stability F1 for r=0.6 = 0.993 +- 0.021
Intervened Stability F1 for r=0.6 = 0.842 +- 0.135
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:19:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:20 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:33 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:35 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:37 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:39 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:19:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9111
Train Loss: 0.4118
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4282
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4292
OOD Validation ACCURACY: 0.8720
OOD Validation Loss: 0.4700
OOD Test ACCURACY: 0.6660
OOD Test Loss: 0.8918

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.8854
Train Loss: 0.4498
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.4694
ID Test ACCURACY: 0.8770
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3373
OOD Test ACCURACY: 0.5787
OOD Test Loss: 1.0425

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.6660 0.8770 0.5787 0.8820 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.734
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.830


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.592812
Plausibility completed in  0:00:20.510579
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5745, device='cuda:1')  +-  tensor(0.2583, device='cuda:1') (0.111)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6265, device='cuda:1')  +-  tensor(0.1481, device='cuda:1') (0.115)
Original Stability MCC for r=0.3 = 0.987 +- 0.047
Intervened Stability MCC for r=0.3 = 0.510 +- 0.400
Original Stability F1 for r=0.3 = 0.991 +- 0.032
Intervened Stability F1 for r=0.3 = 0.729 +- 0.219
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.193665
Plausibility completed in  0:00:20.822943
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5501, device='cuda:1')  +-  tensor(0.2694, device='cuda:1') (0.075)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8900, device='cuda:1')  +-  tensor(0.1117, device='cuda:1') (0.042)
Original Stability MCC for r=0.6 = 0.989 +- 0.045
Intervened Stability MCC for r=0.6 = 0.259 +- 0.404
Original Stability F1 for r=0.6 = 0.996 +- 0.017
Intervened Stability F1 for r=0.6 = 0.871 +- 0.118
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:20:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:20:54 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:06 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:08 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:10 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:12 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:21:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9082
Train Loss: 0.4161
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4276
ID Test ACCURACY: 0.9077
ID Test Loss: 0.4175
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3282
OOD Test ACCURACY: 0.8457
OOD Test Loss: 0.4898

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8790
Train Loss: 0.4656
ID Validation ACCURACY: 0.8803
ID Validation Loss: 0.4735
ID Test ACCURACY: 0.8743
ID Test Loss: 0.4768
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3354
OOD Test ACCURACY: 0.8413
OOD Test Loss: 0.5178

[0m[1;37mINFO[0m: [1mChartInfo 0.9077 0.8457 0.8743 0.8413 0.8803 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.708
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.802


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.388864
Plausibility completed in  0:00:20.490078
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5935, device='cuda:1')  +-  tensor(0.2937, device='cuda:1') (0.085)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6574, device='cuda:1')  +-  tensor(0.1641, device='cuda:1') (0.099)
Original Stability MCC for r=0.3 = 0.991 +- 0.040
Intervened Stability MCC for r=0.3 = 0.504 +- 0.363
Original Stability F1 for r=0.3 = 0.994 +- 0.027
Intervened Stability F1 for r=0.3 = 0.729 +- 0.192
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.202009
Plausibility completed in  0:00:21.177300
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5671, device='cuda:1')  +-  tensor(0.3039, device='cuda:1') (0.062)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8891, device='cuda:1')  +-  tensor(0.1108, device='cuda:1') (0.045)
Original Stability MCC for r=0.6 = 0.986 +- 0.062
Intervened Stability MCC for r=0.6 = 0.229 +- 0.364
Original Stability F1 for r=0.6 = 0.995 +- 0.022
Intervened Stability F1 for r=0.6 = 0.868 +- 0.110
Intervened samples: 3000

\FINISHED GOODMotif - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.78548733 0.78548733] +- [0.02587127 0.02587127] (mean across ratios: 0.79 +- 0.02)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.58018123 0.55414314] +- [0.01292971 0.0196874 ] (mean across ratios: 0.57 +- 0.01)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.81338576 0.98091561] +- [0.02208128 0.00503851] (mean across ratios: 0.90 +- 0.01)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.63702308 0.88117497] +- [0.01219422 0.01368719] (mean across ratios: 0.76 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99324907 0.99591036] +- [0.00226006 0.00179148] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.71435351 0.86611849] +- [0.01787715 0.0129732 ] (mean across ratios: 0.79 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.9900824  0.98903548] +- [0.00332748 0.00486749] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.47202032 0.23199267] +- [0.03577107 0.02729651] (mean across ratios: 0.35 +- 0.02)

Overall time of execution:  0:07:47.396541
DONE LECI GOODMotif/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:22:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:39 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:51 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:53 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:55 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:57 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:59 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:59 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:59 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:59 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:59 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:22:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:59 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:59 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:22:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:59 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 09:22:59 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.8871
Train Loss: 0.4970
ID Validation ACCURACY: 0.8797
ID Validation Loss: 0.5295
ID Test ACCURACY: 0.8927
ID Test Loss: 0.4823
OOD Validation ACCURACY: 0.4747
OOD Validation Loss: 1.8881
OOD Test ACCURACY: 0.3857
OOD Test Loss: 3.2832

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.7347
Train Loss: 0.7778
ID Validation ACCURACY: 0.7300
ID Validation Loss: 0.8197
ID Test ACCURACY: 0.7497
ID Test Loss: 0.7641
OOD Validation ACCURACY: 0.9027
OOD Validation Loss: 0.4950
OOD Test ACCURACY: 0.3873
OOD Test Loss: 6.8454

[0m[1;37mINFO[0m: [1mChartInfo 0.8927 0.3857 0.7497 0.3873 0.7300 0.9027[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.691
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.993363
Plausibility completed in  0:00:19.175599
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5759, device='cuda:1')  +-  tensor(0.2797, device='cuda:1') (0.106)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7058, device='cuda:1')  +-  tensor(0.1309, device='cuda:1') (0.114)
Original Stability MCC for r=0.3 = 0.950 +- 0.124
Intervened Stability MCC for r=0.3 = 0.609 +- 0.331
Original Stability F1 for r=0.3 = 0.968 +- 0.075
Intervened Stability F1 for r=0.3 = 0.761 +- 0.188
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.773630
Plausibility completed in  0:00:19.937419
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5697, device='cuda:1')  +-  tensor(0.2808, device='cuda:1') (0.084)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9471, device='cuda:1')  +-  tensor(0.0727, device='cuda:1') (0.042)
Original Stability MCC for r=0.6 = 0.973 +- 0.087
Intervened Stability MCC for r=0.6 = 0.579 +- 0.326
Original Stability F1 for r=0.6 = 0.990 +- 0.031
Intervened Stability F1 for r=0.6 = 0.882 +- 0.089
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:24:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:07 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:19 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:21 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:23 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:25 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:26 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:26 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:26 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:26 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:26 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:24:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:26 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:26 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:24:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:26 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 09:24:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9131
Train Loss: 0.4912
ID Validation ACCURACY: 0.9110
ID Validation Loss: 0.5286
ID Test ACCURACY: 0.9127
ID Test Loss: 0.5019
OOD Validation ACCURACY: 0.5887
OOD Validation Loss: 4.5675
OOD Test ACCURACY: 0.3957
OOD Test Loss: 6.2688

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ACCURACY: 0.5313
Train Loss: 2.0616
ID Validation ACCURACY: 0.5323
ID Validation Loss: 2.1256
ID Test ACCURACY: 0.5313
ID Test Loss: 2.0766
OOD Validation ACCURACY: 0.8873
OOD Validation Loss: 0.6722
OOD Test ACCURACY: 0.3303
OOD Test Loss: 13.4125

[0m[1;37mINFO[0m: [1mChartInfo 0.9127 0.3957 0.5313 0.3303 0.5323 0.8873[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.642
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.950976
Plausibility completed in  0:00:19.095367
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5981, device='cuda:1')  +-  tensor(0.2809, device='cuda:1') (0.095)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7379, device='cuda:1')  +-  tensor(0.1403, device='cuda:1') (0.114)
Original Stability MCC for r=0.3 = 0.935 +- 0.134
Intervened Stability MCC for r=0.3 = 0.615 +- 0.324
Original Stability F1 for r=0.3 = 0.957 +- 0.084
Intervened Stability F1 for r=0.3 = 0.765 +- 0.181
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.740825
Plausibility completed in  0:00:20.890562
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5798, device='cuda:1')  +-  tensor(0.2797, device='cuda:1') (0.089)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9476, device='cuda:1')  +-  tensor(0.0789, device='cuda:1') (0.037)
Original Stability MCC for r=0.6 = 0.983 +- 0.064
Intervened Stability MCC for r=0.6 = 0.644 +- 0.333
Original Stability F1 for r=0.6 = 0.994 +- 0.023
Intervened Stability F1 for r=0.6 = 0.902 +- 0.089
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:25:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:35 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:47 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:49 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:50 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:52 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:54 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:54 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:54 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:54 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:54 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:25:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:54 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:54 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:25:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:54 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 09:25:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.8891
Train Loss: 0.4932
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.5131
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4878
OOD Validation ACCURACY: 0.6437
OOD Validation Loss: 0.9073
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.4450

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.8338
Train Loss: 0.5768
ID Validation ACCURACY: 0.8263
ID Validation Loss: 0.6099
ID Test ACCURACY: 0.8387
ID Test Loss: 0.5514
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.4917
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.6284

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.3573 0.8387 0.3573 0.8263 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.545
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.562


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.799327
Plausibility completed in  0:00:19.456668
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5364, device='cuda:1')  +-  tensor(0.2901, device='cuda:1') (0.060)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6081, device='cuda:1')  +-  tensor(0.1361, device='cuda:1') (0.081)
Original Stability MCC for r=0.3 = 0.975 +- 0.080
Intervened Stability MCC for r=0.3 = 0.549 +- 0.392
Original Stability F1 for r=0.3 = 0.983 +- 0.053
Intervened Stability F1 for r=0.3 = 0.724 +- 0.219
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.763859
Plausibility completed in  0:00:21.448022
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5157, device='cuda:1')  +-  tensor(0.2790, device='cuda:1') (0.052)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9059, device='cuda:1')  +-  tensor(0.1032, device='cuda:1') (0.033)
Original Stability MCC for r=0.6 = 0.978 +- 0.077
Intervened Stability MCC for r=0.6 = 0.574 +- 0.412
Original Stability F1 for r=0.6 = 0.992 +- 0.027
Intervened Stability F1 for r=0.6 = 0.884 +- 0.111
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:27:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:03 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:15 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:17 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:19 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:21 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:23 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:23 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:23 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:23 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:27:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:23 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:27:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:23 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 09:27:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.8896
Train Loss: 0.4598
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.4805
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4487
OOD Validation ACCURACY: 0.6967
OOD Validation Loss: 0.9930
OOD Test ACCURACY: 0.3650
OOD Test Loss: 3.7864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.8446
Train Loss: 0.5273
ID Validation ACCURACY: 0.8417
ID Validation Loss: 0.5506
ID Test ACCURACY: 0.8483
ID Test Loss: 0.5201
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.5280
OOD Test ACCURACY: 0.5647
OOD Test Loss: 1.8408

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.3650 0.8483 0.5647 0.8417 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.544


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.925739
Plausibility completed in  0:00:19.764569
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5158, device='cuda:1')  +-  tensor(0.2943, device='cuda:1') (0.053)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5653, device='cuda:1')  +-  tensor(0.1062, device='cuda:1') (0.062)
Original Stability MCC for r=0.3 = 0.982 +- 0.058
Intervened Stability MCC for r=0.3 = 0.556 +- 0.343
Original Stability F1 for r=0.3 = 0.988 +- 0.039
Intervened Stability F1 for r=0.3 = 0.726 +- 0.196
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.818024
Plausibility completed in  0:00:19.082623
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4984, device='cuda:1')  +-  tensor(0.2819, device='cuda:1') (0.045)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9119, device='cuda:1')  +-  tensor(0.1006, device='cuda:1') (0.030)
Original Stability MCC for r=0.6 = 0.976 +- 0.077
Intervened Stability MCC for r=0.6 = 0.630 +- 0.360
Original Stability F1 for r=0.6 = 0.991 +- 0.027
Intervened Stability F1 for r=0.6 = 0.896 +- 0.099
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:28:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:31 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:43 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:46 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:48 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:50 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:52 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:52 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:52 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:52 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:28:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:52 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:28:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:52 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 09:28:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4635
ID Validation ACCURACY: 0.8873
ID Validation Loss: 0.4962
ID Test ACCURACY: 0.8990
ID Test Loss: 0.4417
OOD Validation ACCURACY: 0.4727
OOD Validation Loss: 1.7073
OOD Test ACCURACY: 0.4150
OOD Test Loss: 3.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ACCURACY: 0.7313
Train Loss: 0.7642
ID Validation ACCURACY: 0.7220
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.7480
ID Test Loss: 0.7468
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.4686
OOD Test ACCURACY: 0.3573
OOD Test Loss: 7.4038

[0m[1;37mINFO[0m: [1mChartInfo 0.8990 0.4150 0.7480 0.3573 0.7220 0.9300[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.685
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.723


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.770787
Plausibility completed in  0:00:19.371622
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5878, device='cuda:1')  +-  tensor(0.2752, device='cuda:1') (0.104)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7296, device='cuda:1')  +-  tensor(0.1321, device='cuda:1') (0.110)
Original Stability MCC for r=0.3 = 0.955 +- 0.124
Intervened Stability MCC for r=0.3 = 0.643 +- 0.318
Original Stability F1 for r=0.3 = 0.971 +- 0.074
Intervened Stability F1 for r=0.3 = 0.781 +- 0.179
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.766131
Plausibility completed in  0:00:19.138201
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5765, device='cuda:1')  +-  tensor(0.2738, device='cuda:1') (0.084)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9471, device='cuda:1')  +-  tensor(0.0722, device='cuda:1') (0.039)
Original Stability MCC for r=0.6 = 0.992 +- 0.042
Intervened Stability MCC for r=0.6 = 0.584 +- 0.379
Original Stability F1 for r=0.6 = 0.997 +- 0.015
Intervened Stability F1 for r=0.6 = 0.887 +- 0.098
Intervened samples: 3000

\FINISHED GOODMotif - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.65580273 0.65580273] +- [0.08244711 0.08244711] (mean across ratios: 0.66 +- 0.06)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.56279789 0.54804005] +- [0.03143946 0.0340561 ] (mean across ratios: 0.56 +- 0.02)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.773664   0.98188615] +- [0.1100089  0.01109366] (mean across ratios: 0.88 +- 0.06)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.66934303 0.93193053] +- [0.06962376 0.01889676] (mean across ratios: 0.80 +- 0.04)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.97359955 0.99286691] +- [0.01086131 0.00243994] (mean across ratios: 0.98 +- 0.01)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.75147784 0.89041615] +- [0.02253583 0.00731602] (mean across ratios: 0.82 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.95922927 0.98038961] +- [0.01707888 0.00680085] (mean across ratios: 0.97 +- 0.01)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.59433451 0.60229907] +- [0.03597034 0.02897534] (mean across ratios: 0.60 +- 0.02)

Overall time of execution:  0:07:21.445445
DONE CIGA GOODMotif/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:30:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:14 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:27 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:29 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:31 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:32 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:34 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:34 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:34 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:34 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:34 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:30:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:34 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:34 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:30:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:34 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 09:30:34 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.8871
Train Loss: 0.4970
ID Validation ACCURACY: 0.8797
ID Validation Loss: 0.5295
ID Test ACCURACY: 0.8927
ID Test Loss: 0.4823
OOD Validation ACCURACY: 0.4747
OOD Validation Loss: 1.8881
OOD Test ACCURACY: 0.3857
OOD Test Loss: 3.2832

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.7347
Train Loss: 0.7778
ID Validation ACCURACY: 0.7300
ID Validation Loss: 0.8197
ID Test ACCURACY: 0.7497
ID Test Loss: 0.7641
OOD Validation ACCURACY: 0.9027
OOD Validation Loss: 0.4950
OOD Test ACCURACY: 0.3873
OOD Test Loss: 6.8454

[0m[1;37mINFO[0m: [1mChartInfo 0.8927 0.3857 0.7497 0.3873 0.7300 0.9027[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.692
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.180095
Plausibility completed in  0:00:19.479491
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5617, device='cuda:1')  +-  tensor(0.3227, device='cuda:1') (0.082)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6476, device='cuda:1')  +-  tensor(0.1503, device='cuda:1') (0.093)
Original Stability MCC for r=0.3 = 0.948 +- 0.124
Intervened Stability MCC for r=0.3 = 0.468 +- 0.370
Original Stability F1 for r=0.3 = 0.967 +- 0.076
Intervened Stability F1 for r=0.3 = 0.700 +- 0.198
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.939553
Plausibility completed in  0:00:19.534364
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5388, device='cuda:1')  +-  tensor(0.3163, device='cuda:1') (0.051)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9257, device='cuda:1')  +-  tensor(0.0792, device='cuda:1') (0.041)
Original Stability MCC for r=0.6 = 0.974 +- 0.084
Intervened Stability MCC for r=0.6 = 0.320 +- 0.384
Original Stability F1 for r=0.6 = 0.990 +- 0.030
Intervened Stability F1 for r=0.6 = 0.885 +- 0.095
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:31:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:31:43 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:31:56 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:31:58 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:32:00 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:32:01 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:32:03 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:32:03 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:32:03 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 09:32:03 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 09:32:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:32:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:32:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:32:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:32:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:32:03 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 09:32:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:32:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:32:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:32:03 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 09:32:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9131
Train Loss: 0.4912
ID Validation ACCURACY: 0.9110
ID Validation Loss: 0.5286
ID Test ACCURACY: 0.9127
ID Test Loss: 0.5019
OOD Validation ACCURACY: 0.5887
OOD Validation Loss: 4.5675
OOD Test ACCURACY: 0.3957
OOD Test Loss: 6.2688

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ACCURACY: 0.5313
Train Loss: 2.0616
ID Validation ACCURACY: 0.5323
ID Validation Loss: 2.1256
ID Test ACCURACY: 0.5313
ID Test Loss: 2.0766
OOD Validation ACCURACY: 0.8873
OOD Validation Loss: 0.6722
OOD Test ACCURACY: 0.3303
OOD Test Loss: 13.4125

[0m[1;37mINFO[0m: [1mChartInfo 0.9127 0.3957 0.5313 0.3303 0.5323 0.8873[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.642
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.138380
Plausibility completed in  0:00:19.592778
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5833, device='cuda:1')  +-  tensor(0.3112, device='cuda:1') (0.084)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6646, device='cuda:1')  +-  tensor(0.1523, device='cuda:1') (0.101)
Original Stability MCC for r=0.3 = 0.933 +- 0.136
Intervened Stability MCC for r=0.3 = 0.467 +- 0.351
Original Stability F1 for r=0.3 = 0.956 +- 0.085
Intervened Stability F1 for r=0.3 = 0.701 +- 0.182
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.911991
Plausibility completed in  0:00:19.384645
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5413, device='cuda:1')  +-  tensor(0.3077, device='cuda:1') (0.056)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9233, device='cuda:1')  +-  tensor(0.0944, device='cuda:1') (0.037)
Original Stability MCC for r=0.6 = 0.985 +- 0.060
Intervened Stability MCC for r=0.6 = 0.368 +- 0.414
Original Stability F1 for r=0.6 = 0.994 +- 0.021
Intervened Stability F1 for r=0.6 = 0.901 +- 0.096
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:33:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:12 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:25 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:27 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:29 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:31 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:32 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:32 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:32 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:32 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:33:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:32 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:33:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:32 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 09:33:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.8891
Train Loss: 0.4932
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.5131
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4878
OOD Validation ACCURACY: 0.6437
OOD Validation Loss: 0.9073
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.4450

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.8338
Train Loss: 0.5768
ID Validation ACCURACY: 0.8263
ID Validation Loss: 0.6099
ID Test ACCURACY: 0.8387
ID Test Loss: 0.5514
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.4917
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.6284

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.3573 0.8387 0.3573 0.8263 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.546
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.562


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.965086
Plausibility completed in  0:00:19.723557
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5547, device='cuda:1')  +-  tensor(0.3248, device='cuda:1') (0.046)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5913, device='cuda:1')  +-  tensor(0.1560, device='cuda:1') (0.062)
Original Stability MCC for r=0.3 = 0.977 +- 0.075
Intervened Stability MCC for r=0.3 = 0.436 +- 0.425
Original Stability F1 for r=0.3 = 0.985 +- 0.050
Intervened Stability F1 for r=0.3 = 0.682 +- 0.222
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.933653
Plausibility completed in  0:00:19.509707
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5243, device='cuda:1')  +-  tensor(0.3156, device='cuda:1') (0.029)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9080, device='cuda:1')  +-  tensor(0.1007, device='cuda:1') (0.027)
Original Stability MCC for r=0.6 = 0.979 +- 0.068
Intervened Stability MCC for r=0.6 = 0.351 +- 0.427
Original Stability F1 for r=0.6 = 0.992 +- 0.024
Intervened Stability F1 for r=0.6 = 0.898 +- 0.103
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:34:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:34:41 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:34:53 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:34:55 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:34:57 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:34:59 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:35:01 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:35:01 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:35:01 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 09:35:01 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 09:35:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:35:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:35:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:35:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:35:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:35:01 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 09:35:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:35:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:35:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:35:01 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 09:35:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.8896
Train Loss: 0.4598
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.4805
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4487
OOD Validation ACCURACY: 0.6967
OOD Validation Loss: 0.9930
OOD Test ACCURACY: 0.3650
OOD Test Loss: 3.7864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.8446
Train Loss: 0.5273
ID Validation ACCURACY: 0.8417
ID Validation Loss: 0.5506
ID Test ACCURACY: 0.8483
ID Test Loss: 0.5201
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.5280
OOD Test ACCURACY: 0.5647
OOD Test Loss: 1.8408

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.3650 0.8483 0.5647 0.8417 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.544


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.127630
Plausibility completed in  0:00:19.528601
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5390, device='cuda:1')  +-  tensor(0.3235, device='cuda:1') (0.043)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5531, device='cuda:1')  +-  tensor(0.1251, device='cuda:1') (0.055)
Original Stability MCC for r=0.3 = 0.982 +- 0.058
Intervened Stability MCC for r=0.3 = 0.404 +- 0.381
Original Stability F1 for r=0.3 = 0.988 +- 0.039
Intervened Stability F1 for r=0.3 = 0.664 +- 0.200
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.938987
Plausibility completed in  0:00:19.245222
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5154, device='cuda:1')  +-  tensor(0.3131, device='cuda:1') (0.028)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9093, device='cuda:1')  +-  tensor(0.1012, device='cuda:1') (0.027)
Original Stability MCC for r=0.6 = 0.974 +- 0.079
Intervened Stability MCC for r=0.6 = 0.365 +- 0.426
Original Stability F1 for r=0.6 = 0.990 +- 0.028
Intervened Stability F1 for r=0.6 = 0.898 +- 0.102
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:36:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:08 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:20 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:22 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:24 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:26 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:28 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:28 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:28 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:28 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:36:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:28 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:36:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:28 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 09:36:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4635
ID Validation ACCURACY: 0.8873
ID Validation Loss: 0.4962
ID Test ACCURACY: 0.8990
ID Test Loss: 0.4417
OOD Validation ACCURACY: 0.4727
OOD Validation Loss: 1.7073
OOD Test ACCURACY: 0.4150
OOD Test Loss: 3.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ACCURACY: 0.7313
Train Loss: 0.7642
ID Validation ACCURACY: 0.7220
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.7480
ID Test Loss: 0.7468
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.4686
OOD Test ACCURACY: 0.3573
OOD Test Loss: 7.4038

[0m[1;37mINFO[0m: [1mChartInfo 0.8990 0.4150 0.7480 0.3573 0.7220 0.9300[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.685
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.723


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.079978
Plausibility completed in  0:00:19.289696
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5736, device='cuda:1')  +-  tensor(0.3165, device='cuda:1') (0.081)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6732, device='cuda:1')  +-  tensor(0.1513, device='cuda:1') (0.090)
Original Stability MCC for r=0.3 = 0.956 +- 0.123
Intervened Stability MCC for r=0.3 = 0.521 +- 0.366
Original Stability F1 for r=0.3 = 0.972 +- 0.074
Intervened Stability F1 for r=0.3 = 0.730 +- 0.193
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.898257
Plausibility completed in  0:00:19.244197
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5426, device='cuda:1')  +-  tensor(0.3066, device='cuda:1') (0.051)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9230, device='cuda:1')  +-  tensor(0.0800, device='cuda:1') (0.039)
Original Stability MCC for r=0.6 = 0.992 +- 0.045
Intervened Stability MCC for r=0.6 = 0.287 +- 0.397
Original Stability F1 for r=0.6 = 0.997 +- 0.016
Intervened Stability F1 for r=0.6 = 0.879 +- 0.095
Intervened samples: 3000

\FINISHED GOODMotif - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.65580264 0.65580273] +- [0.08244707 0.08244711] (mean across ratios: 0.66 +- 0.06)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.56245272 0.53245778] +- [0.01528904 0.01074576] (mean across ratios: 0.55 +- 0.01)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.773664   0.98188621] +- [0.1100089  0.01109357] (mean across ratios: 0.88 +- 0.06)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.62596198 0.91785377] +- [0.04626757 0.00759183] (mean across ratios: 0.77 +- 0.02)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.97356644 0.99295475] +- [0.01160704 0.00253504] (mean across ratios: 0.98 +- 0.01)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.69549448 0.89216542] +- [0.02236044 0.00868317] (mean across ratios: 0.79 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.95921862 0.98074554] +- [0.01818366 0.00696128] (mean across ratios: 0.97 +- 0.01)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.45920826 0.33825576] +- [0.03876937 0.03079292] (mean across ratios: 0.40 +- 0.02)

Overall time of execution:  0:07:22.940278
DONE CIGA GOODMotif/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:37:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:37:54 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:38:06 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:38:08 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:38:10 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:38:12 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:38:14 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:38:14 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:38:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:38:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:38:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:38:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:38:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:38:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:38:14 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 09:38:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.578
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.484


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.135950
Plausibility completed in  0:00:19.962813
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3649, device='cuda:1')  +-  tensor(0.2148, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3759, device='cuda:1')  +-  tensor(0.0589, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.999 +- 0.017
Intervened Stability MCC for r=0.3 = 0.197 +- 0.297
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.492 +- 0.193
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.915783
Plausibility completed in  0:00:19.985251
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3648, device='cuda:1')  +-  tensor(0.2148, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7110, device='cuda:1')  +-  tensor(0.0681, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.015
Intervened Stability MCC for r=0.6 = 0.166 +- 0.319
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.755 +- 0.110
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:39:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:39:23 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:39:35 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:39:37 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:39:39 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:39:41 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:39:42 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:39:42 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:39:42 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:39:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:39:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:39:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:39:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:39:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:39:42 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 09:39:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.488


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.881730
Plausibility completed in  0:00:19.903365
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3725, device='cuda:1')  +-  tensor(0.2184, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3888, device='cuda:1')  +-  tensor(0.0705, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.993 +- 0.049
Intervened Stability MCC for r=0.3 = 0.223 +- 0.294
Original Stability F1 for r=0.3 = 0.995 +- 0.033
Intervened Stability F1 for r=0.3 = 0.514 +- 0.198
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.888042
Plausibility completed in  0:00:19.767648
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3718, device='cuda:1')  +-  tensor(0.2174, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7132, device='cuda:1')  +-  tensor(0.0695, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.995 +- 0.037
Intervened Stability MCC for r=0.6 = 0.178 +- 0.323
Original Stability F1 for r=0.6 = 0.998 +- 0.013
Intervened Stability F1 for r=0.6 = 0.755 +- 0.114
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:40:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:40:50 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:41:02 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:41:04 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:41:06 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:41:07 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:41:09 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:41:09 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:41:09 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:41:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:41:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:41:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:41:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:41:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:41:09 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 09:41:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.858991
Plausibility completed in  0:00:20.109932
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3696, device='cuda:1')  +-  tensor(0.2164, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3882, device='cuda:1')  +-  tensor(0.0680, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.997 +- 0.026
Intervened Stability MCC for r=0.3 = 0.192 +- 0.295
Original Stability F1 for r=0.3 = 0.998 +- 0.017
Intervened Stability F1 for r=0.3 = 0.498 +- 0.193
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.848509
Plausibility completed in  0:00:19.721915
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3686, device='cuda:1')  +-  tensor(0.2155, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7128, device='cuda:1')  +-  tensor(0.0693, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.996 +- 0.027
Intervened Stability MCC for r=0.6 = 0.164 +- 0.323
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.753 +- 0.115
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:42:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:42:17 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:42:29 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:42:31 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:42:33 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:42:35 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:42:36 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:42:36 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:42:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:42:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:42:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:42:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:42:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:42:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:42:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 09:42:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.474


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.010008
Plausibility completed in  0:00:19.724849
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3686, device='cuda:1')  +-  tensor(0.2151, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3921, device='cuda:1')  +-  tensor(0.0698, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.992 +- 0.052
Intervened Stability MCC for r=0.3 = 0.211 +- 0.295
Original Stability F1 for r=0.3 = 0.994 +- 0.033
Intervened Stability F1 for r=0.3 = 0.509 +- 0.194
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.090560
Plausibility completed in  0:00:19.701568
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3682, device='cuda:1')  +-  tensor(0.2147, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7125, device='cuda:1')  +-  tensor(0.0687, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.998 +- 0.018
Intervened Stability MCC for r=0.6 = 0.134 +- 0.299
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.749 +- 0.105
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:43:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:43:44 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:43:56 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:43:58 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:44:00 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:44:01 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:44:03 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:44:03 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:44:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:44:03 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 09:44:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.535
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.997973
Plausibility completed in  0:00:19.716578
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3680, device='cuda:1')  +-  tensor(0.2166, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3874, device='cuda:1')  +-  tensor(0.0682, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.997 +- 0.027
Intervened Stability MCC for r=0.3 = 0.207 +- 0.296
Original Stability F1 for r=0.3 = 0.998 +- 0.018
Intervened Stability F1 for r=0.3 = 0.504 +- 0.192
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.208002
Plausibility completed in  0:00:19.694576
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3670, device='cuda:1')  +-  tensor(0.2158, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7115, device='cuda:1')  +-  tensor(0.0680, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.997 +- 0.022
Intervened Stability MCC for r=0.6 = 0.169 +- 0.316
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.752 +- 0.111
Intervened samples: 3000

\FINISHED GOODMotif - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.32219606 0.32219606] +- [0.0026828 0.0026828] (mean across ratios: 0.32 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.36871287 0.36806819] +- [0.00244989 0.00225939] (mean across ratios: 0.37 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.3323974  0.63297027] +- [0.00301403 0.00306423] (mean across ratios: 0.48 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.38648651 0.71219763] +- [0.00552162 0.00083394] (mean across ratios: 0.55 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99699953 0.99890301] +- [0.00182939 0.00035497] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.50361024 0.75282903] +- [0.0078395  0.00232984] (mean across ratios: 0.63 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99554468 0.99702324] +- [0.00271083 0.0010277 ] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.20609177 0.16238744] +- [0.01094185 0.01473908] (mean across ratios: 0.18 +- 0.01)

Overall time of execution:  0:07:18.451945
DONE GSAT GOODMotif/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:45:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:45:32 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:45:44 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:45:46 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:45:48 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:45:50 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:45:51 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:45:51 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:45:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:45:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:45:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:45:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:45:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:45:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:45:51 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 09:45:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.578
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.484


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.031250
Plausibility completed in  0:00:19.608586
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4218, device='cuda:1')  +-  tensor(0.2659, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4269, device='cuda:1')  +-  tensor(0.0866, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.999 +- 0.012
Intervened Stability MCC for r=0.3 = 0.148 +- 0.316
Original Stability F1 for r=0.3 = 0.999 +- 0.008
Intervened Stability F1 for r=0.3 = 0.511 +- 0.196
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.838681
Plausibility completed in  0:00:19.406070
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4212, device='cuda:1')  +-  tensor(0.2653, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8060, device='cuda:1')  +-  tensor(0.1200, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.015
Intervened Stability MCC for r=0.6 = 0.057 +- 0.230
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.820 +- 0.127
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:47:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:47:00 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:47:12 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:47:14 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:47:16 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:47:17 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:47:19 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:47:19 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:47:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:47:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:47:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:47:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:47:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:47:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:47:19 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 09:47:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.488


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.881662
Plausibility completed in  0:00:19.753784
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4288, device='cuda:1')  +-  tensor(0.2683, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4429, device='cuda:1')  +-  tensor(0.1039, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.995 +- 0.042
Intervened Stability MCC for r=0.3 = 0.165 +- 0.310
Original Stability F1 for r=0.3 = 0.997 +- 0.029
Intervened Stability F1 for r=0.3 = 0.532 +- 0.194
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.870926
Plausibility completed in  0:00:19.589338
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4257, device='cuda:1')  +-  tensor(0.2628, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8060, device='cuda:1')  +-  tensor(0.1203, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.996 +- 0.031
Intervened Stability MCC for r=0.6 = 0.085 +- 0.293
Original Stability F1 for r=0.6 = 0.999 +- 0.011
Intervened Stability F1 for r=0.6 = 0.818 +- 0.134
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:48:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:48:26 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:48:38 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:48:40 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:48:42 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:48:43 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:48:45 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:48:45 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:48:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:48:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:48:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:48:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:48:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:48:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:48:45 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 09:48:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.078970
Plausibility completed in  0:00:19.777282
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4254, device='cuda:1')  +-  tensor(0.2666, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4415, device='cuda:1')  +-  tensor(0.1002, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.998 +- 0.019
Intervened Stability MCC for r=0.3 = 0.150 +- 0.307
Original Stability F1 for r=0.3 = 0.999 +- 0.013
Intervened Stability F1 for r=0.3 = 0.523 +- 0.193
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.847500
Plausibility completed in  0:00:19.546786
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4204, device='cuda:1')  +-  tensor(0.2605, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8056, device='cuda:1')  +-  tensor(0.1207, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.997 +- 0.022
Intervened Stability MCC for r=0.6 = 0.052 +- 0.250
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.817 +- 0.134
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:49:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:49:52 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:50:04 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:50:06 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:50:08 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:50:09 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:50:11 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:50:11 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:50:11 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:50:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:50:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:50:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:50:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:50:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:50:11 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 09:50:11 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.474


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.005272
Plausibility completed in  0:00:19.486241
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4254, device='cuda:1')  +-  tensor(0.2658, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4457, device='cuda:1')  +-  tensor(0.1034, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.991 +- 0.054
Intervened Stability MCC for r=0.3 = 0.154 +- 0.315
Original Stability F1 for r=0.3 = 0.994 +- 0.034
Intervened Stability F1 for r=0.3 = 0.529 +- 0.193
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.049557
Plausibility completed in  0:00:19.398130
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4192, device='cuda:1')  +-  tensor(0.2571, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8033, device='cuda:1')  +-  tensor(0.1167, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.998 +- 0.016
Intervened Stability MCC for r=0.6 = 0.068 +- 0.263
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.816 +- 0.127
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:51:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 09:51:19 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 09:51:30 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 09:51:32 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 09:51:34 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 09:51:36 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 09:51:38 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:51:38 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:51:38 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:51:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:51:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:51:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:51:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:51:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:51:38 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 09:51:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.535
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.021598
Plausibility completed in  0:00:19.546947
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.2671, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4400, device='cuda:1')  +-  tensor(0.0999, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.997 +- 0.027
Intervened Stability MCC for r=0.3 = 0.151 +- 0.325
Original Stability F1 for r=0.3 = 0.998 +- 0.018
Intervened Stability F1 for r=0.3 = 0.522 +- 0.200
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.083303
Plausibility completed in  0:00:19.504052
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4185, device='cuda:1')  +-  tensor(0.2585, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8018, device='cuda:1')  +-  tensor(0.1165, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.020
Intervened Stability MCC for r=0.6 = 0.071 +- 0.265
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.815 +- 0.127
Intervened samples: 3000

\FINISHED GOODMotif - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.32219606 0.32219606] +- [0.0026828 0.0026828] (mean across ratios: 0.32 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.42522948 0.42100123] +- [0.00221224 0.00252155] (mean across ratios: 0.42 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33239747 0.63297027] +- [0.00301391 0.00306408] (mean across ratios: 0.48 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.43939353 0.80454557] +- [0.00654185 0.00170523] (mean across ratios: 0.62 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99730567 0.99911201] +- [0.00183148 0.00023163] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.52340811 0.81727221] +- [0.00724966 0.00165494] (mean across ratios: 0.67 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99600818 0.99760033] +- [0.00277043 0.00067507] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.15373593 0.06675311] +- [0.00583726 0.01158088] (mean across ratios: 0.11 +- 0.01)

Overall time of execution:  0:07:14.195975
DONE GSAT GOODMotif/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:53:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:53:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.660
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.741


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.064570
Plausibility completed in  0:00:19.768756
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6356, device='cuda:1')  +-  tensor(0.2827, device='cuda:1') (0.095)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6677, device='cuda:1')  +-  tensor(0.1666, device='cuda:1') (0.098)
Original Stability MCC for r=0.3 = 0.988 +- 0.052
Intervened Stability MCC for r=0.3 = 0.542 +- 0.387
Original Stability F1 for r=0.3 = 0.992 +- 0.035
Intervened Stability F1 for r=0.3 = 0.720 +- 0.226
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.072860
Plausibility completed in  0:00:19.825518
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6242, device='cuda:1')  +-  tensor(0.2997, device='cuda:1') (0.061)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8956, device='cuda:1')  +-  tensor(0.1120, device='cuda:1') (0.044)
Original Stability MCC for r=0.6 = 0.982 +- 0.079
Intervened Stability MCC for r=0.6 = 0.461 +- 0.409
Original Stability F1 for r=0.6 = 0.994 +- 0.026
Intervened Stability F1 for r=0.6 = 0.845 +- 0.116
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:54:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:54:13 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.702
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.770


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.092237
Plausibility completed in  0:00:19.979543
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6582, device='cuda:1')  +-  tensor(0.3071, device='cuda:1') (0.076)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6784, device='cuda:1')  +-  tensor(0.1701, device='cuda:1') (0.092)
Original Stability MCC for r=0.3 = 0.989 +- 0.044
Intervened Stability MCC for r=0.3 = 0.486 +- 0.419
Original Stability F1 for r=0.3 = 0.992 +- 0.030
Intervened Stability F1 for r=0.3 = 0.680 +- 0.254
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.897400
Plausibility completed in  0:00:20.072863
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6368, device='cuda:1')  +-  tensor(0.3023, device='cuda:1') (0.073)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8992, device='cuda:1')  +-  tensor(0.1197, device='cuda:1') (0.038)
Original Stability MCC for r=0.6 = 0.991 +- 0.039
Intervened Stability MCC for r=0.6 = 0.604 +- 0.430
Original Stability F1 for r=0.6 = 0.997 +- 0.015
Intervened Stability F1 for r=0.6 = 0.875 +- 0.136
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:55:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:55:21 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.684


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.066614
Plausibility completed in  0:00:20.220191
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6056, device='cuda:1')  +-  tensor(0.2820, device='cuda:1') (0.086)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6287, device='cuda:1')  +-  tensor(0.1577, device='cuda:1') (0.091)
Original Stability MCC for r=0.3 = 0.993 +- 0.038
Intervened Stability MCC for r=0.3 = 0.403 +- 0.422
Original Stability F1 for r=0.3 = 0.995 +- 0.026
Intervened Stability F1 for r=0.3 = 0.641 +- 0.239
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.918921
Plausibility completed in  0:00:19.923870
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5867, device='cuda:1')  +-  tensor(0.2856, device='cuda:1') (0.079)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8483, device='cuda:1')  +-  tensor(0.1244, device='cuda:1') (0.057)
Original Stability MCC for r=0.6 = 0.988 +- 0.056
Intervened Stability MCC for r=0.6 = 0.224 +- 0.379
Original Stability F1 for r=0.6 = 0.995 +- 0.020
Intervened Stability F1 for r=0.6 = 0.790 +- 0.112
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:56:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:56:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.901


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.093691
Plausibility completed in  0:00:19.985452
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6648, device='cuda:1')  +-  tensor(0.2584, device='cuda:1') (0.143)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6768, device='cuda:1')  +-  tensor(0.1664, device='cuda:1') (0.143)
Original Stability MCC for r=0.3 = 0.980 +- 0.075
Intervened Stability MCC for r=0.3 = 0.488 +- 0.375
Original Stability F1 for r=0.3 = 0.986 +- 0.051
Intervened Stability F1 for r=0.3 = 0.680 +- 0.226
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.820951
Plausibility completed in  0:00:19.695832
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9038, device='cuda:1')  +-  tensor(0.1946, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6805, device='cuda:1')  +-  tensor(0.2925, device='cuda:1') (0.098)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9038, device='cuda:1')  +-  tensor(0.1946, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8756, device='cuda:1')  +-  tensor(0.1656, device='cuda:1') (0.065)
Original Stability MCC for r=0.6 = 0.984 +- 0.058
Intervened Stability MCC for r=0.6 = 0.308 +- 0.436
Original Stability F1 for r=0.6 = 0.994 +- 0.021
Intervened Stability F1 for r=0.6 = 0.808 +- 0.122
Intervened samples: 2966
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:57:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:57:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:57:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:57:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.721


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.061386
Plausibility completed in  0:00:19.845303
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6460, device='cuda:1')  +-  tensor(0.2675, device='cuda:1') (0.111)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6812, device='cuda:1')  +-  tensor(0.1408, device='cuda:1') (0.119)
Original Stability MCC for r=0.3 = 0.987 +- 0.053
Intervened Stability MCC for r=0.3 = 0.541 +- 0.361
Original Stability F1 for r=0.3 = 0.991 +- 0.036
Intervened Stability F1 for r=0.3 = 0.716 +- 0.211
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.856506
Plausibility completed in  0:00:19.811446
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6345, device='cuda:1')  +-  tensor(0.2795, device='cuda:1') (0.094)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8707, device='cuda:1')  +-  tensor(0.1084, device='cuda:1') (0.069)
Original Stability MCC for r=0.6 = 0.985 +- 0.061
Intervened Stability MCC for r=0.6 = 0.361 +- 0.403
Original Stability F1 for r=0.6 = 0.995 +- 0.023
Intervened Stability F1 for r=0.6 = 0.815 +- 0.116
Intervened samples: 3000

\FINISHED GOODMotif2 - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.76367326 0.76345528] +- [0.07432533 0.07391123] (mean across ratios: 0.76 +- 0.05)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.64203911 0.63252198] +- [0.02083151 0.03000212] (mean across ratios: 0.64 +- 0.02)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.81151148 0.98362483] +- [0.05535978 0.00662554] (mean across ratios: 0.90 +- 0.03)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.66654621 0.87788632] +- [0.01946138 0.0184286 ] (mean across ratios: 0.77 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99123807 0.99491216] +- [0.00287931 0.00105262] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.68715619 0.82662171] +- [0.02870134 0.02996007] (mean across ratios: 0.76 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.98715749 0.98604356] +- [0.00426712 0.00315902] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.49200767 0.39153859] +- [0.05071791 0.13111846] (mean across ratios: 0.44 +- 0.07)

Overall time of execution:  0:05:40.219104
DONE LECI GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 09:59:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 09:59:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.660
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.741


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.196949
Plausibility completed in  0:00:19.826787
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6316, device='cuda:1')  +-  tensor(0.3093, device='cuda:1') (0.075)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6554, device='cuda:1')  +-  tensor(0.1784, device='cuda:1') (0.078)
Original Stability MCC for r=0.3 = 0.986 +- 0.054
Intervened Stability MCC for r=0.3 = 0.434 +- 0.445
Original Stability F1 for r=0.3 = 0.990 +- 0.037
Intervened Stability F1 for r=0.3 = 0.678 +- 0.241
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.965215
Plausibility completed in  0:00:20.109522
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5801, device='cuda:1')  +-  tensor(0.3181, device='cuda:1') (0.043)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9001, device='cuda:1')  +-  tensor(0.1110, device='cuda:1') (0.029)
Original Stability MCC for r=0.6 = 0.979 +- 0.088
Intervened Stability MCC for r=0.6 = 0.319 +- 0.408
Original Stability F1 for r=0.6 = 0.993 +- 0.029
Intervened Stability F1 for r=0.6 = 0.889 +- 0.118
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:00:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:00:11 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.702
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.770


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.008036
Plausibility completed in  0:00:20.090144
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6188, device='cuda:1')  +-  tensor(0.3181, device='cuda:1') (0.069)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6308, device='cuda:1')  +-  tensor(0.1660, device='cuda:1') (0.082)
Original Stability MCC for r=0.3 = 0.989 +- 0.044
Intervened Stability MCC for r=0.3 = 0.371 +- 0.461
Original Stability F1 for r=0.3 = 0.993 +- 0.030
Intervened Stability F1 for r=0.3 = 0.635 +- 0.264
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.009614
Plausibility completed in  0:00:19.923270
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5929, device='cuda:1')  +-  tensor(0.3189, device='cuda:1') (0.056)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8999, device='cuda:1')  +-  tensor(0.1123, device='cuda:1') (0.037)
Original Stability MCC for r=0.6 = 0.992 +- 0.038
Intervened Stability MCC for r=0.6 = 0.374 +- 0.448
Original Stability F1 for r=0.6 = 0.997 +- 0.014
Intervened Stability F1 for r=0.6 = 0.888 +- 0.123
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:01:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:01:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.684


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.149122
Plausibility completed in  0:00:19.985653
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6135, device='cuda:1')  +-  tensor(0.3114, device='cuda:1') (0.066)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6113, device='cuda:1')  +-  tensor(0.1842, device='cuda:1') (0.068)
Original Stability MCC for r=0.3 = 0.993 +- 0.036
Intervened Stability MCC for r=0.3 = 0.305 +- 0.445
Original Stability F1 for r=0.3 = 0.995 +- 0.025
Intervened Stability F1 for r=0.3 = 0.602 +- 0.248
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.971643
Plausibility completed in  0:00:19.961176
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6079, device='cuda:1')  +-  tensor(0.3208, device='cuda:1') (0.051)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8710, device='cuda:1')  +-  tensor(0.1221, device='cuda:1') (0.040)
Original Stability MCC for r=0.6 = 0.986 +- 0.060
Intervened Stability MCC for r=0.6 = 0.113 +- 0.294
Original Stability F1 for r=0.6 = 0.995 +- 0.022
Intervened Stability F1 for r=0.6 = 0.845 +- 0.114
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:02:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:02:27 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.901


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.151350
Plausibility completed in  0:00:19.889423
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6140, device='cuda:1')  +-  tensor(0.3042, device='cuda:1') (0.114)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6183, device='cuda:1')  +-  tensor(0.1708, device='cuda:1') (0.114)
Original Stability MCC for r=0.3 = 0.979 +- 0.079
Intervened Stability MCC for r=0.3 = 0.385 +- 0.423
Original Stability F1 for r=0.3 = 0.986 +- 0.053
Intervened Stability F1 for r=0.3 = 0.639 +- 0.243
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.917828
Plausibility completed in  0:00:19.681048
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9038, device='cuda:1')  +-  tensor(0.1946, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6291, device='cuda:1')  +-  tensor(0.3235, device='cuda:1') (0.080)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9038, device='cuda:1')  +-  tensor(0.1946, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8672, device='cuda:1')  +-  tensor(0.1739, device='cuda:1') (0.053)
Original Stability MCC for r=0.6 = 0.984 +- 0.062
Intervened Stability MCC for r=0.6 = 0.076 +- 0.316
Original Stability F1 for r=0.6 = 0.994 +- 0.023
Intervened Stability F1 for r=0.6 = 0.846 +- 0.127
Intervened samples: 2966
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:03:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:03:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.721


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.162605
Plausibility completed in  0:00:19.889253
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6181, device='cuda:1')  +-  tensor(0.2889, device='cuda:1') (0.101)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6342, device='cuda:1')  +-  tensor(0.1516, device='cuda:1') (0.098)
Original Stability MCC for r=0.3 = 0.986 +- 0.063
Intervened Stability MCC for r=0.3 = 0.416 +- 0.436
Original Stability F1 for r=0.3 = 0.990 +- 0.043
Intervened Stability F1 for r=0.3 = 0.671 +- 0.221
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.952558
Plausibility completed in  0:00:19.896404
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6102, device='cuda:1')  +-  tensor(0.3032, device='cuda:1') (0.064)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8767, device='cuda:1')  +-  tensor(0.1204, device='cuda:1') (0.048)
Original Stability MCC for r=0.6 = 0.985 +- 0.063
Intervened Stability MCC for r=0.6 = 0.121 +- 0.299
Original Stability F1 for r=0.6 = 0.995 +- 0.023
Intervened Stability F1 for r=0.6 = 0.846 +- 0.115
Intervened samples: 3000

\FINISHED GOODMotif2 - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.76367326 0.76345528] +- [0.07432533 0.07391123] (mean across ratios: 0.76 +- 0.05)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.61921382 0.60405371] +- [0.00655457 0.01660022] (mean across ratios: 0.61 +- 0.01)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.81151148 0.98362483] +- [0.05535978 0.00662554] (mean across ratios: 0.90 +- 0.03)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.62999721 0.88297565] +- [0.01516682 0.01421596] (mean across ratios: 0.76 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99085233 0.99457942] +- [0.00304361 0.00129974] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.645164   0.86264015] +- [0.02741746 0.02093857] (mean across ratios: 0.75 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.986581   0.98512652] +- [0.00451194 0.00395435] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.3821505  0.20080142] +- [0.04465938 0.12114229] (mean across ratios: 0.29 +- 0.06)

Overall time of execution:  0:05:42.684717
DONE LECI GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:05:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:05:00 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:05:00 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:05:00 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:05:00 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:05:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:05:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:05:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:05:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:05:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:05:00 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:05:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:05:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:05:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:05:00 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:05:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.591
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.618


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.290044
Plausibility completed in  0:00:19.767744
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2763, device='cuda:1') (0.089)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5324, device='cuda:1')  +-  tensor(0.1076, device='cuda:1') (0.100)
Original Stability MCC for r=0.3 = 0.888 +- 0.197
Intervened Stability MCC for r=0.3 = 0.375 +- 0.412
Original Stability F1 for r=0.3 = 0.927 +- 0.124
Intervened Stability F1 for r=0.3 = 0.616 +- 0.245
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.975739
Plausibility completed in  0:00:19.696053
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2892, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4747, device='cuda:1')  +-  tensor(0.2589, device='cuda:1') (0.066)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2892, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8635, device='cuda:1')  +-  tensor(0.1608, device='cuda:1') (0.043)
Original Stability MCC for r=0.6 = 0.959 +- 0.089
Intervened Stability MCC for r=0.6 = 0.526 +- 0.384
Original Stability F1 for r=0.6 = 0.985 +- 0.033
Intervened Stability F1 for r=0.6 = 0.862 +- 0.109
Intervened samples: 2944
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:06:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:06:09 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:06:09 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:06:09 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:06:09 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:06:09 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:06:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:06:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:06:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:06:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:06:09 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:06:09 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:06:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:06:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:06:09 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:06:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.480
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.512


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.116578
Plausibility completed in  0:00:20.032939
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5070, device='cuda:1')  +-  tensor(0.2748, device='cuda:1') (0.061)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6490, device='cuda:1')  +-  tensor(0.1318, device='cuda:1') (0.075)
Original Stability MCC for r=0.3 = 0.972 +- 0.076
Intervened Stability MCC for r=0.3 = 0.618 +- 0.319
Original Stability F1 for r=0.3 = 0.981 +- 0.052
Intervened Stability F1 for r=0.3 = 0.764 +- 0.182
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.093545
Plausibility completed in  0:00:19.879847
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5007, device='cuda:1')  +-  tensor(0.2695, device='cuda:1') (0.035)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9338, device='cuda:1')  +-  tensor(0.0862, device='cuda:1') (0.028)
Original Stability MCC for r=0.6 = 0.974 +- 0.085
Intervened Stability MCC for r=0.6 = 0.582 +- 0.371
Original Stability F1 for r=0.6 = 0.991 +- 0.030
Intervened Stability F1 for r=0.6 = 0.890 +- 0.098
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:07:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:07:17 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:07:17 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:07:17 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:07:17 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:07:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:07:17 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:07:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:07:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:07:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:07:17 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:07:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.683
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.726


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.088998
Plausibility completed in  0:00:20.016739
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5975, device='cuda:1')  +-  tensor(0.2733, device='cuda:1') (0.117)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6948, device='cuda:1')  +-  tensor(0.1367, device='cuda:1') (0.124)
Original Stability MCC for r=0.3 = 0.943 +- 0.153
Intervened Stability MCC for r=0.3 = 0.534 +- 0.389
Original Stability F1 for r=0.3 = 0.963 +- 0.098
Intervened Stability F1 for r=0.3 = 0.716 +- 0.221
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.068576
Plausibility completed in  0:00:19.759122
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5681, device='cuda:1')  +-  tensor(0.2714, device='cuda:1') (0.090)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9093, device='cuda:1')  +-  tensor(0.0986, device='cuda:1') (0.053)
Original Stability MCC for r=0.6 = 0.986 +- 0.055
Intervened Stability MCC for r=0.6 = 0.547 +- 0.362
Original Stability F1 for r=0.6 = 0.995 +- 0.020
Intervened Stability F1 for r=0.6 = 0.871 +- 0.100
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:08:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:08:25 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:08:25 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:08:25 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:08:25 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:08:25 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:08:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:08:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:08:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:08:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:08:25 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:08:25 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:08:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:08:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:08:25 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:08:25 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.483
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.517


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.241562
Plausibility completed in  0:00:20.029556
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5098, device='cuda:1')  +-  tensor(0.2964, device='cuda:1') (0.058)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5779, device='cuda:1')  +-  tensor(0.1317, device='cuda:1') (0.069)
Original Stability MCC for r=0.3 = 0.962 +- 0.100
Intervened Stability MCC for r=0.3 = 0.542 +- 0.372
Original Stability F1 for r=0.3 = 0.975 +- 0.065
Intervened Stability F1 for r=0.3 = 0.718 +- 0.213
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.041045
Plausibility completed in  0:00:20.033835
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4981, device='cuda:1')  +-  tensor(0.2867, device='cuda:1') (0.052)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9101, device='cuda:1')  +-  tensor(0.0918, device='cuda:1') (0.039)
Original Stability MCC for r=0.6 = 0.974 +- 0.083
Intervened Stability MCC for r=0.6 = 0.597 +- 0.367
Original Stability F1 for r=0.6 = 0.990 +- 0.030
Intervened Stability F1 for r=0.6 = 0.886 +- 0.099
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:09:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:09:33 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:09:33 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:09:33 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:09:33 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:09:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:09:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:09:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:09:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:09:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:09:33 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:09:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:09:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:09:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:09:33 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:09:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.373
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.475


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.252090
Plausibility completed in  0:00:19.882563
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3317, device='cuda:1')  +-  tensor(0.1660, device='cuda:1') (0.092)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5530, device='cuda:1')  +-  tensor(0.1396, device='cuda:1') (0.093)
Original Stability MCC for r=0.3 = 0.943 +- 0.138
Intervened Stability MCC for r=0.3 = 0.449 +- 0.388
Original Stability F1 for r=0.3 = 0.961 +- 0.093
Intervened Stability F1 for r=0.3 = 0.658 +- 0.225
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.967346
Plausibility completed in  0:00:19.525881
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4706, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3092, device='cuda:1')  +-  tensor(0.1797, device='cuda:1') (0.070)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4706, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8663, device='cuda:1')  +-  tensor(0.1594, device='cuda:1') (0.049)
Original Stability MCC for r=0.6 = 0.980 +- 0.066
Intervened Stability MCC for r=0.6 = 0.509 +- 0.427
Original Stability F1 for r=0.6 = 0.992 +- 0.025
Intervened Stability F1 for r=0.6 = 0.860 +- 0.114
Intervened samples: 2944

\FINISHED GOODMotif2 - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.56387447 0.56376567] +- [0.09189798 0.09200944] (mean across ratios: 0.56 +- 0.07)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.49081531 0.47015355] +- [0.08672783 0.08626457] (mean across ratios: 0.48 +- 0.06)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.67785167 0.96908485] +- [0.09343448 0.01478117] (mean across ratios: 0.82 +- 0.05)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.60140479 0.89661443] +- [0.06107018 0.02733431] (mean across ratios: 0.75 +- 0.03)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.96142797 0.99059889] +- [0.01872592 0.00335779] (mean across ratios: 0.98 +- 0.01)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.69432319 0.87384425] +- [0.05162872 0.01222   ] (mean across ratios: 0.78 +- 0.03)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.94169515 0.97458205] +- [0.02913966 0.00901789] (mean across ratios: 0.96 +- 0.02)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.50344058 0.55216758] +- [0.0837007 0.0329658] (mean across ratios: 0.53 +- 0.04)

Overall time of execution:  0:05:43.311580
DONE CIGA GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:11:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:11:01 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:11:01 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:11:01 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:11:01 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:11:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:11:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:11:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:11:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:11:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:11:01 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:11:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:11:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:11:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:11:01 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:11:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.590
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.618


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.162891
Plausibility completed in  0:00:19.119192
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5338, device='cuda:1')  +-  tensor(0.3273, device='cuda:1') (0.065)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5187, device='cuda:1')  +-  tensor(0.1222, device='cuda:1') (0.074)
Original Stability MCC for r=0.3 = 0.887 +- 0.197
Intervened Stability MCC for r=0.3 = 0.177 +- 0.444
Original Stability F1 for r=0.3 = 0.926 +- 0.124
Intervened Stability F1 for r=0.3 = 0.533 +- 0.252
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.030461
Plausibility completed in  0:00:18.801294
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2892, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4904, device='cuda:1')  +-  tensor(0.2972, device='cuda:1') (0.042)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2892, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8681, device='cuda:1')  +-  tensor(0.1583, device='cuda:1') (0.039)
Original Stability MCC for r=0.6 = 0.961 +- 0.087
Intervened Stability MCC for r=0.6 = 0.219 +- 0.353
Original Stability F1 for r=0.6 = 0.985 +- 0.032
Intervened Stability F1 for r=0.6 = 0.859 +- 0.100
Intervened samples: 2944
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:12:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:12:08 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:12:08 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:12:08 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:12:08 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:12:08 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:12:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:12:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:12:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:12:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:12:08 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:12:08 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:12:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:12:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:12:08 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:12:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.479
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.512


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.965351
Plausibility completed in  0:00:19.322553
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5274, device='cuda:1')  +-  tensor(0.3030, device='cuda:1') (0.053)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6377, device='cuda:1')  +-  tensor(0.1615, device='cuda:1') (0.064)
Original Stability MCC for r=0.3 = 0.973 +- 0.075
Intervened Stability MCC for r=0.3 = 0.460 +- 0.404
Original Stability F1 for r=0.3 = 0.981 +- 0.051
Intervened Stability F1 for r=0.3 = 0.698 +- 0.195
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.920692
Plausibility completed in  0:00:19.165454
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4979, device='cuda:1')  +-  tensor(0.2786, device='cuda:1') (0.031)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9133, device='cuda:1')  +-  tensor(0.1039, device='cuda:1') (0.027)
Original Stability MCC for r=0.6 = 0.975 +- 0.083
Intervened Stability MCC for r=0.6 = 0.318 +- 0.434
Original Stability F1 for r=0.6 = 0.991 +- 0.030
Intervened Stability F1 for r=0.6 = 0.889 +- 0.107
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:13:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:13:14 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:13:14 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:13:14 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:13:14 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:13:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:13:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:13:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:13:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:13:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:13:14 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:13:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:13:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:13:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:13:14 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:13:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.684
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.726


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.139972
Plausibility completed in  0:00:19.285125
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5824, device='cuda:1')  +-  tensor(0.3181, device='cuda:1') (0.090)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6421, device='cuda:1')  +-  tensor(0.1546, device='cuda:1') (0.100)
Original Stability MCC for r=0.3 = 0.944 +- 0.153
Intervened Stability MCC for r=0.3 = 0.343 +- 0.461
Original Stability F1 for r=0.3 = 0.964 +- 0.098
Intervened Stability F1 for r=0.3 = 0.630 +- 0.246
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.932982
Plausibility completed in  0:00:19.273710
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5435, device='cuda:1')  +-  tensor(0.3151, device='cuda:1') (0.052)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8948, device='cuda:1')  +-  tensor(0.1096, device='cuda:1') (0.041)
Original Stability MCC for r=0.6 = 0.985 +- 0.058
Intervened Stability MCC for r=0.6 = 0.298 +- 0.401
Original Stability F1 for r=0.6 = 0.995 +- 0.021
Intervened Stability F1 for r=0.6 = 0.872 +- 0.106
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:14:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:14:20 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:14:20 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:14:20 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:14:20 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:14:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:14:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:14:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:14:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:14:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:14:20 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:14:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:14:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:14:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:14:20 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:14:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.484
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.517


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.101358
Plausibility completed in  0:00:19.412588
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5463, device='cuda:1')  +-  tensor(0.3285, device='cuda:1') (0.050)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.1533, device='cuda:1') (0.062)
Original Stability MCC for r=0.3 = 0.963 +- 0.099
Intervened Stability MCC for r=0.3 = 0.340 +- 0.447
Original Stability F1 for r=0.3 = 0.976 +- 0.064
Intervened Stability F1 for r=0.3 = 0.631 +- 0.220
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.932942
Plausibility completed in  0:00:19.176930
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5277, device='cuda:1')  +-  tensor(0.3240, device='cuda:1') (0.037)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9057, device='cuda:1')  +-  tensor(0.1036, device='cuda:1') (0.031)
Original Stability MCC for r=0.6 = 0.976 +- 0.078
Intervened Stability MCC for r=0.6 = 0.306 +- 0.421
Original Stability F1 for r=0.6 = 0.991 +- 0.027
Intervened Stability F1 for r=0.6 = 0.885 +- 0.104
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:15:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:15:26 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:15:26 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:15:26 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:15:26 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:15:26 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:15:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:15:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:15:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:15:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:15:26 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:15:26 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:15:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:15:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:15:26 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:15:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.373
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.475


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.109616
Plausibility completed in  0:00:19.190529
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.2093, device='cuda:1') (0.075)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5477, device='cuda:1')  +-  tensor(0.1580, device='cuda:1') (0.072)
Original Stability MCC for r=0.3 = 0.942 +- 0.138
Intervened Stability MCC for r=0.3 = 0.288 +- 0.397
Original Stability F1 for r=0.3 = 0.961 +- 0.093
Intervened Stability F1 for r=0.3 = 0.596 +- 0.206
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.824868
Plausibility completed in  0:00:18.830116
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4706, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2837, device='cuda:1')  +-  tensor(0.2040, device='cuda:1') (0.048)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4706, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8631, device='cuda:1')  +-  tensor(0.1606, device='cuda:1') (0.034)
Original Stability MCC for r=0.6 = 0.980 +- 0.063
Intervened Stability MCC for r=0.6 = 0.297 +- 0.457
Original Stability F1 for r=0.6 = 0.993 +- 0.024
Intervened Stability F1 for r=0.6 = 0.860 +- 0.106
Intervened samples: 2944

\FINISHED GOODMotif2 - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.5638744  0.56376567] +- [0.09189802 0.09200944] (mean across ratios: 0.56 +- 0.07)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.50270667 0.46864238] +- [0.09158243 0.09446894] (mean across ratios: 0.49 +- 0.07)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.67785167 0.96908485] +- [0.09343448 0.01478117] (mean across ratios: 0.82 +- 0.05)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.58480536 0.88901621] +- [0.04871116 0.02004467] (mean across ratios: 0.74 +- 0.03)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.961509   0.99097303] +- [0.01915811 0.00310458] (mean across ratios: 0.98 +- 0.01)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.61757764 0.87287749] +- [0.05370184 0.01236168] (mean across ratios: 0.75 +- 0.03)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.94182192 0.97560028] +- [0.02973859 0.00831824] (mean across ratios: 0.96 +- 0.02)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.32164665 0.28753231] +- [0.09158005 0.0351978 ] (mean across ratios: 0.30 +- 0.05)

Overall time of execution:  0:05:32.692537
DONE CIGA GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:16:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:16:51 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:16:51 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:16:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:16:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:16:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:16:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:16:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:16:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:16:51 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 10:16:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.576
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.111572
Plausibility completed in  0:00:19.770047
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3765, device='cuda:1')  +-  tensor(0.2188, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3861, device='cuda:1')  +-  tensor(0.0661, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.994 +- 0.047
Intervened Stability MCC for r=0.3 = 0.031 +- 0.231
Original Stability F1 for r=0.3 = 0.996 +- 0.030
Intervened Stability F1 for r=0.3 = 0.361 +- 0.154
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.862679
Plausibility completed in  0:00:19.798257
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3759, device='cuda:1')  +-  tensor(0.2172, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7146, device='cuda:1')  +-  tensor(0.0706, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.996 +- 0.031
Intervened Stability MCC for r=0.6 = 0.132 +- 0.328
Original Stability F1 for r=0.6 = 0.998 +- 0.011
Intervened Stability F1 for r=0.6 = 0.732 +- 0.118
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:18:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:18:00 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:18:00 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:18:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:18:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:18:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:18:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:18:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:18:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:18:00 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 10:18:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.043481
Plausibility completed in  0:00:19.852830
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3726, device='cuda:1')  +-  tensor(0.2156, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3783, device='cuda:1')  +-  tensor(0.0587, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.995 +- 0.044
Intervened Stability MCC for r=0.3 = 0.027 +- 0.246
Original Stability F1 for r=0.3 = 0.997 +- 0.029
Intervened Stability F1 for r=0.3 = 0.354 +- 0.160
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.072719
Plausibility completed in  0:00:19.778507
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3715, device='cuda:1')  +-  tensor(0.2142, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7137, device='cuda:1')  +-  tensor(0.0696, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.995 +- 0.033
Intervened Stability MCC for r=0.6 = 0.126 +- 0.305
Original Stability F1 for r=0.6 = 0.998 +- 0.012
Intervened Stability F1 for r=0.6 = 0.734 +- 0.104
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:19:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:19:08 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:19:08 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:19:08 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:19:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:19:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:19:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:19:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:19:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:19:08 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 10:19:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.071254
Plausibility completed in  0:00:20.015153
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3704, device='cuda:1')  +-  tensor(0.2159, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3796, device='cuda:1')  +-  tensor(0.0614, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.995 +- 0.038
Intervened Stability MCC for r=0.3 = 0.029 +- 0.250
Original Stability F1 for r=0.3 = 0.997 +- 0.026
Intervened Stability F1 for r=0.3 = 0.354 +- 0.165
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.880050
Plausibility completed in  0:00:20.108732
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3696, device='cuda:1')  +-  tensor(0.2149, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7113, device='cuda:1')  +-  tensor(0.0696, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.025
Intervened Stability MCC for r=0.6 = 0.125 +- 0.323
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.728 +- 0.118
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:20:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:20:16 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:20:16 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:20:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:20:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:20:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:20:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:20:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:20:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:20:16 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 10:20:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.940894
Plausibility completed in  0:00:20.046713
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3704, device='cuda:1')  +-  tensor(0.2142, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3784, device='cuda:1')  +-  tensor(0.0593, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.998 +- 0.019
Intervened Stability MCC for r=0.3 = 0.025 +- 0.232
Original Stability F1 for r=0.3 = 0.999 +- 0.013
Intervened Stability F1 for r=0.3 = 0.354 +- 0.157
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.932083
Plausibility completed in  0:00:19.832427
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3701, device='cuda:1')  +-  tensor(0.2140, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.0717, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.024
Intervened Stability MCC for r=0.6 = 0.079 +- 0.301
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.724 +- 0.113
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:21:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:21:23 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:21:23 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:21:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:21:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:21:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:21:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:21:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:21:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:21:23 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 10:21:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.041027
Plausibility completed in  0:00:19.915748
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3736, device='cuda:1')  +-  tensor(0.2166, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3783, device='cuda:1')  +-  tensor(0.0592, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.993 +- 0.053
Intervened Stability MCC for r=0.3 = 0.029 +- 0.249
Original Stability F1 for r=0.3 = 0.996 +- 0.035
Intervened Stability F1 for r=0.3 = 0.355 +- 0.162
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.901080
Plausibility completed in  0:00:19.635610
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3723, device='cuda:1')  +-  tensor(0.2151, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7117, device='cuda:1')  +-  tensor(0.0670, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.998 +- 0.021
Intervened Stability MCC for r=0.6 = 0.164 +- 0.319
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.740 +- 0.113
Intervened samples: 3000

\FINISHED GOODMotif2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.32386574 0.32386574] +- [0.00206968 0.00206968] (mean across ratios: 0.32 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.37269105 0.37190349] +- [0.00227819 0.00222553] (mean across ratios: 0.37 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33397881 0.63404307] +- [0.0018042  0.00155564] (mean across ratios: 0.48 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.38014901 0.7133482 ] +- [0.00302763 0.00159989] (mean across ratios: 0.55 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99674532 0.99868805] +- [0.00102989 0.00030535] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.35581267 0.73164996] +- [0.00263506 0.00520078] (mean across ratios: 0.54 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99513783 0.99645405] +- [0.00154642 0.00082551] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.02816873 0.12499793] +- [0.00216295 0.02724194] (mean across ratios: 0.08 +- 0.01)

Overall time of execution:  0:05:41.558313
DONE GSAT GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:22:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:22:50 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:22:50 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:22:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:22:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:22:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:22:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:22:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:22:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:22:50 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 10:22:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.576
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.233275
Plausibility completed in  0:00:19.614939
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4337, device='cuda:1')  +-  tensor(0.2689, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4407, device='cuda:1')  +-  tensor(0.0999, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.994 +- 0.047
Intervened Stability MCC for r=0.3 = 0.095 +- 0.265
Original Stability F1 for r=0.3 = 0.996 +- 0.030
Intervened Stability F1 for r=0.3 = 0.465 +- 0.191
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.988220
Plausibility completed in  0:00:19.968227
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4250, device='cuda:1')  +-  tensor(0.2572, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8027, device='cuda:1')  +-  tensor(0.1150, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.995 +- 0.034
Intervened Stability MCC for r=0.6 = -0.008 +- 0.179
Original Stability F1 for r=0.6 = 0.998 +- 0.013
Intervened Stability F1 for r=0.6 = 0.799 +- 0.130
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:23:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:23:58 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:23:58 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:23:58 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:23:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:23:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:23:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:23:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:23:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:23:58 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 10:23:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.025884
Plausibility completed in  0:00:19.609519
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4299, device='cuda:1')  +-  tensor(0.2666, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4314, device='cuda:1')  +-  tensor(0.0894, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.996 +- 0.039
Intervened Stability MCC for r=0.3 = 0.074 +- 0.238
Original Stability F1 for r=0.3 = 0.997 +- 0.025
Intervened Stability F1 for r=0.3 = 0.455 +- 0.168
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.168542
Plausibility completed in  0:00:19.556027
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4128, device='cuda:1')  +-  tensor(0.2453, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7895, device='cuda:1')  +-  tensor(0.1004, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.995 +- 0.032
Intervened Stability MCC for r=0.6 = 0.018 +- 0.224
Original Stability F1 for r=0.6 = 0.998 +- 0.012
Intervened Stability F1 for r=0.6 = 0.789 +- 0.119
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:25:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:25:05 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:25:05 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:25:05 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:25:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:25:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:25:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:25:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:25:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:25:05 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 10:25:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.173409
Plausibility completed in  0:00:19.709169
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4277, device='cuda:1')  +-  tensor(0.2664, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4326, device='cuda:1')  +-  tensor(0.0921, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.995 +- 0.036
Intervened Stability MCC for r=0.3 = 0.051 +- 0.245
Original Stability F1 for r=0.3 = 0.997 +- 0.025
Intervened Stability F1 for r=0.3 = 0.444 +- 0.167
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.180466
Plausibility completed in  0:00:19.651703
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4174, device='cuda:1')  +-  tensor(0.2544, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7948, device='cuda:1')  +-  tensor(0.1056, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.024
Intervened Stability MCC for r=0.6 = 0.004 +- 0.204
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.794 +- 0.132
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:26:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:26:12 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:26:12 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:26:12 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:26:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:26:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:26:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:26:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:26:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:26:12 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 10:26:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.226276
Plausibility completed in  0:00:19.781040
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4262, device='cuda:1')  +-  tensor(0.2647, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.0894, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.997 +- 0.021
Intervened Stability MCC for r=0.3 = 0.049 +- 0.233
Original Stability F1 for r=0.3 = 0.998 +- 0.015
Intervened Stability F1 for r=0.3 = 0.446 +- 0.158
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.023589
Plausibility completed in  0:00:19.985449
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4169, device='cuda:1')  +-  tensor(0.2526, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8021, device='cuda:1')  +-  tensor(0.1150, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.996 +- 0.027
Intervened Stability MCC for r=0.6 = -0.008 +- 0.202
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.793 +- 0.138
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:27:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/18/2024 10:27:21 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:27:21 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:27:21 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:27:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:27:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:27:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:27:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:27:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:27:21 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 10:27:21 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.029329
Plausibility completed in  0:00:19.976353
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4306, device='cuda:1')  +-  tensor(0.2669, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4309, device='cuda:1')  +-  tensor(0.0889, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.993 +- 0.051
Intervened Stability MCC for r=0.3 = 0.087 +- 0.243
Original Stability F1 for r=0.3 = 0.996 +- 0.034
Intervened Stability F1 for r=0.3 = 0.461 +- 0.169
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.026344
Plausibility completed in  0:00:19.629305
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4230, device='cuda:1')  +-  tensor(0.2566, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8017, device='cuda:1')  +-  tensor(0.1134, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.020
Intervened Stability MCC for r=0.6 = 0.012 +- 0.204
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.799 +- 0.130
Intervened samples: 3000

\FINISHED GOODMotif2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.32386587 0.32386593] +- [0.00206954 0.00206947] (mean across ratios: 0.32 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.42961748 0.41900239] +- [0.00257281 0.00442075] (mean across ratios: 0.42 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33397881 0.634043  ] +- [0.0018042  0.00155565] (mean across ratios: 0.48 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.43333601 0.79815687] +- [0.00371939 0.00518138] (mean across ratios: 0.62 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99684275 0.99862297] +- [0.00095019 0.0003469 ] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.45439619 0.79506848] +- [0.00836689 0.00390428] (mean across ratios: 0.62 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99529269 0.99628584] +- [0.0014449  0.00095342] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.07128592 0.00348916] +- [0.01837039 0.01043072] (mean across ratios: 0.04 +- 0.01)

Overall time of execution:  0:05:40.636482
DONE GSAT GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:28:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:28:47 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:28:59 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:01 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:03 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:07 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:29:13 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.378
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.462


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.125804
Plausibility completed in  0:00:19.754656
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4084, device='cuda:1')  +-  tensor(0.2051, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4826, device='cuda:1')  +-  tensor(0.2610, device='cuda:1') (0.027)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4084, device='cuda:1')  +-  tensor(0.2051, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5949, device='cuda:1')  +-  tensor(0.1142, device='cuda:1') (0.023)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.702 +- 0.286
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.864 +- 0.127
Intervened samples: 2968


ratio=0.6


Interventions completed in  0:00:06.024950
Plausibility completed in  0:00:19.631392
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4077, device='cuda:1')  +-  tensor(0.2058, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4561, device='cuda:1')  +-  tensor(0.2468, device='cuda:1') (0.012)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4077, device='cuda:1')  +-  tensor(0.2058, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8516, device='cuda:1')  +-  tensor(0.1566, device='cuda:1') (0.010)
Original Stability MCC for r=0.6 = 1.000 +- 0.008
Intervened Stability MCC for r=0.6 = 0.477 +- 0.420
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.920 +- 0.069
Intervened samples: 2936
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:30:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:21 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:33 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:35 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:37 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:40 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:30:47 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.368
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.796759
Plausibility completed in  0:00:19.784982
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4128, device='cuda:1')  +-  tensor(0.1930, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4657, device='cuda:1')  +-  tensor(0.2511, device='cuda:1') (0.020)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4128, device='cuda:1')  +-  tensor(0.1930, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5912, device='cuda:1')  +-  tensor(0.1354, device='cuda:1') (0.015)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.813 +- 0.272
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.915 +- 0.120
Intervened samples: 2924


ratio=0.6


Interventions completed in  0:00:05.597948
Plausibility completed in  0:00:18.756488
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4052, device='cuda:1')  +-  tensor(0.1904, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4133, device='cuda:1')  +-  tensor(0.2315, device='cuda:1') (0.007)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4052, device='cuda:1')  +-  tensor(0.1904, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8212, device='cuda:1')  +-  tensor(0.2278, device='cuda:1') (0.007)
Original Stability MCC for r=0.6 = 1.000 +- 0.006
Intervened Stability MCC for r=0.6 = 0.631 +- 0.394
Original Stability F1 for r=0.6 = 1.000 +- 0.002
Intervened Stability F1 for r=0.6 = 0.947 +- 0.065
Intervened samples: 2813
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:31:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:31:52 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:04 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:06 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:08 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:11 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:32:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.590


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.059564
Plausibility completed in  0:00:19.832429
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5883, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6338, device='cuda:1')  +-  tensor(0.3268, device='cuda:1') (0.039)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5883, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7113, device='cuda:1')  +-  tensor(0.1730, device='cuda:1') (0.031)
Original Stability MCC for r=0.3 = 1.000 +- 0.004
Intervened Stability MCC for r=0.3 = 0.836 +- 0.260
Original Stability F1 for r=0.3 = 1.000 +- 0.003
Intervened Stability F1 for r=0.3 = 0.918 +- 0.128
Intervened samples: 2968


ratio=0.6


Interventions completed in  0:00:06.002574
Plausibility completed in  0:00:19.416658
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5913, device='cuda:1')  +-  tensor(0.3100, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6044, device='cuda:1')  +-  tensor(0.3279, device='cuda:1') (0.023)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5913, device='cuda:1')  +-  tensor(0.3100, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9126, device='cuda:1')  +-  tensor(0.1788, device='cuda:1') (0.010)
Original Stability MCC for r=0.6 = 0.998 +- 0.019
Intervened Stability MCC for r=0.6 = 0.698 +- 0.390
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.949 +- 0.072
Intervened samples: 2911
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:33:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:23 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:35 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:37 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:39 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:42 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:48 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:33:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.354
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.368


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.990781
Plausibility completed in  0:00:19.718769
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4013, device='cuda:1')  +-  tensor(0.2246, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3546, device='cuda:1')  +-  tensor(0.2489, device='cuda:1') (0.029)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4013, device='cuda:1')  +-  tensor(0.2246, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5886, device='cuda:1')  +-  tensor(0.2007, device='cuda:1') (0.024)
Original Stability MCC for r=0.3 = 0.999 +- 0.015
Intervened Stability MCC for r=0.3 = 0.555 +- 0.337
Original Stability F1 for r=0.3 = 0.999 +- 0.010
Intervened Stability F1 for r=0.3 = 0.753 +- 0.184
Intervened samples: 2933


ratio=0.6


Interventions completed in  0:00:05.489893
Plausibility completed in  0:00:18.245938
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3880, device='cuda:1')  +-  tensor(0.2238, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3226, device='cuda:1')  +-  tensor(0.2450, device='cuda:1') (0.010)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3880, device='cuda:1')  +-  tensor(0.2238, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7592, device='cuda:1')  +-  tensor(0.2496, device='cuda:1') (0.015)
Original Stability MCC for r=0.6 = 0.992 +- 0.037
Intervened Stability MCC for r=0.6 = 0.476 +- 0.405
Original Stability F1 for r=0.6 = 0.997 +- 0.014
Intervened Stability F1 for r=0.6 = 0.858 +- 0.110
Intervened samples: 2750
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:34:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:34:54 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:05 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:07 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:09 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:13 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:35:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.246
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.313


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.805522
Plausibility completed in  0:00:19.703525
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3874, device='cuda:1')  +-  tensor(0.1973, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4458, device='cuda:1')  +-  tensor(0.2823, device='cuda:1') (0.030)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3874, device='cuda:1')  +-  tensor(0.1973, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5348, device='cuda:1')  +-  tensor(0.1431, device='cuda:1') (0.020)
Original Stability MCC for r=0.3 = 0.999 +- 0.011
Intervened Stability MCC for r=0.3 = 0.563 +- 0.429
Original Stability F1 for r=0.3 = 1.000 +- 0.007
Intervened Stability F1 for r=0.3 = 0.767 +- 0.225
Intervened samples: 2911


ratio=0.6


Interventions completed in  0:00:05.735037
Plausibility completed in  0:00:19.207826
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3863, device='cuda:1')  +-  tensor(0.1980, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4217, device='cuda:1')  +-  tensor(0.2707, device='cuda:1') (0.019)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3863, device='cuda:1')  +-  tensor(0.1980, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7708, device='cuda:1')  +-  tensor(0.1886, device='cuda:1') (0.009)
Original Stability MCC for r=0.6 = 0.995 +- 0.042
Intervened Stability MCC for r=0.6 = 0.450 +- 0.408
Original Stability F1 for r=0.6 = 0.998 +- 0.014
Intervened Stability F1 for r=0.6 = 0.871 +- 0.094
Intervened samples: 2875

\FINISHED GOODMotif - LECIvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.43966458 0.43569882] +- [0.07480466 0.07828853] (mean across ratios: 0.44 +- 0.05)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.47652681 0.44361786] +- [0.09022388 0.0917045 ] (mean across ratios: 0.46 +- 0.06)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.42262406 0.74341855] +- [0.061278   0.06434162] (mean across ratios: 0.58 +- 0.04)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.60416553 0.82309207] +- [0.05793759 0.05595181] (mean across ratios: 0.71 +- 0.04)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99971789 0.99887141] +- [0.00034053 0.00108718] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.84352058 0.90894767] +- [0.07088453 0.03791508] (mean across ratios: 0.88 +- 0.04)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99958508 0.99691794] +- [0.00050207 0.00296586] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.69369076 0.54636558] +- [0.11909288 0.0993249 ] (mean across ratios: 0.62 +- 0.08)

Overall time of execution:  0:07:39.615393
DONE LECI GOODMotif/size 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:36:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:36:44 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:36:56 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:36:58 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:00 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:04 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:37:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.378
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.462


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.237304
Plausibility completed in  0:00:19.704156
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4084, device='cuda:1')  +-  tensor(0.2051, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5334, device='cuda:1')  +-  tensor(0.2908, device='cuda:1') (0.017)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4084, device='cuda:1')  +-  tensor(0.2051, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6271, device='cuda:1')  +-  tensor(0.1332, device='cuda:1') (0.017)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.551 +- 0.380
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.824 +- 0.143
Intervened samples: 2968


ratio=0.6


Interventions completed in  0:00:05.954616
Plausibility completed in  0:00:19.619328
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4077, device='cuda:1')  +-  tensor(0.2058, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4867, device='cuda:1')  +-  tensor(0.2654, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4077, device='cuda:1')  +-  tensor(0.2058, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8915, device='cuda:1')  +-  tensor(0.1587, device='cuda:1') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.008
Intervened Stability MCC for r=0.6 = 0.193 +- 0.357
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.915 +- 0.066
Intervened samples: 2936
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:38:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:19 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:30 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:32 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:34 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:38 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:38:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.368
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.116749
Plausibility completed in  0:00:19.503157
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4128, device='cuda:1')  +-  tensor(0.1930, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5040, device='cuda:1')  +-  tensor(0.2728, device='cuda:1') (0.016)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4128, device='cuda:1')  +-  tensor(0.1930, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6241, device='cuda:1')  +-  tensor(0.1485, device='cuda:1') (0.014)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.682 +- 0.376
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.874 +- 0.145
Intervened samples: 2924


ratio=0.6


Interventions completed in  0:00:05.712147
Plausibility completed in  0:00:18.696313
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4052, device='cuda:1')  +-  tensor(0.1904, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4299, device='cuda:1')  +-  tensor(0.2413, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4052, device='cuda:1')  +-  tensor(0.1904, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8587, device='cuda:1')  +-  tensor(0.2352, device='cuda:1') (0.005)
Original Stability MCC for r=0.6 = 0.999 +- 0.009
Intervened Stability MCC for r=0.6 = 0.387 +- 0.430
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.941 +- 0.065
Intervened samples: 2813
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:39:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:39:49 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:01 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:03 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:05 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:08 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:40:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.590


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.022245
Plausibility completed in  0:00:19.963926
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5883, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6672, device='cuda:1')  +-  tensor(0.3306, device='cuda:1') (0.039)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5883, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7265, device='cuda:1')  +-  tensor(0.1752, device='cuda:1') (0.031)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.700 +- 0.359
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.869 +- 0.155
Intervened samples: 2968


ratio=0.6


Interventions completed in  0:00:05.909809
Plausibility completed in  0:00:19.364604
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5913, device='cuda:1')  +-  tensor(0.3100, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6220, device='cuda:1')  +-  tensor(0.3329, device='cuda:1') (0.020)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5913, device='cuda:1')  +-  tensor(0.3100, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9254, device='cuda:1')  +-  tensor(0.1781, device='cuda:1') (0.006)
Original Stability MCC for r=0.6 = 0.998 +- 0.021
Intervened Stability MCC for r=0.6 = 0.368 +- 0.442
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.943 +- 0.068
Intervened samples: 2911
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:41:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:21 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:33 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:35 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:37 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:40 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:41:47 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.354
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.368


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.114834
Plausibility completed in  0:00:19.569283
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4013, device='cuda:1')  +-  tensor(0.2246, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3537, device='cuda:1')  +-  tensor(0.2544, device='cuda:1') (0.024)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4013, device='cuda:1')  +-  tensor(0.2246, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6096, device='cuda:1')  +-  tensor(0.2036, device='cuda:1') (0.018)
Original Stability MCC for r=0.3 = 0.999 +- 0.016
Intervened Stability MCC for r=0.3 = 0.461 +- 0.383
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.723 +- 0.196
Intervened samples: 2933


ratio=0.6


Interventions completed in  0:00:05.812777
Plausibility completed in  0:00:18.300317
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3880, device='cuda:1')  +-  tensor(0.2238, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3205, device='cuda:1')  +-  tensor(0.2358, device='cuda:1') (0.007)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3880, device='cuda:1')  +-  tensor(0.2238, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7907, device='cuda:1')  +-  tensor(0.2575, device='cuda:1') (0.010)
Original Stability MCC for r=0.6 = 0.992 +- 0.038
Intervened Stability MCC for r=0.6 = 0.434 +- 0.417
Original Stability F1 for r=0.6 = 0.997 +- 0.014
Intervened Stability F1 for r=0.6 = 0.874 +- 0.099
Intervened samples: 2750
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:42:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:42:52 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:03 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:05 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:07 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:10 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/18/2024 10:43:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.246
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.313


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.074295
Plausibility completed in  0:00:19.465796
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3874, device='cuda:1')  +-  tensor(0.1973, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4880, device='cuda:1')  +-  tensor(0.3047, device='cuda:1') (0.027)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3874, device='cuda:1')  +-  tensor(0.1973, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5494, device='cuda:1')  +-  tensor(0.1528, device='cuda:1') (0.016)
Original Stability MCC for r=0.3 = 0.999 +- 0.013
Intervened Stability MCC for r=0.3 = 0.390 +- 0.489
Original Stability F1 for r=0.3 = 0.999 +- 0.008
Intervened Stability F1 for r=0.3 = 0.697 +- 0.239
Intervened samples: 2911


ratio=0.6


Interventions completed in  0:00:05.834353
Plausibility completed in  0:00:19.202127
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3863, device='cuda:1')  +-  tensor(0.1980, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4399, device='cuda:1')  +-  tensor(0.2830, device='cuda:1') (0.013)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3863, device='cuda:1')  +-  tensor(0.1980, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7907, device='cuda:1')  +-  tensor(0.1907, device='cuda:1') (0.008)
Original Stability MCC for r=0.6 = 0.996 +- 0.034
Intervened Stability MCC for r=0.6 = 0.339 +- 0.417
Original Stability F1 for r=0.6 = 0.999 +- 0.012
Intervened Stability F1 for r=0.6 = 0.867 +- 0.092
Intervened samples: 2875

\FINISHED GOODMotif - LECIvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.43966458 0.43569882] +- [0.07480466 0.07828853] (mean across ratios: 0.44 +- 0.05)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.50925706 0.45982229] +- [0.10019342 0.09771623] (mean across ratios: 0.48 +- 0.07)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.42262406 0.74341855] +- [0.061278   0.06434162] (mean across ratios: 0.58 +- 0.04)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.62734408 0.85139496] +- [0.05695898 0.05386906] (mean across ratios: 0.74 +- 0.04)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99971106 0.99892594] +- [0.00036232 0.00100552] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.79742354 0.9079237 ] +- [0.07381639 0.03225984] (mean across ratios: 0.85 +- 0.04)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.9995741  0.99709889] +- [0.00053615 0.00273182] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.5569152  0.34416142] +- [0.12114851 0.08167644] (mean across ratios: 0.45 +- 0.07)

Overall time of execution:  0:07:40.494279
DONE LECI GOODMotif/size 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:44:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:44:43 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:44:54 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:44:56 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:44:58 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:45:02 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:45:08 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:45:08 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:45:08 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:45:08 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:45:08 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:45:08 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:45:08 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:45:08 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:45:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8899
Train Loss: 0.5257
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.4847
ID Test ACCURACY: 0.8937
ID Test Loss: 0.5229
OOD Validation ACCURACY: 0.6193
OOD Validation Loss: 1.1712
OOD Test ACCURACY: 0.4250
OOD Test Loss: 6.2644

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.8699
Train Loss: 0.5291
ID Validation ACCURACY: 0.8790
ID Validation Loss: 0.4662
ID Test ACCURACY: 0.8723
ID Test Loss: 0.5479
OOD Validation ACCURACY: 0.7500
OOD Validation Loss: 0.6795
OOD Test ACCURACY: 0.4680
OOD Test Loss: 3.3662

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.4250 0.8723 0.4680 0.8790 0.7500[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.443
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.530


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.251904
Plausibility completed in  0:00:19.267554
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5283, device='cuda:1')  +-  tensor(0.3084, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5767, device='cuda:1')  +-  tensor(0.3259, device='cuda:1') (0.046)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5283, device='cuda:1')  +-  tensor(0.3084, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6462, device='cuda:1')  +-  tensor(0.1912, device='cuda:1') (0.060)
Original Stability MCC for r=0.3 = 0.973 +- 0.085
Intervened Stability MCC for r=0.3 = 0.584 +- 0.370
Original Stability F1 for r=0.3 = 0.982 +- 0.056
Intervened Stability F1 for r=0.3 = 0.752 +- 0.210
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.859429
Plausibility completed in  0:00:18.932762
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5233, device='cuda:1')  +-  tensor(0.3089, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5331, device='cuda:1')  +-  tensor(0.3205, device='cuda:1') (0.029)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5233, device='cuda:1')  +-  tensor(0.3089, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8871, device='cuda:1')  +-  tensor(0.1895, device='cuda:1') (0.027)
Original Stability MCC for r=0.6 = 0.981 +- 0.076
Intervened Stability MCC for r=0.6 = 0.606 +- 0.406
Original Stability F1 for r=0.6 = 0.993 +- 0.026
Intervened Stability F1 for r=0.6 = 0.898 +- 0.104
Intervened samples: 2899
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:46:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:14 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:26 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:28 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:30 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:33 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:39 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:39 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:39 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:39 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:46:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:39 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:46:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:39 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:46:39 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 44...
[0m[1;37mINFO[0m: [1mCheckpoint 44: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.5320
ID Validation ACCURACY: 0.8943
ID Validation Loss: 0.4871
ID Test ACCURACY: 0.8910
ID Test Loss: 0.5314
OOD Validation ACCURACY: 0.6970
OOD Validation Loss: 0.9031
OOD Test ACCURACY: 0.5007
OOD Test Loss: 6.0511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8831
Train Loss: 0.5175
ID Validation ACCURACY: 0.8833
ID Validation Loss: 0.4767
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5135
OOD Validation ACCURACY: 0.7723
OOD Validation Loss: 0.6911
OOD Test ACCURACY: 0.4477
OOD Test Loss: 2.0349

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.5007 0.8860 0.4477 0.8833 0.7723[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.417
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.506


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.148277
Plausibility completed in  0:00:19.312411
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5065, device='cuda:1')  +-  tensor(0.3018, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5384, device='cuda:1')  +-  tensor(0.3160, device='cuda:1') (0.042)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5065, device='cuda:1')  +-  tensor(0.3018, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6158, device='cuda:1')  +-  tensor(0.1975, device='cuda:1') (0.052)
Original Stability MCC for r=0.3 = 0.988 +- 0.052
Intervened Stability MCC for r=0.3 = 0.600 +- 0.353
Original Stability F1 for r=0.3 = 0.992 +- 0.034
Intervened Stability F1 for r=0.3 = 0.761 +- 0.202
Intervened samples: 2961


ratio=0.6


Interventions completed in  0:00:05.773087
Plausibility completed in  0:00:18.605598
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5061, device='cuda:1')  +-  tensor(0.3042, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5007, device='cuda:1')  +-  tensor(0.3148, device='cuda:1') (0.025)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5061, device='cuda:1')  +-  tensor(0.3042, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8492, device='cuda:1')  +-  tensor(0.2125, device='cuda:1') (0.027)
Original Stability MCC for r=0.6 = 0.987 +- 0.061
Intervened Stability MCC for r=0.6 = 0.577 +- 0.434
Original Stability F1 for r=0.6 = 0.995 +- 0.021
Intervened Stability F1 for r=0.6 = 0.889 +- 0.112
Intervened samples: 2862
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:47:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:47:45 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:47:56 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:47:58 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:48:00 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:48:03 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:48:10 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:48:10 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:48:10 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:48:10 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:48:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:48:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:48:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:48:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:48:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:48:10 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:48:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:48:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:48:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:48:10 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:48:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 64...
[0m[1;37mINFO[0m: [1mCheckpoint 64: 
-----------------------------------
Train ACCURACY: 0.8937
Train Loss: 0.5698
ID Validation ACCURACY: 0.9000
ID Validation Loss: 0.5288
ID Test ACCURACY: 0.8943
ID Test Loss: 0.5798
OOD Validation ACCURACY: 0.6730
OOD Validation Loss: 1.3851
OOD Test ACCURACY: 0.4563
OOD Test Loss: 4.4608

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.8583
Train Loss: 0.7164
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.6880
ID Test ACCURACY: 0.8517
ID Test Loss: 0.7220
OOD Validation ACCURACY: 0.7457
OOD Validation Loss: 1.4504
OOD Test ACCURACY: 0.4083
OOD Test Loss: 6.2487

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.4563 0.8517 0.4083 0.8650 0.7457[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.462
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.513


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.160445
Plausibility completed in  0:00:19.425061
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5125, device='cuda:1')  +-  tensor(0.3021, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5553, device='cuda:1')  +-  tensor(0.3186, device='cuda:1') (0.050)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5125, device='cuda:1')  +-  tensor(0.3021, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6078, device='cuda:1')  +-  tensor(0.1956, device='cuda:1') (0.056)
Original Stability MCC for r=0.3 = 0.981 +- 0.064
Intervened Stability MCC for r=0.3 = 0.583 +- 0.382
Original Stability F1 for r=0.3 = 0.987 +- 0.042
Intervened Stability F1 for r=0.3 = 0.753 +- 0.210
Intervened samples: 2963


ratio=0.6


Interventions completed in  0:00:06.022618
Plausibility completed in  0:00:18.734744
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5119, device='cuda:1')  +-  tensor(0.3034, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5127, device='cuda:1')  +-  tensor(0.3155, device='cuda:1') (0.027)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5119, device='cuda:1')  +-  tensor(0.3034, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8559, device='cuda:1')  +-  tensor(0.2060, device='cuda:1') (0.024)
Original Stability MCC for r=0.6 = 0.982 +- 0.076
Intervened Stability MCC for r=0.6 = 0.610 +- 0.410
Original Stability F1 for r=0.6 = 0.994 +- 0.026
Intervened Stability F1 for r=0.6 = 0.899 +- 0.106
Intervened samples: 2877
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:49:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:14 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:26 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:28 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:30 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:33 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:39 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:39 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:39 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:39 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:39 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:39 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:49:39 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.5158
ID Validation ACCURACY: 0.8807
ID Validation Loss: 0.4789
ID Test ACCURACY: 0.8773
ID Test Loss: 0.5165
OOD Validation ACCURACY: 0.6493
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.4040
OOD Test Loss: 2.8675

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.8559
Train Loss: 0.5232
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.4809
ID Test ACCURACY: 0.8633
ID Test Loss: 0.5159
OOD Validation ACCURACY: 0.7123
OOD Validation Loss: 0.8312
OOD Test ACCURACY: 0.3543
OOD Test Loss: 8.7485

[0m[1;37mINFO[0m: [1mChartInfo 0.8773 0.4040 0.8633 0.3543 0.8650 0.7123[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.512
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.581


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.993950
Plausibility completed in  0:00:19.665189
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5704, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5621, device='cuda:1')  +-  tensor(0.3078, device='cuda:1') (0.051)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5704, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5625, device='cuda:1')  +-  tensor(0.1929, device='cuda:1') (0.048)
Original Stability MCC for r=0.3 = 0.977 +- 0.083
Intervened Stability MCC for r=0.3 = 0.581 +- 0.393
Original Stability F1 for r=0.3 = 0.985 +- 0.054
Intervened Stability F1 for r=0.3 = 0.747 +- 0.227
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.955571
Plausibility completed in  0:00:19.276167
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5701, device='cuda:1')  +-  tensor(0.2694, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5501, device='cuda:1')  +-  tensor(0.3020, device='cuda:1') (0.023)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5701, device='cuda:1')  +-  tensor(0.2694, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8631, device='cuda:1')  +-  tensor(0.1520, device='cuda:1') (0.028)
Original Stability MCC for r=0.6 = 0.975 +- 0.090
Intervened Stability MCC for r=0.6 = 0.615 +- 0.410
Original Stability F1 for r=0.6 = 0.991 +- 0.031
Intervened Stability F1 for r=0.6 = 0.898 +- 0.111
Intervened samples: 2957
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:50:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:50:45 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:50:57 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:50:58 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:51:00 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:51:03 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:51:10 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:51:10 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:51:10 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:51:10 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:51:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:51:10 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:51:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:51:10 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:51:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.5187
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4867
ID Test ACCURACY: 0.8650
ID Test Loss: 0.5182
OOD Validation ACCURACY: 0.6850
OOD Validation Loss: 0.7691
OOD Test ACCURACY: 0.3613
OOD Test Loss: 3.5062

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8180
Train Loss: 0.7026
ID Validation ACCURACY: 0.8267
ID Validation Loss: 0.6541
ID Test ACCURACY: 0.8193
ID Test Loss: 0.6900
OOD Validation ACCURACY: 0.8000
OOD Validation Loss: 0.6826
OOD Test ACCURACY: 0.4330
OOD Test Loss: 1.3960

[0m[1;37mINFO[0m: [1mChartInfo 0.8650 0.3613 0.8193 0.4330 0.8267 0.8000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.587
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.706


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.130754
Plausibility completed in  0:00:19.306109
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7147, device='cuda:1')  +-  tensor(0.2688, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6688, device='cuda:1')  +-  tensor(0.3246, device='cuda:1') (0.053)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7147, device='cuda:1')  +-  tensor(0.2688, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6235, device='cuda:1')  +-  tensor(0.2108, device='cuda:1') (0.055)
Original Stability MCC for r=0.3 = 0.988 +- 0.053
Intervened Stability MCC for r=0.3 = 0.544 +- 0.465
Original Stability F1 for r=0.3 = 0.992 +- 0.035
Intervened Stability F1 for r=0.3 = 0.728 +- 0.262
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:06.167467
Plausibility completed in  0:00:19.191681
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7156, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6551, device='cuda:1')  +-  tensor(0.3130, device='cuda:1') (0.035)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7156, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9181, device='cuda:1')  +-  tensor(0.1471, device='cuda:1') (0.016)
Original Stability MCC for r=0.6 = 0.988 +- 0.055
Intervened Stability MCC for r=0.6 = 0.602 +- 0.400
Original Stability F1 for r=0.6 = 0.996 +- 0.020
Intervened Stability F1 for r=0.6 = 0.905 +- 0.096
Intervened samples: 2960

\FINISHED GOODMotif - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.56647584 0.56539831] +- [0.07740632 0.07838542] (mean across ratios: 0.57 +- 0.06)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.58027633 0.55032729] +- [0.04596297 0.05504376] (mean across ratios: 0.57 +- 0.04)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.61763664 0.92617295] +- [0.04079708 0.02137845] (mean across ratios: 0.77 +- 0.02)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.6111599  0.87469664] +- [0.02750565 0.025189  ] (mean across ratios: 0.74 +- 0.02)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.98765684 0.99376663] +- [0.00388609 0.00156075] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.74830297 0.89763544] +- [0.01100933 0.00513111] (mean across ratios: 0.82 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.98145802 0.98266888] +- [0.00593085 0.00447636] (mean across ratios: 0.98 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.57843013 0.6017387 ] +- [0.01854655 0.01328332] (mean across ratios: 0.59 +- 0.01)

Overall time of execution:  0:07:35.047722
DONE CIGA GOODMotif/size 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:52:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:52:37 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:52:49 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:52:51 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:52:52 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:52:56 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:53:02 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:53:02 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:53:02 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:53:02 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:53:02 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:53:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:53:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:53:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:53:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:53:02 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:53:02 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:53:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:53:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:53:02 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:53:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8899
Train Loss: 0.5257
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.4847
ID Test ACCURACY: 0.8937
ID Test Loss: 0.5229
OOD Validation ACCURACY: 0.6193
OOD Validation Loss: 1.1712
OOD Test ACCURACY: 0.4250
OOD Test Loss: 6.2644

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.8699
Train Loss: 0.5291
ID Validation ACCURACY: 0.8790
ID Validation Loss: 0.4662
ID Test ACCURACY: 0.8723
ID Test Loss: 0.5479
OOD Validation ACCURACY: 0.7500
OOD Validation Loss: 0.6795
OOD Test ACCURACY: 0.4680
OOD Test Loss: 3.3662

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.4250 0.8723 0.4680 0.8790 0.7500[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.444
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.530


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.037475
Plausibility completed in  0:00:19.172920
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5283, device='cuda:1')  +-  tensor(0.3084, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6179, device='cuda:1')  +-  tensor(0.3362, device='cuda:1') (0.041)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5283, device='cuda:1')  +-  tensor(0.3084, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6419, device='cuda:1')  +-  tensor(0.1916, device='cuda:1') (0.050)
Original Stability MCC for r=0.3 = 0.974 +- 0.083
Intervened Stability MCC for r=0.3 = 0.406 +- 0.434
Original Stability F1 for r=0.3 = 0.983 +- 0.055
Intervened Stability F1 for r=0.3 = 0.682 +- 0.222
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.643413
Plausibility completed in  0:00:19.037907
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5233, device='cuda:1')  +-  tensor(0.3089, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5476, device='cuda:1')  +-  tensor(0.3226, device='cuda:1') (0.020)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5233, device='cuda:1')  +-  tensor(0.3089, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8849, device='cuda:1')  +-  tensor(0.1922, device='cuda:1') (0.020)
Original Stability MCC for r=0.6 = 0.981 +- 0.077
Intervened Stability MCC for r=0.6 = 0.355 +- 0.441
Original Stability F1 for r=0.6 = 0.993 +- 0.027
Intervened Stability F1 for r=0.6 = 0.901 +- 0.104
Intervened samples: 2899
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:54:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:08 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:19 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:21 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:23 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:26 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:32 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:32 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:32 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:32 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:54:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:32 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:54:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:32 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:54:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 44...
[0m[1;37mINFO[0m: [1mCheckpoint 44: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.5320
ID Validation ACCURACY: 0.8943
ID Validation Loss: 0.4871
ID Test ACCURACY: 0.8910
ID Test Loss: 0.5314
OOD Validation ACCURACY: 0.6970
OOD Validation Loss: 0.9031
OOD Test ACCURACY: 0.5007
OOD Test Loss: 6.0511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8831
Train Loss: 0.5175
ID Validation ACCURACY: 0.8833
ID Validation Loss: 0.4767
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5135
OOD Validation ACCURACY: 0.7723
OOD Validation Loss: 0.6911
OOD Test ACCURACY: 0.4477
OOD Test Loss: 2.0349

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.5007 0.8860 0.4477 0.8833 0.7723[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.417
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.506


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.935523
Plausibility completed in  0:00:19.155130
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5065, device='cuda:1')  +-  tensor(0.3018, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5675, device='cuda:1')  +-  tensor(0.3191, device='cuda:1') (0.039)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5065, device='cuda:1')  +-  tensor(0.3018, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6192, device='cuda:1')  +-  tensor(0.1891, device='cuda:1') (0.044)
Original Stability MCC for r=0.3 = 0.986 +- 0.056
Intervened Stability MCC for r=0.3 = 0.419 +- 0.410
Original Stability F1 for r=0.3 = 0.991 +- 0.037
Intervened Stability F1 for r=0.3 = 0.690 +- 0.206
Intervened samples: 2961


ratio=0.6


Interventions completed in  0:00:05.797139
Plausibility completed in  0:00:18.477596
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5061, device='cuda:1')  +-  tensor(0.3042, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5038, device='cuda:1')  +-  tensor(0.3113, device='cuda:1') (0.017)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5061, device='cuda:1')  +-  tensor(0.3042, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8548, device='cuda:1')  +-  tensor(0.2147, device='cuda:1') (0.019)
Original Stability MCC for r=0.6 = 0.986 +- 0.061
Intervened Stability MCC for r=0.6 = 0.333 +- 0.464
Original Stability F1 for r=0.6 = 0.995 +- 0.021
Intervened Stability F1 for r=0.6 = 0.889 +- 0.112
Intervened samples: 2862
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:55:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:55:36 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:55:47 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:55:49 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:55:51 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:55:54 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:56:00 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:56:00 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:56:00 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:56:00 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:56:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:56:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:56:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:56:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:56:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:56:00 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:56:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:56:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:56:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:56:00 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:56:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 64...
[0m[1;37mINFO[0m: [1mCheckpoint 64: 
-----------------------------------
Train ACCURACY: 0.8937
Train Loss: 0.5698
ID Validation ACCURACY: 0.9000
ID Validation Loss: 0.5288
ID Test ACCURACY: 0.8943
ID Test Loss: 0.5798
OOD Validation ACCURACY: 0.6730
OOD Validation Loss: 1.3851
OOD Test ACCURACY: 0.4563
OOD Test Loss: 4.4608

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.8583
Train Loss: 0.7164
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.6880
ID Test ACCURACY: 0.8517
ID Test Loss: 0.7220
OOD Validation ACCURACY: 0.7457
OOD Validation Loss: 1.4504
OOD Test ACCURACY: 0.4083
OOD Test Loss: 6.2487

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.4563 0.8517 0.4083 0.8650 0.7457[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.461
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.513


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.989459
Plausibility completed in  0:00:19.434477
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5125, device='cuda:1')  +-  tensor(0.3021, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5940, device='cuda:1')  +-  tensor(0.3273, device='cuda:1') (0.043)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5125, device='cuda:1')  +-  tensor(0.3021, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6157, device='cuda:1')  +-  tensor(0.1945, device='cuda:1') (0.048)
Original Stability MCC for r=0.3 = 0.982 +- 0.064
Intervened Stability MCC for r=0.3 = 0.426 +- 0.420
Original Stability F1 for r=0.3 = 0.988 +- 0.043
Intervened Stability F1 for r=0.3 = 0.691 +- 0.211
Intervened samples: 2963


ratio=0.6


Interventions completed in  0:00:05.649846
Plausibility completed in  0:00:18.824702
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5119, device='cuda:1')  +-  tensor(0.3034, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5198, device='cuda:1')  +-  tensor(0.3166, device='cuda:1') (0.018)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5119, device='cuda:1')  +-  tensor(0.3034, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8617, device='cuda:1')  +-  tensor(0.2068, device='cuda:1') (0.019)
Original Stability MCC for r=0.6 = 0.982 +- 0.077
Intervened Stability MCC for r=0.6 = 0.353 +- 0.466
Original Stability F1 for r=0.6 = 0.994 +- 0.026
Intervened Stability F1 for r=0.6 = 0.897 +- 0.111
Intervened samples: 2877
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:57:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:05 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:16 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:18 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:20 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:23 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:29 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:29 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:29 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:29 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:29 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:29 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:57:29 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.5158
ID Validation ACCURACY: 0.8807
ID Validation Loss: 0.4789
ID Test ACCURACY: 0.8773
ID Test Loss: 0.5165
OOD Validation ACCURACY: 0.6493
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.4040
OOD Test Loss: 2.8675

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.8559
Train Loss: 0.5232
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.4809
ID Test ACCURACY: 0.8633
ID Test Loss: 0.5159
OOD Validation ACCURACY: 0.7123
OOD Validation Loss: 0.8312
OOD Test ACCURACY: 0.3543
OOD Test Loss: 8.7485

[0m[1;37mINFO[0m: [1mChartInfo 0.8773 0.4040 0.8633 0.3543 0.8650 0.7123[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.511
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.580


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.978363
Plausibility completed in  0:00:19.434113
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5704, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5925, device='cuda:1')  +-  tensor(0.3273, device='cuda:1') (0.055)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5704, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5756, device='cuda:1')  +-  tensor(0.2007, device='cuda:1') (0.052)
Original Stability MCC for r=0.3 = 0.975 +- 0.090
Intervened Stability MCC for r=0.3 = 0.487 +- 0.405
Original Stability F1 for r=0.3 = 0.983 +- 0.058
Intervened Stability F1 for r=0.3 = 0.715 +- 0.218
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.753613
Plausibility completed in  0:00:19.236908
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5701, device='cuda:1')  +-  tensor(0.2694, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5606, device='cuda:1')  +-  tensor(0.3075, device='cuda:1') (0.015)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5701, device='cuda:1')  +-  tensor(0.2694, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8857, device='cuda:1')  +-  tensor(0.1540, device='cuda:1') (0.016)
Original Stability MCC for r=0.6 = 0.975 +- 0.088
Intervened Stability MCC for r=0.6 = 0.412 +- 0.457
Original Stability F1 for r=0.6 = 0.991 +- 0.031
Intervened Stability F1 for r=0.6 = 0.904 +- 0.107
Intervened samples: 2957
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 10:58:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:34 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:46 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:48 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:50 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:53 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:59 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:59 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:59 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:59 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:59 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:58:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:59 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:59 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 10:58:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:59 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/18/2024 10:58:59 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.5187
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4867
ID Test ACCURACY: 0.8650
ID Test Loss: 0.5182
OOD Validation ACCURACY: 0.6850
OOD Validation Loss: 0.7691
OOD Test ACCURACY: 0.3613
OOD Test Loss: 3.5062

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8180
Train Loss: 0.7026
ID Validation ACCURACY: 0.8267
ID Validation Loss: 0.6541
ID Test ACCURACY: 0.8193
ID Test Loss: 0.6900
OOD Validation ACCURACY: 0.8000
OOD Validation Loss: 0.6826
OOD Test ACCURACY: 0.4330
OOD Test Loss: 1.3960

[0m[1;37mINFO[0m: [1mChartInfo 0.8650 0.3613 0.8193 0.4330 0.8267 0.8000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.587
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.706


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.970802
Plausibility completed in  0:00:19.308579
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7147, device='cuda:1')  +-  tensor(0.2688, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6955, device='cuda:1')  +-  tensor(0.3446, device='cuda:1') (0.040)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7147, device='cuda:1')  +-  tensor(0.2688, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6233, device='cuda:1')  +-  tensor(0.2248, device='cuda:1') (0.041)
Original Stability MCC for r=0.3 = 0.987 +- 0.060
Intervened Stability MCC for r=0.3 = 0.403 +- 0.501
Original Stability F1 for r=0.3 = 0.991 +- 0.040
Intervened Stability F1 for r=0.3 = 0.667 +- 0.275
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:06.000946
Plausibility completed in  0:00:19.233154
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7156, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6674, device='cuda:1')  +-  tensor(0.3333, device='cuda:1') (0.021)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7156, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9218, device='cuda:1')  +-  tensor(0.1437, device='cuda:1') (0.013)
Original Stability MCC for r=0.6 = 0.988 +- 0.053
Intervened Stability MCC for r=0.6 = 0.351 +- 0.437
Original Stability F1 for r=0.6 = 0.996 +- 0.019
Intervened Stability F1 for r=0.6 = 0.914 +- 0.092
Intervened samples: 2960

\FINISHED GOODMotif - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.56647584 0.56539824] +- [0.07740632 0.07838529] (mean across ratios: 0.57 +- 0.06)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.61347293 0.55985411] +- [0.04401418 0.05736999] (mean across ratios: 0.59 +- 0.04)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.61763664 0.92617295] +- [0.04079708 0.02137845] (mean across ratios: 0.77 +- 0.02)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.6151403  0.88177953] +- [0.02174202 0.02348158] (mean across ratios: 0.75 +- 0.02)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.98727974 0.99367652] +- [0.00366099 0.00158005] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.68887138 0.90118767] +- [0.01558513 0.00820255] (mean across ratios: 0.80 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.98090423 0.9824295 ] +- [0.00555918 0.00444305] (mean across ratios: 0.98 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.42825153 0.36107833] +- [0.03046124 0.02670535] (mean across ratios: 0.39 +- 0.02)

Overall time of execution:  0:07:29.334426
DONE CIGA GOODMotif/size 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 11:00:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 11:00:23 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 11:00:35 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 11:00:37 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 11:00:38 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 11:00:42 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 11:00:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 11:00:48 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 11:00:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:00:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:00:48 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 11:00:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3249
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3247
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4865
OOD Test ACCURACY: 0.4907
OOD Test Loss: 2.1636

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3304
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3315
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4661
OOD Test ACCURACY: 0.5197
OOD Test Loss: 1.7017

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4907 0.9280 0.5197 0.9323 0.9040[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.624
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.543


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.117964
Plausibility completed in  0:00:19.362278
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3815, device='cuda:1')  +-  tensor(0.1784, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4338, device='cuda:1')  +-  tensor(0.2340, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3815, device='cuda:1')  +-  tensor(0.1784, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3960, device='cuda:1')  +-  tensor(0.0780, device='cuda:1') (0.005)
Original Stability MCC for r=0.3 = 0.993 +- 0.048
Intervened Stability MCC for r=0.3 = 0.267 +- 0.314
Original Stability F1 for r=0.3 = 0.995 +- 0.030
Intervened Stability F1 for r=0.3 = 0.549 +- 0.200
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.851078
Plausibility completed in  0:00:19.397892
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3810, device='cuda:1')  +-  tensor(0.1786, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4306, device='cuda:1')  +-  tensor(0.2344, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3810, device='cuda:1')  +-  tensor(0.1786, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7374, device='cuda:1')  +-  tensor(0.1226, device='cuda:1') (0.004)
Original Stability MCC for r=0.6 = 0.996 +- 0.027
Intervened Stability MCC for r=0.6 = 0.160 +- 0.334
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.786 +- 0.117
Intervened samples: 2959
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 11:01:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 11:01:55 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 11:02:06 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 11:02:08 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 11:02:10 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 11:02:13 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 11:02:19 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 11:02:19 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 11:02:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 11:02:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:02:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:02:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:02:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:02:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:02:19 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 11:02:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 122...
[0m[1;37mINFO[0m: [1mCheckpoint 122: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3371
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3138
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3425
OOD Validation ACCURACY: 0.8697
OOD Validation Loss: 0.5698
OOD Test ACCURACY: 0.5503
OOD Test Loss: 1.5812

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9264
Train Loss: 0.3343
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3132
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4750
OOD Test ACCURACY: 0.5800
OOD Test Loss: 2.8730

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5503 0.9273 0.5800 0.9327 0.9030[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.603
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.526


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.902286
Plausibility completed in  0:00:20.225333
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3737, device='cuda:1')  +-  tensor(0.1750, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4280, device='cuda:1')  +-  tensor(0.2319, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3737, device='cuda:1')  +-  tensor(0.1750, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3913, device='cuda:1')  +-  tensor(0.0760, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.998 +- 0.021
Intervened Stability MCC for r=0.3 = 0.273 +- 0.306
Original Stability F1 for r=0.3 = 0.999 +- 0.014
Intervened Stability F1 for r=0.3 = 0.550 +- 0.196
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:06.491841
Plausibility completed in  0:00:20.302598
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3731, device='cuda:1')  +-  tensor(0.1746, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4244, device='cuda:1')  +-  tensor(0.2298, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3731, device='cuda:1')  +-  tensor(0.1746, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7392, device='cuda:1')  +-  tensor(0.1179, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.996 +- 0.031
Intervened Stability MCC for r=0.6 = 0.135 +- 0.319
Original Stability F1 for r=0.6 = 0.999 +- 0.011
Intervened Stability F1 for r=0.6 = 0.781 +- 0.114
Intervened samples: 2965
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 11:03:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 11:03:27 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 11:03:39 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 11:03:41 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 11:03:43 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 11:03:46 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 11:03:52 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 11:03:52 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 11:03:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 11:03:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:03:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:03:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:03:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:03:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:03:52 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 11:03:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3328
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3378
OOD Validation ACCURACY: 0.8910
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4787
OOD Test Loss: 2.2870

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3400
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9237
ID Test Loss: 0.3418
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4991
OOD Test ACCURACY: 0.6000
OOD Test Loss: 1.5258

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4787 0.9237 0.6000 0.9327 0.9017[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.615
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.325216
Plausibility completed in  0:00:20.605620
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3788, device='cuda:1')  +-  tensor(0.1767, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4316, device='cuda:1')  +-  tensor(0.2323, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3788, device='cuda:1')  +-  tensor(0.1767, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3925, device='cuda:1')  +-  tensor(0.0774, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.998 +- 0.018
Intervened Stability MCC for r=0.3 = 0.266 +- 0.304
Original Stability F1 for r=0.3 = 0.999 +- 0.012
Intervened Stability F1 for r=0.3 = 0.547 +- 0.192
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:06.116488
Plausibility completed in  0:00:19.922521
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3775, device='cuda:1')  +-  tensor(0.1758, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4263, device='cuda:1')  +-  tensor(0.2308, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3775, device='cuda:1')  +-  tensor(0.1758, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7364, device='cuda:1')  +-  tensor(0.1243, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.994 +- 0.042
Intervened Stability MCC for r=0.6 = 0.149 +- 0.319
Original Stability F1 for r=0.6 = 0.998 +- 0.015
Intervened Stability F1 for r=0.6 = 0.784 +- 0.114
Intervened samples: 2957
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 11:05:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 11:05:02 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 11:05:14 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 11:05:15 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 11:05:17 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 11:05:20 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 11:05:27 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 11:05:27 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 11:05:27 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 11:05:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:05:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:05:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:05:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:05:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:05:27 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 11:05:27 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5283 0.9290 0.5283 0.9337 0.9093[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.614
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.529


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.013216
Plausibility completed in  0:00:19.827870
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3756, device='cuda:1')  +-  tensor(0.1727, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4269, device='cuda:1')  +-  tensor(0.2306, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3756, device='cuda:1')  +-  tensor(0.1727, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3882, device='cuda:1')  +-  tensor(0.0765, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.997 +- 0.024
Intervened Stability MCC for r=0.3 = 0.249 +- 0.313
Original Stability F1 for r=0.3 = 0.998 +- 0.016
Intervened Stability F1 for r=0.3 = 0.536 +- 0.196
Intervened samples: 2963


ratio=0.6


Interventions completed in  0:00:05.791579
Plausibility completed in  0:00:19.272959
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3725, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4161, device='cuda:1')  +-  tensor(0.2240, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3725, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7292, device='cuda:1')  +-  tensor(0.1356, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.994 +- 0.046
Intervened Stability MCC for r=0.6 = 0.137 +- 0.312
Original Stability F1 for r=0.6 = 0.998 +- 0.016
Intervened Stability F1 for r=0.6 = 0.780 +- 0.115
Intervened samples: 2940
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 11:06:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 11:06:32 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 11:06:44 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 11:06:46 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 11:06:48 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 11:06:51 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 11:06:57 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 11:06:57 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 11:06:57 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 11:06:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:06:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:06:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:06:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:06:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:06:57 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 11:06:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3330
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3362
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4896
OOD Test ACCURACY: 0.5230
OOD Test Loss: 2.0987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3396
ID Validation ACCURACY: 0.9320
ID Validation Loss: 0.3109
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3440
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4703
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.1198

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.5230 0.9260 0.5683 0.9320 0.9000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.602
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.534


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.006469
Plausibility completed in  0:00:19.443076
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3765, device='cuda:1')  +-  tensor(0.1766, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4304, device='cuda:1')  +-  tensor(0.2332, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3765, device='cuda:1')  +-  tensor(0.1766, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3903, device='cuda:1')  +-  tensor(0.0746, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.997 +- 0.027
Intervened Stability MCC for r=0.3 = 0.270 +- 0.300
Original Stability F1 for r=0.3 = 0.998 +- 0.017
Intervened Stability F1 for r=0.3 = 0.547 +- 0.191
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.920895
Plausibility completed in  0:00:19.999603
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3743, device='cuda:1')  +-  tensor(0.1753, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4227, device='cuda:1')  +-  tensor(0.2316, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3743, device='cuda:1')  +-  tensor(0.1753, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7339, device='cuda:1')  +-  tensor(0.1302, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.994 +- 0.041
Intervened Stability MCC for r=0.6 = 0.171 +- 0.331
Original Stability F1 for r=0.6 = 0.998 +- 0.015
Intervened Stability F1 for r=0.6 = 0.788 +- 0.115
Intervened samples: 2948

\FINISHED GOODMotif - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.37720627 0.37567004] +- [0.00268543 0.0031694 ] (mean across ratios: 0.38 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.43013564 0.42401571] +- [0.00248752 0.00477034] (mean across ratios: 0.43 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.3398846  0.64245119] +- [0.00208606 0.00250155] (mean across ratios: 0.49 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.39167302 0.7352298 ] +- [0.0025746  0.00345578] (mean across ratios: 0.56 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99787246 0.99818399] +- [0.00126487 0.00034772] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.54574965 0.78378156] +- [0.00509813 0.00287578] (mean across ratios: 0.66 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99682922 0.99494437] +- [0.0019179  0.00099124] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.26523505 0.15016329] +- [0.00824681 0.01362485] (mean across ratios: 0.21 +- 0.01)

Overall time of execution:  0:07:42.011881
DONE GSAT GOODMotif/size 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 11:08:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 11:08:20 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 11:08:32 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 11:08:34 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 11:08:35 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 11:08:39 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 11:08:45 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 11:08:45 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 11:08:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 11:08:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:08:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:08:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:08:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:08:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:08:45 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 11:08:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3249
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3247
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4865
OOD Test ACCURACY: 0.4907
OOD Test Loss: 2.1636

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3304
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3315
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4661
OOD Test ACCURACY: 0.5197
OOD Test Loss: 1.7017

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4907 0.9280 0.5197 0.9323 0.9040[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.624
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.543


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.215434
Plausibility completed in  0:00:19.605316
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3815, device='cuda:1')  +-  tensor(0.1784, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4968, device='cuda:1')  +-  tensor(0.2749, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3815, device='cuda:1')  +-  tensor(0.1784, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4516, device='cuda:1')  +-  tensor(0.1045, device='cuda:1') (0.005)
Original Stability MCC for r=0.3 = 0.991 +- 0.053
Intervened Stability MCC for r=0.3 = 0.239 +- 0.335
Original Stability F1 for r=0.3 = 0.994 +- 0.035
Intervened Stability F1 for r=0.3 = 0.577 +- 0.200
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.783662
Plausibility completed in  0:00:19.240188
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3810, device='cuda:1')  +-  tensor(0.1786, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4863, device='cuda:1')  +-  tensor(0.2699, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3810, device='cuda:1')  +-  tensor(0.1786, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8294, device='cuda:1')  +-  tensor(0.1512, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.997 +- 0.025
Intervened Stability MCC for r=0.6 = 0.061 +- 0.267
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.851 +- 0.122
Intervened samples: 2959
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 11:09:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 11:09:53 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 11:10:04 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 11:10:06 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 11:10:08 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 11:10:11 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 11:10:18 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 11:10:18 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 11:10:18 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 11:10:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:10:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:10:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:10:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:10:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:10:18 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 11:10:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 122...
[0m[1;37mINFO[0m: [1mCheckpoint 122: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3371
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3138
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3425
OOD Validation ACCURACY: 0.8697
OOD Validation Loss: 0.5698
OOD Test ACCURACY: 0.5503
OOD Test Loss: 1.5812

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9264
Train Loss: 0.3343
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3132
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4750
OOD Test ACCURACY: 0.5800
OOD Test Loss: 2.8730

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5503 0.9273 0.5800 0.9327 0.9030[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.603
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.526


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.777308
Plausibility completed in  0:00:19.512466
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3737, device='cuda:1')  +-  tensor(0.1750, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4907, device='cuda:1')  +-  tensor(0.2727, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3737, device='cuda:1')  +-  tensor(0.1750, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4465, device='cuda:1')  +-  tensor(0.1019, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.998 +- 0.024
Intervened Stability MCC for r=0.3 = 0.245 +- 0.328
Original Stability F1 for r=0.3 = 0.999 +- 0.015
Intervened Stability F1 for r=0.3 = 0.579 +- 0.196
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.863158
Plausibility completed in  0:00:19.836135
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3731, device='cuda:1')  +-  tensor(0.1746, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4784, device='cuda:1')  +-  tensor(0.2610, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3731, device='cuda:1')  +-  tensor(0.1746, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8296, device='cuda:1')  +-  tensor(0.1455, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.995 +- 0.040
Intervened Stability MCC for r=0.6 = 0.080 +- 0.293
Original Stability F1 for r=0.6 = 0.998 +- 0.014
Intervened Stability F1 for r=0.6 = 0.850 +- 0.122
Intervened samples: 2965
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 11:11:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 11:11:24 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 11:11:36 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 11:11:38 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 11:11:40 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 11:11:43 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 11:11:49 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 11:11:49 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 11:11:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 11:11:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:11:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:11:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:11:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:11:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:11:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 11:11:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3328
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3378
OOD Validation ACCURACY: 0.8910
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4787
OOD Test Loss: 2.2870

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3400
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9237
ID Test Loss: 0.3418
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4991
OOD Test ACCURACY: 0.6000
OOD Test Loss: 1.5258

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4787 0.9237 0.6000 0.9327 0.9017[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.615
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.957141
Plausibility completed in  0:00:19.657088
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3788, device='cuda:1')  +-  tensor(0.1767, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4945, device='cuda:1')  +-  tensor(0.2732, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3788, device='cuda:1')  +-  tensor(0.1767, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4477, device='cuda:1')  +-  tensor(0.1023, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.997 +- 0.022
Intervened Stability MCC for r=0.3 = 0.242 +- 0.321
Original Stability F1 for r=0.3 = 0.998 +- 0.015
Intervened Stability F1 for r=0.3 = 0.576 +- 0.190
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.832031
Plausibility completed in  0:00:19.426117
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3775, device='cuda:1')  +-  tensor(0.1758, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4821, device='cuda:1')  +-  tensor(0.2640, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3775, device='cuda:1')  +-  tensor(0.1758, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8291, device='cuda:1')  +-  tensor(0.1530, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.995 +- 0.034
Intervened Stability MCC for r=0.6 = 0.057 +- 0.268
Original Stability F1 for r=0.6 = 0.998 +- 0.012
Intervened Stability F1 for r=0.6 = 0.850 +- 0.124
Intervened samples: 2957
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 11:12:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 11:12:56 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 11:13:07 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 11:13:09 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 11:13:11 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 11:13:14 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 11:13:20 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 11:13:20 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 11:13:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 11:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:13:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:13:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:13:20 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 11:13:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5283 0.9290 0.5283 0.9337 0.9093[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.614
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.529


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.883243
Plausibility completed in  0:00:19.425654
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3756, device='cuda:1')  +-  tensor(0.1727, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4903, device='cuda:1')  +-  tensor(0.2736, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3756, device='cuda:1')  +-  tensor(0.1727, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4437, device='cuda:1')  +-  tensor(0.1014, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.998 +- 0.018
Intervened Stability MCC for r=0.3 = 0.222 +- 0.330
Original Stability F1 for r=0.3 = 0.999 +- 0.012
Intervened Stability F1 for r=0.3 = 0.570 +- 0.192
Intervened samples: 2963


ratio=0.6


Interventions completed in  0:00:05.662794
Plausibility completed in  0:00:19.269915
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3725, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4692, device='cuda:1')  +-  tensor(0.2580, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3725, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8203, device='cuda:1')  +-  tensor(0.1643, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.995 +- 0.043
Intervened Stability MCC for r=0.6 = 0.079 +- 0.282
Original Stability F1 for r=0.6 = 0.998 +- 0.015
Intervened Stability F1 for r=0.6 = 0.851 +- 0.123
Intervened samples: 2940
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 18 11:14:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/18/2024 11:14:25 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/18/2024 11:14:37 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/18/2024 11:14:39 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/18/2024 11:14:41 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/18/2024 11:14:44 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/18/2024 11:14:50 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/18/2024 11:14:50 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/18/2024 11:14:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/18/2024 11:14:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:14:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:14:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:14:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/18/2024 11:14:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/18/2024 11:14:50 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/18/2024 11:14:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3330
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3362
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4896
OOD Test ACCURACY: 0.5230
OOD Test Loss: 2.0987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3396
ID Validation ACCURACY: 0.9320
ID Validation Loss: 0.3109
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3440
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4703
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.1198

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.5230 0.9260 0.5683 0.9320 0.9000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.602
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.534


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.888705
Plausibility completed in  0:00:19.359734
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3765, device='cuda:1')  +-  tensor(0.1766, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4926, device='cuda:1')  +-  tensor(0.2722, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3765, device='cuda:1')  +-  tensor(0.1766, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4447, device='cuda:1')  +-  tensor(0.0993, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.998 +- 0.026
Intervened Stability MCC for r=0.3 = 0.239 +- 0.322
Original Stability F1 for r=0.3 = 0.999 +- 0.016
Intervened Stability F1 for r=0.3 = 0.573 +- 0.191
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.667811
Plausibility completed in  0:00:19.144823
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3743, device='cuda:1')  +-  tensor(0.1753, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4775, device='cuda:1')  +-  tensor(0.2648, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3743, device='cuda:1')  +-  tensor(0.1753, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8254, device='cuda:1')  +-  tensor(0.1586, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.996 +- 0.033
Intervened Stability MCC for r=0.6 = 0.073 +- 0.276
Original Stability F1 for r=0.6 = 0.998 +- 0.012
Intervened Stability F1 for r=0.6 = 0.851 +- 0.121
Intervened samples: 2948

\FINISHED GOODMotif - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.37720634 0.37566997] +- [0.00268541 0.00316943] (mean across ratios: 0.38 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.49298073 0.4786893 ] +- [0.00240632 0.00566539] (mean across ratios: 0.49 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33988453 0.64245113] +- [0.0020861  0.00250153] (mean across ratios: 0.49 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.44682661 0.82678239] +- [0.00276938 0.00359067] (mean across ratios: 0.64 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99770622 0.99831491] +- [0.00175921 0.00027543] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.57517424 0.85062245] +- [0.00338153 0.00073484] (mean across ratios: 0.71 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99657457 0.99534439] +- [0.00265568 0.00083111] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.23726311 0.06997535] +- [0.00817321 0.00934721] (mean across ratios: 0.15 +- 0.01)

Overall time of execution:  0:07:37.963362
DONE GSAT GOODMotif/size 0.10
