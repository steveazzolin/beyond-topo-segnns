nohup: ignoring input
Time to compute metrics!

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 12:57:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 12:57:59 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:14 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:16 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:18 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:20 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 12:58:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9035
Train Loss: 0.4128
ID Validation ACCURACY: 0.9023
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4215
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4795
OOD Test ACCURACY: 0.6793
OOD Test Loss: 0.8040

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8663
Train Loss: 0.4837
ID Validation ACCURACY: 0.8677
ID Validation Loss: 0.4913
ID Test ACCURACY: 0.8707
ID Test Loss: 0.4812
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4154
OOD Test ACCURACY: 0.7697
OOD Test Loss: 0.6769

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6793 0.8707 0.7697 0.8677 0.9310[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))

Gold ratio (id_test) =  tensor(0.3175) +- tensor(0.1645)
F1 for r=0.3 = 0.722
WIoU for r=0.3 = 0.684
F1 for r=0.4 = 0.729
WIoU for r=0.4 = 0.755
F1 for r=0.6 = 0.620
WIoU for r=0.6 = 0.781
F1 for r=0.9 = 0.489
WIoU for r=0.9 = 0.791
F1 for r=0.95 = 0.471
WIoU for r=0.95 = 0.791
F1 for r=1.0 = 0.459
WIoU for r=1.0 = 0.791
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.398
WIoU for r=0.3 = 0.264
F1 for r=0.4 = 0.460
WIoU for r=0.4 = 0.316
F1 for r=0.6 = 0.551
WIoU for r=0.6 = 0.400
F1 for r=0.9 = 0.592
WIoU for r=0.9 = 0.448
F1 for r=0.95 = 0.572
WIoU for r=0.95 = 0.447
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.447


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.634
Model XAI F1 of binarized graphs for r=0.3 =  0.7219125
Model XAI WIoU of binarized graphs for r=0.3 =  0.68417875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.389
NEC for r=0.3 class 0 = 0.579 +- 0.306 (in-sample avg dev_std = 0.483)
NEC for r=0.3 class 1 = 0.513 +- 0.306 (in-sample avg dev_std = 0.483)
NEC for r=0.3 class 2 = 0.603 +- 0.306 (in-sample avg dev_std = 0.483)
NEC for r=0.3 all KL = 0.61 +- 0.306 (in-sample avg dev_std = 0.483)
NEC for r=0.3 all L1 = 0.564 +- 0.177 (in-sample avg dev_std = 0.483)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.76
Model XAI F1 of binarized graphs for r=0.4 =  0.7286075
Model XAI WIoU of binarized graphs for r=0.4 =  0.7552312499999999
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.417
NEC for r=0.4 class 0 = 0.577 +- 0.301 (in-sample avg dev_std = 0.497)
NEC for r=0.4 class 1 = 0.522 +- 0.301 (in-sample avg dev_std = 0.497)
NEC for r=0.4 class 2 = 0.602 +- 0.301 (in-sample avg dev_std = 0.497)
NEC for r=0.4 all KL = 0.614 +- 0.301 (in-sample avg dev_std = 0.497)
NEC for r=0.4 all L1 = 0.567 +- 0.172 (in-sample avg dev_std = 0.497)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.865
Model XAI F1 of binarized graphs for r=0.6 =  0.619795
Model XAI WIoU of binarized graphs for r=0.6 =  0.78074125
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.483
NEC for r=0.6 class 0 = 0.536 +- 0.301 (in-sample avg dev_std = 0.531)
NEC for r=0.6 class 1 = 0.475 +- 0.301 (in-sample avg dev_std = 0.531)
NEC for r=0.6 class 2 = 0.63 +- 0.301 (in-sample avg dev_std = 0.531)
NEC for r=0.6 all KL = 0.59 +- 0.301 (in-sample avg dev_std = 0.531)
NEC for r=0.6 all L1 = 0.546 +- 0.177 (in-sample avg dev_std = 0.531)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.905
Model XAI F1 of binarized graphs for r=0.9 =  0.48923125
Model XAI WIoU of binarized graphs for r=0.9 =  0.79137
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.555
NEC for r=0.9 class 0 = 0.469 +- 0.287 (in-sample avg dev_std = 0.575)
NEC for r=0.9 class 1 = 0.453 +- 0.287 (in-sample avg dev_std = 0.575)
NEC for r=0.9 class 2 = 0.581 +- 0.287 (in-sample avg dev_std = 0.575)
NEC for r=0.9 all KL = 0.531 +- 0.287 (in-sample avg dev_std = 0.575)
NEC for r=0.9 all L1 = 0.5 +- 0.166 (in-sample avg dev_std = 0.575)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.905
Model XAI F1 of binarized graphs for r=0.95 =  0.471335
Model XAI WIoU of binarized graphs for r=0.95 =  0.7913650000000001
len(reference) = 800
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.56
NEC for r=0.95 class 0 = 0.478 +- 0.291 (in-sample avg dev_std = 0.567)
NEC for r=0.95 class 1 = 0.443 +- 0.291 (in-sample avg dev_std = 0.567)
NEC for r=0.95 class 2 = 0.573 +- 0.291 (in-sample avg dev_std = 0.567)
NEC for r=0.95 all KL = 0.526 +- 0.291 (in-sample avg dev_std = 0.567)
NEC for r=0.95 all L1 = 0.497 +- 0.168 (in-sample avg dev_std = 0.567)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.905
Model XAI F1 of binarized graphs for r=1.0 =  0.45948124999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.7913650000000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.555
NEC for r=1.0 class 0 = 0.478 +- 0.291 (in-sample avg dev_std = 0.560)
NEC for r=1.0 class 1 = 0.443 +- 0.291 (in-sample avg dev_std = 0.560)
NEC for r=1.0 class 2 = 0.571 +- 0.291 (in-sample avg dev_std = 0.560)
NEC for r=1.0 all KL = 0.523 +- 0.291 (in-sample avg dev_std = 0.560)
NEC for r=1.0 all L1 = 0.496 +- 0.170 (in-sample avg dev_std = 0.560)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.319
Model XAI F1 of binarized graphs for r=0.3 =  0.39848749999999994
Model XAI WIoU of binarized graphs for r=0.3 =  0.2644925
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.35
NEC for r=0.3 class 0 = 0.251 +- 0.176 (in-sample avg dev_std = 0.321)
NEC for r=0.3 class 1 = 0.319 +- 0.176 (in-sample avg dev_std = 0.321)
NEC for r=0.3 class 2 = 0.298 +- 0.176 (in-sample avg dev_std = 0.321)
NEC for r=0.3 all KL = 0.166 +- 0.176 (in-sample avg dev_std = 0.321)
NEC for r=0.3 all L1 = 0.289 +- 0.152 (in-sample avg dev_std = 0.321)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.344
Model XAI F1 of binarized graphs for r=0.4 =  0.45993
Model XAI WIoU of binarized graphs for r=0.4 =  0.31606625
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.36
NEC for r=0.4 class 0 = 0.341 +- 0.230 (in-sample avg dev_std = 0.419)
NEC for r=0.4 class 1 = 0.39 +- 0.230 (in-sample avg dev_std = 0.419)
NEC for r=0.4 class 2 = 0.38 +- 0.230 (in-sample avg dev_std = 0.419)
NEC for r=0.4 all KL = 0.266 +- 0.230 (in-sample avg dev_std = 0.419)
NEC for r=0.4 all L1 = 0.37 +- 0.165 (in-sample avg dev_std = 0.419)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.494
Model XAI F1 of binarized graphs for r=0.6 =  0.55061625
Model XAI WIoU of binarized graphs for r=0.6 =  0.39973375000000005
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.478
NEC for r=0.6 class 0 = 0.441 +- 0.277 (in-sample avg dev_std = 0.517)
NEC for r=0.6 class 1 = 0.424 +- 0.277 (in-sample avg dev_std = 0.517)
NEC for r=0.6 class 2 = 0.502 +- 0.277 (in-sample avg dev_std = 0.517)
NEC for r=0.6 all KL = 0.416 +- 0.277 (in-sample avg dev_std = 0.517)
NEC for r=0.6 all L1 = 0.456 +- 0.170 (in-sample avg dev_std = 0.517)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  0.59211875
Model XAI WIoU of binarized graphs for r=0.9 =  0.44840374999999993
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.606
NEC for r=0.9 class 0 = 0.456 +- 0.249 (in-sample avg dev_std = 0.514)
NEC for r=0.9 class 1 = 0.219 +- 0.249 (in-sample avg dev_std = 0.514)
NEC for r=0.9 class 2 = 0.557 +- 0.249 (in-sample avg dev_std = 0.514)
NEC for r=0.9 all KL = 0.436 +- 0.249 (in-sample avg dev_std = 0.514)
NEC for r=0.9 all L1 = 0.414 +- 0.201 (in-sample avg dev_std = 0.514)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.69
Model XAI F1 of binarized graphs for r=0.95 =  0.5723675
Model XAI WIoU of binarized graphs for r=0.95 =  0.44691749999999997
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.62
NEC for r=0.95 class 0 = 0.426 +- 0.236 (in-sample avg dev_std = 0.488)
NEC for r=0.95 class 1 = 0.215 +- 0.236 (in-sample avg dev_std = 0.488)
NEC for r=0.95 class 2 = 0.526 +- 0.236 (in-sample avg dev_std = 0.488)
NEC for r=0.95 all KL = 0.39 +- 0.236 (in-sample avg dev_std = 0.488)
NEC for r=0.95 all L1 = 0.392 +- 0.192 (in-sample avg dev_std = 0.488)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.691
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.446735
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.631
NEC for r=1.0 class 0 = 0.441 +- 0.227 (in-sample avg dev_std = 0.488)
NEC for r=1.0 class 1 = 0.213 +- 0.227 (in-sample avg dev_std = 0.488)
NEC for r=1.0 class 2 = 0.514 +- 0.227 (in-sample avg dev_std = 0.488)
NEC for r=1.0 all KL = 0.391 +- 0.227 (in-sample avg dev_std = 0.488)
NEC for r=1.0 all L1 = 0.392 +- 0.187 (in-sample avg dev_std = 0.488)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.638
Model XAI F1 of binarized graphs for r=0.3 =  0.7219125
Model XAI WIoU of binarized graphs for r=0.3 =  0.68417875
len(reference) = 791
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.465
SUFF++ for r=0.3 class 0 = 0.496 +- 0.296 (in-sample avg dev_std = 0.573)
SUFF++ for r=0.3 class 1 = 0.516 +- 0.296 (in-sample avg dev_std = 0.573)
SUFF++ for r=0.3 class 2 = 0.497 +- 0.296 (in-sample avg dev_std = 0.573)
SUFF++ for r=0.3 all KL = 0.431 +- 0.296 (in-sample avg dev_std = 0.573)
SUFF++ for r=0.3 all L1 = 0.503 +- 0.168 (in-sample avg dev_std = 0.573)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.76
Model XAI F1 of binarized graphs for r=0.4 =  0.7286075
Model XAI WIoU of binarized graphs for r=0.4 =  0.7552312499999999
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.567
SUFF++ for r=0.4 class 0 = 0.494 +- 0.279 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.4 class 1 = 0.603 +- 0.279 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.4 class 2 = 0.529 +- 0.279 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.4 all KL = 0.485 +- 0.279 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.4 all L1 = 0.542 +- 0.180 (in-sample avg dev_std = 0.557)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.865
Model XAI F1 of binarized graphs for r=0.6 =  0.619795
Model XAI WIoU of binarized graphs for r=0.6 =  0.78074125
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.726
SUFF++ for r=0.6 class 0 = 0.659 +- 0.259 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.6 class 1 = 0.639 +- 0.259 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.6 class 2 = 0.678 +- 0.259 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.6 all KL = 0.638 +- 0.259 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.6 all L1 = 0.658 +- 0.187 (in-sample avg dev_std = 0.480)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.905
Model XAI F1 of binarized graphs for r=0.9 =  0.48923125
Model XAI WIoU of binarized graphs for r=0.9 =  0.79137
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.857
SUFF++ for r=0.9 class 0 = 0.86 +- 0.171 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.9 class 1 = 0.823 +- 0.171 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.9 class 2 = 0.862 +- 0.171 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.9 all KL = 0.889 +- 0.171 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.9 all L1 = 0.848 +- 0.164 (in-sample avg dev_std = 0.235)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.904
Model XAI F1 of binarized graphs for r=0.95 =  0.471335
Model XAI WIoU of binarized graphs for r=0.95 =  0.7913650000000001
len(reference) = 719
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.887
SUFF++ for r=0.95 class 0 = 0.916 +- 0.115 (in-sample avg dev_std = 0.187)
SUFF++ for r=0.95 class 1 = 0.887 +- 0.115 (in-sample avg dev_std = 0.187)
SUFF++ for r=0.95 class 2 = 0.912 +- 0.115 (in-sample avg dev_std = 0.187)
SUFF++ for r=0.95 all KL = 0.942 +- 0.115 (in-sample avg dev_std = 0.187)
SUFF++ for r=0.95 all L1 = 0.905 +- 0.116 (in-sample avg dev_std = 0.187)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.327
Model XAI F1 of binarized graphs for r=0.3 =  0.39848749999999994
Model XAI WIoU of binarized graphs for r=0.3 =  0.2644925
len(reference) = 744
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.326
SUFF++ for r=0.3 class 0 = 0.658 +- 0.160 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 class 1 = 0.635 +- 0.160 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 class 2 = 0.648 +- 0.160 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 all KL = 0.755 +- 0.160 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 all L1 = 0.647 +- 0.117 (in-sample avg dev_std = 0.456)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.345
Model XAI F1 of binarized graphs for r=0.4 =  0.45993
Model XAI WIoU of binarized graphs for r=0.4 =  0.31606625
len(reference) = 798
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.364
SUFF++ for r=0.4 class 0 = 0.586 +- 0.226 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.4 class 1 = 0.577 +- 0.226 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.4 class 2 = 0.581 +- 0.226 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.4 all KL = 0.662 +- 0.226 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.4 all L1 = 0.581 +- 0.136 (in-sample avg dev_std = 0.516)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.494
Model XAI F1 of binarized graphs for r=0.6 =  0.55061625
Model XAI WIoU of binarized graphs for r=0.6 =  0.39973375000000005
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.46
SUFF++ for r=0.6 class 0 = 0.629 +- 0.252 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.6 class 1 = 0.646 +- 0.252 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.6 class 2 = 0.583 +- 0.252 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.6 all KL = 0.676 +- 0.252 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.6 all L1 = 0.618 +- 0.164 (in-sample avg dev_std = 0.488)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  0.59211875
Model XAI WIoU of binarized graphs for r=0.9 =  0.44840374999999993
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.728
SUFF++ for r=0.9 class 0 = 0.739 +- 0.109 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 class 1 = 0.971 +- 0.109 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 class 2 = 0.78 +- 0.109 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 all KL = 0.91 +- 0.109 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 all L1 = 0.827 +- 0.160 (in-sample avg dev_std = 0.217)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.69
Model XAI F1 of binarized graphs for r=0.95 =  0.5723675
Model XAI WIoU of binarized graphs for r=0.95 =  0.44691749999999997
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.663
SUFF++ for r=0.95 class 0 = 0.9 +- 0.049 (in-sample avg dev_std = 0.120)
SUFF++ for r=0.95 class 1 = 0.985 +- 0.049 (in-sample avg dev_std = 0.120)
SUFF++ for r=0.95 class 2 = 0.9 +- 0.049 (in-sample avg dev_std = 0.120)
SUFF++ for r=0.95 all KL = 0.976 +- 0.049 (in-sample avg dev_std = 0.120)
SUFF++ for r=0.95 all L1 = 0.927 +- 0.080 (in-sample avg dev_std = 0.120)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 13:02:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:17 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:31 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:33 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:36 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:38 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:02:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.8972
Train Loss: 0.4272
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.4477
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.3677
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.7662

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8812
Train Loss: 0.4545
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4837
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4477
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3667
OOD Test ACCURACY: 0.6257
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9030 0.6950 0.8840 0.6257 0.8767 0.9280[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))

Gold ratio (id_test) =  tensor(0.3175) +- tensor(0.1645)
F1 for r=0.3 = 0.697
WIoU for r=0.3 = 0.649
F1 for r=0.4 = 0.709
WIoU for r=0.4 = 0.732
F1 for r=0.6 = 0.625
WIoU for r=0.6 = 0.774
F1 for r=0.9 = 0.489
WIoU for r=0.9 = 0.779
F1 for r=0.95 = 0.471
WIoU for r=0.95 = 0.779
F1 for r=1.0 = 0.459
WIoU for r=1.0 = 0.779
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.415
WIoU for r=0.3 = 0.282
F1 for r=0.4 = 0.485
WIoU for r=0.4 = 0.347
F1 for r=0.6 = 0.573
WIoU for r=0.6 = 0.431
F1 for r=0.9 = 0.588
WIoU for r=0.9 = 0.473
F1 for r=0.95 = 0.571
WIoU for r=0.95 = 0.470
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.467


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.608
Model XAI F1 of binarized graphs for r=0.3 =  0.6970112500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.64909375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.364
NEC for r=0.3 class 0 = 0.584 +- 0.280 (in-sample avg dev_std = 0.478)
NEC for r=0.3 class 1 = 0.494 +- 0.280 (in-sample avg dev_std = 0.478)
NEC for r=0.3 class 2 = 0.622 +- 0.280 (in-sample avg dev_std = 0.478)
NEC for r=0.3 all KL = 0.603 +- 0.280 (in-sample avg dev_std = 0.478)
NEC for r=0.3 all L1 = 0.566 +- 0.152 (in-sample avg dev_std = 0.478)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.649
Model XAI F1 of binarized graphs for r=0.4 =  0.7085149999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.7320362499999998
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.392
NEC for r=0.4 class 0 = 0.58 +- 0.279 (in-sample avg dev_std = 0.493)
NEC for r=0.4 class 1 = 0.473 +- 0.279 (in-sample avg dev_std = 0.493)
NEC for r=0.4 class 2 = 0.624 +- 0.279 (in-sample avg dev_std = 0.493)
NEC for r=0.4 all KL = 0.574 +- 0.279 (in-sample avg dev_std = 0.493)
NEC for r=0.4 all L1 = 0.558 +- 0.158 (in-sample avg dev_std = 0.493)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.863
Model XAI F1 of binarized graphs for r=0.6 =  0.62544
Model XAI WIoU of binarized graphs for r=0.6 =  0.7744150000000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.459
NEC for r=0.6 class 0 = 0.581 +- 0.306 (in-sample avg dev_std = 0.492)
NEC for r=0.6 class 1 = 0.44 +- 0.306 (in-sample avg dev_std = 0.492)
NEC for r=0.6 class 2 = 0.638 +- 0.306 (in-sample avg dev_std = 0.492)
NEC for r=0.6 all KL = 0.567 +- 0.306 (in-sample avg dev_std = 0.492)
NEC for r=0.6 all L1 = 0.551 +- 0.178 (in-sample avg dev_std = 0.492)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.48908124999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.7788925
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.539
NEC for r=0.9 class 0 = 0.523 +- 0.309 (in-sample avg dev_std = 0.536)
NEC for r=0.9 class 1 = 0.409 +- 0.309 (in-sample avg dev_std = 0.536)
NEC for r=0.9 class 2 = 0.588 +- 0.309 (in-sample avg dev_std = 0.536)
NEC for r=0.9 all KL = 0.519 +- 0.309 (in-sample avg dev_std = 0.536)
NEC for r=0.9 all L1 = 0.506 +- 0.175 (in-sample avg dev_std = 0.536)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.897
Model XAI F1 of binarized graphs for r=0.95 =  0.47138499999999994
Model XAI WIoU of binarized graphs for r=0.95 =  0.778895
len(reference) = 800
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.542
NEC for r=0.95 class 0 = 0.521 +- 0.305 (in-sample avg dev_std = 0.519)
NEC for r=0.95 class 1 = 0.408 +- 0.305 (in-sample avg dev_std = 0.519)
NEC for r=0.95 class 2 = 0.579 +- 0.305 (in-sample avg dev_std = 0.519)
NEC for r=0.95 all KL = 0.508 +- 0.305 (in-sample avg dev_std = 0.519)
NEC for r=0.95 all L1 = 0.501 +- 0.175 (in-sample avg dev_std = 0.519)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.897
Model XAI F1 of binarized graphs for r=1.0 =  0.45948124999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.7788675
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.541
NEC for r=1.0 class 0 = 0.511 +- 0.303 (in-sample avg dev_std = 0.525)
NEC for r=1.0 class 1 = 0.412 +- 0.303 (in-sample avg dev_std = 0.525)
NEC for r=1.0 class 2 = 0.589 +- 0.303 (in-sample avg dev_std = 0.525)
NEC for r=1.0 all KL = 0.509 +- 0.303 (in-sample avg dev_std = 0.525)
NEC for r=1.0 all L1 = 0.503 +- 0.173 (in-sample avg dev_std = 0.525)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.343
Model XAI F1 of binarized graphs for r=0.3 =  0.41494749999999997
Model XAI WIoU of binarized graphs for r=0.3 =  0.28239
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.377
NEC for r=0.3 class 0 = 0.311 +- 0.311 (in-sample avg dev_std = 0.385)
NEC for r=0.3 class 1 = 0.416 +- 0.311 (in-sample avg dev_std = 0.385)
NEC for r=0.3 class 2 = 0.345 +- 0.311 (in-sample avg dev_std = 0.385)
NEC for r=0.3 all KL = 0.369 +- 0.311 (in-sample avg dev_std = 0.385)
NEC for r=0.3 all L1 = 0.357 +- 0.206 (in-sample avg dev_std = 0.385)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.38
Model XAI F1 of binarized graphs for r=0.4 =  0.48491
Model XAI WIoU of binarized graphs for r=0.4 =  0.34682124999999997
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.424
NEC for r=0.4 class 0 = 0.408 +- 0.290 (in-sample avg dev_std = 0.459)
NEC for r=0.4 class 1 = 0.535 +- 0.290 (in-sample avg dev_std = 0.459)
NEC for r=0.4 class 2 = 0.466 +- 0.290 (in-sample avg dev_std = 0.459)
NEC for r=0.4 all KL = 0.457 +- 0.290 (in-sample avg dev_std = 0.459)
NEC for r=0.4 all L1 = 0.469 +- 0.194 (in-sample avg dev_std = 0.459)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.506
Model XAI F1 of binarized graphs for r=0.6 =  0.5729099999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.43138750000000003
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.488
NEC for r=0.6 class 0 = 0.494 +- 0.309 (in-sample avg dev_std = 0.528)
NEC for r=0.6 class 1 = 0.339 +- 0.309 (in-sample avg dev_std = 0.528)
NEC for r=0.6 class 2 = 0.598 +- 0.309 (in-sample avg dev_std = 0.528)
NEC for r=0.6 all KL = 0.471 +- 0.309 (in-sample avg dev_std = 0.528)
NEC for r=0.6 all L1 = 0.48 +- 0.215 (in-sample avg dev_std = 0.528)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.748
Model XAI F1 of binarized graphs for r=0.9 =  0.5884075
Model XAI WIoU of binarized graphs for r=0.9 =  0.47348
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.603
NEC for r=0.9 class 0 = 0.438 +- 0.262 (in-sample avg dev_std = 0.478)
NEC for r=0.9 class 1 = 0.147 +- 0.262 (in-sample avg dev_std = 0.478)
NEC for r=0.9 class 2 = 0.535 +- 0.262 (in-sample avg dev_std = 0.478)
NEC for r=0.9 all KL = 0.342 +- 0.262 (in-sample avg dev_std = 0.478)
NEC for r=0.9 all L1 = 0.377 +- 0.220 (in-sample avg dev_std = 0.478)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.725
Model XAI F1 of binarized graphs for r=0.95 =  0.57066125
Model XAI WIoU of binarized graphs for r=0.95 =  0.4698125
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.61
NEC for r=0.95 class 0 = 0.407 +- 0.238 (in-sample avg dev_std = 0.461)
NEC for r=0.95 class 1 = 0.15 +- 0.238 (in-sample avg dev_std = 0.461)
NEC for r=0.95 class 2 = 0.511 +- 0.238 (in-sample avg dev_std = 0.461)
NEC for r=0.95 all KL = 0.312 +- 0.238 (in-sample avg dev_std = 0.461)
NEC for r=0.95 all L1 = 0.36 +- 0.204 (in-sample avg dev_std = 0.461)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.706
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.46704375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.593
NEC for r=1.0 class 0 = 0.397 +- 0.241 (in-sample avg dev_std = 0.449)
NEC for r=1.0 class 1 = 0.144 +- 0.241 (in-sample avg dev_std = 0.449)
NEC for r=1.0 class 2 = 0.519 +- 0.241 (in-sample avg dev_std = 0.449)
NEC for r=1.0 all KL = 0.305 +- 0.241 (in-sample avg dev_std = 0.449)
NEC for r=1.0 all L1 = 0.357 +- 0.209 (in-sample avg dev_std = 0.449)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.611
Model XAI F1 of binarized graphs for r=0.3 =  0.6970112500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.64909375
len(reference) = 796
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.45
SUFF++ for r=0.3 class 0 = 0.502 +- 0.271 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.3 class 1 = 0.478 +- 0.271 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.3 class 2 = 0.445 +- 0.271 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.3 all KL = 0.414 +- 0.271 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.3 all L1 = 0.476 +- 0.152 (in-sample avg dev_std = 0.591)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.649
Model XAI F1 of binarized graphs for r=0.4 =  0.7085149999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.7320362499999998
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.556
SUFF++ for r=0.4 class 0 = 0.517 +- 0.271 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.4 class 1 = 0.588 +- 0.271 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.4 class 2 = 0.46 +- 0.271 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.4 all KL = 0.5 +- 0.271 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.4 all L1 = 0.523 +- 0.180 (in-sample avg dev_std = 0.531)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.863
Model XAI F1 of binarized graphs for r=0.6 =  0.62544
Model XAI WIoU of binarized graphs for r=0.6 =  0.7744150000000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.738
SUFF++ for r=0.6 class 0 = 0.648 +- 0.257 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 1 = 0.701 +- 0.257 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 2 = 0.61 +- 0.257 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 all KL = 0.659 +- 0.257 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 all L1 = 0.654 +- 0.173 (in-sample avg dev_std = 0.438)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.48908124999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.7788925
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.832
SUFF++ for r=0.9 class 0 = 0.793 +- 0.194 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 class 1 = 0.783 +- 0.194 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 class 2 = 0.796 +- 0.194 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 all KL = 0.856 +- 0.194 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 all L1 = 0.791 +- 0.176 (in-sample avg dev_std = 0.254)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.896
Model XAI F1 of binarized graphs for r=0.95 =  0.47138499999999994
Model XAI WIoU of binarized graphs for r=0.95 =  0.778895
len(reference) = 719
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.853
SUFF++ for r=0.95 class 0 = 0.871 +- 0.145 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.95 class 1 = 0.862 +- 0.145 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.95 class 2 = 0.859 +- 0.145 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.95 all KL = 0.928 +- 0.145 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.95 all L1 = 0.864 +- 0.155 (in-sample avg dev_std = 0.195)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.349
Model XAI F1 of binarized graphs for r=0.3 =  0.41494749999999997
Model XAI WIoU of binarized graphs for r=0.3 =  0.28239
len(reference) = 769
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.347
SUFF++ for r=0.3 class 0 = 0.543 +- 0.262 (in-sample avg dev_std = 0.619)
SUFF++ for r=0.3 class 1 = 0.527 +- 0.262 (in-sample avg dev_std = 0.619)
SUFF++ for r=0.3 class 2 = 0.525 +- 0.262 (in-sample avg dev_std = 0.619)
SUFF++ for r=0.3 all KL = 0.406 +- 0.262 (in-sample avg dev_std = 0.619)
SUFF++ for r=0.3 all L1 = 0.532 +- 0.120 (in-sample avg dev_std = 0.619)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.38
Model XAI F1 of binarized graphs for r=0.4 =  0.48491
Model XAI WIoU of binarized graphs for r=0.4 =  0.34682124999999997
len(reference) = 798
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.356
SUFF++ for r=0.4 class 0 = 0.487 +- 0.260 (in-sample avg dev_std = 0.618)
SUFF++ for r=0.4 class 1 = 0.498 +- 0.260 (in-sample avg dev_std = 0.618)
SUFF++ for r=0.4 class 2 = 0.454 +- 0.260 (in-sample avg dev_std = 0.618)
SUFF++ for r=0.4 all KL = 0.435 +- 0.260 (in-sample avg dev_std = 0.618)
SUFF++ for r=0.4 all L1 = 0.479 +- 0.123 (in-sample avg dev_std = 0.618)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.506
Model XAI F1 of binarized graphs for r=0.6 =  0.5729099999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.43138750000000003
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.475
SUFF++ for r=0.6 class 0 = 0.61 +- 0.262 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 1 = 0.679 +- 0.262 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 2 = 0.616 +- 0.262 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 all KL = 0.666 +- 0.262 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 all L1 = 0.634 +- 0.196 (in-sample avg dev_std = 0.470)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.748
Model XAI F1 of binarized graphs for r=0.9 =  0.5884075
Model XAI WIoU of binarized graphs for r=0.9 =  0.47348
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.736
SUFF++ for r=0.9 class 0 = 0.794 +- 0.073 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.9 class 1 = 0.953 +- 0.073 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.9 class 2 = 0.829 +- 0.073 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.9 all KL = 0.943 +- 0.073 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.9 all L1 = 0.857 +- 0.128 (in-sample avg dev_std = 0.155)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.725
Model XAI F1 of binarized graphs for r=0.95 =  0.57066125
Model XAI WIoU of binarized graphs for r=0.95 =  0.4698125
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.698
SUFF++ for r=0.95 class 0 = 0.88 +- 0.061 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.95 class 1 = 0.966 +- 0.061 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.95 class 2 = 0.89 +- 0.061 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.95 all KL = 0.963 +- 0.061 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.95 all L1 = 0.911 +- 0.103 (in-sample avg dev_std = 0.155)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 13:06:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 01:06:37 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 01:06:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 01:06:54 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 01:06:57 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 01:06:59 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:07:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4207
ID Validation ACCURACY: 0.8973
ID Validation Loss: 0.4417
ID Test ACCURACY: 0.8983
ID Test Loss: 0.4343
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.4566
OOD Test ACCURACY: 0.7470
OOD Test Loss: 0.7194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.4455
ID Validation ACCURACY: 0.8893
ID Validation Loss: 0.4661
ID Test ACCURACY: 0.8897
ID Test Loss: 0.4398
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.7320
OOD Test Loss: 0.7218

[0m[1;37mINFO[0m: [1mChartInfo 0.8983 0.7470 0.8897 0.7320 0.8893 0.9317[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))

Gold ratio (id_test) =  tensor(0.3175) +- tensor(0.1645)
F1 for r=0.3 = 0.733
WIoU for r=0.3 = 0.726
F1 for r=0.4 = 0.727
WIoU for r=0.4 = 0.789
F1 for r=0.6 = 0.636
WIoU for r=0.6 = 0.810
F1 for r=0.9 = 0.489
WIoU for r=0.9 = 0.810
F1 for r=0.95 = 0.471
WIoU for r=0.95 = 0.810
F1 for r=1.0 = 0.459
WIoU for r=1.0 = 0.810
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.505
WIoU for r=0.3 = 0.413
F1 for r=0.4 = 0.596
WIoU for r=0.4 = 0.501
F1 for r=0.6 = 0.677
WIoU for r=0.6 = 0.587
F1 for r=0.9 = 0.592
WIoU for r=0.9 = 0.612
F1 for r=0.95 = 0.572
WIoU for r=0.95 = 0.612
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.612


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.67
Model XAI F1 of binarized graphs for r=0.3 =  0.7325674999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.72627
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.387
NEC for r=0.3 class 0 = 0.595 +- 0.285 (in-sample avg dev_std = 0.449)
NEC for r=0.3 class 1 = 0.564 +- 0.285 (in-sample avg dev_std = 0.449)
NEC for r=0.3 class 2 = 0.625 +- 0.285 (in-sample avg dev_std = 0.449)
NEC for r=0.3 all KL = 0.658 +- 0.285 (in-sample avg dev_std = 0.449)
NEC for r=0.3 all L1 = 0.594 +- 0.147 (in-sample avg dev_std = 0.449)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.709
Model XAI F1 of binarized graphs for r=0.4 =  0.7271937499999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.788975
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.415
NEC for r=0.4 class 0 = 0.558 +- 0.287 (in-sample avg dev_std = 0.470)
NEC for r=0.4 class 1 = 0.534 +- 0.287 (in-sample avg dev_std = 0.470)
NEC for r=0.4 class 2 = 0.618 +- 0.287 (in-sample avg dev_std = 0.470)
NEC for r=0.4 all KL = 0.647 +- 0.287 (in-sample avg dev_std = 0.470)
NEC for r=0.4 all L1 = 0.569 +- 0.157 (in-sample avg dev_std = 0.470)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.6356700000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.80958625
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.465
NEC for r=0.6 class 0 = 0.568 +- 0.296 (in-sample avg dev_std = 0.482)
NEC for r=0.6 class 1 = 0.514 +- 0.296 (in-sample avg dev_std = 0.482)
NEC for r=0.6 class 2 = 0.617 +- 0.296 (in-sample avg dev_std = 0.482)
NEC for r=0.6 all KL = 0.624 +- 0.296 (in-sample avg dev_std = 0.482)
NEC for r=0.6 all L1 = 0.565 +- 0.162 (in-sample avg dev_std = 0.482)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.48908375
Model XAI WIoU of binarized graphs for r=0.9 =  0.80962375
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.522
NEC for r=0.9 class 0 = 0.534 +- 0.288 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 1 = 0.491 +- 0.288 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 2 = 0.543 +- 0.288 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all KL = 0.561 +- 0.288 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all L1 = 0.522 +- 0.162 (in-sample avg dev_std = 0.541)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.896
Model XAI F1 of binarized graphs for r=0.95 =  0.471335
Model XAI WIoU of binarized graphs for r=0.95 =  0.8096187499999999
len(reference) = 800
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.536
NEC for r=0.95 class 0 = 0.525 +- 0.287 (in-sample avg dev_std = 0.545)
NEC for r=0.95 class 1 = 0.483 +- 0.287 (in-sample avg dev_std = 0.545)
NEC for r=0.95 class 2 = 0.537 +- 0.287 (in-sample avg dev_std = 0.545)
NEC for r=0.95 all KL = 0.554 +- 0.287 (in-sample avg dev_std = 0.545)
NEC for r=0.95 all L1 = 0.514 +- 0.164 (in-sample avg dev_std = 0.545)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.896
Model XAI F1 of binarized graphs for r=1.0 =  0.45948124999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.8096187499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.536
NEC for r=1.0 class 0 = 0.54 +- 0.284 (in-sample avg dev_std = 0.550)
NEC for r=1.0 class 1 = 0.478 +- 0.284 (in-sample avg dev_std = 0.550)
NEC for r=1.0 class 2 = 0.532 +- 0.284 (in-sample avg dev_std = 0.550)
NEC for r=1.0 all KL = 0.558 +- 0.284 (in-sample avg dev_std = 0.550)
NEC for r=1.0 all L1 = 0.516 +- 0.162 (in-sample avg dev_std = 0.550)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.322
Model XAI F1 of binarized graphs for r=0.3 =  0.50527125
Model XAI WIoU of binarized graphs for r=0.3 =  0.41275999999999996
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.359
NEC for r=0.3 class 0 = 0.503 +- 0.277 (in-sample avg dev_std = 0.387)
NEC for r=0.3 class 1 = 0.586 +- 0.277 (in-sample avg dev_std = 0.387)
NEC for r=0.3 class 2 = 0.503 +- 0.277 (in-sample avg dev_std = 0.387)
NEC for r=0.3 all KL = 0.474 +- 0.277 (in-sample avg dev_std = 0.387)
NEC for r=0.3 all L1 = 0.53 +- 0.178 (in-sample avg dev_std = 0.387)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.43
Model XAI F1 of binarized graphs for r=0.4 =  0.59590125
Model XAI WIoU of binarized graphs for r=0.4 =  0.5012925
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.418
NEC for r=0.4 class 0 = 0.499 +- 0.272 (in-sample avg dev_std = 0.436)
NEC for r=0.4 class 1 = 0.476 +- 0.272 (in-sample avg dev_std = 0.436)
NEC for r=0.4 class 2 = 0.565 +- 0.272 (in-sample avg dev_std = 0.436)
NEC for r=0.4 all KL = 0.471 +- 0.272 (in-sample avg dev_std = 0.436)
NEC for r=0.4 all L1 = 0.514 +- 0.183 (in-sample avg dev_std = 0.436)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.649
Model XAI F1 of binarized graphs for r=0.6 =  0.67744
Model XAI WIoU of binarized graphs for r=0.6 =  0.5872175
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.533
NEC for r=0.6 class 0 = 0.484 +- 0.307 (in-sample avg dev_std = 0.586)
NEC for r=0.6 class 1 = 0.379 +- 0.307 (in-sample avg dev_std = 0.586)
NEC for r=0.6 class 2 = 0.618 +- 0.307 (in-sample avg dev_std = 0.586)
NEC for r=0.6 all KL = 0.557 +- 0.307 (in-sample avg dev_std = 0.586)
NEC for r=0.6 all L1 = 0.496 +- 0.188 (in-sample avg dev_std = 0.586)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.759
Model XAI F1 of binarized graphs for r=0.9 =  0.592455
Model XAI WIoU of binarized graphs for r=0.9 =  0.6116812500000001
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.612
NEC for r=0.9 class 0 = 0.44 +- 0.244 (in-sample avg dev_std = 0.551)
NEC for r=0.9 class 1 = 0.332 +- 0.244 (in-sample avg dev_std = 0.551)
NEC for r=0.9 class 2 = 0.499 +- 0.244 (in-sample avg dev_std = 0.551)
NEC for r=0.9 all KL = 0.438 +- 0.244 (in-sample avg dev_std = 0.551)
NEC for r=0.9 all L1 = 0.425 +- 0.154 (in-sample avg dev_std = 0.551)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.759
Model XAI F1 of binarized graphs for r=0.95 =  0.5718075
Model XAI WIoU of binarized graphs for r=0.95 =  0.6117825
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.639
NEC for r=0.95 class 0 = 0.436 +- 0.241 (in-sample avg dev_std = 0.546)
NEC for r=0.95 class 1 = 0.318 +- 0.241 (in-sample avg dev_std = 0.546)
NEC for r=0.95 class 2 = 0.48 +- 0.241 (in-sample avg dev_std = 0.546)
NEC for r=0.95 all KL = 0.424 +- 0.241 (in-sample avg dev_std = 0.546)
NEC for r=0.95 all L1 = 0.413 +- 0.155 (in-sample avg dev_std = 0.546)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.759
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.61195375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.635
NEC for r=1.0 class 0 = 0.438 +- 0.237 (in-sample avg dev_std = 0.549)
NEC for r=1.0 class 1 = 0.313 +- 0.237 (in-sample avg dev_std = 0.549)
NEC for r=1.0 class 2 = 0.472 +- 0.237 (in-sample avg dev_std = 0.549)
NEC for r=1.0 all KL = 0.419 +- 0.237 (in-sample avg dev_std = 0.549)
NEC for r=1.0 all L1 = 0.409 +- 0.152 (in-sample avg dev_std = 0.549)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.672
Model XAI F1 of binarized graphs for r=0.3 =  0.7325674999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.72627
len(reference) = 799
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.469
SUFF++ for r=0.3 class 0 = 0.499 +- 0.274 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.3 class 1 = 0.539 +- 0.274 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.3 class 2 = 0.464 +- 0.274 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.3 all KL = 0.41 +- 0.274 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.3 all L1 = 0.502 +- 0.176 (in-sample avg dev_std = 0.591)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.709
Model XAI F1 of binarized graphs for r=0.4 =  0.7271937499999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.788975
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.55
SUFF++ for r=0.4 class 0 = 0.49 +- 0.288 (in-sample avg dev_std = 0.560)
SUFF++ for r=0.4 class 1 = 0.64 +- 0.288 (in-sample avg dev_std = 0.560)
SUFF++ for r=0.4 class 2 = 0.458 +- 0.288 (in-sample avg dev_std = 0.560)
SUFF++ for r=0.4 all KL = 0.436 +- 0.288 (in-sample avg dev_std = 0.560)
SUFF++ for r=0.4 all L1 = 0.531 +- 0.192 (in-sample avg dev_std = 0.560)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.861
Model XAI F1 of binarized graphs for r=0.6 =  0.6356700000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.80958625
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.711
SUFF++ for r=0.6 class 0 = 0.557 +- 0.301 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 class 1 = 0.732 +- 0.301 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 class 2 = 0.609 +- 0.301 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 all KL = 0.586 +- 0.301 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 all L1 = 0.633 +- 0.216 (in-sample avg dev_std = 0.485)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  0.48908375
Model XAI WIoU of binarized graphs for r=0.9 =  0.80962375
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.811
SUFF++ for r=0.9 class 0 = 0.665 +- 0.250 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 class 1 = 0.783 +- 0.250 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 class 2 = 0.833 +- 0.250 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 all KL = 0.802 +- 0.250 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.9 all L1 = 0.759 +- 0.217 (in-sample avg dev_std = 0.295)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.894
Model XAI F1 of binarized graphs for r=0.95 =  0.471335
Model XAI WIoU of binarized graphs for r=0.95 =  0.8096187499999999
len(reference) = 719
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.854
SUFF++ for r=0.95 class 0 = 0.79 +- 0.198 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.95 class 1 = 0.859 +- 0.198 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.95 class 2 = 0.896 +- 0.198 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.95 all KL = 0.894 +- 0.198 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.95 all L1 = 0.847 +- 0.191 (in-sample avg dev_std = 0.227)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.323
Model XAI F1 of binarized graphs for r=0.3 =  0.50527125
Model XAI WIoU of binarized graphs for r=0.3 =  0.41275999999999996
len(reference) = 792
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.372
SUFF++ for r=0.3 class 0 = 0.538 +- 0.230 (in-sample avg dev_std = 0.495)
SUFF++ for r=0.3 class 1 = 0.506 +- 0.230 (in-sample avg dev_std = 0.495)
SUFF++ for r=0.3 class 2 = 0.531 +- 0.230 (in-sample avg dev_std = 0.495)
SUFF++ for r=0.3 all KL = 0.588 +- 0.230 (in-sample avg dev_std = 0.495)
SUFF++ for r=0.3 all L1 = 0.525 +- 0.142 (in-sample avg dev_std = 0.495)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.433
Model XAI F1 of binarized graphs for r=0.4 =  0.59590125
Model XAI WIoU of binarized graphs for r=0.4 =  0.5012925
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.417
SUFF++ for r=0.4 class 0 = 0.568 +- 0.254 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.4 class 1 = 0.608 +- 0.254 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.4 class 2 = 0.524 +- 0.254 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.4 all KL = 0.62 +- 0.254 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.4 all L1 = 0.566 +- 0.170 (in-sample avg dev_std = 0.472)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.649
Model XAI F1 of binarized graphs for r=0.6 =  0.67744
Model XAI WIoU of binarized graphs for r=0.6 =  0.5872175
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.68
SUFF++ for r=0.6 class 0 = 0.574 +- 0.255 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 class 1 = 0.887 +- 0.255 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 class 2 = 0.723 +- 0.255 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 all KL = 0.731 +- 0.255 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 all L1 = 0.725 +- 0.215 (in-sample avg dev_std = 0.441)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.759
Model XAI F1 of binarized graphs for r=0.9 =  0.592455
Model XAI WIoU of binarized graphs for r=0.9 =  0.6116812500000001
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.777
SUFF++ for r=0.9 class 0 = 0.668 +- 0.137 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 class 1 = 0.942 +- 0.137 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 class 2 = 0.859 +- 0.137 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 all KL = 0.901 +- 0.137 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 all L1 = 0.821 +- 0.179 (in-sample avg dev_std = 0.217)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.759
Model XAI F1 of binarized graphs for r=0.95 =  0.5718075
Model XAI WIoU of binarized graphs for r=0.95 =  0.6117825
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.734
SUFF++ for r=0.95 class 0 = 0.887 +- 0.050 (in-sample avg dev_std = 0.133)
SUFF++ for r=0.95 class 1 = 0.98 +- 0.050 (in-sample avg dev_std = 0.133)
SUFF++ for r=0.95 class 2 = 0.938 +- 0.050 (in-sample avg dev_std = 0.133)
SUFF++ for r=0.95 all KL = 0.977 +- 0.050 (in-sample avg dev_std = 0.133)
SUFF++ for r=0.95 all L1 = 0.934 +- 0.083 (in-sample avg dev_std = 0.133)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 13:10:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 01:10:45 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 01:10:59 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:02 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:04 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:06 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:11:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9111
Train Loss: 0.4118
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4282
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4292
OOD Validation ACCURACY: 0.8720
OOD Validation Loss: 0.4700
OOD Test ACCURACY: 0.6660
OOD Test Loss: 0.8918

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.8854
Train Loss: 0.4498
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.4694
ID Test ACCURACY: 0.8770
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3373
OOD Test ACCURACY: 0.5787
OOD Test Loss: 1.0425

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.6660 0.8770 0.5787 0.8820 0.9293[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))

Gold ratio (id_test) =  tensor(0.3175) +- tensor(0.1645)
F1 for r=0.3 = 0.750
WIoU for r=0.3 = 0.752
F1 for r=0.4 = 0.741
WIoU for r=0.4 = 0.825
F1 for r=0.6 = 0.628
WIoU for r=0.6 = 0.853
F1 for r=0.9 = 0.489
WIoU for r=0.9 = 0.846
F1 for r=0.95 = 0.471
WIoU for r=0.95 = 0.846
F1 for r=1.0 = 0.459
WIoU for r=1.0 = 0.846
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.516
WIoU for r=0.3 = 0.414
F1 for r=0.4 = 0.600
WIoU for r=0.4 = 0.497
F1 for r=0.6 = 0.652
WIoU for r=0.6 = 0.552
F1 for r=0.9 = 0.579
WIoU for r=0.9 = 0.515
F1 for r=0.95 = 0.569
WIoU for r=0.95 = 0.512
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.509


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.695
Model XAI F1 of binarized graphs for r=0.3 =  0.7495212499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.752405
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.409
NEC for r=0.3 class 0 = 0.592 +- 0.296 (in-sample avg dev_std = 0.482)
NEC for r=0.3 class 1 = 0.533 +- 0.296 (in-sample avg dev_std = 0.482)
NEC for r=0.3 class 2 = 0.633 +- 0.296 (in-sample avg dev_std = 0.482)
NEC for r=0.3 all KL = 0.673 +- 0.296 (in-sample avg dev_std = 0.482)
NEC for r=0.3 all L1 = 0.585 +- 0.150 (in-sample avg dev_std = 0.482)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.759
Model XAI F1 of binarized graphs for r=0.4 =  0.7411150000000001
Model XAI WIoU of binarized graphs for r=0.4 =  0.82510625
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.408
NEC for r=0.4 class 0 = 0.594 +- 0.284 (in-sample avg dev_std = 0.472)
NEC for r=0.4 class 1 = 0.534 +- 0.284 (in-sample avg dev_std = 0.472)
NEC for r=0.4 class 2 = 0.64 +- 0.284 (in-sample avg dev_std = 0.472)
NEC for r=0.4 all KL = 0.657 +- 0.284 (in-sample avg dev_std = 0.472)
NEC for r=0.4 all L1 = 0.589 +- 0.143 (in-sample avg dev_std = 0.472)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.882
Model XAI F1 of binarized graphs for r=0.6 =  0.62809125
Model XAI WIoU of binarized graphs for r=0.6 =  0.85293625
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.49
NEC for r=0.6 class 0 = 0.546 +- 0.311 (in-sample avg dev_std = 0.499)
NEC for r=0.6 class 1 = 0.471 +- 0.311 (in-sample avg dev_std = 0.499)
NEC for r=0.6 class 2 = 0.633 +- 0.311 (in-sample avg dev_std = 0.499)
NEC for r=0.6 all KL = 0.58 +- 0.311 (in-sample avg dev_std = 0.499)
NEC for r=0.6 all L1 = 0.549 +- 0.169 (in-sample avg dev_std = 0.499)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  0.488685
Model XAI WIoU of binarized graphs for r=0.9 =  0.84634625
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.555
NEC for r=0.9 class 0 = 0.51 +- 0.308 (in-sample avg dev_std = 0.533)
NEC for r=0.9 class 1 = 0.432 +- 0.308 (in-sample avg dev_std = 0.533)
NEC for r=0.9 class 2 = 0.575 +- 0.308 (in-sample avg dev_std = 0.533)
NEC for r=0.9 all KL = 0.523 +- 0.308 (in-sample avg dev_std = 0.533)
NEC for r=0.9 all L1 = 0.504 +- 0.178 (in-sample avg dev_std = 0.533)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.911
Model XAI F1 of binarized graphs for r=0.95 =  0.47120999999999996
Model XAI WIoU of binarized graphs for r=0.95 =  0.84634625
len(reference) = 800
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.571
NEC for r=0.95 class 0 = 0.506 +- 0.301 (in-sample avg dev_std = 0.545)
NEC for r=0.95 class 1 = 0.417 +- 0.301 (in-sample avg dev_std = 0.545)
NEC for r=0.95 class 2 = 0.559 +- 0.301 (in-sample avg dev_std = 0.545)
NEC for r=0.95 all KL = 0.512 +- 0.301 (in-sample avg dev_std = 0.545)
NEC for r=0.95 all L1 = 0.493 +- 0.168 (in-sample avg dev_std = 0.545)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.911
Model XAI F1 of binarized graphs for r=1.0 =  0.45948124999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.84634625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.579
NEC for r=1.0 class 0 = 0.498 +- 0.305 (in-sample avg dev_std = 0.544)
NEC for r=1.0 class 1 = 0.413 +- 0.305 (in-sample avg dev_std = 0.544)
NEC for r=1.0 class 2 = 0.562 +- 0.305 (in-sample avg dev_std = 0.544)
NEC for r=1.0 all KL = 0.508 +- 0.305 (in-sample avg dev_std = 0.544)
NEC for r=1.0 all L1 = 0.49 +- 0.171 (in-sample avg dev_std = 0.544)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.311
Model XAI F1 of binarized graphs for r=0.3 =  0.5158937499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.41417375
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.372
NEC for r=0.3 class 0 = 0.48 +- 0.288 (in-sample avg dev_std = 0.497)
NEC for r=0.3 class 1 = 0.535 +- 0.288 (in-sample avg dev_std = 0.497)
NEC for r=0.3 class 2 = 0.535 +- 0.288 (in-sample avg dev_std = 0.497)
NEC for r=0.3 all KL = 0.548 +- 0.288 (in-sample avg dev_std = 0.497)
NEC for r=0.3 all L1 = 0.516 +- 0.173 (in-sample avg dev_std = 0.497)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.33
Model XAI F1 of binarized graphs for r=0.4 =  0.59998
Model XAI WIoU of binarized graphs for r=0.4 =  0.49687250000000005
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.375
NEC for r=0.4 class 0 = 0.454 +- 0.295 (in-sample avg dev_std = 0.477)
NEC for r=0.4 class 1 = 0.541 +- 0.295 (in-sample avg dev_std = 0.477)
NEC for r=0.4 class 2 = 0.594 +- 0.295 (in-sample avg dev_std = 0.477)
NEC for r=0.4 all KL = 0.527 +- 0.295 (in-sample avg dev_std = 0.477)
NEC for r=0.4 all L1 = 0.529 +- 0.189 (in-sample avg dev_std = 0.477)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.632
Model XAI F1 of binarized graphs for r=0.6 =  0.6516525
Model XAI WIoU of binarized graphs for r=0.6 =  0.55193625
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.503
NEC for r=0.6 class 0 = 0.437 +- 0.321 (in-sample avg dev_std = 0.553)
NEC for r=0.6 class 1 = 0.338 +- 0.321 (in-sample avg dev_std = 0.553)
NEC for r=0.6 class 2 = 0.627 +- 0.321 (in-sample avg dev_std = 0.553)
NEC for r=0.6 all KL = 0.519 +- 0.321 (in-sample avg dev_std = 0.553)
NEC for r=0.6 all L1 = 0.47 +- 0.221 (in-sample avg dev_std = 0.553)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.685
Model XAI F1 of binarized graphs for r=0.9 =  0.57940875
Model XAI WIoU of binarized graphs for r=0.9 =  0.51532875
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.571
NEC for r=0.9 class 0 = 0.441 +- 0.259 (in-sample avg dev_std = 0.510)
NEC for r=0.9 class 1 = 0.214 +- 0.259 (in-sample avg dev_std = 0.510)
NEC for r=0.9 class 2 = 0.509 +- 0.259 (in-sample avg dev_std = 0.510)
NEC for r=0.9 all KL = 0.392 +- 0.259 (in-sample avg dev_std = 0.510)
NEC for r=0.9 all L1 = 0.391 +- 0.198 (in-sample avg dev_std = 0.510)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.675
Model XAI F1 of binarized graphs for r=0.95 =  0.56852625
Model XAI WIoU of binarized graphs for r=0.95 =  0.51183625
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.573
NEC for r=0.95 class 0 = 0.441 +- 0.255 (in-sample avg dev_std = 0.509)
NEC for r=0.95 class 1 = 0.207 +- 0.255 (in-sample avg dev_std = 0.509)
NEC for r=0.95 class 2 = 0.491 +- 0.255 (in-sample avg dev_std = 0.509)
NEC for r=0.95 all KL = 0.378 +- 0.255 (in-sample avg dev_std = 0.509)
NEC for r=0.95 all L1 = 0.383 +- 0.198 (in-sample avg dev_std = 0.509)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.674
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.50932125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.574
NEC for r=1.0 class 0 = 0.438 +- 0.254 (in-sample avg dev_std = 0.507)
NEC for r=1.0 class 1 = 0.204 +- 0.254 (in-sample avg dev_std = 0.507)
NEC for r=1.0 class 2 = 0.498 +- 0.254 (in-sample avg dev_std = 0.507)
NEC for r=1.0 all KL = 0.379 +- 0.254 (in-sample avg dev_std = 0.507)
NEC for r=1.0 all L1 = 0.383 +- 0.198 (in-sample avg dev_std = 0.507)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.698
Model XAI F1 of binarized graphs for r=0.3 =  0.7495212499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.752405
len(reference) = 797
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.501
SUFF++ for r=0.3 class 0 = 0.539 +- 0.281 (in-sample avg dev_std = 0.605)
SUFF++ for r=0.3 class 1 = 0.536 +- 0.281 (in-sample avg dev_std = 0.605)
SUFF++ for r=0.3 class 2 = 0.471 +- 0.281 (in-sample avg dev_std = 0.605)
SUFF++ for r=0.3 all KL = 0.405 +- 0.281 (in-sample avg dev_std = 0.605)
SUFF++ for r=0.3 all L1 = 0.516 +- 0.165 (in-sample avg dev_std = 0.605)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.759
Model XAI F1 of binarized graphs for r=0.4 =  0.7411150000000001
Model XAI WIoU of binarized graphs for r=0.4 =  0.82510625
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.594
SUFF++ for r=0.4 class 0 = 0.533 +- 0.295 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.4 class 1 = 0.622 +- 0.295 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.4 class 2 = 0.483 +- 0.295 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.4 all KL = 0.461 +- 0.295 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.4 all L1 = 0.547 +- 0.193 (in-sample avg dev_std = 0.576)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.882
Model XAI F1 of binarized graphs for r=0.6 =  0.62809125
Model XAI WIoU of binarized graphs for r=0.6 =  0.85293625
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.752
SUFF++ for r=0.6 class 0 = 0.619 +- 0.274 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 class 1 = 0.698 +- 0.274 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 class 2 = 0.702 +- 0.274 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 all KL = 0.661 +- 0.274 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 all L1 = 0.673 +- 0.190 (in-sample avg dev_std = 0.449)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  0.488685
Model XAI WIoU of binarized graphs for r=0.9 =  0.84634625
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.86
SUFF++ for r=0.9 class 0 = 0.785 +- 0.184 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 1 = 0.825 +- 0.184 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 2 = 0.876 +- 0.184 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 all KL = 0.873 +- 0.184 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 all L1 = 0.828 +- 0.151 (in-sample avg dev_std = 0.265)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.911
Model XAI F1 of binarized graphs for r=0.95 =  0.47120999999999996
Model XAI WIoU of binarized graphs for r=0.95 =  0.84634625
len(reference) = 719
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.892
SUFF++ for r=0.95 class 0 = 0.876 +- 0.109 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.95 class 1 = 0.874 +- 0.109 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.95 class 2 = 0.9 +- 0.109 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.95 all KL = 0.939 +- 0.109 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.95 all L1 = 0.883 +- 0.127 (in-sample avg dev_std = 0.176)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.313
Model XAI F1 of binarized graphs for r=0.3 =  0.5158937499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.41417375
len(reference) = 785
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF++ for r=0.3 class 0 = 0.484 +- 0.243 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.3 class 1 = 0.479 +- 0.243 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.3 class 2 = 0.489 +- 0.243 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.3 all KL = 0.436 +- 0.243 (in-sample avg dev_std = 0.611)
SUFF++ for r=0.3 all L1 = 0.484 +- 0.123 (in-sample avg dev_std = 0.611)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.33
Model XAI F1 of binarized graphs for r=0.4 =  0.59998
Model XAI WIoU of binarized graphs for r=0.4 =  0.49687250000000005
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.38
SUFF++ for r=0.4 class 0 = 0.508 +- 0.249 (in-sample avg dev_std = 0.575)
SUFF++ for r=0.4 class 1 = 0.503 +- 0.249 (in-sample avg dev_std = 0.575)
SUFF++ for r=0.4 class 2 = 0.459 +- 0.249 (in-sample avg dev_std = 0.575)
SUFF++ for r=0.4 all KL = 0.48 +- 0.249 (in-sample avg dev_std = 0.575)
SUFF++ for r=0.4 all L1 = 0.49 +- 0.141 (in-sample avg dev_std = 0.575)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.632
Model XAI F1 of binarized graphs for r=0.6 =  0.6516525
Model XAI WIoU of binarized graphs for r=0.6 =  0.55193625
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.641
SUFF++ for r=0.6 class 0 = 0.538 +- 0.263 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.6 class 1 = 0.791 +- 0.263 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.6 class 2 = 0.703 +- 0.263 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.6 all KL = 0.655 +- 0.263 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.6 all L1 = 0.675 +- 0.220 (in-sample avg dev_std = 0.489)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.685
Model XAI F1 of binarized graphs for r=0.9 =  0.57940875
Model XAI WIoU of binarized graphs for r=0.9 =  0.51532875
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.688
SUFF++ for r=0.9 class 0 = 0.576 +- 0.224 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.9 class 1 = 0.942 +- 0.224 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.9 class 2 = 0.776 +- 0.224 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.9 all KL = 0.82 +- 0.224 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.9 all L1 = 0.762 +- 0.219 (in-sample avg dev_std = 0.331)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.675
Model XAI F1 of binarized graphs for r=0.95 =  0.56852625
Model XAI WIoU of binarized graphs for r=0.95 =  0.51183625
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.652
SUFF++ for r=0.95 class 0 = 0.855 +- 0.107 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.95 class 1 = 0.964 +- 0.107 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.95 class 2 = 0.898 +- 0.107 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.95 all KL = 0.95 +- 0.107 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.95 all L1 = 0.904 +- 0.125 (in-sample avg dev_std = 0.184)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 13:14:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 01:14:54 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:07 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:09 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:12 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:13 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:15:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9082
Train Loss: 0.4161
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4276
ID Test ACCURACY: 0.9077
ID Test Loss: 0.4175
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3282
OOD Test ACCURACY: 0.8457
OOD Test Loss: 0.4898

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8790
Train Loss: 0.4656
ID Validation ACCURACY: 0.8803
ID Validation Loss: 0.4735
ID Test ACCURACY: 0.8743
ID Test Loss: 0.4768
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3354
OOD Test ACCURACY: 0.8413
OOD Test Loss: 0.5178

[0m[1;37mINFO[0m: [1mChartInfo 0.9077 0.8457 0.8743 0.8413 0.8803 0.9317[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))

Gold ratio (id_test) =  tensor(0.3175) +- tensor(0.1645)
F1 for r=0.3 = 0.735
WIoU for r=0.3 = 0.719
F1 for r=0.4 = 0.739
WIoU for r=0.4 = 0.801
F1 for r=0.6 = 0.632
WIoU for r=0.6 = 0.827
F1 for r=0.9 = 0.489
WIoU for r=0.9 = 0.825
F1 for r=0.95 = 0.471
WIoU for r=0.95 = 0.825
F1 for r=1.0 = 0.459
WIoU for r=1.0 = 0.824
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.540
WIoU for r=0.3 = 0.420
F1 for r=0.4 = 0.595
WIoU for r=0.4 = 0.472
F1 for r=0.6 = 0.646
WIoU for r=0.6 = 0.510
F1 for r=0.9 = 0.592
WIoU for r=0.9 = 0.496
F1 for r=0.95 = 0.572
WIoU for r=0.95 = 0.495
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.495


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.611
Model XAI F1 of binarized graphs for r=0.3 =  0.7351737499999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.7189675
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.345
NEC for r=0.3 class 0 = 0.615 +- 0.288 (in-sample avg dev_std = 0.467)
NEC for r=0.3 class 1 = 0.591 +- 0.288 (in-sample avg dev_std = 0.467)
NEC for r=0.3 class 2 = 0.617 +- 0.288 (in-sample avg dev_std = 0.467)
NEC for r=0.3 all KL = 0.663 +- 0.288 (in-sample avg dev_std = 0.467)
NEC for r=0.3 all L1 = 0.607 +- 0.159 (in-sample avg dev_std = 0.467)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.714
Model XAI F1 of binarized graphs for r=0.4 =  0.73922
Model XAI WIoU of binarized graphs for r=0.4 =  0.8012762500000001
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.389
NEC for r=0.4 class 0 = 0.572 +- 0.261 (in-sample avg dev_std = 0.447)
NEC for r=0.4 class 1 = 0.635 +- 0.261 (in-sample avg dev_std = 0.447)
NEC for r=0.4 class 2 = 0.623 +- 0.261 (in-sample avg dev_std = 0.447)
NEC for r=0.4 all KL = 0.661 +- 0.261 (in-sample avg dev_std = 0.447)
NEC for r=0.4 all L1 = 0.61 +- 0.144 (in-sample avg dev_std = 0.447)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.845
Model XAI F1 of binarized graphs for r=0.6 =  0.6316875000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.82688875
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.447
NEC for r=0.6 class 0 = 0.545 +- 0.287 (in-sample avg dev_std = 0.500)
NEC for r=0.6 class 1 = 0.583 +- 0.287 (in-sample avg dev_std = 0.500)
NEC for r=0.6 class 2 = 0.62 +- 0.287 (in-sample avg dev_std = 0.500)
NEC for r=0.6 all KL = 0.637 +- 0.287 (in-sample avg dev_std = 0.500)
NEC for r=0.6 all L1 = 0.582 +- 0.157 (in-sample avg dev_std = 0.500)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.48920874999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.8250737499999999
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.523
NEC for r=0.9 class 0 = 0.481 +- 0.280 (in-sample avg dev_std = 0.527)
NEC for r=0.9 class 1 = 0.532 +- 0.280 (in-sample avg dev_std = 0.527)
NEC for r=0.9 class 2 = 0.575 +- 0.280 (in-sample avg dev_std = 0.527)
NEC for r=0.9 all KL = 0.555 +- 0.280 (in-sample avg dev_std = 0.527)
NEC for r=0.9 all L1 = 0.529 +- 0.160 (in-sample avg dev_std = 0.527)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.904
Model XAI F1 of binarized graphs for r=0.95 =  0.4713525
Model XAI WIoU of binarized graphs for r=0.95 =  0.82454
len(reference) = 800
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.539
NEC for r=0.95 class 0 = 0.48 +- 0.270 (in-sample avg dev_std = 0.535)
NEC for r=0.95 class 1 = 0.527 +- 0.270 (in-sample avg dev_std = 0.535)
NEC for r=0.95 class 2 = 0.545 +- 0.270 (in-sample avg dev_std = 0.535)
NEC for r=0.95 all KL = 0.543 +- 0.270 (in-sample avg dev_std = 0.535)
NEC for r=0.95 all L1 = 0.517 +- 0.156 (in-sample avg dev_std = 0.535)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.902
Model XAI F1 of binarized graphs for r=1.0 =  0.45948124999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.8244962499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.535
NEC for r=1.0 class 0 = 0.49 +- 0.268 (in-sample avg dev_std = 0.544)
NEC for r=1.0 class 1 = 0.527 +- 0.268 (in-sample avg dev_std = 0.544)
NEC for r=1.0 class 2 = 0.553 +- 0.268 (in-sample avg dev_std = 0.544)
NEC for r=1.0 all KL = 0.553 +- 0.268 (in-sample avg dev_std = 0.544)
NEC for r=1.0 all L1 = 0.523 +- 0.151 (in-sample avg dev_std = 0.544)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.321
Model XAI F1 of binarized graphs for r=0.3 =  0.53952625
Model XAI WIoU of binarized graphs for r=0.3 =  0.41968249999999996
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.488 +- 0.246 (in-sample avg dev_std = 0.462)
NEC for r=0.3 class 1 = 0.517 +- 0.246 (in-sample avg dev_std = 0.462)
NEC for r=0.3 class 2 = 0.474 +- 0.246 (in-sample avg dev_std = 0.462)
NEC for r=0.3 all KL = 0.409 +- 0.246 (in-sample avg dev_std = 0.462)
NEC for r=0.3 all L1 = 0.492 +- 0.185 (in-sample avg dev_std = 0.462)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.384
Model XAI F1 of binarized graphs for r=0.4 =  0.59456875
Model XAI WIoU of binarized graphs for r=0.4 =  0.4722625000000001
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.327
NEC for r=0.4 class 0 = 0.475 +- 0.246 (in-sample avg dev_std = 0.440)
NEC for r=0.4 class 1 = 0.517 +- 0.246 (in-sample avg dev_std = 0.440)
NEC for r=0.4 class 2 = 0.587 +- 0.246 (in-sample avg dev_std = 0.440)
NEC for r=0.4 all KL = 0.433 +- 0.246 (in-sample avg dev_std = 0.440)
NEC for r=0.4 all L1 = 0.526 +- 0.154 (in-sample avg dev_std = 0.440)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.738
Model XAI F1 of binarized graphs for r=0.6 =  0.6458625000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.50951875
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.531
NEC for r=0.6 class 0 = 0.538 +- 0.277 (in-sample avg dev_std = 0.591)
NEC for r=0.6 class 1 = 0.501 +- 0.277 (in-sample avg dev_std = 0.591)
NEC for r=0.6 class 2 = 0.626 +- 0.277 (in-sample avg dev_std = 0.591)
NEC for r=0.6 all KL = 0.603 +- 0.277 (in-sample avg dev_std = 0.591)
NEC for r=0.6 all L1 = 0.556 +- 0.145 (in-sample avg dev_std = 0.591)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.87
Model XAI F1 of binarized graphs for r=0.9 =  0.59204375
Model XAI WIoU of binarized graphs for r=0.9 =  0.49600875
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.623
NEC for r=0.9 class 0 = 0.45 +- 0.244 (in-sample avg dev_std = 0.568)
NEC for r=0.9 class 1 = 0.423 +- 0.244 (in-sample avg dev_std = 0.568)
NEC for r=0.9 class 2 = 0.518 +- 0.244 (in-sample avg dev_std = 0.568)
NEC for r=0.9 all KL = 0.497 +- 0.244 (in-sample avg dev_std = 0.568)
NEC for r=0.9 all L1 = 0.465 +- 0.146 (in-sample avg dev_std = 0.568)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.864
Model XAI F1 of binarized graphs for r=0.95 =  0.571705
Model XAI WIoU of binarized graphs for r=0.95 =  0.49546875000000007
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.644
NEC for r=0.95 class 0 = 0.443 +- 0.241 (in-sample avg dev_std = 0.570)
NEC for r=0.95 class 1 = 0.399 +- 0.241 (in-sample avg dev_std = 0.570)
NEC for r=0.95 class 2 = 0.511 +- 0.241 (in-sample avg dev_std = 0.570)
NEC for r=0.95 all KL = 0.48 +- 0.241 (in-sample avg dev_std = 0.570)
NEC for r=0.95 all L1 = 0.452 +- 0.145 (in-sample avg dev_std = 0.570)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.864
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.49549374999999996
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.642
NEC for r=1.0 class 0 = 0.445 +- 0.235 (in-sample avg dev_std = 0.569)
NEC for r=1.0 class 1 = 0.407 +- 0.235 (in-sample avg dev_std = 0.569)
NEC for r=1.0 class 2 = 0.504 +- 0.235 (in-sample avg dev_std = 0.569)
NEC for r=1.0 all KL = 0.482 +- 0.235 (in-sample avg dev_std = 0.569)
NEC for r=1.0 all L1 = 0.453 +- 0.142 (in-sample avg dev_std = 0.569)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.614
Model XAI F1 of binarized graphs for r=0.3 =  0.7351737499999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.7189675
len(reference) = 795
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.44
SUFF++ for r=0.3 class 0 = 0.495 +- 0.275 (in-sample avg dev_std = 0.597)
SUFF++ for r=0.3 class 1 = 0.507 +- 0.275 (in-sample avg dev_std = 0.597)
SUFF++ for r=0.3 class 2 = 0.434 +- 0.275 (in-sample avg dev_std = 0.597)
SUFF++ for r=0.3 all KL = 0.411 +- 0.275 (in-sample avg dev_std = 0.597)
SUFF++ for r=0.3 all L1 = 0.479 +- 0.153 (in-sample avg dev_std = 0.597)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.714
Model XAI F1 of binarized graphs for r=0.4 =  0.73922
Model XAI WIoU of binarized graphs for r=0.4 =  0.8012762500000001
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.559
SUFF++ for r=0.4 class 0 = 0.505 +- 0.267 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.4 class 1 = 0.584 +- 0.267 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.4 class 2 = 0.453 +- 0.267 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.4 all KL = 0.45 +- 0.267 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.4 all L1 = 0.515 +- 0.173 (in-sample avg dev_std = 0.548)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.845
Model XAI F1 of binarized graphs for r=0.6 =  0.6316875000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.82688875
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.731
SUFF++ for r=0.6 class 0 = 0.618 +- 0.276 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 1 = 0.7 +- 0.276 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 2 = 0.642 +- 0.276 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 all KL = 0.623 +- 0.276 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 all L1 = 0.654 +- 0.195 (in-sample avg dev_std = 0.462)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.48920874999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.8250737499999999
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.837
SUFF++ for r=0.9 class 0 = 0.756 +- 0.212 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 class 1 = 0.778 +- 0.212 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 class 2 = 0.836 +- 0.212 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 all KL = 0.844 +- 0.212 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 all L1 = 0.789 +- 0.192 (in-sample avg dev_std = 0.278)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.903
Model XAI F1 of binarized graphs for r=0.95 =  0.4713525
Model XAI WIoU of binarized graphs for r=0.95 =  0.82454
len(reference) = 719
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.866
SUFF++ for r=0.95 class 0 = 0.832 +- 0.183 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.95 class 1 = 0.824 +- 0.183 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.95 class 2 = 0.873 +- 0.183 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.95 all KL = 0.895 +- 0.183 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.95 all L1 = 0.842 +- 0.174 (in-sample avg dev_std = 0.233)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.324
Model XAI F1 of binarized graphs for r=0.3 =  0.53952625
Model XAI WIoU of binarized graphs for r=0.3 =  0.41968249999999996
len(reference) = 787
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.346
SUFF++ for r=0.3 class 0 = 0.55 +- 0.196 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 class 1 = 0.576 +- 0.196 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 class 2 = 0.559 +- 0.196 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 all KL = 0.645 +- 0.196 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 all L1 = 0.561 +- 0.134 (in-sample avg dev_std = 0.530)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.384
Model XAI F1 of binarized graphs for r=0.4 =  0.59456875
Model XAI WIoU of binarized graphs for r=0.4 =  0.4722625000000001
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.402
SUFF++ for r=0.4 class 0 = 0.538 +- 0.217 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.4 class 1 = 0.577 +- 0.217 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.4 class 2 = 0.487 +- 0.217 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.4 all KL = 0.636 +- 0.217 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.4 all L1 = 0.533 +- 0.127 (in-sample avg dev_std = 0.473)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.738
Model XAI F1 of binarized graphs for r=0.6 =  0.6458625000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.50951875
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.666
SUFF++ for r=0.6 class 0 = 0.559 +- 0.262 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 1 = 0.76 +- 0.262 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 2 = 0.666 +- 0.262 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 all KL = 0.671 +- 0.262 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 all L1 = 0.66 +- 0.194 (in-sample avg dev_std = 0.470)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.87
Model XAI F1 of binarized graphs for r=0.9 =  0.59204375
Model XAI WIoU of binarized graphs for r=0.9 =  0.49600875
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.756
SUFF++ for r=0.9 class 0 = 0.671 +- 0.240 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.9 class 1 = 0.911 +- 0.240 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.9 class 2 = 0.689 +- 0.240 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.9 all KL = 0.807 +- 0.240 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.9 all L1 = 0.754 +- 0.206 (in-sample avg dev_std = 0.369)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.864
Model XAI F1 of binarized graphs for r=0.95 =  0.571705
Model XAI WIoU of binarized graphs for r=0.95 =  0.49546875000000007
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.853
SUFF++ for r=0.95 class 0 = 0.896 +- 0.065 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.95 class 1 = 0.956 +- 0.065 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.95 class 2 = 0.918 +- 0.065 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.95 all KL = 0.968 +- 0.065 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.95 all L1 = 0.923 +- 0.091 (in-sample avg dev_std = 0.141)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.61, 0.614, 0.59, 0.531, 0.526, 0.523], 'all_L1': [0.564, 0.567, 0.546, 0.5, 0.497, 0.496]}), defaultdict(<class 'list'>, {'all_KL': [0.603, 0.574, 0.567, 0.519, 0.508, 0.509], 'all_L1': [0.566, 0.558, 0.551, 0.506, 0.501, 0.503]}), defaultdict(<class 'list'>, {'all_KL': [0.658, 0.647, 0.624, 0.561, 0.554, 0.558], 'all_L1': [0.594, 0.569, 0.565, 0.522, 0.514, 0.516]}), defaultdict(<class 'list'>, {'all_KL': [0.673, 0.657, 0.58, 0.523, 0.512, 0.508], 'all_L1': [0.585, 0.589, 0.549, 0.504, 0.493, 0.49]}), defaultdict(<class 'list'>, {'all_KL': [0.663, 0.661, 0.637, 0.555, 0.543, 0.553], 'all_L1': [0.607, 0.61, 0.582, 0.529, 0.517, 0.523]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.431, 0.485, 0.638, 0.889, 0.942, 1.0], 'all_L1': [0.503, 0.542, 0.658, 0.848, 0.905, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.414, 0.5, 0.659, 0.856, 0.928, 1.0], 'all_L1': [0.476, 0.523, 0.654, 0.791, 0.864, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.41, 0.436, 0.586, 0.802, 0.894, 1.0], 'all_L1': [0.502, 0.531, 0.633, 0.759, 0.847, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.461, 0.661, 0.873, 0.939, 1.0], 'all_L1': [0.516, 0.547, 0.673, 0.828, 0.883, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.411, 0.45, 0.623, 0.844, 0.895, 1.0], 'all_L1': [0.479, 0.515, 0.654, 0.789, 0.842, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]

Eval split test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.166, 0.266, 0.416, 0.436, 0.39, 0.391], 'all_L1': [0.289, 0.37, 0.456, 0.414, 0.392, 0.392]}), defaultdict(<class 'list'>, {'all_KL': [0.369, 0.457, 0.471, 0.342, 0.312, 0.305], 'all_L1': [0.357, 0.469, 0.48, 0.377, 0.36, 0.357]}), defaultdict(<class 'list'>, {'all_KL': [0.474, 0.471, 0.557, 0.438, 0.424, 0.419], 'all_L1': [0.53, 0.514, 0.496, 0.425, 0.413, 0.409]}), defaultdict(<class 'list'>, {'all_KL': [0.548, 0.527, 0.519, 0.392, 0.378, 0.379], 'all_L1': [0.516, 0.529, 0.47, 0.391, 0.383, 0.383]}), defaultdict(<class 'list'>, {'all_KL': [0.409, 0.433, 0.603, 0.497, 0.48, 0.482], 'all_L1': [0.492, 0.526, 0.556, 0.465, 0.452, 0.453]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.755, 0.662, 0.676, 0.91, 0.976, 1.0], 'all_L1': [0.647, 0.581, 0.618, 0.827, 0.927, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.406, 0.435, 0.666, 0.943, 0.963, 1.0], 'all_L1': [0.532, 0.479, 0.634, 0.857, 0.911, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.588, 0.62, 0.731, 0.901, 0.977, 1.0], 'all_L1': [0.525, 0.566, 0.725, 0.821, 0.934, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.436, 0.48, 0.655, 0.82, 0.95, 1.0], 'all_L1': [0.484, 0.49, 0.675, 0.762, 0.904, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.645, 0.636, 0.671, 0.807, 0.968, 1.0], 'all_L1': [0.561, 0.533, 0.66, 0.754, 0.923, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.583 +- 0.016, 0.579 +- 0.019, 0.559 +- 0.013, 0.512 +- 0.011, 0.504 +- 0.009, 0.506 +- 0.012
nec class all_KL  =  0.641 +- 0.029, 0.631 +- 0.033, 0.600 +- 0.027, 0.538 +- 0.017, 0.529 +- 0.018, 0.530 +- 0.021
nec_acc_int  =  0.379 +- 0.022, 0.404 +- 0.012, 0.469 +- 0.016, 0.539 +- 0.014, 0.549 +- 0.014, 0.549 +- 0.016
suff++ class all_L1  =  0.495 +- 0.015, 0.532 +- 0.012, 0.654 +- 0.013, 0.803 +- 0.031, 0.868 +- 0.023, 1.000 +- 0.000
suff++ class all_KL  =  0.414 +- 0.009, 0.466 +- 0.023, 0.633 +- 0.028, 0.853 +- 0.030, 0.920 +- 0.021, 1.000 +- 0.000
suff++_acc_int  =  0.465 +- 0.021, 0.565 +- 0.015, 0.732 +- 0.014, 0.840 +- 0.018, 0.870 +- 0.016

Eval split test
nec class all_L1  =  0.437 +- 0.096, 0.482 +- 0.060, 0.492 +- 0.035, 0.414 +- 0.030, 0.400 +- 0.031, 0.399 +- 0.032
nec class all_KL  =  0.393 +- 0.129, 0.431 +- 0.088, 0.513 +- 0.065, 0.421 +- 0.052, 0.397 +- 0.055, 0.395 +- 0.057
nec_acc_int  =  0.360 +- 0.013, 0.381 +- 0.037, 0.507 +- 0.022, 0.603 +- 0.018, 0.617 +- 0.025, 0.615 +- 0.027
suff++ class all_L1  =  0.550 +- 0.054, 0.530 +- 0.040, 0.662 +- 0.037, 0.804 +- 0.040, 0.920 +- 0.011, 1.000 +- 0.000
suff++ class all_KL  =  0.566 +- 0.130, 0.567 +- 0.091, 0.680 +- 0.027, 0.876 +- 0.053, 0.967 +- 0.010, 1.000 +- 0.000
suff++_acc_int  =  0.346 +- 0.015, 0.384 +- 0.023, 0.584 +- 0.096, 0.737 +- 0.030, 0.720 +- 0.072


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.539 +- 0.011, 0.555 +- 0.010, 0.607 +- 0.007, 0.658 +- 0.012, 0.686 +- 0.008, 0.753 +- 0.006
Faith. Armon (L1)= 		  =  0.535 +- 0.011, 0.554 +- 0.009, 0.603 +- 0.007, 0.625 +- 0.006, 0.638 +- 0.004, 0.672 +- 0.011
Faith. GMean (L1)= 	  =  0.537 +- 0.011, 0.554 +- 0.009, 0.605 +- 0.007, 0.641 +- 0.008, 0.662 +- 0.005, 0.711 +- 0.009
Faith. Aritm (KL)= 		  =  0.528 +- 0.012, 0.548 +- 0.008, 0.617 +- 0.008, 0.695 +- 0.010, 0.724 +- 0.006, 0.765 +- 0.011
Faith. Armon (KL)= 		  =  0.503 +- 0.006, 0.535 +- 0.008, 0.615 +- 0.009, 0.659 +- 0.008, 0.671 +- 0.010, 0.693 +- 0.018
Faith. GMean (KL)= 	  =  0.515 +- 0.008, 0.542 +- 0.007, 0.616 +- 0.008, 0.677 +- 0.008, 0.697 +- 0.007, 0.728 +- 0.015

Eval split test
Faith. Aritm (L1)= 		  =  0.493 +- 0.033, 0.506 +- 0.027, 0.577 +- 0.029, 0.609 +- 0.017, 0.660 +- 0.019, 0.699 +- 0.016
Faith. Armon (L1)= 		  =  0.476 +- 0.052, 0.501 +- 0.033, 0.564 +- 0.029, 0.546 +- 0.022, 0.557 +- 0.031, 0.569 +- 0.032
Faith. GMean (L1)= 	  =  0.484 +- 0.042, 0.503 +- 0.030, 0.570 +- 0.029, 0.576 +- 0.017, 0.606 +- 0.025, 0.631 +- 0.025
Faith. Aritm (KL)= 		  =  0.480 +- 0.053, 0.499 +- 0.039, 0.597 +- 0.038, 0.649 +- 0.024, 0.682 +- 0.030, 0.698 +- 0.029
Faith. Armon (KL)= 		  =  0.434 +- 0.094, 0.476 +- 0.057, 0.583 +- 0.046, 0.565 +- 0.042, 0.561 +- 0.056, 0.564 +- 0.060
Faith. GMean (KL)= 	  =  0.454 +- 0.070, 0.487 +- 0.046, 0.590 +- 0.042, 0.605 +- 0.031, 0.618 +- 0.045, 0.627 +- 0.046
Computed for split load_split = id



Completed in  0:21:01.937134  for LECIGIN GOODMotif/basis



DONE LECI GOODMotif/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 13:19:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 01:19:13 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 01:19:27 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 01:19:29 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 01:19:31 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 01:19:33 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 01:19:34 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 01:19:34 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 01:19:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:19:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:19:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:19:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:19:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:19:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:19:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:19:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3178
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3259
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3250
OOD Validation ACCURACY: 0.8527
OOD Validation Loss: 0.5111
OOD Test ACCURACY: 0.6287
OOD Test Loss: 1.1683

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9295
Train Loss: 0.3278
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3391
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3296
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3661
OOD Test ACCURACY: 0.5353
OOD Test Loss: 1.3356

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.6287 0.9287 0.5353 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))

Gold ratio (id_test) =  tensor(0.3175) +- tensor(0.1645)
F1 for r=0.3 = 0.699
WIoU for r=0.3 = 0.573
F1 for r=0.4 = 0.696
WIoU for r=0.4 = 0.584
F1 for r=0.6 = 0.602
WIoU for r=0.6 = 0.481
F1 for r=0.9 = 0.485
WIoU for r=0.9 = 0.360
F1 for r=0.95 = 0.469
WIoU for r=0.95 = 0.346
F1 for r=1.0 = 0.459
WIoU for r=1.0 = 0.337
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.353
WIoU for r=0.3 = 0.253
F1 for r=0.4 = 0.464
WIoU for r=0.4 = 0.342
F1 for r=0.6 = 0.626
WIoU for r=0.6 = 0.484
F1 for r=0.9 = 0.592
WIoU for r=0.9 = 0.434
F1 for r=0.95 = 0.572
WIoU for r=0.95 = 0.415
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.401


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.567
Model XAI F1 of binarized graphs for r=0.3 =  0.69909375
Model XAI WIoU of binarized graphs for r=0.3 =  0.57315375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.328
NEC for r=0.3 class 0 = 0.675 +- 0.307 (in-sample avg dev_std = 0.429)
NEC for r=0.3 class 1 = 0.535 +- 0.307 (in-sample avg dev_std = 0.429)
NEC for r=0.3 class 2 = 0.501 +- 0.307 (in-sample avg dev_std = 0.429)
NEC for r=0.3 all KL = 0.616 +- 0.307 (in-sample avg dev_std = 0.429)
NEC for r=0.3 all L1 = 0.571 +- 0.214 (in-sample avg dev_std = 0.429)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.553
Model XAI F1 of binarized graphs for r=0.4 =  0.6962674999999998
Model XAI WIoU of binarized graphs for r=0.4 =  0.584095
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.343
NEC for r=0.4 class 0 = 0.575 +- 0.273 (in-sample avg dev_std = 0.514)
NEC for r=0.4 class 1 = 0.621 +- 0.273 (in-sample avg dev_std = 0.514)
NEC for r=0.4 class 2 = 0.591 +- 0.273 (in-sample avg dev_std = 0.514)
NEC for r=0.4 all KL = 0.652 +- 0.273 (in-sample avg dev_std = 0.514)
NEC for r=0.4 all L1 = 0.596 +- 0.173 (in-sample avg dev_std = 0.514)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.68
Model XAI F1 of binarized graphs for r=0.6 =  0.60237
Model XAI WIoU of binarized graphs for r=0.6 =  0.48069625000000005
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.37
NEC for r=0.6 class 0 = 0.577 +- 0.250 (in-sample avg dev_std = 0.521)
NEC for r=0.6 class 1 = 0.614 +- 0.250 (in-sample avg dev_std = 0.521)
NEC for r=0.6 class 2 = 0.595 +- 0.250 (in-sample avg dev_std = 0.521)
NEC for r=0.6 all KL = 0.667 +- 0.250 (in-sample avg dev_std = 0.521)
NEC for r=0.6 all L1 = 0.595 +- 0.162 (in-sample avg dev_std = 0.521)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.914
Model XAI F1 of binarized graphs for r=0.9 =  0.48511125
Model XAI WIoU of binarized graphs for r=0.9 =  0.36031375
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.478
NEC for r=0.9 class 0 = 0.61 +- 0.221 (in-sample avg dev_std = 0.614)
NEC for r=0.9 class 1 = 0.56 +- 0.221 (in-sample avg dev_std = 0.614)
NEC for r=0.9 class 2 = 0.568 +- 0.221 (in-sample avg dev_std = 0.614)
NEC for r=0.9 all KL = 0.656 +- 0.221 (in-sample avg dev_std = 0.614)
NEC for r=0.9 all L1 = 0.58 +- 0.150 (in-sample avg dev_std = 0.614)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.925
Model XAI F1 of binarized graphs for r=0.95 =  0.46938625
Model XAI WIoU of binarized graphs for r=0.95 =  0.34554874999999996
len(reference) = 800
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.516
NEC for r=0.95 class 0 = 0.588 +- 0.229 (in-sample avg dev_std = 0.640)
NEC for r=0.95 class 1 = 0.545 +- 0.229 (in-sample avg dev_std = 0.640)
NEC for r=0.95 class 2 = 0.551 +- 0.229 (in-sample avg dev_std = 0.640)
NEC for r=0.95 all KL = 0.641 +- 0.229 (in-sample avg dev_std = 0.640)
NEC for r=0.95 all L1 = 0.561 +- 0.162 (in-sample avg dev_std = 0.640)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  0.45948124999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.33684875000000003
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.517
NEC for r=1.0 class 0 = 0.551 +- 0.238 (in-sample avg dev_std = 0.652)
NEC for r=1.0 class 1 = 0.52 +- 0.238 (in-sample avg dev_std = 0.652)
NEC for r=1.0 class 2 = 0.582 +- 0.238 (in-sample avg dev_std = 0.652)
NEC for r=1.0 all KL = 0.625 +- 0.238 (in-sample avg dev_std = 0.652)
NEC for r=1.0 all L1 = 0.551 +- 0.173 (in-sample avg dev_std = 0.652)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.341
Model XAI F1 of binarized graphs for r=0.3 =  0.35312375
Model XAI WIoU of binarized graphs for r=0.3 =  0.25282875
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.335
NEC for r=0.3 class 0 = 0.514 +- 0.288 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 1 = 0.303 +- 0.288 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 2 = 0.43 +- 0.288 (in-sample avg dev_std = 0.404)
NEC for r=0.3 all KL = 0.411 +- 0.288 (in-sample avg dev_std = 0.404)
NEC for r=0.3 all L1 = 0.418 +- 0.206 (in-sample avg dev_std = 0.404)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.29
Model XAI F1 of binarized graphs for r=0.4 =  0.46437875
Model XAI WIoU of binarized graphs for r=0.4 =  0.34180625
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.351
NEC for r=0.4 class 0 = 0.543 +- 0.273 (in-sample avg dev_std = 0.509)
NEC for r=0.4 class 1 = 0.476 +- 0.273 (in-sample avg dev_std = 0.509)
NEC for r=0.4 class 2 = 0.515 +- 0.273 (in-sample avg dev_std = 0.509)
NEC for r=0.4 all KL = 0.509 +- 0.273 (in-sample avg dev_std = 0.509)
NEC for r=0.4 all L1 = 0.512 +- 0.170 (in-sample avg dev_std = 0.509)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.459
Model XAI F1 of binarized graphs for r=0.6 =  0.62624875
Model XAI WIoU of binarized graphs for r=0.6 =  0.48375124999999997
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.443
NEC for r=0.6 class 0 = 0.638 +- 0.247 (in-sample avg dev_std = 0.547)
NEC for r=0.6 class 1 = 0.595 +- 0.247 (in-sample avg dev_std = 0.547)
NEC for r=0.6 class 2 = 0.622 +- 0.247 (in-sample avg dev_std = 0.547)
NEC for r=0.6 all KL = 0.661 +- 0.247 (in-sample avg dev_std = 0.547)
NEC for r=0.6 all L1 = 0.619 +- 0.138 (in-sample avg dev_std = 0.547)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.699
Model XAI F1 of binarized graphs for r=0.9 =  0.59177625
Model XAI WIoU of binarized graphs for r=0.9 =  0.43375749999999996
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.533
NEC for r=0.9 class 0 = 0.538 +- 0.214 (in-sample avg dev_std = 0.546)
NEC for r=0.9 class 1 = 0.429 +- 0.214 (in-sample avg dev_std = 0.546)
NEC for r=0.9 class 2 = 0.529 +- 0.214 (in-sample avg dev_std = 0.546)
NEC for r=0.9 all KL = 0.481 +- 0.214 (in-sample avg dev_std = 0.546)
NEC for r=0.9 all L1 = 0.5 +- 0.137 (in-sample avg dev_std = 0.546)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.71
Model XAI F1 of binarized graphs for r=0.95 =  0.57151375
Model XAI WIoU of binarized graphs for r=0.95 =  0.41453249999999997
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.571
NEC for r=0.95 class 0 = 0.508 +- 0.201 (in-sample avg dev_std = 0.502)
NEC for r=0.95 class 1 = 0.374 +- 0.201 (in-sample avg dev_std = 0.502)
NEC for r=0.95 class 2 = 0.501 +- 0.201 (in-sample avg dev_std = 0.502)
NEC for r=0.95 all KL = 0.432 +- 0.201 (in-sample avg dev_std = 0.502)
NEC for r=0.95 all L1 = 0.463 +- 0.148 (in-sample avg dev_std = 0.502)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.629
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.401135
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.562
NEC for r=1.0 class 0 = 0.492 +- 0.210 (in-sample avg dev_std = 0.509)
NEC for r=1.0 class 1 = 0.309 +- 0.210 (in-sample avg dev_std = 0.509)
NEC for r=1.0 class 2 = 0.512 +- 0.210 (in-sample avg dev_std = 0.509)
NEC for r=1.0 all KL = 0.432 +- 0.210 (in-sample avg dev_std = 0.509)
NEC for r=1.0 all L1 = 0.44 +- 0.173 (in-sample avg dev_std = 0.509)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.569
Model XAI F1 of binarized graphs for r=0.3 =  0.69909375
Model XAI WIoU of binarized graphs for r=0.3 =  0.57315375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.409
SUFF++ for r=0.3 class 0 = 0.417 +- 0.279 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 class 1 = 0.542 +- 0.279 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 class 2 = 0.6 +- 0.279 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 all KL = 0.481 +- 0.279 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 all L1 = 0.518 +- 0.198 (in-sample avg dev_std = 0.494)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.554
Model XAI F1 of binarized graphs for r=0.4 =  0.6962674999999998
Model XAI WIoU of binarized graphs for r=0.4 =  0.584095
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.439
SUFF++ for r=0.4 class 0 = 0.451 +- 0.281 (in-sample avg dev_std = 0.573)
SUFF++ for r=0.4 class 1 = 0.445 +- 0.281 (in-sample avg dev_std = 0.573)
SUFF++ for r=0.4 class 2 = 0.594 +- 0.281 (in-sample avg dev_std = 0.573)
SUFF++ for r=0.4 all KL = 0.45 +- 0.281 (in-sample avg dev_std = 0.573)
SUFF++ for r=0.4 all L1 = 0.495 +- 0.186 (in-sample avg dev_std = 0.573)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.68
Model XAI F1 of binarized graphs for r=0.6 =  0.60237
Model XAI WIoU of binarized graphs for r=0.6 =  0.48069625000000005
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.619
SUFF++ for r=0.6 class 0 = 0.414 +- 0.289 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 class 1 = 0.528 +- 0.289 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 class 2 = 0.666 +- 0.289 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 all KL = 0.497 +- 0.289 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.6 all L1 = 0.534 +- 0.213 (in-sample avg dev_std = 0.531)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  0.48511125
Model XAI WIoU of binarized graphs for r=0.9 =  0.36031375
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.837
SUFF++ for r=0.9 class 0 = 0.654 +- 0.182 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 class 1 = 0.809 +- 0.182 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 class 2 = 0.875 +- 0.182 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 all KL = 0.84 +- 0.182 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.9 all L1 = 0.778 +- 0.167 (in-sample avg dev_std = 0.262)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.926
Model XAI F1 of binarized graphs for r=0.95 =  0.46938625
Model XAI WIoU of binarized graphs for r=0.95 =  0.34554874999999996
len(reference) = 719
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.897
SUFF++ for r=0.95 class 0 = 0.828 +- 0.115 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.95 class 1 = 0.881 +- 0.115 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.95 class 2 = 0.912 +- 0.115 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.95 all KL = 0.927 +- 0.115 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.95 all L1 = 0.873 +- 0.119 (in-sample avg dev_std = 0.190)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.341
Model XAI F1 of binarized graphs for r=0.3 =  0.35312375
Model XAI WIoU of binarized graphs for r=0.3 =  0.25282875
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.349
SUFF++ for r=0.3 class 0 = 0.608 +- 0.224 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.3 class 1 = 0.678 +- 0.224 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.3 class 2 = 0.634 +- 0.224 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.3 all KL = 0.652 +- 0.224 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.3 all L1 = 0.639 +- 0.157 (in-sample avg dev_std = 0.413)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.294
Model XAI F1 of binarized graphs for r=0.4 =  0.46437875
Model XAI WIoU of binarized graphs for r=0.4 =  0.34180625
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.337
SUFF++ for r=0.4 class 0 = 0.527 +- 0.245 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.4 class 1 = 0.569 +- 0.245 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.4 class 2 = 0.547 +- 0.245 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.4 all KL = 0.552 +- 0.245 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.4 all L1 = 0.547 +- 0.148 (in-sample avg dev_std = 0.506)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.459
Model XAI F1 of binarized graphs for r=0.6 =  0.62624875
Model XAI WIoU of binarized graphs for r=0.6 =  0.48375124999999997
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.51
SUFF++ for r=0.6 class 0 = 0.458 +- 0.255 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.6 class 1 = 0.548 +- 0.255 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.6 class 2 = 0.568 +- 0.255 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.6 all KL = 0.513 +- 0.255 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.6 all L1 = 0.524 +- 0.191 (in-sample avg dev_std = 0.535)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.699
Model XAI F1 of binarized graphs for r=0.9 =  0.59177625
Model XAI WIoU of binarized graphs for r=0.9 =  0.43375749999999996
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.676
SUFF++ for r=0.9 class 0 = 0.665 +- 0.172 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 1 = 0.887 +- 0.172 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 class 2 = 0.739 +- 0.172 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 all KL = 0.849 +- 0.172 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.9 all L1 = 0.761 +- 0.189 (in-sample avg dev_std = 0.303)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.71
Model XAI F1 of binarized graphs for r=0.95 =  0.57151375
Model XAI WIoU of binarized graphs for r=0.95 =  0.41453249999999997
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.67
SUFF++ for r=0.95 class 0 = 0.8 +- 0.084 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.95 class 1 = 0.941 +- 0.084 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.95 class 2 = 0.87 +- 0.084 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.95 all KL = 0.937 +- 0.084 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.95 all L1 = 0.869 +- 0.114 (in-sample avg dev_std = 0.229)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 13:23:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 01:23:21 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 01:23:35 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 01:23:38 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 01:23:40 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 01:23:42 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 01:23:44 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 01:23:44 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 01:23:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:23:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:23:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:23:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:23:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:23:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:23:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:23:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))

Gold ratio (id_test) =  tensor(0.3175) +- tensor(0.1645)
F1 for r=0.3 = 0.726
WIoU for r=0.3 = 0.603
F1 for r=0.4 = 0.722
WIoU for r=0.4 = 0.613
F1 for r=0.6 = 0.627
WIoU for r=0.6 = 0.511
F1 for r=0.9 = 0.488
WIoU for r=0.9 = 0.366
F1 for r=0.95 = 0.471
WIoU for r=0.95 = 0.350
F1 for r=1.0 = 0.459
WIoU for r=1.0 = 0.340
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.361
WIoU for r=0.3 = 0.265
F1 for r=0.4 = 0.495
WIoU for r=0.4 = 0.384
F1 for r=0.6 = 0.628
WIoU for r=0.6 = 0.491
F1 for r=0.9 = 0.590
WIoU for r=0.9 = 0.432
F1 for r=0.95 = 0.572
WIoU for r=0.95 = 0.415
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.402


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.486
Model XAI F1 of binarized graphs for r=0.3 =  0.7257275
Model XAI WIoU of binarized graphs for r=0.3 =  0.60288
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.317
NEC for r=0.3 class 0 = 0.626 +- 0.268 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 1 = 0.505 +- 0.268 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 2 = 0.58 +- 0.268 (in-sample avg dev_std = 0.413)
NEC for r=0.3 all KL = 0.547 +- 0.268 (in-sample avg dev_std = 0.413)
NEC for r=0.3 all L1 = 0.57 +- 0.148 (in-sample avg dev_std = 0.413)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.55
Model XAI F1 of binarized graphs for r=0.4 =  0.7221175
Model XAI WIoU of binarized graphs for r=0.4 =  0.6131237500000001
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.342
NEC for r=0.4 class 0 = 0.639 +- 0.283 (in-sample avg dev_std = 0.435)
NEC for r=0.4 class 1 = 0.529 +- 0.283 (in-sample avg dev_std = 0.435)
NEC for r=0.4 class 2 = 0.613 +- 0.283 (in-sample avg dev_std = 0.435)
NEC for r=0.4 all KL = 0.6 +- 0.283 (in-sample avg dev_std = 0.435)
NEC for r=0.4 all L1 = 0.593 +- 0.148 (in-sample avg dev_std = 0.435)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  0.6266025
Model XAI WIoU of binarized graphs for r=0.6 =  0.51065125
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.381
NEC for r=0.6 class 0 = 0.622 +- 0.269 (in-sample avg dev_std = 0.486)
NEC for r=0.6 class 1 = 0.536 +- 0.269 (in-sample avg dev_std = 0.486)
NEC for r=0.6 class 2 = 0.608 +- 0.269 (in-sample avg dev_std = 0.486)
NEC for r=0.6 all KL = 0.621 +- 0.269 (in-sample avg dev_std = 0.486)
NEC for r=0.6 all L1 = 0.588 +- 0.160 (in-sample avg dev_std = 0.486)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.889
Model XAI F1 of binarized graphs for r=0.9 =  0.48840500000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.36611875
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.495
NEC for r=0.9 class 0 = 0.62 +- 0.237 (in-sample avg dev_std = 0.566)
NEC for r=0.9 class 1 = 0.496 +- 0.237 (in-sample avg dev_std = 0.566)
NEC for r=0.9 class 2 = 0.558 +- 0.237 (in-sample avg dev_std = 0.566)
NEC for r=0.9 all KL = 0.593 +- 0.237 (in-sample avg dev_std = 0.566)
NEC for r=0.9 all L1 = 0.558 +- 0.162 (in-sample avg dev_std = 0.566)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.916
Model XAI F1 of binarized graphs for r=0.95 =  0.470975
Model XAI WIoU of binarized graphs for r=0.95 =  0.35005875000000003
len(reference) = 800
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.525
NEC for r=0.95 class 0 = 0.595 +- 0.232 (in-sample avg dev_std = 0.597)
NEC for r=0.95 class 1 = 0.469 +- 0.232 (in-sample avg dev_std = 0.597)
NEC for r=0.95 class 2 = 0.557 +- 0.232 (in-sample avg dev_std = 0.597)
NEC for r=0.95 all KL = 0.581 +- 0.232 (in-sample avg dev_std = 0.597)
NEC for r=0.95 all L1 = 0.54 +- 0.166 (in-sample avg dev_std = 0.597)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  0.45948124999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.3402125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.537
NEC for r=1.0 class 0 = 0.563 +- 0.239 (in-sample avg dev_std = 0.601)
NEC for r=1.0 class 1 = 0.447 +- 0.239 (in-sample avg dev_std = 0.601)
NEC for r=1.0 class 2 = 0.573 +- 0.239 (in-sample avg dev_std = 0.601)
NEC for r=1.0 all KL = 0.562 +- 0.239 (in-sample avg dev_std = 0.601)
NEC for r=1.0 all L1 = 0.527 +- 0.173 (in-sample avg dev_std = 0.601)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.28
Model XAI F1 of binarized graphs for r=0.3 =  0.36146124999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.2646225
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.323
NEC for r=0.3 class 0 = 0.576 +- 0.239 (in-sample avg dev_std = 0.355)
NEC for r=0.3 class 1 = 0.525 +- 0.239 (in-sample avg dev_std = 0.355)
NEC for r=0.3 class 2 = 0.542 +- 0.239 (in-sample avg dev_std = 0.355)
NEC for r=0.3 all KL = 0.464 +- 0.239 (in-sample avg dev_std = 0.355)
NEC for r=0.3 all L1 = 0.548 +- 0.153 (in-sample avg dev_std = 0.355)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.262
Model XAI F1 of binarized graphs for r=0.4 =  0.49520250000000005
Model XAI WIoU of binarized graphs for r=0.4 =  0.3836175
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.394
NEC for r=0.4 class 0 = 0.554 +- 0.233 (in-sample avg dev_std = 0.428)
NEC for r=0.4 class 1 = 0.598 +- 0.233 (in-sample avg dev_std = 0.428)
NEC for r=0.4 class 2 = 0.584 +- 0.233 (in-sample avg dev_std = 0.428)
NEC for r=0.4 all KL = 0.53 +- 0.233 (in-sample avg dev_std = 0.428)
NEC for r=0.4 all L1 = 0.578 +- 0.136 (in-sample avg dev_std = 0.428)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.635
Model XAI F1 of binarized graphs for r=0.6 =  0.62756625
Model XAI WIoU of binarized graphs for r=0.6 =  0.49079625
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.477
NEC for r=0.6 class 0 = 0.545 +- 0.292 (in-sample avg dev_std = 0.552)
NEC for r=0.6 class 1 = 0.343 +- 0.292 (in-sample avg dev_std = 0.552)
NEC for r=0.6 class 2 = 0.622 +- 0.292 (in-sample avg dev_std = 0.552)
NEC for r=0.6 all KL = 0.555 +- 0.292 (in-sample avg dev_std = 0.552)
NEC for r=0.6 all L1 = 0.506 +- 0.206 (in-sample avg dev_std = 0.552)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.663
Model XAI F1 of binarized graphs for r=0.9 =  0.5903499999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.43229999999999996
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.555
NEC for r=0.9 class 0 = 0.479 +- 0.241 (in-sample avg dev_std = 0.457)
NEC for r=0.9 class 1 = 0.204 +- 0.241 (in-sample avg dev_std = 0.457)
NEC for r=0.9 class 2 = 0.52 +- 0.241 (in-sample avg dev_std = 0.457)
NEC for r=0.9 all KL = 0.359 +- 0.241 (in-sample avg dev_std = 0.457)
NEC for r=0.9 all L1 = 0.404 +- 0.204 (in-sample avg dev_std = 0.457)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.639
Model XAI F1 of binarized graphs for r=0.95 =  0.57168875
Model XAI WIoU of binarized graphs for r=0.95 =  0.415185
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.556
NEC for r=0.95 class 0 = 0.43 +- 0.220 (in-sample avg dev_std = 0.420)
NEC for r=0.95 class 1 = 0.174 +- 0.220 (in-sample avg dev_std = 0.420)
NEC for r=0.95 class 2 = 0.491 +- 0.220 (in-sample avg dev_std = 0.420)
NEC for r=0.95 all KL = 0.305 +- 0.220 (in-sample avg dev_std = 0.420)
NEC for r=0.95 all L1 = 0.368 +- 0.192 (in-sample avg dev_std = 0.420)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.586
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.4020425
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.536
NEC for r=1.0 class 0 = 0.407 +- 0.230 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 1 = 0.149 +- 0.230 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 2 = 0.49 +- 0.230 (in-sample avg dev_std = 0.425)
NEC for r=1.0 all KL = 0.3 +- 0.230 (in-sample avg dev_std = 0.425)
NEC for r=1.0 all L1 = 0.352 +- 0.208 (in-sample avg dev_std = 0.425)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.486
Model XAI F1 of binarized graphs for r=0.3 =  0.7257275
Model XAI WIoU of binarized graphs for r=0.3 =  0.60288
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.441
SUFF++ for r=0.3 class 0 = 0.425 +- 0.256 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.3 class 1 = 0.516 +- 0.256 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.3 class 2 = 0.554 +- 0.256 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.3 all KL = 0.524 +- 0.256 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.3 all L1 = 0.498 +- 0.151 (in-sample avg dev_std = 0.474)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.551
Model XAI F1 of binarized graphs for r=0.4 =  0.7221175
Model XAI WIoU of binarized graphs for r=0.4 =  0.6131237500000001
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.479
SUFF++ for r=0.4 class 0 = 0.437 +- 0.287 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.4 class 1 = 0.541 +- 0.287 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.4 class 2 = 0.598 +- 0.287 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.4 all KL = 0.521 +- 0.287 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.4 all L1 = 0.524 +- 0.165 (in-sample avg dev_std = 0.486)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  0.6266025
Model XAI WIoU of binarized graphs for r=0.6 =  0.51065125
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.651
SUFF++ for r=0.6 class 0 = 0.469 +- 0.270 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 1 = 0.677 +- 0.270 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 2 = 0.688 +- 0.270 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all KL = 0.622 +- 0.270 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all L1 = 0.61 +- 0.200 (in-sample avg dev_std = 0.458)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.892
Model XAI F1 of binarized graphs for r=0.9 =  0.48840500000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.36611875
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.855
SUFF++ for r=0.9 class 0 = 0.682 +- 0.169 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 class 1 = 0.827 +- 0.169 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 class 2 = 0.88 +- 0.169 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 all KL = 0.864 +- 0.169 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.9 all L1 = 0.795 +- 0.164 (in-sample avg dev_std = 0.240)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.917
Model XAI F1 of binarized graphs for r=0.95 =  0.470975
Model XAI WIoU of binarized graphs for r=0.95 =  0.35005875000000003
len(reference) = 719
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.893
SUFF++ for r=0.95 class 0 = 0.818 +- 0.102 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.95 class 1 = 0.905 +- 0.102 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.95 class 2 = 0.904 +- 0.102 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.95 all KL = 0.932 +- 0.102 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.95 all L1 = 0.875 +- 0.111 (in-sample avg dev_std = 0.192)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.282
Model XAI F1 of binarized graphs for r=0.3 =  0.36146124999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.2646225
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.31
SUFF++ for r=0.3 class 0 = 0.523 +- 0.179 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 1 = 0.508 +- 0.179 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 2 = 0.534 +- 0.179 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 all KL = 0.618 +- 0.179 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 all L1 = 0.522 +- 0.110 (in-sample avg dev_std = 0.454)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.261
Model XAI F1 of binarized graphs for r=0.4 =  0.49520250000000005
Model XAI WIoU of binarized graphs for r=0.4 =  0.3836175
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.319
SUFF++ for r=0.4 class 0 = 0.549 +- 0.228 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.4 class 1 = 0.486 +- 0.228 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.4 class 2 = 0.519 +- 0.228 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.4 all KL = 0.585 +- 0.228 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.4 all L1 = 0.519 +- 0.140 (in-sample avg dev_std = 0.473)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.635
Model XAI F1 of binarized graphs for r=0.6 =  0.62756625
Model XAI WIoU of binarized graphs for r=0.6 =  0.49079625
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.613
SUFF++ for r=0.6 class 0 = 0.686 +- 0.224 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 class 1 = 0.772 +- 0.224 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 class 2 = 0.778 +- 0.224 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 all KL = 0.774 +- 0.224 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 all L1 = 0.745 +- 0.186 (in-sample avg dev_std = 0.386)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.663
Model XAI F1 of binarized graphs for r=0.9 =  0.5903499999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.43229999999999996
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.644
SUFF++ for r=0.9 class 0 = 0.74 +- 0.106 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 class 1 = 0.96 +- 0.106 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 class 2 = 0.786 +- 0.106 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 all KL = 0.92 +- 0.106 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 all L1 = 0.826 +- 0.160 (in-sample avg dev_std = 0.184)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.639
Model XAI F1 of binarized graphs for r=0.95 =  0.57168875
Model XAI WIoU of binarized graphs for r=0.95 =  0.415185
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.605
SUFF++ for r=0.95 class 0 = 0.89 +- 0.051 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.95 class 1 = 0.981 +- 0.051 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.95 class 2 = 0.899 +- 0.051 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.95 all KL = 0.975 +- 0.051 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.95 all L1 = 0.922 +- 0.082 (in-sample avg dev_std = 0.139)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 13:27:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 01:27:35 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 01:27:48 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 01:27:50 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 01:27:52 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 01:27:53 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 01:27:55 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 01:27:55 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 01:27:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:27:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:27:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:27:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:27:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:27:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:27:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:27:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))

Gold ratio (id_test) =  tensor(0.3175) +- tensor(0.1645)
F1 for r=0.3 = 0.720
WIoU for r=0.3 = 0.595
F1 for r=0.4 = 0.716
WIoU for r=0.4 = 0.603
F1 for r=0.6 = 0.628
WIoU for r=0.6 = 0.509
F1 for r=0.9 = 0.487
WIoU for r=0.9 = 0.362
F1 for r=0.95 = 0.470
WIoU for r=0.95 = 0.346
F1 for r=1.0 = 0.459
WIoU for r=1.0 = 0.337
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.409
WIoU for r=0.3 = 0.308
F1 for r=0.4 = 0.531
WIoU for r=0.4 = 0.420
F1 for r=0.6 = 0.616
WIoU for r=0.6 = 0.484
F1 for r=0.9 = 0.575
WIoU for r=0.9 = 0.419
F1 for r=0.95 = 0.566
WIoU for r=0.95 = 0.409
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.400


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.506
Model XAI F1 of binarized graphs for r=0.3 =  0.7195550000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.594645
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.376
NEC for r=0.3 class 0 = 0.633 +- 0.265 (in-sample avg dev_std = 0.423)
NEC for r=0.3 class 1 = 0.52 +- 0.265 (in-sample avg dev_std = 0.423)
NEC for r=0.3 class 2 = 0.593 +- 0.265 (in-sample avg dev_std = 0.423)
NEC for r=0.3 all KL = 0.572 +- 0.265 (in-sample avg dev_std = 0.423)
NEC for r=0.3 all L1 = 0.582 +- 0.152 (in-sample avg dev_std = 0.423)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.53
Model XAI F1 of binarized graphs for r=0.4 =  0.7158850000000001
Model XAI WIoU of binarized graphs for r=0.4 =  0.60311125
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.386
NEC for r=0.4 class 0 = 0.617 +- 0.281 (in-sample avg dev_std = 0.448)
NEC for r=0.4 class 1 = 0.497 +- 0.281 (in-sample avg dev_std = 0.448)
NEC for r=0.4 class 2 = 0.643 +- 0.281 (in-sample avg dev_std = 0.448)
NEC for r=0.4 all KL = 0.579 +- 0.281 (in-sample avg dev_std = 0.448)
NEC for r=0.4 all L1 = 0.584 +- 0.157 (in-sample avg dev_std = 0.448)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.716
Model XAI F1 of binarized graphs for r=0.6 =  0.62801125
Model XAI WIoU of binarized graphs for r=0.6 =  0.5089837500000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.398
NEC for r=0.6 class 0 = 0.567 +- 0.284 (in-sample avg dev_std = 0.480)
NEC for r=0.6 class 1 = 0.503 +- 0.284 (in-sample avg dev_std = 0.480)
NEC for r=0.6 class 2 = 0.636 +- 0.284 (in-sample avg dev_std = 0.480)
NEC for r=0.6 all KL = 0.613 +- 0.284 (in-sample avg dev_std = 0.480)
NEC for r=0.6 all L1 = 0.568 +- 0.185 (in-sample avg dev_std = 0.480)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.48748
Model XAI WIoU of binarized graphs for r=0.9 =  0.36187250000000004
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.505
NEC for r=0.9 class 0 = 0.631 +- 0.229 (in-sample avg dev_std = 0.580)
NEC for r=0.9 class 1 = 0.485 +- 0.229 (in-sample avg dev_std = 0.580)
NEC for r=0.9 class 2 = 0.562 +- 0.229 (in-sample avg dev_std = 0.580)
NEC for r=0.9 all KL = 0.613 +- 0.229 (in-sample avg dev_std = 0.580)
NEC for r=0.9 all L1 = 0.559 +- 0.160 (in-sample avg dev_std = 0.580)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.919
Model XAI F1 of binarized graphs for r=0.95 =  0.47026
Model XAI WIoU of binarized graphs for r=0.95 =  0.34586625
len(reference) = 800
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.529
NEC for r=0.95 class 0 = 0.603 +- 0.225 (in-sample avg dev_std = 0.600)
NEC for r=0.95 class 1 = 0.474 +- 0.225 (in-sample avg dev_std = 0.600)
NEC for r=0.95 class 2 = 0.558 +- 0.225 (in-sample avg dev_std = 0.600)
NEC for r=0.95 all KL = 0.599 +- 0.225 (in-sample avg dev_std = 0.600)
NEC for r=0.95 all L1 = 0.545 +- 0.164 (in-sample avg dev_std = 0.600)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  0.45948124999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.33657875000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.548
NEC for r=1.0 class 0 = 0.586 +- 0.235 (in-sample avg dev_std = 0.623)
NEC for r=1.0 class 1 = 0.429 +- 0.235 (in-sample avg dev_std = 0.623)
NEC for r=1.0 class 2 = 0.58 +- 0.235 (in-sample avg dev_std = 0.623)
NEC for r=1.0 all KL = 0.585 +- 0.235 (in-sample avg dev_std = 0.623)
NEC for r=1.0 all L1 = 0.531 +- 0.175 (in-sample avg dev_std = 0.623)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.262
Model XAI F1 of binarized graphs for r=0.3 =  0.40918
Model XAI WIoU of binarized graphs for r=0.3 =  0.30753875
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.249
NEC for r=0.3 class 0 = 0.585 +- 0.240 (in-sample avg dev_std = 0.360)
NEC for r=0.3 class 1 = 0.521 +- 0.240 (in-sample avg dev_std = 0.360)
NEC for r=0.3 class 2 = 0.517 +- 0.240 (in-sample avg dev_std = 0.360)
NEC for r=0.3 all KL = 0.45 +- 0.240 (in-sample avg dev_std = 0.360)
NEC for r=0.3 all L1 = 0.541 +- 0.156 (in-sample avg dev_std = 0.360)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.236
Model XAI F1 of binarized graphs for r=0.4 =  0.53136875
Model XAI WIoU of binarized graphs for r=0.4 =  0.42021125
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.395
NEC for r=0.4 class 0 = 0.605 +- 0.234 (in-sample avg dev_std = 0.414)
NEC for r=0.4 class 1 = 0.597 +- 0.234 (in-sample avg dev_std = 0.414)
NEC for r=0.4 class 2 = 0.592 +- 0.234 (in-sample avg dev_std = 0.414)
NEC for r=0.4 all KL = 0.555 +- 0.234 (in-sample avg dev_std = 0.414)
NEC for r=0.4 all L1 = 0.598 +- 0.125 (in-sample avg dev_std = 0.414)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.631
Model XAI F1 of binarized graphs for r=0.6 =  0.6161475
Model XAI WIoU of binarized graphs for r=0.6 =  0.48357500000000003
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.495
NEC for r=0.6 class 0 = 0.573 +- 0.273 (in-sample avg dev_std = 0.570)
NEC for r=0.6 class 1 = 0.437 +- 0.273 (in-sample avg dev_std = 0.570)
NEC for r=0.6 class 2 = 0.603 +- 0.273 (in-sample avg dev_std = 0.570)
NEC for r=0.6 all KL = 0.573 +- 0.273 (in-sample avg dev_std = 0.570)
NEC for r=0.6 all L1 = 0.539 +- 0.175 (in-sample avg dev_std = 0.570)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.668
Model XAI F1 of binarized graphs for r=0.9 =  0.57488375
Model XAI WIoU of binarized graphs for r=0.9 =  0.418655
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.561
NEC for r=0.9 class 0 = 0.473 +- 0.242 (in-sample avg dev_std = 0.464)
NEC for r=0.9 class 1 = 0.226 +- 0.242 (in-sample avg dev_std = 0.464)
NEC for r=0.9 class 2 = 0.517 +- 0.242 (in-sample avg dev_std = 0.464)
NEC for r=0.9 all KL = 0.387 +- 0.242 (in-sample avg dev_std = 0.464)
NEC for r=0.9 all L1 = 0.409 +- 0.197 (in-sample avg dev_std = 0.464)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.65
Model XAI F1 of binarized graphs for r=0.95 =  0.56614875
Model XAI WIoU of binarized graphs for r=0.95 =  0.40893124999999997
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.577
NEC for r=0.95 class 0 = 0.429 +- 0.214 (in-sample avg dev_std = 0.416)
NEC for r=0.95 class 1 = 0.176 +- 0.214 (in-sample avg dev_std = 0.416)
NEC for r=0.95 class 2 = 0.48 +- 0.214 (in-sample avg dev_std = 0.416)
NEC for r=0.95 all KL = 0.312 +- 0.214 (in-sample avg dev_std = 0.416)
NEC for r=0.95 all L1 = 0.365 +- 0.191 (in-sample avg dev_std = 0.416)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.582
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.3998625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.536
NEC for r=1.0 class 0 = 0.384 +- 0.228 (in-sample avg dev_std = 0.416)
NEC for r=1.0 class 1 = 0.147 +- 0.228 (in-sample avg dev_std = 0.416)
NEC for r=1.0 class 2 = 0.492 +- 0.228 (in-sample avg dev_std = 0.416)
NEC for r=1.0 all KL = 0.3 +- 0.228 (in-sample avg dev_std = 0.416)
NEC for r=1.0 all L1 = 0.345 +- 0.207 (in-sample avg dev_std = 0.416)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.506
Model XAI F1 of binarized graphs for r=0.3 =  0.7195550000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.594645
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.465
SUFF++ for r=0.3 class 0 = 0.431 +- 0.255 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 class 1 = 0.52 +- 0.255 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 class 2 = 0.526 +- 0.255 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 all KL = 0.497 +- 0.255 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 all L1 = 0.492 +- 0.145 (in-sample avg dev_std = 0.511)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.533
Model XAI F1 of binarized graphs for r=0.4 =  0.7158850000000001
Model XAI WIoU of binarized graphs for r=0.4 =  0.60311125
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.486
SUFF++ for r=0.4 class 0 = 0.439 +- 0.260 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.4 class 1 = 0.549 +- 0.260 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.4 class 2 = 0.548 +- 0.260 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.4 all KL = 0.521 +- 0.260 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.4 all L1 = 0.512 +- 0.155 (in-sample avg dev_std = 0.486)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.717
Model XAI F1 of binarized graphs for r=0.6 =  0.62801125
Model XAI WIoU of binarized graphs for r=0.6 =  0.5089837500000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.642
SUFF++ for r=0.6 class 0 = 0.483 +- 0.270 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 1 = 0.632 +- 0.270 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 2 = 0.66 +- 0.270 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 all KL = 0.579 +- 0.270 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 all L1 = 0.591 +- 0.191 (in-sample avg dev_std = 0.476)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  0.48748
Model XAI WIoU of binarized graphs for r=0.9 =  0.36187250000000004
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.865
SUFF++ for r=0.9 class 0 = 0.714 +- 0.168 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 1 = 0.84 +- 0.168 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 2 = 0.866 +- 0.168 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all KL = 0.866 +- 0.168 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all L1 = 0.806 +- 0.152 (in-sample avg dev_std = 0.256)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.921
Model XAI F1 of binarized graphs for r=0.95 =  0.47026
Model XAI WIoU of binarized graphs for r=0.95 =  0.34586625
len(reference) = 719
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.908
SUFF++ for r=0.95 class 0 = 0.833 +- 0.109 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.95 class 1 = 0.904 +- 0.109 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.95 class 2 = 0.888 +- 0.109 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.95 all KL = 0.928 +- 0.109 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.95 all L1 = 0.875 +- 0.114 (in-sample avg dev_std = 0.188)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.264
Model XAI F1 of binarized graphs for r=0.3 =  0.40918
Model XAI WIoU of binarized graphs for r=0.3 =  0.30753875
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.297
SUFF++ for r=0.3 class 0 = 0.492 +- 0.197 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 1 = 0.512 +- 0.197 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 class 2 = 0.505 +- 0.197 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 all KL = 0.601 +- 0.197 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.3 all L1 = 0.503 +- 0.110 (in-sample avg dev_std = 0.441)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.233
Model XAI F1 of binarized graphs for r=0.4 =  0.53136875
Model XAI WIoU of binarized graphs for r=0.4 =  0.42021125
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.298
SUFF++ for r=0.4 class 0 = 0.518 +- 0.236 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.4 class 1 = 0.473 +- 0.236 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.4 class 2 = 0.489 +- 0.236 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.4 all KL = 0.555 +- 0.236 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.4 all L1 = 0.494 +- 0.120 (in-sample avg dev_std = 0.471)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.631
Model XAI F1 of binarized graphs for r=0.6 =  0.6161475
Model XAI WIoU of binarized graphs for r=0.6 =  0.48357500000000003
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.615
SUFF++ for r=0.6 class 0 = 0.622 +- 0.228 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.6 class 1 = 0.705 +- 0.228 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.6 class 2 = 0.73 +- 0.228 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.6 all KL = 0.721 +- 0.228 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.6 all L1 = 0.685 +- 0.184 (in-sample avg dev_std = 0.420)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.668
Model XAI F1 of binarized graphs for r=0.9 =  0.57488375
Model XAI WIoU of binarized graphs for r=0.9 =  0.418655
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.656
SUFF++ for r=0.9 class 0 = 0.729 +- 0.129 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 class 1 = 0.946 +- 0.129 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 class 2 = 0.746 +- 0.129 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 all KL = 0.893 +- 0.129 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 all L1 = 0.804 +- 0.161 (in-sample avg dev_std = 0.215)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.65
Model XAI F1 of binarized graphs for r=0.95 =  0.56614875
Model XAI WIoU of binarized graphs for r=0.95 =  0.40893124999999997
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.618
SUFF++ for r=0.95 class 0 = 0.857 +- 0.082 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.95 class 1 = 0.973 +- 0.082 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.95 class 2 = 0.86 +- 0.082 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.95 all KL = 0.949 +- 0.082 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.95 all L1 = 0.895 +- 0.104 (in-sample avg dev_std = 0.182)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 13:31:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 01:31:25 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 01:31:37 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 01:31:40 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 01:31:43 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 01:31:45 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 01:31:46 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 01:31:46 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 01:31:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:31:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:31:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:31:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:31:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:31:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:31:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:31:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))

Gold ratio (id_test) =  tensor(0.3175) +- tensor(0.1645)
F1 for r=0.3 = 0.716
WIoU for r=0.3 = 0.592
F1 for r=0.4 = 0.710
WIoU for r=0.4 = 0.602
F1 for r=0.6 = 0.614
WIoU for r=0.6 = 0.496
F1 for r=0.9 = 0.482
WIoU for r=0.9 = 0.356
F1 for r=0.95 = 0.468
WIoU for r=0.95 = 0.343
F1 for r=1.0 = 0.459
WIoU for r=1.0 = 0.335
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.357
WIoU for r=0.3 = 0.258
F1 for r=0.4 = 0.472
WIoU for r=0.4 = 0.361
F1 for r=0.6 = 0.596
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.587
WIoU for r=0.9 = 0.425
F1 for r=0.95 = 0.570
WIoU for r=0.95 = 0.410
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.398


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.516
Model XAI F1 of binarized graphs for r=0.3 =  0.7155087499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5917749999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.317
NEC for r=0.3 class 0 = 0.598 +- 0.274 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 1 = 0.535 +- 0.274 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 2 = 0.606 +- 0.274 (in-sample avg dev_std = 0.413)
NEC for r=0.3 all KL = 0.569 +- 0.274 (in-sample avg dev_std = 0.413)
NEC for r=0.3 all L1 = 0.579 +- 0.144 (in-sample avg dev_std = 0.413)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.546
Model XAI F1 of binarized graphs for r=0.4 =  0.7101875
Model XAI WIoU of binarized graphs for r=0.4 =  0.60177
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.362
NEC for r=0.4 class 0 = 0.588 +- 0.280 (in-sample avg dev_std = 0.460)
NEC for r=0.4 class 1 = 0.562 +- 0.280 (in-sample avg dev_std = 0.460)
NEC for r=0.4 class 2 = 0.616 +- 0.280 (in-sample avg dev_std = 0.460)
NEC for r=0.4 all KL = 0.594 +- 0.280 (in-sample avg dev_std = 0.460)
NEC for r=0.4 all L1 = 0.588 +- 0.154 (in-sample avg dev_std = 0.460)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.659
Model XAI F1 of binarized graphs for r=0.6 =  0.61364125
Model XAI WIoU of binarized graphs for r=0.6 =  0.49643750000000003
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.372
NEC for r=0.6 class 0 = 0.558 +- 0.282 (in-sample avg dev_std = 0.476)
NEC for r=0.6 class 1 = 0.541 +- 0.282 (in-sample avg dev_std = 0.476)
NEC for r=0.6 class 2 = 0.628 +- 0.282 (in-sample avg dev_std = 0.476)
NEC for r=0.6 all KL = 0.625 +- 0.282 (in-sample avg dev_std = 0.476)
NEC for r=0.6 all L1 = 0.574 +- 0.178 (in-sample avg dev_std = 0.476)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.48183875
Model XAI WIoU of binarized graphs for r=0.9 =  0.35616249999999994
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.5
NEC for r=0.9 class 0 = 0.586 +- 0.214 (in-sample avg dev_std = 0.603)
NEC for r=0.9 class 1 = 0.511 +- 0.214 (in-sample avg dev_std = 0.603)
NEC for r=0.9 class 2 = 0.585 +- 0.214 (in-sample avg dev_std = 0.603)
NEC for r=0.9 all KL = 0.628 +- 0.214 (in-sample avg dev_std = 0.603)
NEC for r=0.9 all L1 = 0.56 +- 0.160 (in-sample avg dev_std = 0.603)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.926
Model XAI F1 of binarized graphs for r=0.95 =  0.46777874999999997
Model XAI WIoU of binarized graphs for r=0.95 =  0.34297000000000005
len(reference) = 800
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.528
NEC for r=0.95 class 0 = 0.575 +- 0.223 (in-sample avg dev_std = 0.625)
NEC for r=0.95 class 1 = 0.477 +- 0.223 (in-sample avg dev_std = 0.625)
NEC for r=0.95 class 2 = 0.56 +- 0.223 (in-sample avg dev_std = 0.625)
NEC for r=0.95 all KL = 0.607 +- 0.223 (in-sample avg dev_std = 0.625)
NEC for r=0.95 all L1 = 0.537 +- 0.169 (in-sample avg dev_std = 0.625)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  0.45948124999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.335305
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.536
NEC for r=1.0 class 0 = 0.553 +- 0.217 (in-sample avg dev_std = 0.645)
NEC for r=1.0 class 1 = 0.461 +- 0.217 (in-sample avg dev_std = 0.645)
NEC for r=1.0 class 2 = 0.586 +- 0.217 (in-sample avg dev_std = 0.645)
NEC for r=1.0 all KL = 0.602 +- 0.217 (in-sample avg dev_std = 0.645)
NEC for r=1.0 all L1 = 0.532 +- 0.167 (in-sample avg dev_std = 0.645)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.177
Model XAI F1 of binarized graphs for r=0.3 =  0.3568325
Model XAI WIoU of binarized graphs for r=0.3 =  0.25753875
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.298
NEC for r=0.3 class 0 = 0.56 +- 0.231 (in-sample avg dev_std = 0.349)
NEC for r=0.3 class 1 = 0.501 +- 0.231 (in-sample avg dev_std = 0.349)
NEC for r=0.3 class 2 = 0.527 +- 0.231 (in-sample avg dev_std = 0.349)
NEC for r=0.3 all KL = 0.434 +- 0.231 (in-sample avg dev_std = 0.349)
NEC for r=0.3 all L1 = 0.53 +- 0.152 (in-sample avg dev_std = 0.349)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.255
Model XAI F1 of binarized graphs for r=0.4 =  0.47194375
Model XAI WIoU of binarized graphs for r=0.4 =  0.36109749999999996
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.382
NEC for r=0.4 class 0 = 0.56 +- 0.230 (in-sample avg dev_std = 0.401)
NEC for r=0.4 class 1 = 0.602 +- 0.230 (in-sample avg dev_std = 0.401)
NEC for r=0.4 class 2 = 0.583 +- 0.230 (in-sample avg dev_std = 0.401)
NEC for r=0.4 all KL = 0.506 +- 0.230 (in-sample avg dev_std = 0.401)
NEC for r=0.4 all L1 = 0.581 +- 0.136 (in-sample avg dev_std = 0.401)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.58
Model XAI F1 of binarized graphs for r=0.6 =  0.596425
Model XAI WIoU of binarized graphs for r=0.6 =  0.45335875000000003
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.486
NEC for r=0.6 class 0 = 0.564 +- 0.270 (in-sample avg dev_std = 0.512)
NEC for r=0.6 class 1 = 0.452 +- 0.270 (in-sample avg dev_std = 0.512)
NEC for r=0.6 class 2 = 0.632 +- 0.270 (in-sample avg dev_std = 0.512)
NEC for r=0.6 all KL = 0.553 +- 0.270 (in-sample avg dev_std = 0.512)
NEC for r=0.6 all L1 = 0.551 +- 0.169 (in-sample avg dev_std = 0.512)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.671
Model XAI F1 of binarized graphs for r=0.9 =  0.58662625
Model XAI WIoU of binarized graphs for r=0.9 =  0.42531874999999997
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.574
NEC for r=0.9 class 0 = 0.478 +- 0.223 (in-sample avg dev_std = 0.456)
NEC for r=0.9 class 1 = 0.266 +- 0.223 (in-sample avg dev_std = 0.456)
NEC for r=0.9 class 2 = 0.501 +- 0.223 (in-sample avg dev_std = 0.456)
NEC for r=0.9 all KL = 0.361 +- 0.223 (in-sample avg dev_std = 0.456)
NEC for r=0.9 all L1 = 0.417 +- 0.174 (in-sample avg dev_std = 0.456)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.614
Model XAI F1 of binarized graphs for r=0.95 =  0.57028
Model XAI WIoU of binarized graphs for r=0.95 =  0.40991625
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.554
NEC for r=0.95 class 0 = 0.439 +- 0.199 (in-sample avg dev_std = 0.412)
NEC for r=0.95 class 1 = 0.22 +- 0.199 (in-sample avg dev_std = 0.412)
NEC for r=0.95 class 2 = 0.47 +- 0.199 (in-sample avg dev_std = 0.412)
NEC for r=0.95 all KL = 0.303 +- 0.199 (in-sample avg dev_std = 0.412)
NEC for r=0.95 all L1 = 0.379 +- 0.178 (in-sample avg dev_std = 0.412)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.521
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.39820125000000006
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.532
NEC for r=1.0 class 0 = 0.415 +- 0.219 (in-sample avg dev_std = 0.441)
NEC for r=1.0 class 1 = 0.176 +- 0.219 (in-sample avg dev_std = 0.441)
NEC for r=1.0 class 2 = 0.473 +- 0.219 (in-sample avg dev_std = 0.441)
NEC for r=1.0 all KL = 0.317 +- 0.219 (in-sample avg dev_std = 0.441)
NEC for r=1.0 all L1 = 0.358 +- 0.196 (in-sample avg dev_std = 0.441)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.519
Model XAI F1 of binarized graphs for r=0.3 =  0.7155087499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5917749999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.446
SUFF++ for r=0.3 class 0 = 0.446 +- 0.266 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 class 1 = 0.511 +- 0.266 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 class 2 = 0.561 +- 0.266 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 all KL = 0.514 +- 0.266 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 all L1 = 0.505 +- 0.147 (in-sample avg dev_std = 0.487)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.545
Model XAI F1 of binarized graphs for r=0.4 =  0.7101875
Model XAI WIoU of binarized graphs for r=0.4 =  0.60177
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.493
SUFF++ for r=0.4 class 0 = 0.44 +- 0.289 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.4 class 1 = 0.533 +- 0.289 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.4 class 2 = 0.589 +- 0.289 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.4 all KL = 0.52 +- 0.289 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.4 all L1 = 0.52 +- 0.167 (in-sample avg dev_std = 0.494)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.659
Model XAI F1 of binarized graphs for r=0.6 =  0.61364125
Model XAI WIoU of binarized graphs for r=0.6 =  0.49643750000000003
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.668
SUFF++ for r=0.6 class 0 = 0.487 +- 0.292 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 1 = 0.697 +- 0.292 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 2 = 0.628 +- 0.292 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 all KL = 0.603 +- 0.292 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 all L1 = 0.604 +- 0.211 (in-sample avg dev_std = 0.451)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.48183875
Model XAI WIoU of binarized graphs for r=0.9 =  0.35616249999999994
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.869
SUFF++ for r=0.9 class 0 = 0.706 +- 0.165 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 1 = 0.858 +- 0.165 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 2 = 0.827 +- 0.165 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all KL = 0.862 +- 0.165 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all L1 = 0.797 +- 0.153 (in-sample avg dev_std = 0.252)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.928
Model XAI F1 of binarized graphs for r=0.95 =  0.46777874999999997
Model XAI WIoU of binarized graphs for r=0.95 =  0.34297000000000005
len(reference) = 719
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.891
SUFF++ for r=0.95 class 0 = 0.812 +- 0.139 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.95 class 1 = 0.928 +- 0.139 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.95 class 2 = 0.859 +- 0.139 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.95 all KL = 0.916 +- 0.139 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.95 all L1 = 0.866 +- 0.128 (in-sample avg dev_std = 0.234)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.176
Model XAI F1 of binarized graphs for r=0.3 =  0.3568325
Model XAI WIoU of binarized graphs for r=0.3 =  0.25753875
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.287
SUFF++ for r=0.3 class 0 = 0.497 +- 0.182 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 1 = 0.531 +- 0.182 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 2 = 0.535 +- 0.182 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 all KL = 0.629 +- 0.182 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 all L1 = 0.521 +- 0.110 (in-sample avg dev_std = 0.438)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.255
Model XAI F1 of binarized graphs for r=0.4 =  0.47194375
Model XAI WIoU of binarized graphs for r=0.4 =  0.36109749999999996
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.293
SUFF++ for r=0.4 class 0 = 0.481 +- 0.207 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.4 class 1 = 0.478 +- 0.207 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.4 class 2 = 0.498 +- 0.207 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.4 all KL = 0.574 +- 0.207 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.4 all L1 = 0.486 +- 0.117 (in-sample avg dev_std = 0.458)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.579
Model XAI F1 of binarized graphs for r=0.6 =  0.596425
Model XAI WIoU of binarized graphs for r=0.6 =  0.45335875000000003
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.547
SUFF++ for r=0.6 class 0 = 0.535 +- 0.224 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 class 1 = 0.7 +- 0.224 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 class 2 = 0.625 +- 0.224 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 all KL = 0.667 +- 0.224 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 all L1 = 0.619 +- 0.196 (in-sample avg dev_std = 0.419)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.671
Model XAI F1 of binarized graphs for r=0.9 =  0.58662625
Model XAI WIoU of binarized graphs for r=0.9 =  0.42531874999999997
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.649
SUFF++ for r=0.9 class 0 = 0.671 +- 0.145 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 1 = 0.917 +- 0.145 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 2 = 0.696 +- 0.145 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 all KL = 0.861 +- 0.145 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 all L1 = 0.758 +- 0.179 (in-sample avg dev_std = 0.273)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.614
Model XAI F1 of binarized graphs for r=0.95 =  0.57028
Model XAI WIoU of binarized graphs for r=0.95 =  0.40991625
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.591
SUFF++ for r=0.95 class 0 = 0.869 +- 0.060 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.95 class 1 = 0.971 +- 0.060 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.95 class 2 = 0.86 +- 0.060 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.95 all KL = 0.961 +- 0.060 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.95 all L1 = 0.899 +- 0.098 (in-sample avg dev_std = 0.179)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 13:35:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 01:35:26 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 01:35:39 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 01:35:42 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 01:35:44 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 01:35:46 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 01:35:48 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 01:35:48 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 01:35:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:35:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))

Gold ratio (id_test) =  tensor(0.3175) +- tensor(0.1645)
F1 for r=0.3 = 0.655
WIoU for r=0.3 = 0.529
F1 for r=0.4 = 0.655
WIoU for r=0.4 = 0.544
F1 for r=0.6 = 0.585
WIoU for r=0.6 = 0.466
F1 for r=0.9 = 0.465
WIoU for r=0.9 = 0.341
F1 for r=0.95 = 0.458
WIoU for r=0.95 = 0.334
F1 for r=1.0 = 0.459
WIoU for r=1.0 = 0.334
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))

Gold ratio (test) =  tensor(0.3931) +- tensor(0.0982)
F1 for r=0.3 = 0.335
WIoU for r=0.3 = 0.243
F1 for r=0.4 = 0.442
WIoU for r=0.4 = 0.334
F1 for r=0.6 = 0.584
WIoU for r=0.6 = 0.447
F1 for r=0.9 = 0.579
WIoU for r=0.9 = 0.419
F1 for r=0.95 = 0.567
WIoU for r=0.95 = 0.407
F1 for r=1.0 = 0.558
WIoU for r=1.0 = 0.398


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.561
Model XAI F1 of binarized graphs for r=0.3 =  0.6549787499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.52947375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.616 +- 0.284 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 1 = 0.523 +- 0.284 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 2 = 0.534 +- 0.284 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all KL = 0.546 +- 0.284 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all L1 = 0.558 +- 0.160 (in-sample avg dev_std = 0.401)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.5
Model XAI F1 of binarized graphs for r=0.4 =  0.65474875
Model XAI WIoU of binarized graphs for r=0.4 =  0.54398625
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.338
NEC for r=0.4 class 0 = 0.561 +- 0.284 (in-sample avg dev_std = 0.480)
NEC for r=0.4 class 1 = 0.537 +- 0.284 (in-sample avg dev_std = 0.480)
NEC for r=0.4 class 2 = 0.628 +- 0.284 (in-sample avg dev_std = 0.480)
NEC for r=0.4 all KL = 0.576 +- 0.284 (in-sample avg dev_std = 0.480)
NEC for r=0.4 all L1 = 0.574 +- 0.160 (in-sample avg dev_std = 0.480)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.654
Model XAI F1 of binarized graphs for r=0.6 =  0.58514375
Model XAI WIoU of binarized graphs for r=0.6 =  0.46597375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.355
NEC for r=0.6 class 0 = 0.58 +- 0.284 (in-sample avg dev_std = 0.482)
NEC for r=0.6 class 1 = 0.557 +- 0.284 (in-sample avg dev_std = 0.482)
NEC for r=0.6 class 2 = 0.641 +- 0.284 (in-sample avg dev_std = 0.482)
NEC for r=0.6 all KL = 0.65 +- 0.284 (in-sample avg dev_std = 0.482)
NEC for r=0.6 all L1 = 0.592 +- 0.179 (in-sample avg dev_std = 0.482)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  0.46488749999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.34084125
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.49
NEC for r=0.9 class 0 = 0.581 +- 0.238 (in-sample avg dev_std = 0.592)
NEC for r=0.9 class 1 = 0.554 +- 0.238 (in-sample avg dev_std = 0.592)
NEC for r=0.9 class 2 = 0.564 +- 0.238 (in-sample avg dev_std = 0.592)
NEC for r=0.9 all KL = 0.628 +- 0.238 (in-sample avg dev_std = 0.592)
NEC for r=0.9 all L1 = 0.567 +- 0.152 (in-sample avg dev_std = 0.592)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.921
Model XAI F1 of binarized graphs for r=0.95 =  0.45774249999999994
Model XAI WIoU of binarized graphs for r=0.95 =  0.33353
len(reference) = 800
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.511
NEC for r=0.95 class 0 = 0.571 +- 0.230 (in-sample avg dev_std = 0.613)
NEC for r=0.95 class 1 = 0.522 +- 0.230 (in-sample avg dev_std = 0.613)
NEC for r=0.95 class 2 = 0.56 +- 0.230 (in-sample avg dev_std = 0.613)
NEC for r=0.95 all KL = 0.608 +- 0.230 (in-sample avg dev_std = 0.613)
NEC for r=0.95 all L1 = 0.55 +- 0.154 (in-sample avg dev_std = 0.613)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  0.45948124999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.33389375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.528
NEC for r=1.0 class 0 = 0.563 +- 0.234 (in-sample avg dev_std = 0.632)
NEC for r=1.0 class 1 = 0.489 +- 0.234 (in-sample avg dev_std = 0.632)
NEC for r=1.0 class 2 = 0.586 +- 0.234 (in-sample avg dev_std = 0.632)
NEC for r=1.0 all KL = 0.604 +- 0.234 (in-sample avg dev_std = 0.632)
NEC for r=1.0 all L1 = 0.546 +- 0.166 (in-sample avg dev_std = 0.632)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.373
Model XAI F1 of binarized graphs for r=0.3 =  0.33515
Model XAI WIoU of binarized graphs for r=0.3 =  0.24293625000000002
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.325
NEC for r=0.3 class 0 = 0.516 +- 0.231 (in-sample avg dev_std = 0.335)
NEC for r=0.3 class 1 = 0.371 +- 0.231 (in-sample avg dev_std = 0.335)
NEC for r=0.3 class 2 = 0.447 +- 0.231 (in-sample avg dev_std = 0.335)
NEC for r=0.3 all KL = 0.35 +- 0.231 (in-sample avg dev_std = 0.335)
NEC for r=0.3 all L1 = 0.446 +- 0.172 (in-sample avg dev_std = 0.335)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.291
Model XAI F1 of binarized graphs for r=0.4 =  0.44231499999999996
Model XAI WIoU of binarized graphs for r=0.4 =  0.3335575
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.378
NEC for r=0.4 class 0 = 0.538 +- 0.245 (in-sample avg dev_std = 0.418)
NEC for r=0.4 class 1 = 0.524 +- 0.245 (in-sample avg dev_std = 0.418)
NEC for r=0.4 class 2 = 0.537 +- 0.245 (in-sample avg dev_std = 0.418)
NEC for r=0.4 all KL = 0.466 +- 0.245 (in-sample avg dev_std = 0.418)
NEC for r=0.4 all L1 = 0.533 +- 0.152 (in-sample avg dev_std = 0.418)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.48
Model XAI F1 of binarized graphs for r=0.6 =  0.58420875
Model XAI WIoU of binarized graphs for r=0.6 =  0.44668125000000003
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.487
NEC for r=0.6 class 0 = 0.602 +- 0.261 (in-sample avg dev_std = 0.549)
NEC for r=0.6 class 1 = 0.512 +- 0.261 (in-sample avg dev_std = 0.549)
NEC for r=0.6 class 2 = 0.626 +- 0.261 (in-sample avg dev_std = 0.549)
NEC for r=0.6 all KL = 0.613 +- 0.261 (in-sample avg dev_std = 0.549)
NEC for r=0.6 all L1 = 0.581 +- 0.156 (in-sample avg dev_std = 0.549)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.65
Model XAI F1 of binarized graphs for r=0.9 =  0.5792587499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.41902750000000005
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.533
NEC for r=0.9 class 0 = 0.501 +- 0.252 (in-sample avg dev_std = 0.513)
NEC for r=0.9 class 1 = 0.295 +- 0.252 (in-sample avg dev_std = 0.513)
NEC for r=0.9 class 2 = 0.541 +- 0.252 (in-sample avg dev_std = 0.513)
NEC for r=0.9 all KL = 0.436 +- 0.252 (in-sample avg dev_std = 0.513)
NEC for r=0.9 all L1 = 0.449 +- 0.180 (in-sample avg dev_std = 0.513)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.62
Model XAI F1 of binarized graphs for r=0.95 =  0.56730375
Model XAI WIoU of binarized graphs for r=0.95 =  0.40704999999999997
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.557
NEC for r=0.95 class 0 = 0.463 +- 0.228 (in-sample avg dev_std = 0.457)
NEC for r=0.95 class 1 = 0.223 +- 0.228 (in-sample avg dev_std = 0.457)
NEC for r=0.95 class 2 = 0.502 +- 0.228 (in-sample avg dev_std = 0.457)
NEC for r=0.95 all KL = 0.358 +- 0.228 (in-sample avg dev_std = 0.457)
NEC for r=0.95 all L1 = 0.399 +- 0.183 (in-sample avg dev_std = 0.457)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.554
Model XAI F1 of binarized graphs for r=1.0 =  0.55751125
Model XAI WIoU of binarized graphs for r=1.0 =  0.39755250000000003
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.536
NEC for r=1.0 class 0 = 0.419 +- 0.221 (in-sample avg dev_std = 0.456)
NEC for r=1.0 class 1 = 0.201 +- 0.221 (in-sample avg dev_std = 0.456)
NEC for r=1.0 class 2 = 0.494 +- 0.221 (in-sample avg dev_std = 0.456)
NEC for r=1.0 all KL = 0.346 +- 0.221 (in-sample avg dev_std = 0.456)
NEC for r=1.0 all L1 = 0.375 +- 0.195 (in-sample avg dev_std = 0.456)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.562
Model XAI F1 of binarized graphs for r=0.3 =  0.6549787499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.52947375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.423
SUFF++ for r=0.3 class 0 = 0.464 +- 0.265 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.3 class 1 = 0.542 +- 0.265 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.3 class 2 = 0.615 +- 0.265 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.3 all KL = 0.554 +- 0.265 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.3 all L1 = 0.539 +- 0.163 (in-sample avg dev_std = 0.463)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.498
Model XAI F1 of binarized graphs for r=0.4 =  0.65474875
Model XAI WIoU of binarized graphs for r=0.4 =  0.54398625
len(reference) = 800
Effective ratio: 0.415 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.427
SUFF++ for r=0.4 class 0 = 0.437 +- 0.271 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.4 class 1 = 0.515 +- 0.271 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.4 class 2 = 0.6 +- 0.271 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.4 all KL = 0.525 +- 0.271 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.4 all L1 = 0.516 +- 0.166 (in-sample avg dev_std = 0.484)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.655
Model XAI F1 of binarized graphs for r=0.6 =  0.58514375
Model XAI WIoU of binarized graphs for r=0.6 =  0.46597375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.616
SUFF++ for r=0.6 class 0 = 0.436 +- 0.266 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 class 1 = 0.599 +- 0.266 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 class 2 = 0.623 +- 0.266 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 all KL = 0.521 +- 0.266 (in-sample avg dev_std = 0.502)
SUFF++ for r=0.6 all L1 = 0.552 +- 0.201 (in-sample avg dev_std = 0.502)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  0.46488749999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.34084125
len(reference) = 800
Effective ratio: 0.915 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.808
SUFF++ for r=0.9 class 0 = 0.582 +- 0.198 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.9 class 1 = 0.794 +- 0.198 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.9 class 2 = 0.854 +- 0.198 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.9 all KL = 0.804 +- 0.198 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.9 all L1 = 0.742 +- 0.195 (in-sample avg dev_std = 0.316)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.922
Model XAI F1 of binarized graphs for r=0.95 =  0.45774249999999994
Model XAI WIoU of binarized graphs for r=0.95 =  0.33353
len(reference) = 719
Effective ratio: 0.963 +- 0.013
Model Accuracy over intervened graphs for r=0.95 =  0.849
SUFF++ for r=0.95 class 0 = 0.677 +- 0.173 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.95 class 1 = 0.878 +- 0.173 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.95 class 2 = 0.886 +- 0.173 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.95 all KL = 0.863 +- 0.173 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.95 all L1 = 0.812 +- 0.161 (in-sample avg dev_std = 0.315)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.373
Model XAI F1 of binarized graphs for r=0.3 =  0.33515
Model XAI WIoU of binarized graphs for r=0.3 =  0.24293625000000002
len(reference) = 800
Effective ratio: 0.315 +- 0.009
Model Accuracy over intervened graphs for r=0.3 =  0.348
SUFF++ for r=0.3 class 0 = 0.587 +- 0.178 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.3 class 1 = 0.645 +- 0.178 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.3 class 2 = 0.621 +- 0.178 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.3 all KL = 0.725 +- 0.178 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.3 all L1 = 0.617 +- 0.126 (in-sample avg dev_std = 0.359)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.292
Model XAI F1 of binarized graphs for r=0.4 =  0.44231499999999996
Model XAI WIoU of binarized graphs for r=0.4 =  0.3335575
len(reference) = 800
Effective ratio: 0.413 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.308
SUFF++ for r=0.4 class 0 = 0.509 +- 0.223 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.4 class 1 = 0.546 +- 0.223 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.4 class 2 = 0.516 +- 0.223 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.4 all KL = 0.605 +- 0.223 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.4 all L1 = 0.524 +- 0.122 (in-sample avg dev_std = 0.471)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.481
Model XAI F1 of binarized graphs for r=0.6 =  0.58420875
Model XAI WIoU of binarized graphs for r=0.6 =  0.44668125000000003
len(reference) = 800
Effective ratio: 0.616 +- 0.010
Model Accuracy over intervened graphs for r=0.6 =  0.505
SUFF++ for r=0.6 class 0 = 0.532 +- 0.236 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 1 = 0.637 +- 0.236 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 2 = 0.63 +- 0.236 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all KL = 0.623 +- 0.236 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all L1 = 0.599 +- 0.202 (in-sample avg dev_std = 0.465)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.65
Model XAI F1 of binarized graphs for r=0.9 =  0.5792587499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.41902750000000005
len(reference) = 800
Effective ratio: 0.913 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.624
SUFF++ for r=0.9 class 0 = 0.654 +- 0.180 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 class 1 = 0.919 +- 0.180 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 class 2 = 0.691 +- 0.180 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 all KL = 0.831 +- 0.180 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 all L1 = 0.752 +- 0.197 (in-sample avg dev_std = 0.320)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.62
Model XAI F1 of binarized graphs for r=0.95 =  0.56730375
Model XAI WIoU of binarized graphs for r=0.95 =  0.40704999999999997
len(reference) = 800
Effective ratio: 0.964 +- 0.007
Model Accuracy over intervened graphs for r=0.95 =  0.587
SUFF++ for r=0.95 class 0 = 0.817 +- 0.101 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.95 class 1 = 0.967 +- 0.101 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.95 class 2 = 0.853 +- 0.101 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.95 all KL = 0.935 +- 0.101 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.95 all L1 = 0.877 +- 0.118 (in-sample avg dev_std = 0.237)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.616, 0.652, 0.667, 0.656, 0.641, 0.625], 'all_L1': [0.571, 0.596, 0.595, 0.58, 0.561, 0.551]}), defaultdict(<class 'list'>, {'all_KL': [0.547, 0.6, 0.621, 0.593, 0.581, 0.562], 'all_L1': [0.57, 0.593, 0.588, 0.558, 0.54, 0.527]}), defaultdict(<class 'list'>, {'all_KL': [0.572, 0.579, 0.613, 0.613, 0.599, 0.585], 'all_L1': [0.582, 0.584, 0.568, 0.559, 0.545, 0.531]}), defaultdict(<class 'list'>, {'all_KL': [0.569, 0.594, 0.625, 0.628, 0.607, 0.602], 'all_L1': [0.579, 0.588, 0.574, 0.56, 0.537, 0.532]}), defaultdict(<class 'list'>, {'all_KL': [0.546, 0.576, 0.65, 0.628, 0.608, 0.604], 'all_L1': [0.558, 0.574, 0.592, 0.567, 0.55, 0.546]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.481, 0.45, 0.497, 0.84, 0.927, 1.0], 'all_L1': [0.518, 0.495, 0.534, 0.778, 0.873, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.524, 0.521, 0.622, 0.864, 0.932, 1.0], 'all_L1': [0.498, 0.524, 0.61, 0.795, 0.875, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.497, 0.521, 0.579, 0.866, 0.928, 1.0], 'all_L1': [0.492, 0.512, 0.591, 0.806, 0.875, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.514, 0.52, 0.603, 0.862, 0.916, 1.0], 'all_L1': [0.505, 0.52, 0.604, 0.797, 0.866, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.554, 0.525, 0.521, 0.804, 0.863, 1.0], 'all_L1': [0.539, 0.516, 0.552, 0.742, 0.812, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]

Eval split test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.411, 0.509, 0.661, 0.481, 0.432, 0.432], 'all_L1': [0.418, 0.512, 0.619, 0.5, 0.463, 0.44]}), defaultdict(<class 'list'>, {'all_KL': [0.464, 0.53, 0.555, 0.359, 0.305, 0.3], 'all_L1': [0.548, 0.578, 0.506, 0.404, 0.368, 0.352]}), defaultdict(<class 'list'>, {'all_KL': [0.45, 0.555, 0.573, 0.387, 0.312, 0.3], 'all_L1': [0.541, 0.598, 0.539, 0.409, 0.365, 0.345]}), defaultdict(<class 'list'>, {'all_KL': [0.434, 0.506, 0.553, 0.361, 0.303, 0.317], 'all_L1': [0.53, 0.581, 0.551, 0.417, 0.379, 0.358]}), defaultdict(<class 'list'>, {'all_KL': [0.35, 0.466, 0.613, 0.436, 0.358, 0.346], 'all_L1': [0.446, 0.533, 0.581, 0.449, 0.399, 0.375]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.652, 0.552, 0.513, 0.849, 0.937, 1.0], 'all_L1': [0.639, 0.547, 0.524, 0.761, 0.869, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.618, 0.585, 0.774, 0.92, 0.975, 1.0], 'all_L1': [0.522, 0.519, 0.745, 0.826, 0.922, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.601, 0.555, 0.721, 0.893, 0.949, 1.0], 'all_L1': [0.503, 0.494, 0.685, 0.804, 0.895, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.629, 0.574, 0.667, 0.861, 0.961, 1.0], 'all_L1': [0.521, 0.486, 0.619, 0.758, 0.899, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.725, 0.605, 0.623, 0.831, 0.935, 1.0], 'all_L1': [0.617, 0.524, 0.599, 0.752, 0.877, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.572 +- 0.008, 0.587 +- 0.008, 0.583 +- 0.011, 0.565 +- 0.008, 0.547 +- 0.008, 0.537 +- 0.009
nec class all_KL  =  0.570 +- 0.025, 0.600 +- 0.027, 0.635 +- 0.020, 0.624 +- 0.021, 0.607 +- 0.019, 0.596 +- 0.021
nec_acc_int  =  0.334 +- 0.022, 0.354 +- 0.018, 0.375 +- 0.014, 0.494 +- 0.009, 0.522 +- 0.007, 0.533 +- 0.010
suff++ class all_L1  =  0.510 +- 0.017, 0.513 +- 0.010, 0.578 +- 0.030, 0.784 +- 0.023, 0.860 +- 0.024, 1.000 +- 0.000
suff++ class all_KL  =  0.514 +- 0.025, 0.507 +- 0.029, 0.564 +- 0.048, 0.847 +- 0.024, 0.913 +- 0.026, 1.000 +- 0.000
suff++_acc_int  =  0.437 +- 0.019, 0.465 +- 0.027, 0.639 +- 0.019, 0.847 +- 0.022, 0.888 +- 0.020

Eval split test
nec class all_L1  =  0.497 +- 0.054, 0.560 +- 0.032, 0.559 +- 0.038, 0.436 +- 0.036, 0.395 +- 0.036, 0.374 +- 0.034
nec class all_KL  =  0.422 +- 0.040, 0.513 +- 0.029, 0.591 +- 0.041, 0.405 +- 0.047, 0.342 +- 0.049, 0.339 +- 0.049
nec_acc_int  =  0.306 +- 0.031, 0.380 +- 0.016, 0.478 +- 0.018, 0.551 +- 0.016, 0.563 +- 0.009, 0.540 +- 0.011
suff++ class all_L1  =  0.560 +- 0.056, 0.514 +- 0.022, 0.634 +- 0.075, 0.780 +- 0.029, 0.892 +- 0.018, 1.000 +- 0.000
suff++ class all_KL  =  0.645 +- 0.043, 0.574 +- 0.020, 0.660 +- 0.089, 0.871 +- 0.032, 0.951 +- 0.015, 1.000 +- 0.000
suff++_acc_int  =  0.318 +- 0.026, 0.311 +- 0.016, 0.558 +- 0.048, 0.650 +- 0.017, 0.614 +- 0.030


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.541 +- 0.005, 0.550 +- 0.005, 0.581 +- 0.012, 0.674 +- 0.010, 0.703 +- 0.012, 0.769 +- 0.005
Faith. Armon (L1)= 		  =  0.539 +- 0.006, 0.548 +- 0.006, 0.580 +- 0.013, 0.656 +- 0.007, 0.668 +- 0.009, 0.699 +- 0.008
Faith. GMean (L1)= 	  =  0.540 +- 0.006, 0.549 +- 0.005, 0.580 +- 0.012, 0.665 +- 0.009, 0.686 +- 0.010, 0.733 +- 0.006
Faith. Aritm (KL)= 		  =  0.542 +- 0.006, 0.554 +- 0.004, 0.600 +- 0.016, 0.735 +- 0.012, 0.760 +- 0.016, 0.798 +- 0.011
Faith. Armon (KL)= 		  =  0.539 +- 0.006, 0.549 +- 0.009, 0.596 +- 0.020, 0.718 +- 0.013, 0.729 +- 0.016, 0.746 +- 0.017
Faith. GMean (KL)= 	  =  0.541 +- 0.006, 0.551 +- 0.006, 0.598 +- 0.018, 0.727 +- 0.012, 0.744 +- 0.015, 0.772 +- 0.014

Eval split test
Faith. Aritm (L1)= 		  =  0.528 +- 0.005, 0.537 +- 0.008, 0.597 +- 0.019, 0.608 +- 0.014, 0.644 +- 0.012, 0.687 +- 0.017
Faith. Armon (L1)= 		  =  0.521 +- 0.010, 0.535 +- 0.008, 0.589 +- 0.013, 0.558 +- 0.024, 0.546 +- 0.031, 0.544 +- 0.035
Faith. GMean (L1)= 	  =  0.525 +- 0.006, 0.536 +- 0.008, 0.593 +- 0.016, 0.582 +- 0.018, 0.593 +- 0.022, 0.611 +- 0.027
Faith. Aritm (KL)= 		  =  0.533 +- 0.005, 0.544 +- 0.011, 0.625 +- 0.027, 0.638 +- 0.017, 0.647 +- 0.020, 0.669 +- 0.025
Faith. Armon (KL)= 		  =  0.507 +- 0.019, 0.541 +- 0.012, 0.617 +- 0.025, 0.550 +- 0.039, 0.501 +- 0.050, 0.504 +- 0.053
Faith. GMean (KL)= 	  =  0.520 +- 0.010, 0.542 +- 0.012, 0.621 +- 0.026, 0.592 +- 0.028, 0.569 +- 0.036, 0.581 +- 0.041
Computed for split load_split = id



Completed in  0:19:59.975820  for GSATGIN GOODMotif/basis



DONE GSAT GOODMotif/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 13:39:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:25 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:37 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:39 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:42 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:45 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 01:39:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.504
WIoU for r=0.3 = 0.380
F1 for r=0.4 = 0.557
WIoU for r=0.4 = 0.439
F1 for r=0.6 = 0.583
WIoU for r=0.6 = 0.466
F1 for r=0.9 = 0.538
WIoU for r=0.9 = 0.438
F1 for r=0.95 = 0.520
WIoU for r=0.95 = 0.427
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.420
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.192
WIoU for r=0.3 = 0.131
F1 for r=0.4 = 0.173
WIoU for r=0.4 = 0.115
F1 for r=0.6 = 0.147
WIoU for r=0.6 = 0.096
F1 for r=0.9 = 0.122
WIoU for r=0.9 = 0.078
F1 for r=0.95 = 0.117
WIoU for r=0.95 = 0.075
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.073


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.369
Model XAI F1 of binarized graphs for r=0.3 =  0.5035925
Model XAI WIoU of binarized graphs for r=0.3 =  0.37988
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.343
NEC for r=0.3 class 0 = 0.28 +- 0.179 (in-sample avg dev_std = 0.210)
NEC for r=0.3 class 1 = 0.22 +- 0.179 (in-sample avg dev_std = 0.210)
NEC for r=0.3 class 2 = 0.236 +- 0.179 (in-sample avg dev_std = 0.210)
NEC for r=0.3 all KL = 0.122 +- 0.179 (in-sample avg dev_std = 0.210)
NEC for r=0.3 all L1 = 0.245 +- 0.177 (in-sample avg dev_std = 0.210)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.435
Model XAI F1 of binarized graphs for r=0.4 =  0.55710625
Model XAI WIoU of binarized graphs for r=0.4 =  0.43915624999999997
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.359
NEC for r=0.4 class 0 = 0.296 +- 0.247 (in-sample avg dev_std = 0.247)
NEC for r=0.4 class 1 = 0.198 +- 0.247 (in-sample avg dev_std = 0.247)
NEC for r=0.4 class 2 = 0.25 +- 0.247 (in-sample avg dev_std = 0.247)
NEC for r=0.4 all KL = 0.165 +- 0.247 (in-sample avg dev_std = 0.247)
NEC for r=0.4 all L1 = 0.248 +- 0.220 (in-sample avg dev_std = 0.247)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.517
Model XAI F1 of binarized graphs for r=0.6 =  0.58298625
Model XAI WIoU of binarized graphs for r=0.6 =  0.46586500000000003
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.423
NEC for r=0.6 class 0 = 0.408 +- 0.275 (in-sample avg dev_std = 0.445)
NEC for r=0.6 class 1 = 0.236 +- 0.275 (in-sample avg dev_std = 0.445)
NEC for r=0.6 class 2 = 0.421 +- 0.275 (in-sample avg dev_std = 0.445)
NEC for r=0.6 all KL = 0.317 +- 0.275 (in-sample avg dev_std = 0.445)
NEC for r=0.6 all L1 = 0.354 +- 0.229 (in-sample avg dev_std = 0.445)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.801
Model XAI F1 of binarized graphs for r=0.9 =  0.537875
Model XAI WIoU of binarized graphs for r=0.9 =  0.43775875
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.517
NEC for r=0.9 class 0 = 0.614 +- 0.286 (in-sample avg dev_std = 0.543)
NEC for r=0.9 class 1 = 0.334 +- 0.286 (in-sample avg dev_std = 0.543)
NEC for r=0.9 class 2 = 0.596 +- 0.286 (in-sample avg dev_std = 0.543)
NEC for r=0.9 all KL = 0.515 +- 0.286 (in-sample avg dev_std = 0.543)
NEC for r=0.9 all L1 = 0.514 +- 0.216 (in-sample avg dev_std = 0.543)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.849
Model XAI F1 of binarized graphs for r=0.95 =  0.52030375
Model XAI WIoU of binarized graphs for r=0.95 =  0.427305
len(reference) = 800
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.53
NEC for r=0.95 class 0 = 0.595 +- 0.293 (in-sample avg dev_std = 0.538)
NEC for r=0.95 class 1 = 0.335 +- 0.293 (in-sample avg dev_std = 0.538)
NEC for r=0.95 class 2 = 0.575 +- 0.293 (in-sample avg dev_std = 0.538)
NEC for r=0.95 all KL = 0.504 +- 0.293 (in-sample avg dev_std = 0.538)
NEC for r=0.95 all L1 = 0.501 +- 0.218 (in-sample avg dev_std = 0.538)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.894
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.42040875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.553
NEC for r=1.0 class 0 = 0.566 +- 0.303 (in-sample avg dev_std = 0.562)
NEC for r=1.0 class 1 = 0.327 +- 0.303 (in-sample avg dev_std = 0.562)
NEC for r=1.0 class 2 = 0.552 +- 0.303 (in-sample avg dev_std = 0.562)
NEC for r=1.0 all KL = 0.492 +- 0.303 (in-sample avg dev_std = 0.562)
NEC for r=1.0 all L1 = 0.481 +- 0.223 (in-sample avg dev_std = 0.562)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.415
Model XAI F1 of binarized graphs for r=0.3 =  0.19157874999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.13074124999999998
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.352
NEC for r=0.3 class 0 = 0.214 +- 0.260 (in-sample avg dev_std = 0.261)
NEC for r=0.3 class 1 = 0.157 +- 0.260 (in-sample avg dev_std = 0.261)
NEC for r=0.3 class 2 = 0.193 +- 0.260 (in-sample avg dev_std = 0.261)
NEC for r=0.3 all KL = 0.144 +- 0.260 (in-sample avg dev_std = 0.261)
NEC for r=0.3 all L1 = 0.187 +- 0.213 (in-sample avg dev_std = 0.261)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.382
Model XAI F1 of binarized graphs for r=0.4 =  0.17299125000000004
Model XAI WIoU of binarized graphs for r=0.4 =  0.11505499999999999
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.357
NEC for r=0.4 class 0 = 0.202 +- 0.281 (in-sample avg dev_std = 0.248)
NEC for r=0.4 class 1 = 0.159 +- 0.281 (in-sample avg dev_std = 0.248)
NEC for r=0.4 class 2 = 0.19 +- 0.281 (in-sample avg dev_std = 0.248)
NEC for r=0.4 all KL = 0.152 +- 0.281 (in-sample avg dev_std = 0.248)
NEC for r=0.4 all L1 = 0.184 +- 0.216 (in-sample avg dev_std = 0.248)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.36
Model XAI F1 of binarized graphs for r=0.6 =  0.14660250000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.09557874999999999
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.353
NEC for r=0.6 class 0 = 0.337 +- 0.429 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 1 = 0.333 +- 0.429 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 2 = 0.358 +- 0.429 (in-sample avg dev_std = 0.263)
NEC for r=0.6 all KL = 0.384 +- 0.429 (in-sample avg dev_std = 0.263)
NEC for r=0.6 all L1 = 0.342 +- 0.330 (in-sample avg dev_std = 0.263)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.349
Model XAI F1 of binarized graphs for r=0.9 =  0.12152625
Model XAI WIoU of binarized graphs for r=0.9 =  0.07779125
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.348
NEC for r=0.9 class 0 = 0.27 +- 0.414 (in-sample avg dev_std = 0.363)
NEC for r=0.9 class 1 = 0.24 +- 0.414 (in-sample avg dev_std = 0.363)
NEC for r=0.9 class 2 = 0.248 +- 0.414 (in-sample avg dev_std = 0.363)
NEC for r=0.9 all KL = 0.358 +- 0.414 (in-sample avg dev_std = 0.363)
NEC for r=0.9 all L1 = 0.253 +- 0.292 (in-sample avg dev_std = 0.363)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.322
Model XAI F1 of binarized graphs for r=0.95 =  0.11720375000000001
Model XAI WIoU of binarized graphs for r=0.95 =  0.075195
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.357
NEC for r=0.95 class 0 = 0.248 +- 0.422 (in-sample avg dev_std = 0.328)
NEC for r=0.95 class 1 = 0.227 +- 0.422 (in-sample avg dev_std = 0.328)
NEC for r=0.95 class 2 = 0.224 +- 0.422 (in-sample avg dev_std = 0.328)
NEC for r=0.95 all KL = 0.373 +- 0.422 (in-sample avg dev_std = 0.328)
NEC for r=0.95 all L1 = 0.233 +- 0.263 (in-sample avg dev_std = 0.328)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.333
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.07303625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.357
NEC for r=1.0 class 0 = 0.271 +- 0.423 (in-sample avg dev_std = 0.307)
NEC for r=1.0 class 1 = 0.248 +- 0.423 (in-sample avg dev_std = 0.307)
NEC for r=1.0 class 2 = 0.271 +- 0.423 (in-sample avg dev_std = 0.307)
NEC for r=1.0 all KL = 0.411 +- 0.423 (in-sample avg dev_std = 0.307)
NEC for r=1.0 all L1 = 0.263 +- 0.273 (in-sample avg dev_std = 0.307)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.367
Model XAI F1 of binarized graphs for r=0.3 =  0.5035925
Model XAI WIoU of binarized graphs for r=0.3 =  0.37988
len(reference) = 765
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.352
SUFF++ for r=0.3 class 0 = 0.754 +- 0.134 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 class 1 = 0.796 +- 0.134 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 class 2 = 0.783 +- 0.134 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 all KL = 0.894 +- 0.134 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 all L1 = 0.777 +- 0.141 (in-sample avg dev_std = 0.266)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.436
Model XAI F1 of binarized graphs for r=0.4 =  0.55710625
Model XAI WIoU of binarized graphs for r=0.4 =  0.43915624999999997
len(reference) = 798
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.402
SUFF++ for r=0.4 class 0 = 0.754 +- 0.185 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.4 class 1 = 0.835 +- 0.185 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.4 class 2 = 0.771 +- 0.185 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.4 all KL = 0.868 +- 0.185 (in-sample avg dev_std = 0.307)
SUFF++ for r=0.4 all L1 = 0.787 +- 0.169 (in-sample avg dev_std = 0.307)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.517
Model XAI F1 of binarized graphs for r=0.6 =  0.58298625
Model XAI WIoU of binarized graphs for r=0.6 =  0.46586500000000003
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.492
SUFF++ for r=0.6 class 0 = 0.722 +- 0.230 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 class 1 = 0.86 +- 0.230 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 class 2 = 0.735 +- 0.230 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 all KL = 0.818 +- 0.230 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 all L1 = 0.773 +- 0.201 (in-sample avg dev_std = 0.375)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.801
Model XAI F1 of binarized graphs for r=0.9 =  0.537875
Model XAI WIoU of binarized graphs for r=0.9 =  0.43775875
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.798
SUFF++ for r=0.9 class 0 = 0.768 +- 0.194 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 class 1 = 0.861 +- 0.194 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 class 2 = 0.833 +- 0.194 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 all KL = 0.874 +- 0.194 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.9 all L1 = 0.821 +- 0.213 (in-sample avg dev_std = 0.250)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.833
Model XAI F1 of binarized graphs for r=0.95 =  0.52030375
Model XAI WIoU of binarized graphs for r=0.95 =  0.427305
len(reference) = 706
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.814
SUFF++ for r=0.95 class 0 = 0.804 +- 0.160 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.95 class 1 = 0.909 +- 0.160 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.95 class 2 = 0.885 +- 0.160 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.95 all KL = 0.917 +- 0.160 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.95 all L1 = 0.865 +- 0.179 (in-sample avg dev_std = 0.216)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.415
Model XAI F1 of binarized graphs for r=0.3 =  0.19157874999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.13074124999999998
len(reference) = 798
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.41
SUFF++ for r=0.3 class 0 = 0.822 +- 0.200 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.3 class 1 = 0.879 +- 0.200 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.3 class 2 = 0.827 +- 0.200 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.3 all KL = 0.899 +- 0.200 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.3 all L1 = 0.843 +- 0.178 (in-sample avg dev_std = 0.219)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.382
Model XAI F1 of binarized graphs for r=0.4 =  0.17299125000000004
Model XAI WIoU of binarized graphs for r=0.4 =  0.11505499999999999
len(reference) = 799
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.392
SUFF++ for r=0.4 class 0 = 0.813 +- 0.259 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.4 class 1 = 0.871 +- 0.259 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.4 class 2 = 0.827 +- 0.259 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.4 all KL = 0.871 +- 0.259 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.4 all L1 = 0.837 +- 0.207 (in-sample avg dev_std = 0.242)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.357
Model XAI F1 of binarized graphs for r=0.6 =  0.14660250000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.09557874999999999
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.382
SUFF++ for r=0.6 class 0 = 0.607 +- 0.423 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 1 = 0.595 +- 0.423 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 class 2 = 0.628 +- 0.423 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 all KL = 0.522 +- 0.423 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.6 all L1 = 0.61 +- 0.301 (in-sample avg dev_std = 0.544)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.349
Model XAI F1 of binarized graphs for r=0.9 =  0.12152625
Model XAI WIoU of binarized graphs for r=0.9 =  0.07779125
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.367
SUFF++ for r=0.9 class 0 = 0.704 +- 0.429 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.9 class 1 = 0.735 +- 0.429 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.9 class 2 = 0.76 +- 0.429 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.9 all KL = 0.581 +- 0.429 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.9 all L1 = 0.732 +- 0.272 (in-sample avg dev_std = 0.465)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.322
Model XAI F1 of binarized graphs for r=0.95 =  0.11720375000000001
Model XAI WIoU of binarized graphs for r=0.95 =  0.075195
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.35
SUFF++ for r=0.95 class 0 = 0.871 +- 0.252 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.95 class 1 = 0.874 +- 0.252 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.95 class 2 = 0.906 +- 0.252 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.95 all KL = 0.849 +- 0.252 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.95 all L1 = 0.883 +- 0.183 (in-sample avg dev_std = 0.231)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 13:46:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 01:46:45 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 01:46:58 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:01 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:03 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:06 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 01:47:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.503
WIoU for r=0.3 = 0.378
F1 for r=0.4 = 0.553
WIoU for r=0.4 = 0.434
F1 for r=0.6 = 0.578
WIoU for r=0.6 = 0.463
F1 for r=0.9 = 0.535
WIoU for r=0.9 = 0.445
F1 for r=0.95 = 0.520
WIoU for r=0.95 = 0.439
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.432
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.244
WIoU for r=0.3 = 0.289
F1 for r=0.4 = 0.205
WIoU for r=0.4 = 0.280
F1 for r=0.6 = 0.156
WIoU for r=0.6 = 0.275
F1 for r=0.9 = 0.122
WIoU for r=0.9 = 0.276
F1 for r=0.95 = 0.118
WIoU for r=0.95 = 0.276
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.275


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.371
Model XAI F1 of binarized graphs for r=0.3 =  0.50318625
Model XAI WIoU of binarized graphs for r=0.3 =  0.37834625000000005
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.341
NEC for r=0.3 class 0 = 0.218 +- 0.181 (in-sample avg dev_std = 0.186)
NEC for r=0.3 class 1 = 0.19 +- 0.181 (in-sample avg dev_std = 0.186)
NEC for r=0.3 class 2 = 0.19 +- 0.181 (in-sample avg dev_std = 0.186)
NEC for r=0.3 all KL = 0.096 +- 0.181 (in-sample avg dev_std = 0.186)
NEC for r=0.3 all L1 = 0.199 +- 0.166 (in-sample avg dev_std = 0.186)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.442
Model XAI F1 of binarized graphs for r=0.4 =  0.5531324999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.43389750000000005
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.348
NEC for r=0.4 class 0 = 0.283 +- 0.271 (in-sample avg dev_std = 0.254)
NEC for r=0.4 class 1 = 0.195 +- 0.271 (in-sample avg dev_std = 0.254)
NEC for r=0.4 class 2 = 0.264 +- 0.271 (in-sample avg dev_std = 0.254)
NEC for r=0.4 all KL = 0.17 +- 0.271 (in-sample avg dev_std = 0.254)
NEC for r=0.4 all L1 = 0.247 +- 0.224 (in-sample avg dev_std = 0.254)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.569
Model XAI F1 of binarized graphs for r=0.6 =  0.5783450000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.46326
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.418
NEC for r=0.6 class 0 = 0.453 +- 0.311 (in-sample avg dev_std = 0.462)
NEC for r=0.6 class 1 = 0.284 +- 0.311 (in-sample avg dev_std = 0.462)
NEC for r=0.6 class 2 = 0.464 +- 0.311 (in-sample avg dev_std = 0.462)
NEC for r=0.6 all KL = 0.362 +- 0.311 (in-sample avg dev_std = 0.462)
NEC for r=0.6 all L1 = 0.399 +- 0.232 (in-sample avg dev_std = 0.462)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.779
Model XAI F1 of binarized graphs for r=0.9 =  0.5346175
Model XAI WIoU of binarized graphs for r=0.9 =  0.44534375
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.493
NEC for r=0.9 class 0 = 0.59 +- 0.287 (in-sample avg dev_std = 0.598)
NEC for r=0.9 class 1 = 0.352 +- 0.287 (in-sample avg dev_std = 0.598)
NEC for r=0.9 class 2 = 0.565 +- 0.287 (in-sample avg dev_std = 0.598)
NEC for r=0.9 all KL = 0.535 +- 0.287 (in-sample avg dev_std = 0.598)
NEC for r=0.9 all L1 = 0.501 +- 0.207 (in-sample avg dev_std = 0.598)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.851
Model XAI F1 of binarized graphs for r=0.95 =  0.5201600000000001
Model XAI WIoU of binarized graphs for r=0.95 =  0.43879125
len(reference) = 800
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.512
NEC for r=0.95 class 0 = 0.602 +- 0.287 (in-sample avg dev_std = 0.608)
NEC for r=0.95 class 1 = 0.35 +- 0.287 (in-sample avg dev_std = 0.608)
NEC for r=0.95 class 2 = 0.597 +- 0.287 (in-sample avg dev_std = 0.608)
NEC for r=0.95 all KL = 0.56 +- 0.287 (in-sample avg dev_std = 0.608)
NEC for r=0.95 all L1 = 0.515 +- 0.210 (in-sample avg dev_std = 0.608)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.904
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.43184
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.536
NEC for r=1.0 class 0 = 0.592 +- 0.299 (in-sample avg dev_std = 0.610)
NEC for r=1.0 class 1 = 0.361 +- 0.299 (in-sample avg dev_std = 0.610)
NEC for r=1.0 class 2 = 0.554 +- 0.299 (in-sample avg dev_std = 0.610)
NEC for r=1.0 all KL = 0.541 +- 0.299 (in-sample avg dev_std = 0.610)
NEC for r=1.0 all L1 = 0.501 +- 0.211 (in-sample avg dev_std = 0.610)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.548
Model XAI F1 of binarized graphs for r=0.3 =  0.24439375
Model XAI WIoU of binarized graphs for r=0.3 =  0.28948124999999997
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.348
NEC for r=0.3 class 0 = 0.398 +- 0.328 (in-sample avg dev_std = 0.326)
NEC for r=0.3 class 1 = 0.389 +- 0.328 (in-sample avg dev_std = 0.326)
NEC for r=0.3 class 2 = 0.459 +- 0.328 (in-sample avg dev_std = 0.326)
NEC for r=0.3 all KL = 0.388 +- 0.328 (in-sample avg dev_std = 0.326)
NEC for r=0.3 all L1 = 0.414 +- 0.271 (in-sample avg dev_std = 0.326)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.479
Model XAI F1 of binarized graphs for r=0.4 =  0.204945
Model XAI WIoU of binarized graphs for r=0.4 =  0.27998125
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.357
NEC for r=0.4 class 0 = 0.293 +- 0.340 (in-sample avg dev_std = 0.305)
NEC for r=0.4 class 1 = 0.391 +- 0.340 (in-sample avg dev_std = 0.305)
NEC for r=0.4 class 2 = 0.403 +- 0.340 (in-sample avg dev_std = 0.305)
NEC for r=0.4 all KL = 0.37 +- 0.340 (in-sample avg dev_std = 0.305)
NEC for r=0.4 all L1 = 0.362 +- 0.280 (in-sample avg dev_std = 0.305)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.399
Model XAI F1 of binarized graphs for r=0.6 =  0.155775
Model XAI WIoU of binarized graphs for r=0.6 =  0.27471625000000005
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.356
NEC for r=0.6 class 0 = 0.226 +- 0.285 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 1 = 0.22 +- 0.285 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 2 = 0.276 +- 0.285 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all KL = 0.244 +- 0.285 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all L1 = 0.24 +- 0.267 (in-sample avg dev_std = 0.292)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.389
Model XAI F1 of binarized graphs for r=0.9 =  0.12197875
Model XAI WIoU of binarized graphs for r=0.9 =  0.27609875
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.349
NEC for r=0.9 class 0 = 0.194 +- 0.329 (in-sample avg dev_std = 0.280)
NEC for r=0.9 class 1 = 0.145 +- 0.329 (in-sample avg dev_std = 0.280)
NEC for r=0.9 class 2 = 0.145 +- 0.329 (in-sample avg dev_std = 0.280)
NEC for r=0.9 all KL = 0.195 +- 0.329 (in-sample avg dev_std = 0.280)
NEC for r=0.9 all L1 = 0.162 +- 0.263 (in-sample avg dev_std = 0.280)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.407
Model XAI F1 of binarized graphs for r=0.95 =  0.11762375
Model XAI WIoU of binarized graphs for r=0.95 =  0.27592750000000005
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.347
NEC for r=0.95 class 0 = 0.192 +- 0.326 (in-sample avg dev_std = 0.270)
NEC for r=0.95 class 1 = 0.149 +- 0.326 (in-sample avg dev_std = 0.270)
NEC for r=0.95 class 2 = 0.132 +- 0.326 (in-sample avg dev_std = 0.270)
NEC for r=0.95 all KL = 0.196 +- 0.326 (in-sample avg dev_std = 0.270)
NEC for r=0.95 all L1 = 0.158 +- 0.259 (in-sample avg dev_std = 0.270)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.37
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.2752525
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.349
NEC for r=1.0 class 0 = 0.168 +- 0.304 (in-sample avg dev_std = 0.270)
NEC for r=1.0 class 1 = 0.125 +- 0.304 (in-sample avg dev_std = 0.270)
NEC for r=1.0 class 2 = 0.112 +- 0.304 (in-sample avg dev_std = 0.270)
NEC for r=1.0 all KL = 0.173 +- 0.304 (in-sample avg dev_std = 0.270)
NEC for r=1.0 all L1 = 0.135 +- 0.233 (in-sample avg dev_std = 0.270)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.374
Model XAI F1 of binarized graphs for r=0.3 =  0.50318625
Model XAI WIoU of binarized graphs for r=0.3 =  0.37834625000000005
len(reference) = 746
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.359
SUFF++ for r=0.3 class 0 = 0.789 +- 0.143 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 1 = 0.816 +- 0.143 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 2 = 0.801 +- 0.143 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 all KL = 0.911 +- 0.143 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 all L1 = 0.802 +- 0.126 (in-sample avg dev_std = 0.247)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.443
Model XAI F1 of binarized graphs for r=0.4 =  0.5531324999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.43389750000000005
len(reference) = 796
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.402
SUFF++ for r=0.4 class 0 = 0.756 +- 0.204 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.4 class 1 = 0.847 +- 0.204 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.4 class 2 = 0.782 +- 0.204 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.4 all KL = 0.869 +- 0.204 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.4 all L1 = 0.795 +- 0.166 (in-sample avg dev_std = 0.321)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.569
Model XAI F1 of binarized graphs for r=0.6 =  0.5783450000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.46326
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.521
SUFF++ for r=0.6 class 0 = 0.667 +- 0.248 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 class 1 = 0.808 +- 0.248 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 class 2 = 0.703 +- 0.248 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 all KL = 0.758 +- 0.248 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.6 all L1 = 0.726 +- 0.198 (in-sample avg dev_std = 0.454)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.779
Model XAI F1 of binarized graphs for r=0.9 =  0.5346175
Model XAI WIoU of binarized graphs for r=0.9 =  0.44534375
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.774
SUFF++ for r=0.9 class 0 = 0.803 +- 0.214 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 1 = 0.882 +- 0.214 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 2 = 0.817 +- 0.214 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 all KL = 0.863 +- 0.214 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 all L1 = 0.834 +- 0.203 (in-sample avg dev_std = 0.305)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.836
Model XAI F1 of binarized graphs for r=0.95 =  0.5201600000000001
Model XAI WIoU of binarized graphs for r=0.95 =  0.43879125
len(reference) = 706
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.82
SUFF++ for r=0.95 class 0 = 0.853 +- 0.169 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.95 class 1 = 0.92 +- 0.169 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.95 class 2 = 0.86 +- 0.169 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.95 all KL = 0.914 +- 0.169 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.95 all L1 = 0.877 +- 0.178 (in-sample avg dev_std = 0.250)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.546
Model XAI F1 of binarized graphs for r=0.3 =  0.24439375
Model XAI WIoU of binarized graphs for r=0.3 =  0.28948124999999997
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.57
SUFF++ for r=0.3 class 0 = 0.6 +- 0.326 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.3 class 1 = 0.563 +- 0.326 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.3 class 2 = 0.566 +- 0.326 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.3 all KL = 0.546 +- 0.326 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.3 all L1 = 0.577 +- 0.196 (in-sample avg dev_std = 0.544)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.479
Model XAI F1 of binarized graphs for r=0.4 =  0.204945
Model XAI WIoU of binarized graphs for r=0.4 =  0.27998125
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.484
SUFF++ for r=0.4 class 0 = 0.639 +- 0.323 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.4 class 1 = 0.605 +- 0.323 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.4 class 2 = 0.629 +- 0.323 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.4 all KL = 0.528 +- 0.323 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.4 all L1 = 0.624 +- 0.209 (in-sample avg dev_std = 0.528)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.399
Model XAI F1 of binarized graphs for r=0.6 =  0.155775
Model XAI WIoU of binarized graphs for r=0.6 =  0.27471625000000005
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.469
SUFF++ for r=0.6 class 0 = 0.755 +- 0.352 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 1 = 0.648 +- 0.352 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 2 = 0.685 +- 0.352 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all KL = 0.661 +- 0.352 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all L1 = 0.696 +- 0.279 (in-sample avg dev_std = 0.432)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.389
Model XAI F1 of binarized graphs for r=0.9 =  0.12197875
Model XAI WIoU of binarized graphs for r=0.9 =  0.27609875
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.385
SUFF++ for r=0.9 class 0 = 0.848 +- 0.280 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.9 class 1 = 0.843 +- 0.280 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.9 class 2 = 0.844 +- 0.280 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.9 all KL = 0.811 +- 0.280 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.9 all L1 = 0.845 +- 0.233 (in-sample avg dev_std = 0.298)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.407
Model XAI F1 of binarized graphs for r=0.95 =  0.11762375
Model XAI WIoU of binarized graphs for r=0.95 =  0.27592750000000005
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.387
SUFF++ for r=0.95 class 0 = 0.853 +- 0.205 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.95 class 1 = 0.896 +- 0.205 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.95 class 2 = 0.914 +- 0.205 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.95 all KL = 0.897 +- 0.205 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.95 all L1 = 0.887 +- 0.204 (in-sample avg dev_std = 0.201)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 13:54:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:03 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:16 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:18 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:20 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:24 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 01:54:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.593
WIoU for r=0.3 = 0.478
F1 for r=0.4 = 0.641
WIoU for r=0.4 = 0.552
F1 for r=0.6 = 0.625
WIoU for r=0.6 = 0.594
F1 for r=0.9 = 0.532
WIoU for r=0.9 = 0.597
F1 for r=0.95 = 0.519
WIoU for r=0.95 = 0.597
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.597
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.277
WIoU for r=0.3 = 0.215
F1 for r=0.4 = 0.235
WIoU for r=0.4 = 0.190
F1 for r=0.6 = 0.173
WIoU for r=0.6 = 0.166
F1 for r=0.9 = 0.123
WIoU for r=0.9 = 0.148
F1 for r=0.95 = 0.118
WIoU for r=0.95 = 0.146
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.144


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.404
Model XAI F1 of binarized graphs for r=0.3 =  0.592795
Model XAI WIoU of binarized graphs for r=0.3 =  0.47816374999999994
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.341
NEC for r=0.3 class 0 = 0.173 +- 0.247 (in-sample avg dev_std = 0.160)
NEC for r=0.3 class 1 = 0.119 +- 0.247 (in-sample avg dev_std = 0.160)
NEC for r=0.3 class 2 = 0.179 +- 0.247 (in-sample avg dev_std = 0.160)
NEC for r=0.3 all KL = 0.112 +- 0.247 (in-sample avg dev_std = 0.160)
NEC for r=0.3 all L1 = 0.157 +- 0.225 (in-sample avg dev_std = 0.160)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.494
Model XAI F1 of binarized graphs for r=0.4 =  0.6410724999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.5518599999999999
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.355
NEC for r=0.4 class 0 = 0.324 +- 0.342 (in-sample avg dev_std = 0.267)
NEC for r=0.4 class 1 = 0.136 +- 0.342 (in-sample avg dev_std = 0.267)
NEC for r=0.4 class 2 = 0.298 +- 0.342 (in-sample avg dev_std = 0.267)
NEC for r=0.4 all KL = 0.227 +- 0.342 (in-sample avg dev_std = 0.267)
NEC for r=0.4 all L1 = 0.252 +- 0.292 (in-sample avg dev_std = 0.267)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.676
Model XAI F1 of binarized graphs for r=0.6 =  0.62505875
Model XAI WIoU of binarized graphs for r=0.6 =  0.593855
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.401
NEC for r=0.6 class 0 = 0.53 +- 0.370 (in-sample avg dev_std = 0.484)
NEC for r=0.6 class 1 = 0.245 +- 0.370 (in-sample avg dev_std = 0.484)
NEC for r=0.6 class 2 = 0.524 +- 0.370 (in-sample avg dev_std = 0.484)
NEC for r=0.6 all KL = 0.443 +- 0.370 (in-sample avg dev_std = 0.484)
NEC for r=0.6 all L1 = 0.432 +- 0.288 (in-sample avg dev_std = 0.484)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  0.53213125
Model XAI WIoU of binarized graphs for r=0.9 =  0.59742875
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.495
NEC for r=0.9 class 0 = 0.628 +- 0.334 (in-sample avg dev_std = 0.598)
NEC for r=0.9 class 1 = 0.272 +- 0.334 (in-sample avg dev_std = 0.598)
NEC for r=0.9 class 2 = 0.587 +- 0.334 (in-sample avg dev_std = 0.598)
NEC for r=0.9 all KL = 0.548 +- 0.334 (in-sample avg dev_std = 0.598)
NEC for r=0.9 all L1 = 0.495 +- 0.261 (in-sample avg dev_std = 0.598)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.856
Model XAI F1 of binarized graphs for r=0.95 =  0.5185225
Model XAI WIoU of binarized graphs for r=0.95 =  0.59737625
len(reference) = 800
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.514
NEC for r=0.95 class 0 = 0.633 +- 0.335 (in-sample avg dev_std = 0.623)
NEC for r=0.95 class 1 = 0.258 +- 0.335 (in-sample avg dev_std = 0.623)
NEC for r=0.95 class 2 = 0.59 +- 0.335 (in-sample avg dev_std = 0.623)
NEC for r=0.95 all KL = 0.559 +- 0.335 (in-sample avg dev_std = 0.623)
NEC for r=0.95 all L1 = 0.492 +- 0.261 (in-sample avg dev_std = 0.623)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.938
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.596785
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.547
NEC for r=1.0 class 0 = 0.622 +- 0.336 (in-sample avg dev_std = 0.645)
NEC for r=1.0 class 1 = 0.253 +- 0.336 (in-sample avg dev_std = 0.645)
NEC for r=1.0 class 2 = 0.597 +- 0.336 (in-sample avg dev_std = 0.645)
NEC for r=1.0 all KL = 0.569 +- 0.336 (in-sample avg dev_std = 0.645)
NEC for r=1.0 all L1 = 0.489 +- 0.264 (in-sample avg dev_std = 0.645)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.671
Model XAI F1 of binarized graphs for r=0.3 =  0.277145
Model XAI WIoU of binarized graphs for r=0.3 =  0.21495
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.352
NEC for r=0.3 class 0 = 0.53 +- 0.419 (in-sample avg dev_std = 0.170)
NEC for r=0.3 class 1 = 0.163 +- 0.419 (in-sample avg dev_std = 0.170)
NEC for r=0.3 class 2 = 0.515 +- 0.419 (in-sample avg dev_std = 0.170)
NEC for r=0.3 all KL = 0.373 +- 0.419 (in-sample avg dev_std = 0.170)
NEC for r=0.3 all L1 = 0.4 +- 0.341 (in-sample avg dev_std = 0.170)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.611
Model XAI F1 of binarized graphs for r=0.4 =  0.235445
Model XAI WIoU of binarized graphs for r=0.4 =  0.18960124999999997
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.36
NEC for r=0.4 class 0 = 0.52 +- 0.340 (in-sample avg dev_std = 0.239)
NEC for r=0.4 class 1 = 0.211 +- 0.340 (in-sample avg dev_std = 0.239)
NEC for r=0.4 class 2 = 0.554 +- 0.340 (in-sample avg dev_std = 0.239)
NEC for r=0.4 all KL = 0.345 +- 0.340 (in-sample avg dev_std = 0.239)
NEC for r=0.4 all L1 = 0.425 +- 0.274 (in-sample avg dev_std = 0.239)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.464
Model XAI F1 of binarized graphs for r=0.6 =  0.17305625
Model XAI WIoU of binarized graphs for r=0.6 =  0.16601999999999997
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.366
NEC for r=0.6 class 0 = 0.305 +- 0.273 (in-sample avg dev_std = 0.310)
NEC for r=0.6 class 1 = 0.161 +- 0.273 (in-sample avg dev_std = 0.310)
NEC for r=0.6 class 2 = 0.363 +- 0.273 (in-sample avg dev_std = 0.310)
NEC for r=0.6 all KL = 0.27 +- 0.273 (in-sample avg dev_std = 0.310)
NEC for r=0.6 all L1 = 0.274 +- 0.236 (in-sample avg dev_std = 0.310)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.364
Model XAI F1 of binarized graphs for r=0.9 =  0.12338625
Model XAI WIoU of binarized graphs for r=0.9 =  0.14814875
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.353
NEC for r=0.9 class 0 = 0.262 +- 0.237 (in-sample avg dev_std = 0.270)
NEC for r=0.9 class 1 = 0.184 +- 0.237 (in-sample avg dev_std = 0.270)
NEC for r=0.9 class 2 = 0.294 +- 0.237 (in-sample avg dev_std = 0.270)
NEC for r=0.9 all KL = 0.205 +- 0.237 (in-sample avg dev_std = 0.270)
NEC for r=0.9 all L1 = 0.245 +- 0.206 (in-sample avg dev_std = 0.270)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.37
Model XAI F1 of binarized graphs for r=0.95 =  0.11797875000000001
Model XAI WIoU of binarized graphs for r=0.95 =  0.14613875
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.344
NEC for r=0.95 class 0 = 0.27 +- 0.236 (in-sample avg dev_std = 0.274)
NEC for r=0.95 class 1 = 0.229 +- 0.236 (in-sample avg dev_std = 0.274)
NEC for r=0.95 class 2 = 0.283 +- 0.236 (in-sample avg dev_std = 0.274)
NEC for r=0.95 all KL = 0.24 +- 0.236 (in-sample avg dev_std = 0.274)
NEC for r=0.95 all L1 = 0.26 +- 0.207 (in-sample avg dev_std = 0.274)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.431
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.14440375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.345
NEC for r=1.0 class 0 = 0.337 +- 0.262 (in-sample avg dev_std = 0.294)
NEC for r=1.0 class 1 = 0.339 +- 0.262 (in-sample avg dev_std = 0.294)
NEC for r=1.0 class 2 = 0.33 +- 0.262 (in-sample avg dev_std = 0.294)
NEC for r=1.0 all KL = 0.328 +- 0.262 (in-sample avg dev_std = 0.294)
NEC for r=1.0 all L1 = 0.335 +- 0.214 (in-sample avg dev_std = 0.294)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.404
Model XAI F1 of binarized graphs for r=0.3 =  0.592795
Model XAI WIoU of binarized graphs for r=0.3 =  0.47816374999999994
len(reference) = 774
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.365
SUFF++ for r=0.3 class 0 = 0.847 +- 0.213 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 class 1 = 0.923 +- 0.213 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 class 2 = 0.843 +- 0.213 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 all KL = 0.895 +- 0.213 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 all L1 = 0.871 +- 0.180 (in-sample avg dev_std = 0.294)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.494
Model XAI F1 of binarized graphs for r=0.4 =  0.6410724999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.5518599999999999
len(reference) = 799
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.441
SUFF++ for r=0.4 class 0 = 0.73 +- 0.252 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.4 class 1 = 0.895 +- 0.252 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.4 class 2 = 0.761 +- 0.252 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.4 all KL = 0.803 +- 0.252 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.4 all L1 = 0.796 +- 0.212 (in-sample avg dev_std = 0.423)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.676
Model XAI F1 of binarized graphs for r=0.6 =  0.62505875
Model XAI WIoU of binarized graphs for r=0.6 =  0.593855
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.629
SUFF++ for r=0.6 class 0 = 0.74 +- 0.232 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 1 = 0.864 +- 0.232 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 2 = 0.759 +- 0.232 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all KL = 0.799 +- 0.232 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all L1 = 0.788 +- 0.204 (in-sample avg dev_std = 0.432)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  0.53213125
Model XAI WIoU of binarized graphs for r=0.9 =  0.59742875
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.799
SUFF++ for r=0.9 class 0 = 0.837 +- 0.178 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.9 class 1 = 0.926 +- 0.178 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.9 class 2 = 0.909 +- 0.178 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.9 all KL = 0.911 +- 0.178 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.9 all L1 = 0.891 +- 0.174 (in-sample avg dev_std = 0.268)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.841
Model XAI F1 of binarized graphs for r=0.95 =  0.5185225
Model XAI WIoU of binarized graphs for r=0.95 =  0.59737625
len(reference) = 706
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.847
SUFF++ for r=0.95 class 0 = 0.862 +- 0.165 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.95 class 1 = 0.952 +- 0.165 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.95 class 2 = 0.929 +- 0.165 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.95 all KL = 0.927 +- 0.165 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.95 all L1 = 0.913 +- 0.154 (in-sample avg dev_std = 0.248)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.671
Model XAI F1 of binarized graphs for r=0.3 =  0.277145
Model XAI WIoU of binarized graphs for r=0.3 =  0.21495
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.636
SUFF++ for r=0.3 class 0 = 0.707 +- 0.179 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 1 = 0.8 +- 0.179 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 2 = 0.701 +- 0.179 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 all KL = 0.816 +- 0.179 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 all L1 = 0.737 +- 0.153 (in-sample avg dev_std = 0.364)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.611
Model XAI F1 of binarized graphs for r=0.4 =  0.235445
Model XAI WIoU of binarized graphs for r=0.4 =  0.18960124999999997
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.637
SUFF++ for r=0.4 class 0 = 0.593 +- 0.210 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.4 class 1 = 0.674 +- 0.210 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.4 class 2 = 0.666 +- 0.210 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.4 all KL = 0.728 +- 0.210 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.4 all L1 = 0.644 +- 0.177 (in-sample avg dev_std = 0.433)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.464
Model XAI F1 of binarized graphs for r=0.6 =  0.17305625
Model XAI WIoU of binarized graphs for r=0.6 =  0.16601999999999997
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.546
SUFF++ for r=0.6 class 0 = 0.65 +- 0.247 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 class 1 = 0.801 +- 0.247 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 class 2 = 0.764 +- 0.247 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 all KL = 0.719 +- 0.247 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.6 all L1 = 0.738 +- 0.210 (in-sample avg dev_std = 0.362)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.368
Model XAI F1 of binarized graphs for r=0.9 =  0.12338625
Model XAI WIoU of binarized graphs for r=0.9 =  0.14814875
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.398
SUFF++ for r=0.9 class 0 = 0.799 +- 0.221 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.9 class 1 = 0.831 +- 0.221 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.9 class 2 = 0.854 +- 0.221 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.9 all KL = 0.832 +- 0.221 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.9 all L1 = 0.827 +- 0.180 (in-sample avg dev_std = 0.355)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.369
Model XAI F1 of binarized graphs for r=0.95 =  0.11797875000000001
Model XAI WIoU of binarized graphs for r=0.95 =  0.14613875
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.384
SUFF++ for r=0.95 class 0 = 0.884 +- 0.194 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.95 class 1 = 0.868 +- 0.194 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.95 class 2 = 0.916 +- 0.194 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.95 all KL = 0.895 +- 0.194 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.95 all L1 = 0.889 +- 0.155 (in-sample avg dev_std = 0.231)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 14:01:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:18 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:30 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:33 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:35 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:38 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:01:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 02:01:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.425
WIoU for r=0.3 = 0.365
F1 for r=0.4 = 0.433
WIoU for r=0.4 = 0.372
F1 for r=0.6 = 0.434
WIoU for r=0.6 = 0.376
F1 for r=0.9 = 0.476
WIoU for r=0.9 = 0.416
F1 for r=0.95 = 0.490
WIoU for r=0.95 = 0.418
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.419
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.167
WIoU for r=0.3 = 0.250
F1 for r=0.4 = 0.148
WIoU for r=0.4 = 0.249
F1 for r=0.6 = 0.134
WIoU for r=0.6 = 0.256
F1 for r=0.9 = 0.102
WIoU for r=0.9 = 0.257
F1 for r=0.95 = 0.104
WIoU for r=0.95 = 0.260
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.262


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.464
Model XAI F1 of binarized graphs for r=0.3 =  0.42458125
Model XAI WIoU of binarized graphs for r=0.3 =  0.36473875
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.355
NEC for r=0.3 class 0 = 0.473 +- 0.361 (in-sample avg dev_std = 0.383)
NEC for r=0.3 class 1 = 0.213 +- 0.361 (in-sample avg dev_std = 0.383)
NEC for r=0.3 class 2 = 0.367 +- 0.361 (in-sample avg dev_std = 0.383)
NEC for r=0.3 all KL = 0.358 +- 0.361 (in-sample avg dev_std = 0.383)
NEC for r=0.3 all L1 = 0.35 +- 0.316 (in-sample avg dev_std = 0.383)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.506
Model XAI F1 of binarized graphs for r=0.4 =  0.43265125
Model XAI WIoU of binarized graphs for r=0.4 =  0.37166499999999997
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.374
NEC for r=0.4 class 0 = 0.544 +- 0.353 (in-sample avg dev_std = 0.481)
NEC for r=0.4 class 1 = 0.29 +- 0.353 (in-sample avg dev_std = 0.481)
NEC for r=0.4 class 2 = 0.489 +- 0.353 (in-sample avg dev_std = 0.481)
NEC for r=0.4 all KL = 0.457 +- 0.353 (in-sample avg dev_std = 0.481)
NEC for r=0.4 all L1 = 0.44 +- 0.291 (in-sample avg dev_std = 0.481)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.582
Model XAI F1 of binarized graphs for r=0.6 =  0.43366374999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.37588875
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.442
NEC for r=0.6 class 0 = 0.634 +- 0.314 (in-sample avg dev_std = 0.514)
NEC for r=0.6 class 1 = 0.338 +- 0.314 (in-sample avg dev_std = 0.514)
NEC for r=0.6 class 2 = 0.564 +- 0.314 (in-sample avg dev_std = 0.514)
NEC for r=0.6 all KL = 0.51 +- 0.314 (in-sample avg dev_std = 0.514)
NEC for r=0.6 all L1 = 0.511 +- 0.253 (in-sample avg dev_std = 0.514)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.47570999999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.4158725
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.54
NEC for r=0.9 class 0 = 0.612 +- 0.320 (in-sample avg dev_std = 0.634)
NEC for r=0.9 class 1 = 0.256 +- 0.320 (in-sample avg dev_std = 0.634)
NEC for r=0.9 class 2 = 0.609 +- 0.320 (in-sample avg dev_std = 0.634)
NEC for r=0.9 all KL = 0.556 +- 0.320 (in-sample avg dev_std = 0.634)
NEC for r=0.9 all L1 = 0.491 +- 0.256 (in-sample avg dev_std = 0.634)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.921
Model XAI F1 of binarized graphs for r=0.95 =  0.49036625
Model XAI WIoU of binarized graphs for r=0.95 =  0.41792124999999997
len(reference) = 800
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.555
NEC for r=0.95 class 0 = 0.607 +- 0.311 (in-sample avg dev_std = 0.661)
NEC for r=0.95 class 1 = 0.264 +- 0.311 (in-sample avg dev_std = 0.661)
NEC for r=0.95 class 2 = 0.597 +- 0.311 (in-sample avg dev_std = 0.661)
NEC for r=0.95 all KL = 0.566 +- 0.311 (in-sample avg dev_std = 0.661)
NEC for r=0.95 all L1 = 0.488 +- 0.247 (in-sample avg dev_std = 0.661)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.936
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.4187075
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.558
NEC for r=1.0 class 0 = 0.601 +- 0.301 (in-sample avg dev_std = 0.675)
NEC for r=1.0 class 1 = 0.282 +- 0.301 (in-sample avg dev_std = 0.675)
NEC for r=1.0 class 2 = 0.591 +- 0.301 (in-sample avg dev_std = 0.675)
NEC for r=1.0 all KL = 0.574 +- 0.301 (in-sample avg dev_std = 0.675)
NEC for r=1.0 all L1 = 0.49 +- 0.236 (in-sample avg dev_std = 0.675)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.436
Model XAI F1 of binarized graphs for r=0.3 =  0.16687249999999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.2496975
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.363
NEC for r=0.3 class 0 = 0.52 +- 0.380 (in-sample avg dev_std = 0.387)
NEC for r=0.3 class 1 = 0.425 +- 0.380 (in-sample avg dev_std = 0.387)
NEC for r=0.3 class 2 = 0.53 +- 0.380 (in-sample avg dev_std = 0.387)
NEC for r=0.3 all KL = 0.521 +- 0.380 (in-sample avg dev_std = 0.387)
NEC for r=0.3 all L1 = 0.491 +- 0.319 (in-sample avg dev_std = 0.387)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.436
Model XAI F1 of binarized graphs for r=0.4 =  0.148415
Model XAI WIoU of binarized graphs for r=0.4 =  0.249155
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.354
NEC for r=0.4 class 0 = 0.527 +- 0.400 (in-sample avg dev_std = 0.391)
NEC for r=0.4 class 1 = 0.469 +- 0.400 (in-sample avg dev_std = 0.391)
NEC for r=0.4 class 2 = 0.54 +- 0.400 (in-sample avg dev_std = 0.391)
NEC for r=0.4 all KL = 0.587 +- 0.400 (in-sample avg dev_std = 0.391)
NEC for r=0.4 all L1 = 0.511 +- 0.323 (in-sample avg dev_std = 0.391)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.394
Model XAI F1 of binarized graphs for r=0.6 =  0.1338175
Model XAI WIoU of binarized graphs for r=0.6 =  0.2557825
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.366
NEC for r=0.6 class 0 = 0.573 +- 0.369 (in-sample avg dev_std = 0.448)
NEC for r=0.6 class 1 = 0.516 +- 0.369 (in-sample avg dev_std = 0.448)
NEC for r=0.6 class 2 = 0.537 +- 0.369 (in-sample avg dev_std = 0.448)
NEC for r=0.6 all KL = 0.585 +- 0.369 (in-sample avg dev_std = 0.448)
NEC for r=0.6 all L1 = 0.542 +- 0.248 (in-sample avg dev_std = 0.448)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.419
Model XAI F1 of binarized graphs for r=0.9 =  0.101945
Model XAI WIoU of binarized graphs for r=0.9 =  0.25745125
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.344
NEC for r=0.9 class 0 = 0.462 +- 0.337 (in-sample avg dev_std = 0.423)
NEC for r=0.9 class 1 = 0.424 +- 0.337 (in-sample avg dev_std = 0.423)
NEC for r=0.9 class 2 = 0.373 +- 0.337 (in-sample avg dev_std = 0.423)
NEC for r=0.9 all KL = 0.421 +- 0.337 (in-sample avg dev_std = 0.423)
NEC for r=0.9 all L1 = 0.421 +- 0.234 (in-sample avg dev_std = 0.423)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.449
Model XAI F1 of binarized graphs for r=0.95 =  0.10434000000000002
Model XAI WIoU of binarized graphs for r=0.95 =  0.2602125
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.351
NEC for r=0.95 class 0 = 0.493 +- 0.356 (in-sample avg dev_std = 0.414)
NEC for r=0.95 class 1 = 0.471 +- 0.356 (in-sample avg dev_std = 0.414)
NEC for r=0.95 class 2 = 0.358 +- 0.356 (in-sample avg dev_std = 0.414)
NEC for r=0.95 all KL = 0.48 +- 0.356 (in-sample avg dev_std = 0.414)
NEC for r=0.95 all L1 = 0.443 +- 0.259 (in-sample avg dev_std = 0.414)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.509
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.26247375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.356
NEC for r=1.0 class 0 = 0.48 +- 0.346 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 1 = 0.476 +- 0.346 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 2 = 0.349 +- 0.346 (in-sample avg dev_std = 0.426)
NEC for r=1.0 all KL = 0.479 +- 0.346 (in-sample avg dev_std = 0.426)
NEC for r=1.0 all L1 = 0.437 +- 0.252 (in-sample avg dev_std = 0.426)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.467
Model XAI F1 of binarized graphs for r=0.3 =  0.42458125
Model XAI WIoU of binarized graphs for r=0.3 =  0.36473875
len(reference) = 792
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.412
SUFF++ for r=0.3 class 0 = 0.578 +- 0.320 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 1 = 0.777 +- 0.320 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 2 = 0.742 +- 0.320 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 all KL = 0.693 +- 0.320 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 all L1 = 0.698 +- 0.280 (in-sample avg dev_std = 0.442)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.509
Model XAI F1 of binarized graphs for r=0.4 =  0.43265125
Model XAI WIoU of binarized graphs for r=0.4 =  0.37166499999999997
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.435
SUFF++ for r=0.4 class 0 = 0.511 +- 0.315 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.4 class 1 = 0.694 +- 0.315 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.4 class 2 = 0.651 +- 0.315 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.4 all KL = 0.605 +- 0.315 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.4 all L1 = 0.619 +- 0.261 (in-sample avg dev_std = 0.522)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.581
Model XAI F1 of binarized graphs for r=0.6 =  0.43366374999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.37588875
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.47
SUFF++ for r=0.6 class 0 = 0.384 +- 0.272 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.6 class 1 = 0.616 +- 0.272 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.6 class 2 = 0.543 +- 0.272 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.6 all KL = 0.523 +- 0.272 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.6 all L1 = 0.514 +- 0.224 (in-sample avg dev_std = 0.536)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.47570999999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.4158725
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.732
SUFF++ for r=0.9 class 0 = 0.636 +- 0.294 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.9 class 1 = 0.754 +- 0.294 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.9 class 2 = 0.713 +- 0.294 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.9 all KL = 0.689 +- 0.294 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.9 all L1 = 0.701 +- 0.243 (in-sample avg dev_std = 0.509)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.915
Model XAI F1 of binarized graphs for r=0.95 =  0.49036625
Model XAI WIoU of binarized graphs for r=0.95 =  0.41792124999999997
len(reference) = 706
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.793
SUFF++ for r=0.95 class 0 = 0.654 +- 0.277 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.95 class 1 = 0.844 +- 0.277 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.95 class 2 = 0.852 +- 0.277 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.95 all KL = 0.771 +- 0.277 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.95 all L1 = 0.782 +- 0.232 (in-sample avg dev_std = 0.462)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.434
Model XAI F1 of binarized graphs for r=0.3 =  0.16687249999999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.2496975
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.433
SUFF++ for r=0.3 class 0 = 0.526 +- 0.325 (in-sample avg dev_std = 0.598)
SUFF++ for r=0.3 class 1 = 0.552 +- 0.325 (in-sample avg dev_std = 0.598)
SUFF++ for r=0.3 class 2 = 0.581 +- 0.325 (in-sample avg dev_std = 0.598)
SUFF++ for r=0.3 all KL = 0.476 +- 0.325 (in-sample avg dev_std = 0.598)
SUFF++ for r=0.3 all L1 = 0.552 +- 0.247 (in-sample avg dev_std = 0.598)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.436
Model XAI F1 of binarized graphs for r=0.4 =  0.148415
Model XAI WIoU of binarized graphs for r=0.4 =  0.249155
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.426
SUFF++ for r=0.4 class 0 = 0.572 +- 0.331 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.4 class 1 = 0.589 +- 0.331 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.4 class 2 = 0.595 +- 0.331 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.4 all KL = 0.525 +- 0.331 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.4 all L1 = 0.585 +- 0.239 (in-sample avg dev_std = 0.521)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.394
Model XAI F1 of binarized graphs for r=0.6 =  0.1338175
Model XAI WIoU of binarized graphs for r=0.6 =  0.2557825
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.431
SUFF++ for r=0.6 class 0 = 0.496 +- 0.281 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 class 1 = 0.561 +- 0.281 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 class 2 = 0.556 +- 0.281 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 all KL = 0.496 +- 0.281 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 all L1 = 0.537 +- 0.205 (in-sample avg dev_std = 0.534)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.419
Model XAI F1 of binarized graphs for r=0.9 =  0.101945
Model XAI WIoU of binarized graphs for r=0.9 =  0.25745125
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.406
SUFF++ for r=0.9 class 0 = 0.718 +- 0.214 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.9 class 1 = 0.754 +- 0.214 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.9 class 2 = 0.734 +- 0.214 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.9 all KL = 0.779 +- 0.214 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.9 all L1 = 0.736 +- 0.205 (in-sample avg dev_std = 0.351)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.449
Model XAI F1 of binarized graphs for r=0.95 =  0.10434000000000002
Model XAI WIoU of binarized graphs for r=0.95 =  0.2602125
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.42
SUFF++ for r=0.95 class 0 = 0.759 +- 0.261 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.95 class 1 = 0.769 +- 0.261 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.95 class 2 = 0.775 +- 0.261 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.95 all KL = 0.787 +- 0.261 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.95 all L1 = 0.768 +- 0.230 (in-sample avg dev_std = 0.343)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 14:08:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:31 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:43 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:45 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:47 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:50 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 02:08:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.330
WIoU for r=0.3 = 0.252
F1 for r=0.4 = 0.359
WIoU for r=0.4 = 0.272
F1 for r=0.6 = 0.427
WIoU for r=0.6 = 0.324
F1 for r=0.9 = 0.510
WIoU for r=0.9 = 0.405
F1 for r=0.95 = 0.509
WIoU for r=0.95 = 0.406
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.407
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.187
WIoU for r=0.3 = 0.261
F1 for r=0.4 = 0.165
WIoU for r=0.4 = 0.252
F1 for r=0.6 = 0.139
WIoU for r=0.6 = 0.247
F1 for r=0.9 = 0.113
WIoU for r=0.9 = 0.239
F1 for r=0.95 = 0.110
WIoU for r=0.95 = 0.238
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.239


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.33
Model XAI F1 of binarized graphs for r=0.3 =  0.3295225
Model XAI WIoU of binarized graphs for r=0.3 =  0.25154375
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.299
NEC for r=0.3 class 0 = 0.25 +- 0.185 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 1 = 0.217 +- 0.185 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 2 = 0.203 +- 0.185 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all KL = 0.114 +- 0.185 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all L1 = 0.224 +- 0.187 (in-sample avg dev_std = 0.195)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.331
Model XAI F1 of binarized graphs for r=0.4 =  0.35879749999999994
Model XAI WIoU of binarized graphs for r=0.4 =  0.27236
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.326
NEC for r=0.4 class 0 = 0.31 +- 0.252 (in-sample avg dev_std = 0.327)
NEC for r=0.4 class 1 = 0.256 +- 0.252 (in-sample avg dev_std = 0.327)
NEC for r=0.4 class 2 = 0.266 +- 0.252 (in-sample avg dev_std = 0.327)
NEC for r=0.4 all KL = 0.2 +- 0.252 (in-sample avg dev_std = 0.327)
NEC for r=0.4 all L1 = 0.277 +- 0.218 (in-sample avg dev_std = 0.327)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.412
Model XAI F1 of binarized graphs for r=0.6 =  0.42664
Model XAI WIoU of binarized graphs for r=0.6 =  0.324205
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.388
NEC for r=0.6 class 0 = 0.465 +- 0.295 (in-sample avg dev_std = 0.471)
NEC for r=0.6 class 1 = 0.368 +- 0.295 (in-sample avg dev_std = 0.471)
NEC for r=0.6 class 2 = 0.449 +- 0.295 (in-sample avg dev_std = 0.471)
NEC for r=0.6 all KL = 0.376 +- 0.295 (in-sample avg dev_std = 0.471)
NEC for r=0.6 all L1 = 0.427 +- 0.221 (in-sample avg dev_std = 0.471)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.729
Model XAI F1 of binarized graphs for r=0.9 =  0.51031375
Model XAI WIoU of binarized graphs for r=0.9 =  0.40528625000000007
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.491
NEC for r=0.9 class 0 = 0.627 +- 0.312 (in-sample avg dev_std = 0.549)
NEC for r=0.9 class 1 = 0.266 +- 0.312 (in-sample avg dev_std = 0.549)
NEC for r=0.9 class 2 = 0.602 +- 0.312 (in-sample avg dev_std = 0.549)
NEC for r=0.9 all KL = 0.503 +- 0.312 (in-sample avg dev_std = 0.549)
NEC for r=0.9 all L1 = 0.497 +- 0.245 (in-sample avg dev_std = 0.549)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.82
Model XAI F1 of binarized graphs for r=0.95 =  0.50870625
Model XAI WIoU of binarized graphs for r=0.95 =  0.40598749999999995
len(reference) = 800
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.54
NEC for r=0.95 class 0 = 0.611 +- 0.318 (in-sample avg dev_std = 0.578)
NEC for r=0.95 class 1 = 0.253 +- 0.318 (in-sample avg dev_std = 0.578)
NEC for r=0.95 class 2 = 0.628 +- 0.318 (in-sample avg dev_std = 0.578)
NEC for r=0.95 all KL = 0.52 +- 0.318 (in-sample avg dev_std = 0.578)
NEC for r=0.95 all L1 = 0.496 +- 0.247 (in-sample avg dev_std = 0.578)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.908
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.40675125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.561
NEC for r=1.0 class 0 = 0.596 +- 0.326 (in-sample avg dev_std = 0.603)
NEC for r=1.0 class 1 = 0.239 +- 0.326 (in-sample avg dev_std = 0.603)
NEC for r=1.0 class 2 = 0.595 +- 0.326 (in-sample avg dev_std = 0.603)
NEC for r=1.0 all KL = 0.517 +- 0.326 (in-sample avg dev_std = 0.603)
NEC for r=1.0 all L1 = 0.475 +- 0.249 (in-sample avg dev_std = 0.603)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.504
Model XAI F1 of binarized graphs for r=0.3 =  0.18709125000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.26083625
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.332
NEC for r=0.3 class 0 = 0.374 +- 0.361 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 1 = 0.227 +- 0.361 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 2 = 0.455 +- 0.361 (in-sample avg dev_std = 0.216)
NEC for r=0.3 all KL = 0.312 +- 0.361 (in-sample avg dev_std = 0.216)
NEC for r=0.3 all L1 = 0.349 +- 0.305 (in-sample avg dev_std = 0.216)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.488
Model XAI F1 of binarized graphs for r=0.4 =  0.1646125
Model XAI WIoU of binarized graphs for r=0.4 =  0.25187875
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.332
NEC for r=0.4 class 0 = 0.331 +- 0.331 (in-sample avg dev_std = 0.226)
NEC for r=0.4 class 1 = 0.158 +- 0.331 (in-sample avg dev_std = 0.226)
NEC for r=0.4 class 2 = 0.403 +- 0.331 (in-sample avg dev_std = 0.226)
NEC for r=0.4 all KL = 0.289 +- 0.331 (in-sample avg dev_std = 0.226)
NEC for r=0.4 all L1 = 0.294 +- 0.277 (in-sample avg dev_std = 0.226)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.447
Model XAI F1 of binarized graphs for r=0.6 =  0.13887
Model XAI WIoU of binarized graphs for r=0.6 =  0.24737749999999997
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.364
NEC for r=0.6 class 0 = 0.281 +- 0.270 (in-sample avg dev_std = 0.369)
NEC for r=0.6 class 1 = 0.192 +- 0.270 (in-sample avg dev_std = 0.369)
NEC for r=0.6 class 2 = 0.344 +- 0.270 (in-sample avg dev_std = 0.369)
NEC for r=0.6 all KL = 0.228 +- 0.270 (in-sample avg dev_std = 0.369)
NEC for r=0.6 all L1 = 0.27 +- 0.253 (in-sample avg dev_std = 0.369)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.391
Model XAI F1 of binarized graphs for r=0.9 =  0.1129725
Model XAI WIoU of binarized graphs for r=0.9 =  0.23908875000000002
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.37
NEC for r=0.9 class 0 = 0.214 +- 0.274 (in-sample avg dev_std = 0.370)
NEC for r=0.9 class 1 = 0.214 +- 0.274 (in-sample avg dev_std = 0.370)
NEC for r=0.9 class 2 = 0.271 +- 0.274 (in-sample avg dev_std = 0.370)
NEC for r=0.9 all KL = 0.255 +- 0.274 (in-sample avg dev_std = 0.370)
NEC for r=0.9 all L1 = 0.232 +- 0.200 (in-sample avg dev_std = 0.370)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.395
Model XAI F1 of binarized graphs for r=0.95 =  0.10950750000000001
Model XAI WIoU of binarized graphs for r=0.95 =  0.2375325
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.364
NEC for r=0.95 class 0 = 0.273 +- 0.291 (in-sample avg dev_std = 0.367)
NEC for r=0.95 class 1 = 0.331 +- 0.291 (in-sample avg dev_std = 0.367)
NEC for r=0.95 class 2 = 0.339 +- 0.291 (in-sample avg dev_std = 0.367)
NEC for r=0.95 all KL = 0.304 +- 0.291 (in-sample avg dev_std = 0.367)
NEC for r=0.95 all L1 = 0.314 +- 0.243 (in-sample avg dev_std = 0.367)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.414
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.23854
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.379
NEC for r=1.0 class 0 = 0.31 +- 0.307 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 1 = 0.352 +- 0.307 (in-sample avg dev_std = 0.395)
NEC for r=1.0 class 2 = 0.316 +- 0.307 (in-sample avg dev_std = 0.395)
NEC for r=1.0 all KL = 0.326 +- 0.307 (in-sample avg dev_std = 0.395)
NEC for r=1.0 all L1 = 0.326 +- 0.246 (in-sample avg dev_std = 0.395)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.332
Model XAI F1 of binarized graphs for r=0.3 =  0.3295225
Model XAI WIoU of binarized graphs for r=0.3 =  0.25154375
len(reference) = 792
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.342
SUFF++ for r=0.3 class 0 = 0.729 +- 0.161 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 1 = 0.759 +- 0.161 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 class 2 = 0.775 +- 0.161 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 all KL = 0.861 +- 0.161 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.3 all L1 = 0.754 +- 0.150 (in-sample avg dev_std = 0.314)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.331
Model XAI F1 of binarized graphs for r=0.4 =  0.35879749999999994
Model XAI WIoU of binarized graphs for r=0.4 =  0.27236
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.369
SUFF++ for r=0.4 class 0 = 0.663 +- 0.222 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.4 class 1 = 0.704 +- 0.222 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.4 class 2 = 0.728 +- 0.222 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.4 all KL = 0.772 +- 0.222 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.4 all L1 = 0.698 +- 0.178 (in-sample avg dev_std = 0.430)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.41
Model XAI F1 of binarized graphs for r=0.6 =  0.42664
Model XAI WIoU of binarized graphs for r=0.6 =  0.324205
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.408
SUFF++ for r=0.6 class 0 = 0.564 +- 0.265 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.6 class 1 = 0.633 +- 0.265 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.6 class 2 = 0.568 +- 0.265 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.6 all KL = 0.633 +- 0.265 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.6 all L1 = 0.588 +- 0.195 (in-sample avg dev_std = 0.520)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.729
Model XAI F1 of binarized graphs for r=0.9 =  0.51031375
Model XAI WIoU of binarized graphs for r=0.9 =  0.40528625000000007
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.654
SUFF++ for r=0.9 class 0 = 0.578 +- 0.303 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 1 = 0.814 +- 0.303 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 2 = 0.61 +- 0.303 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 all KL = 0.676 +- 0.303 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 all L1 = 0.668 +- 0.268 (in-sample avg dev_std = 0.475)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.797
Model XAI F1 of binarized graphs for r=0.95 =  0.50870625
Model XAI WIoU of binarized graphs for r=0.95 =  0.40598749999999995
len(reference) = 706
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.753
SUFF++ for r=0.95 class 0 = 0.739 +- 0.258 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.95 class 1 = 0.905 +- 0.258 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.95 class 2 = 0.741 +- 0.258 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.95 all KL = 0.806 +- 0.258 (in-sample avg dev_std = 0.400)
SUFF++ for r=0.95 all L1 = 0.793 +- 0.226 (in-sample avg dev_std = 0.400)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.504
Model XAI F1 of binarized graphs for r=0.3 =  0.18709125000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.26083625
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.447
SUFF++ for r=0.3 class 0 = 0.574 +- 0.285 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 1 = 0.672 +- 0.285 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 class 2 = 0.608 +- 0.285 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 all KL = 0.585 +- 0.285 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.3 all L1 = 0.618 +- 0.174 (in-sample avg dev_std = 0.594)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.488
Model XAI F1 of binarized graphs for r=0.4 =  0.1646125
Model XAI WIoU of binarized graphs for r=0.4 =  0.25187875
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.443
SUFF++ for r=0.4 class 0 = 0.655 +- 0.245 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.4 class 1 = 0.766 +- 0.245 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.4 class 2 = 0.72 +- 0.245 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.4 all KL = 0.653 +- 0.245 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.4 all L1 = 0.714 +- 0.179 (in-sample avg dev_std = 0.501)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.447
Model XAI F1 of binarized graphs for r=0.6 =  0.13887
Model XAI WIoU of binarized graphs for r=0.6 =  0.24737749999999997
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.442
SUFF++ for r=0.6 class 0 = 0.718 +- 0.217 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 class 1 = 0.815 +- 0.217 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 class 2 = 0.753 +- 0.217 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 all KL = 0.803 +- 0.217 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 all L1 = 0.763 +- 0.224 (in-sample avg dev_std = 0.404)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.391
Model XAI F1 of binarized graphs for r=0.9 =  0.1129725
Model XAI WIoU of binarized graphs for r=0.9 =  0.23908875000000002
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.402
SUFF++ for r=0.9 class 0 = 0.886 +- 0.162 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 class 1 = 0.891 +- 0.162 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 class 2 = 0.899 +- 0.162 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all KL = 0.91 +- 0.162 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all L1 = 0.892 +- 0.129 (in-sample avg dev_std = 0.189)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.395
Model XAI F1 of binarized graphs for r=0.95 =  0.10950750000000001
Model XAI WIoU of binarized graphs for r=0.95 =  0.2375325
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.403
SUFF++ for r=0.95 class 0 = 0.866 +- 0.148 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.95 class 1 = 0.861 +- 0.148 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.95 class 2 = 0.875 +- 0.148 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.95 all KL = 0.922 +- 0.148 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.95 all L1 = 0.867 +- 0.182 (in-sample avg dev_std = 0.191)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.122, 0.165, 0.317, 0.515, 0.504, 0.492], 'all_L1': [0.245, 0.248, 0.354, 0.514, 0.501, 0.481]}), defaultdict(<class 'list'>, {'all_KL': [0.096, 0.17, 0.362, 0.535, 0.56, 0.541], 'all_L1': [0.199, 0.247, 0.399, 0.501, 0.515, 0.501]}), defaultdict(<class 'list'>, {'all_KL': [0.112, 0.227, 0.443, 0.548, 0.559, 0.569], 'all_L1': [0.157, 0.252, 0.432, 0.495, 0.492, 0.489]}), defaultdict(<class 'list'>, {'all_KL': [0.358, 0.457, 0.51, 0.556, 0.566, 0.574], 'all_L1': [0.35, 0.44, 0.511, 0.491, 0.488, 0.49]}), defaultdict(<class 'list'>, {'all_KL': [0.114, 0.2, 0.376, 0.503, 0.52, 0.517], 'all_L1': [0.224, 0.277, 0.427, 0.497, 0.496, 0.475]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.894, 0.868, 0.818, 0.874, 0.917, 1.0], 'all_L1': [0.777, 0.787, 0.773, 0.821, 0.865, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.911, 0.869, 0.758, 0.863, 0.914, 1.0], 'all_L1': [0.802, 0.795, 0.726, 0.834, 0.877, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.895, 0.803, 0.799, 0.911, 0.927, 1.0], 'all_L1': [0.871, 0.796, 0.788, 0.891, 0.913, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.693, 0.605, 0.523, 0.689, 0.771, 1.0], 'all_L1': [0.698, 0.619, 0.514, 0.701, 0.782, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.861, 0.772, 0.633, 0.676, 0.806, 1.0], 'all_L1': [0.754, 0.698, 0.588, 0.668, 0.793, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]

Eval split test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.144, 0.152, 0.384, 0.358, 0.373, 0.411], 'all_L1': [0.187, 0.184, 0.342, 0.253, 0.233, 0.263]}), defaultdict(<class 'list'>, {'all_KL': [0.388, 0.37, 0.244, 0.195, 0.196, 0.173], 'all_L1': [0.414, 0.362, 0.24, 0.162, 0.158, 0.135]}), defaultdict(<class 'list'>, {'all_KL': [0.373, 0.345, 0.27, 0.205, 0.24, 0.328], 'all_L1': [0.4, 0.425, 0.274, 0.245, 0.26, 0.335]}), defaultdict(<class 'list'>, {'all_KL': [0.521, 0.587, 0.585, 0.421, 0.48, 0.479], 'all_L1': [0.491, 0.511, 0.542, 0.421, 0.443, 0.437]}), defaultdict(<class 'list'>, {'all_KL': [0.312, 0.289, 0.228, 0.255, 0.304, 0.326], 'all_L1': [0.349, 0.294, 0.27, 0.232, 0.314, 0.326]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.899, 0.871, 0.522, 0.581, 0.849, 1.0], 'all_L1': [0.843, 0.837, 0.61, 0.732, 0.883, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.546, 0.528, 0.661, 0.811, 0.897, 1.0], 'all_L1': [0.577, 0.624, 0.696, 0.845, 0.887, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.816, 0.728, 0.719, 0.832, 0.895, 1.0], 'all_L1': [0.737, 0.644, 0.738, 0.827, 0.889, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.476, 0.525, 0.496, 0.779, 0.787, 1.0], 'all_L1': [0.552, 0.585, 0.537, 0.736, 0.768, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.585, 0.653, 0.803, 0.91, 0.922, 1.0], 'all_L1': [0.618, 0.714, 0.763, 0.892, 0.867, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.235 +- 0.065, 0.293 +- 0.074, 0.425 +- 0.051, 0.500 +- 0.008, 0.498 +- 0.009, 0.487 +- 0.009
nec class all_KL  =  0.160 +- 0.099, 0.244 +- 0.109, 0.402 +- 0.068, 0.531 +- 0.020, 0.542 +- 0.025, 0.539 +- 0.031
nec_acc_int  =  0.336 +- 0.019, 0.352 +- 0.016, 0.414 +- 0.019, 0.507 +- 0.019, 0.530 +- 0.016, 0.551 +- 0.009
suff++ class all_L1  =  0.780 +- 0.057, 0.739 +- 0.070, 0.678 +- 0.108, 0.783 +- 0.084, 0.846 +- 0.050, 1.000 +- 0.000
suff++ class all_KL  =  0.851 +- 0.081, 0.783 +- 0.097, 0.706 +- 0.112, 0.803 +- 0.099, 0.867 +- 0.065, 1.000 +- 0.000
suff++_acc_int  =  0.366 +- 0.024, 0.410 +- 0.026, 0.504 +- 0.073, 0.751 +- 0.054, 0.805 +- 0.031

Eval split test
nec class all_L1  =  0.368 +- 0.101, 0.355 +- 0.112, 0.334 +- 0.109, 0.263 +- 0.085, 0.282 +- 0.095, 0.299 +- 0.099
nec class all_KL  =  0.348 +- 0.123, 0.349 +- 0.141, 0.342 +- 0.133, 0.287 +- 0.089, 0.319 +- 0.100, 0.343 +- 0.103
nec_acc_int  =  0.350 +- 0.010, 0.352 +- 0.010, 0.361 +- 0.006, 0.353 +- 0.009, 0.353 +- 0.007, 0.357 +- 0.012
suff++ class all_L1  =  0.665 +- 0.109, 0.681 +- 0.089, 0.669 +- 0.084, 0.806 +- 0.063, 0.859 +- 0.046, 1.000 +- 0.000
suff++ class all_KL  =  0.664 +- 0.164, 0.661 +- 0.130, 0.640 +- 0.117, 0.783 +- 0.110, 0.870 +- 0.048, 1.000 +- 0.000
suff++_acc_int  =  0.499 +- 0.088, 0.476 +- 0.085, 0.454 +- 0.054, 0.391 +- 0.014, 0.389 +- 0.023


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.508 +- 0.012, 0.516 +- 0.015, 0.551 +- 0.038, 0.641 +- 0.044, 0.672 +- 0.027, 0.744 +- 0.004
Faith. Armon (L1)= 		  =  0.354 +- 0.066, 0.410 +- 0.053, 0.513 +- 0.025, 0.608 +- 0.029, 0.627 +- 0.018, 0.655 +- 0.008
Faith. GMean (L1)= 	  =  0.422 +- 0.042, 0.459 +- 0.032, 0.532 +- 0.029, 0.625 +- 0.036, 0.649 +- 0.022, 0.698 +- 0.006
Faith. Aritm (KL)= 		  =  0.506 +- 0.012, 0.514 +- 0.015, 0.554 +- 0.041, 0.667 +- 0.052, 0.704 +- 0.033, 0.769 +- 0.016
Faith. Armon (KL)= 		  =  0.252 +- 0.111, 0.351 +- 0.089, 0.501 +- 0.040, 0.637 +- 0.037, 0.665 +- 0.026, 0.700 +- 0.026
Faith. GMean (KL)= 	  =  0.351 +- 0.074, 0.422 +- 0.055, 0.526 +- 0.036, 0.652 +- 0.045, 0.685 +- 0.029, 0.734 +- 0.021

Eval split test
Faith. Aritm (L1)= 		  =  0.517 +- 0.029, 0.518 +- 0.020, 0.501 +- 0.026, 0.535 +- 0.033, 0.570 +- 0.029, 0.650 +- 0.050
Faith. Armon (L1)= 		  =  0.455 +- 0.079, 0.447 +- 0.085, 0.427 +- 0.062, 0.386 +- 0.085, 0.412 +- 0.097, 0.451 +- 0.123
Faith. GMean (L1)= 	  =  0.483 +- 0.051, 0.479 +- 0.054, 0.462 +- 0.043, 0.452 +- 0.060, 0.483 +- 0.070, 0.538 +- 0.098
Faith. Aritm (KL)= 		  =  0.506 +- 0.051, 0.505 +- 0.040, 0.491 +- 0.035, 0.535 +- 0.049, 0.594 +- 0.032, 0.672 +- 0.051
Faith. Armon (KL)= 		  =  0.424 +- 0.095, 0.423 +- 0.097, 0.417 +- 0.068, 0.406 +- 0.084, 0.454 +- 0.098, 0.502 +- 0.119
Faith. GMean (KL)= 	  =  0.459 +- 0.065, 0.459 +- 0.065, 0.451 +- 0.046, 0.464 +- 0.062, 0.518 +- 0.070, 0.579 +- 0.093
Computed for split load_split = id



Completed in  0:36:02.160135  for LECIvGIN GOODMotif/size



DONE LECI GOODMotif/size

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 14:15:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 02:15:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 02:15:51 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 02:15:53 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 02:15:55 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 02:15:59 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 02:16:05 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 02:16:05 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 02:16:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:16:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:16:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:16:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:16:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:16:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:16:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:16:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3249
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3247
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4865
OOD Test ACCURACY: 0.4907
OOD Test Loss: 2.1636

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3304
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3315
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4661
OOD Test ACCURACY: 0.5197
OOD Test Loss: 1.7017

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4907 0.9280 0.5197 0.9323 0.9040[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.743
WIoU for r=0.3 = 0.631
F1 for r=0.4 = 0.741
WIoU for r=0.4 = 0.637
F1 for r=0.6 = 0.662
WIoU for r=0.6 = 0.548
F1 for r=0.9 = 0.532
WIoU for r=0.9 = 0.416
F1 for r=0.95 = 0.518
WIoU for r=0.95 = 0.403
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.395
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.320
WIoU for r=0.3 = 0.204
F1 for r=0.4 = 0.255
WIoU for r=0.4 = 0.158
F1 for r=0.6 = 0.180
WIoU for r=0.6 = 0.109
F1 for r=0.9 = 0.124
WIoU for r=0.9 = 0.075
F1 for r=0.95 = 0.118
WIoU for r=0.95 = 0.072
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.068


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.49
Model XAI F1 of binarized graphs for r=0.3 =  0.7432099999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6305912499999999
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.321
NEC for r=0.3 class 0 = 0.582 +- 0.348 (in-sample avg dev_std = 0.356)
NEC for r=0.3 class 1 = 0.462 +- 0.348 (in-sample avg dev_std = 0.356)
NEC for r=0.3 class 2 = 0.569 +- 0.348 (in-sample avg dev_std = 0.356)
NEC for r=0.3 all KL = 0.504 +- 0.348 (in-sample avg dev_std = 0.356)
NEC for r=0.3 all L1 = 0.537 +- 0.212 (in-sample avg dev_std = 0.356)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.639
Model XAI F1 of binarized graphs for r=0.4 =  0.7408674999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.636655
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.345
NEC for r=0.4 class 0 = 0.589 +- 0.326 (in-sample avg dev_std = 0.413)
NEC for r=0.4 class 1 = 0.544 +- 0.326 (in-sample avg dev_std = 0.413)
NEC for r=0.4 class 2 = 0.624 +- 0.326 (in-sample avg dev_std = 0.413)
NEC for r=0.4 all KL = 0.599 +- 0.326 (in-sample avg dev_std = 0.413)
NEC for r=0.4 all L1 = 0.586 +- 0.182 (in-sample avg dev_std = 0.413)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.801
Model XAI F1 of binarized graphs for r=0.6 =  0.66175375
Model XAI WIoU of binarized graphs for r=0.6 =  0.54802625
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.37
NEC for r=0.6 class 0 = 0.607 +- 0.272 (in-sample avg dev_std = 0.503)
NEC for r=0.6 class 1 = 0.57 +- 0.272 (in-sample avg dev_std = 0.503)
NEC for r=0.6 class 2 = 0.658 +- 0.272 (in-sample avg dev_std = 0.503)
NEC for r=0.6 all KL = 0.658 +- 0.272 (in-sample avg dev_std = 0.503)
NEC for r=0.6 all L1 = 0.611 +- 0.157 (in-sample avg dev_std = 0.503)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.53248125
Model XAI WIoU of binarized graphs for r=0.9 =  0.41568125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.469
NEC for r=0.9 class 0 = 0.59 +- 0.250 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 1 = 0.518 +- 0.250 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 2 = 0.604 +- 0.250 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all KL = 0.622 +- 0.250 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all L1 = 0.57 +- 0.173 (in-sample avg dev_std = 0.570)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.933
Model XAI F1 of binarized graphs for r=0.95 =  0.5184375
Model XAI WIoU of binarized graphs for r=0.95 =  0.4031975
len(reference) = 800
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.513
NEC for r=0.95 class 0 = 0.572 +- 0.247 (in-sample avg dev_std = 0.596)
NEC for r=0.95 class 1 = 0.496 +- 0.247 (in-sample avg dev_std = 0.596)
NEC for r=0.95 class 2 = 0.59 +- 0.247 (in-sample avg dev_std = 0.596)
NEC for r=0.95 all KL = 0.612 +- 0.247 (in-sample avg dev_std = 0.596)
NEC for r=0.95 all L1 = 0.552 +- 0.174 (in-sample avg dev_std = 0.596)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.938
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.39527875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.513
NEC for r=1.0 class 0 = 0.575 +- 0.246 (in-sample avg dev_std = 0.618)
NEC for r=1.0 class 1 = 0.497 +- 0.246 (in-sample avg dev_std = 0.618)
NEC for r=1.0 class 2 = 0.599 +- 0.246 (in-sample avg dev_std = 0.618)
NEC for r=1.0 all KL = 0.633 +- 0.246 (in-sample avg dev_std = 0.618)
NEC for r=1.0 all L1 = 0.557 +- 0.173 (in-sample avg dev_std = 0.618)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  0.31971875
Model XAI WIoU of binarized graphs for r=0.3 =  0.20440000000000003
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.34
NEC for r=0.3 class 0 = 0.459 +- 0.197 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 1 = 0.473 +- 0.197 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 2 = 0.497 +- 0.197 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all KL = 0.32 +- 0.197 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all L1 = 0.476 +- 0.151 (in-sample avg dev_std = 0.214)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.636
Model XAI F1 of binarized graphs for r=0.4 =  0.2553875
Model XAI WIoU of binarized graphs for r=0.4 =  0.1580775
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.35
NEC for r=0.4 class 0 = 0.41 +- 0.183 (in-sample avg dev_std = 0.219)
NEC for r=0.4 class 1 = 0.408 +- 0.183 (in-sample avg dev_std = 0.219)
NEC for r=0.4 class 2 = 0.43 +- 0.183 (in-sample avg dev_std = 0.219)
NEC for r=0.4 all KL = 0.247 +- 0.183 (in-sample avg dev_std = 0.219)
NEC for r=0.4 all L1 = 0.416 +- 0.154 (in-sample avg dev_std = 0.219)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.17980000000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.10896999999999998
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.407
NEC for r=0.6 class 0 = 0.385 +- 0.143 (in-sample avg dev_std = 0.260)
NEC for r=0.6 class 1 = 0.321 +- 0.143 (in-sample avg dev_std = 0.260)
NEC for r=0.6 class 2 = 0.426 +- 0.143 (in-sample avg dev_std = 0.260)
NEC for r=0.6 all KL = 0.235 +- 0.143 (in-sample avg dev_std = 0.260)
NEC for r=0.6 all L1 = 0.376 +- 0.143 (in-sample avg dev_std = 0.260)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.586
Model XAI F1 of binarized graphs for r=0.9 =  0.12446125000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.07521749999999999
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.413
NEC for r=0.9 class 0 = 0.297 +- 0.207 (in-sample avg dev_std = 0.250)
NEC for r=0.9 class 1 = 0.332 +- 0.207 (in-sample avg dev_std = 0.250)
NEC for r=0.9 class 2 = 0.331 +- 0.207 (in-sample avg dev_std = 0.250)
NEC for r=0.9 all KL = 0.2 +- 0.207 (in-sample avg dev_std = 0.250)
NEC for r=0.9 all L1 = 0.32 +- 0.164 (in-sample avg dev_std = 0.250)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.561
Model XAI F1 of binarized graphs for r=0.95 =  0.11846250000000001
Model XAI WIoU of binarized graphs for r=0.95 =  0.0715825
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.411
NEC for r=0.95 class 0 = 0.236 +- 0.203 (in-sample avg dev_std = 0.180)
NEC for r=0.95 class 1 = 0.285 +- 0.203 (in-sample avg dev_std = 0.180)
NEC for r=0.95 class 2 = 0.271 +- 0.203 (in-sample avg dev_std = 0.180)
NEC for r=0.95 all KL = 0.152 +- 0.203 (in-sample avg dev_std = 0.180)
NEC for r=0.95 all L1 = 0.264 +- 0.190 (in-sample avg dev_std = 0.180)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.501
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.06840625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.41
NEC for r=1.0 class 0 = 0.21 +- 0.212 (in-sample avg dev_std = 0.170)
NEC for r=1.0 class 1 = 0.261 +- 0.212 (in-sample avg dev_std = 0.170)
NEC for r=1.0 class 2 = 0.224 +- 0.212 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all KL = 0.138 +- 0.212 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all L1 = 0.232 +- 0.208 (in-sample avg dev_std = 0.170)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.482
Model XAI F1 of binarized graphs for r=0.3 =  0.7432099999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6305912499999999
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.414
SUFF++ for r=0.3 class 0 = 0.463 +- 0.300 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.3 class 1 = 0.597 +- 0.300 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.3 class 2 = 0.567 +- 0.300 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.3 all KL = 0.557 +- 0.300 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.3 all L1 = 0.542 +- 0.171 (in-sample avg dev_std = 0.504)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.64
Model XAI F1 of binarized graphs for r=0.4 =  0.7408674999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.636655
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.506
SUFF++ for r=0.4 class 0 = 0.485 +- 0.300 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.4 class 1 = 0.575 +- 0.300 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.4 class 2 = 0.606 +- 0.300 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.4 all KL = 0.542 +- 0.300 (in-sample avg dev_std = 0.527)
SUFF++ for r=0.4 all L1 = 0.555 +- 0.195 (in-sample avg dev_std = 0.527)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.804
Model XAI F1 of binarized graphs for r=0.6 =  0.66175375
Model XAI WIoU of binarized graphs for r=0.6 =  0.54802625
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.711
SUFF++ for r=0.6 class 0 = 0.607 +- 0.276 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 1 = 0.649 +- 0.276 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 2 = 0.713 +- 0.276 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 all KL = 0.666 +- 0.276 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 all L1 = 0.656 +- 0.212 (in-sample avg dev_std = 0.437)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.53248125
Model XAI WIoU of binarized graphs for r=0.9 =  0.41568125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.885
SUFF++ for r=0.9 class 0 = 0.808 +- 0.180 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 class 1 = 0.868 +- 0.180 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 class 2 = 0.893 +- 0.180 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 all KL = 0.896 +- 0.180 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 all L1 = 0.856 +- 0.163 (in-sample avg dev_std = 0.232)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.928
Model XAI F1 of binarized graphs for r=0.95 =  0.5184375
Model XAI WIoU of binarized graphs for r=0.95 =  0.4031975
len(reference) = 706
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.911
SUFF++ for r=0.95 class 0 = 0.885 +- 0.116 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.95 class 1 = 0.94 +- 0.116 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.95 class 2 = 0.916 +- 0.116 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.95 all KL = 0.948 +- 0.116 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.95 all L1 = 0.913 +- 0.114 (in-sample avg dev_std = 0.169)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.605
Model XAI F1 of binarized graphs for r=0.3 =  0.31971875
Model XAI WIoU of binarized graphs for r=0.3 =  0.20440000000000003
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.551
SUFF++ for r=0.3 class 0 = 0.584 +- 0.150 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.3 class 1 = 0.607 +- 0.150 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.3 class 2 = 0.649 +- 0.150 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.3 all KL = 0.761 +- 0.150 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.3 all L1 = 0.612 +- 0.123 (in-sample avg dev_std = 0.359)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.63
Model XAI F1 of binarized graphs for r=0.4 =  0.2553875
Model XAI WIoU of binarized graphs for r=0.4 =  0.1580775
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.569
SUFF++ for r=0.4 class 0 = 0.601 +- 0.144 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.4 class 1 = 0.622 +- 0.144 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.4 class 2 = 0.641 +- 0.144 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.4 all KL = 0.778 +- 0.144 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.4 all L1 = 0.621 +- 0.119 (in-sample avg dev_std = 0.342)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  0.17980000000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.10896999999999998
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.599
SUFF++ for r=0.6 class 0 = 0.597 +- 0.224 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 1 = 0.65 +- 0.224 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 2 = 0.596 +- 0.224 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 all KL = 0.713 +- 0.224 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 all L1 = 0.615 +- 0.131 (in-sample avg dev_std = 0.367)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.586
Model XAI F1 of binarized graphs for r=0.9 =  0.12446125000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.07521749999999999
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.545
SUFF++ for r=0.9 class 0 = 0.764 +- 0.208 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.9 class 1 = 0.691 +- 0.208 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.9 class 2 = 0.72 +- 0.208 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.9 all KL = 0.817 +- 0.208 (in-sample avg dev_std = 0.226)
SUFF++ for r=0.9 all L1 = 0.725 +- 0.153 (in-sample avg dev_std = 0.226)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.558
Model XAI F1 of binarized graphs for r=0.95 =  0.11846250000000001
Model XAI WIoU of binarized graphs for r=0.95 =  0.0715825
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.518
SUFF++ for r=0.95 class 0 = 0.884 +- 0.158 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.95 class 1 = 0.824 +- 0.158 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.95 class 2 = 0.849 +- 0.158 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.95 all KL = 0.921 +- 0.158 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.95 all L1 = 0.852 +- 0.129 (in-sample avg dev_std = 0.134)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 14:23:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 02:23:08 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 02:23:22 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 02:23:24 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 02:23:25 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 02:23:29 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 02:23:35 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 02:23:35 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 02:23:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:23:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:23:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:23:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:23:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:23:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:23:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:23:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 122...
[0m[1;37mINFO[0m: [1mCheckpoint 122: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3371
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3138
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3425
OOD Validation ACCURACY: 0.8697
OOD Validation Loss: 0.5698
OOD Test ACCURACY: 0.5503
OOD Test Loss: 1.5812

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9264
Train Loss: 0.3343
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3132
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4750
OOD Test ACCURACY: 0.5800
OOD Test Loss: 2.8730

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5503 0.9273 0.5800 0.9327 0.9030[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.730
WIoU for r=0.3 = 0.611
F1 for r=0.4 = 0.734
WIoU for r=0.4 = 0.625
F1 for r=0.6 = 0.653
WIoU for r=0.6 = 0.533
F1 for r=0.9 = 0.530
WIoU for r=0.9 = 0.405
F1 for r=0.95 = 0.517
WIoU for r=0.95 = 0.394
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.387
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.316
WIoU for r=0.3 = 0.202
F1 for r=0.4 = 0.253
WIoU for r=0.4 = 0.156
F1 for r=0.6 = 0.179
WIoU for r=0.6 = 0.108
F1 for r=0.9 = 0.124
WIoU for r=0.9 = 0.075
F1 for r=0.95 = 0.118
WIoU for r=0.95 = 0.071
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.068


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.475
Model XAI F1 of binarized graphs for r=0.3 =  0.7297612499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6108312499999999
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.314
NEC for r=0.3 class 0 = 0.569 +- 0.340 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 1 = 0.425 +- 0.340 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 2 = 0.543 +- 0.340 (in-sample avg dev_std = 0.344)
NEC for r=0.3 all KL = 0.466 +- 0.340 (in-sample avg dev_std = 0.344)
NEC for r=0.3 all L1 = 0.512 +- 0.233 (in-sample avg dev_std = 0.344)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.632
Model XAI F1 of binarized graphs for r=0.4 =  0.7335587499999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.62548375
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.33
NEC for r=0.4 class 0 = 0.567 +- 0.319 (in-sample avg dev_std = 0.422)
NEC for r=0.4 class 1 = 0.528 +- 0.319 (in-sample avg dev_std = 0.422)
NEC for r=0.4 class 2 = 0.61 +- 0.319 (in-sample avg dev_std = 0.422)
NEC for r=0.4 all KL = 0.564 +- 0.319 (in-sample avg dev_std = 0.422)
NEC for r=0.4 all L1 = 0.568 +- 0.199 (in-sample avg dev_std = 0.422)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.6529900000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.5328050000000001
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.386
NEC for r=0.6 class 0 = 0.562 +- 0.275 (in-sample avg dev_std = 0.483)
NEC for r=0.6 class 1 = 0.535 +- 0.275 (in-sample avg dev_std = 0.483)
NEC for r=0.6 class 2 = 0.662 +- 0.275 (in-sample avg dev_std = 0.483)
NEC for r=0.6 all KL = 0.583 +- 0.275 (in-sample avg dev_std = 0.483)
NEC for r=0.6 all L1 = 0.586 +- 0.170 (in-sample avg dev_std = 0.483)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.52960625
Model XAI WIoU of binarized graphs for r=0.9 =  0.40500875000000003
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.476
NEC for r=0.9 class 0 = 0.545 +- 0.257 (in-sample avg dev_std = 0.531)
NEC for r=0.9 class 1 = 0.519 +- 0.257 (in-sample avg dev_std = 0.531)
NEC for r=0.9 class 2 = 0.585 +- 0.257 (in-sample avg dev_std = 0.531)
NEC for r=0.9 all KL = 0.549 +- 0.257 (in-sample avg dev_std = 0.531)
NEC for r=0.9 all L1 = 0.549 +- 0.173 (in-sample avg dev_std = 0.531)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.933
Model XAI F1 of binarized graphs for r=0.95 =  0.517305
Model XAI WIoU of binarized graphs for r=0.95 =  0.39409125
len(reference) = 800
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.493
NEC for r=0.95 class 0 = 0.557 +- 0.254 (in-sample avg dev_std = 0.568)
NEC for r=0.95 class 1 = 0.513 +- 0.254 (in-sample avg dev_std = 0.568)
NEC for r=0.95 class 2 = 0.588 +- 0.254 (in-sample avg dev_std = 0.568)
NEC for r=0.95 all KL = 0.571 +- 0.254 (in-sample avg dev_std = 0.568)
NEC for r=0.95 all L1 = 0.552 +- 0.166 (in-sample avg dev_std = 0.568)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.938
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.38721374999999997
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.507
NEC for r=1.0 class 0 = 0.552 +- 0.259 (in-sample avg dev_std = 0.584)
NEC for r=1.0 class 1 = 0.504 +- 0.259 (in-sample avg dev_std = 0.584)
NEC for r=1.0 class 2 = 0.586 +- 0.259 (in-sample avg dev_std = 0.584)
NEC for r=1.0 all KL = 0.578 +- 0.259 (in-sample avg dev_std = 0.584)
NEC for r=1.0 all L1 = 0.547 +- 0.172 (in-sample avg dev_std = 0.584)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.647
Model XAI F1 of binarized graphs for r=0.3 =  0.315925
Model XAI WIoU of binarized graphs for r=0.3 =  0.201755
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.36
NEC for r=0.3 class 0 = 0.391 +- 0.189 (in-sample avg dev_std = 0.199)
NEC for r=0.3 class 1 = 0.445 +- 0.189 (in-sample avg dev_std = 0.199)
NEC for r=0.3 class 2 = 0.512 +- 0.189 (in-sample avg dev_std = 0.199)
NEC for r=0.3 all KL = 0.268 +- 0.189 (in-sample avg dev_std = 0.199)
NEC for r=0.3 all L1 = 0.448 +- 0.153 (in-sample avg dev_std = 0.199)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.582
Model XAI F1 of binarized graphs for r=0.4 =  0.25287125
Model XAI WIoU of binarized graphs for r=0.4 =  0.15601500000000001
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.374
NEC for r=0.4 class 0 = 0.413 +- 0.204 (in-sample avg dev_std = 0.217)
NEC for r=0.4 class 1 = 0.45 +- 0.204 (in-sample avg dev_std = 0.217)
NEC for r=0.4 class 2 = 0.463 +- 0.204 (in-sample avg dev_std = 0.217)
NEC for r=0.4 all KL = 0.274 +- 0.204 (in-sample avg dev_std = 0.217)
NEC for r=0.4 all L1 = 0.442 +- 0.150 (in-sample avg dev_std = 0.217)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.646
Model XAI F1 of binarized graphs for r=0.6 =  0.17901249999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.10809875
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.394
NEC for r=0.6 class 0 = 0.387 +- 0.150 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 1 = 0.34 +- 0.150 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 2 = 0.432 +- 0.150 (in-sample avg dev_std = 0.259)
NEC for r=0.6 all KL = 0.233 +- 0.150 (in-sample avg dev_std = 0.259)
NEC for r=0.6 all L1 = 0.385 +- 0.134 (in-sample avg dev_std = 0.259)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.554
Model XAI F1 of binarized graphs for r=0.9 =  0.12400375000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.0747075
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.399
NEC for r=0.9 class 0 = 0.307 +- 0.117 (in-sample avg dev_std = 0.198)
NEC for r=0.9 class 1 = 0.33 +- 0.117 (in-sample avg dev_std = 0.198)
NEC for r=0.9 class 2 = 0.33 +- 0.117 (in-sample avg dev_std = 0.198)
NEC for r=0.9 all KL = 0.146 +- 0.117 (in-sample avg dev_std = 0.198)
NEC for r=0.9 all L1 = 0.322 +- 0.147 (in-sample avg dev_std = 0.198)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.543
Model XAI F1 of binarized graphs for r=0.95 =  0.11803625000000001
Model XAI WIoU of binarized graphs for r=0.95 =  0.07112125
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.396
NEC for r=0.95 class 0 = 0.284 +- 0.112 (in-sample avg dev_std = 0.180)
NEC for r=0.95 class 1 = 0.318 +- 0.112 (in-sample avg dev_std = 0.180)
NEC for r=0.95 class 2 = 0.303 +- 0.112 (in-sample avg dev_std = 0.180)
NEC for r=0.95 all KL = 0.134 +- 0.112 (in-sample avg dev_std = 0.180)
NEC for r=0.95 all L1 = 0.302 +- 0.164 (in-sample avg dev_std = 0.180)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.56
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.06815125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.406
NEC for r=1.0 class 0 = 0.247 +- 0.114 (in-sample avg dev_std = 0.186)
NEC for r=1.0 class 1 = 0.282 +- 0.114 (in-sample avg dev_std = 0.186)
NEC for r=1.0 class 2 = 0.27 +- 0.114 (in-sample avg dev_std = 0.186)
NEC for r=1.0 all KL = 0.115 +- 0.114 (in-sample avg dev_std = 0.186)
NEC for r=1.0 all L1 = 0.267 +- 0.164 (in-sample avg dev_std = 0.186)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.475
Model XAI F1 of binarized graphs for r=0.3 =  0.7297612499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6108312499999999
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.427
SUFF++ for r=0.3 class 0 = 0.498 +- 0.275 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 class 1 = 0.607 +- 0.275 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 class 2 = 0.599 +- 0.275 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 all KL = 0.6 +- 0.275 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.3 all L1 = 0.568 +- 0.169 (in-sample avg dev_std = 0.487)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.634
Model XAI F1 of binarized graphs for r=0.4 =  0.7335587499999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.62548375
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.537
SUFF++ for r=0.4 class 0 = 0.528 +- 0.272 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.4 class 1 = 0.561 +- 0.272 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.4 class 2 = 0.619 +- 0.272 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.4 all KL = 0.58 +- 0.272 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.4 all L1 = 0.569 +- 0.177 (in-sample avg dev_std = 0.513)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.6529900000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.5328050000000001
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.675
SUFF++ for r=0.6 class 0 = 0.581 +- 0.256 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 1 = 0.622 +- 0.256 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 2 = 0.721 +- 0.256 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 all KL = 0.687 +- 0.256 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 all L1 = 0.641 +- 0.199 (in-sample avg dev_std = 0.427)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.52960625
Model XAI WIoU of binarized graphs for r=0.9 =  0.40500875000000003
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.862
SUFF++ for r=0.9 class 0 = 0.745 +- 0.162 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 1 = 0.83 +- 0.162 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 2 = 0.878 +- 0.162 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all KL = 0.886 +- 0.162 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all L1 = 0.817 +- 0.169 (in-sample avg dev_std = 0.229)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.926
Model XAI F1 of binarized graphs for r=0.95 =  0.517305
Model XAI WIoU of binarized graphs for r=0.95 =  0.39409125
len(reference) = 706
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.892
SUFF++ for r=0.95 class 0 = 0.851 +- 0.101 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.95 class 1 = 0.891 +- 0.101 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.95 class 2 = 0.917 +- 0.101 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.95 all KL = 0.942 +- 0.101 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.95 all L1 = 0.886 +- 0.124 (in-sample avg dev_std = 0.182)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.647
Model XAI F1 of binarized graphs for r=0.3 =  0.315925
Model XAI WIoU of binarized graphs for r=0.3 =  0.201755
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.605
SUFF++ for r=0.3 class 0 = 0.693 +- 0.119 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.3 class 1 = 0.674 +- 0.119 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.3 class 2 = 0.687 +- 0.119 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.3 all KL = 0.85 +- 0.119 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.3 all L1 = 0.685 +- 0.115 (in-sample avg dev_std = 0.264)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.581
Model XAI F1 of binarized graphs for r=0.4 =  0.25287125
Model XAI WIoU of binarized graphs for r=0.4 =  0.15601500000000001
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.596
SUFF++ for r=0.4 class 0 = 0.661 +- 0.141 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.4 class 1 = 0.666 +- 0.141 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.4 class 2 = 0.672 +- 0.141 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.4 all KL = 0.823 +- 0.141 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.4 all L1 = 0.666 +- 0.122 (in-sample avg dev_std = 0.279)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.649
Model XAI F1 of binarized graphs for r=0.6 =  0.17901249999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.10809875
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.595
SUFF++ for r=0.6 class 0 = 0.644 +- 0.210 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.6 class 1 = 0.648 +- 0.210 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.6 class 2 = 0.635 +- 0.210 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.6 all KL = 0.759 +- 0.210 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.6 all L1 = 0.642 +- 0.120 (in-sample avg dev_std = 0.388)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.554
Model XAI F1 of binarized graphs for r=0.9 =  0.12400375000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.0747075
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.517
SUFF++ for r=0.9 class 0 = 0.765 +- 0.088 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 1 = 0.741 +- 0.088 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 2 = 0.745 +- 0.088 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 all KL = 0.896 +- 0.088 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 all L1 = 0.75 +- 0.107 (in-sample avg dev_std = 0.194)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.543
Model XAI F1 of binarized graphs for r=0.95 =  0.11803625000000001
Model XAI WIoU of binarized graphs for r=0.95 =  0.07112125
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.493
SUFF++ for r=0.95 class 0 = 0.859 +- 0.056 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.95 class 1 = 0.826 +- 0.056 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.95 class 2 = 0.833 +- 0.056 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.95 all KL = 0.947 +- 0.056 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.95 all L1 = 0.839 +- 0.096 (in-sample avg dev_std = 0.140)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 14:30:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 02:30:36 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 02:30:48 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 02:30:50 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 02:30:52 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 02:30:55 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 02:31:01 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 02:31:01 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 02:31:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:31:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:31:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:31:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:31:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:31:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:31:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:31:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3328
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3378
OOD Validation ACCURACY: 0.8910
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4787
OOD Test Loss: 2.2870

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3400
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9237
ID Test Loss: 0.3418
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4991
OOD Test ACCURACY: 0.6000
OOD Test Loss: 1.5258

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4787 0.9237 0.6000 0.9327 0.9017[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.737
WIoU for r=0.3 = 0.617
F1 for r=0.4 = 0.743
WIoU for r=0.4 = 0.634
F1 for r=0.6 = 0.667
WIoU for r=0.6 = 0.550
F1 for r=0.9 = 0.536
WIoU for r=0.9 = 0.416
F1 for r=0.95 = 0.520
WIoU for r=0.95 = 0.402
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.392
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.319
WIoU for r=0.3 = 0.204
F1 for r=0.4 = 0.255
WIoU for r=0.4 = 0.157
F1 for r=0.6 = 0.180
WIoU for r=0.6 = 0.109
F1 for r=0.9 = 0.124
WIoU for r=0.9 = 0.075
F1 for r=0.95 = 0.118
WIoU for r=0.95 = 0.071
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.068


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.472
Model XAI F1 of binarized graphs for r=0.3 =  0.736995
Model XAI WIoU of binarized graphs for r=0.3 =  0.61693125
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.339
NEC for r=0.3 class 0 = 0.549 +- 0.317 (in-sample avg dev_std = 0.355)
NEC for r=0.3 class 1 = 0.455 +- 0.317 (in-sample avg dev_std = 0.355)
NEC for r=0.3 class 2 = 0.596 +- 0.317 (in-sample avg dev_std = 0.355)
NEC for r=0.3 all KL = 0.494 +- 0.317 (in-sample avg dev_std = 0.355)
NEC for r=0.3 all L1 = 0.533 +- 0.217 (in-sample avg dev_std = 0.355)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.613
Model XAI F1 of binarized graphs for r=0.4 =  0.74320125
Model XAI WIoU of binarized graphs for r=0.4 =  0.63405125
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.34
NEC for r=0.4 class 0 = 0.519 +- 0.306 (in-sample avg dev_std = 0.409)
NEC for r=0.4 class 1 = 0.528 +- 0.306 (in-sample avg dev_std = 0.409)
NEC for r=0.4 class 2 = 0.639 +- 0.306 (in-sample avg dev_std = 0.409)
NEC for r=0.4 all KL = 0.552 +- 0.306 (in-sample avg dev_std = 0.409)
NEC for r=0.4 all L1 = 0.561 +- 0.197 (in-sample avg dev_std = 0.409)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.784
Model XAI F1 of binarized graphs for r=0.6 =  0.66699625
Model XAI WIoU of binarized graphs for r=0.6 =  0.550325
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.388
NEC for r=0.6 class 0 = 0.541 +- 0.260 (in-sample avg dev_std = 0.466)
NEC for r=0.6 class 1 = 0.575 +- 0.260 (in-sample avg dev_std = 0.466)
NEC for r=0.6 class 2 = 0.644 +- 0.260 (in-sample avg dev_std = 0.466)
NEC for r=0.6 all KL = 0.585 +- 0.260 (in-sample avg dev_std = 0.466)
NEC for r=0.6 all L1 = 0.586 +- 0.163 (in-sample avg dev_std = 0.466)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.914
Model XAI F1 of binarized graphs for r=0.9 =  0.53644625
Model XAI WIoU of binarized graphs for r=0.9 =  0.41648624999999995
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.466
NEC for r=0.9 class 0 = 0.529 +- 0.242 (in-sample avg dev_std = 0.516)
NEC for r=0.9 class 1 = 0.536 +- 0.242 (in-sample avg dev_std = 0.516)
NEC for r=0.9 class 2 = 0.576 +- 0.242 (in-sample avg dev_std = 0.516)
NEC for r=0.9 all KL = 0.535 +- 0.242 (in-sample avg dev_std = 0.516)
NEC for r=0.9 all L1 = 0.547 +- 0.171 (in-sample avg dev_std = 0.516)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.926
Model XAI F1 of binarized graphs for r=0.95 =  0.52011375
Model XAI WIoU of binarized graphs for r=0.95 =  0.40173500000000006
len(reference) = 800
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.483
NEC for r=0.95 class 0 = 0.539 +- 0.237 (in-sample avg dev_std = 0.553)
NEC for r=0.95 class 1 = 0.537 +- 0.237 (in-sample avg dev_std = 0.553)
NEC for r=0.95 class 2 = 0.569 +- 0.237 (in-sample avg dev_std = 0.553)
NEC for r=0.95 all KL = 0.551 +- 0.237 (in-sample avg dev_std = 0.553)
NEC for r=0.95 all L1 = 0.548 +- 0.166 (in-sample avg dev_std = 0.553)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.938
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.39213875000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.489
NEC for r=1.0 class 0 = 0.526 +- 0.241 (in-sample avg dev_std = 0.560)
NEC for r=1.0 class 1 = 0.55 +- 0.241 (in-sample avg dev_std = 0.560)
NEC for r=1.0 class 2 = 0.593 +- 0.241 (in-sample avg dev_std = 0.560)
NEC for r=1.0 all KL = 0.573 +- 0.241 (in-sample avg dev_std = 0.560)
NEC for r=1.0 all L1 = 0.556 +- 0.167 (in-sample avg dev_std = 0.560)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.506
Model XAI F1 of binarized graphs for r=0.3 =  0.31880749999999997
Model XAI WIoU of binarized graphs for r=0.3 =  0.20374875
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.304 +- 0.191 (in-sample avg dev_std = 0.163)
NEC for r=0.3 class 1 = 0.34 +- 0.191 (in-sample avg dev_std = 0.163)
NEC for r=0.3 class 2 = 0.396 +- 0.191 (in-sample avg dev_std = 0.163)
NEC for r=0.3 all KL = 0.206 +- 0.191 (in-sample avg dev_std = 0.163)
NEC for r=0.3 all L1 = 0.346 +- 0.186 (in-sample avg dev_std = 0.163)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.517
Model XAI F1 of binarized graphs for r=0.4 =  0.25488875
Model XAI WIoU of binarized graphs for r=0.4 =  0.15743500000000002
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.351
NEC for r=0.4 class 0 = 0.329 +- 0.174 (in-sample avg dev_std = 0.169)
NEC for r=0.4 class 1 = 0.371 +- 0.174 (in-sample avg dev_std = 0.169)
NEC for r=0.4 class 2 = 0.404 +- 0.174 (in-sample avg dev_std = 0.169)
NEC for r=0.4 all KL = 0.207 +- 0.174 (in-sample avg dev_std = 0.169)
NEC for r=0.4 all L1 = 0.367 +- 0.171 (in-sample avg dev_std = 0.169)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.586
Model XAI F1 of binarized graphs for r=0.6 =  0.17981124999999998
Model XAI WIoU of binarized graphs for r=0.6 =  0.108675
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.374
NEC for r=0.6 class 0 = 0.287 +- 0.124 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 1 = 0.32 +- 0.124 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 2 = 0.354 +- 0.124 (in-sample avg dev_std = 0.190)
NEC for r=0.6 all KL = 0.152 +- 0.124 (in-sample avg dev_std = 0.190)
NEC for r=0.6 all L1 = 0.32 +- 0.153 (in-sample avg dev_std = 0.190)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.499
Model XAI F1 of binarized graphs for r=0.9 =  0.12449875000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.07502500000000001
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.353
NEC for r=0.9 class 0 = 0.264 +- 0.128 (in-sample avg dev_std = 0.170)
NEC for r=0.9 class 1 = 0.332 +- 0.128 (in-sample avg dev_std = 0.170)
NEC for r=0.9 class 2 = 0.281 +- 0.128 (in-sample avg dev_std = 0.170)
NEC for r=0.9 all KL = 0.144 +- 0.128 (in-sample avg dev_std = 0.170)
NEC for r=0.9 all L1 = 0.293 +- 0.150 (in-sample avg dev_std = 0.170)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.522
Model XAI F1 of binarized graphs for r=0.95 =  0.11847374999999999
Model XAI WIoU of binarized graphs for r=0.95 =  0.071355
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.358
NEC for r=0.95 class 0 = 0.231 +- 0.105 (in-sample avg dev_std = 0.156)
NEC for r=0.95 class 1 = 0.308 +- 0.105 (in-sample avg dev_std = 0.156)
NEC for r=0.95 class 2 = 0.257 +- 0.105 (in-sample avg dev_std = 0.156)
NEC for r=0.95 all KL = 0.121 +- 0.105 (in-sample avg dev_std = 0.156)
NEC for r=0.95 all L1 = 0.266 +- 0.151 (in-sample avg dev_std = 0.156)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.48
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.06820999999999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.365
NEC for r=1.0 class 0 = 0.236 +- 0.142 (in-sample avg dev_std = 0.154)
NEC for r=1.0 class 1 = 0.306 +- 0.142 (in-sample avg dev_std = 0.154)
NEC for r=1.0 class 2 = 0.268 +- 0.142 (in-sample avg dev_std = 0.154)
NEC for r=1.0 all KL = 0.143 +- 0.142 (in-sample avg dev_std = 0.154)
NEC for r=1.0 all L1 = 0.271 +- 0.172 (in-sample avg dev_std = 0.154)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.472
Model XAI F1 of binarized graphs for r=0.3 =  0.736995
Model XAI WIoU of binarized graphs for r=0.3 =  0.61693125
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.425
SUFF++ for r=0.3 class 0 = 0.473 +- 0.271 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 class 1 = 0.618 +- 0.271 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 class 2 = 0.573 +- 0.271 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 all KL = 0.582 +- 0.271 (in-sample avg dev_std = 0.481)
SUFF++ for r=0.3 all L1 = 0.555 +- 0.191 (in-sample avg dev_std = 0.481)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.61
Model XAI F1 of binarized graphs for r=0.4 =  0.74320125
Model XAI WIoU of binarized graphs for r=0.4 =  0.63405125
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.537
SUFF++ for r=0.4 class 0 = 0.537 +- 0.260 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.4 class 1 = 0.575 +- 0.260 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.4 class 2 = 0.614 +- 0.260 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.4 all KL = 0.6 +- 0.260 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.4 all L1 = 0.575 +- 0.190 (in-sample avg dev_std = 0.480)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.783
Model XAI F1 of binarized graphs for r=0.6 =  0.66699625
Model XAI WIoU of binarized graphs for r=0.6 =  0.550325
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.712
SUFF++ for r=0.6 class 0 = 0.647 +- 0.243 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 1 = 0.606 +- 0.243 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 2 = 0.73 +- 0.243 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 all KL = 0.713 +- 0.243 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 all L1 = 0.66 +- 0.201 (in-sample avg dev_std = 0.401)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.914
Model XAI F1 of binarized graphs for r=0.9 =  0.53644625
Model XAI WIoU of binarized graphs for r=0.9 =  0.41648624999999995
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.873
SUFF++ for r=0.9 class 0 = 0.802 +- 0.151 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 class 1 = 0.823 +- 0.151 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 class 2 = 0.868 +- 0.151 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 all KL = 0.901 +- 0.151 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 all L1 = 0.831 +- 0.159 (in-sample avg dev_std = 0.219)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.922
Model XAI F1 of binarized graphs for r=0.95 =  0.52011375
Model XAI WIoU of binarized graphs for r=0.95 =  0.40173500000000006
len(reference) = 706
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.894
SUFF++ for r=0.95 class 0 = 0.861 +- 0.123 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.95 class 1 = 0.892 +- 0.123 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.95 class 2 = 0.908 +- 0.123 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.95 all KL = 0.94 +- 0.123 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.95 all L1 = 0.887 +- 0.139 (in-sample avg dev_std = 0.172)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.506
Model XAI F1 of binarized graphs for r=0.3 =  0.31880749999999997
Model XAI WIoU of binarized graphs for r=0.3 =  0.20374875
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.504
SUFF++ for r=0.3 class 0 = 0.689 +- 0.154 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 class 1 = 0.676 +- 0.154 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 class 2 = 0.681 +- 0.154 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 all KL = 0.81 +- 0.154 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.3 all L1 = 0.682 +- 0.116 (in-sample avg dev_std = 0.346)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.515
Model XAI F1 of binarized graphs for r=0.4 =  0.25488875
Model XAI WIoU of binarized graphs for r=0.4 =  0.15743500000000002
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.513
SUFF++ for r=0.4 class 0 = 0.678 +- 0.162 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.4 class 1 = 0.653 +- 0.162 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.4 class 2 = 0.674 +- 0.162 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.4 all KL = 0.81 +- 0.162 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.4 all L1 = 0.668 +- 0.123 (in-sample avg dev_std = 0.329)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.587
Model XAI F1 of binarized graphs for r=0.6 =  0.17981124999999998
Model XAI WIoU of binarized graphs for r=0.6 =  0.108675
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.555
SUFF++ for r=0.6 class 0 = 0.643 +- 0.185 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 class 1 = 0.625 +- 0.185 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 class 2 = 0.629 +- 0.185 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 all KL = 0.756 +- 0.185 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 all L1 = 0.632 +- 0.127 (in-sample avg dev_std = 0.383)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.502
Model XAI F1 of binarized graphs for r=0.9 =  0.12449875000000002
Model XAI WIoU of binarized graphs for r=0.9 =  0.07502500000000001
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.467
SUFF++ for r=0.9 class 0 = 0.726 +- 0.195 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 1 = 0.713 +- 0.195 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 2 = 0.759 +- 0.195 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all KL = 0.83 +- 0.195 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all L1 = 0.732 +- 0.134 (in-sample avg dev_std = 0.221)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.522
Model XAI F1 of binarized graphs for r=0.95 =  0.11847374999999999
Model XAI WIoU of binarized graphs for r=0.95 =  0.071355
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.475
SUFF++ for r=0.95 class 0 = 0.837 +- 0.065 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.95 class 1 = 0.836 +- 0.065 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.95 class 2 = 0.857 +- 0.065 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.95 all KL = 0.947 +- 0.065 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.95 all L1 = 0.843 +- 0.099 (in-sample avg dev_std = 0.131)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 14:38:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 02:38:02 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 02:38:14 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 02:38:16 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 02:38:18 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 02:38:21 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 02:38:28 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 02:38:28 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 02:38:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:38:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:38:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:38:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:38:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:38:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:38:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:38:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5283 0.9290 0.5283 0.9337 0.9093[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.734
WIoU for r=0.3 = 0.615
F1 for r=0.4 = 0.734
WIoU for r=0.4 = 0.625
F1 for r=0.6 = 0.653
WIoU for r=0.6 = 0.534
F1 for r=0.9 = 0.533
WIoU for r=0.9 = 0.411
F1 for r=0.95 = 0.519
WIoU for r=0.95 = 0.399
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.390
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.319
WIoU for r=0.3 = 0.206
F1 for r=0.4 = 0.255
WIoU for r=0.4 = 0.160
F1 for r=0.6 = 0.180
WIoU for r=0.6 = 0.110
F1 for r=0.9 = 0.124
WIoU for r=0.9 = 0.076
F1 for r=0.95 = 0.118
WIoU for r=0.95 = 0.072
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.069


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.491
Model XAI F1 of binarized graphs for r=0.3 =  0.7335275
Model XAI WIoU of binarized graphs for r=0.3 =  0.6146275
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.327
NEC for r=0.3 class 0 = 0.582 +- 0.321 (in-sample avg dev_std = 0.310)
NEC for r=0.3 class 1 = 0.432 +- 0.321 (in-sample avg dev_std = 0.310)
NEC for r=0.3 class 2 = 0.568 +- 0.321 (in-sample avg dev_std = 0.310)
NEC for r=0.3 all KL = 0.482 +- 0.321 (in-sample avg dev_std = 0.310)
NEC for r=0.3 all L1 = 0.527 +- 0.200 (in-sample avg dev_std = 0.310)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.618
Model XAI F1 of binarized graphs for r=0.4 =  0.73448875
Model XAI WIoU of binarized graphs for r=0.4 =  0.6246375000000001
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.338
NEC for r=0.4 class 0 = 0.606 +- 0.308 (in-sample avg dev_std = 0.353)
NEC for r=0.4 class 1 = 0.468 +- 0.308 (in-sample avg dev_std = 0.353)
NEC for r=0.4 class 2 = 0.613 +- 0.308 (in-sample avg dev_std = 0.353)
NEC for r=0.4 all KL = 0.555 +- 0.308 (in-sample avg dev_std = 0.353)
NEC for r=0.4 all L1 = 0.562 +- 0.179 (in-sample avg dev_std = 0.353)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.762
Model XAI F1 of binarized graphs for r=0.6 =  0.65334625
Model XAI WIoU of binarized graphs for r=0.6 =  0.53425625
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.391
NEC for r=0.6 class 0 = 0.604 +- 0.254 (in-sample avg dev_std = 0.433)
NEC for r=0.6 class 1 = 0.532 +- 0.254 (in-sample avg dev_std = 0.433)
NEC for r=0.6 class 2 = 0.625 +- 0.254 (in-sample avg dev_std = 0.433)
NEC for r=0.6 all KL = 0.582 +- 0.254 (in-sample avg dev_std = 0.433)
NEC for r=0.6 all L1 = 0.587 +- 0.148 (in-sample avg dev_std = 0.433)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.5329887499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.411405
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.473
NEC for r=0.9 class 0 = 0.594 +- 0.240 (in-sample avg dev_std = 0.510)
NEC for r=0.9 class 1 = 0.524 +- 0.240 (in-sample avg dev_std = 0.510)
NEC for r=0.9 class 2 = 0.579 +- 0.240 (in-sample avg dev_std = 0.510)
NEC for r=0.9 all KL = 0.569 +- 0.240 (in-sample avg dev_std = 0.510)
NEC for r=0.9 all L1 = 0.565 +- 0.159 (in-sample avg dev_std = 0.510)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.934
Model XAI F1 of binarized graphs for r=0.95 =  0.518995
Model XAI WIoU of binarized graphs for r=0.95 =  0.39897750000000004
len(reference) = 800
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.492
NEC for r=0.95 class 0 = 0.59 +- 0.237 (in-sample avg dev_std = 0.554)
NEC for r=0.95 class 1 = 0.527 +- 0.237 (in-sample avg dev_std = 0.554)
NEC for r=0.95 class 2 = 0.58 +- 0.237 (in-sample avg dev_std = 0.554)
NEC for r=0.95 all KL = 0.596 +- 0.237 (in-sample avg dev_std = 0.554)
NEC for r=0.95 all L1 = 0.565 +- 0.160 (in-sample avg dev_std = 0.554)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.938
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.39040874999999997
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.502
NEC for r=1.0 class 0 = 0.572 +- 0.247 (in-sample avg dev_std = 0.578)
NEC for r=1.0 class 1 = 0.526 +- 0.247 (in-sample avg dev_std = 0.578)
NEC for r=1.0 class 2 = 0.596 +- 0.247 (in-sample avg dev_std = 0.578)
NEC for r=1.0 all KL = 0.615 +- 0.247 (in-sample avg dev_std = 0.578)
NEC for r=1.0 all L1 = 0.564 +- 0.166 (in-sample avg dev_std = 0.578)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.582
Model XAI F1 of binarized graphs for r=0.3 =  0.31931
Model XAI WIoU of binarized graphs for r=0.3 =  0.20639625000000003
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.339
NEC for r=0.3 class 0 = 0.456 +- 0.195 (in-sample avg dev_std = 0.213)
NEC for r=0.3 class 1 = 0.372 +- 0.195 (in-sample avg dev_std = 0.213)
NEC for r=0.3 class 2 = 0.434 +- 0.195 (in-sample avg dev_std = 0.213)
NEC for r=0.3 all KL = 0.262 +- 0.195 (in-sample avg dev_std = 0.213)
NEC for r=0.3 all L1 = 0.42 +- 0.159 (in-sample avg dev_std = 0.213)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.599
Model XAI F1 of binarized graphs for r=0.4 =  0.255125
Model XAI WIoU of binarized graphs for r=0.4 =  0.1599075
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.349
NEC for r=0.4 class 0 = 0.476 +- 0.198 (in-sample avg dev_std = 0.214)
NEC for r=0.4 class 1 = 0.375 +- 0.198 (in-sample avg dev_std = 0.214)
NEC for r=0.4 class 2 = 0.414 +- 0.198 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all KL = 0.259 +- 0.198 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all L1 = 0.422 +- 0.162 (in-sample avg dev_std = 0.214)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.665
Model XAI F1 of binarized graphs for r=0.6 =  0.17954499999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.11019125
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.386
NEC for r=0.6 class 0 = 0.446 +- 0.160 (in-sample avg dev_std = 0.210)
NEC for r=0.6 class 1 = 0.311 +- 0.160 (in-sample avg dev_std = 0.210)
NEC for r=0.6 class 2 = 0.392 +- 0.160 (in-sample avg dev_std = 0.210)
NEC for r=0.6 all KL = 0.209 +- 0.160 (in-sample avg dev_std = 0.210)
NEC for r=0.6 all L1 = 0.382 +- 0.154 (in-sample avg dev_std = 0.210)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.591
Model XAI F1 of binarized graphs for r=0.9 =  0.12430625000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.07582375
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.414
NEC for r=0.9 class 0 = 0.427 +- 0.225 (in-sample avg dev_std = 0.274)
NEC for r=0.9 class 1 = 0.407 +- 0.225 (in-sample avg dev_std = 0.274)
NEC for r=0.9 class 2 = 0.388 +- 0.225 (in-sample avg dev_std = 0.274)
NEC for r=0.9 all KL = 0.247 +- 0.225 (in-sample avg dev_std = 0.274)
NEC for r=0.9 all L1 = 0.408 +- 0.174 (in-sample avg dev_std = 0.274)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.592
Model XAI F1 of binarized graphs for r=0.95 =  0.11829250000000002
Model XAI WIoU of binarized graphs for r=0.95 =  0.07213375
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.413
NEC for r=0.95 class 0 = 0.379 +- 0.216 (in-sample avg dev_std = 0.269)
NEC for r=0.95 class 1 = 0.399 +- 0.216 (in-sample avg dev_std = 0.269)
NEC for r=0.95 class 2 = 0.361 +- 0.216 (in-sample avg dev_std = 0.269)
NEC for r=0.95 all KL = 0.231 +- 0.216 (in-sample avg dev_std = 0.269)
NEC for r=0.95 all L1 = 0.38 +- 0.174 (in-sample avg dev_std = 0.269)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.538
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.06909
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.435
NEC for r=1.0 class 0 = 0.327 +- 0.186 (in-sample avg dev_std = 0.231)
NEC for r=1.0 class 1 = 0.392 +- 0.186 (in-sample avg dev_std = 0.231)
NEC for r=1.0 class 2 = 0.348 +- 0.186 (in-sample avg dev_std = 0.231)
NEC for r=1.0 all KL = 0.209 +- 0.186 (in-sample avg dev_std = 0.231)
NEC for r=1.0 all L1 = 0.356 +- 0.162 (in-sample avg dev_std = 0.231)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.491
Model XAI F1 of binarized graphs for r=0.3 =  0.7335275
Model XAI WIoU of binarized graphs for r=0.3 =  0.6146275
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.406
SUFF++ for r=0.3 class 0 = 0.485 +- 0.257 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 1 = 0.613 +- 0.257 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 2 = 0.566 +- 0.257 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 all KL = 0.602 +- 0.257 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 all L1 = 0.555 +- 0.153 (in-sample avg dev_std = 0.435)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.616
Model XAI F1 of binarized graphs for r=0.4 =  0.73448875
Model XAI WIoU of binarized graphs for r=0.4 =  0.6246375000000001
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.506
SUFF++ for r=0.4 class 0 = 0.52 +- 0.242 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.4 class 1 = 0.587 +- 0.242 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.4 class 2 = 0.608 +- 0.242 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.4 all KL = 0.605 +- 0.242 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.4 all L1 = 0.572 +- 0.160 (in-sample avg dev_std = 0.441)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.761
Model XAI F1 of binarized graphs for r=0.6 =  0.65334625
Model XAI WIoU of binarized graphs for r=0.6 =  0.53425625
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.67
SUFF++ for r=0.6 class 0 = 0.593 +- 0.233 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 1 = 0.611 +- 0.233 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 2 = 0.712 +- 0.233 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 all KL = 0.699 +- 0.233 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 all L1 = 0.638 +- 0.194 (in-sample avg dev_std = 0.379)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.5329887499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.411405
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.879
SUFF++ for r=0.9 class 0 = 0.8 +- 0.164 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 class 1 = 0.851 +- 0.164 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 class 2 = 0.868 +- 0.164 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all KL = 0.898 +- 0.164 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all L1 = 0.84 +- 0.160 (in-sample avg dev_std = 0.225)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.929
Model XAI F1 of binarized graphs for r=0.95 =  0.518995
Model XAI WIoU of binarized graphs for r=0.95 =  0.39897750000000004
len(reference) = 706
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.912
SUFF++ for r=0.95 class 0 = 0.885 +- 0.127 (in-sample avg dev_std = 0.167)
SUFF++ for r=0.95 class 1 = 0.909 +- 0.127 (in-sample avg dev_std = 0.167)
SUFF++ for r=0.95 class 2 = 0.905 +- 0.127 (in-sample avg dev_std = 0.167)
SUFF++ for r=0.95 all KL = 0.941 +- 0.127 (in-sample avg dev_std = 0.167)
SUFF++ for r=0.95 all L1 = 0.899 +- 0.129 (in-sample avg dev_std = 0.167)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.581
Model XAI F1 of binarized graphs for r=0.3 =  0.31931
Model XAI WIoU of binarized graphs for r=0.3 =  0.20639625000000003
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.582
SUFF++ for r=0.3 class 0 = 0.603 +- 0.154 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.3 class 1 = 0.614 +- 0.154 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.3 class 2 = 0.64 +- 0.154 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.3 all KL = 0.756 +- 0.154 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.3 all L1 = 0.618 +- 0.121 (in-sample avg dev_std = 0.394)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.6
Model XAI F1 of binarized graphs for r=0.4 =  0.255125
Model XAI WIoU of binarized graphs for r=0.4 =  0.1599075
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.586
SUFF++ for r=0.4 class 0 = 0.611 +- 0.167 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.4 class 1 = 0.617 +- 0.167 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.4 class 2 = 0.644 +- 0.167 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.4 all KL = 0.77 +- 0.167 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.4 all L1 = 0.624 +- 0.130 (in-sample avg dev_std = 0.340)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.17954499999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.11019125
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.583
SUFF++ for r=0.6 class 0 = 0.623 +- 0.144 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.6 class 1 = 0.672 +- 0.144 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.6 class 2 = 0.669 +- 0.144 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.6 all KL = 0.802 +- 0.144 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.6 all L1 = 0.655 +- 0.115 (in-sample avg dev_std = 0.322)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.592
Model XAI F1 of binarized graphs for r=0.9 =  0.12430625000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.07582375
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.607
SUFF++ for r=0.9 class 0 = 0.728 +- 0.159 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 1 = 0.719 +- 0.159 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 2 = 0.728 +- 0.159 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 all KL = 0.866 +- 0.159 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 all L1 = 0.725 +- 0.157 (in-sample avg dev_std = 0.241)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.595
Model XAI F1 of binarized graphs for r=0.95 =  0.11829250000000002
Model XAI WIoU of binarized graphs for r=0.95 =  0.07213375
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.579
SUFF++ for r=0.95 class 0 = 0.851 +- 0.077 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.95 class 1 = 0.818 +- 0.077 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.95 class 2 = 0.823 +- 0.077 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.95 all KL = 0.943 +- 0.077 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.95 all L1 = 0.831 +- 0.108 (in-sample avg dev_std = 0.137)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 14:45:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/08/2024 02:45:44 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 02:45:56 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 02:45:58 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 02:45:59 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 02:46:03 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 02:46:09 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 02:46:09 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 02:46:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:46:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:46:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:46:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:46:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:46:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:46:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:46:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3330
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3362
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4896
OOD Test ACCURACY: 0.5230
OOD Test Loss: 2.0987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3396
ID Validation ACCURACY: 0.9320
ID Validation Loss: 0.3109
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3440
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4703
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.1198

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.5230 0.9260 0.5683 0.9320 0.9000[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.724
WIoU for r=0.3 = 0.606
F1 for r=0.4 = 0.733
WIoU for r=0.4 = 0.625
F1 for r=0.6 = 0.658
WIoU for r=0.6 = 0.540
F1 for r=0.9 = 0.534
WIoU for r=0.9 = 0.412
F1 for r=0.95 = 0.519
WIoU for r=0.95 = 0.398
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.390
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))

Gold ratio (test) =  tensor(0.0605) +- tensor(0.0246)
F1 for r=0.3 = 0.317
WIoU for r=0.3 = 0.201
F1 for r=0.4 = 0.253
WIoU for r=0.4 = 0.155
F1 for r=0.6 = 0.180
WIoU for r=0.6 = 0.108
F1 for r=0.9 = 0.124
WIoU for r=0.9 = 0.074
F1 for r=0.95 = 0.118
WIoU for r=0.95 = 0.071
F1 for r=1.0 = 0.113
WIoU for r=1.0 = 0.067


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.482
Model XAI F1 of binarized graphs for r=0.3 =  0.72429625
Model XAI WIoU of binarized graphs for r=0.3 =  0.6055962500000001
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.326
NEC for r=0.3 class 0 = 0.61 +- 0.317 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 1 = 0.509 +- 0.317 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 2 = 0.601 +- 0.317 (in-sample avg dev_std = 0.400)
NEC for r=0.3 all KL = 0.559 +- 0.317 (in-sample avg dev_std = 0.400)
NEC for r=0.3 all L1 = 0.573 +- 0.203 (in-sample avg dev_std = 0.400)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.594
Model XAI F1 of binarized graphs for r=0.4 =  0.7325849999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.62492125
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.326
NEC for r=0.4 class 0 = 0.591 +- 0.306 (in-sample avg dev_std = 0.442)
NEC for r=0.4 class 1 = 0.554 +- 0.306 (in-sample avg dev_std = 0.442)
NEC for r=0.4 class 2 = 0.624 +- 0.306 (in-sample avg dev_std = 0.442)
NEC for r=0.4 all KL = 0.616 +- 0.306 (in-sample avg dev_std = 0.442)
NEC for r=0.4 all L1 = 0.589 +- 0.186 (in-sample avg dev_std = 0.442)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.744
Model XAI F1 of binarized graphs for r=0.6 =  0.6578325
Model XAI WIoU of binarized graphs for r=0.6 =  0.5399175
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.376
NEC for r=0.6 class 0 = 0.586 +- 0.268 (in-sample avg dev_std = 0.497)
NEC for r=0.6 class 1 = 0.577 +- 0.268 (in-sample avg dev_std = 0.497)
NEC for r=0.6 class 2 = 0.624 +- 0.268 (in-sample avg dev_std = 0.497)
NEC for r=0.6 all KL = 0.643 +- 0.268 (in-sample avg dev_std = 0.497)
NEC for r=0.6 all L1 = 0.595 +- 0.172 (in-sample avg dev_std = 0.497)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.915
Model XAI F1 of binarized graphs for r=0.9 =  0.53362375
Model XAI WIoU of binarized graphs for r=0.9 =  0.41183375
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.475
NEC for r=0.9 class 0 = 0.57 +- 0.252 (in-sample avg dev_std = 0.561)
NEC for r=0.9 class 1 = 0.525 +- 0.252 (in-sample avg dev_std = 0.561)
NEC for r=0.9 class 2 = 0.579 +- 0.252 (in-sample avg dev_std = 0.561)
NEC for r=0.9 all KL = 0.582 +- 0.252 (in-sample avg dev_std = 0.561)
NEC for r=0.9 all L1 = 0.558 +- 0.166 (in-sample avg dev_std = 0.561)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.933
Model XAI F1 of binarized graphs for r=0.95 =  0.51869
Model XAI WIoU of binarized graphs for r=0.95 =  0.39842124999999995
len(reference) = 800
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.485
NEC for r=0.95 class 0 = 0.582 +- 0.249 (in-sample avg dev_std = 0.585)
NEC for r=0.95 class 1 = 0.523 +- 0.249 (in-sample avg dev_std = 0.585)
NEC for r=0.95 class 2 = 0.576 +- 0.249 (in-sample avg dev_std = 0.585)
NEC for r=0.95 all KL = 0.598 +- 0.249 (in-sample avg dev_std = 0.585)
NEC for r=0.95 all L1 = 0.56 +- 0.167 (in-sample avg dev_std = 0.585)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.939
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.38990250000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.507
NEC for r=1.0 class 0 = 0.567 +- 0.254 (in-sample avg dev_std = 0.601)
NEC for r=1.0 class 1 = 0.511 +- 0.254 (in-sample avg dev_std = 0.601)
NEC for r=1.0 class 2 = 0.585 +- 0.254 (in-sample avg dev_std = 0.601)
NEC for r=1.0 all KL = 0.613 +- 0.254 (in-sample avg dev_std = 0.601)
NEC for r=1.0 all L1 = 0.554 +- 0.175 (in-sample avg dev_std = 0.601)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.566
Model XAI F1 of binarized graphs for r=0.3 =  0.3172825
Model XAI WIoU of binarized graphs for r=0.3 =  0.20112000000000002
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.341
NEC for r=0.3 class 0 = 0.385 +- 0.229 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 1 = 0.421 +- 0.229 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 2 = 0.413 +- 0.229 (in-sample avg dev_std = 0.198)
NEC for r=0.3 all KL = 0.272 +- 0.229 (in-sample avg dev_std = 0.198)
NEC for r=0.3 all L1 = 0.406 +- 0.212 (in-sample avg dev_std = 0.198)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.569
Model XAI F1 of binarized graphs for r=0.4 =  0.25349499999999997
Model XAI WIoU of binarized graphs for r=0.4 =  0.15517875
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.337
NEC for r=0.4 class 0 = 0.432 +- 0.207 (in-sample avg dev_std = 0.212)
NEC for r=0.4 class 1 = 0.41 +- 0.207 (in-sample avg dev_std = 0.212)
NEC for r=0.4 class 2 = 0.422 +- 0.207 (in-sample avg dev_std = 0.212)
NEC for r=0.4 all KL = 0.271 +- 0.207 (in-sample avg dev_std = 0.212)
NEC for r=0.4 all L1 = 0.422 +- 0.192 (in-sample avg dev_std = 0.212)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.17977875
Model XAI WIoU of binarized graphs for r=0.6 =  0.10751874999999998
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.404
NEC for r=0.6 class 0 = 0.38 +- 0.190 (in-sample avg dev_std = 0.269)
NEC for r=0.6 class 1 = 0.351 +- 0.190 (in-sample avg dev_std = 0.269)
NEC for r=0.6 class 2 = 0.429 +- 0.190 (in-sample avg dev_std = 0.269)
NEC for r=0.6 all KL = 0.261 +- 0.190 (in-sample avg dev_std = 0.269)
NEC for r=0.6 all L1 = 0.385 +- 0.131 (in-sample avg dev_std = 0.269)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.587
Model XAI F1 of binarized graphs for r=0.9 =  0.12446375
Model XAI WIoU of binarized graphs for r=0.9 =  0.07420875
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.385
NEC for r=0.9 class 0 = 0.338 +- 0.135 (in-sample avg dev_std = 0.221)
NEC for r=0.9 class 1 = 0.332 +- 0.135 (in-sample avg dev_std = 0.221)
NEC for r=0.9 class 2 = 0.333 +- 0.135 (in-sample avg dev_std = 0.221)
NEC for r=0.9 all KL = 0.185 +- 0.135 (in-sample avg dev_std = 0.221)
NEC for r=0.9 all L1 = 0.334 +- 0.157 (in-sample avg dev_std = 0.221)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.55
Model XAI F1 of binarized graphs for r=0.95 =  0.11844000000000002
Model XAI WIoU of binarized graphs for r=0.95 =  0.07059375
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.383
NEC for r=0.95 class 0 = 0.289 +- 0.143 (in-sample avg dev_std = 0.188)
NEC for r=0.95 class 1 = 0.307 +- 0.143 (in-sample avg dev_std = 0.188)
NEC for r=0.95 class 2 = 0.273 +- 0.143 (in-sample avg dev_std = 0.188)
NEC for r=0.95 all KL = 0.165 +- 0.143 (in-sample avg dev_std = 0.188)
NEC for r=0.95 all L1 = 0.29 +- 0.170 (in-sample avg dev_std = 0.188)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.519
Model XAI F1 of binarized graphs for r=1.0 =  0.11317499999999998
Model XAI WIoU of binarized graphs for r=1.0 =  0.067485
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.379
NEC for r=1.0 class 0 = 0.242 +- 0.146 (in-sample avg dev_std = 0.177)
NEC for r=1.0 class 1 = 0.269 +- 0.146 (in-sample avg dev_std = 0.177)
NEC for r=1.0 class 2 = 0.245 +- 0.146 (in-sample avg dev_std = 0.177)
NEC for r=1.0 all KL = 0.13 +- 0.146 (in-sample avg dev_std = 0.177)
NEC for r=1.0 all L1 = 0.252 +- 0.177 (in-sample avg dev_std = 0.177)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.482
Model XAI F1 of binarized graphs for r=0.3 =  0.72429625
Model XAI WIoU of binarized graphs for r=0.3 =  0.6055962500000001
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.416
SUFF++ for r=0.3 class 0 = 0.458 +- 0.271 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.3 class 1 = 0.543 +- 0.271 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.3 class 2 = 0.548 +- 0.271 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.3 all KL = 0.516 +- 0.271 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.3 all L1 = 0.516 +- 0.167 (in-sample avg dev_std = 0.540)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.594
Model XAI F1 of binarized graphs for r=0.4 =  0.7325849999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.62492125
len(reference) = 800
Effective ratio: 0.414 +- 0.012
Model Accuracy over intervened graphs for r=0.4 =  0.527
SUFF++ for r=0.4 class 0 = 0.496 +- 0.285 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.4 class 1 = 0.531 +- 0.285 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.4 class 2 = 0.622 +- 0.285 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.4 all KL = 0.527 +- 0.285 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.4 all L1 = 0.549 +- 0.198 (in-sample avg dev_std = 0.530)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.743
Model XAI F1 of binarized graphs for r=0.6 =  0.6578325
Model XAI WIoU of binarized graphs for r=0.6 =  0.5399175
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.666
SUFF++ for r=0.6 class 0 = 0.564 +- 0.286 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 1 = 0.556 +- 0.286 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 2 = 0.758 +- 0.286 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 all KL = 0.642 +- 0.286 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 all L1 = 0.625 +- 0.234 (in-sample avg dev_std = 0.437)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.915
Model XAI F1 of binarized graphs for r=0.9 =  0.53362375
Model XAI WIoU of binarized graphs for r=0.9 =  0.41183375
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.875
SUFF++ for r=0.9 class 0 = 0.791 +- 0.166 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.9 class 1 = 0.83 +- 0.166 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.9 class 2 = 0.901 +- 0.166 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.9 all KL = 0.897 +- 0.166 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.9 all L1 = 0.84 +- 0.167 (in-sample avg dev_std = 0.214)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.928
Model XAI F1 of binarized graphs for r=0.95 =  0.51869
Model XAI WIoU of binarized graphs for r=0.95 =  0.39842124999999995
len(reference) = 706
Effective ratio: 0.965 +- 0.014
Model Accuracy over intervened graphs for r=0.95 =  0.902
SUFF++ for r=0.95 class 0 = 0.859 +- 0.135 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.95 class 1 = 0.912 +- 0.135 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.95 class 2 = 0.919 +- 0.135 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.95 all KL = 0.94 +- 0.135 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.95 all L1 = 0.896 +- 0.141 (in-sample avg dev_std = 0.175)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.569
Model XAI F1 of binarized graphs for r=0.3 =  0.3172825
Model XAI WIoU of binarized graphs for r=0.3 =  0.20112000000000002
len(reference) = 800
Effective ratio: 0.303 +- 0.002
Model Accuracy over intervened graphs for r=0.3 =  0.579
SUFF++ for r=0.3 class 0 = 0.624 +- 0.236 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 1 = 0.615 +- 0.236 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 2 = 0.677 +- 0.236 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 all KL = 0.743 +- 0.236 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 all L1 = 0.638 +- 0.121 (in-sample avg dev_std = 0.390)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.571
Model XAI F1 of binarized graphs for r=0.4 =  0.25349499999999997
Model XAI WIoU of binarized graphs for r=0.4 =  0.15517875
len(reference) = 800
Effective ratio: 0.402 +- 0.002
Model Accuracy over intervened graphs for r=0.4 =  0.567
SUFF++ for r=0.4 class 0 = 0.626 +- 0.226 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.4 class 1 = 0.623 +- 0.226 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.4 class 2 = 0.657 +- 0.226 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.4 all KL = 0.75 +- 0.226 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.4 all L1 = 0.635 +- 0.123 (in-sample avg dev_std = 0.358)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.17977875
Model XAI WIoU of binarized graphs for r=0.6 =  0.10751874999999998
len(reference) = 800
Effective ratio: 0.602 +- 0.002
Model Accuracy over intervened graphs for r=0.6 =  0.562
SUFF++ for r=0.6 class 0 = 0.585 +- 0.251 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 1 = 0.607 +- 0.251 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 2 = 0.627 +- 0.251 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 all KL = 0.684 +- 0.251 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 all L1 = 0.606 +- 0.126 (in-sample avg dev_std = 0.405)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.591
Model XAI F1 of binarized graphs for r=0.9 =  0.12446375
Model XAI WIoU of binarized graphs for r=0.9 =  0.07420875
len(reference) = 800
Effective ratio: 0.902 +- 0.002
Model Accuracy over intervened graphs for r=0.9 =  0.493
SUFF++ for r=0.9 class 0 = 0.72 +- 0.136 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 1 = 0.72 +- 0.136 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 2 = 0.761 +- 0.136 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all KL = 0.854 +- 0.136 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all L1 = 0.733 +- 0.134 (in-sample avg dev_std = 0.229)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.553
Model XAI F1 of binarized graphs for r=0.95 =  0.11844000000000002
Model XAI WIoU of binarized graphs for r=0.95 =  0.07059375
len(reference) = 800
Effective ratio: 0.952 +- 0.002
Model Accuracy over intervened graphs for r=0.95 =  0.455
SUFF++ for r=0.95 class 0 = 0.832 +- 0.095 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.95 class 1 = 0.814 +- 0.095 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.95 class 2 = 0.861 +- 0.095 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.95 all KL = 0.933 +- 0.095 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.95 all L1 = 0.835 +- 0.141 (in-sample avg dev_std = 0.134)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.504, 0.599, 0.658, 0.622, 0.612, 0.633], 'all_L1': [0.537, 0.586, 0.611, 0.57, 0.552, 0.557]}), defaultdict(<class 'list'>, {'all_KL': [0.466, 0.564, 0.583, 0.549, 0.571, 0.578], 'all_L1': [0.512, 0.568, 0.586, 0.549, 0.552, 0.547]}), defaultdict(<class 'list'>, {'all_KL': [0.494, 0.552, 0.585, 0.535, 0.551, 0.573], 'all_L1': [0.533, 0.561, 0.586, 0.547, 0.548, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.482, 0.555, 0.582, 0.569, 0.596, 0.615], 'all_L1': [0.527, 0.562, 0.587, 0.565, 0.565, 0.564]}), defaultdict(<class 'list'>, {'all_KL': [0.559, 0.616, 0.643, 0.582, 0.598, 0.613], 'all_L1': [0.573, 0.589, 0.595, 0.558, 0.56, 0.554]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.557, 0.542, 0.666, 0.896, 0.948, 1.0], 'all_L1': [0.542, 0.555, 0.656, 0.856, 0.913, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.6, 0.58, 0.687, 0.886, 0.942, 1.0], 'all_L1': [0.568, 0.569, 0.641, 0.817, 0.886, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.582, 0.6, 0.713, 0.901, 0.94, 1.0], 'all_L1': [0.555, 0.575, 0.66, 0.831, 0.887, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.602, 0.605, 0.699, 0.898, 0.941, 1.0], 'all_L1': [0.555, 0.572, 0.638, 0.84, 0.899, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.516, 0.527, 0.642, 0.897, 0.94, 1.0], 'all_L1': [0.516, 0.549, 0.625, 0.84, 0.896, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]

Eval split test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.32, 0.247, 0.235, 0.2, 0.152, 0.138], 'all_L1': [0.476, 0.416, 0.376, 0.32, 0.264, 0.232]}), defaultdict(<class 'list'>, {'all_KL': [0.268, 0.274, 0.233, 0.146, 0.134, 0.115], 'all_L1': [0.448, 0.442, 0.385, 0.322, 0.302, 0.267]}), defaultdict(<class 'list'>, {'all_KL': [0.206, 0.207, 0.152, 0.144, 0.121, 0.143], 'all_L1': [0.346, 0.367, 0.32, 0.293, 0.266, 0.271]}), defaultdict(<class 'list'>, {'all_KL': [0.262, 0.259, 0.209, 0.247, 0.231, 0.209], 'all_L1': [0.42, 0.422, 0.382, 0.408, 0.38, 0.356]}), defaultdict(<class 'list'>, {'all_KL': [0.272, 0.271, 0.261, 0.185, 0.165, 0.13], 'all_L1': [0.406, 0.422, 0.385, 0.334, 0.29, 0.252]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.761, 0.778, 0.713, 0.817, 0.921, 1.0], 'all_L1': [0.612, 0.621, 0.615, 0.725, 0.852, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.85, 0.823, 0.759, 0.896, 0.947, 1.0], 'all_L1': [0.685, 0.666, 0.642, 0.75, 0.839, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.81, 0.81, 0.756, 0.83, 0.947, 1.0], 'all_L1': [0.682, 0.668, 0.632, 0.732, 0.843, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.756, 0.77, 0.802, 0.866, 0.943, 1.0], 'all_L1': [0.618, 0.624, 0.655, 0.725, 0.831, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.743, 0.75, 0.684, 0.854, 0.933, 1.0], 'all_L1': [0.638, 0.635, 0.606, 0.733, 0.835, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.536 +- 0.020, 0.573 +- 0.012, 0.593 +- 0.010, 0.558 +- 0.009, 0.555 +- 0.006, 0.556 +- 0.005
nec class all_KL  =  0.501 +- 0.032, 0.577 +- 0.026, 0.610 +- 0.033, 0.571 +- 0.030, 0.586 +- 0.022, 0.602 +- 0.023
nec_acc_int  =  0.325 +- 0.008, 0.336 +- 0.007, 0.382 +- 0.008, 0.472 +- 0.004, 0.493 +- 0.011, 0.504 +- 0.008
suff++ class all_L1  =  0.547 +- 0.018, 0.564 +- 0.010, 0.644 +- 0.013, 0.837 +- 0.013, 0.896 +- 0.010, 1.000 +- 0.000
suff++ class all_KL  =  0.571 +- 0.032, 0.571 +- 0.031, 0.681 +- 0.025, 0.896 +- 0.005, 0.942 +- 0.003, 1.000 +- 0.000
suff++_acc_int  =  0.418 +- 0.008, 0.523 +- 0.014, 0.687 +- 0.020, 0.875 +- 0.008, 0.902 +- 0.008

Eval split test
nec class all_L1  =  0.419 +- 0.044, 0.414 +- 0.025, 0.370 +- 0.025, 0.335 +- 0.039, 0.300 +- 0.042, 0.276 +- 0.042
nec class all_KL  =  0.266 +- 0.036, 0.252 +- 0.024, 0.218 +- 0.037, 0.184 +- 0.038, 0.161 +- 0.038, 0.147 +- 0.032
nec_acc_int  =  0.345 +- 0.008, 0.352 +- 0.012, 0.393 +- 0.012, 0.393 +- 0.022, 0.392 +- 0.020, 0.399 +- 0.025
suff++ class all_L1  =  0.647 +- 0.031, 0.643 +- 0.020, 0.630 +- 0.018, 0.733 +- 0.009, 0.840 +- 0.007, 1.000 +- 0.000
suff++ class all_KL  =  0.784 +- 0.040, 0.786 +- 0.027, 0.743 +- 0.041, 0.853 +- 0.028, 0.938 +- 0.010, 1.000 +- 0.000
suff++_acc_int  =  0.564 +- 0.035, 0.566 +- 0.029, 0.579 +- 0.017, 0.526 +- 0.048, 0.504 +- 0.043


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.542 +- 0.002, 0.569 +- 0.001, 0.619 +- 0.009, 0.697 +- 0.010, 0.726 +- 0.006, 0.778 +- 0.003
Faith. Armon (L1)= 		  =  0.541 +- 0.002, 0.568 +- 0.001, 0.617 +- 0.009, 0.669 +- 0.010, 0.686 +- 0.006, 0.714 +- 0.005
Faith. GMean (L1)= 	  =  0.541 +- 0.002, 0.568 +- 0.001, 0.618 +- 0.009, 0.683 +- 0.010, 0.705 +- 0.006, 0.745 +- 0.004
Faith. Aritm (KL)= 		  =  0.536 +- 0.004, 0.574 +- 0.004, 0.646 +- 0.009, 0.734 +- 0.015, 0.764 +- 0.012, 0.801 +- 0.012
Faith. Armon (KL)= 		  =  0.532 +- 0.005, 0.573 +- 0.004, 0.643 +- 0.011, 0.697 +- 0.022, 0.722 +- 0.017, 0.752 +- 0.018
Faith. GMean (KL)= 	  =  0.534 +- 0.004, 0.573 +- 0.004, 0.644 +- 0.010, 0.715 +- 0.019, 0.743 +- 0.015, 0.776 +- 0.015

Eval split test
Faith. Aritm (L1)= 		  =  0.533 +- 0.020, 0.528 +- 0.013, 0.500 +- 0.015, 0.534 +- 0.018, 0.570 +- 0.018, 0.638 +- 0.021
Faith. Armon (L1)= 		  =  0.507 +- 0.030, 0.503 +- 0.018, 0.465 +- 0.021, 0.459 +- 0.034, 0.441 +- 0.043, 0.430 +- 0.050
Faith. GMean (L1)= 	  =  0.520 +- 0.024, 0.515 +- 0.016, 0.482 +- 0.018, 0.495 +- 0.027, 0.501 +- 0.032, 0.524 +- 0.039
Faith. Aritm (KL)= 		  =  0.525 +- 0.021, 0.519 +- 0.015, 0.480 +- 0.018, 0.518 +- 0.023, 0.549 +- 0.019, 0.574 +- 0.016
Faith. Armon (KL)= 		  =  0.395 +- 0.039, 0.380 +- 0.028, 0.335 +- 0.043, 0.301 +- 0.051, 0.272 +- 0.054, 0.255 +- 0.048
Faith. GMean (KL)= 	  =  0.455 +- 0.029, 0.444 +- 0.021, 0.400 +- 0.031, 0.394 +- 0.040, 0.386 +- 0.044, 0.381 +- 0.040
Computed for split load_split = id



Completed in  0:37:47.306689  for GSATGIN GOODMotif/size



DONE GSAT GOODMotif/size

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 14:53:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:53:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.715
WIoU for r=0.3 = 0.680
F1 for r=0.4 = 0.721
WIoU for r=0.4 = 0.753
F1 for r=0.6 = 0.616
WIoU for r=0.6 = 0.753
F1 for r=0.9 = 0.473
WIoU for r=0.9 = 0.747
F1 for r=0.95 = 0.456
WIoU for r=0.95 = 0.747
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.747
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.782
WIoU for r=0.3 = 0.908
F1 for r=0.4 = 0.739
WIoU for r=0.4 = 0.979
F1 for r=0.6 = 0.565
WIoU for r=0.6 = 0.958
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.956
F1 for r=0.95 = 0.404
WIoU for r=0.95 = 0.956
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.956


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.543
Model XAI F1 of binarized graphs for r=0.3 =  0.7154362500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.67951625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.381
NEC for r=0.3 class 0 = 0.583 +- 0.292 (in-sample avg dev_std = 0.445)
NEC for r=0.3 class 1 = 0.499 +- 0.292 (in-sample avg dev_std = 0.445)
NEC for r=0.3 class 2 = 0.58 +- 0.292 (in-sample avg dev_std = 0.445)
NEC for r=0.3 all KL = 0.591 +- 0.292 (in-sample avg dev_std = 0.445)
NEC for r=0.3 all L1 = 0.555 +- 0.171 (in-sample avg dev_std = 0.445)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.794
Model XAI F1 of binarized graphs for r=0.4 =  0.7209225
Model XAI WIoU of binarized graphs for r=0.4 =  0.7533875000000001
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.43
NEC for r=0.4 class 0 = 0.629 +- 0.285 (in-sample avg dev_std = 0.457)
NEC for r=0.4 class 1 = 0.465 +- 0.285 (in-sample avg dev_std = 0.457)
NEC for r=0.4 class 2 = 0.62 +- 0.285 (in-sample avg dev_std = 0.457)
NEC for r=0.4 all KL = 0.597 +- 0.285 (in-sample avg dev_std = 0.457)
NEC for r=0.4 all L1 = 0.572 +- 0.170 (in-sample avg dev_std = 0.457)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.886
Model XAI F1 of binarized graphs for r=0.6 =  0.6161525
Model XAI WIoU of binarized graphs for r=0.6 =  0.7525425000000001
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.51
NEC for r=0.6 class 0 = 0.578 +- 0.319 (in-sample avg dev_std = 0.482)
NEC for r=0.6 class 1 = 0.416 +- 0.319 (in-sample avg dev_std = 0.482)
NEC for r=0.6 class 2 = 0.604 +- 0.319 (in-sample avg dev_std = 0.482)
NEC for r=0.6 all KL = 0.542 +- 0.319 (in-sample avg dev_std = 0.482)
NEC for r=0.6 all L1 = 0.534 +- 0.182 (in-sample avg dev_std = 0.482)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  0.47311
Model XAI WIoU of binarized graphs for r=0.9 =  0.74703875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.602
NEC for r=0.9 class 0 = 0.505 +- 0.305 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 1 = 0.385 +- 0.305 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 2 = 0.509 +- 0.305 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all KL = 0.461 +- 0.305 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all L1 = 0.468 +- 0.176 (in-sample avg dev_std = 0.508)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.886
Model XAI F1 of binarized graphs for r=0.95 =  0.4556875
Model XAI WIoU of binarized graphs for r=0.95 =  0.74696875
len(reference) = 800
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.599
NEC for r=0.95 class 0 = 0.511 +- 0.300 (in-sample avg dev_std = 0.510)
NEC for r=0.95 class 1 = 0.378 +- 0.300 (in-sample avg dev_std = 0.510)
NEC for r=0.95 class 2 = 0.512 +- 0.300 (in-sample avg dev_std = 0.510)
NEC for r=0.95 all KL = 0.461 +- 0.300 (in-sample avg dev_std = 0.510)
NEC for r=0.95 all L1 = 0.468 +- 0.171 (in-sample avg dev_std = 0.510)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.89
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.7469425
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.605
NEC for r=1.0 class 0 = 0.506 +- 0.303 (in-sample avg dev_std = 0.515)
NEC for r=1.0 class 1 = 0.377 +- 0.303 (in-sample avg dev_std = 0.515)
NEC for r=1.0 class 2 = 0.495 +- 0.303 (in-sample avg dev_std = 0.515)
NEC for r=1.0 all KL = 0.453 +- 0.303 (in-sample avg dev_std = 0.515)
NEC for r=1.0 all L1 = 0.46 +- 0.170 (in-sample avg dev_std = 0.515)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.699
Model XAI F1 of binarized graphs for r=0.3 =  0.7824275
Model XAI WIoU of binarized graphs for r=0.3 =  0.90822125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.369
NEC for r=0.3 class 0 = 0.661 +- 0.299 (in-sample avg dev_std = 0.485)
NEC for r=0.3 class 1 = 0.475 +- 0.299 (in-sample avg dev_std = 0.485)
NEC for r=0.3 class 2 = 0.622 +- 0.299 (in-sample avg dev_std = 0.485)
NEC for r=0.3 all KL = 0.657 +- 0.299 (in-sample avg dev_std = 0.485)
NEC for r=0.3 all L1 = 0.584 +- 0.153 (in-sample avg dev_std = 0.485)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.899
Model XAI F1 of binarized graphs for r=0.4 =  0.7388162499999998
Model XAI WIoU of binarized graphs for r=0.4 =  0.9794125
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.463
NEC for r=0.4 class 0 = 0.62 +- 0.343 (in-sample avg dev_std = 0.477)
NEC for r=0.4 class 1 = 0.438 +- 0.343 (in-sample avg dev_std = 0.477)
NEC for r=0.4 class 2 = 0.621 +- 0.343 (in-sample avg dev_std = 0.477)
NEC for r=0.4 all KL = 0.633 +- 0.343 (in-sample avg dev_std = 0.477)
NEC for r=0.4 all L1 = 0.558 +- 0.189 (in-sample avg dev_std = 0.477)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.899
Model XAI F1 of binarized graphs for r=0.6 =  0.5651437500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.95768625
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.543
NEC for r=0.6 class 0 = 0.514 +- 0.354 (in-sample avg dev_std = 0.491)
NEC for r=0.6 class 1 = 0.35 +- 0.354 (in-sample avg dev_std = 0.491)
NEC for r=0.6 class 2 = 0.551 +- 0.354 (in-sample avg dev_std = 0.491)
NEC for r=0.6 all KL = 0.503 +- 0.354 (in-sample avg dev_std = 0.491)
NEC for r=0.6 all L1 = 0.47 +- 0.206 (in-sample avg dev_std = 0.491)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.95569125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.65
NEC for r=0.9 class 0 = 0.422 +- 0.317 (in-sample avg dev_std = 0.531)
NEC for r=0.9 class 1 = 0.286 +- 0.317 (in-sample avg dev_std = 0.531)
NEC for r=0.9 class 2 = 0.439 +- 0.317 (in-sample avg dev_std = 0.531)
NEC for r=0.9 all KL = 0.405 +- 0.317 (in-sample avg dev_std = 0.531)
NEC for r=0.9 all L1 = 0.381 +- 0.190 (in-sample avg dev_std = 0.531)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.899
Model XAI F1 of binarized graphs for r=0.95 =  0.40367624999999996
Model XAI WIoU of binarized graphs for r=0.95 =  0.95569125
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.675
NEC for r=0.95 class 0 = 0.397 +- 0.308 (in-sample avg dev_std = 0.523)
NEC for r=0.95 class 1 = 0.276 +- 0.308 (in-sample avg dev_std = 0.523)
NEC for r=0.95 class 2 = 0.428 +- 0.308 (in-sample avg dev_std = 0.523)
NEC for r=0.95 all KL = 0.386 +- 0.308 (in-sample avg dev_std = 0.523)
NEC for r=0.95 all L1 = 0.366 +- 0.181 (in-sample avg dev_std = 0.523)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.899
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.95569125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.678
NEC for r=1.0 class 0 = 0.395 +- 0.316 (in-sample avg dev_std = 0.527)
NEC for r=1.0 class 1 = 0.284 +- 0.316 (in-sample avg dev_std = 0.527)
NEC for r=1.0 class 2 = 0.432 +- 0.316 (in-sample avg dev_std = 0.527)
NEC for r=1.0 all KL = 0.393 +- 0.316 (in-sample avg dev_std = 0.527)
NEC for r=1.0 all L1 = 0.369 +- 0.190 (in-sample avg dev_std = 0.527)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.543
Model XAI F1 of binarized graphs for r=0.3 =  0.7154362500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.67951625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.525
SUFF++ for r=0.3 class 0 = 0.563 +- 0.294 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 1 = 0.553 +- 0.294 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 2 = 0.552 +- 0.294 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 all KL = 0.514 +- 0.294 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 all L1 = 0.556 +- 0.198 (in-sample avg dev_std = 0.519)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.794
Model XAI F1 of binarized graphs for r=0.4 =  0.7209225
Model XAI WIoU of binarized graphs for r=0.4 =  0.7533875000000001
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.603
SUFF++ for r=0.4 class 0 = 0.504 +- 0.292 (in-sample avg dev_std = 0.571)
SUFF++ for r=0.4 class 1 = 0.587 +- 0.292 (in-sample avg dev_std = 0.571)
SUFF++ for r=0.4 class 2 = 0.53 +- 0.292 (in-sample avg dev_std = 0.571)
SUFF++ for r=0.4 all KL = 0.503 +- 0.292 (in-sample avg dev_std = 0.571)
SUFF++ for r=0.4 all L1 = 0.54 +- 0.198 (in-sample avg dev_std = 0.571)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.886
Model XAI F1 of binarized graphs for r=0.6 =  0.6161525
Model XAI WIoU of binarized graphs for r=0.6 =  0.7525425000000001
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.774
SUFF++ for r=0.6 class 0 = 0.698 +- 0.250 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 1 = 0.675 +- 0.250 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 class 2 = 0.694 +- 0.250 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 all KL = 0.724 +- 0.250 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.6 all L1 = 0.689 +- 0.201 (in-sample avg dev_std = 0.381)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  0.47311
Model XAI WIoU of binarized graphs for r=0.9 =  0.74703875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.809
SUFF++ for r=0.9 class 0 = 0.789 +- 0.194 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 class 1 = 0.725 +- 0.194 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 class 2 = 0.798 +- 0.194 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 all KL = 0.852 +- 0.194 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 all L1 = 0.771 +- 0.195 (in-sample avg dev_std = 0.259)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.884
Model XAI F1 of binarized graphs for r=0.95 =  0.4556875
Model XAI WIoU of binarized graphs for r=0.95 =  0.74696875
len(reference) = 732
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.851
SUFF++ for r=0.95 class 0 = 0.838 +- 0.135 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.95 class 1 = 0.795 +- 0.135 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.95 class 2 = 0.866 +- 0.135 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.95 all KL = 0.916 +- 0.135 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.95 all L1 = 0.834 +- 0.157 (in-sample avg dev_std = 0.216)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.699
Model XAI F1 of binarized graphs for r=0.3 =  0.7824275
Model XAI WIoU of binarized graphs for r=0.3 =  0.90822125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.653
SUFF++ for r=0.3 class 0 = 0.619 +- 0.326 (in-sample avg dev_std = 0.565)
SUFF++ for r=0.3 class 1 = 0.676 +- 0.326 (in-sample avg dev_std = 0.565)
SUFF++ for r=0.3 class 2 = 0.641 +- 0.326 (in-sample avg dev_std = 0.565)
SUFF++ for r=0.3 all KL = 0.582 +- 0.326 (in-sample avg dev_std = 0.565)
SUFF++ for r=0.3 all L1 = 0.646 +- 0.210 (in-sample avg dev_std = 0.565)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.899
Model XAI F1 of binarized graphs for r=0.4 =  0.7388162499999998
Model XAI WIoU of binarized graphs for r=0.4 =  0.9794125
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.814
SUFF++ for r=0.4 class 0 = 0.699 +- 0.333 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.4 class 1 = 0.718 +- 0.333 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.4 class 2 = 0.756 +- 0.333 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.4 all KL = 0.647 +- 0.333 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.4 all L1 = 0.725 +- 0.169 (in-sample avg dev_std = 0.511)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.899
Model XAI F1 of binarized graphs for r=0.6 =  0.5651437500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.95768625
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.829
SUFF++ for r=0.6 class 0 = 0.788 +- 0.190 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 class 1 = 0.69 +- 0.190 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 class 2 = 0.821 +- 0.190 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 all KL = 0.801 +- 0.190 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.6 all L1 = 0.766 +- 0.151 (in-sample avg dev_std = 0.372)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.95569125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.883
SUFF++ for r=0.9 class 0 = 0.908 +- 0.121 (in-sample avg dev_std = 0.120)
SUFF++ for r=0.9 class 1 = 0.804 +- 0.121 (in-sample avg dev_std = 0.120)
SUFF++ for r=0.9 class 2 = 0.875 +- 0.121 (in-sample avg dev_std = 0.120)
SUFF++ for r=0.9 all KL = 0.929 +- 0.121 (in-sample avg dev_std = 0.120)
SUFF++ for r=0.9 all L1 = 0.862 +- 0.156 (in-sample avg dev_std = 0.120)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.899
Model XAI F1 of binarized graphs for r=0.95 =  0.40367624999999996
Model XAI WIoU of binarized graphs for r=0.95 =  0.95569125
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.912
SUFF++ for r=0.95 class 0 = 0.934 +- 0.077 (in-sample avg dev_std = 0.065)
SUFF++ for r=0.95 class 1 = 0.927 +- 0.077 (in-sample avg dev_std = 0.065)
SUFF++ for r=0.95 class 2 = 0.944 +- 0.077 (in-sample avg dev_std = 0.065)
SUFF++ for r=0.95 all KL = 0.979 +- 0.077 (in-sample avg dev_std = 0.065)
SUFF++ for r=0.95 all L1 = 0.935 +- 0.114 (in-sample avg dev_std = 0.065)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 14:57:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 02:57:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.739
WIoU for r=0.3 = 0.724
F1 for r=0.4 = 0.728
WIoU for r=0.4 = 0.789
F1 for r=0.6 = 0.616
WIoU for r=0.6 = 0.786
F1 for r=0.9 = 0.473
WIoU for r=0.9 = 0.785
F1 for r=0.95 = 0.456
WIoU for r=0.95 = 0.785
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.785
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.726
WIoU for r=0.3 = 0.842
F1 for r=0.4 = 0.700
WIoU for r=0.4 = 0.909
F1 for r=0.6 = 0.565
WIoU for r=0.6 = 0.846
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.795
F1 for r=0.95 = 0.404
WIoU for r=0.95 = 0.790
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.788


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.663
Model XAI F1 of binarized graphs for r=0.3 =  0.73866625
Model XAI WIoU of binarized graphs for r=0.3 =  0.72356
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.374
NEC for r=0.3 class 0 = 0.572 +- 0.281 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 1 = 0.513 +- 0.281 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 2 = 0.585 +- 0.281 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all KL = 0.619 +- 0.281 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all L1 = 0.558 +- 0.150 (in-sample avg dev_std = 0.403)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.784
Model XAI F1 of binarized graphs for r=0.4 =  0.72766375
Model XAI WIoU of binarized graphs for r=0.4 =  0.78898125
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.384
NEC for r=0.4 class 0 = 0.601 +- 0.292 (in-sample avg dev_std = 0.428)
NEC for r=0.4 class 1 = 0.53 +- 0.292 (in-sample avg dev_std = 0.428)
NEC for r=0.4 class 2 = 0.595 +- 0.292 (in-sample avg dev_std = 0.428)
NEC for r=0.4 all KL = 0.62 +- 0.292 (in-sample avg dev_std = 0.428)
NEC for r=0.4 all L1 = 0.576 +- 0.145 (in-sample avg dev_std = 0.428)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.881
Model XAI F1 of binarized graphs for r=0.6 =  0.61638375
Model XAI WIoU of binarized graphs for r=0.6 =  0.7859
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.447
NEC for r=0.6 class 0 = 0.561 +- 0.302 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 1 = 0.519 +- 0.302 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 2 = 0.611 +- 0.302 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all KL = 0.594 +- 0.302 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all L1 = 0.565 +- 0.162 (in-sample avg dev_std = 0.447)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.47285625
Model XAI WIoU of binarized graphs for r=0.9 =  0.78460625
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.546
NEC for r=0.9 class 0 = 0.479 +- 0.283 (in-sample avg dev_std = 0.497)
NEC for r=0.9 class 1 = 0.465 +- 0.283 (in-sample avg dev_std = 0.497)
NEC for r=0.9 class 2 = 0.549 +- 0.283 (in-sample avg dev_std = 0.497)
NEC for r=0.9 all KL = 0.491 +- 0.283 (in-sample avg dev_std = 0.497)
NEC for r=0.9 all L1 = 0.499 +- 0.163 (in-sample avg dev_std = 0.497)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.904
Model XAI F1 of binarized graphs for r=0.95 =  0.4555025
Model XAI WIoU of binarized graphs for r=0.95 =  0.784685
len(reference) = 800
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.529
NEC for r=0.95 class 0 = 0.497 +- 0.283 (in-sample avg dev_std = 0.495)
NEC for r=0.95 class 1 = 0.471 +- 0.283 (in-sample avg dev_std = 0.495)
NEC for r=0.95 class 2 = 0.547 +- 0.283 (in-sample avg dev_std = 0.495)
NEC for r=0.95 all KL = 0.501 +- 0.283 (in-sample avg dev_std = 0.495)
NEC for r=0.95 all L1 = 0.506 +- 0.165 (in-sample avg dev_std = 0.495)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.908
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.7847825
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.548
NEC for r=1.0 class 0 = 0.485 +- 0.278 (in-sample avg dev_std = 0.498)
NEC for r=1.0 class 1 = 0.47 +- 0.278 (in-sample avg dev_std = 0.498)
NEC for r=1.0 class 2 = 0.545 +- 0.278 (in-sample avg dev_std = 0.498)
NEC for r=1.0 all KL = 0.494 +- 0.278 (in-sample avg dev_std = 0.498)
NEC for r=1.0 all L1 = 0.501 +- 0.158 (in-sample avg dev_std = 0.498)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.556
Model XAI F1 of binarized graphs for r=0.3 =  0.7263150000000002
Model XAI WIoU of binarized graphs for r=0.3 =  0.8424875000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.444
NEC for r=0.3 class 0 = 0.488 +- 0.215 (in-sample avg dev_std = 0.474)
NEC for r=0.3 class 1 = 0.508 +- 0.215 (in-sample avg dev_std = 0.474)
NEC for r=0.3 class 2 = 0.57 +- 0.215 (in-sample avg dev_std = 0.474)
NEC for r=0.3 all KL = 0.481 +- 0.215 (in-sample avg dev_std = 0.474)
NEC for r=0.3 all L1 = 0.522 +- 0.124 (in-sample avg dev_std = 0.474)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.731
Model XAI F1 of binarized graphs for r=0.4 =  0.6997162499999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.90945875
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.479
NEC for r=0.4 class 0 = 0.415 +- 0.310 (in-sample avg dev_std = 0.498)
NEC for r=0.4 class 1 = 0.483 +- 0.310 (in-sample avg dev_std = 0.498)
NEC for r=0.4 class 2 = 0.613 +- 0.310 (in-sample avg dev_std = 0.498)
NEC for r=0.4 all KL = 0.509 +- 0.310 (in-sample avg dev_std = 0.498)
NEC for r=0.4 all L1 = 0.504 +- 0.187 (in-sample avg dev_std = 0.498)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.5651437500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.8456575000000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.525
NEC for r=0.6 class 0 = 0.442 +- 0.338 (in-sample avg dev_std = 0.534)
NEC for r=0.6 class 1 = 0.457 +- 0.338 (in-sample avg dev_std = 0.534)
NEC for r=0.6 class 2 = 0.54 +- 0.338 (in-sample avg dev_std = 0.534)
NEC for r=0.6 all KL = 0.477 +- 0.338 (in-sample avg dev_std = 0.534)
NEC for r=0.6 all L1 = 0.48 +- 0.195 (in-sample avg dev_std = 0.534)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.7951375000000002
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.603
NEC for r=0.9 class 0 = 0.415 +- 0.331 (in-sample avg dev_std = 0.577)
NEC for r=0.9 class 1 = 0.442 +- 0.331 (in-sample avg dev_std = 0.577)
NEC for r=0.9 class 2 = 0.443 +- 0.331 (in-sample avg dev_std = 0.577)
NEC for r=0.9 all KL = 0.447 +- 0.331 (in-sample avg dev_std = 0.577)
NEC for r=0.9 all L1 = 0.434 +- 0.194 (in-sample avg dev_std = 0.577)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.891
Model XAI F1 of binarized graphs for r=0.95 =  0.40367624999999996
Model XAI WIoU of binarized graphs for r=0.95 =  0.79022125
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.597
NEC for r=0.95 class 0 = 0.42 +- 0.328 (in-sample avg dev_std = 0.575)
NEC for r=0.95 class 1 = 0.439 +- 0.328 (in-sample avg dev_std = 0.575)
NEC for r=0.95 class 2 = 0.452 +- 0.328 (in-sample avg dev_std = 0.575)
NEC for r=0.95 all KL = 0.45 +- 0.328 (in-sample avg dev_std = 0.575)
NEC for r=0.95 all L1 = 0.437 +- 0.190 (in-sample avg dev_std = 0.575)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.891
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.7882975000000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.603
NEC for r=1.0 class 0 = 0.419 +- 0.324 (in-sample avg dev_std = 0.576)
NEC for r=1.0 class 1 = 0.435 +- 0.324 (in-sample avg dev_std = 0.576)
NEC for r=1.0 class 2 = 0.44 +- 0.324 (in-sample avg dev_std = 0.576)
NEC for r=1.0 all KL = 0.444 +- 0.324 (in-sample avg dev_std = 0.576)
NEC for r=1.0 all L1 = 0.431 +- 0.186 (in-sample avg dev_std = 0.576)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.665
Model XAI F1 of binarized graphs for r=0.3 =  0.73866625
Model XAI WIoU of binarized graphs for r=0.3 =  0.72356
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.52
SUFF++ for r=0.3 class 0 = 0.497 +- 0.261 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.3 class 1 = 0.64 +- 0.261 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.3 class 2 = 0.529 +- 0.261 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.3 all KL = 0.487 +- 0.261 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.3 all L1 = 0.555 +- 0.160 (in-sample avg dev_std = 0.535)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.784
Model XAI F1 of binarized graphs for r=0.4 =  0.72766375
Model XAI WIoU of binarized graphs for r=0.4 =  0.78898125
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.595
SUFF++ for r=0.4 class 0 = 0.516 +- 0.263 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.4 class 1 = 0.619 +- 0.263 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.4 class 2 = 0.52 +- 0.263 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.4 all KL = 0.49 +- 0.263 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.4 all L1 = 0.551 +- 0.151 (in-sample avg dev_std = 0.558)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.881
Model XAI F1 of binarized graphs for r=0.6 =  0.61638375
Model XAI WIoU of binarized graphs for r=0.6 =  0.7859
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.713
SUFF++ for r=0.6 class 0 = 0.648 +- 0.249 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 class 1 = 0.64 +- 0.249 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 class 2 = 0.658 +- 0.249 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 all KL = 0.644 +- 0.249 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 all L1 = 0.649 +- 0.188 (in-sample avg dev_std = 0.449)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.47285625
Model XAI WIoU of binarized graphs for r=0.9 =  0.78460625
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.817
SUFF++ for r=0.9 class 0 = 0.788 +- 0.198 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 1 = 0.792 +- 0.198 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 2 = 0.795 +- 0.198 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 all KL = 0.852 +- 0.198 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 all L1 = 0.792 +- 0.191 (in-sample avg dev_std = 0.276)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.903
Model XAI F1 of binarized graphs for r=0.95 =  0.4555025
Model XAI WIoU of binarized graphs for r=0.95 =  0.784685
len(reference) = 732
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.863
SUFF++ for r=0.95 class 0 = 0.858 +- 0.140 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.95 class 1 = 0.852 +- 0.140 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.95 class 2 = 0.853 +- 0.140 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.95 all KL = 0.919 +- 0.140 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.95 all L1 = 0.854 +- 0.158 (in-sample avg dev_std = 0.212)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.549
Model XAI F1 of binarized graphs for r=0.3 =  0.7263150000000002
Model XAI WIoU of binarized graphs for r=0.3 =  0.8424875000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.586
SUFF++ for r=0.3 class 0 = 0.599 +- 0.230 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.3 class 1 = 0.602 +- 0.230 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.3 class 2 = 0.602 +- 0.230 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.3 all KL = 0.626 +- 0.230 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.3 all L1 = 0.601 +- 0.174 (in-sample avg dev_std = 0.499)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.731
Model XAI F1 of binarized graphs for r=0.4 =  0.6997162499999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.90945875
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.69
SUFF++ for r=0.4 class 0 = 0.613 +- 0.289 (in-sample avg dev_std = 0.559)
SUFF++ for r=0.4 class 1 = 0.645 +- 0.289 (in-sample avg dev_std = 0.559)
SUFF++ for r=0.4 class 2 = 0.57 +- 0.289 (in-sample avg dev_std = 0.559)
SUFF++ for r=0.4 all KL = 0.587 +- 0.289 (in-sample avg dev_std = 0.559)
SUFF++ for r=0.4 all L1 = 0.61 +- 0.173 (in-sample avg dev_std = 0.559)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  0.5651437500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.8456575000000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.786
SUFF++ for r=0.6 class 0 = 0.68 +- 0.249 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 1 = 0.641 +- 0.249 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 class 2 = 0.725 +- 0.249 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all KL = 0.685 +- 0.249 (in-sample avg dev_std = 0.469)
SUFF++ for r=0.6 all L1 = 0.682 +- 0.161 (in-sample avg dev_std = 0.469)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.7951375000000002
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.728
SUFF++ for r=0.9 class 0 = 0.645 +- 0.373 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.9 class 1 = 0.69 +- 0.373 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.9 class 2 = 0.891 +- 0.373 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.9 all KL = 0.717 +- 0.373 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.9 all L1 = 0.743 +- 0.280 (in-sample avg dev_std = 0.466)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.891
Model XAI F1 of binarized graphs for r=0.95 =  0.40367624999999996
Model XAI WIoU of binarized graphs for r=0.95 =  0.79022125
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.601
SUFF++ for r=0.95 class 0 = 0.59 +- 0.331 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.95 class 1 = 0.565 +- 0.331 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.95 class 2 = 0.542 +- 0.331 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.95 all KL = 0.551 +- 0.331 (in-sample avg dev_std = 0.576)
SUFF++ for r=0.95 all L1 = 0.565 +- 0.192 (in-sample avg dev_std = 0.576)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 15:01:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:01:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.673
WIoU for r=0.3 = 0.596
F1 for r=0.4 = 0.700
WIoU for r=0.4 = 0.683
F1 for r=0.6 = 0.602
WIoU for r=0.6 = 0.689
F1 for r=0.9 = 0.473
WIoU for r=0.9 = 0.700
F1 for r=0.95 = 0.456
WIoU for r=0.95 = 0.700
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.700
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.782
WIoU for r=0.3 = 0.880
F1 for r=0.4 = 0.712
WIoU for r=0.4 = 0.877
F1 for r=0.6 = 0.544
WIoU for r=0.6 = 0.750
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.694
F1 for r=0.95 = 0.404
WIoU for r=0.95 = 0.692
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.691


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.509
Model XAI F1 of binarized graphs for r=0.3 =  0.6729925
Model XAI WIoU of binarized graphs for r=0.3 =  0.5961862499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.347
NEC for r=0.3 class 0 = 0.59 +- 0.279 (in-sample avg dev_std = 0.479)
NEC for r=0.3 class 1 = 0.534 +- 0.279 (in-sample avg dev_std = 0.479)
NEC for r=0.3 class 2 = 0.582 +- 0.279 (in-sample avg dev_std = 0.479)
NEC for r=0.3 all KL = 0.61 +- 0.279 (in-sample avg dev_std = 0.479)
NEC for r=0.3 all L1 = 0.569 +- 0.164 (in-sample avg dev_std = 0.479)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.738
Model XAI F1 of binarized graphs for r=0.4 =  0.6996975000000001
Model XAI WIoU of binarized graphs for r=0.4 =  0.6832187500000001
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.383
NEC for r=0.4 class 0 = 0.622 +- 0.287 (in-sample avg dev_std = 0.500)
NEC for r=0.4 class 1 = 0.524 +- 0.287 (in-sample avg dev_std = 0.500)
NEC for r=0.4 class 2 = 0.628 +- 0.287 (in-sample avg dev_std = 0.500)
NEC for r=0.4 all KL = 0.668 +- 0.287 (in-sample avg dev_std = 0.500)
NEC for r=0.4 all L1 = 0.592 +- 0.154 (in-sample avg dev_std = 0.500)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.853
Model XAI F1 of binarized graphs for r=0.6 =  0.602245
Model XAI WIoU of binarized graphs for r=0.6 =  0.6885925
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.455
NEC for r=0.6 class 0 = 0.584 +- 0.281 (in-sample avg dev_std = 0.543)
NEC for r=0.6 class 1 = 0.511 +- 0.281 (in-sample avg dev_std = 0.543)
NEC for r=0.6 class 2 = 0.611 +- 0.281 (in-sample avg dev_std = 0.543)
NEC for r=0.6 all KL = 0.633 +- 0.281 (in-sample avg dev_std = 0.543)
NEC for r=0.6 all L1 = 0.57 +- 0.167 (in-sample avg dev_std = 0.543)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.914
Model XAI F1 of binarized graphs for r=0.9 =  0.47312125
Model XAI WIoU of binarized graphs for r=0.9 =  0.70028
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.537
NEC for r=0.9 class 0 = 0.533 +- 0.291 (in-sample avg dev_std = 0.588)
NEC for r=0.9 class 1 = 0.477 +- 0.291 (in-sample avg dev_std = 0.588)
NEC for r=0.9 class 2 = 0.567 +- 0.291 (in-sample avg dev_std = 0.588)
NEC for r=0.9 all KL = 0.572 +- 0.291 (in-sample avg dev_std = 0.588)
NEC for r=0.9 all L1 = 0.526 +- 0.163 (in-sample avg dev_std = 0.588)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.918
Model XAI F1 of binarized graphs for r=0.95 =  0.45576
Model XAI WIoU of binarized graphs for r=0.95 =  0.700355
len(reference) = 800
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.547
NEC for r=0.95 class 0 = 0.519 +- 0.289 (in-sample avg dev_std = 0.577)
NEC for r=0.95 class 1 = 0.47 +- 0.289 (in-sample avg dev_std = 0.577)
NEC for r=0.95 class 2 = 0.55 +- 0.289 (in-sample avg dev_std = 0.577)
NEC for r=0.95 all KL = 0.553 +- 0.289 (in-sample avg dev_std = 0.577)
NEC for r=0.95 all L1 = 0.514 +- 0.167 (in-sample avg dev_std = 0.577)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.918
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.7003287499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.544
NEC for r=1.0 class 0 = 0.529 +- 0.284 (in-sample avg dev_std = 0.578)
NEC for r=1.0 class 1 = 0.483 +- 0.284 (in-sample avg dev_std = 0.578)
NEC for r=1.0 class 2 = 0.544 +- 0.284 (in-sample avg dev_std = 0.578)
NEC for r=1.0 all KL = 0.56 +- 0.284 (in-sample avg dev_std = 0.578)
NEC for r=1.0 all L1 = 0.519 +- 0.164 (in-sample avg dev_std = 0.578)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.493
Model XAI F1 of binarized graphs for r=0.3 =  0.782
Model XAI WIoU of binarized graphs for r=0.3 =  0.8802100000000002
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.404
NEC for r=0.3 class 0 = 0.547 +- 0.268 (in-sample avg dev_std = 0.558)
NEC for r=0.3 class 1 = 0.444 +- 0.268 (in-sample avg dev_std = 0.558)
NEC for r=0.3 class 2 = 0.608 +- 0.268 (in-sample avg dev_std = 0.558)
NEC for r=0.3 all KL = 0.587 +- 0.268 (in-sample avg dev_std = 0.558)
NEC for r=0.3 all L1 = 0.533 +- 0.134 (in-sample avg dev_std = 0.558)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.827
Model XAI F1 of binarized graphs for r=0.4 =  0.7116162499999998
Model XAI WIoU of binarized graphs for r=0.4 =  0.87691125
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.523
NEC for r=0.4 class 0 = 0.488 +- 0.312 (in-sample avg dev_std = 0.603)
NEC for r=0.4 class 1 = 0.463 +- 0.312 (in-sample avg dev_std = 0.603)
NEC for r=0.4 class 2 = 0.636 +- 0.312 (in-sample avg dev_std = 0.603)
NEC for r=0.4 all KL = 0.594 +- 0.312 (in-sample avg dev_std = 0.603)
NEC for r=0.4 all L1 = 0.529 +- 0.191 (in-sample avg dev_std = 0.603)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.859
Model XAI F1 of binarized graphs for r=0.6 =  0.5438937500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7503025
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.583
NEC for r=0.6 class 0 = 0.425 +- 0.356 (in-sample avg dev_std = 0.593)
NEC for r=0.6 class 1 = 0.474 +- 0.356 (in-sample avg dev_std = 0.593)
NEC for r=0.6 class 2 = 0.551 +- 0.356 (in-sample avg dev_std = 0.593)
NEC for r=0.6 all KL = 0.534 +- 0.356 (in-sample avg dev_std = 0.593)
NEC for r=0.6 all L1 = 0.484 +- 0.231 (in-sample avg dev_std = 0.593)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.666
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.6935862500000001
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.634
NEC for r=0.9 class 0 = 0.408 +- 0.307 (in-sample avg dev_std = 0.539)
NEC for r=0.9 class 1 = 0.407 +- 0.307 (in-sample avg dev_std = 0.539)
NEC for r=0.9 class 2 = 0.347 +- 0.307 (in-sample avg dev_std = 0.539)
NEC for r=0.9 all KL = 0.44 +- 0.307 (in-sample avg dev_std = 0.539)
NEC for r=0.9 all L1 = 0.387 +- 0.195 (in-sample avg dev_std = 0.539)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.71
Model XAI F1 of binarized graphs for r=0.95 =  0.40367624999999996
Model XAI WIoU of binarized graphs for r=0.95 =  0.691805
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.64
NEC for r=0.95 class 0 = 0.406 +- 0.290 (in-sample avg dev_std = 0.525)
NEC for r=0.95 class 1 = 0.411 +- 0.290 (in-sample avg dev_std = 0.525)
NEC for r=0.95 class 2 = 0.33 +- 0.290 (in-sample avg dev_std = 0.525)
NEC for r=0.95 all KL = 0.436 +- 0.290 (in-sample avg dev_std = 0.525)
NEC for r=0.95 all L1 = 0.382 +- 0.191 (in-sample avg dev_std = 0.525)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.71
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.69095
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.638
NEC for r=1.0 class 0 = 0.403 +- 0.298 (in-sample avg dev_std = 0.536)
NEC for r=1.0 class 1 = 0.427 +- 0.298 (in-sample avg dev_std = 0.536)
NEC for r=1.0 class 2 = 0.326 +- 0.298 (in-sample avg dev_std = 0.536)
NEC for r=1.0 all KL = 0.441 +- 0.298 (in-sample avg dev_std = 0.536)
NEC for r=1.0 all L1 = 0.386 +- 0.199 (in-sample avg dev_std = 0.536)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.509
Model XAI F1 of binarized graphs for r=0.3 =  0.6729925
Model XAI WIoU of binarized graphs for r=0.3 =  0.5961862499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.418
SUFF++ for r=0.3 class 0 = 0.456 +- 0.256 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 class 1 = 0.53 +- 0.256 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 class 2 = 0.475 +- 0.256 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 all KL = 0.429 +- 0.256 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 all L1 = 0.487 +- 0.159 (in-sample avg dev_std = 0.553)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.738
Model XAI F1 of binarized graphs for r=0.4 =  0.6996975000000001
Model XAI WIoU of binarized graphs for r=0.4 =  0.6832187500000001
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.567
SUFF++ for r=0.4 class 0 = 0.495 +- 0.282 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.4 class 1 = 0.664 +- 0.282 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.4 class 2 = 0.518 +- 0.282 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.4 all KL = 0.478 +- 0.282 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.4 all L1 = 0.558 +- 0.188 (in-sample avg dev_std = 0.550)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.853
Model XAI F1 of binarized graphs for r=0.6 =  0.602245
Model XAI WIoU of binarized graphs for r=0.6 =  0.6885925
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.73
SUFF++ for r=0.6 class 0 = 0.623 +- 0.285 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 class 1 = 0.675 +- 0.285 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 class 2 = 0.677 +- 0.285 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 all KL = 0.617 +- 0.285 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 all L1 = 0.659 +- 0.205 (in-sample avg dev_std = 0.482)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.914
Model XAI F1 of binarized graphs for r=0.9 =  0.47312125
Model XAI WIoU of binarized graphs for r=0.9 =  0.70028
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.843
SUFF++ for r=0.9 class 0 = 0.782 +- 0.199 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 1 = 0.797 +- 0.199 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 2 = 0.823 +- 0.199 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 all KL = 0.838 +- 0.199 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 all L1 = 0.801 +- 0.182 (in-sample avg dev_std = 0.269)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.918
Model XAI F1 of binarized graphs for r=0.95 =  0.45576
Model XAI WIoU of binarized graphs for r=0.95 =  0.700355
len(reference) = 732
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.884
SUFF++ for r=0.95 class 0 = 0.858 +- 0.154 (in-sample avg dev_std = 0.213)
SUFF++ for r=0.95 class 1 = 0.863 +- 0.154 (in-sample avg dev_std = 0.213)
SUFF++ for r=0.95 class 2 = 0.88 +- 0.154 (in-sample avg dev_std = 0.213)
SUFF++ for r=0.95 all KL = 0.915 +- 0.154 (in-sample avg dev_std = 0.213)
SUFF++ for r=0.95 all L1 = 0.867 +- 0.150 (in-sample avg dev_std = 0.213)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.493
Model XAI F1 of binarized graphs for r=0.3 =  0.782
Model XAI WIoU of binarized graphs for r=0.3 =  0.8802100000000002
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.587
SUFF++ for r=0.3 class 0 = 0.607 +- 0.298 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 class 1 = 0.657 +- 0.298 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 class 2 = 0.558 +- 0.298 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 all KL = 0.563 +- 0.298 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.3 all L1 = 0.608 +- 0.180 (in-sample avg dev_std = 0.543)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.827
Model XAI F1 of binarized graphs for r=0.4 =  0.7116162499999998
Model XAI WIoU of binarized graphs for r=0.4 =  0.87691125
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.696
SUFF++ for r=0.4 class 0 = 0.609 +- 0.361 (in-sample avg dev_std = 0.637)
SUFF++ for r=0.4 class 1 = 0.683 +- 0.361 (in-sample avg dev_std = 0.637)
SUFF++ for r=0.4 class 2 = 0.623 +- 0.361 (in-sample avg dev_std = 0.637)
SUFF++ for r=0.4 all KL = 0.546 +- 0.361 (in-sample avg dev_std = 0.637)
SUFF++ for r=0.4 all L1 = 0.639 +- 0.200 (in-sample avg dev_std = 0.637)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.861
Model XAI F1 of binarized graphs for r=0.6 =  0.5438937500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7503025
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.732
SUFF++ for r=0.6 class 0 = 0.603 +- 0.345 (in-sample avg dev_std = 0.572)
SUFF++ for r=0.6 class 1 = 0.704 +- 0.345 (in-sample avg dev_std = 0.572)
SUFF++ for r=0.6 class 2 = 0.638 +- 0.345 (in-sample avg dev_std = 0.572)
SUFF++ for r=0.6 all KL = 0.592 +- 0.345 (in-sample avg dev_std = 0.572)
SUFF++ for r=0.6 all L1 = 0.649 +- 0.199 (in-sample avg dev_std = 0.572)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.664
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.6935862500000001
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.837
SUFF++ for r=0.9 class 0 = 0.659 +- 0.313 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 1 = 0.73 +- 0.313 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 2 = 0.911 +- 0.313 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 all KL = 0.744 +- 0.313 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 all L1 = 0.768 +- 0.289 (in-sample avg dev_std = 0.304)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.71
Model XAI F1 of binarized graphs for r=0.95 =  0.40367624999999996
Model XAI WIoU of binarized graphs for r=0.95 =  0.691805
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.658
SUFF++ for r=0.95 class 0 = 0.59 +- 0.287 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.95 class 1 = 0.59 +- 0.287 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.95 class 2 = 0.694 +- 0.287 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.95 all KL = 0.577 +- 0.287 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.95 all L1 = 0.625 +- 0.196 (in-sample avg dev_std = 0.513)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 15:06:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:06:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.752
WIoU for r=0.3 = 0.850
F1 for r=0.4 = 0.726
WIoU for r=0.4 = 0.895
F1 for r=0.6 = 0.607
WIoU for r=0.6 = 0.908
F1 for r=0.9 = 0.472
WIoU for r=0.9 = 0.911
F1 for r=0.95 = 0.456
WIoU for r=0.95 = 0.911
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.911
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.752
WIoU for r=0.3 = 0.847
F1 for r=0.4 = 0.687
WIoU for r=0.4 = 0.880
F1 for r=0.6 = 0.555
WIoU for r=0.6 = 0.845
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.845
F1 for r=0.95 = 0.404
WIoU for r=0.95 = 0.845
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.845


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.675
Model XAI F1 of binarized graphs for r=0.3 =  0.7517824999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.8495525
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.345
NEC for r=0.3 class 0 = 0.454 +- 0.340 (in-sample avg dev_std = 0.385)
NEC for r=0.3 class 1 = 0.465 +- 0.340 (in-sample avg dev_std = 0.385)
NEC for r=0.3 class 2 = 0.582 +- 0.340 (in-sample avg dev_std = 0.385)
NEC for r=0.3 all KL = 0.482 +- 0.340 (in-sample avg dev_std = 0.385)
NEC for r=0.3 all L1 = 0.502 +- 0.176 (in-sample avg dev_std = 0.385)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.81
Model XAI F1 of binarized graphs for r=0.4 =  0.7261524999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.8951762500000001
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.386
NEC for r=0.4 class 0 = 0.449 +- 0.308 (in-sample avg dev_std = 0.417)
NEC for r=0.4 class 1 = 0.521 +- 0.308 (in-sample avg dev_std = 0.417)
NEC for r=0.4 class 2 = 0.61 +- 0.308 (in-sample avg dev_std = 0.417)
NEC for r=0.4 all KL = 0.519 +- 0.308 (in-sample avg dev_std = 0.417)
NEC for r=0.4 all L1 = 0.528 +- 0.163 (in-sample avg dev_std = 0.417)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  0.60748625
Model XAI WIoU of binarized graphs for r=0.6 =  0.9079487499999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.485
NEC for r=0.6 class 0 = 0.408 +- 0.306 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 1 = 0.43 +- 0.306 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 2 = 0.571 +- 0.306 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all KL = 0.424 +- 0.306 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all L1 = 0.471 +- 0.178 (in-sample avg dev_std = 0.451)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.882
Model XAI F1 of binarized graphs for r=0.9 =  0.4723375
Model XAI WIoU of binarized graphs for r=0.9 =  0.91110875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.534
NEC for r=0.9 class 0 = 0.372 +- 0.295 (in-sample avg dev_std = 0.458)
NEC for r=0.9 class 1 = 0.381 +- 0.295 (in-sample avg dev_std = 0.458)
NEC for r=0.9 class 2 = 0.523 +- 0.295 (in-sample avg dev_std = 0.458)
NEC for r=0.9 all KL = 0.354 +- 0.295 (in-sample avg dev_std = 0.458)
NEC for r=0.9 all L1 = 0.427 +- 0.174 (in-sample avg dev_std = 0.458)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.882
Model XAI F1 of binarized graphs for r=0.95 =  0.45576
Model XAI WIoU of binarized graphs for r=0.95 =  0.91110875
len(reference) = 800
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.555
NEC for r=0.95 class 0 = 0.366 +- 0.290 (in-sample avg dev_std = 0.459)
NEC for r=0.95 class 1 = 0.376 +- 0.290 (in-sample avg dev_std = 0.459)
NEC for r=0.95 class 2 = 0.506 +- 0.290 (in-sample avg dev_std = 0.459)
NEC for r=0.95 all KL = 0.345 +- 0.290 (in-sample avg dev_std = 0.459)
NEC for r=0.95 all L1 = 0.418 +- 0.168 (in-sample avg dev_std = 0.459)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.882
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.91110875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.547
NEC for r=1.0 class 0 = 0.373 +- 0.293 (in-sample avg dev_std = 0.459)
NEC for r=1.0 class 1 = 0.369 +- 0.293 (in-sample avg dev_std = 0.459)
NEC for r=1.0 class 2 = 0.508 +- 0.293 (in-sample avg dev_std = 0.459)
NEC for r=1.0 all KL = 0.347 +- 0.293 (in-sample avg dev_std = 0.459)
NEC for r=1.0 all L1 = 0.418 +- 0.172 (in-sample avg dev_std = 0.459)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.744
Model XAI F1 of binarized graphs for r=0.3 =  0.7515675000000002
Model XAI WIoU of binarized graphs for r=0.3 =  0.8466300000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.333
NEC for r=0.3 class 0 = 0.482 +- 0.321 (in-sample avg dev_std = 0.418)
NEC for r=0.3 class 1 = 0.479 +- 0.321 (in-sample avg dev_std = 0.418)
NEC for r=0.3 class 2 = 0.585 +- 0.321 (in-sample avg dev_std = 0.418)
NEC for r=0.3 all KL = 0.525 +- 0.321 (in-sample avg dev_std = 0.418)
NEC for r=0.3 all L1 = 0.515 +- 0.153 (in-sample avg dev_std = 0.418)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.895
Model XAI F1 of binarized graphs for r=0.4 =  0.68741625
Model XAI WIoU of binarized graphs for r=0.4 =  0.8804949999999999
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.409
NEC for r=0.4 class 0 = 0.412 +- 0.366 (in-sample avg dev_std = 0.413)
NEC for r=0.4 class 1 = 0.486 +- 0.366 (in-sample avg dev_std = 0.413)
NEC for r=0.4 class 2 = 0.652 +- 0.366 (in-sample avg dev_std = 0.413)
NEC for r=0.4 all KL = 0.505 +- 0.366 (in-sample avg dev_std = 0.413)
NEC for r=0.4 all L1 = 0.517 +- 0.204 (in-sample avg dev_std = 0.413)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.5545187500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.84512
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.541
NEC for r=0.6 class 0 = 0.345 +- 0.347 (in-sample avg dev_std = 0.463)
NEC for r=0.6 class 1 = 0.408 +- 0.347 (in-sample avg dev_std = 0.463)
NEC for r=0.6 class 2 = 0.523 +- 0.347 (in-sample avg dev_std = 0.463)
NEC for r=0.6 all KL = 0.399 +- 0.347 (in-sample avg dev_std = 0.463)
NEC for r=0.6 all L1 = 0.426 +- 0.206 (in-sample avg dev_std = 0.463)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.84512
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.603
NEC for r=0.9 class 0 = 0.356 +- 0.306 (in-sample avg dev_std = 0.510)
NEC for r=0.9 class 1 = 0.348 +- 0.306 (in-sample avg dev_std = 0.510)
NEC for r=0.9 class 2 = 0.46 +- 0.306 (in-sample avg dev_std = 0.510)
NEC for r=0.9 all KL = 0.36 +- 0.306 (in-sample avg dev_std = 0.510)
NEC for r=0.9 all L1 = 0.388 +- 0.182 (in-sample avg dev_std = 0.510)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.897
Model XAI F1 of binarized graphs for r=0.95 =  0.40367624999999996
Model XAI WIoU of binarized graphs for r=0.95 =  0.84512
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.598
NEC for r=0.95 class 0 = 0.369 +- 0.305 (in-sample avg dev_std = 0.511)
NEC for r=0.95 class 1 = 0.353 +- 0.305 (in-sample avg dev_std = 0.511)
NEC for r=0.95 class 2 = 0.458 +- 0.305 (in-sample avg dev_std = 0.511)
NEC for r=0.95 all KL = 0.365 +- 0.305 (in-sample avg dev_std = 0.511)
NEC for r=0.95 all L1 = 0.393 +- 0.182 (in-sample avg dev_std = 0.511)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.897
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.84512
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.598
NEC for r=1.0 class 0 = 0.369 +- 0.305 (in-sample avg dev_std = 0.511)
NEC for r=1.0 class 1 = 0.355 +- 0.305 (in-sample avg dev_std = 0.511)
NEC for r=1.0 class 2 = 0.458 +- 0.305 (in-sample avg dev_std = 0.511)
NEC for r=1.0 all KL = 0.366 +- 0.305 (in-sample avg dev_std = 0.511)
NEC for r=1.0 all L1 = 0.394 +- 0.182 (in-sample avg dev_std = 0.511)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.674
Model XAI F1 of binarized graphs for r=0.3 =  0.7517824999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.8495525
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.517
SUFF++ for r=0.3 class 0 = 0.534 +- 0.295 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 1 = 0.66 +- 0.295 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 2 = 0.531 +- 0.295 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all KL = 0.586 +- 0.295 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all L1 = 0.574 +- 0.164 (in-sample avg dev_std = 0.461)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.809
Model XAI F1 of binarized graphs for r=0.4 =  0.7261524999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.8951762500000001
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.583
SUFF++ for r=0.4 class 0 = 0.554 +- 0.281 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.4 class 1 = 0.706 +- 0.281 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.4 class 2 = 0.575 +- 0.281 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.4 all KL = 0.642 +- 0.281 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.4 all L1 = 0.611 +- 0.193 (in-sample avg dev_std = 0.421)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  0.60748625
Model XAI WIoU of binarized graphs for r=0.6 =  0.9079487499999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.734
SUFF++ for r=0.6 class 0 = 0.63 +- 0.200 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.6 class 1 = 0.746 +- 0.200 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.6 class 2 = 0.749 +- 0.200 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.6 all KL = 0.79 +- 0.200 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.6 all L1 = 0.709 +- 0.177 (in-sample avg dev_std = 0.332)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.882
Model XAI F1 of binarized graphs for r=0.9 =  0.4723375
Model XAI WIoU of binarized graphs for r=0.9 =  0.91110875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.841
SUFF++ for r=0.9 class 0 = 0.832 +- 0.120 (in-sample avg dev_std = 0.187)
SUFF++ for r=0.9 class 1 = 0.857 +- 0.120 (in-sample avg dev_std = 0.187)
SUFF++ for r=0.9 class 2 = 0.879 +- 0.120 (in-sample avg dev_std = 0.187)
SUFF++ for r=0.9 all KL = 0.933 +- 0.120 (in-sample avg dev_std = 0.187)
SUFF++ for r=0.9 all L1 = 0.856 +- 0.142 (in-sample avg dev_std = 0.187)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.88
Model XAI F1 of binarized graphs for r=0.95 =  0.45576
Model XAI WIoU of binarized graphs for r=0.95 =  0.91110875
len(reference) = 732
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.855
SUFF++ for r=0.95 class 0 = 0.901 +- 0.073 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.95 class 1 = 0.906 +- 0.073 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.95 class 2 = 0.911 +- 0.073 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.95 all KL = 0.967 +- 0.073 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.95 all L1 = 0.906 +- 0.108 (in-sample avg dev_std = 0.155)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.744
Model XAI F1 of binarized graphs for r=0.3 =  0.7515675000000002
Model XAI WIoU of binarized graphs for r=0.3 =  0.8466300000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.541
SUFF++ for r=0.3 class 0 = 0.519 +- 0.311 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 class 1 = 0.665 +- 0.311 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 class 2 = 0.59 +- 0.311 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 all KL = 0.592 +- 0.311 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 all L1 = 0.593 +- 0.173 (in-sample avg dev_std = 0.488)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.895
Model XAI F1 of binarized graphs for r=0.4 =  0.68741625
Model XAI WIoU of binarized graphs for r=0.4 =  0.8804949999999999
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.692
SUFF++ for r=0.4 class 0 = 0.557 +- 0.283 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.4 class 1 = 0.699 +- 0.283 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.4 class 2 = 0.759 +- 0.283 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.4 all KL = 0.659 +- 0.283 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.4 all L1 = 0.673 +- 0.175 (in-sample avg dev_std = 0.437)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.5545187500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.84512
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.718
SUFF++ for r=0.6 class 0 = 0.577 +- 0.218 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.6 class 1 = 0.789 +- 0.218 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.6 class 2 = 0.794 +- 0.218 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.6 all KL = 0.777 +- 0.218 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.6 all L1 = 0.722 +- 0.186 (in-sample avg dev_std = 0.374)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.84512
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.811
SUFF++ for r=0.9 class 0 = 0.771 +- 0.090 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 class 1 = 0.862 +- 0.090 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 class 2 = 0.935 +- 0.090 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all KL = 0.928 +- 0.090 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all L1 = 0.857 +- 0.148 (in-sample avg dev_std = 0.185)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.897
Model XAI F1 of binarized graphs for r=0.95 =  0.40367624999999996
Model XAI WIoU of binarized graphs for r=0.95 =  0.84512
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.602
SUFF++ for r=0.95 class 0 = 0.631 +- 0.302 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.95 class 1 = 0.651 +- 0.302 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.95 class 2 = 0.543 +- 0.302 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.95 all KL = 0.637 +- 0.302 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.95 all L1 = 0.608 +- 0.181 (in-sample avg dev_std = 0.514)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 15:10:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:10:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.706
WIoU for r=0.3 = 0.652
F1 for r=0.4 = 0.709
WIoU for r=0.4 = 0.703
F1 for r=0.6 = 0.604
WIoU for r=0.6 = 0.714
F1 for r=0.9 = 0.473
WIoU for r=0.9 = 0.707
F1 for r=0.95 = 0.456
WIoU for r=0.95 = 0.707
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.707
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.769
WIoU for r=0.3 = 0.900
F1 for r=0.4 = 0.706
WIoU for r=0.4 = 0.922
F1 for r=0.6 = 0.544
WIoU for r=0.6 = 0.849
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.827
F1 for r=0.95 = 0.404
WIoU for r=0.95 = 0.827
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.827


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.576
Model XAI F1 of binarized graphs for r=0.3 =  0.705865
Model XAI WIoU of binarized graphs for r=0.3 =  0.6524725000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.393
NEC for r=0.3 class 0 = 0.597 +- 0.304 (in-sample avg dev_std = 0.558)
NEC for r=0.3 class 1 = 0.54 +- 0.304 (in-sample avg dev_std = 0.558)
NEC for r=0.3 class 2 = 0.666 +- 0.304 (in-sample avg dev_std = 0.558)
NEC for r=0.3 all KL = 0.712 +- 0.304 (in-sample avg dev_std = 0.558)
NEC for r=0.3 all L1 = 0.602 +- 0.162 (in-sample avg dev_std = 0.558)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.70859875
Model XAI WIoU of binarized graphs for r=0.4 =  0.7032075
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.428
NEC for r=0.4 class 0 = 0.552 +- 0.302 (in-sample avg dev_std = 0.552)
NEC for r=0.4 class 1 = 0.489 +- 0.302 (in-sample avg dev_std = 0.552)
NEC for r=0.4 class 2 = 0.625 +- 0.302 (in-sample avg dev_std = 0.552)
NEC for r=0.4 all KL = 0.642 +- 0.302 (in-sample avg dev_std = 0.552)
NEC for r=0.4 all L1 = 0.557 +- 0.161 (in-sample avg dev_std = 0.552)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  0.60399125
Model XAI WIoU of binarized graphs for r=0.6 =  0.714225
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.494
NEC for r=0.6 class 0 = 0.503 +- 0.323 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 1 = 0.469 +- 0.323 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 2 = 0.618 +- 0.323 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all KL = 0.616 +- 0.323 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all L1 = 0.532 +- 0.178 (in-sample avg dev_std = 0.556)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.905
Model XAI F1 of binarized graphs for r=0.9 =  0.47308624999999993
Model XAI WIoU of binarized graphs for r=0.9 =  0.70713375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.576
NEC for r=0.9 class 0 = 0.442 +- 0.308 (in-sample avg dev_std = 0.564)
NEC for r=0.9 class 1 = 0.434 +- 0.308 (in-sample avg dev_std = 0.564)
NEC for r=0.9 class 2 = 0.552 +- 0.308 (in-sample avg dev_std = 0.564)
NEC for r=0.9 all KL = 0.523 +- 0.308 (in-sample avg dev_std = 0.564)
NEC for r=0.9 all L1 = 0.477 +- 0.167 (in-sample avg dev_std = 0.564)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.905
Model XAI F1 of binarized graphs for r=0.95 =  0.45576
Model XAI WIoU of binarized graphs for r=0.95 =  0.7069325000000001
len(reference) = 800
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.58
NEC for r=0.95 class 0 = 0.451 +- 0.313 (in-sample avg dev_std = 0.559)
NEC for r=0.95 class 1 = 0.414 +- 0.313 (in-sample avg dev_std = 0.559)
NEC for r=0.95 class 2 = 0.536 +- 0.313 (in-sample avg dev_std = 0.559)
NEC for r=0.95 all KL = 0.511 +- 0.313 (in-sample avg dev_std = 0.559)
NEC for r=0.95 all L1 = 0.468 +- 0.175 (in-sample avg dev_std = 0.559)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.905
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.7069325000000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.572
NEC for r=1.0 class 0 = 0.451 +- 0.308 (in-sample avg dev_std = 0.569)
NEC for r=1.0 class 1 = 0.429 +- 0.308 (in-sample avg dev_std = 0.569)
NEC for r=1.0 class 2 = 0.533 +- 0.308 (in-sample avg dev_std = 0.569)
NEC for r=1.0 all KL = 0.518 +- 0.308 (in-sample avg dev_std = 0.569)
NEC for r=1.0 all L1 = 0.472 +- 0.164 (in-sample avg dev_std = 0.569)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.863
Model XAI F1 of binarized graphs for r=0.3 =  0.7685775000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8999287499999999
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.415
NEC for r=0.3 class 0 = 0.597 +- 0.281 (in-sample avg dev_std = 0.516)
NEC for r=0.3 class 1 = 0.522 +- 0.281 (in-sample avg dev_std = 0.516)
NEC for r=0.3 class 2 = 0.638 +- 0.281 (in-sample avg dev_std = 0.516)
NEC for r=0.3 all KL = 0.63 +- 0.281 (in-sample avg dev_std = 0.516)
NEC for r=0.3 all L1 = 0.585 +- 0.138 (in-sample avg dev_std = 0.516)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.796
Model XAI F1 of binarized graphs for r=0.4 =  0.7057162499999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.921675
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.452
NEC for r=0.4 class 0 = 0.523 +- 0.354 (in-sample avg dev_std = 0.510)
NEC for r=0.4 class 1 = 0.528 +- 0.354 (in-sample avg dev_std = 0.510)
NEC for r=0.4 class 2 = 0.635 +- 0.354 (in-sample avg dev_std = 0.510)
NEC for r=0.4 all KL = 0.626 +- 0.354 (in-sample avg dev_std = 0.510)
NEC for r=0.4 all L1 = 0.562 +- 0.180 (in-sample avg dev_std = 0.510)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.865
Model XAI F1 of binarized graphs for r=0.6 =  0.5438937500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.8493262500000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.599
NEC for r=0.6 class 0 = 0.434 +- 0.333 (in-sample avg dev_std = 0.546)
NEC for r=0.6 class 1 = 0.393 +- 0.333 (in-sample avg dev_std = 0.546)
NEC for r=0.6 class 2 = 0.519 +- 0.333 (in-sample avg dev_std = 0.546)
NEC for r=0.6 all KL = 0.477 +- 0.333 (in-sample avg dev_std = 0.546)
NEC for r=0.6 all L1 = 0.448 +- 0.194 (in-sample avg dev_std = 0.546)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.865
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.827495
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.642
NEC for r=0.9 class 0 = 0.395 +- 0.329 (in-sample avg dev_std = 0.566)
NEC for r=0.9 class 1 = 0.356 +- 0.329 (in-sample avg dev_std = 0.566)
NEC for r=0.9 class 2 = 0.464 +- 0.329 (in-sample avg dev_std = 0.566)
NEC for r=0.9 all KL = 0.452 +- 0.329 (in-sample avg dev_std = 0.566)
NEC for r=0.9 all L1 = 0.405 +- 0.189 (in-sample avg dev_std = 0.566)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.865
Model XAI F1 of binarized graphs for r=0.95 =  0.40367624999999996
Model XAI WIoU of binarized graphs for r=0.95 =  0.827495
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.649
NEC for r=0.95 class 0 = 0.388 +- 0.318 (in-sample avg dev_std = 0.582)
NEC for r=0.95 class 1 = 0.345 +- 0.318 (in-sample avg dev_std = 0.582)
NEC for r=0.95 class 2 = 0.457 +- 0.318 (in-sample avg dev_std = 0.582)
NEC for r=0.95 all KL = 0.447 +- 0.318 (in-sample avg dev_std = 0.582)
NEC for r=0.95 all L1 = 0.396 +- 0.173 (in-sample avg dev_std = 0.582)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.865
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.827495
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.648
NEC for r=1.0 class 0 = 0.388 +- 0.319 (in-sample avg dev_std = 0.583)
NEC for r=1.0 class 1 = 0.349 +- 0.319 (in-sample avg dev_std = 0.583)
NEC for r=1.0 class 2 = 0.457 +- 0.319 (in-sample avg dev_std = 0.583)
NEC for r=1.0 all KL = 0.449 +- 0.319 (in-sample avg dev_std = 0.583)
NEC for r=1.0 all L1 = 0.397 +- 0.174 (in-sample avg dev_std = 0.583)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.579
Model XAI F1 of binarized graphs for r=0.3 =  0.705865
Model XAI WIoU of binarized graphs for r=0.3 =  0.6524725000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.553
SUFF++ for r=0.3 class 0 = 0.468 +- 0.300 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 class 1 = 0.523 +- 0.300 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 class 2 = 0.499 +- 0.300 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 all KL = 0.364 +- 0.300 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 all L1 = 0.497 +- 0.189 (in-sample avg dev_std = 0.608)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.70859875
Model XAI WIoU of binarized graphs for r=0.4 =  0.7032075
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.625
SUFF++ for r=0.4 class 0 = 0.495 +- 0.305 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.4 class 1 = 0.66 +- 0.305 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.4 class 2 = 0.548 +- 0.305 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.4 all KL = 0.471 +- 0.305 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.4 all L1 = 0.567 +- 0.202 (in-sample avg dev_std = 0.564)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  0.60399125
Model XAI WIoU of binarized graphs for r=0.6 =  0.714225
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.762
SUFF++ for r=0.6 class 0 = 0.627 +- 0.299 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 1 = 0.714 +- 0.299 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 2 = 0.707 +- 0.299 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all KL = 0.638 +- 0.299 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all L1 = 0.683 +- 0.217 (in-sample avg dev_std = 0.440)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.905
Model XAI F1 of binarized graphs for r=0.9 =  0.47308624999999993
Model XAI WIoU of binarized graphs for r=0.9 =  0.70713375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.844
SUFF++ for r=0.9 class 0 = 0.755 +- 0.234 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 class 1 = 0.808 +- 0.234 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 class 2 = 0.849 +- 0.234 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 all KL = 0.838 +- 0.234 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 all L1 = 0.804 +- 0.201 (in-sample avg dev_std = 0.286)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.904
Model XAI F1 of binarized graphs for r=0.95 =  0.45576
Model XAI WIoU of binarized graphs for r=0.95 =  0.7069325000000001
len(reference) = 732
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.867
SUFF++ for r=0.95 class 0 = 0.858 +- 0.150 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.95 class 1 = 0.854 +- 0.150 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.95 class 2 = 0.906 +- 0.150 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.95 all KL = 0.922 +- 0.150 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.95 all L1 = 0.873 +- 0.151 (in-sample avg dev_std = 0.227)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.863
Model XAI F1 of binarized graphs for r=0.3 =  0.7685775000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.8999287499999999
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.692
SUFF++ for r=0.3 class 0 = 0.56 +- 0.309 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 1 = 0.652 +- 0.309 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 2 = 0.52 +- 0.309 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 all KL = 0.546 +- 0.309 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 all L1 = 0.578 +- 0.220 (in-sample avg dev_std = 0.519)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.796
Model XAI F1 of binarized graphs for r=0.4 =  0.7057162499999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.921675
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.753
SUFF++ for r=0.4 class 0 = 0.614 +- 0.328 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.4 class 1 = 0.74 +- 0.328 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.4 class 2 = 0.634 +- 0.328 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.4 all KL = 0.57 +- 0.328 (in-sample avg dev_std = 0.528)
SUFF++ for r=0.4 all L1 = 0.664 +- 0.202 (in-sample avg dev_std = 0.528)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.865
Model XAI F1 of binarized graphs for r=0.6 =  0.5438937500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.8493262500000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.76
SUFF++ for r=0.6 class 0 = 0.58 +- 0.307 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.6 class 1 = 0.747 +- 0.307 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.6 class 2 = 0.68 +- 0.307 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.6 all KL = 0.648 +- 0.307 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.6 all L1 = 0.67 +- 0.183 (in-sample avg dev_std = 0.506)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.865
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.827495
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.874
SUFF++ for r=0.9 class 0 = 0.821 +- 0.125 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 1 = 0.936 +- 0.125 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 2 = 0.924 +- 0.125 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all KL = 0.939 +- 0.125 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all L1 = 0.895 +- 0.147 (in-sample avg dev_std = 0.229)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.865
Model XAI F1 of binarized graphs for r=0.95 =  0.40367624999999996
Model XAI WIoU of binarized graphs for r=0.95 =  0.827495
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.644
SUFF++ for r=0.95 class 0 = 0.616 +- 0.326 (in-sample avg dev_std = 0.577)
SUFF++ for r=0.95 class 1 = 0.648 +- 0.326 (in-sample avg dev_std = 0.577)
SUFF++ for r=0.95 class 2 = 0.528 +- 0.326 (in-sample avg dev_std = 0.577)
SUFF++ for r=0.95 all KL = 0.547 +- 0.326 (in-sample avg dev_std = 0.577)
SUFF++ for r=0.95 all L1 = 0.598 +- 0.183 (in-sample avg dev_std = 0.577)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.591, 0.597, 0.542, 0.461, 0.461, 0.453], 'all_L1': [0.555, 0.572, 0.534, 0.468, 0.468, 0.46]}), defaultdict(<class 'list'>, {'all_KL': [0.619, 0.62, 0.594, 0.491, 0.501, 0.494], 'all_L1': [0.558, 0.576, 0.565, 0.499, 0.506, 0.501]}), defaultdict(<class 'list'>, {'all_KL': [0.61, 0.668, 0.633, 0.572, 0.553, 0.56], 'all_L1': [0.569, 0.592, 0.57, 0.526, 0.514, 0.519]}), defaultdict(<class 'list'>, {'all_KL': [0.482, 0.519, 0.424, 0.354, 0.345, 0.347], 'all_L1': [0.502, 0.528, 0.471, 0.427, 0.418, 0.418]}), defaultdict(<class 'list'>, {'all_KL': [0.712, 0.642, 0.616, 0.523, 0.511, 0.518], 'all_L1': [0.602, 0.557, 0.532, 0.477, 0.468, 0.472]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.514, 0.503, 0.724, 0.852, 0.916, 1.0], 'all_L1': [0.556, 0.54, 0.689, 0.771, 0.834, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.487, 0.49, 0.644, 0.852, 0.919, 1.0], 'all_L1': [0.555, 0.551, 0.649, 0.792, 0.854, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.429, 0.478, 0.617, 0.838, 0.915, 1.0], 'all_L1': [0.487, 0.558, 0.659, 0.801, 0.867, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.586, 0.642, 0.79, 0.933, 0.967, 1.0], 'all_L1': [0.574, 0.611, 0.709, 0.856, 0.906, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.364, 0.471, 0.638, 0.838, 0.922, 1.0], 'all_L1': [0.497, 0.567, 0.683, 0.804, 0.873, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]

Eval split test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.657, 0.633, 0.503, 0.405, 0.386, 0.393], 'all_L1': [0.584, 0.558, 0.47, 0.381, 0.366, 0.369]}), defaultdict(<class 'list'>, {'all_KL': [0.481, 0.509, 0.477, 0.447, 0.45, 0.444], 'all_L1': [0.522, 0.504, 0.48, 0.434, 0.437, 0.431]}), defaultdict(<class 'list'>, {'all_KL': [0.587, 0.594, 0.534, 0.44, 0.436, 0.441], 'all_L1': [0.533, 0.529, 0.484, 0.387, 0.382, 0.386]}), defaultdict(<class 'list'>, {'all_KL': [0.525, 0.505, 0.399, 0.36, 0.365, 0.366], 'all_L1': [0.515, 0.517, 0.426, 0.388, 0.393, 0.394]}), defaultdict(<class 'list'>, {'all_KL': [0.63, 0.626, 0.477, 0.452, 0.447, 0.449], 'all_L1': [0.585, 0.562, 0.448, 0.405, 0.396, 0.397]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.582, 0.647, 0.801, 0.929, 0.979, 1.0], 'all_L1': [0.646, 0.725, 0.766, 0.862, 0.935, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.626, 0.587, 0.685, 0.717, 0.551, 1.0], 'all_L1': [0.601, 0.61, 0.682, 0.743, 0.565, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.563, 0.546, 0.592, 0.744, 0.577, 1.0], 'all_L1': [0.608, 0.639, 0.649, 0.768, 0.625, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.592, 0.659, 0.777, 0.928, 0.637, 1.0], 'all_L1': [0.593, 0.673, 0.722, 0.857, 0.608, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.546, 0.57, 0.648, 0.939, 0.547, 1.0], 'all_L1': [0.578, 0.664, 0.67, 0.895, 0.598, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.557 +- 0.032, 0.565 +- 0.022, 0.534 +- 0.035, 0.479 +- 0.033, 0.475 +- 0.034, 0.474 +- 0.035
nec class all_KL  =  0.603 +- 0.073, 0.609 +- 0.051, 0.562 +- 0.075, 0.480 +- 0.073, 0.474 +- 0.071, 0.474 +- 0.073
nec_acc_int  =  0.368 +- 0.019, 0.402 +- 0.022, 0.478 +- 0.024, 0.559 +- 0.026, 0.562 +- 0.025, 0.563 +- 0.023
suff++ class all_L1  =  0.534 +- 0.035, 0.565 +- 0.024, 0.678 +- 0.021, 0.805 +- 0.028, 0.867 +- 0.024, 1.000 +- 0.000
suff++ class all_KL  =  0.476 +- 0.075, 0.517 +- 0.064, 0.683 +- 0.065, 0.863 +- 0.036, 0.928 +- 0.020, 1.000 +- 0.000
suff++_acc_int  =  0.506 +- 0.046, 0.595 +- 0.019, 0.743 +- 0.022, 0.831 +- 0.015, 0.864 +- 0.011

Eval split test
nec class all_L1  =  0.548 +- 0.031, 0.534 +- 0.023, 0.462 +- 0.022, 0.399 +- 0.019, 0.395 +- 0.024, 0.395 +- 0.020
nec class all_KL  =  0.576 +- 0.065, 0.573 +- 0.056, 0.478 +- 0.045, 0.421 +- 0.035, 0.417 +- 0.035, 0.419 +- 0.033
nec_acc_int  =  0.393 +- 0.038, 0.465 +- 0.037, 0.558 +- 0.028, 0.626 +- 0.020, 0.632 +- 0.030, 0.633 +- 0.030
suff++ class all_L1  =  0.605 +- 0.023, 0.662 +- 0.038, 0.698 +- 0.042, 0.825 +- 0.059, 0.666 +- 0.136, 1.000 +- 0.000
suff++ class all_KL  =  0.582 +- 0.027, 0.602 +- 0.044, 0.701 +- 0.078, 0.851 +- 0.099, 0.658 +- 0.164, 1.000 +- 0.000
suff++_acc_int  =  0.612 +- 0.054, 0.729 +- 0.049, 0.765 +- 0.040, 0.827 +- 0.056, 0.683 +- 0.117


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.545 +- 0.011, 0.565 +- 0.007, 0.606 +- 0.009, 0.642 +- 0.014, 0.671 +- 0.014, 0.737 +- 0.017
Faith. Armon (L1)= 		  =  0.543 +- 0.012, 0.564 +- 0.006, 0.596 +- 0.016, 0.600 +- 0.023, 0.612 +- 0.026, 0.642 +- 0.032
Faith. GMean (L1)= 	  =  0.544 +- 0.011, 0.565 +- 0.006, 0.601 +- 0.012, 0.620 +- 0.018, 0.641 +- 0.019, 0.688 +- 0.026
Faith. Aritm (KL)= 		  =  0.539 +- 0.013, 0.563 +- 0.012, 0.622 +- 0.009, 0.671 +- 0.021, 0.701 +- 0.027, 0.737 +- 0.036
Faith. Armon (KL)= 		  =  0.522 +- 0.026, 0.554 +- 0.011, 0.608 +- 0.028, 0.612 +- 0.056, 0.623 +- 0.062, 0.640 +- 0.070
Faith. GMean (KL)= 	  =  0.530 +- 0.018, 0.558 +- 0.011, 0.615 +- 0.018, 0.641 +- 0.039, 0.661 +- 0.046, 0.687 +- 0.055

Eval split test
Faith. Aritm (L1)= 		  =  0.577 +- 0.021, 0.598 +- 0.028, 0.580 +- 0.021, 0.612 +- 0.026, 0.530 +- 0.060, 0.698 +- 0.010
Faith. Armon (L1)= 		  =  0.575 +- 0.022, 0.591 +- 0.027, 0.555 +- 0.017, 0.537 +- 0.015, 0.489 +- 0.019, 0.566 +- 0.021
Faith. GMean (L1)= 	  =  0.576 +- 0.022, 0.595 +- 0.028, 0.567 +- 0.018, 0.573 +- 0.018, 0.509 +- 0.038, 0.629 +- 0.016
Faith. Aritm (KL)= 		  =  0.579 +- 0.024, 0.588 +- 0.031, 0.589 +- 0.033, 0.636 +- 0.043, 0.538 +- 0.073, 0.709 +- 0.017
Faith. Armon (KL)= 		  =  0.575 +- 0.025, 0.585 +- 0.032, 0.564 +- 0.030, 0.559 +- 0.030, 0.500 +- 0.029, 0.589 +- 0.033
Faith. GMean (KL)= 	  =  0.577 +- 0.024, 0.586 +- 0.031, 0.576 +- 0.030, 0.596 +- 0.032, 0.518 +- 0.049, 0.646 +- 0.026
Computed for split load_split = id



Completed in  0:20:36.869355  for LECIGIN GOODMotif2/basis



DONE LECI GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 15:14:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/08/2024 03:14:30 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 03:14:30 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 03:14:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:14:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:14:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:14:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:14:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:14:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:14:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:14:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3252
ID Validation ACCURACY: 0.9357
ID Validation Loss: 0.3127
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3421
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.4181
OOD Test ACCURACY: 0.7947
OOD Test Loss: 0.8208

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 47...
[0m[1;37mINFO[0m: [1mCheckpoint 47: 
-----------------------------------
Train ACCURACY: 0.9265
Train Loss: 0.3388
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.3254
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3540
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.3738
OOD Test ACCURACY: 0.6353
OOD Test Loss: 1.7363

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.7947 0.9243 0.6353 0.9317 0.9300[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.681
WIoU for r=0.3 = 0.561
F1 for r=0.4 = 0.660
WIoU for r=0.4 = 0.548
F1 for r=0.6 = 0.563
WIoU for r=0.6 = 0.443
F1 for r=0.9 = 0.454
WIoU for r=0.9 = 0.331
F1 for r=0.95 = 0.447
WIoU for r=0.95 = 0.324
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.321
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.570
WIoU for r=0.3 = 0.454
F1 for r=0.4 = 0.566
WIoU for r=0.4 = 0.453
F1 for r=0.6 = 0.495
WIoU for r=0.6 = 0.360
F1 for r=0.9 = 0.413
WIoU for r=0.9 = 0.282
F1 for r=0.95 = 0.399
WIoU for r=0.95 = 0.269
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.264


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.441
Model XAI F1 of binarized graphs for r=0.3 =  0.6810437500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.56119125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.305
NEC for r=0.3 class 0 = 0.572 +- 0.314 (in-sample avg dev_std = 0.372)
NEC for r=0.3 class 1 = 0.444 +- 0.314 (in-sample avg dev_std = 0.372)
NEC for r=0.3 class 2 = 0.626 +- 0.314 (in-sample avg dev_std = 0.372)
NEC for r=0.3 all KL = 0.537 +- 0.314 (in-sample avg dev_std = 0.372)
NEC for r=0.3 all L1 = 0.549 +- 0.198 (in-sample avg dev_std = 0.372)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.486
Model XAI F1 of binarized graphs for r=0.4 =  0.6599299999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.547765
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.366
NEC for r=0.4 class 0 = 0.566 +- 0.271 (in-sample avg dev_std = 0.417)
NEC for r=0.4 class 1 = 0.465 +- 0.271 (in-sample avg dev_std = 0.417)
NEC for r=0.4 class 2 = 0.654 +- 0.271 (in-sample avg dev_std = 0.417)
NEC for r=0.4 all KL = 0.558 +- 0.271 (in-sample avg dev_std = 0.417)
NEC for r=0.4 all L1 = 0.564 +- 0.170 (in-sample avg dev_std = 0.417)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.69
Model XAI F1 of binarized graphs for r=0.6 =  0.56277625
Model XAI WIoU of binarized graphs for r=0.6 =  0.44329500000000005
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.387
NEC for r=0.6 class 0 = 0.578 +- 0.270 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 1 = 0.466 +- 0.270 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 2 = 0.652 +- 0.270 (in-sample avg dev_std = 0.460)
NEC for r=0.6 all KL = 0.619 +- 0.270 (in-sample avg dev_std = 0.460)
NEC for r=0.6 all L1 = 0.567 +- 0.176 (in-sample avg dev_std = 0.460)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.918
Model XAI F1 of binarized graphs for r=0.9 =  0.45431999999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.33086625
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.524
NEC for r=0.9 class 0 = 0.603 +- 0.237 (in-sample avg dev_std = 0.569)
NEC for r=0.9 class 1 = 0.428 +- 0.237 (in-sample avg dev_std = 0.569)
NEC for r=0.9 class 2 = 0.572 +- 0.237 (in-sample avg dev_std = 0.569)
NEC for r=0.9 all KL = 0.562 +- 0.237 (in-sample avg dev_std = 0.569)
NEC for r=0.9 all L1 = 0.536 +- 0.166 (in-sample avg dev_std = 0.569)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.929
Model XAI F1 of binarized graphs for r=0.95 =  0.44670625
Model XAI WIoU of binarized graphs for r=0.95 =  0.32400125
len(reference) = 800
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.541
NEC for r=0.95 class 0 = 0.575 +- 0.234 (in-sample avg dev_std = 0.577)
NEC for r=0.95 class 1 = 0.429 +- 0.234 (in-sample avg dev_std = 0.577)
NEC for r=0.95 class 2 = 0.53 +- 0.234 (in-sample avg dev_std = 0.577)
NEC for r=0.95 all KL = 0.526 +- 0.234 (in-sample avg dev_std = 0.577)
NEC for r=0.95 all L1 = 0.512 +- 0.165 (in-sample avg dev_std = 0.577)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.32110374999999997
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.547
NEC for r=1.0 class 0 = 0.567 +- 0.237 (in-sample avg dev_std = 0.616)
NEC for r=1.0 class 1 = 0.419 +- 0.237 (in-sample avg dev_std = 0.616)
NEC for r=1.0 class 2 = 0.555 +- 0.237 (in-sample avg dev_std = 0.616)
NEC for r=1.0 all KL = 0.552 +- 0.237 (in-sample avg dev_std = 0.616)
NEC for r=1.0 all L1 = 0.515 +- 0.173 (in-sample avg dev_std = 0.616)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.359
Model XAI F1 of binarized graphs for r=0.3 =  0.56971625
Model XAI WIoU of binarized graphs for r=0.3 =  0.45398375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.398
NEC for r=0.3 class 0 = 0.47 +- 0.263 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 1 = 0.546 +- 0.263 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 2 = 0.583 +- 0.263 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all KL = 0.518 +- 0.263 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all L1 = 0.534 +- 0.158 (in-sample avg dev_std = 0.401)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  0.5656937499999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.45289250000000003
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.426
NEC for r=0.4 class 0 = 0.534 +- 0.310 (in-sample avg dev_std = 0.480)
NEC for r=0.4 class 1 = 0.43 +- 0.310 (in-sample avg dev_std = 0.480)
NEC for r=0.4 class 2 = 0.685 +- 0.310 (in-sample avg dev_std = 0.480)
NEC for r=0.4 all KL = 0.586 +- 0.310 (in-sample avg dev_std = 0.480)
NEC for r=0.4 all L1 = 0.549 +- 0.188 (in-sample avg dev_std = 0.480)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.766
Model XAI F1 of binarized graphs for r=0.6 =  0.4948887500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.35975250000000003
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.445
NEC for r=0.6 class 0 = 0.604 +- 0.255 (in-sample avg dev_std = 0.546)
NEC for r=0.6 class 1 = 0.418 +- 0.255 (in-sample avg dev_std = 0.546)
NEC for r=0.6 class 2 = 0.621 +- 0.255 (in-sample avg dev_std = 0.546)
NEC for r=0.6 all KL = 0.562 +- 0.255 (in-sample avg dev_std = 0.546)
NEC for r=0.6 all L1 = 0.546 +- 0.180 (in-sample avg dev_std = 0.546)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.754
Model XAI F1 of binarized graphs for r=0.9 =  0.4132875
Model XAI WIoU of binarized graphs for r=0.9 =  0.281845
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.574
NEC for r=0.9 class 0 = 0.533 +- 0.244 (in-sample avg dev_std = 0.494)
NEC for r=0.9 class 1 = 0.341 +- 0.244 (in-sample avg dev_std = 0.494)
NEC for r=0.9 class 2 = 0.446 +- 0.244 (in-sample avg dev_std = 0.494)
NEC for r=0.9 all KL = 0.398 +- 0.244 (in-sample avg dev_std = 0.494)
NEC for r=0.9 all L1 = 0.438 +- 0.184 (in-sample avg dev_std = 0.494)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.757
Model XAI F1 of binarized graphs for r=0.95 =  0.39871875
Model XAI WIoU of binarized graphs for r=0.95 =  0.26946
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.607
NEC for r=0.95 class 0 = 0.524 +- 0.250 (in-sample avg dev_std = 0.515)
NEC for r=0.95 class 1 = 0.343 +- 0.250 (in-sample avg dev_std = 0.515)
NEC for r=0.95 class 2 = 0.424 +- 0.250 (in-sample avg dev_std = 0.515)
NEC for r=0.95 all KL = 0.398 +- 0.250 (in-sample avg dev_std = 0.515)
NEC for r=0.95 all L1 = 0.429 +- 0.175 (in-sample avg dev_std = 0.515)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.809
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.26427125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.608
NEC for r=1.0 class 0 = 0.457 +- 0.259 (in-sample avg dev_std = 0.473)
NEC for r=1.0 class 1 = 0.331 +- 0.259 (in-sample avg dev_std = 0.473)
NEC for r=1.0 class 2 = 0.407 +- 0.259 (in-sample avg dev_std = 0.473)
NEC for r=1.0 all KL = 0.369 +- 0.259 (in-sample avg dev_std = 0.473)
NEC for r=1.0 all L1 = 0.397 +- 0.174 (in-sample avg dev_std = 0.473)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.436
Model XAI F1 of binarized graphs for r=0.3 =  0.6810437500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.56119125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.445
SUFF++ for r=0.3 class 0 = 0.491 +- 0.268 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.3 class 1 = 0.589 +- 0.268 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.3 class 2 = 0.526 +- 0.268 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.3 all KL = 0.563 +- 0.268 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.3 all L1 = 0.535 +- 0.159 (in-sample avg dev_std = 0.451)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.485
Model XAI F1 of binarized graphs for r=0.4 =  0.6599299999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.547765
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.47
SUFF++ for r=0.4 class 0 = 0.49 +- 0.241 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.4 class 1 = 0.609 +- 0.241 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.4 class 2 = 0.583 +- 0.241 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.4 all KL = 0.593 +- 0.241 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.4 all L1 = 0.561 +- 0.178 (in-sample avg dev_std = 0.425)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.686
Model XAI F1 of binarized graphs for r=0.6 =  0.56277625
Model XAI WIoU of binarized graphs for r=0.6 =  0.44329500000000005
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.598
SUFF++ for r=0.6 class 0 = 0.455 +- 0.262 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 class 1 = 0.773 +- 0.262 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 class 2 = 0.63 +- 0.262 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 all KL = 0.635 +- 0.262 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 all L1 = 0.619 +- 0.213 (in-sample avg dev_std = 0.394)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.918
Model XAI F1 of binarized graphs for r=0.9 =  0.45431999999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.33086625
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.802
SUFF++ for r=0.9 class 0 = 0.587 +- 0.190 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 class 1 = 0.849 +- 0.190 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 class 2 = 0.814 +- 0.190 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 all KL = 0.819 +- 0.190 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 all L1 = 0.751 +- 0.181 (in-sample avg dev_std = 0.320)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.93
Model XAI F1 of binarized graphs for r=0.95 =  0.44670625
Model XAI WIoU of binarized graphs for r=0.95 =  0.32400125
len(reference) = 732
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.869
SUFF++ for r=0.95 class 0 = 0.733 +- 0.145 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.95 class 1 = 0.885 +- 0.145 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.95 class 2 = 0.852 +- 0.145 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.95 all KL = 0.887 +- 0.145 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.95 all L1 = 0.824 +- 0.133 (in-sample avg dev_std = 0.297)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.359
Model XAI F1 of binarized graphs for r=0.3 =  0.56971625
Model XAI WIoU of binarized graphs for r=0.3 =  0.45398375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.468
SUFF++ for r=0.3 class 0 = 0.566 +- 0.236 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.3 class 1 = 0.634 +- 0.236 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.3 class 2 = 0.61 +- 0.236 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.3 all KL = 0.655 +- 0.236 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.3 all L1 = 0.604 +- 0.165 (in-sample avg dev_std = 0.375)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.658
Model XAI F1 of binarized graphs for r=0.4 =  0.5656937499999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.45289250000000003
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.611
SUFF++ for r=0.4 class 0 = 0.497 +- 0.287 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.4 class 1 = 0.613 +- 0.287 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.4 class 2 = 0.681 +- 0.287 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.4 all KL = 0.588 +- 0.287 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.4 all L1 = 0.598 +- 0.192 (in-sample avg dev_std = 0.445)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.766
Model XAI F1 of binarized graphs for r=0.6 =  0.4948887500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.35975250000000003
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.672
SUFF++ for r=0.6 class 0 = 0.471 +- 0.189 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.6 class 1 = 0.802 +- 0.189 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.6 class 2 = 0.679 +- 0.189 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.6 all KL = 0.731 +- 0.189 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.6 all L1 = 0.654 +- 0.194 (in-sample avg dev_std = 0.358)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.754
Model XAI F1 of binarized graphs for r=0.9 =  0.4132875
Model XAI WIoU of binarized graphs for r=0.9 =  0.281845
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.749
SUFF++ for r=0.9 class 0 = 0.599 +- 0.140 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 1 = 0.824 +- 0.140 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 2 = 0.834 +- 0.140 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all KL = 0.865 +- 0.140 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all L1 = 0.754 +- 0.172 (in-sample avg dev_std = 0.221)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.757
Model XAI F1 of binarized graphs for r=0.95 =  0.39871875
Model XAI WIoU of binarized graphs for r=0.95 =  0.26946
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.771
SUFF++ for r=0.95 class 0 = 0.703 +- 0.146 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.95 class 1 = 0.922 +- 0.146 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.95 class 2 = 0.904 +- 0.146 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.95 all KL = 0.916 +- 0.146 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.95 all L1 = 0.845 +- 0.139 (in-sample avg dev_std = 0.254)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 15:18:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/08/2024 03:18:39 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 03:18:39 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 03:18:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:18:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:18:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:18:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9303
Train Loss: 0.3173
ID Validation ACCURACY: 0.9357
ID Validation Loss: 0.3076
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3411
OOD Validation ACCURACY: 0.8477
OOD Validation Loss: 0.4798
OOD Test ACCURACY: 0.6430
OOD Test Loss: 0.9596

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ACCURACY: 0.9249
Train Loss: 0.3435
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3292
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3609
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3859
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.8691

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6430 0.9200 0.5833 0.9297 0.9273[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.723
WIoU for r=0.3 = 0.605
F1 for r=0.4 = 0.703
WIoU for r=0.4 = 0.596
F1 for r=0.6 = 0.593
WIoU for r=0.6 = 0.472
F1 for r=0.9 = 0.471
WIoU for r=0.9 = 0.349
F1 for r=0.95 = 0.455
WIoU for r=0.95 = 0.335
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.325
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.676
WIoU for r=0.3 = 0.547
F1 for r=0.4 = 0.662
WIoU for r=0.4 = 0.543
F1 for r=0.6 = 0.508
WIoU for r=0.6 = 0.374
F1 for r=0.9 = 0.413
WIoU for r=0.9 = 0.285
F1 for r=0.95 = 0.400
WIoU for r=0.95 = 0.274
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.268


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.489
Model XAI F1 of binarized graphs for r=0.3 =  0.7234225000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.605325
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.317
NEC for r=0.3 class 0 = 0.636 +- 0.273 (in-sample avg dev_std = 0.416)
NEC for r=0.3 class 1 = 0.593 +- 0.273 (in-sample avg dev_std = 0.416)
NEC for r=0.3 class 2 = 0.628 +- 0.273 (in-sample avg dev_std = 0.416)
NEC for r=0.3 all KL = 0.623 +- 0.273 (in-sample avg dev_std = 0.416)
NEC for r=0.3 all L1 = 0.62 +- 0.151 (in-sample avg dev_std = 0.416)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.605
Model XAI F1 of binarized graphs for r=0.4 =  0.703215
Model XAI WIoU of binarized graphs for r=0.4 =  0.5957187500000001
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.368
NEC for r=0.4 class 0 = 0.608 +- 0.298 (in-sample avg dev_std = 0.458)
NEC for r=0.4 class 1 = 0.545 +- 0.298 (in-sample avg dev_std = 0.458)
NEC for r=0.4 class 2 = 0.646 +- 0.298 (in-sample avg dev_std = 0.458)
NEC for r=0.4 all KL = 0.619 +- 0.298 (in-sample avg dev_std = 0.458)
NEC for r=0.4 all L1 = 0.601 +- 0.162 (in-sample avg dev_std = 0.458)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.743
Model XAI F1 of binarized graphs for r=0.6 =  0.5931475
Model XAI WIoU of binarized graphs for r=0.6 =  0.4717075
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.369
NEC for r=0.6 class 0 = 0.627 +- 0.287 (in-sample avg dev_std = 0.475)
NEC for r=0.6 class 1 = 0.46 +- 0.287 (in-sample avg dev_std = 0.475)
NEC for r=0.6 class 2 = 0.651 +- 0.287 (in-sample avg dev_std = 0.475)
NEC for r=0.6 all KL = 0.619 +- 0.287 (in-sample avg dev_std = 0.475)
NEC for r=0.6 all L1 = 0.581 +- 0.192 (in-sample avg dev_std = 0.475)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.905
Model XAI F1 of binarized graphs for r=0.9 =  0.470985
Model XAI WIoU of binarized graphs for r=0.9 =  0.34901499999999996
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.521
NEC for r=0.9 class 0 = 0.586 +- 0.247 (in-sample avg dev_std = 0.580)
NEC for r=0.9 class 1 = 0.475 +- 0.247 (in-sample avg dev_std = 0.580)
NEC for r=0.9 class 2 = 0.56 +- 0.247 (in-sample avg dev_std = 0.580)
NEC for r=0.9 all KL = 0.572 +- 0.247 (in-sample avg dev_std = 0.580)
NEC for r=0.9 all L1 = 0.541 +- 0.157 (in-sample avg dev_std = 0.580)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.929
Model XAI F1 of binarized graphs for r=0.95 =  0.45539500000000005
Model XAI WIoU of binarized graphs for r=0.95 =  0.33496250000000005
len(reference) = 800
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.533
NEC for r=0.95 class 0 = 0.569 +- 0.236 (in-sample avg dev_std = 0.593)
NEC for r=0.95 class 1 = 0.445 +- 0.236 (in-sample avg dev_std = 0.593)
NEC for r=0.95 class 2 = 0.542 +- 0.236 (in-sample avg dev_std = 0.593)
NEC for r=0.95 all KL = 0.54 +- 0.236 (in-sample avg dev_std = 0.593)
NEC for r=0.95 all L1 = 0.519 +- 0.163 (in-sample avg dev_std = 0.593)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.32503375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.547
NEC for r=1.0 class 0 = 0.544 +- 0.250 (in-sample avg dev_std = 0.609)
NEC for r=1.0 class 1 = 0.422 +- 0.250 (in-sample avg dev_std = 0.609)
NEC for r=1.0 class 2 = 0.555 +- 0.250 (in-sample avg dev_std = 0.609)
NEC for r=1.0 all KL = 0.543 +- 0.250 (in-sample avg dev_std = 0.609)
NEC for r=1.0 all L1 = 0.508 +- 0.174 (in-sample avg dev_std = 0.609)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.694
Model XAI F1 of binarized graphs for r=0.3 =  0.6756125000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5474874999999999
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.451
NEC for r=0.3 class 0 = 0.574 +- 0.249 (in-sample avg dev_std = 0.497)
NEC for r=0.3 class 1 = 0.597 +- 0.249 (in-sample avg dev_std = 0.497)
NEC for r=0.3 class 2 = 0.634 +- 0.249 (in-sample avg dev_std = 0.497)
NEC for r=0.3 all KL = 0.656 +- 0.249 (in-sample avg dev_std = 0.497)
NEC for r=0.3 all L1 = 0.602 +- 0.136 (in-sample avg dev_std = 0.497)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.646
Model XAI F1 of binarized graphs for r=0.4 =  0.6624599999999998
Model XAI WIoU of binarized graphs for r=0.4 =  0.543365
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.399
NEC for r=0.4 class 0 = 0.57 +- 0.254 (in-sample avg dev_std = 0.553)
NEC for r=0.4 class 1 = 0.605 +- 0.254 (in-sample avg dev_std = 0.553)
NEC for r=0.4 class 2 = 0.661 +- 0.254 (in-sample avg dev_std = 0.553)
NEC for r=0.4 all KL = 0.672 +- 0.254 (in-sample avg dev_std = 0.553)
NEC for r=0.4 all L1 = 0.612 +- 0.138 (in-sample avg dev_std = 0.553)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.75
Model XAI F1 of binarized graphs for r=0.6 =  0.50813
Model XAI WIoU of binarized graphs for r=0.6 =  0.374095
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.449
NEC for r=0.6 class 0 = 0.6 +- 0.249 (in-sample avg dev_std = 0.574)
NEC for r=0.6 class 1 = 0.544 +- 0.249 (in-sample avg dev_std = 0.574)
NEC for r=0.6 class 2 = 0.606 +- 0.249 (in-sample avg dev_std = 0.574)
NEC for r=0.6 all KL = 0.632 +- 0.249 (in-sample avg dev_std = 0.574)
NEC for r=0.6 all L1 = 0.583 +- 0.139 (in-sample avg dev_std = 0.574)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.754
Model XAI F1 of binarized graphs for r=0.9 =  0.413335
Model XAI WIoU of binarized graphs for r=0.9 =  0.2854925
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.583
NEC for r=0.9 class 0 = 0.543 +- 0.293 (in-sample avg dev_std = 0.561)
NEC for r=0.9 class 1 = 0.434 +- 0.293 (in-sample avg dev_std = 0.561)
NEC for r=0.9 class 2 = 0.439 +- 0.293 (in-sample avg dev_std = 0.561)
NEC for r=0.9 all KL = 0.544 +- 0.293 (in-sample avg dev_std = 0.561)
NEC for r=0.9 all L1 = 0.471 +- 0.162 (in-sample avg dev_std = 0.561)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.636
Model XAI F1 of binarized graphs for r=0.95 =  0.40029124999999993
Model XAI WIoU of binarized graphs for r=0.95 =  0.27403875
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.586
NEC for r=0.95 class 0 = 0.512 +- 0.289 (in-sample avg dev_std = 0.495)
NEC for r=0.95 class 1 = 0.43 +- 0.289 (in-sample avg dev_std = 0.495)
NEC for r=0.95 class 2 = 0.379 +- 0.289 (in-sample avg dev_std = 0.495)
NEC for r=0.95 all KL = 0.49 +- 0.289 (in-sample avg dev_std = 0.495)
NEC for r=0.95 all L1 = 0.44 +- 0.156 (in-sample avg dev_std = 0.495)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.656
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.26764499999999997
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.575
NEC for r=1.0 class 0 = 0.454 +- 0.235 (in-sample avg dev_std = 0.455)
NEC for r=1.0 class 1 = 0.407 +- 0.235 (in-sample avg dev_std = 0.455)
NEC for r=1.0 class 2 = 0.327 +- 0.235 (in-sample avg dev_std = 0.455)
NEC for r=1.0 all KL = 0.378 +- 0.235 (in-sample avg dev_std = 0.455)
NEC for r=1.0 all L1 = 0.396 +- 0.150 (in-sample avg dev_std = 0.455)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.493
Model XAI F1 of binarized graphs for r=0.3 =  0.7234225000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.605325
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.458
SUFF++ for r=0.3 class 0 = 0.455 +- 0.281 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 class 1 = 0.477 +- 0.281 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 class 2 = 0.544 +- 0.281 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 all KL = 0.509 +- 0.281 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.3 all L1 = 0.493 +- 0.170 (in-sample avg dev_std = 0.473)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.605
Model XAI F1 of binarized graphs for r=0.4 =  0.703215
Model XAI WIoU of binarized graphs for r=0.4 =  0.5957187500000001
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF++ for r=0.4 class 0 = 0.462 +- 0.286 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.4 class 1 = 0.543 +- 0.286 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.4 class 2 = 0.594 +- 0.286 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.4 all KL = 0.529 +- 0.286 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.4 all L1 = 0.534 +- 0.170 (in-sample avg dev_std = 0.517)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.739
Model XAI F1 of binarized graphs for r=0.6 =  0.5931475
Model XAI WIoU of binarized graphs for r=0.6 =  0.4717075
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.658
SUFF++ for r=0.6 class 0 = 0.437 +- 0.267 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 1 = 0.693 +- 0.267 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 2 = 0.645 +- 0.267 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 all KL = 0.587 +- 0.267 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 all L1 = 0.592 +- 0.195 (in-sample avg dev_std = 0.452)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.470985
Model XAI WIoU of binarized graphs for r=0.9 =  0.34901499999999996
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.831
SUFF++ for r=0.9 class 0 = 0.69 +- 0.202 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 class 1 = 0.809 +- 0.202 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 class 2 = 0.834 +- 0.202 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 all KL = 0.84 +- 0.202 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 all L1 = 0.779 +- 0.192 (in-sample avg dev_std = 0.278)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.93
Model XAI F1 of binarized graphs for r=0.95 =  0.45539500000000005
Model XAI WIoU of binarized graphs for r=0.95 =  0.33496250000000005
len(reference) = 732
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.88
SUFF++ for r=0.95 class 0 = 0.822 +- 0.134 (in-sample avg dev_std = 0.204)
SUFF++ for r=0.95 class 1 = 0.858 +- 0.134 (in-sample avg dev_std = 0.204)
SUFF++ for r=0.95 class 2 = 0.881 +- 0.134 (in-sample avg dev_std = 0.204)
SUFF++ for r=0.95 all KL = 0.917 +- 0.134 (in-sample avg dev_std = 0.204)
SUFF++ for r=0.95 all L1 = 0.854 +- 0.147 (in-sample avg dev_std = 0.204)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.694
Model XAI F1 of binarized graphs for r=0.3 =  0.6756125000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5474874999999999
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.522
SUFF++ for r=0.3 class 0 = 0.48 +- 0.297 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 class 1 = 0.625 +- 0.297 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 class 2 = 0.595 +- 0.297 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 all KL = 0.552 +- 0.297 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 all L1 = 0.568 +- 0.190 (in-sample avg dev_std = 0.511)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.647
Model XAI F1 of binarized graphs for r=0.4 =  0.6624599999999998
Model XAI WIoU of binarized graphs for r=0.4 =  0.543365
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.643
SUFF++ for r=0.4 class 0 = 0.518 +- 0.277 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.4 class 1 = 0.497 +- 0.277 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.4 class 2 = 0.696 +- 0.277 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.4 all KL = 0.539 +- 0.277 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.4 all L1 = 0.57 +- 0.175 (in-sample avg dev_std = 0.503)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.751
Model XAI F1 of binarized graphs for r=0.6 =  0.50813
Model XAI WIoU of binarized graphs for r=0.6 =  0.374095
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.691
SUFF++ for r=0.6 class 0 = 0.468 +- 0.228 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 1 = 0.722 +- 0.228 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 2 = 0.702 +- 0.228 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 all KL = 0.658 +- 0.228 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 all L1 = 0.633 +- 0.178 (in-sample avg dev_std = 0.422)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.755
Model XAI F1 of binarized graphs for r=0.9 =  0.413335
Model XAI WIoU of binarized graphs for r=0.9 =  0.2854925
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.705
SUFF++ for r=0.9 class 0 = 0.602 +- 0.230 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 class 1 = 0.735 +- 0.230 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 class 2 = 0.904 +- 0.230 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 all KL = 0.805 +- 0.230 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.9 all L1 = 0.748 +- 0.196 (in-sample avg dev_std = 0.347)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.636
Model XAI F1 of binarized graphs for r=0.95 =  0.40029124999999993
Model XAI WIoU of binarized graphs for r=0.95 =  0.27403875
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.69
SUFF++ for r=0.95 class 0 = 0.72 +- 0.190 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.95 class 1 = 0.794 +- 0.190 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.95 class 2 = 0.946 +- 0.190 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.95 all KL = 0.879 +- 0.190 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.95 all L1 = 0.821 +- 0.157 (in-sample avg dev_std = 0.299)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 15:22:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/08/2024 03:22:31 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 03:22:31 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 03:22:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:22:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:22:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:22:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:22:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:22:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:22:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:22:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3303
ID Validation ACCURACY: 0.9350
ID Validation Loss: 0.3133
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3501
OOD Validation ACCURACY: 0.8013
OOD Validation Loss: 0.5544
OOD Test ACCURACY: 0.7917
OOD Test Loss: 0.8351

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9260
Train Loss: 0.3556
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.3333
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3700
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.4586
OOD Test ACCURACY: 0.6470
OOD Test Loss: 1.3751

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.7917 0.9233 0.6470 0.9317 0.9260[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.661
WIoU for r=0.3 = 0.538
F1 for r=0.4 = 0.631
WIoU for r=0.4 = 0.510
F1 for r=0.6 = 0.546
WIoU for r=0.6 = 0.422
F1 for r=0.9 = 0.459
WIoU for r=0.9 = 0.333
F1 for r=0.95 = 0.449
WIoU for r=0.95 = 0.325
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.319
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.636
WIoU for r=0.3 = 0.515
F1 for r=0.4 = 0.581
WIoU for r=0.4 = 0.464
F1 for r=0.6 = 0.490
WIoU for r=0.6 = 0.355
F1 for r=0.9 = 0.411
WIoU for r=0.9 = 0.279
F1 for r=0.95 = 0.398
WIoU for r=0.95 = 0.269
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.263


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.451
Model XAI F1 of binarized graphs for r=0.3 =  0.6614675
Model XAI WIoU of binarized graphs for r=0.3 =  0.5380575000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.338
NEC for r=0.3 class 0 = 0.625 +- 0.246 (in-sample avg dev_std = 0.461)
NEC for r=0.3 class 1 = 0.551 +- 0.246 (in-sample avg dev_std = 0.461)
NEC for r=0.3 class 2 = 0.66 +- 0.246 (in-sample avg dev_std = 0.461)
NEC for r=0.3 all KL = 0.631 +- 0.246 (in-sample avg dev_std = 0.461)
NEC for r=0.3 all L1 = 0.613 +- 0.145 (in-sample avg dev_std = 0.461)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.469
Model XAI F1 of binarized graphs for r=0.4 =  0.63072875
Model XAI WIoU of binarized graphs for r=0.4 =  0.51009375
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.33
NEC for r=0.4 class 0 = 0.603 +- 0.289 (in-sample avg dev_std = 0.449)
NEC for r=0.4 class 1 = 0.439 +- 0.289 (in-sample avg dev_std = 0.449)
NEC for r=0.4 class 2 = 0.654 +- 0.289 (in-sample avg dev_std = 0.449)
NEC for r=0.4 all KL = 0.572 +- 0.289 (in-sample avg dev_std = 0.449)
NEC for r=0.4 all L1 = 0.567 +- 0.174 (in-sample avg dev_std = 0.449)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.619
Model XAI F1 of binarized graphs for r=0.6 =  0.5463225
Model XAI WIoU of binarized graphs for r=0.6 =  0.422085
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.385
NEC for r=0.6 class 0 = 0.57 +- 0.276 (in-sample avg dev_std = 0.470)
NEC for r=0.6 class 1 = 0.432 +- 0.276 (in-sample avg dev_std = 0.470)
NEC for r=0.6 class 2 = 0.66 +- 0.276 (in-sample avg dev_std = 0.470)
NEC for r=0.6 all KL = 0.583 +- 0.276 (in-sample avg dev_std = 0.470)
NEC for r=0.6 all L1 = 0.557 +- 0.186 (in-sample avg dev_std = 0.470)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.4590625
Model XAI WIoU of binarized graphs for r=0.9 =  0.33327875000000007
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.508
NEC for r=0.9 class 0 = 0.625 +- 0.230 (in-sample avg dev_std = 0.596)
NEC for r=0.9 class 1 = 0.453 +- 0.230 (in-sample avg dev_std = 0.596)
NEC for r=0.9 class 2 = 0.572 +- 0.230 (in-sample avg dev_std = 0.596)
NEC for r=0.9 all KL = 0.614 +- 0.230 (in-sample avg dev_std = 0.596)
NEC for r=0.9 all L1 = 0.551 +- 0.165 (in-sample avg dev_std = 0.596)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.93
Model XAI F1 of binarized graphs for r=0.95 =  0.44948625
Model XAI WIoU of binarized graphs for r=0.95 =  0.32457375
len(reference) = 800
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.555
NEC for r=0.95 class 0 = 0.601 +- 0.228 (in-sample avg dev_std = 0.606)
NEC for r=0.95 class 1 = 0.413 +- 0.228 (in-sample avg dev_std = 0.606)
NEC for r=0.95 class 2 = 0.548 +- 0.228 (in-sample avg dev_std = 0.606)
NEC for r=0.95 all KL = 0.566 +- 0.228 (in-sample avg dev_std = 0.606)
NEC for r=0.95 all L1 = 0.521 +- 0.172 (in-sample avg dev_std = 0.606)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.3186425
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.557
NEC for r=1.0 class 0 = 0.57 +- 0.252 (in-sample avg dev_std = 0.622)
NEC for r=1.0 class 1 = 0.399 +- 0.252 (in-sample avg dev_std = 0.622)
NEC for r=1.0 class 2 = 0.562 +- 0.252 (in-sample avg dev_std = 0.622)
NEC for r=1.0 all KL = 0.569 +- 0.252 (in-sample avg dev_std = 0.622)
NEC for r=1.0 all L1 = 0.512 +- 0.181 (in-sample avg dev_std = 0.622)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.688
Model XAI F1 of binarized graphs for r=0.3 =  0.63566625
Model XAI WIoU of binarized graphs for r=0.3 =  0.515265
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.365
NEC for r=0.3 class 0 = 0.653 +- 0.241 (in-sample avg dev_std = 0.468)
NEC for r=0.3 class 1 = 0.517 +- 0.241 (in-sample avg dev_std = 0.468)
NEC for r=0.3 class 2 = 0.658 +- 0.241 (in-sample avg dev_std = 0.468)
NEC for r=0.3 all KL = 0.638 +- 0.241 (in-sample avg dev_std = 0.468)
NEC for r=0.3 all L1 = 0.608 +- 0.138 (in-sample avg dev_std = 0.468)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.704
Model XAI F1 of binarized graphs for r=0.4 =  0.5806625
Model XAI WIoU of binarized graphs for r=0.4 =  0.46395250000000005
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.397
NEC for r=0.4 class 0 = 0.559 +- 0.276 (in-sample avg dev_std = 0.490)
NEC for r=0.4 class 1 = 0.519 +- 0.276 (in-sample avg dev_std = 0.490)
NEC for r=0.4 class 2 = 0.658 +- 0.276 (in-sample avg dev_std = 0.490)
NEC for r=0.4 all KL = 0.615 +- 0.276 (in-sample avg dev_std = 0.490)
NEC for r=0.4 all L1 = 0.579 +- 0.152 (in-sample avg dev_std = 0.490)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.48989374999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.35478499999999996
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.457
NEC for r=0.6 class 0 = 0.569 +- 0.218 (in-sample avg dev_std = 0.455)
NEC for r=0.6 class 1 = 0.43 +- 0.218 (in-sample avg dev_std = 0.455)
NEC for r=0.6 class 2 = 0.562 +- 0.218 (in-sample avg dev_std = 0.455)
NEC for r=0.6 all KL = 0.481 +- 0.218 (in-sample avg dev_std = 0.455)
NEC for r=0.6 all L1 = 0.519 +- 0.155 (in-sample avg dev_std = 0.455)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.738
Model XAI F1 of binarized graphs for r=0.9 =  0.41095375000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.2793825
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.59
NEC for r=0.9 class 0 = 0.6 +- 0.289 (in-sample avg dev_std = 0.532)
NEC for r=0.9 class 1 = 0.389 +- 0.289 (in-sample avg dev_std = 0.532)
NEC for r=0.9 class 2 = 0.455 +- 0.289 (in-sample avg dev_std = 0.532)
NEC for r=0.9 all KL = 0.506 +- 0.289 (in-sample avg dev_std = 0.532)
NEC for r=0.9 all L1 = 0.479 +- 0.171 (in-sample avg dev_std = 0.532)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.779
Model XAI F1 of binarized graphs for r=0.95 =  0.39837874999999995
Model XAI WIoU of binarized graphs for r=0.95 =  0.26855125
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.595
NEC for r=0.95 class 0 = 0.547 +- 0.307 (in-sample avg dev_std = 0.562)
NEC for r=0.95 class 1 = 0.383 +- 0.307 (in-sample avg dev_std = 0.562)
NEC for r=0.95 class 2 = 0.418 +- 0.307 (in-sample avg dev_std = 0.562)
NEC for r=0.95 all KL = 0.506 +- 0.307 (in-sample avg dev_std = 0.562)
NEC for r=0.95 all L1 = 0.448 +- 0.173 (in-sample avg dev_std = 0.562)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.806
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.26323375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.613
NEC for r=1.0 class 0 = 0.502 +- 0.262 (in-sample avg dev_std = 0.548)
NEC for r=1.0 class 1 = 0.369 +- 0.262 (in-sample avg dev_std = 0.548)
NEC for r=1.0 class 2 = 0.394 +- 0.262 (in-sample avg dev_std = 0.548)
NEC for r=1.0 all KL = 0.438 +- 0.262 (in-sample avg dev_std = 0.548)
NEC for r=1.0 all L1 = 0.42 +- 0.171 (in-sample avg dev_std = 0.548)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.452
Model XAI F1 of binarized graphs for r=0.3 =  0.6614675
Model XAI WIoU of binarized graphs for r=0.3 =  0.5380575000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.445
SUFF++ for r=0.3 class 0 = 0.407 +- 0.246 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.3 class 1 = 0.499 +- 0.246 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.3 class 2 = 0.49 +- 0.246 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.3 all KL = 0.455 +- 0.246 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.3 all L1 = 0.466 +- 0.160 (in-sample avg dev_std = 0.506)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.468
Model XAI F1 of binarized graphs for r=0.4 =  0.63072875
Model XAI WIoU of binarized graphs for r=0.4 =  0.51009375
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.486
SUFF++ for r=0.4 class 0 = 0.468 +- 0.254 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.4 class 1 = 0.574 +- 0.254 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.4 class 2 = 0.552 +- 0.254 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.4 all KL = 0.55 +- 0.254 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.4 all L1 = 0.532 +- 0.170 (in-sample avg dev_std = 0.472)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.618
Model XAI F1 of binarized graphs for r=0.6 =  0.5463225
Model XAI WIoU of binarized graphs for r=0.6 =  0.422085
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.599
SUFF++ for r=0.6 class 0 = 0.463 +- 0.246 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 class 1 = 0.668 +- 0.246 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 class 2 = 0.647 +- 0.246 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 all KL = 0.607 +- 0.246 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 all L1 = 0.593 +- 0.178 (in-sample avg dev_std = 0.446)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.4590625
Model XAI WIoU of binarized graphs for r=0.9 =  0.33327875000000007
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.828
SUFF++ for r=0.9 class 0 = 0.635 +- 0.198 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 class 1 = 0.859 +- 0.198 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 class 2 = 0.824 +- 0.198 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 all KL = 0.833 +- 0.198 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 all L1 = 0.773 +- 0.184 (in-sample avg dev_std = 0.286)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.932
Model XAI F1 of binarized graphs for r=0.95 =  0.44948625
Model XAI WIoU of binarized graphs for r=0.95 =  0.32457375
len(reference) = 732
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.886
SUFF++ for r=0.95 class 0 = 0.771 +- 0.139 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.95 class 1 = 0.893 +- 0.139 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.95 class 2 = 0.869 +- 0.139 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.95 all KL = 0.904 +- 0.139 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.95 all L1 = 0.845 +- 0.136 (in-sample avg dev_std = 0.259)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.688
Model XAI F1 of binarized graphs for r=0.3 =  0.63566625
Model XAI WIoU of binarized graphs for r=0.3 =  0.515265
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.519
SUFF++ for r=0.3 class 0 = 0.512 +- 0.278 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.3 class 1 = 0.625 +- 0.278 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.3 class 2 = 0.566 +- 0.278 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.3 all KL = 0.582 +- 0.278 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.3 all L1 = 0.568 +- 0.189 (in-sample avg dev_std = 0.472)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.704
Model XAI F1 of binarized graphs for r=0.4 =  0.5806625
Model XAI WIoU of binarized graphs for r=0.4 =  0.46395250000000005
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.615
SUFF++ for r=0.4 class 0 = 0.499 +- 0.281 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.4 class 1 = 0.655 +- 0.281 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.4 class 2 = 0.647 +- 0.281 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.4 all KL = 0.592 +- 0.281 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.4 all L1 = 0.602 +- 0.175 (in-sample avg dev_std = 0.466)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.48989374999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.35478499999999996
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.633
SUFF++ for r=0.6 class 0 = 0.482 +- 0.201 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.6 class 1 = 0.697 +- 0.201 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.6 class 2 = 0.712 +- 0.201 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.6 all KL = 0.717 +- 0.201 (in-sample avg dev_std = 0.347)
SUFF++ for r=0.6 all L1 = 0.632 +- 0.175 (in-sample avg dev_std = 0.347)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.736
Model XAI F1 of binarized graphs for r=0.9 =  0.41095375000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.2793825
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.691
SUFF++ for r=0.9 class 0 = 0.694 +- 0.169 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.9 class 1 = 0.757 +- 0.169 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.9 class 2 = 0.829 +- 0.169 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.9 all KL = 0.841 +- 0.169 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.9 all L1 = 0.761 +- 0.174 (in-sample avg dev_std = 0.268)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.779
Model XAI F1 of binarized graphs for r=0.95 =  0.39837874999999995
Model XAI WIoU of binarized graphs for r=0.95 =  0.26855125
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.757
SUFF++ for r=0.95 class 0 = 0.738 +- 0.189 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.95 class 1 = 0.893 +- 0.189 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.95 class 2 = 0.895 +- 0.189 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.95 all KL = 0.889 +- 0.189 (in-sample avg dev_std = 0.291)
SUFF++ for r=0.95 all L1 = 0.843 +- 0.139 (in-sample avg dev_std = 0.291)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 15:26:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/08/2024 03:26:43 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 03:26:43 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 03:26:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:26:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:26:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:26:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:26:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:26:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:26:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:26:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9303
Train Loss: 0.3118
ID Validation ACCURACY: 0.9357
ID Validation Loss: 0.3016
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3358
OOD Validation ACCURACY: 0.8073
OOD Validation Loss: 0.5158
OOD Test ACCURACY: 0.7527
OOD Test Loss: 1.0888

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9293
Train Loss: 0.3258
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3155
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3465
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.4445
OOD Test ACCURACY: 0.5280
OOD Test Loss: 1.3857

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7527 0.9257 0.5280 0.9347 0.9260[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.717
WIoU for r=0.3 = 0.599
F1 for r=0.4 = 0.697
WIoU for r=0.4 = 0.588
F1 for r=0.6 = 0.592
WIoU for r=0.6 = 0.468
F1 for r=0.9 = 0.471
WIoU for r=0.9 = 0.347
F1 for r=0.95 = 0.455
WIoU for r=0.95 = 0.333
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.324
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.654
WIoU for r=0.3 = 0.519
F1 for r=0.4 = 0.621
WIoU for r=0.4 = 0.498
F1 for r=0.6 = 0.483
WIoU for r=0.6 = 0.348
F1 for r=0.9 = 0.390
WIoU for r=0.9 = 0.262
F1 for r=0.95 = 0.390
WIoU for r=0.95 = 0.261
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.263


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.482
Model XAI F1 of binarized graphs for r=0.3 =  0.71724125
Model XAI WIoU of binarized graphs for r=0.3 =  0.5986525
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.312
NEC for r=0.3 class 0 = 0.618 +- 0.270 (in-sample avg dev_std = 0.391)
NEC for r=0.3 class 1 = 0.467 +- 0.270 (in-sample avg dev_std = 0.391)
NEC for r=0.3 class 2 = 0.58 +- 0.270 (in-sample avg dev_std = 0.391)
NEC for r=0.3 all KL = 0.55 +- 0.270 (in-sample avg dev_std = 0.391)
NEC for r=0.3 all L1 = 0.556 +- 0.176 (in-sample avg dev_std = 0.391)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.641
Model XAI F1 of binarized graphs for r=0.4 =  0.6965062500000001
Model XAI WIoU of binarized graphs for r=0.4 =  0.5880325
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.373
NEC for r=0.4 class 0 = 0.608 +- 0.267 (in-sample avg dev_std = 0.406)
NEC for r=0.4 class 1 = 0.46 +- 0.267 (in-sample avg dev_std = 0.406)
NEC for r=0.4 class 2 = 0.639 +- 0.267 (in-sample avg dev_std = 0.406)
NEC for r=0.4 all KL = 0.572 +- 0.267 (in-sample avg dev_std = 0.406)
NEC for r=0.4 all L1 = 0.571 +- 0.156 (in-sample avg dev_std = 0.406)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.764
Model XAI F1 of binarized graphs for r=0.6 =  0.59186125
Model XAI WIoU of binarized graphs for r=0.6 =  0.4677675
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.432
NEC for r=0.6 class 0 = 0.644 +- 0.261 (in-sample avg dev_std = 0.456)
NEC for r=0.6 class 1 = 0.452 +- 0.261 (in-sample avg dev_std = 0.456)
NEC for r=0.6 class 2 = 0.62 +- 0.261 (in-sample avg dev_std = 0.456)
NEC for r=0.6 all KL = 0.564 +- 0.261 (in-sample avg dev_std = 0.456)
NEC for r=0.6 all L1 = 0.573 +- 0.166 (in-sample avg dev_std = 0.456)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.4707525
Model XAI WIoU of binarized graphs for r=0.9 =  0.34706500000000007
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.521
NEC for r=0.9 class 0 = 0.602 +- 0.215 (in-sample avg dev_std = 0.555)
NEC for r=0.9 class 1 = 0.441 +- 0.215 (in-sample avg dev_std = 0.555)
NEC for r=0.9 class 2 = 0.571 +- 0.215 (in-sample avg dev_std = 0.555)
NEC for r=0.9 all KL = 0.55 +- 0.215 (in-sample avg dev_std = 0.555)
NEC for r=0.9 all L1 = 0.539 +- 0.160 (in-sample avg dev_std = 0.555)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.93
Model XAI F1 of binarized graphs for r=0.95 =  0.45474999999999993
Model XAI WIoU of binarized graphs for r=0.95 =  0.332845
len(reference) = 800
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.542
NEC for r=0.95 class 0 = 0.586 +- 0.227 (in-sample avg dev_std = 0.605)
NEC for r=0.95 class 1 = 0.409 +- 0.227 (in-sample avg dev_std = 0.605)
NEC for r=0.95 class 2 = 0.555 +- 0.227 (in-sample avg dev_std = 0.605)
NEC for r=0.95 all KL = 0.555 +- 0.227 (in-sample avg dev_std = 0.605)
NEC for r=0.95 all L1 = 0.518 +- 0.171 (in-sample avg dev_std = 0.605)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.32357375000000005
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.553
NEC for r=1.0 class 0 = 0.569 +- 0.251 (in-sample avg dev_std = 0.619)
NEC for r=1.0 class 1 = 0.382 +- 0.251 (in-sample avg dev_std = 0.619)
NEC for r=1.0 class 2 = 0.571 +- 0.251 (in-sample avg dev_std = 0.619)
NEC for r=1.0 all KL = 0.551 +- 0.251 (in-sample avg dev_std = 0.619)
NEC for r=1.0 all L1 = 0.509 +- 0.181 (in-sample avg dev_std = 0.619)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.456
Model XAI F1 of binarized graphs for r=0.3 =  0.6542587499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.51921125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.412
NEC for r=0.3 class 0 = 0.506 +- 0.235 (in-sample avg dev_std = 0.483)
NEC for r=0.3 class 1 = 0.577 +- 0.235 (in-sample avg dev_std = 0.483)
NEC for r=0.3 class 2 = 0.577 +- 0.235 (in-sample avg dev_std = 0.483)
NEC for r=0.3 all KL = 0.6 +- 0.235 (in-sample avg dev_std = 0.483)
NEC for r=0.3 all L1 = 0.554 +- 0.173 (in-sample avg dev_std = 0.483)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.561
Model XAI F1 of binarized graphs for r=0.4 =  0.6210937499999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.49783125
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.402
NEC for r=0.4 class 0 = 0.595 +- 0.258 (in-sample avg dev_std = 0.486)
NEC for r=0.4 class 1 = 0.56 +- 0.258 (in-sample avg dev_std = 0.486)
NEC for r=0.4 class 2 = 0.683 +- 0.258 (in-sample avg dev_std = 0.486)
NEC for r=0.4 all KL = 0.613 +- 0.258 (in-sample avg dev_std = 0.486)
NEC for r=0.4 all L1 = 0.612 +- 0.150 (in-sample avg dev_std = 0.486)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.589
Model XAI F1 of binarized graphs for r=0.6 =  0.48279250000000007
Model XAI WIoU of binarized graphs for r=0.6 =  0.3483737499999999
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.444
NEC for r=0.6 class 0 = 0.578 +- 0.232 (in-sample avg dev_std = 0.441)
NEC for r=0.6 class 1 = 0.499 +- 0.232 (in-sample avg dev_std = 0.441)
NEC for r=0.6 class 2 = 0.539 +- 0.232 (in-sample avg dev_std = 0.441)
NEC for r=0.6 all KL = 0.487 +- 0.232 (in-sample avg dev_std = 0.441)
NEC for r=0.6 all L1 = 0.538 +- 0.142 (in-sample avg dev_std = 0.441)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.76
Model XAI F1 of binarized graphs for r=0.9 =  0.38961875
Model XAI WIoU of binarized graphs for r=0.9 =  0.26186
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.593
NEC for r=0.9 class 0 = 0.529 +- 0.292 (in-sample avg dev_std = 0.542)
NEC for r=0.9 class 1 = 0.386 +- 0.292 (in-sample avg dev_std = 0.542)
NEC for r=0.9 class 2 = 0.424 +- 0.292 (in-sample avg dev_std = 0.542)
NEC for r=0.9 all KL = 0.446 +- 0.292 (in-sample avg dev_std = 0.542)
NEC for r=0.9 all L1 = 0.445 +- 0.178 (in-sample avg dev_std = 0.542)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.76
Model XAI F1 of binarized graphs for r=0.95 =  0.38962125000000003
Model XAI WIoU of binarized graphs for r=0.95 =  0.26077
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.576
NEC for r=0.95 class 0 = 0.519 +- 0.308 (in-sample avg dev_std = 0.555)
NEC for r=0.95 class 1 = 0.373 +- 0.308 (in-sample avg dev_std = 0.555)
NEC for r=0.95 class 2 = 0.408 +- 0.308 (in-sample avg dev_std = 0.555)
NEC for r=0.95 all KL = 0.469 +- 0.308 (in-sample avg dev_std = 0.555)
NEC for r=0.95 all L1 = 0.432 +- 0.178 (in-sample avg dev_std = 0.555)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.772
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.26257375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.609
NEC for r=1.0 class 0 = 0.472 +- 0.289 (in-sample avg dev_std = 0.507)
NEC for r=1.0 class 1 = 0.362 +- 0.289 (in-sample avg dev_std = 0.507)
NEC for r=1.0 class 2 = 0.357 +- 0.289 (in-sample avg dev_std = 0.507)
NEC for r=1.0 all KL = 0.413 +- 0.289 (in-sample avg dev_std = 0.507)
NEC for r=1.0 all L1 = 0.396 +- 0.176 (in-sample avg dev_std = 0.507)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.481
Model XAI F1 of binarized graphs for r=0.3 =  0.71724125
Model XAI WIoU of binarized graphs for r=0.3 =  0.5986525
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.497
SUFF++ for r=0.3 class 0 = 0.47 +- 0.254 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.3 class 1 = 0.61 +- 0.254 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.3 class 2 = 0.55 +- 0.254 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.3 all KL = 0.577 +- 0.254 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.3 all L1 = 0.543 +- 0.162 (in-sample avg dev_std = 0.446)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.641
Model XAI F1 of binarized graphs for r=0.4 =  0.6965062500000001
Model XAI WIoU of binarized graphs for r=0.4 =  0.5880325
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.495
SUFF++ for r=0.4 class 0 = 0.432 +- 0.273 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.4 class 1 = 0.645 +- 0.273 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.4 class 2 = 0.593 +- 0.273 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.4 all KL = 0.577 +- 0.273 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.4 all L1 = 0.557 +- 0.181 (in-sample avg dev_std = 0.444)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.764
Model XAI F1 of binarized graphs for r=0.6 =  0.59186125
Model XAI WIoU of binarized graphs for r=0.6 =  0.4677675
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.659
SUFF++ for r=0.6 class 0 = 0.46 +- 0.244 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 1 = 0.719 +- 0.244 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 class 2 = 0.681 +- 0.244 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 all KL = 0.68 +- 0.244 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.6 all L1 = 0.621 +- 0.188 (in-sample avg dev_std = 0.401)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  0.4707525
Model XAI WIoU of binarized graphs for r=0.9 =  0.34706500000000007
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.871
SUFF++ for r=0.9 class 0 = 0.729 +- 0.169 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 class 1 = 0.837 +- 0.169 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 class 2 = 0.815 +- 0.169 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 all KL = 0.868 +- 0.169 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 all L1 = 0.794 +- 0.161 (in-sample avg dev_std = 0.258)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.932
Model XAI F1 of binarized graphs for r=0.95 =  0.45474999999999993
Model XAI WIoU of binarized graphs for r=0.95 =  0.332845
len(reference) = 732
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.915
SUFF++ for r=0.95 class 0 = 0.856 +- 0.107 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.95 class 1 = 0.887 +- 0.107 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.95 class 2 = 0.878 +- 0.107 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.95 all KL = 0.931 +- 0.107 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.95 all L1 = 0.874 +- 0.114 (in-sample avg dev_std = 0.183)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.459
Model XAI F1 of binarized graphs for r=0.3 =  0.6542587499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.51921125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.518
SUFF++ for r=0.3 class 0 = 0.505 +- 0.277 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 1 = 0.646 +- 0.277 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 2 = 0.638 +- 0.277 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 all KL = 0.6 +- 0.277 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 all L1 = 0.598 +- 0.181 (in-sample avg dev_std = 0.467)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.562
Model XAI F1 of binarized graphs for r=0.4 =  0.6210937499999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.49783125
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.667
SUFF++ for r=0.4 class 0 = 0.481 +- 0.224 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.4 class 1 = 0.563 +- 0.224 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.4 class 2 = 0.714 +- 0.224 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.4 all KL = 0.634 +- 0.224 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.4 all L1 = 0.587 +- 0.197 (in-sample avg dev_std = 0.417)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.585
Model XAI F1 of binarized graphs for r=0.6 =  0.48279250000000007
Model XAI WIoU of binarized graphs for r=0.6 =  0.3483737499999999
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.687
SUFF++ for r=0.6 class 0 = 0.455 +- 0.204 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.6 class 1 = 0.696 +- 0.204 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.6 class 2 = 0.531 +- 0.204 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.6 all KL = 0.675 +- 0.204 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.6 all L1 = 0.563 +- 0.196 (in-sample avg dev_std = 0.315)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.76
Model XAI F1 of binarized graphs for r=0.9 =  0.38961875
Model XAI WIoU of binarized graphs for r=0.9 =  0.26186
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.695
SUFF++ for r=0.9 class 0 = 0.663 +- 0.155 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 1 = 0.82 +- 0.155 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 2 = 0.879 +- 0.155 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all KL = 0.885 +- 0.155 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all L1 = 0.789 +- 0.183 (in-sample avg dev_std = 0.256)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.76
Model XAI F1 of binarized graphs for r=0.95 =  0.38962125000000003
Model XAI WIoU of binarized graphs for r=0.95 =  0.26077
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.72
SUFF++ for r=0.95 class 0 = 0.751 +- 0.144 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.95 class 1 = 0.898 +- 0.144 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.95 class 2 = 0.925 +- 0.144 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.95 all KL = 0.911 +- 0.144 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.95 all L1 = 0.859 +- 0.128 (in-sample avg dev_std = 0.237)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 15:30:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/08/2024 03:30:27 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 03:30:27 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 03:30:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:30:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:30:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:30:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:30:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:30:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3216
ID Validation ACCURACY: 0.9353
ID Validation Loss: 0.3083
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3413
OOD Validation ACCURACY: 0.9157
OOD Validation Loss: 0.4277
OOD Test ACCURACY: 0.7673
OOD Test Loss: 0.8079

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3200
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3075
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3766
OOD Test ACCURACY: 0.7923
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.7673 0.9250 0.7923 0.9337 0.9280[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.695
WIoU for r=0.3 = 0.576
F1 for r=0.4 = 0.672
WIoU for r=0.4 = 0.564
F1 for r=0.6 = 0.570
WIoU for r=0.6 = 0.449
F1 for r=0.9 = 0.450
WIoU for r=0.9 = 0.327
F1 for r=0.95 = 0.444
WIoU for r=0.95 = 0.321
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.320
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.595
WIoU for r=0.3 = 0.477
F1 for r=0.4 = 0.560
WIoU for r=0.4 = 0.451
F1 for r=0.6 = 0.440
WIoU for r=0.6 = 0.317
F1 for r=0.9 = 0.389
WIoU for r=0.9 = 0.261
F1 for r=0.95 = 0.385
WIoU for r=0.95 = 0.257
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.260


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.463
Model XAI F1 of binarized graphs for r=0.3 =  0.6951824999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5758800000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.291
NEC for r=0.3 class 0 = 0.588 +- 0.281 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 1 = 0.581 +- 0.281 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 2 = 0.587 +- 0.281 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all KL = 0.543 +- 0.281 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all L1 = 0.585 +- 0.149 (in-sample avg dev_std = 0.411)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.53
Model XAI F1 of binarized graphs for r=0.4 =  0.6716975
Model XAI WIoU of binarized graphs for r=0.4 =  0.5644162500000001
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.356
NEC for r=0.4 class 0 = 0.551 +- 0.285 (in-sample avg dev_std = 0.403)
NEC for r=0.4 class 1 = 0.549 +- 0.285 (in-sample avg dev_std = 0.403)
NEC for r=0.4 class 2 = 0.631 +- 0.285 (in-sample avg dev_std = 0.403)
NEC for r=0.4 all KL = 0.547 +- 0.285 (in-sample avg dev_std = 0.403)
NEC for r=0.4 all L1 = 0.578 +- 0.151 (in-sample avg dev_std = 0.403)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.688
Model XAI F1 of binarized graphs for r=0.6 =  0.56951625
Model XAI WIoU of binarized graphs for r=0.6 =  0.44933750000000006
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.381
NEC for r=0.6 class 0 = 0.581 +- 0.272 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 1 = 0.509 +- 0.272 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 2 = 0.66 +- 0.272 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all KL = 0.595 +- 0.272 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all L1 = 0.585 +- 0.164 (in-sample avg dev_std = 0.458)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.44999875
Model XAI WIoU of binarized graphs for r=0.9 =  0.3266312500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.509
NEC for r=0.9 class 0 = 0.578 +- 0.215 (in-sample avg dev_std = 0.589)
NEC for r=0.9 class 1 = 0.478 +- 0.215 (in-sample avg dev_std = 0.589)
NEC for r=0.9 class 2 = 0.566 +- 0.215 (in-sample avg dev_std = 0.589)
NEC for r=0.9 all KL = 0.567 +- 0.215 (in-sample avg dev_std = 0.589)
NEC for r=0.9 all L1 = 0.541 +- 0.158 (in-sample avg dev_std = 0.589)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.933
Model XAI F1 of binarized graphs for r=0.95 =  0.44407374999999993
Model XAI WIoU of binarized graphs for r=0.95 =  0.32124250000000004
len(reference) = 800
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.54
NEC for r=0.95 class 0 = 0.553 +- 0.219 (in-sample avg dev_std = 0.598)
NEC for r=0.95 class 1 = 0.448 +- 0.219 (in-sample avg dev_std = 0.598)
NEC for r=0.95 class 2 = 0.545 +- 0.219 (in-sample avg dev_std = 0.598)
NEC for r=0.95 all KL = 0.542 +- 0.219 (in-sample avg dev_std = 0.598)
NEC for r=0.95 all L1 = 0.516 +- 0.160 (in-sample avg dev_std = 0.598)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.32028375000000003
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.534
NEC for r=1.0 class 0 = 0.545 +- 0.219 (in-sample avg dev_std = 0.624)
NEC for r=1.0 class 1 = 0.444 +- 0.219 (in-sample avg dev_std = 0.624)
NEC for r=1.0 class 2 = 0.567 +- 0.219 (in-sample avg dev_std = 0.624)
NEC for r=1.0 all KL = 0.55 +- 0.219 (in-sample avg dev_std = 0.624)
NEC for r=1.0 all L1 = 0.52 +- 0.164 (in-sample avg dev_std = 0.624)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.477
Model XAI F1 of binarized graphs for r=0.3 =  0.59546125
Model XAI WIoU of binarized graphs for r=0.3 =  0.47737999999999997
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.437
NEC for r=0.3 class 0 = 0.525 +- 0.259 (in-sample avg dev_std = 0.470)
NEC for r=0.3 class 1 = 0.641 +- 0.259 (in-sample avg dev_std = 0.470)
NEC for r=0.3 class 2 = 0.641 +- 0.259 (in-sample avg dev_std = 0.470)
NEC for r=0.3 all KL = 0.634 +- 0.259 (in-sample avg dev_std = 0.470)
NEC for r=0.3 all L1 = 0.603 +- 0.147 (in-sample avg dev_std = 0.470)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.704
Model XAI F1 of binarized graphs for r=0.4 =  0.5595874999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.45073125
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.432
NEC for r=0.4 class 0 = 0.588 +- 0.264 (in-sample avg dev_std = 0.467)
NEC for r=0.4 class 1 = 0.524 +- 0.264 (in-sample avg dev_std = 0.467)
NEC for r=0.4 class 2 = 0.672 +- 0.264 (in-sample avg dev_std = 0.467)
NEC for r=0.4 all KL = 0.601 +- 0.264 (in-sample avg dev_std = 0.467)
NEC for r=0.4 all L1 = 0.594 +- 0.145 (in-sample avg dev_std = 0.467)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.717
Model XAI F1 of binarized graphs for r=0.6 =  0.44035624999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.3166975
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.466
NEC for r=0.6 class 0 = 0.597 +- 0.281 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 1 = 0.445 +- 0.281 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 2 = 0.584 +- 0.281 (in-sample avg dev_std = 0.416)
NEC for r=0.6 all KL = 0.501 +- 0.281 (in-sample avg dev_std = 0.416)
NEC for r=0.6 all L1 = 0.541 +- 0.165 (in-sample avg dev_std = 0.416)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.705
Model XAI F1 of binarized graphs for r=0.9 =  0.38863
Model XAI WIoU of binarized graphs for r=0.9 =  0.26089125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.576
NEC for r=0.9 class 0 = 0.558 +- 0.327 (in-sample avg dev_std = 0.507)
NEC for r=0.9 class 1 = 0.361 +- 0.327 (in-sample avg dev_std = 0.507)
NEC for r=0.9 class 2 = 0.493 +- 0.327 (in-sample avg dev_std = 0.507)
NEC for r=0.9 all KL = 0.471 +- 0.327 (in-sample avg dev_std = 0.507)
NEC for r=0.9 all L1 = 0.469 +- 0.192 (in-sample avg dev_std = 0.507)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.744
Model XAI F1 of binarized graphs for r=0.95 =  0.38535250000000004
Model XAI WIoU of binarized graphs for r=0.95 =  0.25721375
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.573
NEC for r=0.95 class 0 = 0.523 +- 0.297 (in-sample avg dev_std = 0.494)
NEC for r=0.95 class 1 = 0.371 +- 0.297 (in-sample avg dev_std = 0.494)
NEC for r=0.95 class 2 = 0.452 +- 0.297 (in-sample avg dev_std = 0.494)
NEC for r=0.95 all KL = 0.431 +- 0.297 (in-sample avg dev_std = 0.494)
NEC for r=0.95 all L1 = 0.447 +- 0.164 (in-sample avg dev_std = 0.494)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.771
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.26045625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.604
NEC for r=1.0 class 0 = 0.478 +- 0.250 (in-sample avg dev_std = 0.473)
NEC for r=1.0 class 1 = 0.372 +- 0.250 (in-sample avg dev_std = 0.473)
NEC for r=1.0 class 2 = 0.432 +- 0.250 (in-sample avg dev_std = 0.473)
NEC for r=1.0 all KL = 0.383 +- 0.250 (in-sample avg dev_std = 0.473)
NEC for r=1.0 all L1 = 0.427 +- 0.146 (in-sample avg dev_std = 0.473)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.461
Model XAI F1 of binarized graphs for r=0.3 =  0.6951824999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5758800000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.461
SUFF++ for r=0.3 class 0 = 0.474 +- 0.261 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 1 = 0.49 +- 0.261 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 2 = 0.555 +- 0.261 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 all KL = 0.566 +- 0.261 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 all L1 = 0.507 +- 0.163 (in-sample avg dev_std = 0.439)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.6716975
Model XAI WIoU of binarized graphs for r=0.4 =  0.5644162500000001
len(reference) = 800
Effective ratio: 0.414 +- 0.011
Model Accuracy over intervened graphs for r=0.4 =  0.492
SUFF++ for r=0.4 class 0 = 0.502 +- 0.265 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.4 class 1 = 0.56 +- 0.265 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.4 class 2 = 0.592 +- 0.265 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.4 all KL = 0.603 +- 0.265 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.4 all L1 = 0.552 +- 0.159 (in-sample avg dev_std = 0.458)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  0.56951625
Model XAI WIoU of binarized graphs for r=0.6 =  0.44933750000000006
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.64
SUFF++ for r=0.6 class 0 = 0.499 +- 0.240 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 class 1 = 0.724 +- 0.240 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 class 2 = 0.656 +- 0.240 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 all KL = 0.67 +- 0.240 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.6 all L1 = 0.626 +- 0.180 (in-sample avg dev_std = 0.414)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.44999875
Model XAI WIoU of binarized graphs for r=0.9 =  0.3266312500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.86
SUFF++ for r=0.9 class 0 = 0.638 +- 0.183 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 class 1 = 0.827 +- 0.183 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 class 2 = 0.837 +- 0.183 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 all KL = 0.837 +- 0.183 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 all L1 = 0.768 +- 0.154 (in-sample avg dev_std = 0.314)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.934
Model XAI F1 of binarized graphs for r=0.95 =  0.44407374999999993
Model XAI WIoU of binarized graphs for r=0.95 =  0.32124250000000004
len(reference) = 732
Effective ratio: 0.963 +- 0.012
Model Accuracy over intervened graphs for r=0.95 =  0.879
SUFF++ for r=0.95 class 0 = 0.729 +- 0.163 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.95 class 1 = 0.88 +- 0.163 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.95 class 2 = 0.878 +- 0.163 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.95 all KL = 0.878 +- 0.163 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.95 all L1 = 0.83 +- 0.136 (in-sample avg dev_std = 0.322)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.476
Model XAI F1 of binarized graphs for r=0.3 =  0.59546125
Model XAI WIoU of binarized graphs for r=0.3 =  0.47737999999999997
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.535
SUFF++ for r=0.3 class 0 = 0.56 +- 0.277 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.3 class 1 = 0.582 +- 0.277 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.3 class 2 = 0.609 +- 0.277 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.3 all KL = 0.615 +- 0.277 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.3 all L1 = 0.584 +- 0.171 (in-sample avg dev_std = 0.447)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.702
Model XAI F1 of binarized graphs for r=0.4 =  0.5595874999999999
Model XAI WIoU of binarized graphs for r=0.4 =  0.45073125
len(reference) = 800
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.681
SUFF++ for r=0.4 class 0 = 0.473 +- 0.279 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.4 class 1 = 0.546 +- 0.279 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.4 class 2 = 0.703 +- 0.279 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.4 all KL = 0.586 +- 0.279 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.4 all L1 = 0.575 +- 0.201 (in-sample avg dev_std = 0.415)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.717
Model XAI F1 of binarized graphs for r=0.6 =  0.44035624999999995
Model XAI WIoU of binarized graphs for r=0.6 =  0.3166975
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.681
SUFF++ for r=0.6 class 0 = 0.429 +- 0.257 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 class 1 = 0.662 +- 0.257 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 class 2 = 0.638 +- 0.257 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 all KL = 0.681 +- 0.257 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 all L1 = 0.579 +- 0.186 (in-sample avg dev_std = 0.327)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.705
Model XAI F1 of binarized graphs for r=0.9 =  0.38863
Model XAI WIoU of binarized graphs for r=0.9 =  0.26089125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.665
SUFF++ for r=0.9 class 0 = 0.582 +- 0.175 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 1 = 0.818 +- 0.175 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 2 = 0.831 +- 0.175 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 all KL = 0.819 +- 0.175 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 all L1 = 0.746 +- 0.157 (in-sample avg dev_std = 0.279)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.744
Model XAI F1 of binarized graphs for r=0.95 =  0.38535250000000004
Model XAI WIoU of binarized graphs for r=0.95 =  0.25721375
len(reference) = 800
Effective ratio: 0.962 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.7
SUFF++ for r=0.95 class 0 = 0.627 +- 0.135 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.95 class 1 = 0.884 +- 0.135 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.95 class 2 = 0.852 +- 0.135 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.95 all KL = 0.853 +- 0.135 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.95 all L1 = 0.79 +- 0.152 (in-sample avg dev_std = 0.276)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.537, 0.558, 0.619, 0.562, 0.526, 0.552], 'all_L1': [0.549, 0.564, 0.567, 0.536, 0.512, 0.515]}), defaultdict(<class 'list'>, {'all_KL': [0.623, 0.619, 0.619, 0.572, 0.54, 0.543], 'all_L1': [0.62, 0.601, 0.581, 0.541, 0.519, 0.508]}), defaultdict(<class 'list'>, {'all_KL': [0.631, 0.572, 0.583, 0.614, 0.566, 0.569], 'all_L1': [0.613, 0.567, 0.557, 0.551, 0.521, 0.512]}), defaultdict(<class 'list'>, {'all_KL': [0.55, 0.572, 0.564, 0.55, 0.555, 0.551], 'all_L1': [0.556, 0.571, 0.573, 0.539, 0.518, 0.509]}), defaultdict(<class 'list'>, {'all_KL': [0.543, 0.547, 0.595, 0.567, 0.542, 0.55], 'all_L1': [0.585, 0.578, 0.585, 0.541, 0.516, 0.52]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.563, 0.593, 0.635, 0.819, 0.887, 1.0], 'all_L1': [0.535, 0.561, 0.619, 0.751, 0.824, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.509, 0.529, 0.587, 0.84, 0.917, 1.0], 'all_L1': [0.493, 0.534, 0.592, 0.779, 0.854, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.455, 0.55, 0.607, 0.833, 0.904, 1.0], 'all_L1': [0.466, 0.532, 0.593, 0.773, 0.845, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.577, 0.577, 0.68, 0.868, 0.931, 1.0], 'all_L1': [0.543, 0.557, 0.621, 0.794, 0.874, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.566, 0.603, 0.67, 0.837, 0.878, 1.0], 'all_L1': [0.507, 0.552, 0.626, 0.768, 0.83, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]

Eval split test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.518, 0.586, 0.562, 0.398, 0.398, 0.369], 'all_L1': [0.534, 0.549, 0.546, 0.438, 0.429, 0.397]}), defaultdict(<class 'list'>, {'all_KL': [0.656, 0.672, 0.632, 0.544, 0.49, 0.378], 'all_L1': [0.602, 0.612, 0.583, 0.471, 0.44, 0.396]}), defaultdict(<class 'list'>, {'all_KL': [0.638, 0.615, 0.481, 0.506, 0.506, 0.438], 'all_L1': [0.608, 0.579, 0.519, 0.479, 0.448, 0.42]}), defaultdict(<class 'list'>, {'all_KL': [0.6, 0.613, 0.487, 0.446, 0.469, 0.413], 'all_L1': [0.554, 0.612, 0.538, 0.445, 0.432, 0.396]}), defaultdict(<class 'list'>, {'all_KL': [0.634, 0.601, 0.501, 0.471, 0.431, 0.383], 'all_L1': [0.603, 0.594, 0.541, 0.469, 0.447, 0.427]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.655, 0.588, 0.731, 0.865, 0.916, 1.0], 'all_L1': [0.604, 0.598, 0.654, 0.754, 0.845, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.552, 0.539, 0.658, 0.805, 0.879, 1.0], 'all_L1': [0.568, 0.57, 0.633, 0.748, 0.821, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.582, 0.592, 0.717, 0.841, 0.889, 1.0], 'all_L1': [0.568, 0.602, 0.632, 0.761, 0.843, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.6, 0.634, 0.675, 0.885, 0.911, 1.0], 'all_L1': [0.598, 0.587, 0.563, 0.789, 0.859, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.615, 0.586, 0.681, 0.819, 0.853, 1.0], 'all_L1': [0.584, 0.575, 0.579, 0.746, 0.79, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.585 +- 0.029, 0.576 +- 0.013, 0.573 +- 0.010, 0.542 +- 0.005, 0.517 +- 0.003, 0.513 +- 0.004
nec class all_KL  =  0.577 +- 0.041, 0.574 +- 0.025, 0.596 +- 0.021, 0.573 +- 0.022, 0.546 +- 0.014, 0.553 +- 0.009
nec_acc_int  =  0.313 +- 0.015, 0.359 +- 0.016, 0.391 +- 0.022, 0.517 +- 0.006, 0.542 +- 0.007, 0.547 +- 0.008
suff++ class all_L1  =  0.509 +- 0.028, 0.547 +- 0.012, 0.610 +- 0.015, 0.773 +- 0.014, 0.845 +- 0.018, 1.000 +- 0.000
suff++ class all_KL  =  0.534 +- 0.046, 0.570 +- 0.027, 0.636 +- 0.036, 0.839 +- 0.016, 0.903 +- 0.019, 1.000 +- 0.000
suff++_acc_int  =  0.461 +- 0.019, 0.488 +- 0.010, 0.631 +- 0.027, 0.838 +- 0.025, 0.886 +- 0.016

Eval split test
nec class all_L1  =  0.580 +- 0.030, 0.589 +- 0.024, 0.545 +- 0.021, 0.460 +- 0.016, 0.439 +- 0.008, 0.407 +- 0.013
nec class all_KL  =  0.609 +- 0.049, 0.617 +- 0.029, 0.533 +- 0.057, 0.473 +- 0.050, 0.459 +- 0.039, 0.396 +- 0.026
nec_acc_int  =  0.412 +- 0.030, 0.411 +- 0.015, 0.452 +- 0.008, 0.583 +- 0.007, 0.587 +- 0.012, 0.602 +- 0.014
suff++ class all_L1  =  0.584 +- 0.015, 0.586 +- 0.012, 0.612 +- 0.035, 0.760 +- 0.016, 0.832 +- 0.024, 1.000 +- 0.000
suff++ class all_KL  =  0.601 +- 0.034, 0.588 +- 0.030, 0.692 +- 0.027, 0.843 +- 0.029, 0.890 +- 0.023, 1.000 +- 0.000
suff++_acc_int  =  0.512 +- 0.023, 0.643 +- 0.028, 0.673 +- 0.021, 0.701 +- 0.027, 0.728 +- 0.032


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.547 +- 0.006, 0.562 +- 0.006, 0.591 +- 0.010, 0.657 +- 0.008, 0.681 +- 0.010, 0.756 +- 0.002
Faith. Armon (L1)= 		  =  0.543 +- 0.007, 0.561 +- 0.006, 0.591 +- 0.010, 0.637 +- 0.006, 0.642 +- 0.007, 0.678 +- 0.004
Faith. GMean (L1)= 	  =  0.545 +- 0.006, 0.561 +- 0.006, 0.591 +- 0.010, 0.647 +- 0.007, 0.661 +- 0.008, 0.716 +- 0.003
Faith. Aritm (KL)= 		  =  0.555 +- 0.009, 0.572 +- 0.006, 0.616 +- 0.014, 0.706 +- 0.011, 0.725 +- 0.014, 0.777 +- 0.004
Faith. Armon (KL)= 		  =  0.551 +- 0.012, 0.571 +- 0.005, 0.614 +- 0.014, 0.681 +- 0.014, 0.680 +- 0.014, 0.712 +- 0.007
Faith. GMean (KL)= 	  =  0.553 +- 0.010, 0.571 +- 0.005, 0.615 +- 0.014, 0.693 +- 0.012, 0.702 +- 0.014, 0.744 +- 0.006

Eval split test
Faith. Aritm (L1)= 		  =  0.582 +- 0.009, 0.588 +- 0.009, 0.579 +- 0.022, 0.610 +- 0.008, 0.635 +- 0.010, 0.704 +- 0.007
Faith. Armon (L1)= 		  =  0.581 +- 0.009, 0.587 +- 0.009, 0.576 +- 0.021, 0.573 +- 0.011, 0.575 +- 0.006, 0.579 +- 0.014
Faith. GMean (L1)= 	  =  0.582 +- 0.009, 0.588 +- 0.009, 0.578 +- 0.022, 0.591 +- 0.009, 0.604 +- 0.007, 0.638 +- 0.011
Faith. Aritm (KL)= 		  =  0.605 +- 0.012, 0.603 +- 0.012, 0.613 +- 0.028, 0.658 +- 0.017, 0.674 +- 0.021, 0.698 +- 0.013
Faith. Armon (KL)= 		  =  0.602 +- 0.015, 0.601 +- 0.012, 0.600 +- 0.033, 0.603 +- 0.036, 0.604 +- 0.034, 0.567 +- 0.026
Faith. GMean (KL)= 	  =  0.604 +- 0.014, 0.602 +- 0.012, 0.606 +- 0.030, 0.630 +- 0.026, 0.638 +- 0.028, 0.629 +- 0.020
Computed for split load_split = id



Completed in  0:19:37.140963  for GSATGIN GOODMotif2/basis



DONE GSAT GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 15:34:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:17 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:19 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:20 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:21 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:22 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:34:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 35...
[0m[1;37mINFO[0m: [1mCheckpoint 35: 
-----------------------------------
Train ACCURACY: 0.9819
Train Loss: 0.0593
ID Validation ACCURACY: 0.6877
ID Validation Loss: 1.6620
ID Test ACCURACY: 0.6462
ID Test Loss: 1.7034
OOD Validation ACCURACY: 0.5798
OOD Validation Loss: 2.5076
OOD Test ACCURACY: 0.5333
OOD Test Loss: 3.8144

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 7...
[0m[1;37mINFO[0m: [1mCheckpoint 7: 
-----------------------------------
Train ACCURACY: 0.7409
Train Loss: 0.6367
ID Validation ACCURACY: 0.6643
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.6841
ID Test Loss: 0.7824
OOD Validation ACCURACY: 0.6213
OOD Validation Loss: 0.9502
OOD Test ACCURACY: 0.5765
OOD Test Loss: 1.1552

[0m[1;37mINFO[0m: [1mChartInfo 0.6462 0.5333 0.6841 0.5765 0.6643 0.6213[0mGOODTwitter(554)
Data example from id_test: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from id_test: (tensor([0, 1, 2]), tensor([138, 251, 165]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.608
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.598
NEC for r=0.3 class 0 = 0.355 +- 0.255 (in-sample avg dev_std = 0.325)
NEC for r=0.3 class 1 = 0.256 +- 0.255 (in-sample avg dev_std = 0.325)
NEC for r=0.3 class 2 = 0.228 +- 0.255 (in-sample avg dev_std = 0.325)
NEC for r=0.3 all KL = 0.245 +- 0.255 (in-sample avg dev_std = 0.325)
NEC for r=0.3 all L1 = 0.272 +- 0.228 (in-sample avg dev_std = 0.325)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.621
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.614
NEC for r=0.4 class 0 = 0.314 +- 0.244 (in-sample avg dev_std = 0.313)
NEC for r=0.4 class 1 = 0.235 +- 0.244 (in-sample avg dev_std = 0.313)
NEC for r=0.4 class 2 = 0.209 +- 0.244 (in-sample avg dev_std = 0.313)
NEC for r=0.4 all KL = 0.218 +- 0.244 (in-sample avg dev_std = 0.313)
NEC for r=0.4 all L1 = 0.247 +- 0.225 (in-sample avg dev_std = 0.313)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.633
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.627
NEC for r=0.6 class 0 = 0.262 +- 0.220 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 1 = 0.184 +- 0.220 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 2 = 0.17 +- 0.220 (in-sample avg dev_std = 0.295)
NEC for r=0.6 all KL = 0.17 +- 0.220 (in-sample avg dev_std = 0.295)
NEC for r=0.6 all L1 = 0.199 +- 0.201 (in-sample avg dev_std = 0.295)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 551
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.635
NEC for r=0.9 class 0 = 0.174 +- 0.157 (in-sample avg dev_std = 0.204)
NEC for r=0.9 class 1 = 0.12 +- 0.157 (in-sample avg dev_std = 0.204)
NEC for r=0.9 class 2 = 0.111 +- 0.157 (in-sample avg dev_std = 0.204)
NEC for r=0.9 all KL = 0.086 +- 0.157 (in-sample avg dev_std = 0.204)
NEC for r=0.9 all L1 = 0.131 +- 0.165 (in-sample avg dev_std = 0.204)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.639
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 551
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.641
NEC for r=0.95 class 0 = 0.146 +- 0.122 (in-sample avg dev_std = 0.171)
NEC for r=0.95 class 1 = 0.111 +- 0.122 (in-sample avg dev_std = 0.171)
NEC for r=0.95 class 2 = 0.098 +- 0.122 (in-sample avg dev_std = 0.171)
NEC for r=0.95 all KL = 0.064 +- 0.122 (in-sample avg dev_std = 0.171)
NEC for r=0.95 all L1 = 0.116 +- 0.146 (in-sample avg dev_std = 0.171)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.644
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 551
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.641
NEC for r=1.0 class 0 = 0.136 +- 0.112 (in-sample avg dev_std = 0.162)
NEC for r=1.0 class 1 = 0.104 +- 0.112 (in-sample avg dev_std = 0.162)
NEC for r=1.0 class 2 = 0.094 +- 0.112 (in-sample avg dev_std = 0.162)
NEC for r=1.0 all KL = 0.06 +- 0.112 (in-sample avg dev_std = 0.162)
NEC for r=1.0 all L1 = 0.109 +- 0.141 (in-sample avg dev_std = 0.162)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.506
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.528
NEC for r=0.3 class 0 = 0.318 +- 0.252 (in-sample avg dev_std = 0.330)
NEC for r=0.3 class 1 = 0.312 +- 0.252 (in-sample avg dev_std = 0.330)
NEC for r=0.3 class 2 = 0.269 +- 0.252 (in-sample avg dev_std = 0.330)
NEC for r=0.3 all KL = 0.27 +- 0.252 (in-sample avg dev_std = 0.330)
NEC for r=0.3 all L1 = 0.303 +- 0.218 (in-sample avg dev_std = 0.330)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.527
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.524
NEC for r=0.4 class 0 = 0.283 +- 0.246 (in-sample avg dev_std = 0.316)
NEC for r=0.4 class 1 = 0.283 +- 0.246 (in-sample avg dev_std = 0.316)
NEC for r=0.4 class 2 = 0.238 +- 0.246 (in-sample avg dev_std = 0.316)
NEC for r=0.4 all KL = 0.241 +- 0.246 (in-sample avg dev_std = 0.316)
NEC for r=0.4 all L1 = 0.272 +- 0.215 (in-sample avg dev_std = 0.316)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.515
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.518
NEC for r=0.6 class 0 = 0.215 +- 0.198 (in-sample avg dev_std = 0.256)
NEC for r=0.6 class 1 = 0.227 +- 0.198 (in-sample avg dev_std = 0.256)
NEC for r=0.6 class 2 = 0.183 +- 0.198 (in-sample avg dev_std = 0.256)
NEC for r=0.6 all KL = 0.163 +- 0.198 (in-sample avg dev_std = 0.256)
NEC for r=0.6 all L1 = 0.213 +- 0.199 (in-sample avg dev_std = 0.256)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.531
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.53
NEC for r=0.9 class 0 = 0.13 +- 0.127 (in-sample avg dev_std = 0.171)
NEC for r=0.9 class 1 = 0.15 +- 0.127 (in-sample avg dev_std = 0.171)
NEC for r=0.9 class 2 = 0.109 +- 0.127 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all KL = 0.077 +- 0.127 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all L1 = 0.135 +- 0.157 (in-sample avg dev_std = 0.171)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.53
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.533
NEC for r=0.95 class 0 = 0.123 +- 0.124 (in-sample avg dev_std = 0.173)
NEC for r=0.95 class 1 = 0.139 +- 0.124 (in-sample avg dev_std = 0.173)
NEC for r=0.95 class 2 = 0.108 +- 0.124 (in-sample avg dev_std = 0.173)
NEC for r=0.95 all KL = 0.073 +- 0.124 (in-sample avg dev_std = 0.173)
NEC for r=0.95 all L1 = 0.127 +- 0.155 (in-sample avg dev_std = 0.173)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.533
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.535
NEC for r=1.0 class 0 = 0.124 +- 0.130 (in-sample avg dev_std = 0.183)
NEC for r=1.0 class 1 = 0.137 +- 0.130 (in-sample avg dev_std = 0.183)
NEC for r=1.0 class 2 = 0.113 +- 0.130 (in-sample avg dev_std = 0.183)
NEC for r=1.0 all KL = 0.076 +- 0.130 (in-sample avg dev_std = 0.183)
NEC for r=1.0 all L1 = 0.128 +- 0.158 (in-sample avg dev_std = 0.183)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.608
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.55
SUFF++ for r=0.3 class 0 = 0.578 +- 0.254 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.3 class 1 = 0.655 +- 0.254 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.3 class 2 = 0.679 +- 0.254 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.3 all KL = 0.58 +- 0.254 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.3 all L1 = 0.643 +- 0.203 (in-sample avg dev_std = 0.534)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.621
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.569
SUFF++ for r=0.4 class 0 = 0.623 +- 0.254 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.4 class 1 = 0.695 +- 0.254 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.4 class 2 = 0.727 +- 0.254 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.4 all KL = 0.631 +- 0.254 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.4 all L1 = 0.686 +- 0.201 (in-sample avg dev_std = 0.496)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.633
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.604
SUFF++ for r=0.6 class 0 = 0.725 +- 0.222 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 class 1 = 0.769 +- 0.222 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 class 2 = 0.815 +- 0.222 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 all KL = 0.765 +- 0.222 (in-sample avg dev_std = 0.375)
SUFF++ for r=0.6 all L1 = 0.772 +- 0.191 (in-sample avg dev_std = 0.375)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.636
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.626
SUFF++ for r=0.9 class 0 = 0.857 +- 0.126 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.9 class 1 = 0.888 +- 0.126 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.9 class 2 = 0.904 +- 0.126 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.9 all KL = 0.928 +- 0.126 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.9 all L1 = 0.885 +- 0.146 (in-sample avg dev_std = 0.212)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.636
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 445
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.63
SUFF++ for r=0.95 class 0 = 0.933 +- 0.045 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.95 class 1 = 0.935 +- 0.045 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.95 class 2 = 0.945 +- 0.045 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.95 all KL = 0.974 +- 0.045 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.95 all L1 = 0.937 +- 0.085 (in-sample avg dev_std = 0.136)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.506
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.487
SUFF++ for r=0.3 class 0 = 0.599 +- 0.229 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.3 class 1 = 0.586 +- 0.229 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.3 class 2 = 0.643 +- 0.229 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.3 all KL = 0.559 +- 0.229 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.3 all L1 = 0.603 +- 0.182 (in-sample avg dev_std = 0.503)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.527
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.487
SUFF++ for r=0.4 class 0 = 0.653 +- 0.233 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.4 class 1 = 0.621 +- 0.233 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.4 class 2 = 0.681 +- 0.233 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.4 all KL = 0.606 +- 0.233 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.4 all L1 = 0.644 +- 0.190 (in-sample avg dev_std = 0.477)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.515
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.5
SUFF++ for r=0.6 class 0 = 0.734 +- 0.211 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 1 = 0.703 +- 0.211 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 2 = 0.764 +- 0.211 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 all KL = 0.739 +- 0.211 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 all L1 = 0.726 +- 0.196 (in-sample avg dev_std = 0.379)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.531
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.521
SUFF++ for r=0.9 class 0 = 0.89 +- 0.096 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.9 class 1 = 0.867 +- 0.096 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.9 class 2 = 0.89 +- 0.096 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.9 all KL = 0.938 +- 0.096 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.9 all L1 = 0.879 +- 0.135 (in-sample avg dev_std = 0.175)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.53
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.524
SUFF++ for r=0.95 class 0 = 0.93 +- 0.055 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.95 class 1 = 0.919 +- 0.055 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.95 class 2 = 0.928 +- 0.055 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.95 all KL = 0.974 +- 0.055 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.95 all L1 = 0.924 +- 0.098 (in-sample avg dev_std = 0.118)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 15:39:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:04 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:05 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:05 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:06 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:07 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:39:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 32...
[0m[1;37mINFO[0m: [1mCheckpoint 32: 
-----------------------------------
Train ACCURACY: 0.9873
Train Loss: 0.0557
ID Validation ACCURACY: 0.7040
ID Validation Loss: 1.2333
ID Test ACCURACY: 0.6751
ID Test Loss: 1.2914
OOD Validation ACCURACY: 0.6235
OOD Validation Loss: 1.5984
OOD Test ACCURACY: 0.5710
OOD Test Loss: 2.1738

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 10...
[0m[1;37mINFO[0m: [1mCheckpoint 10: 
-----------------------------------
Train ACCURACY: 0.8039
Train Loss: 0.4968
ID Validation ACCURACY: 0.6949
ID Validation Loss: 0.7512
ID Test ACCURACY: 0.6931
ID Test Loss: 0.7845
OOD Validation ACCURACY: 0.6476
OOD Validation Loss: 0.9328
OOD Test ACCURACY: 0.5779
OOD Test Loss: 1.2430

[0m[1;37mINFO[0m: [1mChartInfo 0.6751 0.5710 0.6931 0.5779 0.6949 0.6476[0mGOODTwitter(554)
Data example from id_test: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from id_test: (tensor([0, 1, 2]), tensor([138, 251, 165]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.617
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.618
NEC for r=0.3 class 0 = 0.274 +- 0.216 (in-sample avg dev_std = 0.264)
NEC for r=0.3 class 1 = 0.257 +- 0.216 (in-sample avg dev_std = 0.264)
NEC for r=0.3 class 2 = 0.227 +- 0.216 (in-sample avg dev_std = 0.264)
NEC for r=0.3 all KL = 0.176 +- 0.216 (in-sample avg dev_std = 0.264)
NEC for r=0.3 all L1 = 0.252 +- 0.206 (in-sample avg dev_std = 0.264)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.635
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.64
NEC for r=0.4 class 0 = 0.265 +- 0.206 (in-sample avg dev_std = 0.271)
NEC for r=0.4 class 1 = 0.24 +- 0.206 (in-sample avg dev_std = 0.271)
NEC for r=0.4 class 2 = 0.195 +- 0.206 (in-sample avg dev_std = 0.271)
NEC for r=0.4 all KL = 0.167 +- 0.206 (in-sample avg dev_std = 0.271)
NEC for r=0.4 all L1 = 0.233 +- 0.202 (in-sample avg dev_std = 0.271)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.673
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.647
NEC for r=0.6 class 0 = 0.218 +- 0.193 (in-sample avg dev_std = 0.247)
NEC for r=0.6 class 1 = 0.184 +- 0.193 (in-sample avg dev_std = 0.247)
NEC for r=0.6 class 2 = 0.174 +- 0.193 (in-sample avg dev_std = 0.247)
NEC for r=0.6 all KL = 0.133 +- 0.193 (in-sample avg dev_std = 0.247)
NEC for r=0.6 all L1 = 0.19 +- 0.190 (in-sample avg dev_std = 0.247)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.67
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 551
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.667
NEC for r=0.9 class 0 = 0.148 +- 0.121 (in-sample avg dev_std = 0.176)
NEC for r=0.9 class 1 = 0.116 +- 0.121 (in-sample avg dev_std = 0.176)
NEC for r=0.9 class 2 = 0.122 +- 0.121 (in-sample avg dev_std = 0.176)
NEC for r=0.9 all KL = 0.068 +- 0.121 (in-sample avg dev_std = 0.176)
NEC for r=0.9 all L1 = 0.126 +- 0.150 (in-sample avg dev_std = 0.176)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.673
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 551
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.672
NEC for r=0.95 class 0 = 0.128 +- 0.112 (in-sample avg dev_std = 0.162)
NEC for r=0.95 class 1 = 0.101 +- 0.112 (in-sample avg dev_std = 0.162)
NEC for r=0.95 class 2 = 0.114 +- 0.112 (in-sample avg dev_std = 0.162)
NEC for r=0.95 all KL = 0.058 +- 0.112 (in-sample avg dev_std = 0.162)
NEC for r=0.95 all L1 = 0.112 +- 0.142 (in-sample avg dev_std = 0.162)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.673
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 551
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.668
NEC for r=1.0 class 0 = 0.12 +- 0.108 (in-sample avg dev_std = 0.166)
NEC for r=1.0 class 1 = 0.099 +- 0.108 (in-sample avg dev_std = 0.166)
NEC for r=1.0 class 2 = 0.116 +- 0.108 (in-sample avg dev_std = 0.166)
NEC for r=1.0 all KL = 0.056 +- 0.108 (in-sample avg dev_std = 0.166)
NEC for r=1.0 all L1 = 0.109 +- 0.139 (in-sample avg dev_std = 0.166)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.55
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.546
NEC for r=0.3 class 0 = 0.276 +- 0.178 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 1 = 0.252 +- 0.178 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 2 = 0.314 +- 0.178 (in-sample avg dev_std = 0.248)
NEC for r=0.3 all KL = 0.17 +- 0.178 (in-sample avg dev_std = 0.248)
NEC for r=0.3 all L1 = 0.273 +- 0.179 (in-sample avg dev_std = 0.248)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.551
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.544
NEC for r=0.4 class 0 = 0.232 +- 0.166 (in-sample avg dev_std = 0.228)
NEC for r=0.4 class 1 = 0.218 +- 0.166 (in-sample avg dev_std = 0.228)
NEC for r=0.4 class 2 = 0.264 +- 0.166 (in-sample avg dev_std = 0.228)
NEC for r=0.4 all KL = 0.139 +- 0.166 (in-sample avg dev_std = 0.228)
NEC for r=0.4 all L1 = 0.233 +- 0.173 (in-sample avg dev_std = 0.228)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.545
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.548
NEC for r=0.6 class 0 = 0.179 +- 0.145 (in-sample avg dev_std = 0.189)
NEC for r=0.6 class 1 = 0.177 +- 0.145 (in-sample avg dev_std = 0.189)
NEC for r=0.6 class 2 = 0.207 +- 0.145 (in-sample avg dev_std = 0.189)
NEC for r=0.6 all KL = 0.101 +- 0.145 (in-sample avg dev_std = 0.189)
NEC for r=0.6 all L1 = 0.185 +- 0.171 (in-sample avg dev_std = 0.189)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.556
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.557
NEC for r=0.9 class 0 = 0.118 +- 0.115 (in-sample avg dev_std = 0.148)
NEC for r=0.9 class 1 = 0.119 +- 0.115 (in-sample avg dev_std = 0.148)
NEC for r=0.9 class 2 = 0.144 +- 0.115 (in-sample avg dev_std = 0.148)
NEC for r=0.9 all KL = 0.062 +- 0.115 (in-sample avg dev_std = 0.148)
NEC for r=0.9 all L1 = 0.125 +- 0.150 (in-sample avg dev_std = 0.148)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.56
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.559
NEC for r=0.95 class 0 = 0.122 +- 0.125 (in-sample avg dev_std = 0.164)
NEC for r=0.95 class 1 = 0.116 +- 0.125 (in-sample avg dev_std = 0.164)
NEC for r=0.95 class 2 = 0.149 +- 0.125 (in-sample avg dev_std = 0.164)
NEC for r=0.95 all KL = 0.067 +- 0.125 (in-sample avg dev_std = 0.164)
NEC for r=0.95 all L1 = 0.126 +- 0.153 (in-sample avg dev_std = 0.164)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.554
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.555
NEC for r=1.0 class 0 = 0.118 +- 0.129 (in-sample avg dev_std = 0.170)
NEC for r=1.0 class 1 = 0.117 +- 0.129 (in-sample avg dev_std = 0.170)
NEC for r=1.0 class 2 = 0.151 +- 0.129 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all KL = 0.07 +- 0.129 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all L1 = 0.126 +- 0.158 (in-sample avg dev_std = 0.170)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.617
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.575
SUFF++ for r=0.3 class 0 = 0.595 +- 0.222 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.3 class 1 = 0.644 +- 0.222 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.3 class 2 = 0.704 +- 0.222 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.3 all KL = 0.659 +- 0.222 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.3 all L1 = 0.649 +- 0.177 (in-sample avg dev_std = 0.463)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.635
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.601
SUFF++ for r=0.4 class 0 = 0.634 +- 0.217 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.4 class 1 = 0.684 +- 0.217 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.4 class 2 = 0.713 +- 0.217 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.4 all KL = 0.682 +- 0.217 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.4 all L1 = 0.68 +- 0.183 (in-sample avg dev_std = 0.446)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.673
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.63
SUFF++ for r=0.6 class 0 = 0.697 +- 0.211 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 1 = 0.76 +- 0.211 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 2 = 0.78 +- 0.211 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 all KL = 0.771 +- 0.211 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 all L1 = 0.75 +- 0.187 (in-sample avg dev_std = 0.367)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.669
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.66
SUFF++ for r=0.9 class 0 = 0.872 +- 0.113 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.9 class 1 = 0.888 +- 0.113 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.9 class 2 = 0.876 +- 0.113 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.9 all KL = 0.932 +- 0.113 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.9 all L1 = 0.88 +- 0.144 (in-sample avg dev_std = 0.202)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.665
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 445
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.66
SUFF++ for r=0.95 class 0 = 0.938 +- 0.038 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.95 class 1 = 0.939 +- 0.038 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.95 class 2 = 0.933 +- 0.038 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.95 all KL = 0.976 +- 0.038 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.95 all L1 = 0.937 +- 0.078 (in-sample avg dev_std = 0.137)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.55
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.526
SUFF++ for r=0.3 class 0 = 0.69 +- 0.165 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.3 class 1 = 0.726 +- 0.165 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.3 class 2 = 0.689 +- 0.165 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.3 all KL = 0.791 +- 0.165 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.3 all L1 = 0.707 +- 0.148 (in-sample avg dev_std = 0.345)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.551
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.533
SUFF++ for r=0.4 class 0 = 0.725 +- 0.155 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.4 class 1 = 0.733 +- 0.155 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.4 class 2 = 0.688 +- 0.155 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.4 all KL = 0.796 +- 0.155 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.4 all L1 = 0.72 +- 0.151 (in-sample avg dev_std = 0.341)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.545
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.528
SUFF++ for r=0.6 class 0 = 0.788 +- 0.139 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 class 1 = 0.769 +- 0.139 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 class 2 = 0.737 +- 0.139 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 all KL = 0.837 +- 0.139 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.6 all L1 = 0.766 +- 0.155 (in-sample avg dev_std = 0.311)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.556
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.549
SUFF++ for r=0.9 class 0 = 0.918 +- 0.051 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.9 class 1 = 0.904 +- 0.051 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.9 class 2 = 0.89 +- 0.051 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.9 all KL = 0.965 +- 0.051 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.9 all L1 = 0.904 +- 0.102 (in-sample avg dev_std = 0.148)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.56
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.553
SUFF++ for r=0.95 class 0 = 0.941 +- 0.023 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.95 class 1 = 0.938 +- 0.023 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.95 class 2 = 0.932 +- 0.023 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.95 all KL = 0.985 +- 0.023 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.95 all L1 = 0.937 +- 0.075 (in-sample avg dev_std = 0.096)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 15:43:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:50 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:52 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:52 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:54 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:43:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.9622
Train Loss: 0.1169
ID Validation ACCURACY: 0.7058
ID Validation Loss: 1.0059
ID Test ACCURACY: 0.6588
ID Test Loss: 1.1823
OOD Validation ACCURACY: 0.6319
OOD Validation Loss: 1.4492
OOD Test ACCURACY: 0.5635
OOD Test Loss: 2.1363

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8077
Train Loss: 0.4721
ID Validation ACCURACY: 0.7004
ID Validation Loss: 0.7735
ID Test ACCURACY: 0.6895
ID Test Loss: 0.8005
OOD Validation ACCURACY: 0.6420
OOD Validation Loss: 0.9580
OOD Test ACCURACY: 0.5964
OOD Test Loss: 1.2456

[0m[1;37mINFO[0m: [1mChartInfo 0.6588 0.5635 0.6895 0.5964 0.7004 0.6420[0mGOODTwitter(554)
Data example from id_test: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from id_test: (tensor([0, 1, 2]), tensor([138, 251, 165]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.628
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.617
NEC for r=0.3 class 0 = 0.264 +- 0.186 (in-sample avg dev_std = 0.240)
NEC for r=0.3 class 1 = 0.227 +- 0.186 (in-sample avg dev_std = 0.240)
NEC for r=0.3 class 2 = 0.288 +- 0.186 (in-sample avg dev_std = 0.240)
NEC for r=0.3 all KL = 0.155 +- 0.186 (in-sample avg dev_std = 0.240)
NEC for r=0.3 all L1 = 0.254 +- 0.191 (in-sample avg dev_std = 0.240)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.646
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.628
NEC for r=0.4 class 0 = 0.235 +- 0.178 (in-sample avg dev_std = 0.239)
NEC for r=0.4 class 1 = 0.2 +- 0.178 (in-sample avg dev_std = 0.239)
NEC for r=0.4 class 2 = 0.254 +- 0.178 (in-sample avg dev_std = 0.239)
NEC for r=0.4 all KL = 0.136 +- 0.178 (in-sample avg dev_std = 0.239)
NEC for r=0.4 all L1 = 0.224 +- 0.189 (in-sample avg dev_std = 0.239)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.659
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.646
NEC for r=0.6 class 0 = 0.201 +- 0.148 (in-sample avg dev_std = 0.217)
NEC for r=0.6 class 1 = 0.163 +- 0.148 (in-sample avg dev_std = 0.217)
NEC for r=0.6 class 2 = 0.204 +- 0.148 (in-sample avg dev_std = 0.217)
NEC for r=0.6 all KL = 0.104 +- 0.148 (in-sample avg dev_std = 0.217)
NEC for r=0.6 all L1 = 0.185 +- 0.169 (in-sample avg dev_std = 0.217)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.682
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 551
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.672
NEC for r=0.9 class 0 = 0.146 +- 0.100 (in-sample avg dev_std = 0.150)
NEC for r=0.9 class 1 = 0.107 +- 0.100 (in-sample avg dev_std = 0.150)
NEC for r=0.9 class 2 = 0.135 +- 0.100 (in-sample avg dev_std = 0.150)
NEC for r=0.9 all KL = 0.056 +- 0.100 (in-sample avg dev_std = 0.150)
NEC for r=0.9 all L1 = 0.125 +- 0.142 (in-sample avg dev_std = 0.150)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.675
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 551
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.673
NEC for r=0.95 class 0 = 0.138 +- 0.096 (in-sample avg dev_std = 0.154)
NEC for r=0.95 class 1 = 0.102 +- 0.096 (in-sample avg dev_std = 0.154)
NEC for r=0.95 class 2 = 0.126 +- 0.096 (in-sample avg dev_std = 0.154)
NEC for r=0.95 all KL = 0.051 +- 0.096 (in-sample avg dev_std = 0.154)
NEC for r=0.95 all L1 = 0.118 +- 0.136 (in-sample avg dev_std = 0.154)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.659
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 551
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.67
NEC for r=1.0 class 0 = 0.128 +- 0.096 (in-sample avg dev_std = 0.151)
NEC for r=1.0 class 1 = 0.098 +- 0.096 (in-sample avg dev_std = 0.151)
NEC for r=1.0 class 2 = 0.124 +- 0.096 (in-sample avg dev_std = 0.151)
NEC for r=1.0 all KL = 0.05 +- 0.096 (in-sample avg dev_std = 0.151)
NEC for r=1.0 all L1 = 0.113 +- 0.135 (in-sample avg dev_std = 0.151)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.541
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.542
NEC for r=0.3 class 0 = 0.259 +- 0.139 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 1 = 0.229 +- 0.139 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 2 = 0.263 +- 0.139 (in-sample avg dev_std = 0.217)
NEC for r=0.3 all KL = 0.126 +- 0.139 (in-sample avg dev_std = 0.217)
NEC for r=0.3 all L1 = 0.245 +- 0.161 (in-sample avg dev_std = 0.217)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.535
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.55
NEC for r=0.4 class 0 = 0.228 +- 0.140 (in-sample avg dev_std = 0.209)
NEC for r=0.4 class 1 = 0.211 +- 0.140 (in-sample avg dev_std = 0.209)
NEC for r=0.4 class 2 = 0.237 +- 0.140 (in-sample avg dev_std = 0.209)
NEC for r=0.4 all KL = 0.116 +- 0.140 (in-sample avg dev_std = 0.209)
NEC for r=0.4 all L1 = 0.222 +- 0.166 (in-sample avg dev_std = 0.209)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.556
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.553
NEC for r=0.6 class 0 = 0.175 +- 0.120 (in-sample avg dev_std = 0.199)
NEC for r=0.6 class 1 = 0.178 +- 0.120 (in-sample avg dev_std = 0.199)
NEC for r=0.6 class 2 = 0.199 +- 0.120 (in-sample avg dev_std = 0.199)
NEC for r=0.6 all KL = 0.091 +- 0.120 (in-sample avg dev_std = 0.199)
NEC for r=0.6 all L1 = 0.182 +- 0.161 (in-sample avg dev_std = 0.199)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.565
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.566
NEC for r=0.9 class 0 = 0.117 +- 0.088 (in-sample avg dev_std = 0.150)
NEC for r=0.9 class 1 = 0.123 +- 0.088 (in-sample avg dev_std = 0.150)
NEC for r=0.9 class 2 = 0.156 +- 0.088 (in-sample avg dev_std = 0.150)
NEC for r=0.9 all KL = 0.055 +- 0.088 (in-sample avg dev_std = 0.150)
NEC for r=0.9 all L1 = 0.129 +- 0.141 (in-sample avg dev_std = 0.150)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.564
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.565
NEC for r=0.95 class 0 = 0.112 +- 0.094 (in-sample avg dev_std = 0.150)
NEC for r=0.95 class 1 = 0.118 +- 0.094 (in-sample avg dev_std = 0.150)
NEC for r=0.95 class 2 = 0.155 +- 0.094 (in-sample avg dev_std = 0.150)
NEC for r=0.95 all KL = 0.055 +- 0.094 (in-sample avg dev_std = 0.150)
NEC for r=0.95 all L1 = 0.126 +- 0.142 (in-sample avg dev_std = 0.150)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.561
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.561
NEC for r=1.0 class 0 = 0.116 +- 0.106 (in-sample avg dev_std = 0.163)
NEC for r=1.0 class 1 = 0.123 +- 0.106 (in-sample avg dev_std = 0.163)
NEC for r=1.0 class 2 = 0.156 +- 0.106 (in-sample avg dev_std = 0.163)
NEC for r=1.0 all KL = 0.062 +- 0.106 (in-sample avg dev_std = 0.163)
NEC for r=1.0 all L1 = 0.129 +- 0.150 (in-sample avg dev_std = 0.163)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.628
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.574
SUFF++ for r=0.3 class 0 = 0.666 +- 0.183 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.3 class 1 = 0.71 +- 0.183 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.3 class 2 = 0.618 +- 0.183 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.3 all KL = 0.733 +- 0.183 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.3 all L1 = 0.672 +- 0.161 (in-sample avg dev_std = 0.413)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.646
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.6
SUFF++ for r=0.4 class 0 = 0.677 +- 0.194 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.4 class 1 = 0.742 +- 0.194 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.4 class 2 = 0.645 +- 0.194 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.4 all KL = 0.743 +- 0.194 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.4 all L1 = 0.697 +- 0.169 (in-sample avg dev_std = 0.409)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.659
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.625
SUFF++ for r=0.6 class 0 = 0.725 +- 0.186 (in-sample avg dev_std = 0.356)
SUFF++ for r=0.6 class 1 = 0.79 +- 0.186 (in-sample avg dev_std = 0.356)
SUFF++ for r=0.6 class 2 = 0.711 +- 0.186 (in-sample avg dev_std = 0.356)
SUFF++ for r=0.6 all KL = 0.795 +- 0.186 (in-sample avg dev_std = 0.356)
SUFF++ for r=0.6 all L1 = 0.75 +- 0.170 (in-sample avg dev_std = 0.356)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.682
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.664
SUFF++ for r=0.9 class 0 = 0.86 +- 0.093 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 class 1 = 0.894 +- 0.093 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 class 2 = 0.879 +- 0.093 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all KL = 0.943 +- 0.093 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all L1 = 0.881 +- 0.133 (in-sample avg dev_std = 0.185)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.674
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 445
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.668
SUFF++ for r=0.95 class 0 = 0.928 +- 0.030 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.95 class 1 = 0.942 +- 0.030 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.95 class 2 = 0.931 +- 0.030 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.95 all KL = 0.98 +- 0.030 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.95 all L1 = 0.936 +- 0.075 (in-sample avg dev_std = 0.131)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.541
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.539
SUFF++ for r=0.3 class 0 = 0.737 +- 0.115 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 1 = 0.77 +- 0.115 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 2 = 0.73 +- 0.115 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 all KL = 0.869 +- 0.115 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 all L1 = 0.752 +- 0.137 (in-sample avg dev_std = 0.259)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.535
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.545
SUFF++ for r=0.4 class 0 = 0.762 +- 0.127 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.4 class 1 = 0.776 +- 0.127 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.4 class 2 = 0.739 +- 0.127 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.4 all KL = 0.864 +- 0.127 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.4 all L1 = 0.763 +- 0.148 (in-sample avg dev_std = 0.265)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.556
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.541
SUFF++ for r=0.6 class 0 = 0.809 +- 0.124 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 class 1 = 0.797 +- 0.124 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 class 2 = 0.761 +- 0.124 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 all KL = 0.879 +- 0.124 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 all L1 = 0.791 +- 0.161 (in-sample avg dev_std = 0.255)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.565
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.555
SUFF++ for r=0.9 class 0 = 0.896 +- 0.080 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.9 class 1 = 0.866 +- 0.080 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.9 class 2 = 0.857 +- 0.080 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.9 all KL = 0.944 +- 0.080 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.9 all L1 = 0.872 +- 0.131 (in-sample avg dev_std = 0.172)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.564
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.562
SUFF++ for r=0.95 class 0 = 0.939 +- 0.032 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.95 class 1 = 0.92 +- 0.032 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.95 class 2 = 0.919 +- 0.032 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.95 all KL = 0.98 +- 0.032 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.95 all L1 = 0.925 +- 0.085 (in-sample avg dev_std = 0.111)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 15:48:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:35 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:37 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:37 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:38 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:39 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:48:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 163...
[0m[1;37mINFO[0m: [1mCheckpoint 163: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.7076
ID Validation Loss: 2.3068
ID Test ACCURACY: 0.6697
ID Test Loss: 2.5476
OOD Validation ACCURACY: 0.6118
OOD Validation Loss: 2.8631
OOD Test ACCURACY: 0.5559
OOD Test Loss: 3.9096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 9...
[0m[1;37mINFO[0m: [1mCheckpoint 9: 
-----------------------------------
Train ACCURACY: 0.7730
Train Loss: 0.5461
ID Validation ACCURACY: 0.6877
ID Validation Loss: 0.7610
ID Test ACCURACY: 0.6841
ID Test Loss: 0.7794
OOD Validation ACCURACY: 0.6431
OOD Validation Loss: 0.8959
OOD Test ACCURACY: 0.5944
OOD Test Loss: 1.0740

[0m[1;37mINFO[0m: [1mChartInfo 0.6697 0.5559 0.6841 0.5944 0.6877 0.6431[0mGOODTwitter(554)
Data example from id_test: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from id_test: (tensor([0, 1, 2]), tensor([138, 251, 165]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.646
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.634
NEC for r=0.3 class 0 = 0.304 +- 0.338 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 1 = 0.194 +- 0.338 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 2 = 0.224 +- 0.338 (in-sample avg dev_std = 0.379)
NEC for r=0.3 all KL = 0.29 +- 0.338 (in-sample avg dev_std = 0.379)
NEC for r=0.3 all L1 = 0.23 +- 0.267 (in-sample avg dev_std = 0.379)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.67
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.643
NEC for r=0.4 class 0 = 0.257 +- 0.314 (in-sample avg dev_std = 0.341)
NEC for r=0.4 class 1 = 0.169 +- 0.314 (in-sample avg dev_std = 0.341)
NEC for r=0.4 class 2 = 0.198 +- 0.314 (in-sample avg dev_std = 0.341)
NEC for r=0.4 all KL = 0.239 +- 0.314 (in-sample avg dev_std = 0.341)
NEC for r=0.4 all L1 = 0.199 +- 0.248 (in-sample avg dev_std = 0.341)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.666
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.662
NEC for r=0.6 class 0 = 0.18 +- 0.249 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 1 = 0.123 +- 0.249 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 2 = 0.141 +- 0.249 (in-sample avg dev_std = 0.282)
NEC for r=0.6 all KL = 0.155 +- 0.249 (in-sample avg dev_std = 0.282)
NEC for r=0.6 all L1 = 0.143 +- 0.199 (in-sample avg dev_std = 0.282)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.666
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 551
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.664
NEC for r=0.9 class 0 = 0.108 +- 0.129 (in-sample avg dev_std = 0.163)
NEC for r=0.9 class 1 = 0.076 +- 0.129 (in-sample avg dev_std = 0.163)
NEC for r=0.9 class 2 = 0.086 +- 0.129 (in-sample avg dev_std = 0.163)
NEC for r=0.9 all KL = 0.06 +- 0.129 (in-sample avg dev_std = 0.163)
NEC for r=0.9 all L1 = 0.087 +- 0.141 (in-sample avg dev_std = 0.163)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.668
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 551
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.665
NEC for r=0.95 class 0 = 0.096 +- 0.102 (in-sample avg dev_std = 0.145)
NEC for r=0.95 class 1 = 0.061 +- 0.102 (in-sample avg dev_std = 0.145)
NEC for r=0.95 class 2 = 0.078 +- 0.102 (in-sample avg dev_std = 0.145)
NEC for r=0.95 all KL = 0.046 +- 0.102 (in-sample avg dev_std = 0.145)
NEC for r=0.95 all L1 = 0.075 +- 0.128 (in-sample avg dev_std = 0.145)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.668
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 551
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.668
NEC for r=1.0 class 0 = 0.102 +- 0.120 (in-sample avg dev_std = 0.162)
NEC for r=1.0 class 1 = 0.065 +- 0.120 (in-sample avg dev_std = 0.162)
NEC for r=1.0 class 2 = 0.08 +- 0.120 (in-sample avg dev_std = 0.162)
NEC for r=1.0 all KL = 0.053 +- 0.120 (in-sample avg dev_std = 0.162)
NEC for r=1.0 all L1 = 0.079 +- 0.136 (in-sample avg dev_std = 0.162)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.54
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.531
NEC for r=0.3 class 0 = 0.273 +- 0.315 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 1 = 0.269 +- 0.315 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 2 = 0.303 +- 0.315 (in-sample avg dev_std = 0.400)
NEC for r=0.3 all KL = 0.324 +- 0.315 (in-sample avg dev_std = 0.400)
NEC for r=0.3 all L1 = 0.279 +- 0.250 (in-sample avg dev_std = 0.400)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.539
NEC for r=0.4 class 0 = 0.227 +- 0.289 (in-sample avg dev_std = 0.364)
NEC for r=0.4 class 1 = 0.234 +- 0.289 (in-sample avg dev_std = 0.364)
NEC for r=0.4 class 2 = 0.257 +- 0.289 (in-sample avg dev_std = 0.364)
NEC for r=0.4 all KL = 0.259 +- 0.289 (in-sample avg dev_std = 0.364)
NEC for r=0.4 all L1 = 0.238 +- 0.236 (in-sample avg dev_std = 0.364)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.531
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.547
NEC for r=0.6 class 0 = 0.174 +- 0.235 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 1 = 0.178 +- 0.235 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 2 = 0.202 +- 0.235 (in-sample avg dev_std = 0.263)
NEC for r=0.6 all KL = 0.174 +- 0.235 (in-sample avg dev_std = 0.263)
NEC for r=0.6 all L1 = 0.183 +- 0.210 (in-sample avg dev_std = 0.263)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.543
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.55
NEC for r=0.9 class 0 = 0.103 +- 0.122 (in-sample avg dev_std = 0.162)
NEC for r=0.9 class 1 = 0.111 +- 0.122 (in-sample avg dev_std = 0.162)
NEC for r=0.9 class 2 = 0.116 +- 0.122 (in-sample avg dev_std = 0.162)
NEC for r=0.9 all KL = 0.066 +- 0.122 (in-sample avg dev_std = 0.162)
NEC for r=0.9 all L1 = 0.11 +- 0.152 (in-sample avg dev_std = 0.162)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.543
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.546
NEC for r=0.95 class 0 = 0.099 +- 0.118 (in-sample avg dev_std = 0.152)
NEC for r=0.95 class 1 = 0.103 +- 0.118 (in-sample avg dev_std = 0.152)
NEC for r=0.95 class 2 = 0.115 +- 0.118 (in-sample avg dev_std = 0.152)
NEC for r=0.95 all KL = 0.06 +- 0.118 (in-sample avg dev_std = 0.152)
NEC for r=0.95 all L1 = 0.105 +- 0.148 (in-sample avg dev_std = 0.152)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.543
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.546
NEC for r=1.0 class 0 = 0.092 +- 0.116 (in-sample avg dev_std = 0.155)
NEC for r=1.0 class 1 = 0.1 +- 0.116 (in-sample avg dev_std = 0.155)
NEC for r=1.0 class 2 = 0.117 +- 0.116 (in-sample avg dev_std = 0.155)
NEC for r=1.0 all KL = 0.059 +- 0.116 (in-sample avg dev_std = 0.155)
NEC for r=1.0 all L1 = 0.102 +- 0.146 (in-sample avg dev_std = 0.155)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.646
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.568
SUFF++ for r=0.3 class 0 = 0.628 +- 0.322 (in-sample avg dev_std = 0.650)
SUFF++ for r=0.3 class 1 = 0.696 +- 0.322 (in-sample avg dev_std = 0.650)
SUFF++ for r=0.3 class 2 = 0.592 +- 0.322 (in-sample avg dev_std = 0.650)
SUFF++ for r=0.3 all KL = 0.371 +- 0.322 (in-sample avg dev_std = 0.650)
SUFF++ for r=0.3 all L1 = 0.648 +- 0.217 (in-sample avg dev_std = 0.650)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.67
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.59
SUFF++ for r=0.4 class 0 = 0.649 +- 0.342 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.4 class 1 = 0.742 +- 0.342 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.4 class 2 = 0.631 +- 0.342 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.4 all KL = 0.447 +- 0.342 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.4 all L1 = 0.686 +- 0.219 (in-sample avg dev_std = 0.602)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.666
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.62
SUFF++ for r=0.6 class 0 = 0.702 +- 0.334 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 1 = 0.793 +- 0.334 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 2 = 0.713 +- 0.334 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 all KL = 0.582 +- 0.334 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 all L1 = 0.747 +- 0.215 (in-sample avg dev_std = 0.510)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.667
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.666
SUFF++ for r=0.9 class 0 = 0.883 +- 0.155 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 1 = 0.918 +- 0.155 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 2 = 0.89 +- 0.155 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all KL = 0.91 +- 0.155 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all L1 = 0.901 +- 0.146 (in-sample avg dev_std = 0.239)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.654
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 445
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.653
SUFF++ for r=0.95 class 0 = 0.924 +- 0.084 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.95 class 1 = 0.948 +- 0.084 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.95 class 2 = 0.909 +- 0.084 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.95 all KL = 0.952 +- 0.084 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.95 all L1 = 0.932 +- 0.105 (in-sample avg dev_std = 0.200)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.54
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.513
SUFF++ for r=0.3 class 0 = 0.661 +- 0.292 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.3 class 1 = 0.659 +- 0.292 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.3 class 2 = 0.623 +- 0.292 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.3 all KL = 0.489 +- 0.292 (in-sample avg dev_std = 0.557)
SUFF++ for r=0.3 all L1 = 0.651 +- 0.212 (in-sample avg dev_std = 0.557)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.514
SUFF++ for r=0.4 class 0 = 0.708 +- 0.288 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.4 class 1 = 0.686 +- 0.288 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.4 class 2 = 0.645 +- 0.288 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.4 all KL = 0.539 +- 0.288 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.4 all L1 = 0.682 +- 0.210 (in-sample avg dev_std = 0.522)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.531
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.52
SUFF++ for r=0.6 class 0 = 0.767 +- 0.271 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 1 = 0.756 +- 0.271 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 2 = 0.71 +- 0.271 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 all KL = 0.663 +- 0.271 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 all L1 = 0.747 +- 0.203 (in-sample avg dev_std = 0.435)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.543
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.543
SUFF++ for r=0.9 class 0 = 0.892 +- 0.100 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 class 1 = 0.886 +- 0.100 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 class 2 = 0.882 +- 0.100 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 all KL = 0.926 +- 0.100 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 all L1 = 0.887 +- 0.136 (in-sample avg dev_std = 0.197)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.543
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.546
SUFF++ for r=0.95 class 0 = 0.941 +- 0.050 (in-sample avg dev_std = 0.128)
SUFF++ for r=0.95 class 1 = 0.929 +- 0.050 (in-sample avg dev_std = 0.128)
SUFF++ for r=0.95 class 2 = 0.929 +- 0.050 (in-sample avg dev_std = 0.128)
SUFF++ for r=0.95 all KL = 0.972 +- 0.050 (in-sample avg dev_std = 0.128)
SUFF++ for r=0.95 all L1 = 0.932 +- 0.094 (in-sample avg dev_std = 0.128)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 15:53:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:19 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:21 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:21 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:22 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:23 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:53:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0094
ID Validation ACCURACY: 0.7040
ID Validation Loss: 1.7565
ID Test ACCURACY: 0.6643
ID Test Loss: 2.0819
OOD Validation ACCURACY: 0.6084
OOD Validation Loss: 2.4105
OOD Test ACCURACY: 0.5450
OOD Test Loss: 3.1833

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.9317
Train Loss: 0.2018
ID Validation ACCURACY: 0.6859
ID Validation Loss: 0.9593
ID Test ACCURACY: 0.6769
ID Test Loss: 1.0846
OOD Validation ACCURACY: 0.6476
OOD Validation Loss: 1.2904
OOD Test ACCURACY: 0.6026
OOD Test Loss: 1.8131

[0m[1;37mINFO[0m: [1mChartInfo 0.6643 0.5450 0.6769 0.6026 0.6859 0.6476[0mGOODTwitter(554)
Data example from id_test: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from id_test: (tensor([0, 1, 2]), tensor([138, 251, 165]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.588
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.595
NEC for r=0.3 class 0 = 0.268 +- 0.281 (in-sample avg dev_std = 0.331)
NEC for r=0.3 class 1 = 0.254 +- 0.281 (in-sample avg dev_std = 0.331)
NEC for r=0.3 class 2 = 0.303 +- 0.281 (in-sample avg dev_std = 0.331)
NEC for r=0.3 all KL = 0.263 +- 0.281 (in-sample avg dev_std = 0.331)
NEC for r=0.3 all L1 = 0.272 +- 0.247 (in-sample avg dev_std = 0.331)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.617
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.608
NEC for r=0.4 class 0 = 0.236 +- 0.270 (in-sample avg dev_std = 0.330)
NEC for r=0.4 class 1 = 0.231 +- 0.270 (in-sample avg dev_std = 0.330)
NEC for r=0.4 class 2 = 0.275 +- 0.270 (in-sample avg dev_std = 0.330)
NEC for r=0.4 all KL = 0.235 +- 0.270 (in-sample avg dev_std = 0.330)
NEC for r=0.4 all L1 = 0.245 +- 0.238 (in-sample avg dev_std = 0.330)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.633
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.607
NEC for r=0.6 class 0 = 0.192 +- 0.223 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 1 = 0.159 +- 0.223 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 2 = 0.227 +- 0.223 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all KL = 0.163 +- 0.223 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all L1 = 0.187 +- 0.209 (in-sample avg dev_std = 0.292)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.659
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 551
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.638
NEC for r=0.9 class 0 = 0.116 +- 0.152 (in-sample avg dev_std = 0.175)
NEC for r=0.9 class 1 = 0.111 +- 0.152 (in-sample avg dev_std = 0.175)
NEC for r=0.9 class 2 = 0.117 +- 0.152 (in-sample avg dev_std = 0.175)
NEC for r=0.9 all KL = 0.078 +- 0.152 (in-sample avg dev_std = 0.175)
NEC for r=0.9 all L1 = 0.114 +- 0.165 (in-sample avg dev_std = 0.175)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.657
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 551
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.642
NEC for r=0.95 class 0 = 0.103 +- 0.125 (in-sample avg dev_std = 0.164)
NEC for r=0.95 class 1 = 0.099 +- 0.125 (in-sample avg dev_std = 0.164)
NEC for r=0.95 class 2 = 0.109 +- 0.125 (in-sample avg dev_std = 0.164)
NEC for r=0.95 all KL = 0.064 +- 0.125 (in-sample avg dev_std = 0.164)
NEC for r=0.95 all L1 = 0.103 +- 0.153 (in-sample avg dev_std = 0.164)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.662
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 551
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.639
NEC for r=1.0 class 0 = 0.095 +- 0.134 (in-sample avg dev_std = 0.169)
NEC for r=1.0 class 1 = 0.098 +- 0.134 (in-sample avg dev_std = 0.169)
NEC for r=1.0 class 2 = 0.109 +- 0.134 (in-sample avg dev_std = 0.169)
NEC for r=1.0 all KL = 0.064 +- 0.134 (in-sample avg dev_std = 0.169)
NEC for r=1.0 all L1 = 0.1 +- 0.155 (in-sample avg dev_std = 0.169)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.514
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.514
NEC for r=0.3 class 0 = 0.247 +- 0.246 (in-sample avg dev_std = 0.312)
NEC for r=0.3 class 1 = 0.26 +- 0.246 (in-sample avg dev_std = 0.312)
NEC for r=0.3 class 2 = 0.302 +- 0.246 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all KL = 0.241 +- 0.246 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all L1 = 0.267 +- 0.226 (in-sample avg dev_std = 0.312)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.521
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.514
NEC for r=0.4 class 0 = 0.214 +- 0.225 (in-sample avg dev_std = 0.275)
NEC for r=0.4 class 1 = 0.224 +- 0.225 (in-sample avg dev_std = 0.275)
NEC for r=0.4 class 2 = 0.272 +- 0.225 (in-sample avg dev_std = 0.275)
NEC for r=0.4 all KL = 0.194 +- 0.225 (in-sample avg dev_std = 0.275)
NEC for r=0.4 all L1 = 0.233 +- 0.217 (in-sample avg dev_std = 0.275)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.535
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.525
NEC for r=0.6 class 0 = 0.156 +- 0.180 (in-sample avg dev_std = 0.237)
NEC for r=0.6 class 1 = 0.176 +- 0.180 (in-sample avg dev_std = 0.237)
NEC for r=0.6 class 2 = 0.208 +- 0.180 (in-sample avg dev_std = 0.237)
NEC for r=0.6 all KL = 0.132 +- 0.180 (in-sample avg dev_std = 0.237)
NEC for r=0.6 all L1 = 0.179 +- 0.193 (in-sample avg dev_std = 0.237)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.535
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.538
NEC for r=0.9 class 0 = 0.109 +- 0.112 (in-sample avg dev_std = 0.158)
NEC for r=0.9 class 1 = 0.113 +- 0.112 (in-sample avg dev_std = 0.158)
NEC for r=0.9 class 2 = 0.126 +- 0.112 (in-sample avg dev_std = 0.158)
NEC for r=0.9 all KL = 0.064 +- 0.112 (in-sample avg dev_std = 0.158)
NEC for r=0.9 all L1 = 0.115 +- 0.154 (in-sample avg dev_std = 0.158)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.529
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.536
NEC for r=0.95 class 0 = 0.096 +- 0.115 (in-sample avg dev_std = 0.155)
NEC for r=0.95 class 1 = 0.109 +- 0.115 (in-sample avg dev_std = 0.155)
NEC for r=0.95 class 2 = 0.122 +- 0.115 (in-sample avg dev_std = 0.155)
NEC for r=0.95 all KL = 0.061 +- 0.115 (in-sample avg dev_std = 0.155)
NEC for r=0.95 all L1 = 0.108 +- 0.151 (in-sample avg dev_std = 0.155)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.533
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.536
NEC for r=1.0 class 0 = 0.102 +- 0.127 (in-sample avg dev_std = 0.170)
NEC for r=1.0 class 1 = 0.113 +- 0.127 (in-sample avg dev_std = 0.170)
NEC for r=1.0 class 2 = 0.123 +- 0.127 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all KL = 0.068 +- 0.127 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all L1 = 0.113 +- 0.159 (in-sample avg dev_std = 0.170)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.588
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.538
SUFF++ for r=0.3 class 0 = 0.637 +- 0.281 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 class 1 = 0.685 +- 0.281 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 class 2 = 0.594 +- 0.281 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 all KL = 0.543 +- 0.281 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 all L1 = 0.646 +- 0.204 (in-sample avg dev_std = 0.542)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.617
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.565
SUFF++ for r=0.4 class 0 = 0.682 +- 0.280 (in-sample avg dev_std = 0.512)
SUFF++ for r=0.4 class 1 = 0.706 +- 0.280 (in-sample avg dev_std = 0.512)
SUFF++ for r=0.4 class 2 = 0.622 +- 0.280 (in-sample avg dev_std = 0.512)
SUFF++ for r=0.4 all KL = 0.585 +- 0.280 (in-sample avg dev_std = 0.512)
SUFF++ for r=0.4 all L1 = 0.676 +- 0.208 (in-sample avg dev_std = 0.512)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.633
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.595
SUFF++ for r=0.6 class 0 = 0.724 +- 0.274 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 1 = 0.764 +- 0.274 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 2 = 0.699 +- 0.274 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all KL = 0.675 +- 0.274 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all L1 = 0.735 +- 0.210 (in-sample avg dev_std = 0.440)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.658
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.65
SUFF++ for r=0.9 class 0 = 0.876 +- 0.139 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 1 = 0.884 +- 0.139 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 class 2 = 0.866 +- 0.139 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all KL = 0.909 +- 0.139 (in-sample avg dev_std = 0.229)
SUFF++ for r=0.9 all L1 = 0.877 +- 0.160 (in-sample avg dev_std = 0.229)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.645
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 445
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.642
SUFF++ for r=0.95 class 0 = 0.929 +- 0.066 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.95 class 1 = 0.929 +- 0.066 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.95 class 2 = 0.922 +- 0.066 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.95 all KL = 0.958 +- 0.066 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.95 all L1 = 0.927 +- 0.100 (in-sample avg dev_std = 0.183)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.514
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.504
SUFF++ for r=0.3 class 0 = 0.724 +- 0.234 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 1 = 0.721 +- 0.234 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 2 = 0.673 +- 0.234 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 all KL = 0.7 +- 0.234 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 all L1 = 0.71 +- 0.196 (in-sample avg dev_std = 0.409)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.521
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.506
SUFF++ for r=0.4 class 0 = 0.741 +- 0.229 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.4 class 1 = 0.738 +- 0.229 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.4 class 2 = 0.694 +- 0.229 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.4 all KL = 0.724 +- 0.229 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.4 all L1 = 0.728 +- 0.196 (in-sample avg dev_std = 0.388)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.535
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.519
SUFF++ for r=0.6 class 0 = 0.788 +- 0.212 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.6 class 1 = 0.795 +- 0.212 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.6 class 2 = 0.743 +- 0.212 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.6 all KL = 0.794 +- 0.212 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.6 all L1 = 0.78 +- 0.191 (in-sample avg dev_std = 0.331)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.535
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.531
SUFF++ for r=0.9 class 0 = 0.896 +- 0.094 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 class 1 = 0.887 +- 0.094 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 class 2 = 0.881 +- 0.094 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 all KL = 0.937 +- 0.094 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 all L1 = 0.888 +- 0.139 (in-sample avg dev_std = 0.182)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.529
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.534
SUFF++ for r=0.95 class 0 = 0.942 +- 0.039 (in-sample avg dev_std = 0.114)
SUFF++ for r=0.95 class 1 = 0.935 +- 0.039 (in-sample avg dev_std = 0.114)
SUFF++ for r=0.95 class 2 = 0.929 +- 0.039 (in-sample avg dev_std = 0.114)
SUFF++ for r=0.95 all KL = 0.979 +- 0.039 (in-sample avg dev_std = 0.114)
SUFF++ for r=0.95 all L1 = 0.935 +- 0.092 (in-sample avg dev_std = 0.114)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.245, 0.218, 0.17, 0.086, 0.064, 0.06], 'all_L1': [0.272, 0.247, 0.199, 0.131, 0.116, 0.109]}), defaultdict(<class 'list'>, {'all_KL': [0.176, 0.167, 0.133, 0.068, 0.058, 0.056], 'all_L1': [0.252, 0.233, 0.19, 0.126, 0.112, 0.109]}), defaultdict(<class 'list'>, {'all_KL': [0.155, 0.136, 0.104, 0.056, 0.051, 0.05], 'all_L1': [0.254, 0.224, 0.185, 0.125, 0.118, 0.113]}), defaultdict(<class 'list'>, {'all_KL': [0.29, 0.239, 0.155, 0.06, 0.046, 0.053], 'all_L1': [0.23, 0.199, 0.143, 0.087, 0.075, 0.079]}), defaultdict(<class 'list'>, {'all_KL': [0.263, 0.235, 0.163, 0.078, 0.064, 0.064], 'all_L1': [0.272, 0.245, 0.187, 0.114, 0.103, 0.1]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.58, 0.631, 0.765, 0.928, 0.974, 1.0], 'all_L1': [0.643, 0.686, 0.772, 0.885, 0.937, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.659, 0.682, 0.771, 0.932, 0.976, 1.0], 'all_L1': [0.649, 0.68, 0.75, 0.88, 0.937, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.733, 0.743, 0.795, 0.943, 0.98, 1.0], 'all_L1': [0.672, 0.697, 0.75, 0.881, 0.936, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.371, 0.447, 0.582, 0.91, 0.952, 1.0], 'all_L1': [0.648, 0.686, 0.747, 0.901, 0.932, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.543, 0.585, 0.675, 0.909, 0.958, 1.0], 'all_L1': [0.646, 0.676, 0.735, 0.877, 0.927, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]

Eval split test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.27, 0.241, 0.163, 0.077, 0.073, 0.076], 'all_L1': [0.303, 0.272, 0.213, 0.135, 0.127, 0.128]}), defaultdict(<class 'list'>, {'all_KL': [0.17, 0.139, 0.101, 0.062, 0.067, 0.07], 'all_L1': [0.273, 0.233, 0.185, 0.125, 0.126, 0.126]}), defaultdict(<class 'list'>, {'all_KL': [0.126, 0.116, 0.091, 0.055, 0.055, 0.062], 'all_L1': [0.245, 0.222, 0.182, 0.129, 0.126, 0.129]}), defaultdict(<class 'list'>, {'all_KL': [0.324, 0.259, 0.174, 0.066, 0.06, 0.059], 'all_L1': [0.279, 0.238, 0.183, 0.11, 0.105, 0.102]}), defaultdict(<class 'list'>, {'all_KL': [0.241, 0.194, 0.132, 0.064, 0.061, 0.068], 'all_L1': [0.267, 0.233, 0.179, 0.115, 0.108, 0.113]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.559, 0.606, 0.739, 0.938, 0.974, 1.0], 'all_L1': [0.603, 0.644, 0.726, 0.879, 0.924, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.791, 0.796, 0.837, 0.965, 0.985, 1.0], 'all_L1': [0.707, 0.72, 0.766, 0.904, 0.937, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.869, 0.864, 0.879, 0.944, 0.98, 1.0], 'all_L1': [0.752, 0.763, 0.791, 0.872, 0.925, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.489, 0.539, 0.663, 0.926, 0.972, 1.0], 'all_L1': [0.651, 0.682, 0.747, 0.887, 0.932, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.7, 0.724, 0.794, 0.937, 0.979, 1.0], 'all_L1': [0.71, 0.728, 0.78, 0.888, 0.935, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.256 +- 0.016, 0.230 +- 0.017, 0.181 +- 0.019, 0.117 +- 0.016, 0.105 +- 0.016, 0.102 +- 0.012
nec class all_KL  =  0.226 +- 0.052, 0.199 +- 0.041, 0.145 +- 0.024, 0.070 +- 0.011, 0.057 +- 0.007, 0.057 +- 0.005
nec_acc_int  =  0.612 +- 0.014, 0.626 +- 0.014, 0.638 +- 0.019, 0.655 +- 0.015, 0.659 +- 0.014, 0.657 +- 0.014
suff++ class all_L1  =  0.652 +- 0.010, 0.685 +- 0.007, 0.751 +- 0.012, 0.885 +- 0.008, 0.934 +- 0.004, 1.000 +- 0.000
suff++ class all_KL  =  0.577 +- 0.122, 0.618 +- 0.100, 0.718 +- 0.079, 0.924 +- 0.013, 0.968 +- 0.011, 1.000 +- 0.000
suff++_acc_int  =  0.561 +- 0.015, 0.585 +- 0.015, 0.615 +- 0.013, 0.653 +- 0.015, 0.650 +- 0.013

Eval split test
nec class all_L1  =  0.273 +- 0.019, 0.240 +- 0.017, 0.188 +- 0.012, 0.123 +- 0.009, 0.118 +- 0.010, 0.120 +- 0.011
nec class all_KL  =  0.226 +- 0.071, 0.190 +- 0.056, 0.132 +- 0.033, 0.065 +- 0.007, 0.063 +- 0.006, 0.067 +- 0.006
nec_acc_int  =  0.532 +- 0.011, 0.534 +- 0.014, 0.538 +- 0.014, 0.548 +- 0.013, 0.548 +- 0.012, 0.546 +- 0.010
suff++ class all_L1  =  0.685 +- 0.052, 0.707 +- 0.041, 0.762 +- 0.023, 0.886 +- 0.011, 0.931 +- 0.005, 1.000 +- 0.000
suff++ class all_KL  =  0.682 +- 0.141, 0.706 +- 0.119, 0.782 +- 0.076, 0.942 +- 0.013, 0.978 +- 0.005, 1.000 +- 0.000
suff++_acc_int  =  0.514 +- 0.018, 0.517 +- 0.020, 0.522 +- 0.013, 0.540 +- 0.012, 0.544 +- 0.014


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.454 +- 0.008, 0.457 +- 0.008, 0.466 +- 0.013, 0.501 +- 0.005, 0.519 +- 0.009, 0.551 +- 0.006
Faith. Armon (L1)= 		  =  0.367 +- 0.016, 0.343 +- 0.020, 0.291 +- 0.026, 0.206 +- 0.025, 0.188 +- 0.026, 0.185 +- 0.020
Faith. GMean (L1)= 	  =  0.408 +- 0.012, 0.396 +- 0.015, 0.368 +- 0.022, 0.320 +- 0.022, 0.312 +- 0.025, 0.319 +- 0.020
Faith. Aritm (KL)= 		  =  0.401 +- 0.038, 0.408 +- 0.034, 0.431 +- 0.035, 0.497 +- 0.007, 0.512 +- 0.007, 0.528 +- 0.002
Faith. Armon (KL)= 		  =  0.312 +- 0.038, 0.294 +- 0.039, 0.239 +- 0.033, 0.129 +- 0.019, 0.107 +- 0.013, 0.107 +- 0.009
Faith. GMean (KL)= 	  =  0.352 +- 0.021, 0.345 +- 0.022, 0.320 +- 0.025, 0.253 +- 0.020, 0.234 +- 0.015, 0.238 +- 0.010

Eval split test
Faith. Aritm (L1)= 		  =  0.479 +- 0.017, 0.474 +- 0.013, 0.475 +- 0.008, 0.504 +- 0.006, 0.525 +- 0.004, 0.560 +- 0.005
Faith. Armon (L1)= 		  =  0.389 +- 0.011, 0.357 +- 0.013, 0.302 +- 0.014, 0.216 +- 0.014, 0.210 +- 0.015, 0.213 +- 0.017
Faith. GMean (L1)= 	  =  0.432 +- 0.005, 0.411 +- 0.005, 0.378 +- 0.008, 0.330 +- 0.012, 0.332 +- 0.013, 0.345 +- 0.015
Faith. Aritm (KL)= 		  =  0.454 +- 0.037, 0.448 +- 0.032, 0.457 +- 0.022, 0.503 +- 0.006, 0.521 +- 0.004, 0.534 +- 0.003
Faith. Armon (KL)= 		  =  0.322 +- 0.063, 0.288 +- 0.058, 0.223 +- 0.045, 0.121 +- 0.012, 0.119 +- 0.011, 0.126 +- 0.011
Faith. GMean (KL)= 	  =  0.379 +- 0.028, 0.356 +- 0.026, 0.317 +- 0.026, 0.247 +- 0.013, 0.248 +- 0.012, 0.259 +- 0.012
Computed for split load_split = id



Completed in  0:23:54.218754  for LECIvGIN GOODTwitter/length



DONE LECI GOODTwitter/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 15:58:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:24 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:26 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:27 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:27 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:29 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 03:58:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9965
Train Loss: 0.0177
ID Validation ACCURACY: 0.6931
ID Validation Loss: 1.6171
ID Test ACCURACY: 0.6318
ID Test Loss: 1.8774
OOD Validation ACCURACY: 0.6011
OOD Validation Loss: 2.2998
OOD Test ACCURACY: 0.5319
OOD Test Loss: 3.2275

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0007
ID Validation ACCURACY: 0.6715
ID Validation Loss: 2.2483
ID Test ACCURACY: 0.6498
ID Test Loss: 2.4645
OOD Validation ACCURACY: 0.6353
OOD Validation Loss: 2.6045
OOD Test ACCURACY: 0.5765
OOD Test Loss: 3.1984

[0m[1;37mINFO[0m: [1mChartInfo 0.6318 0.5319 0.6498 0.5765 0.6715 0.6353[0mGOODTwitter(554)
Data example from id_test: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from id_test: (tensor([0, 1, 2]), tensor([138, 251, 165]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.554
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.569
NEC for r=0.3 class 0 = 0.254 +- 0.249 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 1 = 0.186 +- 0.249 (in-sample avg dev_std = 0.293)
NEC for r=0.3 class 2 = 0.296 +- 0.249 (in-sample avg dev_std = 0.293)
NEC for r=0.3 all KL = 0.211 +- 0.249 (in-sample avg dev_std = 0.293)
NEC for r=0.3 all L1 = 0.235 +- 0.232 (in-sample avg dev_std = 0.293)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.581
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.593
NEC for r=0.4 class 0 = 0.241 +- 0.251 (in-sample avg dev_std = 0.297)
NEC for r=0.4 class 1 = 0.171 +- 0.251 (in-sample avg dev_std = 0.297)
NEC for r=0.4 class 2 = 0.244 +- 0.251 (in-sample avg dev_std = 0.297)
NEC for r=0.4 all KL = 0.194 +- 0.251 (in-sample avg dev_std = 0.297)
NEC for r=0.4 all L1 = 0.21 +- 0.224 (in-sample avg dev_std = 0.297)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.604
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.615
NEC for r=0.6 class 0 = 0.192 +- 0.225 (in-sample avg dev_std = 0.269)
NEC for r=0.6 class 1 = 0.152 +- 0.225 (in-sample avg dev_std = 0.269)
NEC for r=0.6 class 2 = 0.17 +- 0.225 (in-sample avg dev_std = 0.269)
NEC for r=0.6 all KL = 0.149 +- 0.225 (in-sample avg dev_std = 0.269)
NEC for r=0.6 all L1 = 0.167 +- 0.208 (in-sample avg dev_std = 0.269)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.628
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 551
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.632
NEC for r=0.9 class 0 = 0.121 +- 0.163 (in-sample avg dev_std = 0.214)
NEC for r=0.9 class 1 = 0.124 +- 0.163 (in-sample avg dev_std = 0.214)
NEC for r=0.9 class 2 = 0.108 +- 0.163 (in-sample avg dev_std = 0.214)
NEC for r=0.9 all KL = 0.086 +- 0.163 (in-sample avg dev_std = 0.214)
NEC for r=0.9 all L1 = 0.118 +- 0.169 (in-sample avg dev_std = 0.214)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.639
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 551
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.629
NEC for r=0.95 class 0 = 0.111 +- 0.147 (in-sample avg dev_std = 0.209)
NEC for r=0.95 class 1 = 0.127 +- 0.147 (in-sample avg dev_std = 0.209)
NEC for r=0.95 class 2 = 0.105 +- 0.147 (in-sample avg dev_std = 0.209)
NEC for r=0.95 all KL = 0.08 +- 0.147 (in-sample avg dev_std = 0.209)
NEC for r=0.95 all L1 = 0.116 +- 0.162 (in-sample avg dev_std = 0.209)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.63
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 551
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.623
NEC for r=1.0 class 0 = 0.117 +- 0.160 (in-sample avg dev_std = 0.210)
NEC for r=1.0 class 1 = 0.13 +- 0.160 (in-sample avg dev_std = 0.210)
NEC for r=1.0 class 2 = 0.109 +- 0.160 (in-sample avg dev_std = 0.210)
NEC for r=1.0 all KL = 0.084 +- 0.160 (in-sample avg dev_std = 0.210)
NEC for r=1.0 all L1 = 0.12 +- 0.169 (in-sample avg dev_std = 0.210)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.536
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.531
NEC for r=0.3 class 0 = 0.261 +- 0.247 (in-sample avg dev_std = 0.330)
NEC for r=0.3 class 1 = 0.194 +- 0.247 (in-sample avg dev_std = 0.330)
NEC for r=0.3 class 2 = 0.242 +- 0.247 (in-sample avg dev_std = 0.330)
NEC for r=0.3 all KL = 0.211 +- 0.247 (in-sample avg dev_std = 0.330)
NEC for r=0.3 all L1 = 0.223 +- 0.221 (in-sample avg dev_std = 0.330)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.539
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.535
NEC for r=0.4 class 0 = 0.216 +- 0.237 (in-sample avg dev_std = 0.315)
NEC for r=0.4 class 1 = 0.183 +- 0.237 (in-sample avg dev_std = 0.315)
NEC for r=0.4 class 2 = 0.235 +- 0.237 (in-sample avg dev_std = 0.315)
NEC for r=0.4 all KL = 0.193 +- 0.237 (in-sample avg dev_std = 0.315)
NEC for r=0.4 all L1 = 0.204 +- 0.214 (in-sample avg dev_std = 0.315)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.536
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.534
NEC for r=0.6 class 0 = 0.184 +- 0.214 (in-sample avg dev_std = 0.275)
NEC for r=0.6 class 1 = 0.155 +- 0.214 (in-sample avg dev_std = 0.275)
NEC for r=0.6 class 2 = 0.193 +- 0.214 (in-sample avg dev_std = 0.275)
NEC for r=0.6 all KL = 0.145 +- 0.214 (in-sample avg dev_std = 0.275)
NEC for r=0.6 all L1 = 0.172 +- 0.205 (in-sample avg dev_std = 0.275)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.544
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.541
NEC for r=0.9 class 0 = 0.137 +- 0.153 (in-sample avg dev_std = 0.203)
NEC for r=0.9 class 1 = 0.118 +- 0.153 (in-sample avg dev_std = 0.203)
NEC for r=0.9 class 2 = 0.157 +- 0.153 (in-sample avg dev_std = 0.203)
NEC for r=0.9 all KL = 0.093 +- 0.153 (in-sample avg dev_std = 0.203)
NEC for r=0.9 all L1 = 0.133 +- 0.173 (in-sample avg dev_std = 0.203)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.541
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.541
NEC for r=0.95 class 0 = 0.132 +- 0.156 (in-sample avg dev_std = 0.203)
NEC for r=0.95 class 1 = 0.114 +- 0.156 (in-sample avg dev_std = 0.203)
NEC for r=0.95 class 2 = 0.153 +- 0.156 (in-sample avg dev_std = 0.203)
NEC for r=0.95 all KL = 0.091 +- 0.156 (in-sample avg dev_std = 0.203)
NEC for r=0.95 all L1 = 0.129 +- 0.173 (in-sample avg dev_std = 0.203)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.543
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.541
NEC for r=1.0 class 0 = 0.124 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=1.0 class 1 = 0.114 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=1.0 class 2 = 0.148 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=1.0 all KL = 0.087 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=1.0 all L1 = 0.125 +- 0.172 (in-sample avg dev_std = 0.204)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.554
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.512
SUFF++ for r=0.3 class 0 = 0.667 +- 0.281 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.3 class 1 = 0.729 +- 0.281 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.3 class 2 = 0.591 +- 0.281 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.3 all KL = 0.593 +- 0.281 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.3 all L1 = 0.673 +- 0.210 (in-sample avg dev_std = 0.521)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.581
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.543
SUFF++ for r=0.4 class 0 = 0.715 +- 0.287 (in-sample avg dev_std = 0.495)
SUFF++ for r=0.4 class 1 = 0.761 +- 0.287 (in-sample avg dev_std = 0.495)
SUFF++ for r=0.4 class 2 = 0.609 +- 0.287 (in-sample avg dev_std = 0.495)
SUFF++ for r=0.4 all KL = 0.626 +- 0.287 (in-sample avg dev_std = 0.495)
SUFF++ for r=0.4 all L1 = 0.705 +- 0.212 (in-sample avg dev_std = 0.495)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.604
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.588
SUFF++ for r=0.6 class 0 = 0.793 +- 0.255 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 class 1 = 0.83 +- 0.255 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 class 2 = 0.729 +- 0.255 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 all KL = 0.748 +- 0.255 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 all L1 = 0.791 +- 0.192 (in-sample avg dev_std = 0.410)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.629
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.629
SUFF++ for r=0.9 class 0 = 0.885 +- 0.146 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 class 1 = 0.883 +- 0.146 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 class 2 = 0.91 +- 0.146 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 all KL = 0.919 +- 0.146 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 all L1 = 0.891 +- 0.151 (in-sample avg dev_std = 0.223)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.622
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 445
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.619
SUFF++ for r=0.95 class 0 = 0.932 +- 0.070 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.95 class 1 = 0.93 +- 0.070 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.95 class 2 = 0.946 +- 0.070 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.95 all KL = 0.965 +- 0.070 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.95 all L1 = 0.935 +- 0.097 (in-sample avg dev_std = 0.166)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.536
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.515
SUFF++ for r=0.3 class 0 = 0.668 +- 0.276 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.3 class 1 = 0.733 +- 0.276 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.3 class 2 = 0.654 +- 0.276 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.3 all KL = 0.629 +- 0.276 (in-sample avg dev_std = 0.501)
SUFF++ for r=0.3 all L1 = 0.697 +- 0.216 (in-sample avg dev_std = 0.501)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.539
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.518
SUFF++ for r=0.4 class 0 = 0.723 +- 0.273 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.4 class 1 = 0.753 +- 0.273 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.4 class 2 = 0.692 +- 0.273 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.4 all KL = 0.673 +- 0.273 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.4 all L1 = 0.73 +- 0.211 (in-sample avg dev_std = 0.466)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.536
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.526
SUFF++ for r=0.6 class 0 = 0.784 +- 0.242 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 class 1 = 0.818 +- 0.242 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 class 2 = 0.741 +- 0.242 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 all KL = 0.775 +- 0.242 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 all L1 = 0.79 +- 0.198 (in-sample avg dev_std = 0.382)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.544
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.538
SUFF++ for r=0.9 class 0 = 0.89 +- 0.124 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.9 class 1 = 0.896 +- 0.124 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.9 class 2 = 0.862 +- 0.124 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.9 all KL = 0.928 +- 0.124 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.9 all L1 = 0.886 +- 0.155 (in-sample avg dev_std = 0.195)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.541
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.54
SUFF++ for r=0.95 class 0 = 0.916 +- 0.091 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.95 class 1 = 0.928 +- 0.091 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.95 class 2 = 0.908 +- 0.091 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.95 all KL = 0.962 +- 0.091 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.95 all L1 = 0.92 +- 0.125 (in-sample avg dev_std = 0.147)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:03:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:03 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:04 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:05 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:05 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:07 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:03:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0007
ID Validation ACCURACY: 0.7004
ID Validation Loss: 2.0560
ID Test ACCURACY: 0.6715
ID Test Loss: 2.3868
OOD Validation ACCURACY: 0.6331
OOD Validation Loss: 2.6110
OOD Test ACCURACY: 0.5518
OOD Test Loss: 3.4085

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0007
ID Validation ACCURACY: 0.7004
ID Validation Loss: 2.0560
ID Test ACCURACY: 0.6715
ID Test Loss: 2.3868
OOD Validation ACCURACY: 0.6331
OOD Validation Loss: 2.6110
OOD Test ACCURACY: 0.5518
OOD Test Loss: 3.4085

[0m[1;37mINFO[0m: [1mChartInfo 0.6715 0.5518 0.6715 0.5518 0.7004 0.6331[0mGOODTwitter(554)
Data example from id_test: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from id_test: (tensor([0, 1, 2]), tensor([138, 251, 165]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.628
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.64
NEC for r=0.3 class 0 = 0.272 +- 0.315 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 1 = 0.17 +- 0.315 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 2 = 0.221 +- 0.315 (in-sample avg dev_std = 0.337)
NEC for r=0.3 all KL = 0.248 +- 0.315 (in-sample avg dev_std = 0.337)
NEC for r=0.3 all L1 = 0.21 +- 0.252 (in-sample avg dev_std = 0.337)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.661
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.639
NEC for r=0.4 class 0 = 0.225 +- 0.304 (in-sample avg dev_std = 0.345)
NEC for r=0.4 class 1 = 0.153 +- 0.304 (in-sample avg dev_std = 0.345)
NEC for r=0.4 class 2 = 0.175 +- 0.304 (in-sample avg dev_std = 0.345)
NEC for r=0.4 all KL = 0.214 +- 0.304 (in-sample avg dev_std = 0.345)
NEC for r=0.4 all L1 = 0.178 +- 0.237 (in-sample avg dev_std = 0.345)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.661
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.648
NEC for r=0.6 class 0 = 0.202 +- 0.278 (in-sample avg dev_std = 0.311)
NEC for r=0.6 class 1 = 0.13 +- 0.278 (in-sample avg dev_std = 0.311)
NEC for r=0.6 class 2 = 0.137 +- 0.278 (in-sample avg dev_std = 0.311)
NEC for r=0.6 all KL = 0.175 +- 0.278 (in-sample avg dev_std = 0.311)
NEC for r=0.6 all L1 = 0.15 +- 0.218 (in-sample avg dev_std = 0.311)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.664
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 551
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.655
NEC for r=0.9 class 0 = 0.164 +- 0.214 (in-sample avg dev_std = 0.255)
NEC for r=0.9 class 1 = 0.104 +- 0.214 (in-sample avg dev_std = 0.255)
NEC for r=0.9 class 2 = 0.123 +- 0.214 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all KL = 0.116 +- 0.214 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all L1 = 0.124 +- 0.194 (in-sample avg dev_std = 0.255)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.666
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 551
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.654
NEC for r=0.95 class 0 = 0.157 +- 0.197 (in-sample avg dev_std = 0.241)
NEC for r=0.95 class 1 = 0.101 +- 0.197 (in-sample avg dev_std = 0.241)
NEC for r=0.95 class 2 = 0.119 +- 0.197 (in-sample avg dev_std = 0.241)
NEC for r=0.95 all KL = 0.105 +- 0.197 (in-sample avg dev_std = 0.241)
NEC for r=0.95 all L1 = 0.12 +- 0.187 (in-sample avg dev_std = 0.241)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.67
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 551
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.655
NEC for r=1.0 class 0 = 0.152 +- 0.196 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 1 = 0.093 +- 0.196 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 2 = 0.119 +- 0.196 (in-sample avg dev_std = 0.242)
NEC for r=1.0 all KL = 0.102 +- 0.196 (in-sample avg dev_std = 0.242)
NEC for r=1.0 all L1 = 0.116 +- 0.182 (in-sample avg dev_std = 0.242)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.545
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.554
NEC for r=0.3 class 0 = 0.24 +- 0.318 (in-sample avg dev_std = 0.375)
NEC for r=0.3 class 1 = 0.173 +- 0.318 (in-sample avg dev_std = 0.375)
NEC for r=0.3 class 2 = 0.228 +- 0.318 (in-sample avg dev_std = 0.375)
NEC for r=0.3 all KL = 0.263 +- 0.318 (in-sample avg dev_std = 0.375)
NEC for r=0.3 all L1 = 0.204 +- 0.242 (in-sample avg dev_std = 0.375)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.548
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.545
NEC for r=0.4 class 0 = 0.216 +- 0.308 (in-sample avg dev_std = 0.351)
NEC for r=0.4 class 1 = 0.161 +- 0.308 (in-sample avg dev_std = 0.351)
NEC for r=0.4 class 2 = 0.205 +- 0.308 (in-sample avg dev_std = 0.351)
NEC for r=0.4 all KL = 0.232 +- 0.308 (in-sample avg dev_std = 0.351)
NEC for r=0.4 all L1 = 0.186 +- 0.238 (in-sample avg dev_std = 0.351)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.55
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.542
NEC for r=0.6 class 0 = 0.193 +- 0.291 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 1 = 0.147 +- 0.291 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 2 = 0.204 +- 0.291 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all KL = 0.205 +- 0.291 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all L1 = 0.173 +- 0.226 (in-sample avg dev_std = 0.330)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.541
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.539
NEC for r=0.9 class 0 = 0.161 +- 0.191 (in-sample avg dev_std = 0.240)
NEC for r=0.9 class 1 = 0.122 +- 0.191 (in-sample avg dev_std = 0.240)
NEC for r=0.9 class 2 = 0.164 +- 0.191 (in-sample avg dev_std = 0.240)
NEC for r=0.9 all KL = 0.119 +- 0.191 (in-sample avg dev_std = 0.240)
NEC for r=0.9 all L1 = 0.142 +- 0.193 (in-sample avg dev_std = 0.240)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.548
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.541
NEC for r=0.95 class 0 = 0.154 +- 0.183 (in-sample avg dev_std = 0.221)
NEC for r=0.95 class 1 = 0.116 +- 0.183 (in-sample avg dev_std = 0.221)
NEC for r=0.95 class 2 = 0.159 +- 0.183 (in-sample avg dev_std = 0.221)
NEC for r=0.95 all KL = 0.108 +- 0.183 (in-sample avg dev_std = 0.221)
NEC for r=0.95 all L1 = 0.136 +- 0.187 (in-sample avg dev_std = 0.221)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.546
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.542
NEC for r=1.0 class 0 = 0.148 +- 0.167 (in-sample avg dev_std = 0.213)
NEC for r=1.0 class 1 = 0.112 +- 0.167 (in-sample avg dev_std = 0.213)
NEC for r=1.0 class 2 = 0.152 +- 0.167 (in-sample avg dev_std = 0.213)
NEC for r=1.0 all KL = 0.097 +- 0.167 (in-sample avg dev_std = 0.213)
NEC for r=1.0 all L1 = 0.131 +- 0.176 (in-sample avg dev_std = 0.213)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.628
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.544
SUFF++ for r=0.3 class 0 = 0.58 +- 0.307 (in-sample avg dev_std = 0.666)
SUFF++ for r=0.3 class 1 = 0.681 +- 0.307 (in-sample avg dev_std = 0.666)
SUFF++ for r=0.3 class 2 = 0.578 +- 0.307 (in-sample avg dev_std = 0.666)
SUFF++ for r=0.3 all KL = 0.374 +- 0.307 (in-sample avg dev_std = 0.666)
SUFF++ for r=0.3 all L1 = 0.625 +- 0.220 (in-sample avg dev_std = 0.666)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.661
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.574
SUFF++ for r=0.4 class 0 = 0.633 +- 0.330 (in-sample avg dev_std = 0.631)
SUFF++ for r=0.4 class 1 = 0.719 +- 0.330 (in-sample avg dev_std = 0.631)
SUFF++ for r=0.4 class 2 = 0.638 +- 0.330 (in-sample avg dev_std = 0.631)
SUFF++ for r=0.4 all KL = 0.431 +- 0.330 (in-sample avg dev_std = 0.631)
SUFF++ for r=0.4 all L1 = 0.674 +- 0.222 (in-sample avg dev_std = 0.631)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.661
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.614
SUFF++ for r=0.6 class 0 = 0.748 +- 0.342 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 1 = 0.796 +- 0.342 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 class 2 = 0.754 +- 0.342 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 all KL = 0.615 +- 0.342 (in-sample avg dev_std = 0.504)
SUFF++ for r=0.6 all L1 = 0.771 +- 0.224 (in-sample avg dev_std = 0.504)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.665
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.661
SUFF++ for r=0.9 class 0 = 0.878 +- 0.189 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 1 = 0.906 +- 0.189 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 class 2 = 0.892 +- 0.189 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all KL = 0.899 +- 0.189 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.9 all L1 = 0.895 +- 0.164 (in-sample avg dev_std = 0.256)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.656
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 445
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.656
SUFF++ for r=0.95 class 0 = 0.933 +- 0.111 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.95 class 1 = 0.945 +- 0.111 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.95 class 2 = 0.929 +- 0.111 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.95 all KL = 0.956 +- 0.111 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.95 all L1 = 0.938 +- 0.109 (in-sample avg dev_std = 0.194)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.545
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.519
SUFF++ for r=0.3 class 0 = 0.666 +- 0.320 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 class 1 = 0.689 +- 0.320 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 class 2 = 0.641 +- 0.320 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 all KL = 0.443 +- 0.320 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 all L1 = 0.671 +- 0.222 (in-sample avg dev_std = 0.614)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.548
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.525
SUFF++ for r=0.4 class 0 = 0.734 +- 0.327 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.4 class 1 = 0.76 +- 0.327 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.4 class 2 = 0.692 +- 0.327 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.4 all KL = 0.568 +- 0.327 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.4 all L1 = 0.737 +- 0.218 (in-sample avg dev_std = 0.535)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.551
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 799
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.543
SUFF++ for r=0.6 class 0 = 0.821 +- 0.279 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 class 1 = 0.839 +- 0.279 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 class 2 = 0.788 +- 0.279 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 all KL = 0.763 +- 0.279 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.6 all L1 = 0.822 +- 0.203 (in-sample avg dev_std = 0.383)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.541
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.545
SUFF++ for r=0.9 class 0 = 0.872 +- 0.168 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 class 1 = 0.906 +- 0.168 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 class 2 = 0.859 +- 0.168 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 all KL = 0.913 +- 0.168 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 all L1 = 0.886 +- 0.165 (in-sample avg dev_std = 0.222)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.548
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.545
SUFF++ for r=0.95 class 0 = 0.904 +- 0.126 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.95 class 1 = 0.929 +- 0.126 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.95 class 2 = 0.9 +- 0.126 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.95 all KL = 0.95 +- 0.126 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.95 all L1 = 0.915 +- 0.134 (in-sample avg dev_std = 0.166)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:07:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:36 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:38 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:38 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:38 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:40 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:07:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 25...
[0m[1;37mINFO[0m: [1mCheckpoint 25: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0031
ID Validation ACCURACY: 0.7058
ID Validation Loss: 1.5079
ID Test ACCURACY: 0.6426
ID Test Loss: 1.8561
OOD Validation ACCURACY: 0.6101
OOD Validation Loss: 2.2219
OOD Test ACCURACY: 0.5333
OOD Test Loss: 3.4476

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 36...
[0m[1;37mINFO[0m: [1mCheckpoint 36: 
-----------------------------------
Train ACCURACY: 0.9981
Train Loss: 0.0050
ID Validation ACCURACY: 0.6733
ID Validation Loss: 1.7091
ID Test ACCURACY: 0.6552
ID Test Loss: 1.9976
OOD Validation ACCURACY: 0.6403
OOD Validation Loss: 2.0926
OOD Test ACCURACY: 0.5690
OOD Test Loss: 2.7705

[0m[1;37mINFO[0m: [1mChartInfo 0.6426 0.5333 0.6552 0.5690 0.6733 0.6403[0mGOODTwitter(554)
Data example from id_test: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from id_test: (tensor([0, 1, 2]), tensor([138, 251, 165]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.599
NEC for r=0.3 class 0 = 0.218 +- 0.261 (in-sample avg dev_std = 0.300)
NEC for r=0.3 class 1 = 0.191 +- 0.261 (in-sample avg dev_std = 0.300)
NEC for r=0.3 class 2 = 0.278 +- 0.261 (in-sample avg dev_std = 0.300)
NEC for r=0.3 all KL = 0.213 +- 0.261 (in-sample avg dev_std = 0.300)
NEC for r=0.3 all L1 = 0.223 +- 0.234 (in-sample avg dev_std = 0.300)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.626
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.61
NEC for r=0.4 class 0 = 0.194 +- 0.273 (in-sample avg dev_std = 0.323)
NEC for r=0.4 class 1 = 0.192 +- 0.273 (in-sample avg dev_std = 0.323)
NEC for r=0.4 class 2 = 0.254 +- 0.273 (in-sample avg dev_std = 0.323)
NEC for r=0.4 all KL = 0.213 +- 0.273 (in-sample avg dev_std = 0.323)
NEC for r=0.4 all L1 = 0.211 +- 0.232 (in-sample avg dev_std = 0.323)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.633
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.628
NEC for r=0.6 class 0 = 0.15 +- 0.243 (in-sample avg dev_std = 0.302)
NEC for r=0.6 class 1 = 0.163 +- 0.243 (in-sample avg dev_std = 0.302)
NEC for r=0.6 class 2 = 0.196 +- 0.243 (in-sample avg dev_std = 0.302)
NEC for r=0.6 all KL = 0.167 +- 0.243 (in-sample avg dev_std = 0.302)
NEC for r=0.6 all L1 = 0.169 +- 0.209 (in-sample avg dev_std = 0.302)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.641
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 551
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.633
NEC for r=0.9 class 0 = 0.135 +- 0.201 (in-sample avg dev_std = 0.253)
NEC for r=0.9 class 1 = 0.13 +- 0.201 (in-sample avg dev_std = 0.253)
NEC for r=0.9 class 2 = 0.148 +- 0.201 (in-sample avg dev_std = 0.253)
NEC for r=0.9 all KL = 0.118 +- 0.201 (in-sample avg dev_std = 0.253)
NEC for r=0.9 all L1 = 0.137 +- 0.189 (in-sample avg dev_std = 0.253)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.641
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 551
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.641
NEC for r=0.95 class 0 = 0.125 +- 0.195 (in-sample avg dev_std = 0.246)
NEC for r=0.95 class 1 = 0.128 +- 0.195 (in-sample avg dev_std = 0.246)
NEC for r=0.95 class 2 = 0.154 +- 0.195 (in-sample avg dev_std = 0.246)
NEC for r=0.95 all KL = 0.113 +- 0.195 (in-sample avg dev_std = 0.246)
NEC for r=0.95 all L1 = 0.135 +- 0.189 (in-sample avg dev_std = 0.246)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.641
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 551
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.646
NEC for r=1.0 class 0 = 0.114 +- 0.195 (in-sample avg dev_std = 0.235)
NEC for r=1.0 class 1 = 0.131 +- 0.195 (in-sample avg dev_std = 0.235)
NEC for r=1.0 class 2 = 0.14 +- 0.195 (in-sample avg dev_std = 0.235)
NEC for r=1.0 all KL = 0.106 +- 0.195 (in-sample avg dev_std = 0.235)
NEC for r=1.0 all L1 = 0.13 +- 0.188 (in-sample avg dev_std = 0.235)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.493
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.5
NEC for r=0.3 class 0 = 0.192 +- 0.284 (in-sample avg dev_std = 0.350)
NEC for r=0.3 class 1 = 0.219 +- 0.284 (in-sample avg dev_std = 0.350)
NEC for r=0.3 class 2 = 0.27 +- 0.284 (in-sample avg dev_std = 0.350)
NEC for r=0.3 all KL = 0.247 +- 0.284 (in-sample avg dev_std = 0.350)
NEC for r=0.3 all L1 = 0.225 +- 0.233 (in-sample avg dev_std = 0.350)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.493
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.504
NEC for r=0.4 class 0 = 0.167 +- 0.260 (in-sample avg dev_std = 0.334)
NEC for r=0.4 class 1 = 0.201 +- 0.260 (in-sample avg dev_std = 0.334)
NEC for r=0.4 class 2 = 0.238 +- 0.260 (in-sample avg dev_std = 0.334)
NEC for r=0.4 all KL = 0.212 +- 0.260 (in-sample avg dev_std = 0.334)
NEC for r=0.4 all L1 = 0.201 +- 0.221 (in-sample avg dev_std = 0.334)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.509
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.507
NEC for r=0.6 class 0 = 0.144 +- 0.241 (in-sample avg dev_std = 0.307)
NEC for r=0.6 class 1 = 0.169 +- 0.241 (in-sample avg dev_std = 0.307)
NEC for r=0.6 class 2 = 0.216 +- 0.241 (in-sample avg dev_std = 0.307)
NEC for r=0.6 all KL = 0.173 +- 0.241 (in-sample avg dev_std = 0.307)
NEC for r=0.6 all L1 = 0.174 +- 0.214 (in-sample avg dev_std = 0.307)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.533
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.522
NEC for r=0.9 class 0 = 0.143 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 1 = 0.149 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 2 = 0.187 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 all KL = 0.131 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 all L1 = 0.157 +- 0.199 (in-sample avg dev_std = 0.259)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.524
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.523
NEC for r=0.95 class 0 = 0.139 +- 0.194 (in-sample avg dev_std = 0.252)
NEC for r=0.95 class 1 = 0.144 +- 0.194 (in-sample avg dev_std = 0.252)
NEC for r=0.95 class 2 = 0.19 +- 0.194 (in-sample avg dev_std = 0.252)
NEC for r=0.95 all KL = 0.126 +- 0.194 (in-sample avg dev_std = 0.252)
NEC for r=0.95 all L1 = 0.154 +- 0.197 (in-sample avg dev_std = 0.252)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.531
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.523
NEC for r=1.0 class 0 = 0.136 +- 0.198 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 1 = 0.147 +- 0.198 (in-sample avg dev_std = 0.246)
NEC for r=1.0 class 2 = 0.178 +- 0.198 (in-sample avg dev_std = 0.246)
NEC for r=1.0 all KL = 0.124 +- 0.198 (in-sample avg dev_std = 0.246)
NEC for r=1.0 all L1 = 0.152 +- 0.197 (in-sample avg dev_std = 0.246)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.548
SUFF++ for r=0.3 class 0 = 0.726 +- 0.295 (in-sample avg dev_std = 0.565)
SUFF++ for r=0.3 class 1 = 0.694 +- 0.295 (in-sample avg dev_std = 0.565)
SUFF++ for r=0.3 class 2 = 0.555 +- 0.295 (in-sample avg dev_std = 0.565)
SUFF++ for r=0.3 all KL = 0.545 +- 0.295 (in-sample avg dev_std = 0.565)
SUFF++ for r=0.3 all L1 = 0.661 +- 0.216 (in-sample avg dev_std = 0.565)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.626
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.572
SUFF++ for r=0.4 class 0 = 0.79 +- 0.301 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.4 class 1 = 0.725 +- 0.301 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.4 class 2 = 0.611 +- 0.301 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.4 all KL = 0.607 +- 0.301 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.4 all L1 = 0.708 +- 0.220 (in-sample avg dev_std = 0.535)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.633
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.602
SUFF++ for r=0.6 class 0 = 0.822 +- 0.275 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 1 = 0.798 +- 0.275 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 2 = 0.724 +- 0.275 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 all KL = 0.735 +- 0.275 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 all L1 = 0.782 +- 0.214 (in-sample avg dev_std = 0.421)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.64
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.64
SUFF++ for r=0.9 class 0 = 0.9 +- 0.160 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 class 1 = 0.897 +- 0.160 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 class 2 = 0.876 +- 0.160 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all KL = 0.916 +- 0.160 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all L1 = 0.892 +- 0.160 (in-sample avg dev_std = 0.225)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.634
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 445
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.631
SUFF++ for r=0.95 class 0 = 0.952 +- 0.096 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.95 class 1 = 0.931 +- 0.096 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.95 class 2 = 0.935 +- 0.096 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.95 all KL = 0.96 +- 0.096 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.95 all L1 = 0.937 +- 0.107 (in-sample avg dev_std = 0.181)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.493
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.455
SUFF++ for r=0.3 class 0 = 0.777 +- 0.320 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 class 1 = 0.676 +- 0.320 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 class 2 = 0.598 +- 0.320 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 all KL = 0.574 +- 0.320 (in-sample avg dev_std = 0.551)
SUFF++ for r=0.3 all L1 = 0.683 +- 0.232 (in-sample avg dev_std = 0.551)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.493
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.462
SUFF++ for r=0.4 class 0 = 0.802 +- 0.311 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.4 class 1 = 0.718 +- 0.311 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.4 class 2 = 0.636 +- 0.311 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.4 all KL = 0.628 +- 0.311 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.4 all L1 = 0.72 +- 0.226 (in-sample avg dev_std = 0.500)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.509
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.49
SUFF++ for r=0.6 class 0 = 0.83 +- 0.260 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 1 = 0.799 +- 0.260 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 2 = 0.742 +- 0.260 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 all KL = 0.759 +- 0.260 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 all L1 = 0.793 +- 0.211 (in-sample avg dev_std = 0.396)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.533
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.516
SUFF++ for r=0.9 class 0 = 0.879 +- 0.177 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 class 1 = 0.862 +- 0.177 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 class 2 = 0.848 +- 0.177 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 all KL = 0.893 +- 0.177 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.9 all L1 = 0.863 +- 0.182 (in-sample avg dev_std = 0.259)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.524
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.527
SUFF++ for r=0.95 class 0 = 0.908 +- 0.135 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.95 class 1 = 0.909 +- 0.135 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.95 class 2 = 0.886 +- 0.135 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.95 all KL = 0.939 +- 0.135 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.95 all L1 = 0.903 +- 0.147 (in-sample avg dev_std = 0.189)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:12:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:07 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:08 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:09 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:09 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:10 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:12:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0013
ID Validation ACCURACY: 0.7004
ID Validation Loss: 1.8103
ID Test ACCURACY: 0.6444
ID Test Loss: 2.1469
OOD Validation ACCURACY: 0.6280
OOD Validation Loss: 2.2065
OOD Test ACCURACY: 0.5436
OOD Test Loss: 2.9759

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 0.6877
ID Validation Loss: 2.1026
ID Test ACCURACY: 0.6101
ID Test Loss: 2.4334
OOD Validation ACCURACY: 0.6336
OOD Validation Loss: 2.6554
OOD Test ACCURACY: 0.5642
OOD Test Loss: 3.4042

[0m[1;37mINFO[0m: [1mChartInfo 0.6444 0.5436 0.6101 0.5642 0.6877 0.6336[0mGOODTwitter(554)
Data example from id_test: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from id_test: (tensor([0, 1, 2]), tensor([138, 251, 165]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.61
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.598
NEC for r=0.3 class 0 = 0.278 +- 0.286 (in-sample avg dev_std = 0.311)
NEC for r=0.3 class 1 = 0.149 +- 0.286 (in-sample avg dev_std = 0.311)
NEC for r=0.3 class 2 = 0.241 +- 0.286 (in-sample avg dev_std = 0.311)
NEC for r=0.3 all KL = 0.209 +- 0.286 (in-sample avg dev_std = 0.311)
NEC for r=0.3 all L1 = 0.208 +- 0.244 (in-sample avg dev_std = 0.311)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.615
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.604
NEC for r=0.4 class 0 = 0.25 +- 0.279 (in-sample avg dev_std = 0.318)
NEC for r=0.4 class 1 = 0.152 +- 0.279 (in-sample avg dev_std = 0.318)
NEC for r=0.4 class 2 = 0.207 +- 0.279 (in-sample avg dev_std = 0.318)
NEC for r=0.4 all KL = 0.201 +- 0.279 (in-sample avg dev_std = 0.318)
NEC for r=0.4 all L1 = 0.193 +- 0.235 (in-sample avg dev_std = 0.318)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.632
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.636
NEC for r=0.6 class 0 = 0.177 +- 0.254 (in-sample avg dev_std = 0.294)
NEC for r=0.6 class 1 = 0.129 +- 0.254 (in-sample avg dev_std = 0.294)
NEC for r=0.6 class 2 = 0.194 +- 0.254 (in-sample avg dev_std = 0.294)
NEC for r=0.6 all KL = 0.17 +- 0.254 (in-sample avg dev_std = 0.294)
NEC for r=0.6 all L1 = 0.16 +- 0.214 (in-sample avg dev_std = 0.294)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.653
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 551
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.635
NEC for r=0.9 class 0 = 0.158 +- 0.206 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 1 = 0.117 +- 0.206 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 2 = 0.153 +- 0.206 (in-sample avg dev_std = 0.259)
NEC for r=0.9 all KL = 0.121 +- 0.206 (in-sample avg dev_std = 0.259)
NEC for r=0.9 all L1 = 0.138 +- 0.193 (in-sample avg dev_std = 0.259)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.644
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 551
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.634
NEC for r=0.95 class 0 = 0.139 +- 0.179 (in-sample avg dev_std = 0.235)
NEC for r=0.95 class 1 = 0.107 +- 0.179 (in-sample avg dev_std = 0.235)
NEC for r=0.95 class 2 = 0.143 +- 0.179 (in-sample avg dev_std = 0.235)
NEC for r=0.95 all KL = 0.1 +- 0.179 (in-sample avg dev_std = 0.235)
NEC for r=0.95 all L1 = 0.125 +- 0.181 (in-sample avg dev_std = 0.235)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.644
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 551
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.636
NEC for r=1.0 class 0 = 0.141 +- 0.177 (in-sample avg dev_std = 0.228)
NEC for r=1.0 class 1 = 0.106 +- 0.177 (in-sample avg dev_std = 0.228)
NEC for r=1.0 class 2 = 0.135 +- 0.177 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all KL = 0.095 +- 0.177 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all L1 = 0.123 +- 0.179 (in-sample avg dev_std = 0.228)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.556
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.547
NEC for r=0.3 class 0 = 0.287 +- 0.278 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 1 = 0.218 +- 0.278 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 2 = 0.245 +- 0.278 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all KL = 0.252 +- 0.278 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all L1 = 0.243 +- 0.237 (in-sample avg dev_std = 0.364)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.546
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.545
NEC for r=0.4 class 0 = 0.257 +- 0.275 (in-sample avg dev_std = 0.363)
NEC for r=0.4 class 1 = 0.223 +- 0.275 (in-sample avg dev_std = 0.363)
NEC for r=0.4 class 2 = 0.249 +- 0.275 (in-sample avg dev_std = 0.363)
NEC for r=0.4 all KL = 0.248 +- 0.275 (in-sample avg dev_std = 0.363)
NEC for r=0.4 all L1 = 0.239 +- 0.231 (in-sample avg dev_std = 0.363)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.545
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.537
NEC for r=0.6 class 0 = 0.207 +- 0.252 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 1 = 0.215 +- 0.252 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 2 = 0.21 +- 0.252 (in-sample avg dev_std = 0.331)
NEC for r=0.6 all KL = 0.213 +- 0.252 (in-sample avg dev_std = 0.331)
NEC for r=0.6 all L1 = 0.212 +- 0.218 (in-sample avg dev_std = 0.331)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.556
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.535
NEC for r=0.9 class 0 = 0.149 +- 0.211 (in-sample avg dev_std = 0.255)
NEC for r=0.9 class 1 = 0.19 +- 0.211 (in-sample avg dev_std = 0.255)
NEC for r=0.9 class 2 = 0.188 +- 0.211 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all KL = 0.148 +- 0.211 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all L1 = 0.179 +- 0.211 (in-sample avg dev_std = 0.255)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.549
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.537
NEC for r=0.95 class 0 = 0.14 +- 0.184 (in-sample avg dev_std = 0.235)
NEC for r=0.95 class 1 = 0.164 +- 0.184 (in-sample avg dev_std = 0.235)
NEC for r=0.95 class 2 = 0.177 +- 0.184 (in-sample avg dev_std = 0.235)
NEC for r=0.95 all KL = 0.119 +- 0.184 (in-sample avg dev_std = 0.235)
NEC for r=0.95 all L1 = 0.161 +- 0.194 (in-sample avg dev_std = 0.235)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.538
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.54
NEC for r=1.0 class 0 = 0.132 +- 0.174 (in-sample avg dev_std = 0.229)
NEC for r=1.0 class 1 = 0.155 +- 0.174 (in-sample avg dev_std = 0.229)
NEC for r=1.0 class 2 = 0.177 +- 0.174 (in-sample avg dev_std = 0.229)
NEC for r=1.0 all KL = 0.109 +- 0.174 (in-sample avg dev_std = 0.229)
NEC for r=1.0 all L1 = 0.154 +- 0.188 (in-sample avg dev_std = 0.229)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.61
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.542
SUFF++ for r=0.3 class 0 = 0.575 +- 0.294 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 class 1 = 0.737 +- 0.294 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 class 2 = 0.579 +- 0.294 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 all KL = 0.479 +- 0.294 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 all L1 = 0.65 +- 0.213 (in-sample avg dev_std = 0.608)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.615
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.571
SUFF++ for r=0.4 class 0 = 0.624 +- 0.300 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.4 class 1 = 0.74 +- 0.300 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.4 class 2 = 0.628 +- 0.300 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.4 all KL = 0.503 +- 0.300 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.4 all L1 = 0.678 +- 0.210 (in-sample avg dev_std = 0.587)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.632
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.608
SUFF++ for r=0.6 class 0 = 0.744 +- 0.295 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 1 = 0.811 +- 0.295 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 2 = 0.75 +- 0.295 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 all KL = 0.682 +- 0.295 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 all L1 = 0.776 +- 0.212 (in-sample avg dev_std = 0.451)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.651
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.634
SUFF++ for r=0.9 class 0 = 0.876 +- 0.161 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 class 1 = 0.91 +- 0.161 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 class 2 = 0.892 +- 0.161 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all KL = 0.913 +- 0.161 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all L1 = 0.896 +- 0.158 (in-sample avg dev_std = 0.228)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.638
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 445
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.638
SUFF++ for r=0.95 class 0 = 0.937 +- 0.086 (in-sample avg dev_std = 0.173)
SUFF++ for r=0.95 class 1 = 0.944 +- 0.086 (in-sample avg dev_std = 0.173)
SUFF++ for r=0.95 class 2 = 0.92 +- 0.086 (in-sample avg dev_std = 0.173)
SUFF++ for r=0.95 all KL = 0.961 +- 0.086 (in-sample avg dev_std = 0.173)
SUFF++ for r=0.95 all L1 = 0.936 +- 0.102 (in-sample avg dev_std = 0.173)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.556
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.498
SUFF++ for r=0.3 class 0 = 0.604 +- 0.260 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.3 class 1 = 0.631 +- 0.260 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.3 class 2 = 0.58 +- 0.260 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.3 all KL = 0.432 +- 0.260 (in-sample avg dev_std = 0.621)
SUFF++ for r=0.3 all L1 = 0.611 +- 0.197 (in-sample avg dev_std = 0.621)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.546
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.506
SUFF++ for r=0.4 class 0 = 0.658 +- 0.279 (in-sample avg dev_std = 0.565)
SUFF++ for r=0.4 class 1 = 0.671 +- 0.279 (in-sample avg dev_std = 0.565)
SUFF++ for r=0.4 class 2 = 0.628 +- 0.279 (in-sample avg dev_std = 0.565)
SUFF++ for r=0.4 all KL = 0.511 +- 0.279 (in-sample avg dev_std = 0.565)
SUFF++ for r=0.4 all L1 = 0.657 +- 0.204 (in-sample avg dev_std = 0.565)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.545
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.52
SUFF++ for r=0.6 class 0 = 0.765 +- 0.256 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 1 = 0.748 +- 0.256 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 class 2 = 0.727 +- 0.256 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all KL = 0.69 +- 0.256 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.6 all L1 = 0.747 +- 0.204 (in-sample avg dev_std = 0.433)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.556
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.54
SUFF++ for r=0.9 class 0 = 0.867 +- 0.168 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 1 = 0.849 +- 0.168 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 class 2 = 0.844 +- 0.168 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 all KL = 0.892 +- 0.168 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.9 all L1 = 0.852 +- 0.180 (in-sample avg dev_std = 0.255)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.549
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.542
SUFF++ for r=0.95 class 0 = 0.919 +- 0.117 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.95 class 1 = 0.896 +- 0.117 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.95 class 2 = 0.886 +- 0.117 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.95 all KL = 0.945 +- 0.117 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.95 all L1 = 0.899 +- 0.138 (in-sample avg dev_std = 0.176)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:16:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:41 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:43 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:43 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:44 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:45 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 18], node_perm=[10])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:16:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 5...
[0m[1;37mINFO[0m: [1mCheckpoint 5: 
-----------------------------------
Train ACCURACY: 0.9208
Train Loss: 0.2372
ID Validation ACCURACY: 0.6949
ID Validation Loss: 0.8254
ID Test ACCURACY: 0.6480
ID Test Loss: 0.9897
OOD Validation ACCURACY: 0.6174
OOD Validation Loss: 1.2560
OOD Test ACCURACY: 0.5669
OOD Test Loss: 1.6424

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 0.6823
ID Validation Loss: 2.1377
ID Test ACCURACY: 0.6588
ID Test Loss: 2.5118
OOD Validation ACCURACY: 0.6336
OOD Validation Loss: 2.6032
OOD Test ACCURACY: 0.5745
OOD Test Loss: 3.2801

[0m[1;37mINFO[0m: [1mChartInfo 0.6480 0.5669 0.6588 0.5745 0.6823 0.6336[0mGOODTwitter(554)
Data example from id_test: Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1], ori_edge_index=[2, 12], node_perm=[7])
Label distribution from id_test: (tensor([0, 1, 2]), tensor([138, 251, 165]))
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODTwitter(1457)
Data example from test: Data(x=[28, 768], edge_index=[2, 54], y=[1], idx=[1], sentence_tokens=[28], length=[1], domain_id=[1], ori_edge_index=[2, 54], node_perm=[28])
Label distribution from test: (tensor([0, 1, 2]), tensor([379, 719, 359]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.564
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.547
NEC for r=0.3 class 0 = 0.213 +- 0.090 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 1 = 0.162 +- 0.090 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 2 = 0.244 +- 0.090 (in-sample avg dev_std = 0.162)
NEC for r=0.3 all KL = 0.071 +- 0.090 (in-sample avg dev_std = 0.162)
NEC for r=0.3 all L1 = 0.199 +- 0.131 (in-sample avg dev_std = 0.162)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.59
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.591
NEC for r=0.4 class 0 = 0.225 +- 0.100 (in-sample avg dev_std = 0.173)
NEC for r=0.4 class 1 = 0.158 +- 0.100 (in-sample avg dev_std = 0.173)
NEC for r=0.4 class 2 = 0.241 +- 0.100 (in-sample avg dev_std = 0.173)
NEC for r=0.4 all KL = 0.075 +- 0.100 (in-sample avg dev_std = 0.173)
NEC for r=0.4 all L1 = 0.199 +- 0.136 (in-sample avg dev_std = 0.173)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.652
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.635
NEC for r=0.6 class 0 = 0.209 +- 0.088 (in-sample avg dev_std = 0.170)
NEC for r=0.6 class 1 = 0.157 +- 0.088 (in-sample avg dev_std = 0.170)
NEC for r=0.6 class 2 = 0.223 +- 0.088 (in-sample avg dev_std = 0.170)
NEC for r=0.6 all KL = 0.072 +- 0.088 (in-sample avg dev_std = 0.170)
NEC for r=0.6 all L1 = 0.19 +- 0.132 (in-sample avg dev_std = 0.170)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.673
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 551
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.643
NEC for r=0.9 class 0 = 0.162 +- 0.072 (in-sample avg dev_std = 0.131)
NEC for r=0.9 class 1 = 0.128 +- 0.072 (in-sample avg dev_std = 0.131)
NEC for r=0.9 class 2 = 0.15 +- 0.072 (in-sample avg dev_std = 0.131)
NEC for r=0.9 all KL = 0.048 +- 0.072 (in-sample avg dev_std = 0.131)
NEC for r=0.9 all L1 = 0.143 +- 0.121 (in-sample avg dev_std = 0.131)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.664
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 551
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.647
NEC for r=0.95 class 0 = 0.151 +- 0.070 (in-sample avg dev_std = 0.134)
NEC for r=0.95 class 1 = 0.119 +- 0.070 (in-sample avg dev_std = 0.134)
NEC for r=0.95 class 2 = 0.138 +- 0.070 (in-sample avg dev_std = 0.134)
NEC for r=0.95 all KL = 0.044 +- 0.070 (in-sample avg dev_std = 0.134)
NEC for r=0.95 all L1 = 0.133 +- 0.117 (in-sample avg dev_std = 0.134)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.646
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 551
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.643
NEC for r=1.0 class 0 = 0.14 +- 0.069 (in-sample avg dev_std = 0.129)
NEC for r=1.0 class 1 = 0.115 +- 0.069 (in-sample avg dev_std = 0.129)
NEC for r=1.0 class 2 = 0.133 +- 0.069 (in-sample avg dev_std = 0.129)
NEC for r=1.0 all KL = 0.042 +- 0.069 (in-sample avg dev_std = 0.129)
NEC for r=1.0 all L1 = 0.127 +- 0.116 (in-sample avg dev_std = 0.129)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.562
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.561
NEC for r=0.3 class 0 = 0.262 +- 0.106 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 1 = 0.222 +- 0.106 (in-sample avg dev_std = 0.198)
NEC for r=0.3 class 2 = 0.255 +- 0.106 (in-sample avg dev_std = 0.198)
NEC for r=0.3 all KL = 0.1 +- 0.106 (in-sample avg dev_std = 0.198)
NEC for r=0.3 all L1 = 0.241 +- 0.133 (in-sample avg dev_std = 0.198)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.555
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.567
NEC for r=0.4 class 0 = 0.256 +- 0.110 (in-sample avg dev_std = 0.207)
NEC for r=0.4 class 1 = 0.226 +- 0.110 (in-sample avg dev_std = 0.207)
NEC for r=0.4 class 2 = 0.25 +- 0.110 (in-sample avg dev_std = 0.207)
NEC for r=0.4 all KL = 0.105 +- 0.110 (in-sample avg dev_std = 0.207)
NEC for r=0.4 all L1 = 0.24 +- 0.140 (in-sample avg dev_std = 0.207)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.555
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.562
NEC for r=0.6 class 0 = 0.23 +- 0.111 (in-sample avg dev_std = 0.204)
NEC for r=0.6 class 1 = 0.218 +- 0.111 (in-sample avg dev_std = 0.204)
NEC for r=0.6 class 2 = 0.239 +- 0.111 (in-sample avg dev_std = 0.204)
NEC for r=0.6 all KL = 0.101 +- 0.111 (in-sample avg dev_std = 0.204)
NEC for r=0.6 all L1 = 0.226 +- 0.148 (in-sample avg dev_std = 0.204)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.566
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.563
NEC for r=0.9 class 0 = 0.192 +- 0.108 (in-sample avg dev_std = 0.184)
NEC for r=0.9 class 1 = 0.196 +- 0.108 (in-sample avg dev_std = 0.184)
NEC for r=0.9 class 2 = 0.187 +- 0.108 (in-sample avg dev_std = 0.184)
NEC for r=0.9 all KL = 0.085 +- 0.108 (in-sample avg dev_std = 0.184)
NEC for r=0.9 all L1 = 0.193 +- 0.150 (in-sample avg dev_std = 0.184)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.575
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.564
NEC for r=0.95 class 0 = 0.174 +- 0.101 (in-sample avg dev_std = 0.177)
NEC for r=0.95 class 1 = 0.182 +- 0.101 (in-sample avg dev_std = 0.177)
NEC for r=0.95 class 2 = 0.182 +- 0.101 (in-sample avg dev_std = 0.177)
NEC for r=0.95 all KL = 0.077 +- 0.101 (in-sample avg dev_std = 0.177)
NEC for r=0.95 all L1 = 0.18 +- 0.147 (in-sample avg dev_std = 0.177)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.574
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.57
NEC for r=1.0 class 0 = 0.172 +- 0.102 (in-sample avg dev_std = 0.173)
NEC for r=1.0 class 1 = 0.176 +- 0.102 (in-sample avg dev_std = 0.173)
NEC for r=1.0 class 2 = 0.173 +- 0.102 (in-sample avg dev_std = 0.173)
NEC for r=1.0 all KL = 0.075 +- 0.102 (in-sample avg dev_std = 0.173)
NEC for r=1.0 all L1 = 0.174 +- 0.146 (in-sample avg dev_std = 0.173)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.564
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 551
Effective ratio: 0.315 +- 0.015
Model Accuracy over intervened graphs for r=0.3 =  0.545
SUFF++ for r=0.3 class 0 = 0.716 +- 0.123 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.3 class 1 = 0.807 +- 0.123 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.3 class 2 = 0.698 +- 0.123 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.3 all KL = 0.879 +- 0.123 (in-sample avg dev_std = 0.268)
SUFF++ for r=0.3 all L1 = 0.752 +- 0.126 (in-sample avg dev_std = 0.268)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.59
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 551
Effective ratio: 0.416 +- 0.017
Model Accuracy over intervened graphs for r=0.4 =  0.564
SUFF++ for r=0.4 class 0 = 0.707 +- 0.123 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.4 class 1 = 0.795 +- 0.123 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.4 class 2 = 0.696 +- 0.123 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.4 all KL = 0.868 +- 0.123 (in-sample avg dev_std = 0.283)
SUFF++ for r=0.4 all L1 = 0.744 +- 0.126 (in-sample avg dev_std = 0.283)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.652
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 551
Effective ratio: 0.616 +- 0.016
Model Accuracy over intervened graphs for r=0.6 =  0.597
SUFF++ for r=0.6 class 0 = 0.718 +- 0.112 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.6 class 1 = 0.788 +- 0.112 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.6 class 2 = 0.733 +- 0.112 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.6 all KL = 0.868 +- 0.112 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.6 all L1 = 0.754 +- 0.126 (in-sample avg dev_std = 0.284)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.673
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 544
Effective ratio: 0.916 +- 0.017
Model Accuracy over intervened graphs for r=0.9 =  0.651
SUFF++ for r=0.9 class 0 = 0.855 +- 0.059 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 class 1 = 0.871 +- 0.059 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 class 2 = 0.858 +- 0.059 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 all KL = 0.951 +- 0.059 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 all L1 = 0.863 +- 0.105 (in-sample avg dev_std = 0.177)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.649
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 445
Effective ratio: 0.969 +- 0.017
Model Accuracy over intervened graphs for r=0.95 =  0.641
SUFF++ for r=0.95 class 0 = 0.91 +- 0.036 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.95 class 1 = 0.917 +- 0.036 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.95 class 2 = 0.919 +- 0.036 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.95 all KL = 0.974 +- 0.036 (in-sample avg dev_std = 0.152)
SUFF++ for r=0.95 all L1 = 0.916 +- 0.075 (in-sample avg dev_std = 0.152)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.562
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.005
Model Accuracy over intervened graphs for r=0.3 =  0.525
SUFF++ for r=0.3 class 0 = 0.666 +- 0.124 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 class 1 = 0.714 +- 0.124 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 class 2 = 0.673 +- 0.124 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 all KL = 0.826 +- 0.124 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 all L1 = 0.692 +- 0.118 (in-sample avg dev_std = 0.316)


ratio=0.4


Computing with masking

Model Accuracy of binarized graphs for r=0.4 =  0.555
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.408 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.53
SUFF++ for r=0.4 class 0 = 0.67 +- 0.130 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.4 class 1 = 0.699 +- 0.130 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.4 class 2 = 0.669 +- 0.130 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.4 all KL = 0.809 +- 0.130 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.4 all L1 = 0.684 +- 0.126 (in-sample avg dev_std = 0.331)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.555
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.004
Model Accuracy over intervened graphs for r=0.6 =  0.535
SUFF++ for r=0.6 class 0 = 0.699 +- 0.132 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.6 class 1 = 0.71 +- 0.132 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.6 class 2 = 0.69 +- 0.132 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.6 all KL = 0.819 +- 0.132 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.6 all L1 = 0.702 +- 0.142 (in-sample avg dev_std = 0.319)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.566
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.908 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.558
SUFF++ for r=0.9 class 0 = 0.82 +- 0.104 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 class 1 = 0.805 +- 0.104 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 class 2 = 0.812 +- 0.104 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all KL = 0.919 +- 0.104 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all L1 = 0.81 +- 0.146 (in-sample avg dev_std = 0.189)


ratio=0.95


Computing with masking

Model Accuracy of binarized graphs for r=0.95 =  0.575
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.959 +- 0.006
Model Accuracy over intervened graphs for r=0.95 =  0.569
SUFF++ for r=0.95 class 0 = 0.891 +- 0.059 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.95 class 1 = 0.879 +- 0.059 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.95 class 2 = 0.885 +- 0.059 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.95 all KL = 0.966 +- 0.059 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.95 all L1 = 0.883 +- 0.106 (in-sample avg dev_std = 0.129)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.211, 0.194, 0.149, 0.086, 0.08, 0.084], 'all_L1': [0.235, 0.21, 0.167, 0.118, 0.116, 0.12]}), defaultdict(<class 'list'>, {'all_KL': [0.248, 0.214, 0.175, 0.116, 0.105, 0.102], 'all_L1': [0.21, 0.178, 0.15, 0.124, 0.12, 0.116]}), defaultdict(<class 'list'>, {'all_KL': [0.213, 0.213, 0.167, 0.118, 0.113, 0.106], 'all_L1': [0.223, 0.211, 0.169, 0.137, 0.135, 0.13]}), defaultdict(<class 'list'>, {'all_KL': [0.209, 0.201, 0.17, 0.121, 0.1, 0.095], 'all_L1': [0.208, 0.193, 0.16, 0.138, 0.125, 0.123]}), defaultdict(<class 'list'>, {'all_KL': [0.071, 0.075, 0.072, 0.048, 0.044, 0.042], 'all_L1': [0.199, 0.199, 0.19, 0.143, 0.133, 0.127]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.593, 0.626, 0.748, 0.919, 0.965, 1.0], 'all_L1': [0.673, 0.705, 0.791, 0.891, 0.935, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.374, 0.431, 0.615, 0.899, 0.956, 1.0], 'all_L1': [0.625, 0.674, 0.771, 0.895, 0.938, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.545, 0.607, 0.735, 0.916, 0.96, 1.0], 'all_L1': [0.661, 0.708, 0.782, 0.892, 0.937, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.479, 0.503, 0.682, 0.913, 0.961, 1.0], 'all_L1': [0.65, 0.678, 0.776, 0.896, 0.936, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.879, 0.868, 0.868, 0.951, 0.974, 1.0], 'all_L1': [0.752, 0.744, 0.754, 0.863, 0.916, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]

Eval split test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.211, 0.193, 0.145, 0.093, 0.091, 0.087], 'all_L1': [0.223, 0.204, 0.172, 0.133, 0.129, 0.125]}), defaultdict(<class 'list'>, {'all_KL': [0.263, 0.232, 0.205, 0.119, 0.108, 0.097], 'all_L1': [0.204, 0.186, 0.173, 0.142, 0.136, 0.131]}), defaultdict(<class 'list'>, {'all_KL': [0.247, 0.212, 0.173, 0.131, 0.126, 0.124], 'all_L1': [0.225, 0.201, 0.174, 0.157, 0.154, 0.152]}), defaultdict(<class 'list'>, {'all_KL': [0.252, 0.248, 0.213, 0.148, 0.119, 0.109], 'all_L1': [0.243, 0.239, 0.212, 0.179, 0.161, 0.154]}), defaultdict(<class 'list'>, {'all_KL': [0.1, 0.105, 0.101, 0.085, 0.077, 0.075], 'all_L1': [0.241, 0.24, 0.226, 0.193, 0.18, 0.174]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.629, 0.673, 0.775, 0.928, 0.962, 1.0], 'all_L1': [0.697, 0.73, 0.79, 0.886, 0.92, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.443, 0.568, 0.763, 0.913, 0.95, 1.0], 'all_L1': [0.671, 0.737, 0.822, 0.886, 0.915, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.574, 0.628, 0.759, 0.893, 0.939, 1.0], 'all_L1': [0.683, 0.72, 0.793, 0.863, 0.903, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.432, 0.511, 0.69, 0.892, 0.945, 1.0], 'all_L1': [0.611, 0.657, 0.747, 0.852, 0.899, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.826, 0.809, 0.819, 0.919, 0.966, 1.0], 'all_L1': [0.692, 0.684, 0.702, 0.81, 0.883, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.215 +- 0.013, 0.198 +- 0.012, 0.167 +- 0.013, 0.132 +- 0.009, 0.126 +- 0.007, 0.123 +- 0.005
nec class all_KL  =  0.190 +- 0.061, 0.179 +- 0.053, 0.147 +- 0.038, 0.098 +- 0.028, 0.088 +- 0.025, 0.086 +- 0.023
nec_acc_int  =  0.591 +- 0.032, 0.607 +- 0.017, 0.632 +- 0.011, 0.640 +- 0.009, 0.641 +- 0.009, 0.641 +- 0.011
suff++ class all_L1  =  0.672 +- 0.043, 0.702 +- 0.025, 0.775 +- 0.012, 0.887 +- 0.012, 0.932 +- 0.008, 1.000 +- 0.000
suff++ class all_KL  =  0.574 +- 0.169, 0.607 +- 0.149, 0.730 +- 0.084, 0.920 +- 0.017, 0.963 +- 0.006, 1.000 +- 0.000
suff++_acc_int  =  0.538 +- 0.013, 0.565 +- 0.011, 0.602 +- 0.009, 0.643 +- 0.012, 0.637 +- 0.012

Eval split test
nec class all_L1  =  0.227 +- 0.014, 0.214 +- 0.022, 0.191 +- 0.023, 0.161 +- 0.022, 0.152 +- 0.018, 0.147 +- 0.018
nec class all_KL  =  0.215 +- 0.060, 0.198 +- 0.050, 0.167 +- 0.041, 0.115 +- 0.023, 0.104 +- 0.018, 0.098 +- 0.017
nec_acc_int  =  0.538 +- 0.022, 0.539 +- 0.020, 0.536 +- 0.018, 0.540 +- 0.013, 0.541 +- 0.013, 0.543 +- 0.015
suff++ class all_L1  =  0.671 +- 0.031, 0.706 +- 0.030, 0.771 +- 0.042, 0.859 +- 0.028, 0.904 +- 0.013, 1.000 +- 0.000
suff++ class all_KL  =  0.581 +- 0.144, 0.638 +- 0.102, 0.761 +- 0.041, 0.909 +- 0.014, 0.952 +- 0.010, 1.000 +- 0.000
suff++_acc_int  =  0.502 +- 0.026, 0.508 +- 0.024, 0.523 +- 0.018, 0.540 +- 0.013, 0.545 +- 0.014


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.444 +- 0.020, 0.450 +- 0.017, 0.471 +- 0.006, 0.510 +- 0.005, 0.529 +- 0.004, 0.562 +- 0.002
Faith. Armon (L1)= 		  =  0.325 +- 0.014, 0.309 +- 0.016, 0.275 +- 0.017, 0.230 +- 0.014, 0.222 +- 0.011, 0.219 +- 0.008
Faith. GMean (L1)= 	  =  0.380 +- 0.013, 0.373 +- 0.016, 0.360 +- 0.013, 0.342 +- 0.011, 0.342 +- 0.009, 0.351 +- 0.007
Faith. Aritm (KL)= 		  =  0.382 +- 0.056, 0.393 +- 0.052, 0.438 +- 0.026, 0.509 +- 0.007, 0.526 +- 0.010, 0.543 +- 0.012
Faith. Armon (KL)= 		  =  0.268 +- 0.068, 0.265 +- 0.064, 0.240 +- 0.054, 0.175 +- 0.047, 0.161 +- 0.042, 0.157 +- 0.040
Faith. GMean (KL)= 	  =  0.313 +- 0.036, 0.317 +- 0.037, 0.321 +- 0.036, 0.296 +- 0.045, 0.288 +- 0.044, 0.290 +- 0.044

Eval split test
Faith. Aritm (L1)= 		  =  0.449 +- 0.015, 0.460 +- 0.006, 0.481 +- 0.011, 0.510 +- 0.005, 0.528 +- 0.003, 0.574 +- 0.009
Faith. Armon (L1)= 		  =  0.339 +- 0.015, 0.327 +- 0.022, 0.305 +- 0.026, 0.270 +- 0.030, 0.260 +- 0.026, 0.256 +- 0.027
Faith. GMean (L1)= 	  =  0.390 +- 0.013, 0.388 +- 0.012, 0.383 +- 0.013, 0.370 +- 0.020, 0.370 +- 0.019, 0.383 +- 0.023
Faith. Aritm (KL)= 		  =  0.398 +- 0.045, 0.418 +- 0.027, 0.464 +- 0.011, 0.512 +- 0.006, 0.528 +- 0.004, 0.549 +- 0.009
Faith. Armon (KL)= 		  =  0.298 +- 0.061, 0.293 +- 0.055, 0.271 +- 0.054, 0.204 +- 0.037, 0.187 +- 0.029, 0.179 +- 0.028
Faith. GMean (KL)= 	  =  0.340 +- 0.031, 0.347 +- 0.028, 0.353 +- 0.038, 0.322 +- 0.031, 0.314 +- 0.026, 0.313 +- 0.027
Computed for split load_split = id



Completed in  0:22:49.662682  for GSATvGIN GOODTwitter/length



DONE GSAT GOODTwitter/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:21:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:29 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:32 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:36 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:38 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:21:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ROC-AUC: 0.9716
Train Loss: 0.0653
ID Validation ROC-AUC: 0.8412
ID Validation Loss: 0.1394
ID Test ROC-AUC: 0.7964
ID Test Loss: 0.1371
OOD Validation ROC-AUC: 0.7570
OOD Validation Loss: 0.1376
OOD Test ROC-AUC: 0.7331
OOD Test Loss: 0.0930

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ROC-AUC: 0.8810
Train Loss: 0.1019
ID Validation ROC-AUC: 0.8118
ID Validation Loss: 0.1338
ID Test ROC-AUC: 0.8103
ID Test Loss: 0.1133
OOD Validation ROC-AUC: 0.7797
OOD Validation Loss: 0.1199
OOD Test ROC-AUC: 0.7043
OOD Test Loss: 0.0856

[0m[1;37mINFO[0m: [1mChartInfo 0.7964 0.7331 0.8103 0.7043 0.8118 0.7797[0mGOODHIV(4112)
Data example from id_test: Data(x=[23, 9], edge_index=[2, 48], edge_attr=[48, 3], y=[1, 1], smiles='Cc1occc1C(=S)Nc1ccc(Cl)c(C(=O)OCC(C)C)c1', idx=[1], scaffold='S=C(Nc1ccccc1)c1ccoc1', domain_id=[1], env_id=[1], ori_edge_index=[2, 48], node_perm=[23])
Label distribution from id_test: (tensor([0., 1.]), tensor([3976,  136]))
[1;34mDEBUG[0m: 05/08/2024 04:21:43 PM : [1mUnbalanced warning for GOODHIV (id_test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([136, 136]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 05/08/2024 04:21:45 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.71
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 272
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.662
NEC for r=0.3 class 0.0 = 0.044 +- 0.039 (in-sample avg dev_std = 0.086)
NEC for r=0.3 class 1.0 = 0.089 +- 0.039 (in-sample avg dev_std = 0.086)
NEC for r=0.3 all KL = 0.024 +- 0.039 (in-sample avg dev_std = 0.086)
NEC for r=0.3 all L1 = 0.066 +- 0.080 (in-sample avg dev_std = 0.086)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.753
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 272
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.721
NEC for r=0.4 class 0.0 = 0.043 +- 0.062 (in-sample avg dev_std = 0.110)
NEC for r=0.4 class 1.0 = 0.115 +- 0.062 (in-sample avg dev_std = 0.110)
NEC for r=0.4 all KL = 0.03 +- 0.062 (in-sample avg dev_std = 0.110)
NEC for r=0.4 all L1 = 0.079 +- 0.107 (in-sample avg dev_std = 0.110)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.786
NEC for r=0.6 class 0.0 = 0.042 +- 0.109 (in-sample avg dev_std = 0.167)
NEC for r=0.6 class 1.0 = 0.154 +- 0.109 (in-sample avg dev_std = 0.167)
NEC for r=0.6 all KL = 0.05 +- 0.109 (in-sample avg dev_std = 0.167)
NEC for r=0.6 all L1 = 0.098 +- 0.132 (in-sample avg dev_std = 0.167)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.808
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.8
NEC for r=0.9 class 0.0 = 0.044 +- 0.165 (in-sample avg dev_std = 0.221)
NEC for r=0.9 class 1.0 = 0.187 +- 0.165 (in-sample avg dev_std = 0.221)
NEC for r=0.9 all KL = 0.085 +- 0.165 (in-sample avg dev_std = 0.221)
NEC for r=0.9 all L1 = 0.116 +- 0.159 (in-sample avg dev_std = 0.221)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.815
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 272
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.797
NEC for r=0.95 class 0.0 = 0.041 +- 0.190 (in-sample avg dev_std = 0.253)
NEC for r=0.95 class 1.0 = 0.209 +- 0.190 (in-sample avg dev_std = 0.253)
NEC for r=0.95 all KL = 0.1 +- 0.190 (in-sample avg dev_std = 0.253)
NEC for r=0.95 all L1 = 0.125 +- 0.172 (in-sample avg dev_std = 0.253)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.814
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 272
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.797
NEC for r=1.0 class 0.0 = 0.047 +- 0.173 (in-sample avg dev_std = 0.241)
NEC for r=1.0 class 1.0 = 0.196 +- 0.173 (in-sample avg dev_std = 0.241)
NEC for r=1.0 all KL = 0.095 +- 0.173 (in-sample avg dev_std = 0.241)
NEC for r=1.0 all L1 = 0.121 +- 0.162 (in-sample avg dev_std = 0.241)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.626
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.601
NEC for r=0.3 class 0.0 = 0.06 +- 0.058 (in-sample avg dev_std = 0.106)
NEC for r=0.3 class 1.0 = 0.1 +- 0.058 (in-sample avg dev_std = 0.106)
NEC for r=0.3 all KL = 0.031 +- 0.058 (in-sample avg dev_std = 0.106)
NEC for r=0.3 all L1 = 0.08 +- 0.097 (in-sample avg dev_std = 0.106)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.639
NEC for r=0.4 class 0.0 = 0.053 +- 0.056 (in-sample avg dev_std = 0.104)
NEC for r=0.4 class 1.0 = 0.102 +- 0.056 (in-sample avg dev_std = 0.104)
NEC for r=0.4 all KL = 0.028 +- 0.056 (in-sample avg dev_std = 0.104)
NEC for r=0.4 all L1 = 0.077 +- 0.096 (in-sample avg dev_std = 0.104)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.709
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.665
NEC for r=0.6 class 0.0 = 0.051 +- 0.098 (in-sample avg dev_std = 0.149)
NEC for r=0.6 class 1.0 = 0.121 +- 0.098 (in-sample avg dev_std = 0.149)
NEC for r=0.6 all KL = 0.04 +- 0.098 (in-sample avg dev_std = 0.149)
NEC for r=0.6 all L1 = 0.086 +- 0.114 (in-sample avg dev_std = 0.149)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.723
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.692
NEC for r=0.9 class 0.0 = 0.038 +- 0.114 (in-sample avg dev_std = 0.168)
NEC for r=0.9 class 1.0 = 0.132 +- 0.114 (in-sample avg dev_std = 0.168)
NEC for r=0.9 all KL = 0.055 +- 0.114 (in-sample avg dev_std = 0.168)
NEC for r=0.9 all L1 = 0.085 +- 0.125 (in-sample avg dev_std = 0.168)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.733
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 162
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.709
NEC for r=0.95 class 0.0 = 0.03 +- 0.142 (in-sample avg dev_std = 0.167)
NEC for r=0.95 class 1.0 = 0.14 +- 0.142 (in-sample avg dev_std = 0.167)
NEC for r=0.95 all KL = 0.059 +- 0.142 (in-sample avg dev_std = 0.167)
NEC for r=0.95 all L1 = 0.085 +- 0.140 (in-sample avg dev_std = 0.167)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.744
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.717
NEC for r=1.0 class 0.0 = 0.029 +- 0.141 (in-sample avg dev_std = 0.172)
NEC for r=1.0 class 1.0 = 0.143 +- 0.141 (in-sample avg dev_std = 0.172)
NEC for r=1.0 all KL = 0.061 +- 0.141 (in-sample avg dev_std = 0.172)
NEC for r=1.0 all L1 = 0.086 +- 0.140 (in-sample avg dev_std = 0.172)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.717
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 260
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.604
SUFF++ for r=0.3 class 0.0 = 0.946 +- 0.070 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.3 class 1.0 = 0.883 +- 0.070 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.3 all KL = 0.957 +- 0.070 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.3 all L1 = 0.913 +- 0.105 (in-sample avg dev_std = 0.146)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 271
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.654
SUFF++ for r=0.4 class 0.0 = 0.945 +- 0.082 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.4 class 1.0 = 0.844 +- 0.082 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.4 all KL = 0.948 +- 0.082 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.4 all L1 = 0.894 +- 0.130 (in-sample avg dev_std = 0.148)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.755
SUFF++ for r=0.6 class 0.0 = 0.959 +- 0.109 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.6 class 1.0 = 0.831 +- 0.109 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.6 all KL = 0.947 +- 0.109 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.6 all L1 = 0.895 +- 0.143 (in-sample avg dev_std = 0.160)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.808
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.802
SUFF++ for r=0.9 class 0.0 = 0.986 +- 0.040 (in-sample avg dev_std = 0.093)
SUFF++ for r=0.9 class 1.0 = 0.945 +- 0.040 (in-sample avg dev_std = 0.093)
SUFF++ for r=0.9 all KL = 0.989 +- 0.040 (in-sample avg dev_std = 0.093)
SUFF++ for r=0.9 all L1 = 0.965 +- 0.066 (in-sample avg dev_std = 0.093)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.816
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 270
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.816
SUFF++ for r=0.95 class 0.0 = 0.988 +- 0.039 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.95 class 1.0 = 0.947 +- 0.039 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.95 all KL = 0.988 +- 0.039 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.95 all L1 = 0.967 +- 0.063 (in-sample avg dev_std = 0.103)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.622
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 147
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.582
SUFF++ for r=0.3 class 0.0 = 0.939 +- 0.077 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.3 class 1.0 = 0.887 +- 0.077 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.3 all KL = 0.959 +- 0.077 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.3 all L1 = 0.914 +- 0.113 (in-sample avg dev_std = 0.115)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.591
SUFF++ for r=0.4 class 0.0 = 0.931 +- 0.087 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.4 class 1.0 = 0.866 +- 0.087 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.4 all KL = 0.952 +- 0.087 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.4 all L1 = 0.898 +- 0.127 (in-sample avg dev_std = 0.139)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.709
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.645
SUFF++ for r=0.6 class 0.0 = 0.944 +- 0.127 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.6 class 1.0 = 0.841 +- 0.127 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.6 all KL = 0.938 +- 0.127 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.6 all L1 = 0.892 +- 0.145 (in-sample avg dev_std = 0.202)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.723
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.707
SUFF++ for r=0.9 class 0.0 = 0.978 +- 0.071 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.9 class 1.0 = 0.943 +- 0.071 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.9 all KL = 0.981 +- 0.071 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.9 all L1 = 0.96 +- 0.082 (in-sample avg dev_std = 0.115)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.73
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 161
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.732
SUFF++ for r=0.95 class 0.0 = 0.994 +- 0.075 (in-sample avg dev_std = 0.055)
SUFF++ for r=0.95 class 1.0 = 0.961 +- 0.075 (in-sample avg dev_std = 0.055)
SUFF++ for r=0.95 all KL = 0.985 +- 0.075 (in-sample avg dev_std = 0.055)
SUFF++ for r=0.95 all L1 = 0.978 +- 0.088 (in-sample avg dev_std = 0.055)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:22:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:47 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:50 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:53 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:56 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:22:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ROC-AUC: 0.9881
Train Loss: 0.0502
ID Validation ROC-AUC: 0.8421
ID Validation Loss: 0.1583
ID Test ROC-AUC: 0.7976
ID Test Loss: 0.1471
OOD Validation ROC-AUC: 0.7386
OOD Validation Loss: 0.1672
OOD Test ROC-AUC: 0.7071
OOD Test Loss: 0.1073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 77...
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ROC-AUC: 0.9117
Train Loss: 0.0938
ID Validation ROC-AUC: 0.8079
ID Validation Loss: 0.1347
ID Test ROC-AUC: 0.7889
ID Test Loss: 0.1161
OOD Validation ROC-AUC: 0.7802
OOD Validation Loss: 0.1159
OOD Test ROC-AUC: 0.6996
OOD Test Loss: 0.0890

[0m[1;37mINFO[0m: [1mChartInfo 0.7976 0.7071 0.7889 0.6996 0.8079 0.7802[0mGOODHIV(4112)
Data example from id_test: Data(x=[23, 9], edge_index=[2, 48], edge_attr=[48, 3], y=[1, 1], smiles='Cc1occc1C(=S)Nc1ccc(Cl)c(C(=O)OCC(C)C)c1', idx=[1], scaffold='S=C(Nc1ccccc1)c1ccoc1', domain_id=[1], env_id=[1], ori_edge_index=[2, 48], node_perm=[23])
Label distribution from id_test: (tensor([0., 1.]), tensor([3976,  136]))
[1;34mDEBUG[0m: 05/08/2024 04:23:00 PM : [1mUnbalanced warning for GOODHIV (id_test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([136, 136]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 05/08/2024 04:23:01 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.7
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 272
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.692
NEC for r=0.3 class 0.0 = 0.047 +- 0.057 (in-sample avg dev_std = 0.092)
NEC for r=0.3 class 1.0 = 0.109 +- 0.057 (in-sample avg dev_std = 0.092)
NEC for r=0.3 all KL = 0.031 +- 0.057 (in-sample avg dev_std = 0.092)
NEC for r=0.3 all L1 = 0.078 +- 0.104 (in-sample avg dev_std = 0.092)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.726
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 272
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.695
NEC for r=0.4 class 0.0 = 0.05 +- 0.077 (in-sample avg dev_std = 0.122)
NEC for r=0.4 class 1.0 = 0.129 +- 0.077 (in-sample avg dev_std = 0.122)
NEC for r=0.4 all KL = 0.041 +- 0.077 (in-sample avg dev_std = 0.122)
NEC for r=0.4 all L1 = 0.09 +- 0.123 (in-sample avg dev_std = 0.122)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.766
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.722
NEC for r=0.6 class 0.0 = 0.043 +- 0.135 (in-sample avg dev_std = 0.189)
NEC for r=0.6 class 1.0 = 0.175 +- 0.135 (in-sample avg dev_std = 0.189)
NEC for r=0.6 all KL = 0.067 +- 0.135 (in-sample avg dev_std = 0.189)
NEC for r=0.6 all L1 = 0.109 +- 0.160 (in-sample avg dev_std = 0.189)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.792
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.749
NEC for r=0.9 class 0.0 = 0.051 +- 0.215 (in-sample avg dev_std = 0.278)
NEC for r=0.9 class 1.0 = 0.221 +- 0.215 (in-sample avg dev_std = 0.278)
NEC for r=0.9 all KL = 0.122 +- 0.215 (in-sample avg dev_std = 0.278)
NEC for r=0.9 all L1 = 0.136 +- 0.192 (in-sample avg dev_std = 0.278)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.799
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 272
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.759
NEC for r=0.95 class 0.0 = 0.055 +- 0.219 (in-sample avg dev_std = 0.262)
NEC for r=0.95 class 1.0 = 0.217 +- 0.219 (in-sample avg dev_std = 0.262)
NEC for r=0.95 all KL = 0.13 +- 0.219 (in-sample avg dev_std = 0.262)
NEC for r=0.95 all L1 = 0.136 +- 0.189 (in-sample avg dev_std = 0.262)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.807
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 272
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.755
NEC for r=1.0 class 0.0 = 0.057 +- 0.241 (in-sample avg dev_std = 0.292)
NEC for r=1.0 class 1.0 = 0.23 +- 0.241 (in-sample avg dev_std = 0.292)
NEC for r=1.0 all KL = 0.148 +- 0.241 (in-sample avg dev_std = 0.292)
NEC for r=1.0 all L1 = 0.143 +- 0.197 (in-sample avg dev_std = 0.292)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.728
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.668
NEC for r=0.3 class 0.0 = 0.03 +- 0.053 (in-sample avg dev_std = 0.089)
NEC for r=0.3 class 1.0 = 0.075 +- 0.053 (in-sample avg dev_std = 0.089)
NEC for r=0.3 all KL = 0.022 +- 0.053 (in-sample avg dev_std = 0.089)
NEC for r=0.3 all L1 = 0.053 +- 0.077 (in-sample avg dev_std = 0.089)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.733
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.673
NEC for r=0.4 class 0.0 = 0.026 +- 0.060 (in-sample avg dev_std = 0.101)
NEC for r=0.4 class 1.0 = 0.106 +- 0.060 (in-sample avg dev_std = 0.101)
NEC for r=0.4 all KL = 0.028 +- 0.060 (in-sample avg dev_std = 0.101)
NEC for r=0.4 all L1 = 0.066 +- 0.108 (in-sample avg dev_std = 0.101)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.729
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.655
NEC for r=0.6 class 0.0 = 0.035 +- 0.122 (in-sample avg dev_std = 0.160)
NEC for r=0.6 class 1.0 = 0.148 +- 0.122 (in-sample avg dev_std = 0.160)
NEC for r=0.6 all KL = 0.056 +- 0.122 (in-sample avg dev_std = 0.160)
NEC for r=0.6 all L1 = 0.092 +- 0.153 (in-sample avg dev_std = 0.160)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.731
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.704
NEC for r=0.9 class 0.0 = 0.025 +- 0.186 (in-sample avg dev_std = 0.209)
NEC for r=0.9 class 1.0 = 0.155 +- 0.186 (in-sample avg dev_std = 0.209)
NEC for r=0.9 all KL = 0.081 +- 0.186 (in-sample avg dev_std = 0.209)
NEC for r=0.9 all L1 = 0.09 +- 0.159 (in-sample avg dev_std = 0.209)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.747
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 162
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.686
NEC for r=0.95 class 0.0 = 0.028 +- 0.225 (in-sample avg dev_std = 0.254)
NEC for r=0.95 class 1.0 = 0.177 +- 0.225 (in-sample avg dev_std = 0.254)
NEC for r=0.95 all KL = 0.1 +- 0.225 (in-sample avg dev_std = 0.254)
NEC for r=0.95 all L1 = 0.103 +- 0.182 (in-sample avg dev_std = 0.254)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.749
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.701
NEC for r=1.0 class 0.0 = 0.024 +- 0.216 (in-sample avg dev_std = 0.253)
NEC for r=1.0 class 1.0 = 0.176 +- 0.216 (in-sample avg dev_std = 0.253)
NEC for r=1.0 all KL = 0.098 +- 0.216 (in-sample avg dev_std = 0.253)
NEC for r=1.0 all L1 = 0.1 +- 0.178 (in-sample avg dev_std = 0.253)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.693
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 254
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.59
SUFF++ for r=0.3 class 0.0 = 0.947 +- 0.093 (in-sample avg dev_std = 0.156)
SUFF++ for r=0.3 class 1.0 = 0.856 +- 0.093 (in-sample avg dev_std = 0.156)
SUFF++ for r=0.3 all KL = 0.948 +- 0.093 (in-sample avg dev_std = 0.156)
SUFF++ for r=0.3 all L1 = 0.902 +- 0.130 (in-sample avg dev_std = 0.156)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.726
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 271
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.665
SUFF++ for r=0.4 class 0.0 = 0.946 +- 0.115 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.4 class 1.0 = 0.831 +- 0.115 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.4 all KL = 0.938 +- 0.115 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.4 all L1 = 0.888 +- 0.154 (in-sample avg dev_std = 0.168)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.766
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.728
SUFF++ for r=0.6 class 0.0 = 0.956 +- 0.127 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.6 class 1.0 = 0.82 +- 0.127 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.6 all KL = 0.934 +- 0.127 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.6 all L1 = 0.888 +- 0.158 (in-sample avg dev_std = 0.196)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.792
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.785
SUFF++ for r=0.9 class 0.0 = 0.983 +- 0.085 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.9 class 1.0 = 0.934 +- 0.085 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.9 all KL = 0.975 +- 0.085 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.9 all L1 = 0.958 +- 0.093 (in-sample avg dev_std = 0.129)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.802
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 270
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.792
SUFF++ for r=0.95 class 0.0 = 0.986 +- 0.081 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.95 class 1.0 = 0.942 +- 0.081 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.95 all KL = 0.98 +- 0.081 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.95 all L1 = 0.964 +- 0.084 (in-sample avg dev_std = 0.131)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.733
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 149
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.626
SUFF++ for r=0.3 class 0.0 = 0.96 +- 0.075 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.3 class 1.0 = 0.907 +- 0.075 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.3 all KL = 0.963 +- 0.075 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.3 all L1 = 0.934 +- 0.095 (in-sample avg dev_std = 0.116)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.733
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.628
SUFF++ for r=0.4 class 0.0 = 0.969 +- 0.096 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.4 class 1.0 = 0.867 +- 0.096 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.4 all KL = 0.955 +- 0.096 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.4 all L1 = 0.918 +- 0.135 (in-sample avg dev_std = 0.147)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.729
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.665
SUFF++ for r=0.6 class 0.0 = 0.973 +- 0.122 (in-sample avg dev_std = 0.162)
SUFF++ for r=0.6 class 1.0 = 0.85 +- 0.122 (in-sample avg dev_std = 0.162)
SUFF++ for r=0.6 all KL = 0.947 +- 0.122 (in-sample avg dev_std = 0.162)
SUFF++ for r=0.6 all L1 = 0.911 +- 0.158 (in-sample avg dev_std = 0.162)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.731
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.717
SUFF++ for r=0.9 class 0.0 = 0.993 +- 0.068 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.9 class 1.0 = 0.936 +- 0.068 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.9 all KL = 0.981 +- 0.068 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.9 all L1 = 0.964 +- 0.082 (in-sample avg dev_std = 0.124)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.744
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 161
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.736
SUFF++ for r=0.95 class 0.0 = 0.995 +- 0.066 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.95 class 1.0 = 0.931 +- 0.066 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.95 all KL = 0.98 +- 0.066 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.95 all L1 = 0.963 +- 0.085 (in-sample avg dev_std = 0.119)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:24:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:02 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:05 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:08 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:11 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:24:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ROC-AUC: 0.9869
Train Loss: 0.0538
ID Validation ROC-AUC: 0.8431
ID Validation Loss: 0.1490
ID Test ROC-AUC: 0.8115
ID Test Loss: 0.1338
OOD Validation ROC-AUC: 0.7762
OOD Validation Loss: 0.1394
OOD Test ROC-AUC: 0.7383
OOD Test Loss: 0.0997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ROC-AUC: 0.9764
Train Loss: 0.0628
ID Validation ROC-AUC: 0.8350
ID Validation Loss: 0.1429
ID Test ROC-AUC: 0.8089
ID Test Loss: 0.1287
OOD Validation ROC-AUC: 0.7881
OOD Validation Loss: 0.1266
OOD Test ROC-AUC: 0.7471
OOD Test Loss: 0.0945

[0m[1;37mINFO[0m: [1mChartInfo 0.8115 0.7383 0.8089 0.7471 0.8350 0.7881[0mGOODHIV(4112)
Data example from id_test: Data(x=[23, 9], edge_index=[2, 48], edge_attr=[48, 3], y=[1, 1], smiles='Cc1occc1C(=S)Nc1ccc(Cl)c(C(=O)OCC(C)C)c1', idx=[1], scaffold='S=C(Nc1ccccc1)c1ccoc1', domain_id=[1], env_id=[1], ori_edge_index=[2, 48], node_perm=[23])
Label distribution from id_test: (tensor([0., 1.]), tensor([3976,  136]))
[1;34mDEBUG[0m: 05/08/2024 04:24:15 PM : [1mUnbalanced warning for GOODHIV (id_test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([136, 136]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 05/08/2024 04:24:16 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.757
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 272
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.688
NEC for r=0.3 class 0.0 = 0.062 +- 0.072 (in-sample avg dev_std = 0.117)
NEC for r=0.3 class 1.0 = 0.146 +- 0.072 (in-sample avg dev_std = 0.117)
NEC for r=0.3 all KL = 0.038 +- 0.072 (in-sample avg dev_std = 0.117)
NEC for r=0.3 all L1 = 0.104 +- 0.120 (in-sample avg dev_std = 0.117)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.764
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 272
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.717
NEC for r=0.4 class 0.0 = 0.064 +- 0.077 (in-sample avg dev_std = 0.142)
NEC for r=0.4 class 1.0 = 0.149 +- 0.077 (in-sample avg dev_std = 0.142)
NEC for r=0.4 all KL = 0.045 +- 0.077 (in-sample avg dev_std = 0.142)
NEC for r=0.4 all L1 = 0.107 +- 0.120 (in-sample avg dev_std = 0.142)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.799
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.773
NEC for r=0.6 class 0.0 = 0.06 +- 0.120 (in-sample avg dev_std = 0.198)
NEC for r=0.6 class 1.0 = 0.177 +- 0.120 (in-sample avg dev_std = 0.198)
NEC for r=0.6 all KL = 0.067 +- 0.120 (in-sample avg dev_std = 0.198)
NEC for r=0.6 all L1 = 0.118 +- 0.139 (in-sample avg dev_std = 0.198)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.827
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.79
NEC for r=0.9 class 0.0 = 0.058 +- 0.209 (in-sample avg dev_std = 0.271)
NEC for r=0.9 class 1.0 = 0.227 +- 0.209 (in-sample avg dev_std = 0.271)
NEC for r=0.9 all KL = 0.127 +- 0.209 (in-sample avg dev_std = 0.271)
NEC for r=0.9 all L1 = 0.142 +- 0.182 (in-sample avg dev_std = 0.271)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.824
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 272
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.772
NEC for r=0.95 class 0.0 = 0.066 +- 0.211 (in-sample avg dev_std = 0.274)
NEC for r=0.95 class 1.0 = 0.225 +- 0.211 (in-sample avg dev_std = 0.274)
NEC for r=0.95 all KL = 0.135 +- 0.211 (in-sample avg dev_std = 0.274)
NEC for r=0.95 all L1 = 0.145 +- 0.184 (in-sample avg dev_std = 0.274)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.822
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 272
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.777
NEC for r=1.0 class 0.0 = 0.069 +- 0.224 (in-sample avg dev_std = 0.270)
NEC for r=1.0 class 1.0 = 0.225 +- 0.224 (in-sample avg dev_std = 0.270)
NEC for r=1.0 all KL = 0.143 +- 0.224 (in-sample avg dev_std = 0.270)
NEC for r=1.0 all L1 = 0.147 +- 0.192 (in-sample avg dev_std = 0.270)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.627
NEC for r=0.3 class 0.0 = 0.05 +- 0.059 (in-sample avg dev_std = 0.109)
NEC for r=0.3 class 1.0 = 0.116 +- 0.059 (in-sample avg dev_std = 0.109)
NEC for r=0.3 all KL = 0.032 +- 0.059 (in-sample avg dev_std = 0.109)
NEC for r=0.3 all L1 = 0.083 +- 0.099 (in-sample avg dev_std = 0.109)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.644
NEC for r=0.4 class 0.0 = 0.064 +- 0.079 (in-sample avg dev_std = 0.139)
NEC for r=0.4 class 1.0 = 0.137 +- 0.079 (in-sample avg dev_std = 0.139)
NEC for r=0.4 all KL = 0.045 +- 0.079 (in-sample avg dev_std = 0.139)
NEC for r=0.4 all L1 = 0.1 +- 0.127 (in-sample avg dev_std = 0.139)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.702
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.682
NEC for r=0.6 class 0.0 = 0.065 +- 0.132 (in-sample avg dev_std = 0.192)
NEC for r=0.6 class 1.0 = 0.15 +- 0.132 (in-sample avg dev_std = 0.192)
NEC for r=0.6 all KL = 0.069 +- 0.132 (in-sample avg dev_std = 0.192)
NEC for r=0.6 all L1 = 0.108 +- 0.142 (in-sample avg dev_std = 0.192)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.706
NEC for r=0.9 class 0.0 = 0.058 +- 0.199 (in-sample avg dev_std = 0.239)
NEC for r=0.9 class 1.0 = 0.188 +- 0.199 (in-sample avg dev_std = 0.239)
NEC for r=0.9 all KL = 0.109 +- 0.199 (in-sample avg dev_std = 0.239)
NEC for r=0.9 all L1 = 0.123 +- 0.177 (in-sample avg dev_std = 0.239)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.745
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 162
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.702
NEC for r=0.95 class 0.0 = 0.045 +- 0.216 (in-sample avg dev_std = 0.238)
NEC for r=0.95 class 1.0 = 0.193 +- 0.216 (in-sample avg dev_std = 0.238)
NEC for r=0.95 all KL = 0.11 +- 0.216 (in-sample avg dev_std = 0.238)
NEC for r=0.95 all L1 = 0.119 +- 0.179 (in-sample avg dev_std = 0.238)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.752
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.708
NEC for r=1.0 class 0.0 = 0.048 +- 0.229 (in-sample avg dev_std = 0.255)
NEC for r=1.0 class 1.0 = 0.209 +- 0.229 (in-sample avg dev_std = 0.255)
NEC for r=1.0 all KL = 0.124 +- 0.229 (in-sample avg dev_std = 0.255)
NEC for r=1.0 all L1 = 0.128 +- 0.190 (in-sample avg dev_std = 0.255)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.767
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 255
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.626
SUFF++ for r=0.3 class 0.0 = 0.926 +- 0.093 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.3 class 1.0 = 0.806 +- 0.093 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.3 all KL = 0.93 +- 0.093 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.3 all L1 = 0.864 +- 0.141 (in-sample avg dev_std = 0.182)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 271
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.677
SUFF++ for r=0.4 class 0.0 = 0.929 +- 0.122 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.4 class 1.0 = 0.784 +- 0.122 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.4 all KL = 0.918 +- 0.122 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.4 all L1 = 0.857 +- 0.156 (in-sample avg dev_std = 0.210)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.799
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.753
SUFF++ for r=0.6 class 0.0 = 0.943 +- 0.112 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.6 class 1.0 = 0.826 +- 0.112 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.6 all KL = 0.937 +- 0.112 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.6 all L1 = 0.885 +- 0.143 (in-sample avg dev_std = 0.186)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.827
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.815
SUFF++ for r=0.9 class 0.0 = 0.982 +- 0.064 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.9 class 1.0 = 0.925 +- 0.064 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.9 all KL = 0.979 +- 0.064 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.9 all L1 = 0.954 +- 0.086 (in-sample avg dev_std = 0.126)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.824
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 270
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.812
SUFF++ for r=0.95 class 0.0 = 0.977 +- 0.072 (in-sample avg dev_std = 0.144)
SUFF++ for r=0.95 class 1.0 = 0.929 +- 0.072 (in-sample avg dev_std = 0.144)
SUFF++ for r=0.95 all KL = 0.976 +- 0.072 (in-sample avg dev_std = 0.144)
SUFF++ for r=0.95 all L1 = 0.953 +- 0.087 (in-sample avg dev_std = 0.144)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.624
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 148
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.572
SUFF++ for r=0.3 class 0.0 = 0.941 +- 0.080 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.3 class 1.0 = 0.875 +- 0.080 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.3 all KL = 0.957 +- 0.080 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.3 all L1 = 0.909 +- 0.121 (in-sample avg dev_std = 0.139)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.663
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 160
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.583
SUFF++ for r=0.4 class 0.0 = 0.931 +- 0.109 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.4 class 1.0 = 0.837 +- 0.109 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.4 all KL = 0.939 +- 0.109 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.4 all L1 = 0.885 +- 0.155 (in-sample avg dev_std = 0.171)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.702
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.649
SUFF++ for r=0.6 class 0.0 = 0.941 +- 0.155 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.6 class 1.0 = 0.828 +- 0.155 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.6 all KL = 0.927 +- 0.155 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.6 all L1 = 0.885 +- 0.168 (in-sample avg dev_std = 0.206)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.739
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 161
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.743
SUFF++ for r=0.9 class 0.0 = 0.982 +- 0.107 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.9 class 1.0 = 0.914 +- 0.107 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.9 all KL = 0.965 +- 0.107 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.9 all L1 = 0.948 +- 0.105 (in-sample avg dev_std = 0.166)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.742
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 161
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.746
SUFF++ for r=0.95 class 0.0 = 0.992 +- 0.124 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.95 class 1.0 = 0.946 +- 0.124 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.95 all KL = 0.973 +- 0.124 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.95 all L1 = 0.969 +- 0.113 (in-sample avg dev_std = 0.094)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:25:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:15 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:19 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:22 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:25 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 140...
[0m[1;37mINFO[0m: [1mCheckpoint 140: 
-----------------------------------
Train ROC-AUC: 0.9788
Train Loss: 0.0657
ID Validation ROC-AUC: 0.8378
ID Validation Loss: 0.1396
ID Test ROC-AUC: 0.8109
ID Test Loss: 0.1227
OOD Validation ROC-AUC: 0.7665
OOD Validation Loss: 0.1310
OOD Test ROC-AUC: 0.7331
OOD Test Loss: 0.0936

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ROC-AUC: 0.9723
Train Loss: 0.0782
ID Validation ROC-AUC: 0.8167
ID Validation Loss: 0.1530
ID Test ROC-AUC: 0.8037
ID Test Loss: 0.1332
OOD Validation ROC-AUC: 0.7875
OOD Validation Loss: 0.1295
OOD Test ROC-AUC: 0.6782
OOD Test Loss: 0.1101

[0m[1;37mINFO[0m: [1mChartInfo 0.8109 0.7331 0.8037 0.6782 0.8167 0.7875[0mGOODHIV(4112)
Data example from id_test: Data(x=[23, 9], edge_index=[2, 48], edge_attr=[48, 3], y=[1, 1], smiles='Cc1occc1C(=S)Nc1ccc(Cl)c(C(=O)OCC(C)C)c1', idx=[1], scaffold='S=C(Nc1ccccc1)c1ccoc1', domain_id=[1], env_id=[1], ori_edge_index=[2, 48], node_perm=[23])
Label distribution from id_test: (tensor([0., 1.]), tensor([3976,  136]))
[1;34mDEBUG[0m: 05/08/2024 04:25:28 PM : [1mUnbalanced warning for GOODHIV (id_test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([136, 136]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 05/08/2024 04:25:30 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.704
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 272
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.676
NEC for r=0.3 class 0.0 = 0.023 +- 0.029 (in-sample avg dev_std = 0.057)
NEC for r=0.3 class 1.0 = 0.06 +- 0.029 (in-sample avg dev_std = 0.057)
NEC for r=0.3 all KL = 0.011 +- 0.029 (in-sample avg dev_std = 0.057)
NEC for r=0.3 all L1 = 0.042 +- 0.062 (in-sample avg dev_std = 0.057)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 272
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.707
NEC for r=0.4 class 0.0 = 0.026 +- 0.048 (in-sample avg dev_std = 0.075)
NEC for r=0.4 class 1.0 = 0.076 +- 0.048 (in-sample avg dev_std = 0.075)
NEC for r=0.4 all KL = 0.016 +- 0.048 (in-sample avg dev_std = 0.075)
NEC for r=0.4 all L1 = 0.051 +- 0.077 (in-sample avg dev_std = 0.075)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.793
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.749
NEC for r=0.6 class 0.0 = 0.026 +- 0.063 (in-sample avg dev_std = 0.114)
NEC for r=0.6 class 1.0 = 0.117 +- 0.063 (in-sample avg dev_std = 0.114)
NEC for r=0.6 all KL = 0.028 +- 0.063 (in-sample avg dev_std = 0.114)
NEC for r=0.6 all L1 = 0.071 +- 0.110 (in-sample avg dev_std = 0.114)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.827
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.792
NEC for r=0.9 class 0.0 = 0.035 +- 0.144 (in-sample avg dev_std = 0.188)
NEC for r=0.9 class 1.0 = 0.184 +- 0.144 (in-sample avg dev_std = 0.188)
NEC for r=0.9 all KL = 0.073 +- 0.144 (in-sample avg dev_std = 0.188)
NEC for r=0.9 all L1 = 0.109 +- 0.162 (in-sample avg dev_std = 0.188)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.835
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 272
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.786
NEC for r=0.95 class 0.0 = 0.039 +- 0.158 (in-sample avg dev_std = 0.227)
NEC for r=0.95 class 1.0 = 0.2 +- 0.158 (in-sample avg dev_std = 0.227)
NEC for r=0.95 all KL = 0.089 +- 0.158 (in-sample avg dev_std = 0.227)
NEC for r=0.95 all L1 = 0.119 +- 0.168 (in-sample avg dev_std = 0.227)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.832
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 272
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.778
NEC for r=1.0 class 0.0 = 0.038 +- 0.182 (in-sample avg dev_std = 0.237)
NEC for r=1.0 class 1.0 = 0.218 +- 0.182 (in-sample avg dev_std = 0.237)
NEC for r=1.0 all KL = 0.101 +- 0.182 (in-sample avg dev_std = 0.237)
NEC for r=1.0 all L1 = 0.128 +- 0.181 (in-sample avg dev_std = 0.237)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.646
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.639
NEC for r=0.3 class 0.0 = 0.021 +- 0.037 (in-sample avg dev_std = 0.062)
NEC for r=0.3 class 1.0 = 0.052 +- 0.037 (in-sample avg dev_std = 0.062)
NEC for r=0.3 all KL = 0.013 +- 0.037 (in-sample avg dev_std = 0.062)
NEC for r=0.3 all L1 = 0.037 +- 0.057 (in-sample avg dev_std = 0.062)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.691
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.659
NEC for r=0.4 class 0.0 = 0.022 +- 0.054 (in-sample avg dev_std = 0.058)
NEC for r=0.4 class 1.0 = 0.068 +- 0.054 (in-sample avg dev_std = 0.058)
NEC for r=0.4 all KL = 0.018 +- 0.054 (in-sample avg dev_std = 0.058)
NEC for r=0.4 all L1 = 0.045 +- 0.077 (in-sample avg dev_std = 0.058)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.703
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.707
NEC for r=0.6 class 0.0 = 0.019 +- 0.089 (in-sample avg dev_std = 0.116)
NEC for r=0.6 class 1.0 = 0.114 +- 0.089 (in-sample avg dev_std = 0.116)
NEC for r=0.6 all KL = 0.033 +- 0.089 (in-sample avg dev_std = 0.116)
NEC for r=0.6 all L1 = 0.066 +- 0.123 (in-sample avg dev_std = 0.116)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.772
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.753
NEC for r=0.9 class 0.0 = 0.014 +- 0.127 (in-sample avg dev_std = 0.172)
NEC for r=0.9 class 1.0 = 0.125 +- 0.127 (in-sample avg dev_std = 0.172)
NEC for r=0.9 all KL = 0.046 +- 0.127 (in-sample avg dev_std = 0.172)
NEC for r=0.9 all L1 = 0.069 +- 0.130 (in-sample avg dev_std = 0.172)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.782
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 162
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.757
NEC for r=0.95 class 0.0 = 0.014 +- 0.139 (in-sample avg dev_std = 0.170)
NEC for r=0.95 class 1.0 = 0.122 +- 0.139 (in-sample avg dev_std = 0.170)
NEC for r=0.95 all KL = 0.047 +- 0.139 (in-sample avg dev_std = 0.170)
NEC for r=0.95 all L1 = 0.068 +- 0.131 (in-sample avg dev_std = 0.170)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.793
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.762
NEC for r=1.0 class 0.0 = 0.013 +- 0.125 (in-sample avg dev_std = 0.173)
NEC for r=1.0 class 1.0 = 0.118 +- 0.125 (in-sample avg dev_std = 0.173)
NEC for r=1.0 all KL = 0.044 +- 0.125 (in-sample avg dev_std = 0.173)
NEC for r=1.0 all L1 = 0.066 +- 0.120 (in-sample avg dev_std = 0.173)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 254
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.601
SUFF++ for r=0.3 class 0.0 = 0.972 +- 0.047 (in-sample avg dev_std = 0.075)
SUFF++ for r=0.3 class 1.0 = 0.913 +- 0.047 (in-sample avg dev_std = 0.075)
SUFF++ for r=0.3 all KL = 0.976 +- 0.047 (in-sample avg dev_std = 0.075)
SUFF++ for r=0.3 all L1 = 0.943 +- 0.086 (in-sample avg dev_std = 0.075)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.722
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 269
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.62
SUFF++ for r=0.4 class 0.0 = 0.968 +- 0.055 (in-sample avg dev_std = 0.109)
SUFF++ for r=0.4 class 1.0 = 0.894 +- 0.055 (in-sample avg dev_std = 0.109)
SUFF++ for r=0.4 all KL = 0.97 +- 0.055 (in-sample avg dev_std = 0.109)
SUFF++ for r=0.4 all L1 = 0.931 +- 0.099 (in-sample avg dev_std = 0.109)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.793
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.734
SUFF++ for r=0.6 class 0.0 = 0.975 +- 0.082 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.6 class 1.0 = 0.874 +- 0.082 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.6 all KL = 0.966 +- 0.082 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.6 all L1 = 0.925 +- 0.117 (in-sample avg dev_std = 0.141)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.827
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.824
SUFF++ for r=0.9 class 0.0 = 0.99 +- 0.045 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.9 class 1.0 = 0.933 +- 0.045 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.9 all KL = 0.986 +- 0.045 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.9 all L1 = 0.961 +- 0.076 (in-sample avg dev_std = 0.103)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.835
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 270
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.824
SUFF++ for r=0.95 class 0.0 = 0.989 +- 0.045 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.95 class 1.0 = 0.94 +- 0.045 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.95 all KL = 0.987 +- 0.045 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.95 all L1 = 0.965 +- 0.069 (in-sample avg dev_std = 0.103)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.655
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 153
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.58
SUFF++ for r=0.3 class 0.0 = 0.976 +- 0.034 (in-sample avg dev_std = 0.066)
SUFF++ for r=0.3 class 1.0 = 0.938 +- 0.034 (in-sample avg dev_std = 0.066)
SUFF++ for r=0.3 all KL = 0.983 +- 0.034 (in-sample avg dev_std = 0.066)
SUFF++ for r=0.3 all L1 = 0.957 +- 0.064 (in-sample avg dev_std = 0.066)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.691
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.596
SUFF++ for r=0.4 class 0.0 = 0.977 +- 0.053 (in-sample avg dev_std = 0.071)
SUFF++ for r=0.4 class 1.0 = 0.918 +- 0.053 (in-sample avg dev_std = 0.071)
SUFF++ for r=0.4 all KL = 0.978 +- 0.053 (in-sample avg dev_std = 0.071)
SUFF++ for r=0.4 all L1 = 0.948 +- 0.087 (in-sample avg dev_std = 0.071)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.703
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.678
SUFF++ for r=0.6 class 0.0 = 0.979 +- 0.088 (in-sample avg dev_std = 0.106)
SUFF++ for r=0.6 class 1.0 = 0.893 +- 0.088 (in-sample avg dev_std = 0.106)
SUFF++ for r=0.6 all KL = 0.969 +- 0.088 (in-sample avg dev_std = 0.106)
SUFF++ for r=0.6 all L1 = 0.936 +- 0.119 (in-sample avg dev_std = 0.106)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.772
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.771
SUFF++ for r=0.9 class 0.0 = 0.994 +- 0.055 (in-sample avg dev_std = 0.091)
SUFF++ for r=0.9 class 1.0 = 0.947 +- 0.055 (in-sample avg dev_std = 0.091)
SUFF++ for r=0.9 all KL = 0.988 +- 0.055 (in-sample avg dev_std = 0.091)
SUFF++ for r=0.9 all L1 = 0.97 +- 0.064 (in-sample avg dev_std = 0.091)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.779
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 161
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.78
SUFF++ for r=0.95 class 0.0 = 0.996 +- 0.034 (in-sample avg dev_std = 0.075)
SUFF++ for r=0.95 class 1.0 = 0.964 +- 0.034 (in-sample avg dev_std = 0.075)
SUFF++ for r=0.95 all KL = 0.992 +- 0.034 (in-sample avg dev_std = 0.075)
SUFF++ for r=0.95 all L1 = 0.98 +- 0.046 (in-sample avg dev_std = 0.075)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:26:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:38 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:42 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:45 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:49 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ROC-AUC: 0.9928
Train Loss: 0.0421
ID Validation ROC-AUC: 0.8460
ID Validation Loss: 0.1580
ID Test ROC-AUC: 0.8091
ID Test Loss: 0.1489
OOD Validation ROC-AUC: 0.7496
OOD Validation Loss: 0.1650
OOD Test ROC-AUC: 0.7077
OOD Test Loss: 0.1190

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ROC-AUC: 0.9781
Train Loss: 0.0600
ID Validation ROC-AUC: 0.8358
ID Validation Loss: 0.1409
ID Test ROC-AUC: 0.8118
ID Test Loss: 0.1303
OOD Validation ROC-AUC: 0.7903
OOD Validation Loss: 0.1230
OOD Test ROC-AUC: 0.7362
OOD Test Loss: 0.0936

[0m[1;37mINFO[0m: [1mChartInfo 0.8091 0.7077 0.8118 0.7362 0.8358 0.7903[0mGOODHIV(4112)
Data example from id_test: Data(x=[23, 9], edge_index=[2, 48], edge_attr=[48, 3], y=[1, 1], smiles='Cc1occc1C(=S)Nc1ccc(Cl)c(C(=O)OCC(C)C)c1', idx=[1], scaffold='S=C(Nc1ccccc1)c1ccoc1', domain_id=[1], env_id=[1], ori_edge_index=[2, 48], node_perm=[23])
Label distribution from id_test: (tensor([0., 1.]), tensor([3976,  136]))
[1;34mDEBUG[0m: 05/08/2024 04:26:52 PM : [1mUnbalanced warning for GOODHIV (id_test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([136, 136]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 05/08/2024 04:26:54 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.717
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 272
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.696
NEC for r=0.3 class 0.0 = 0.035 +- 0.067 (in-sample avg dev_std = 0.118)
NEC for r=0.3 class 1.0 = 0.121 +- 0.067 (in-sample avg dev_std = 0.118)
NEC for r=0.3 all KL = 0.035 +- 0.067 (in-sample avg dev_std = 0.118)
NEC for r=0.3 all L1 = 0.078 +- 0.117 (in-sample avg dev_std = 0.118)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.743
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 272
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.728
NEC for r=0.4 class 0.0 = 0.045 +- 0.094 (in-sample avg dev_std = 0.165)
NEC for r=0.4 class 1.0 = 0.144 +- 0.094 (in-sample avg dev_std = 0.165)
NEC for r=0.4 all KL = 0.049 +- 0.094 (in-sample avg dev_std = 0.165)
NEC for r=0.4 all L1 = 0.094 +- 0.134 (in-sample avg dev_std = 0.165)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.766
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.747
NEC for r=0.6 class 0.0 = 0.059 +- 0.153 (in-sample avg dev_std = 0.203)
NEC for r=0.6 class 1.0 = 0.17 +- 0.153 (in-sample avg dev_std = 0.203)
NEC for r=0.6 all KL = 0.077 +- 0.153 (in-sample avg dev_std = 0.203)
NEC for r=0.6 all L1 = 0.115 +- 0.159 (in-sample avg dev_std = 0.203)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.788
NEC for r=0.9 class 0.0 = 0.057 +- 0.209 (in-sample avg dev_std = 0.256)
NEC for r=0.9 class 1.0 = 0.21 +- 0.209 (in-sample avg dev_std = 0.256)
NEC for r=0.9 all KL = 0.125 +- 0.209 (in-sample avg dev_std = 0.256)
NEC for r=0.9 all L1 = 0.133 +- 0.181 (in-sample avg dev_std = 0.256)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.836
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 272
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.792
NEC for r=0.95 class 0.0 = 0.059 +- 0.225 (in-sample avg dev_std = 0.275)
NEC for r=0.95 class 1.0 = 0.215 +- 0.225 (in-sample avg dev_std = 0.275)
NEC for r=0.95 all KL = 0.135 +- 0.225 (in-sample avg dev_std = 0.275)
NEC for r=0.95 all L1 = 0.137 +- 0.191 (in-sample avg dev_std = 0.275)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.827
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 272
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.792
NEC for r=1.0 class 0.0 = 0.052 +- 0.225 (in-sample avg dev_std = 0.283)
NEC for r=1.0 class 1.0 = 0.224 +- 0.225 (in-sample avg dev_std = 0.283)
NEC for r=1.0 all KL = 0.141 +- 0.225 (in-sample avg dev_std = 0.283)
NEC for r=1.0 all L1 = 0.138 +- 0.185 (in-sample avg dev_std = 0.283)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.663
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.638
NEC for r=0.3 class 0.0 = 0.024 +- 0.073 (in-sample avg dev_std = 0.106)
NEC for r=0.3 class 1.0 = 0.082 +- 0.073 (in-sample avg dev_std = 0.106)
NEC for r=0.3 all KL = 0.025 +- 0.073 (in-sample avg dev_std = 0.106)
NEC for r=0.3 all L1 = 0.053 +- 0.104 (in-sample avg dev_std = 0.106)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.689
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.674
NEC for r=0.4 class 0.0 = 0.027 +- 0.083 (in-sample avg dev_std = 0.130)
NEC for r=0.4 class 1.0 = 0.109 +- 0.083 (in-sample avg dev_std = 0.130)
NEC for r=0.4 all KL = 0.033 +- 0.083 (in-sample avg dev_std = 0.130)
NEC for r=0.4 all L1 = 0.068 +- 0.127 (in-sample avg dev_std = 0.130)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.66
NEC for r=0.6 class 0.0 = 0.033 +- 0.135 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 1.0 = 0.131 +- 0.135 (in-sample avg dev_std = 0.166)
NEC for r=0.6 all KL = 0.053 +- 0.135 (in-sample avg dev_std = 0.166)
NEC for r=0.6 all L1 = 0.082 +- 0.153 (in-sample avg dev_std = 0.166)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.708
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.684
NEC for r=0.9 class 0.0 = 0.022 +- 0.191 (in-sample avg dev_std = 0.219)
NEC for r=0.9 class 1.0 = 0.15 +- 0.191 (in-sample avg dev_std = 0.219)
NEC for r=0.9 all KL = 0.073 +- 0.191 (in-sample avg dev_std = 0.219)
NEC for r=0.9 all L1 = 0.086 +- 0.163 (in-sample avg dev_std = 0.219)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.723
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 162
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.681
NEC for r=0.95 class 0.0 = 0.021 +- 0.176 (in-sample avg dev_std = 0.212)
NEC for r=0.95 class 1.0 = 0.143 +- 0.176 (in-sample avg dev_std = 0.212)
NEC for r=0.95 all KL = 0.068 +- 0.176 (in-sample avg dev_std = 0.212)
NEC for r=0.95 all L1 = 0.082 +- 0.152 (in-sample avg dev_std = 0.212)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.729
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.675
NEC for r=1.0 class 0.0 = 0.02 +- 0.177 (in-sample avg dev_std = 0.203)
NEC for r=1.0 class 1.0 = 0.142 +- 0.177 (in-sample avg dev_std = 0.203)
NEC for r=1.0 all KL = 0.072 +- 0.177 (in-sample avg dev_std = 0.203)
NEC for r=1.0 all L1 = 0.081 +- 0.147 (in-sample avg dev_std = 0.203)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.726
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 260
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.602
SUFF++ for r=0.3 class 0.0 = 0.956 +- 0.118 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.3 class 1.0 = 0.847 +- 0.118 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.3 all KL = 0.936 +- 0.118 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.3 all L1 = 0.9 +- 0.150 (in-sample avg dev_std = 0.178)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.744
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 271
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.639
SUFF++ for r=0.4 class 0.0 = 0.946 +- 0.159 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.4 class 1.0 = 0.8 +- 0.159 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.4 all KL = 0.909 +- 0.159 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.4 all L1 = 0.873 +- 0.178 (in-sample avg dev_std = 0.228)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.766
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.719
SUFF++ for r=0.6 class 0.0 = 0.955 +- 0.166 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.6 class 1.0 = 0.788 +- 0.166 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.6 all KL = 0.909 +- 0.166 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.6 all L1 = 0.871 +- 0.176 (in-sample avg dev_std = 0.223)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.826
SUFF++ for r=0.9 class 0.0 = 0.982 +- 0.083 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.9 class 1.0 = 0.929 +- 0.083 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.9 all KL = 0.976 +- 0.083 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.9 all L1 = 0.955 +- 0.093 (in-sample avg dev_std = 0.139)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.836
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 270
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.833
SUFF++ for r=0.95 class 0.0 = 0.984 +- 0.077 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.95 class 1.0 = 0.933 +- 0.077 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.95 all KL = 0.977 +- 0.077 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.95 all L1 = 0.958 +- 0.087 (in-sample avg dev_std = 0.137)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.676
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 144
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.608
SUFF++ for r=0.3 class 0.0 = 0.968 +- 0.077 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.3 class 1.0 = 0.907 +- 0.077 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.3 all KL = 0.965 +- 0.077 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.3 all L1 = 0.936 +- 0.121 (in-sample avg dev_std = 0.110)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.688
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 161
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.621
SUFF++ for r=0.4 class 0.0 = 0.963 +- 0.102 (in-sample avg dev_std = 0.151)
SUFF++ for r=0.4 class 1.0 = 0.879 +- 0.102 (in-sample avg dev_std = 0.151)
SUFF++ for r=0.4 all KL = 0.953 +- 0.102 (in-sample avg dev_std = 0.151)
SUFF++ for r=0.4 all L1 = 0.921 +- 0.141 (in-sample avg dev_std = 0.151)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.685
SUFF++ for r=0.6 class 0.0 = 0.969 +- 0.153 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.6 class 1.0 = 0.851 +- 0.153 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.6 all KL = 0.938 +- 0.153 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.6 all L1 = 0.91 +- 0.168 (in-sample avg dev_std = 0.182)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.708
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.714
SUFF++ for r=0.9 class 0.0 = 0.991 +- 0.053 (in-sample avg dev_std = 0.109)
SUFF++ for r=0.9 class 1.0 = 0.949 +- 0.053 (in-sample avg dev_std = 0.109)
SUFF++ for r=0.9 all KL = 0.984 +- 0.053 (in-sample avg dev_std = 0.109)
SUFF++ for r=0.9 all L1 = 0.97 +- 0.067 (in-sample avg dev_std = 0.109)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.72
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 161
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.715
SUFF++ for r=0.95 class 0.0 = 0.994 +- 0.056 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.95 class 1.0 = 0.956 +- 0.056 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.95 all KL = 0.985 +- 0.056 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.95 all L1 = 0.975 +- 0.070 (in-sample avg dev_std = 0.105)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.024, 0.03, 0.05, 0.085, 0.1, 0.095], 'all_L1': [0.066, 0.079, 0.098, 0.116, 0.125, 0.121]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.041, 0.067, 0.122, 0.13, 0.148], 'all_L1': [0.078, 0.09, 0.109, 0.136, 0.136, 0.143]}), defaultdict(<class 'list'>, {'all_KL': [0.038, 0.045, 0.067, 0.127, 0.135, 0.143], 'all_L1': [0.104, 0.107, 0.118, 0.142, 0.145, 0.147]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.016, 0.028, 0.073, 0.089, 0.101], 'all_L1': [0.042, 0.051, 0.071, 0.109, 0.119, 0.128]}), defaultdict(<class 'list'>, {'all_KL': [0.035, 0.049, 0.077, 0.125, 0.135, 0.141], 'all_L1': [0.078, 0.094, 0.115, 0.133, 0.137, 0.138]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.957, 0.948, 0.947, 0.989, 0.988, 1.0], 'all_L1': [0.913, 0.894, 0.895, 0.965, 0.967, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.948, 0.938, 0.934, 0.975, 0.98, 1.0], 'all_L1': [0.902, 0.888, 0.888, 0.958, 0.964, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.93, 0.918, 0.937, 0.979, 0.976, 1.0], 'all_L1': [0.864, 0.857, 0.885, 0.954, 0.953, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.976, 0.97, 0.966, 0.986, 0.987, 1.0], 'all_L1': [0.943, 0.931, 0.925, 0.961, 0.965, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.936, 0.909, 0.909, 0.976, 0.977, 1.0], 'all_L1': [0.9, 0.873, 0.871, 0.955, 0.958, 1.0], 0.0: [1.0], 1.0: [1.0]})]

Eval split test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.031, 0.028, 0.04, 0.055, 0.059, 0.061], 'all_L1': [0.08, 0.077, 0.086, 0.085, 0.085, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.022, 0.028, 0.056, 0.081, 0.1, 0.098], 'all_L1': [0.053, 0.066, 0.092, 0.09, 0.103, 0.1]}), defaultdict(<class 'list'>, {'all_KL': [0.032, 0.045, 0.069, 0.109, 0.11, 0.124], 'all_L1': [0.083, 0.1, 0.108, 0.123, 0.119, 0.128]}), defaultdict(<class 'list'>, {'all_KL': [0.013, 0.018, 0.033, 0.046, 0.047, 0.044], 'all_L1': [0.037, 0.045, 0.066, 0.069, 0.068, 0.066]}), defaultdict(<class 'list'>, {'all_KL': [0.025, 0.033, 0.053, 0.073, 0.068, 0.072], 'all_L1': [0.053, 0.068, 0.082, 0.086, 0.082, 0.081]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.959, 0.952, 0.938, 0.981, 0.985, 1.0], 'all_L1': [0.914, 0.898, 0.892, 0.96, 0.978, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.963, 0.955, 0.947, 0.981, 0.98, 1.0], 'all_L1': [0.934, 0.918, 0.911, 0.964, 0.963, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.957, 0.939, 0.927, 0.965, 0.973, 1.0], 'all_L1': [0.909, 0.885, 0.885, 0.948, 0.969, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.983, 0.978, 0.969, 0.988, 0.992, 1.0], 'all_L1': [0.957, 0.948, 0.936, 0.97, 0.98, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.965, 0.953, 0.938, 0.984, 0.985, 1.0], 'all_L1': [0.936, 0.921, 0.91, 0.97, 0.975, 1.0], 0.0: [1.0], 1.0: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.074 +- 0.020, 0.084 +- 0.019, 0.102 +- 0.017, 0.127 +- 0.013, 0.132 +- 0.009, 0.135 +- 0.010
nec class all_KL  =  0.028 +- 0.010, 0.036 +- 0.012, 0.058 +- 0.017, 0.106 +- 0.023, 0.118 +- 0.019, 0.126 +- 0.023
nec_acc_int  =  0.683 +- 0.012, 0.714 +- 0.012, 0.755 +- 0.022, 0.784 +- 0.018, 0.781 +- 0.014, 0.780 +- 0.015
suff++ class all_L1  =  0.904 +- 0.025, 0.889 +- 0.025, 0.893 +- 0.018, 0.959 +- 0.004, 0.961 +- 0.005, 1.000 +- 0.000
suff++ class all_KL  =  0.949 +- 0.016, 0.937 +- 0.022, 0.939 +- 0.019, 0.981 +- 0.006, 0.982 +- 0.005, 1.000 +- 0.000
suff++_acc_int  =  0.605 +- 0.011, 0.651 +- 0.020, 0.738 +- 0.014, 0.810 +- 0.015, 0.815 +- 0.014

Eval split test
nec class all_L1  =  0.061 +- 0.018, 0.071 +- 0.018, 0.087 +- 0.014, 0.091 +- 0.018, 0.091 +- 0.018, 0.092 +- 0.021
nec class all_KL  =  0.025 +- 0.007, 0.030 +- 0.009, 0.050 +- 0.013, 0.073 +- 0.022, 0.077 +- 0.024, 0.080 +- 0.028
nec_acc_int  =  0.635 +- 0.022, 0.657 +- 0.015, 0.674 +- 0.019, 0.708 +- 0.024, 0.707 +- 0.027, 0.713 +- 0.028
suff++ class all_L1  =  0.930 +- 0.017, 0.914 +- 0.022, 0.907 +- 0.018, 0.962 +- 0.008, 0.973 +- 0.006, 1.000 +- 0.000
suff++ class all_KL  =  0.965 +- 0.009, 0.955 +- 0.013, 0.944 +- 0.014, 0.980 +- 0.008, 0.983 +- 0.006, 1.000 +- 0.000
suff++_acc_int  =  0.593 +- 0.020, 0.604 +- 0.017, 0.664 +- 0.016, 0.730 +- 0.024, 0.742 +- 0.022


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.489 +- 0.003, 0.486 +- 0.003, 0.498 +- 0.003, 0.543 +- 0.005, 0.547 +- 0.003, 0.568 +- 0.005
Faith. Armon (L1)= 		  =  0.135 +- 0.034, 0.153 +- 0.032, 0.183 +- 0.028, 0.224 +- 0.020, 0.233 +- 0.014, 0.238 +- 0.015
Faith. GMean (L1)= 	  =  0.255 +- 0.033, 0.271 +- 0.029, 0.301 +- 0.024, 0.349 +- 0.017, 0.357 +- 0.012, 0.368 +- 0.013
Faith. Aritm (KL)= 		  =  0.489 +- 0.003, 0.486 +- 0.005, 0.498 +- 0.003, 0.544 +- 0.009, 0.550 +- 0.007, 0.563 +- 0.011
Faith. Armon (KL)= 		  =  0.054 +- 0.018, 0.069 +- 0.022, 0.108 +- 0.031, 0.191 +- 0.037, 0.210 +- 0.031, 0.222 +- 0.036
Faith. GMean (KL)= 	  =  0.159 +- 0.030, 0.181 +- 0.032, 0.229 +- 0.036, 0.321 +- 0.035, 0.339 +- 0.028, 0.353 +- 0.033

Eval split test
Faith. Aritm (L1)= 		  =  0.496 +- 0.001, 0.493 +- 0.003, 0.497 +- 0.005, 0.527 +- 0.005, 0.532 +- 0.007, 0.546 +- 0.010
Faith. Armon (L1)= 		  =  0.114 +- 0.031, 0.131 +- 0.030, 0.158 +- 0.023, 0.165 +- 0.029, 0.167 +- 0.029, 0.168 +- 0.035
Faith. GMean (L1)= 	  =  0.236 +- 0.033, 0.253 +- 0.029, 0.279 +- 0.020, 0.294 +- 0.027, 0.297 +- 0.028, 0.302 +- 0.034
Faith. Aritm (KL)= 		  =  0.495 +- 0.002, 0.493 +- 0.003, 0.497 +- 0.005, 0.526 +- 0.008, 0.530 +- 0.009, 0.540 +- 0.014
Faith. Armon (KL)= 		  =  0.048 +- 0.013, 0.059 +- 0.016, 0.095 +- 0.023, 0.135 +- 0.038, 0.141 +- 0.041, 0.147 +- 0.048
Faith. GMean (KL)= 	  =  0.152 +- 0.022, 0.168 +- 0.024, 0.216 +- 0.026, 0.264 +- 0.039, 0.271 +- 0.042, 0.278 +- 0.050
Computed for split load_split = id



Completed in  0:06:35.449375  for LECIvGIN GOODHIV/scaffold



DONE LECI GOODHIV/scaffold

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:28:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:15 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:19 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:23 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:26 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:28:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ROC-AUC: 0.9090
Train Loss: 0.0950
ID Validation ROC-AUC: 0.8455
ID Validation Loss: 0.1252
ID Test ROC-AUC: 0.8217
ID Test Loss: 0.1090
OOD Validation ROC-AUC: 0.7404
OOD Validation Loss: 0.1137
OOD Test ROC-AUC: 0.6988
OOD Test Loss: 0.0867

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ROC-AUC: 0.8446
Train Loss: 0.1135
ID Validation ROC-AUC: 0.8042
ID Validation Loss: 0.1337
ID Test ROC-AUC: 0.8042
ID Test Loss: 0.1156
OOD Validation ROC-AUC: 0.7833
OOD Validation Loss: 0.1126
OOD Test ROC-AUC: 0.6912
OOD Test Loss: 0.0970

[0m[1;37mINFO[0m: [1mChartInfo 0.8217 0.6988 0.8042 0.6912 0.8042 0.7833[0mGOODHIV(4112)
Data example from id_test: Data(x=[23, 9], edge_index=[2, 48], edge_attr=[48, 3], y=[1, 1], smiles='Cc1occc1C(=S)Nc1ccc(Cl)c(C(=O)OCC(C)C)c1', idx=[1], scaffold='S=C(Nc1ccccc1)c1ccoc1', domain_id=[1], env_id=[1], ori_edge_index=[2, 48], node_perm=[23])
Label distribution from id_test: (tensor([0., 1.]), tensor([3976,  136]))
[1;34mDEBUG[0m: 05/08/2024 04:28:30 PM : [1mUnbalanced warning for GOODHIV (id_test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([136, 136]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 05/08/2024 04:28:32 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.626
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 272
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.625
NEC for r=0.3 class 0.0 = 0.009 +- 0.010 (in-sample avg dev_std = 0.019)
NEC for r=0.3 class 1.0 = 0.02 +- 0.010 (in-sample avg dev_std = 0.019)
NEC for r=0.3 all KL = 0.004 +- 0.010 (in-sample avg dev_std = 0.019)
NEC for r=0.3 all L1 = 0.014 +- 0.021 (in-sample avg dev_std = 0.019)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.641
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 272
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.619
NEC for r=0.4 class 0.0 = 0.01 +- 0.015 (in-sample avg dev_std = 0.028)
NEC for r=0.4 class 1.0 = 0.029 +- 0.015 (in-sample avg dev_std = 0.028)
NEC for r=0.4 all KL = 0.006 +- 0.015 (in-sample avg dev_std = 0.028)
NEC for r=0.4 all L1 = 0.02 +- 0.035 (in-sample avg dev_std = 0.028)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.683
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.648
NEC for r=0.6 class 0.0 = 0.012 +- 0.037 (in-sample avg dev_std = 0.049)
NEC for r=0.6 class 1.0 = 0.049 +- 0.037 (in-sample avg dev_std = 0.049)
NEC for r=0.6 all KL = 0.013 +- 0.037 (in-sample avg dev_std = 0.049)
NEC for r=0.6 all L1 = 0.03 +- 0.061 (in-sample avg dev_std = 0.049)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.718
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.718
NEC for r=0.9 class 0.0 = 0.012 +- 0.030 (in-sample avg dev_std = 0.062)
NEC for r=0.9 class 1.0 = 0.051 +- 0.030 (in-sample avg dev_std = 0.062)
NEC for r=0.9 all KL = 0.01 +- 0.030 (in-sample avg dev_std = 0.062)
NEC for r=0.9 all L1 = 0.032 +- 0.061 (in-sample avg dev_std = 0.062)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.726
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 272
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.709
NEC for r=0.95 class 0.0 = 0.013 +- 0.031 (in-sample avg dev_std = 0.064)
NEC for r=0.95 class 1.0 = 0.052 +- 0.031 (in-sample avg dev_std = 0.064)
NEC for r=0.95 all KL = 0.01 +- 0.031 (in-sample avg dev_std = 0.064)
NEC for r=0.95 all L1 = 0.032 +- 0.064 (in-sample avg dev_std = 0.064)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.735
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 272
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.728
NEC for r=1.0 class 0.0 = 0.012 +- 0.032 (in-sample avg dev_std = 0.076)
NEC for r=1.0 class 1.0 = 0.049 +- 0.032 (in-sample avg dev_std = 0.076)
NEC for r=1.0 all KL = 0.01 +- 0.032 (in-sample avg dev_std = 0.076)
NEC for r=1.0 all L1 = 0.03 +- 0.062 (in-sample avg dev_std = 0.076)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.58
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.558
NEC for r=0.3 class 0.0 = 0.008 +- 0.007 (in-sample avg dev_std = 0.014)
NEC for r=0.3 class 1.0 = 0.016 +- 0.007 (in-sample avg dev_std = 0.014)
NEC for r=0.3 all KL = 0.003 +- 0.007 (in-sample avg dev_std = 0.014)
NEC for r=0.3 all L1 = 0.012 +- 0.018 (in-sample avg dev_std = 0.014)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.588
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.584
NEC for r=0.4 class 0.0 = 0.008 +- 0.007 (in-sample avg dev_std = 0.016)
NEC for r=0.4 class 1.0 = 0.018 +- 0.007 (in-sample avg dev_std = 0.016)
NEC for r=0.4 all KL = 0.003 +- 0.007 (in-sample avg dev_std = 0.016)
NEC for r=0.4 all L1 = 0.013 +- 0.019 (in-sample avg dev_std = 0.016)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.62
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.625
NEC for r=0.6 class 0.0 = 0.011 +- 0.018 (in-sample avg dev_std = 0.025)
NEC for r=0.6 class 1.0 = 0.027 +- 0.018 (in-sample avg dev_std = 0.025)
NEC for r=0.6 all KL = 0.006 +- 0.018 (in-sample avg dev_std = 0.025)
NEC for r=0.6 all L1 = 0.019 +- 0.033 (in-sample avg dev_std = 0.025)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.667
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.644
NEC for r=0.9 class 0.0 = 0.015 +- 0.009 (in-sample avg dev_std = 0.026)
NEC for r=0.9 class 1.0 = 0.027 +- 0.009 (in-sample avg dev_std = 0.026)
NEC for r=0.9 all KL = 0.005 +- 0.009 (in-sample avg dev_std = 0.026)
NEC for r=0.9 all L1 = 0.021 +- 0.030 (in-sample avg dev_std = 0.026)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.664
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 162
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.626
NEC for r=0.95 class 0.0 = 0.018 +- 0.013 (in-sample avg dev_std = 0.030)
NEC for r=0.95 class 1.0 = 0.031 +- 0.013 (in-sample avg dev_std = 0.030)
NEC for r=0.95 all KL = 0.005 +- 0.013 (in-sample avg dev_std = 0.030)
NEC for r=0.95 all L1 = 0.024 +- 0.036 (in-sample avg dev_std = 0.030)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.648
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.631
NEC for r=1.0 class 0.0 = 0.016 +- 0.015 (in-sample avg dev_std = 0.027)
NEC for r=1.0 class 1.0 = 0.035 +- 0.015 (in-sample avg dev_std = 0.027)
NEC for r=1.0 all KL = 0.006 +- 0.015 (in-sample avg dev_std = 0.027)
NEC for r=1.0 all L1 = 0.026 +- 0.039 (in-sample avg dev_std = 0.027)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.627
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 272
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.589
SUFF++ for r=0.3 class 0.0 = 0.987 +- 0.020 (in-sample avg dev_std = 0.044)
SUFF++ for r=0.3 class 1.0 = 0.974 +- 0.020 (in-sample avg dev_std = 0.044)
SUFF++ for r=0.3 all KL = 0.992 +- 0.020 (in-sample avg dev_std = 0.044)
SUFF++ for r=0.3 all L1 = 0.98 +- 0.026 (in-sample avg dev_std = 0.044)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.641
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 272
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.585
SUFF++ for r=0.4 class 0.0 = 0.986 +- 0.020 (in-sample avg dev_std = 0.040)
SUFF++ for r=0.4 class 1.0 = 0.967 +- 0.020 (in-sample avg dev_std = 0.040)
SUFF++ for r=0.4 all KL = 0.991 +- 0.020 (in-sample avg dev_std = 0.040)
SUFF++ for r=0.4 all L1 = 0.977 +- 0.038 (in-sample avg dev_std = 0.040)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.683
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.625
SUFF++ for r=0.6 class 0.0 = 0.984 +- 0.039 (in-sample avg dev_std = 0.045)
SUFF++ for r=0.6 class 1.0 = 0.951 +- 0.039 (in-sample avg dev_std = 0.045)
SUFF++ for r=0.6 all KL = 0.986 +- 0.039 (in-sample avg dev_std = 0.045)
SUFF++ for r=0.6 all L1 = 0.967 +- 0.061 (in-sample avg dev_std = 0.045)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.718
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.699
SUFF++ for r=0.9 class 0.0 = 0.987 +- 0.021 (in-sample avg dev_std = 0.048)
SUFF++ for r=0.9 class 1.0 = 0.952 +- 0.021 (in-sample avg dev_std = 0.048)
SUFF++ for r=0.9 all KL = 0.992 +- 0.021 (in-sample avg dev_std = 0.048)
SUFF++ for r=0.9 all L1 = 0.969 +- 0.056 (in-sample avg dev_std = 0.048)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.728
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 270
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.702
SUFF++ for r=0.95 class 0.0 = 0.992 +- 0.019 (in-sample avg dev_std = 0.044)
SUFF++ for r=0.95 class 1.0 = 0.964 +- 0.019 (in-sample avg dev_std = 0.044)
SUFF++ for r=0.95 all KL = 0.995 +- 0.019 (in-sample avg dev_std = 0.044)
SUFF++ for r=0.95 all L1 = 0.978 +- 0.050 (in-sample avg dev_std = 0.044)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.581
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.557
SUFF++ for r=0.3 class 0.0 = 0.99 +- 0.011 (in-sample avg dev_std = 0.027)
SUFF++ for r=0.3 class 1.0 = 0.981 +- 0.011 (in-sample avg dev_std = 0.027)
SUFF++ for r=0.3 all KL = 0.996 +- 0.011 (in-sample avg dev_std = 0.027)
SUFF++ for r=0.3 all L1 = 0.986 +- 0.018 (in-sample avg dev_std = 0.027)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.588
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.594
SUFF++ for r=0.4 class 0.0 = 0.989 +- 0.014 (in-sample avg dev_std = 0.029)
SUFF++ for r=0.4 class 1.0 = 0.978 +- 0.014 (in-sample avg dev_std = 0.029)
SUFF++ for r=0.4 all KL = 0.995 +- 0.014 (in-sample avg dev_std = 0.029)
SUFF++ for r=0.4 all L1 = 0.983 +- 0.022 (in-sample avg dev_std = 0.029)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.62
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.59
SUFF++ for r=0.6 class 0.0 = 0.987 +- 0.013 (in-sample avg dev_std = 0.028)
SUFF++ for r=0.6 class 1.0 = 0.972 +- 0.013 (in-sample avg dev_std = 0.028)
SUFF++ for r=0.6 all KL = 0.994 +- 0.013 (in-sample avg dev_std = 0.028)
SUFF++ for r=0.6 all L1 = 0.979 +- 0.029 (in-sample avg dev_std = 0.028)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.667
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.64
SUFF++ for r=0.9 class 0.0 = 0.986 +- 0.011 (in-sample avg dev_std = 0.024)
SUFF++ for r=0.9 class 1.0 = 0.976 +- 0.011 (in-sample avg dev_std = 0.024)
SUFF++ for r=0.9 all KL = 0.996 +- 0.011 (in-sample avg dev_std = 0.024)
SUFF++ for r=0.9 all L1 = 0.981 +- 0.032 (in-sample avg dev_std = 0.024)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.657
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 161
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.634
SUFF++ for r=0.95 class 0.0 = 0.991 +- 0.006 (in-sample avg dev_std = 0.023)
SUFF++ for r=0.95 class 1.0 = 0.984 +- 0.006 (in-sample avg dev_std = 0.023)
SUFF++ for r=0.95 all KL = 0.998 +- 0.006 (in-sample avg dev_std = 0.023)
SUFF++ for r=0.95 all L1 = 0.987 +- 0.020 (in-sample avg dev_std = 0.023)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:29:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:35 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:39 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:42 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:45 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ROC-AUC: 0.9193
Train Loss: 0.0894
ID Validation ROC-AUC: 0.8354
ID Validation Loss: 0.1257
ID Test ROC-AUC: 0.8084
ID Test Loss: 0.1109
OOD Validation ROC-AUC: 0.7601
OOD Validation Loss: 0.1176
OOD Test ROC-AUC: 0.7290
OOD Test Loss: 0.0872

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 35...
[0m[1;37mINFO[0m: [1mCheckpoint 35: 
-----------------------------------
Train ROC-AUC: 0.8677
Train Loss: 0.1098
ID Validation ROC-AUC: 0.8315
ID Validation Loss: 0.1337
ID Test ROC-AUC: 0.8039
ID Test Loss: 0.1138
OOD Validation ROC-AUC: 0.7858
OOD Validation Loss: 0.1065
OOD Test ROC-AUC: 0.7517
OOD Test Loss: 0.0875

[0m[1;37mINFO[0m: [1mChartInfo 0.8084 0.7290 0.8039 0.7517 0.8315 0.7858[0mGOODHIV(4112)
Data example from id_test: Data(x=[23, 9], edge_index=[2, 48], edge_attr=[48, 3], y=[1, 1], smiles='Cc1occc1C(=S)Nc1ccc(Cl)c(C(=O)OCC(C)C)c1', idx=[1], scaffold='S=C(Nc1ccccc1)c1ccoc1', domain_id=[1], env_id=[1], ori_edge_index=[2, 48], node_perm=[23])
Label distribution from id_test: (tensor([0., 1.]), tensor([3976,  136]))
[1;34mDEBUG[0m: 05/08/2024 04:29:48 PM : [1mUnbalanced warning for GOODHIV (id_test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([136, 136]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 05/08/2024 04:29:49 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.675
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 272
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.566
NEC for r=0.3 class 0.0 = 0.045 +- 0.080 (in-sample avg dev_std = 0.095)
NEC for r=0.3 class 1.0 = 0.098 +- 0.080 (in-sample avg dev_std = 0.095)
NEC for r=0.3 all KL = 0.041 +- 0.080 (in-sample avg dev_std = 0.095)
NEC for r=0.3 all L1 = 0.072 +- 0.102 (in-sample avg dev_std = 0.095)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.7
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 272
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.636
NEC for r=0.4 class 0.0 = 0.05 +- 0.087 (in-sample avg dev_std = 0.117)
NEC for r=0.4 class 1.0 = 0.126 +- 0.087 (in-sample avg dev_std = 0.117)
NEC for r=0.4 all KL = 0.049 +- 0.087 (in-sample avg dev_std = 0.117)
NEC for r=0.4 all L1 = 0.088 +- 0.111 (in-sample avg dev_std = 0.117)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.77
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.725
NEC for r=0.6 class 0.0 = 0.067 +- 0.087 (in-sample avg dev_std = 0.126)
NEC for r=0.6 class 1.0 = 0.148 +- 0.087 (in-sample avg dev_std = 0.126)
NEC for r=0.6 all KL = 0.055 +- 0.087 (in-sample avg dev_std = 0.126)
NEC for r=0.6 all L1 = 0.108 +- 0.110 (in-sample avg dev_std = 0.126)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.788
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.77
NEC for r=0.9 class 0.0 = 0.052 +- 0.053 (in-sample avg dev_std = 0.110)
NEC for r=0.9 class 1.0 = 0.12 +- 0.053 (in-sample avg dev_std = 0.110)
NEC for r=0.9 all KL = 0.034 +- 0.053 (in-sample avg dev_std = 0.110)
NEC for r=0.9 all L1 = 0.086 +- 0.089 (in-sample avg dev_std = 0.110)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.797
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 272
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.763
NEC for r=0.95 class 0.0 = 0.055 +- 0.061 (in-sample avg dev_std = 0.115)
NEC for r=0.95 class 1.0 = 0.117 +- 0.061 (in-sample avg dev_std = 0.115)
NEC for r=0.95 all KL = 0.036 +- 0.061 (in-sample avg dev_std = 0.115)
NEC for r=0.95 all L1 = 0.086 +- 0.090 (in-sample avg dev_std = 0.115)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.794
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 272
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.775
NEC for r=1.0 class 0.0 = 0.052 +- 0.050 (in-sample avg dev_std = 0.108)
NEC for r=1.0 class 1.0 = 0.115 +- 0.050 (in-sample avg dev_std = 0.108)
NEC for r=1.0 all KL = 0.032 +- 0.050 (in-sample avg dev_std = 0.108)
NEC for r=1.0 all L1 = 0.083 +- 0.089 (in-sample avg dev_std = 0.108)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.528
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.527
NEC for r=0.3 class 0.0 = 0.036 +- 0.067 (in-sample avg dev_std = 0.056)
NEC for r=0.3 class 1.0 = 0.05 +- 0.067 (in-sample avg dev_std = 0.056)
NEC for r=0.3 all KL = 0.025 +- 0.067 (in-sample avg dev_std = 0.056)
NEC for r=0.3 all L1 = 0.043 +- 0.079 (in-sample avg dev_std = 0.056)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.579
NEC for r=0.4 class 0.0 = 0.042 +- 0.056 (in-sample avg dev_std = 0.086)
NEC for r=0.4 class 1.0 = 0.07 +- 0.056 (in-sample avg dev_std = 0.086)
NEC for r=0.4 all KL = 0.029 +- 0.056 (in-sample avg dev_std = 0.086)
NEC for r=0.4 all L1 = 0.056 +- 0.083 (in-sample avg dev_std = 0.086)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.622
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.635
NEC for r=0.6 class 0.0 = 0.048 +- 0.057 (in-sample avg dev_std = 0.087)
NEC for r=0.6 class 1.0 = 0.101 +- 0.057 (in-sample avg dev_std = 0.087)
NEC for r=0.6 all KL = 0.031 +- 0.057 (in-sample avg dev_std = 0.087)
NEC for r=0.6 all L1 = 0.075 +- 0.096 (in-sample avg dev_std = 0.087)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.696
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.695
NEC for r=0.9 class 0.0 = 0.041 +- 0.049 (in-sample avg dev_std = 0.083)
NEC for r=0.9 class 1.0 = 0.096 +- 0.049 (in-sample avg dev_std = 0.083)
NEC for r=0.9 all KL = 0.023 +- 0.049 (in-sample avg dev_std = 0.083)
NEC for r=0.9 all L1 = 0.069 +- 0.082 (in-sample avg dev_std = 0.083)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.717
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 162
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.7
NEC for r=0.95 class 0.0 = 0.042 +- 0.042 (in-sample avg dev_std = 0.081)
NEC for r=0.95 class 1.0 = 0.089 +- 0.042 (in-sample avg dev_std = 0.081)
NEC for r=0.95 all KL = 0.021 +- 0.042 (in-sample avg dev_std = 0.081)
NEC for r=0.95 all L1 = 0.066 +- 0.077 (in-sample avg dev_std = 0.081)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.725
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.709
NEC for r=1.0 class 0.0 = 0.039 +- 0.034 (in-sample avg dev_std = 0.080)
NEC for r=1.0 class 1.0 = 0.086 +- 0.034 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all KL = 0.018 +- 0.034 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all L1 = 0.063 +- 0.076 (in-sample avg dev_std = 0.080)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.678
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 272
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.584
SUFF++ for r=0.3 class 0.0 = 0.936 +- 0.073 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.3 class 1.0 = 0.884 +- 0.073 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.3 all KL = 0.942 +- 0.073 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.3 all L1 = 0.91 +- 0.092 (in-sample avg dev_std = 0.129)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.701
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 272
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.634
SUFF++ for r=0.4 class 0.0 = 0.928 +- 0.094 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.4 class 1.0 = 0.848 +- 0.094 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.4 all KL = 0.926 +- 0.094 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.4 all L1 = 0.888 +- 0.108 (in-sample avg dev_std = 0.158)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.769
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.699
SUFF++ for r=0.6 class 0.0 = 0.913 +- 0.092 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.6 class 1.0 = 0.816 +- 0.092 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.6 all KL = 0.919 +- 0.092 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.6 all L1 = 0.864 +- 0.119 (in-sample avg dev_std = 0.183)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.786
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 271
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.751
SUFF++ for r=0.9 class 0.0 = 0.944 +- 0.068 (in-sample avg dev_std = 0.128)
SUFF++ for r=0.9 class 1.0 = 0.869 +- 0.068 (in-sample avg dev_std = 0.128)
SUFF++ for r=0.9 all KL = 0.96 +- 0.068 (in-sample avg dev_std = 0.128)
SUFF++ for r=0.9 all L1 = 0.907 +- 0.104 (in-sample avg dev_std = 0.128)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.799
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 270
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.754
SUFF++ for r=0.95 class 0.0 = 0.966 +- 0.044 (in-sample avg dev_std = 0.086)
SUFF++ for r=0.95 class 1.0 = 0.916 +- 0.044 (in-sample avg dev_std = 0.086)
SUFF++ for r=0.95 all KL = 0.981 +- 0.044 (in-sample avg dev_std = 0.086)
SUFF++ for r=0.95 all L1 = 0.941 +- 0.076 (in-sample avg dev_std = 0.086)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.527
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.53
SUFF++ for r=0.3 class 0.0 = 0.955 +- 0.048 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.3 class 1.0 = 0.946 +- 0.048 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.3 all KL = 0.968 +- 0.048 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.3 all L1 = 0.95 +- 0.060 (in-sample avg dev_std = 0.094)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.536
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.567
SUFF++ for r=0.4 class 0.0 = 0.944 +- 0.079 (in-sample avg dev_std = 0.120)
SUFF++ for r=0.4 class 1.0 = 0.907 +- 0.079 (in-sample avg dev_std = 0.120)
SUFF++ for r=0.4 all KL = 0.949 +- 0.079 (in-sample avg dev_std = 0.120)
SUFF++ for r=0.4 all L1 = 0.925 +- 0.092 (in-sample avg dev_std = 0.120)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.622
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.616
SUFF++ for r=0.6 class 0.0 = 0.926 +- 0.071 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.6 class 1.0 = 0.878 +- 0.071 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.6 all KL = 0.944 +- 0.071 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.6 all L1 = 0.902 +- 0.096 (in-sample avg dev_std = 0.141)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.696
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.677
SUFF++ for r=0.9 class 0.0 = 0.953 +- 0.053 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.9 class 1.0 = 0.885 +- 0.053 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.9 all KL = 0.968 +- 0.053 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.9 all L1 = 0.919 +- 0.093 (in-sample avg dev_std = 0.111)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.72
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 160
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.699
SUFF++ for r=0.95 class 0.0 = 0.976 +- 0.038 (in-sample avg dev_std = 0.086)
SUFF++ for r=0.95 class 1.0 = 0.927 +- 0.038 (in-sample avg dev_std = 0.086)
SUFF++ for r=0.95 all KL = 0.984 +- 0.038 (in-sample avg dev_std = 0.086)
SUFF++ for r=0.95 all L1 = 0.952 +- 0.068 (in-sample avg dev_std = 0.086)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:30:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 05/08/2024 04:30:50 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:30:53 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:30:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:30:59 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ROC-AUC: 0.9408
Train Loss: 0.0845
ID Validation ROC-AUC: 0.8353
ID Validation Loss: 0.1363
ID Test ROC-AUC: 0.8180
ID Test Loss: 0.1216
OOD Validation ROC-AUC: 0.7710
OOD Validation Loss: 0.1283
OOD Test ROC-AUC: 0.7279
OOD Test Loss: 0.0901

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ROC-AUC: 0.9312
Train Loss: 0.0842
ID Validation ROC-AUC: 0.8199
ID Validation Loss: 0.1342
ID Test ROC-AUC: 0.7980
ID Test Loss: 0.1163
OOD Validation ROC-AUC: 0.7737
OOD Validation Loss: 0.1243
OOD Test ROC-AUC: 0.7203
OOD Test Loss: 0.0949

[0m[1;37mINFO[0m: [1mChartInfo 0.8180 0.7279 0.7980 0.7203 0.8199 0.7737[0mGOODHIV(4112)
Data example from id_test: Data(x=[23, 9], edge_index=[2, 48], edge_attr=[48, 3], y=[1, 1], smiles='Cc1occc1C(=S)Nc1ccc(Cl)c(C(=O)OCC(C)C)c1', idx=[1], scaffold='S=C(Nc1ccccc1)c1ccoc1', domain_id=[1], env_id=[1], ori_edge_index=[2, 48], node_perm=[23])
Label distribution from id_test: (tensor([0., 1.]), tensor([3976,  136]))
[1;34mDEBUG[0m: 05/08/2024 04:31:02 PM : [1mUnbalanced warning for GOODHIV (id_test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([136, 136]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 05/08/2024 04:31:04 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 272
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.629
NEC for r=0.3 class 0.0 = 0.137 +- 0.132 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 1.0 = 0.226 +- 0.132 (in-sample avg dev_std = 0.176)
NEC for r=0.3 all KL = 0.104 +- 0.132 (in-sample avg dev_std = 0.176)
NEC for r=0.3 all L1 = 0.181 +- 0.159 (in-sample avg dev_std = 0.176)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.624
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 272
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.646
NEC for r=0.4 class 0.0 = 0.154 +- 0.117 (in-sample avg dev_std = 0.198)
NEC for r=0.4 class 1.0 = 0.23 +- 0.117 (in-sample avg dev_std = 0.198)
NEC for r=0.4 all KL = 0.098 +- 0.117 (in-sample avg dev_std = 0.198)
NEC for r=0.4 all L1 = 0.192 +- 0.156 (in-sample avg dev_std = 0.198)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.668
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.684
NEC for r=0.6 class 0.0 = 0.15 +- 0.115 (in-sample avg dev_std = 0.211)
NEC for r=0.6 class 1.0 = 0.239 +- 0.115 (in-sample avg dev_std = 0.211)
NEC for r=0.6 all KL = 0.092 +- 0.115 (in-sample avg dev_std = 0.211)
NEC for r=0.6 all L1 = 0.195 +- 0.154 (in-sample avg dev_std = 0.211)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.756
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.725
NEC for r=0.9 class 0.0 = 0.107 +- 0.099 (in-sample avg dev_std = 0.179)
NEC for r=0.9 class 1.0 = 0.184 +- 0.099 (in-sample avg dev_std = 0.179)
NEC for r=0.9 all KL = 0.062 +- 0.099 (in-sample avg dev_std = 0.179)
NEC for r=0.9 all L1 = 0.146 +- 0.140 (in-sample avg dev_std = 0.179)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.76
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 272
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.728
NEC for r=0.95 class 0.0 = 0.094 +- 0.082 (in-sample avg dev_std = 0.172)
NEC for r=0.95 class 1.0 = 0.17 +- 0.082 (in-sample avg dev_std = 0.172)
NEC for r=0.95 all KL = 0.054 +- 0.082 (in-sample avg dev_std = 0.172)
NEC for r=0.95 all L1 = 0.132 +- 0.126 (in-sample avg dev_std = 0.172)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.762
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 272
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.729
NEC for r=1.0 class 0.0 = 0.077 +- 0.087 (in-sample avg dev_std = 0.170)
NEC for r=1.0 class 1.0 = 0.17 +- 0.087 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all KL = 0.053 +- 0.087 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all L1 = 0.124 +- 0.128 (in-sample avg dev_std = 0.170)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.619
NEC for r=0.3 class 0.0 = 0.084 +- 0.108 (in-sample avg dev_std = 0.143)
NEC for r=0.3 class 1.0 = 0.163 +- 0.108 (in-sample avg dev_std = 0.143)
NEC for r=0.3 all KL = 0.071 +- 0.108 (in-sample avg dev_std = 0.143)
NEC for r=0.3 all L1 = 0.124 +- 0.135 (in-sample avg dev_std = 0.143)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.664
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.623
NEC for r=0.4 class 0.0 = 0.089 +- 0.094 (in-sample avg dev_std = 0.136)
NEC for r=0.4 class 1.0 = 0.173 +- 0.094 (in-sample avg dev_std = 0.136)
NEC for r=0.4 all KL = 0.068 +- 0.094 (in-sample avg dev_std = 0.136)
NEC for r=0.4 all L1 = 0.131 +- 0.126 (in-sample avg dev_std = 0.136)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.698
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.674
NEC for r=0.6 class 0.0 = 0.07 +- 0.103 (in-sample avg dev_std = 0.139)
NEC for r=0.6 class 1.0 = 0.196 +- 0.103 (in-sample avg dev_std = 0.139)
NEC for r=0.6 all KL = 0.066 +- 0.103 (in-sample avg dev_std = 0.139)
NEC for r=0.6 all L1 = 0.133 +- 0.134 (in-sample avg dev_std = 0.139)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.692
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.696
NEC for r=0.9 class 0.0 = 0.05 +- 0.069 (in-sample avg dev_std = 0.128)
NEC for r=0.9 class 1.0 = 0.149 +- 0.069 (in-sample avg dev_std = 0.128)
NEC for r=0.9 all KL = 0.039 +- 0.069 (in-sample avg dev_std = 0.128)
NEC for r=0.9 all L1 = 0.099 +- 0.115 (in-sample avg dev_std = 0.128)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.695
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 162
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.699
NEC for r=0.95 class 0.0 = 0.055 +- 0.063 (in-sample avg dev_std = 0.123)
NEC for r=0.95 class 1.0 = 0.131 +- 0.063 (in-sample avg dev_std = 0.123)
NEC for r=0.95 all KL = 0.036 +- 0.063 (in-sample avg dev_std = 0.123)
NEC for r=0.95 all L1 = 0.093 +- 0.109 (in-sample avg dev_std = 0.123)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.696
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.692
NEC for r=1.0 class 0.0 = 0.047 +- 0.069 (in-sample avg dev_std = 0.135)
NEC for r=1.0 class 1.0 = 0.133 +- 0.069 (in-sample avg dev_std = 0.135)
NEC for r=1.0 all KL = 0.039 +- 0.069 (in-sample avg dev_std = 0.135)
NEC for r=1.0 all L1 = 0.09 +- 0.107 (in-sample avg dev_std = 0.135)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 272
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.574
SUFF++ for r=0.3 class 0.0 = 0.824 +- 0.118 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.3 class 1.0 = 0.756 +- 0.118 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.3 all KL = 0.856 +- 0.118 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.3 all L1 = 0.79 +- 0.123 (in-sample avg dev_std = 0.257)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.624
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 272
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.593
SUFF++ for r=0.4 class 0.0 = 0.79 +- 0.127 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.4 class 1.0 = 0.742 +- 0.127 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.4 all KL = 0.848 +- 0.127 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.4 all L1 = 0.766 +- 0.128 (in-sample avg dev_std = 0.277)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.667
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.646
SUFF++ for r=0.6 class 0.0 = 0.809 +- 0.116 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.6 class 1.0 = 0.729 +- 0.116 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.6 all KL = 0.867 +- 0.116 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.6 all L1 = 0.769 +- 0.145 (in-sample avg dev_std = 0.270)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.755
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.724
SUFF++ for r=0.9 class 0.0 = 0.908 +- 0.073 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.9 class 1.0 = 0.82 +- 0.073 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.9 all KL = 0.947 +- 0.073 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.9 all L1 = 0.864 +- 0.128 (in-sample avg dev_std = 0.176)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.763
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 270
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.748
SUFF++ for r=0.95 class 0.0 = 0.945 +- 0.047 (in-sample avg dev_std = 0.132)
SUFF++ for r=0.95 class 1.0 = 0.882 +- 0.047 (in-sample avg dev_std = 0.132)
SUFF++ for r=0.95 all KL = 0.974 +- 0.047 (in-sample avg dev_std = 0.132)
SUFF++ for r=0.95 all L1 = 0.913 +- 0.092 (in-sample avg dev_std = 0.132)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.579
SUFF++ for r=0.3 class 0.0 = 0.879 +- 0.104 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.3 class 1.0 = 0.807 +- 0.104 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.3 all KL = 0.892 +- 0.104 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.3 all L1 = 0.843 +- 0.117 (in-sample avg dev_std = 0.205)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.664
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.576
SUFF++ for r=0.4 class 0.0 = 0.848 +- 0.102 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.4 class 1.0 = 0.793 +- 0.102 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.4 all KL = 0.88 +- 0.102 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.4 all L1 = 0.82 +- 0.113 (in-sample avg dev_std = 0.234)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.697
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.638
SUFF++ for r=0.6 class 0.0 = 0.873 +- 0.108 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.6 class 1.0 = 0.767 +- 0.108 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.6 all KL = 0.889 +- 0.108 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.6 all L1 = 0.82 +- 0.133 (in-sample avg dev_std = 0.225)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.692
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.667
SUFF++ for r=0.9 class 0.0 = 0.93 +- 0.078 (in-sample avg dev_std = 0.149)
SUFF++ for r=0.9 class 1.0 = 0.851 +- 0.078 (in-sample avg dev_std = 0.149)
SUFF++ for r=0.9 all KL = 0.953 +- 0.078 (in-sample avg dev_std = 0.149)
SUFF++ for r=0.9 all L1 = 0.89 +- 0.121 (in-sample avg dev_std = 0.149)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.691
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 161
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.676
SUFF++ for r=0.95 class 0.0 = 0.957 +- 0.041 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.95 class 1.0 = 0.901 +- 0.041 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.95 all KL = 0.976 +- 0.041 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.95 all L1 = 0.929 +- 0.085 (in-sample avg dev_std = 0.117)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:32:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:05 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:08 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:11 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:14 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ROC-AUC: 0.9672
Train Loss: 0.0711
ID Validation ROC-AUC: 0.8273
ID Validation Loss: 0.1308
ID Test ROC-AUC: 0.8111
ID Test Loss: 0.1127
OOD Validation ROC-AUC: 0.7208
OOD Validation Loss: 0.1246
OOD Test ROC-AUC: 0.6528
OOD Test Loss: 0.0969

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 38...
[0m[1;37mINFO[0m: [1mCheckpoint 38: 
-----------------------------------
Train ROC-AUC: 0.8696
Train Loss: 0.1264
ID Validation ROC-AUC: 0.8184
ID Validation Loss: 0.1532
ID Test ROC-AUC: 0.8196
ID Test Loss: 0.1278
OOD Validation ROC-AUC: 0.7775
OOD Validation Loss: 0.1197
OOD Test ROC-AUC: 0.7122
OOD Test Loss: 0.1159

[0m[1;37mINFO[0m: [1mChartInfo 0.8111 0.6528 0.8196 0.7122 0.8184 0.7775[0mGOODHIV(4112)
Data example from id_test: Data(x=[23, 9], edge_index=[2, 48], edge_attr=[48, 3], y=[1, 1], smiles='Cc1occc1C(=S)Nc1ccc(Cl)c(C(=O)OCC(C)C)c1', idx=[1], scaffold='S=C(Nc1ccccc1)c1ccoc1', domain_id=[1], env_id=[1], ori_edge_index=[2, 48], node_perm=[23])
Label distribution from id_test: (tensor([0., 1.]), tensor([3976,  136]))
[1;34mDEBUG[0m: 05/08/2024 04:32:17 PM : [1mUnbalanced warning for GOODHIV (id_test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([136, 136]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 05/08/2024 04:32:19 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.654
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 272
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.635
NEC for r=0.3 class 0.0 = 0.107 +- 0.112 (in-sample avg dev_std = 0.160)
NEC for r=0.3 class 1.0 = 0.168 +- 0.112 (in-sample avg dev_std = 0.160)
NEC for r=0.3 all KL = 0.077 +- 0.112 (in-sample avg dev_std = 0.160)
NEC for r=0.3 all L1 = 0.137 +- 0.145 (in-sample avg dev_std = 0.160)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.671
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 272
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.657
NEC for r=0.4 class 0.0 = 0.126 +- 0.105 (in-sample avg dev_std = 0.170)
NEC for r=0.4 class 1.0 = 0.19 +- 0.105 (in-sample avg dev_std = 0.170)
NEC for r=0.4 all KL = 0.079 +- 0.105 (in-sample avg dev_std = 0.170)
NEC for r=0.4 all L1 = 0.158 +- 0.142 (in-sample avg dev_std = 0.170)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.731
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.681
NEC for r=0.6 class 0.0 = 0.134 +- 0.094 (in-sample avg dev_std = 0.185)
NEC for r=0.6 class 1.0 = 0.198 +- 0.094 (in-sample avg dev_std = 0.185)
NEC for r=0.6 all KL = 0.073 +- 0.094 (in-sample avg dev_std = 0.185)
NEC for r=0.6 all L1 = 0.166 +- 0.140 (in-sample avg dev_std = 0.185)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.75
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.712
NEC for r=0.9 class 0.0 = 0.114 +- 0.065 (in-sample avg dev_std = 0.149)
NEC for r=0.9 class 1.0 = 0.167 +- 0.065 (in-sample avg dev_std = 0.149)
NEC for r=0.9 all KL = 0.043 +- 0.065 (in-sample avg dev_std = 0.149)
NEC for r=0.9 all L1 = 0.141 +- 0.117 (in-sample avg dev_std = 0.149)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.748
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 272
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.719
NEC for r=0.95 class 0.0 = 0.109 +- 0.061 (in-sample avg dev_std = 0.152)
NEC for r=0.95 class 1.0 = 0.156 +- 0.061 (in-sample avg dev_std = 0.152)
NEC for r=0.95 all KL = 0.041 +- 0.061 (in-sample avg dev_std = 0.152)
NEC for r=0.95 all L1 = 0.133 +- 0.111 (in-sample avg dev_std = 0.152)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.748
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 272
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.719
NEC for r=1.0 class 0.0 = 0.102 +- 0.068 (in-sample avg dev_std = 0.153)
NEC for r=1.0 class 1.0 = 0.154 +- 0.068 (in-sample avg dev_std = 0.153)
NEC for r=1.0 all KL = 0.04 +- 0.068 (in-sample avg dev_std = 0.153)
NEC for r=1.0 all L1 = 0.128 +- 0.117 (in-sample avg dev_std = 0.153)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.616
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.607
NEC for r=0.3 class 0.0 = 0.06 +- 0.082 (in-sample avg dev_std = 0.111)
NEC for r=0.3 class 1.0 = 0.08 +- 0.082 (in-sample avg dev_std = 0.111)
NEC for r=0.3 all KL = 0.041 +- 0.082 (in-sample avg dev_std = 0.111)
NEC for r=0.3 all L1 = 0.07 +- 0.107 (in-sample avg dev_std = 0.111)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.606
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.599
NEC for r=0.4 class 0.0 = 0.073 +- 0.068 (in-sample avg dev_std = 0.118)
NEC for r=0.4 class 1.0 = 0.092 +- 0.068 (in-sample avg dev_std = 0.118)
NEC for r=0.4 all KL = 0.045 +- 0.068 (in-sample avg dev_std = 0.118)
NEC for r=0.4 all L1 = 0.082 +- 0.101 (in-sample avg dev_std = 0.118)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.588
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.596
NEC for r=0.6 class 0.0 = 0.091 +- 0.089 (in-sample avg dev_std = 0.138)
NEC for r=0.6 class 1.0 = 0.119 +- 0.089 (in-sample avg dev_std = 0.138)
NEC for r=0.6 all KL = 0.059 +- 0.089 (in-sample avg dev_std = 0.138)
NEC for r=0.6 all L1 = 0.105 +- 0.111 (in-sample avg dev_std = 0.138)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.632
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.612
NEC for r=0.9 class 0.0 = 0.082 +- 0.043 (in-sample avg dev_std = 0.107)
NEC for r=0.9 class 1.0 = 0.104 +- 0.043 (in-sample avg dev_std = 0.107)
NEC for r=0.9 all KL = 0.03 +- 0.043 (in-sample avg dev_std = 0.107)
NEC for r=0.9 all L1 = 0.093 +- 0.088 (in-sample avg dev_std = 0.107)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.654
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 162
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.618
NEC for r=0.95 class 0.0 = 0.079 +- 0.049 (in-sample avg dev_std = 0.112)
NEC for r=0.95 class 1.0 = 0.109 +- 0.049 (in-sample avg dev_std = 0.112)
NEC for r=0.95 all KL = 0.031 +- 0.049 (in-sample avg dev_std = 0.112)
NEC for r=0.95 all L1 = 0.094 +- 0.094 (in-sample avg dev_std = 0.112)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.663
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.621
NEC for r=1.0 class 0.0 = 0.077 +- 0.048 (in-sample avg dev_std = 0.112)
NEC for r=1.0 class 1.0 = 0.11 +- 0.048 (in-sample avg dev_std = 0.112)
NEC for r=1.0 all KL = 0.032 +- 0.048 (in-sample avg dev_std = 0.112)
NEC for r=1.0 all L1 = 0.093 +- 0.093 (in-sample avg dev_std = 0.112)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.653
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 272
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.619
SUFF++ for r=0.3 class 0.0 = 0.84 +- 0.123 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 1.0 = 0.782 +- 0.123 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 all KL = 0.849 +- 0.123 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 all L1 = 0.811 +- 0.124 (in-sample avg dev_std = 0.259)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.671
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 272
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.637
SUFF++ for r=0.4 class 0.0 = 0.82 +- 0.122 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.4 class 1.0 = 0.765 +- 0.122 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.4 all KL = 0.85 +- 0.122 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.4 all L1 = 0.793 +- 0.129 (in-sample avg dev_std = 0.269)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.731
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.68
SUFF++ for r=0.6 class 0.0 = 0.823 +- 0.106 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.6 class 1.0 = 0.778 +- 0.106 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.6 all KL = 0.884 +- 0.106 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.6 all L1 = 0.801 +- 0.120 (in-sample avg dev_std = 0.252)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.75
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.736
SUFF++ for r=0.9 class 0.0 = 0.885 +- 0.061 (in-sample avg dev_std = 0.156)
SUFF++ for r=0.9 class 1.0 = 0.853 +- 0.061 (in-sample avg dev_std = 0.156)
SUFF++ for r=0.9 all KL = 0.959 +- 0.061 (in-sample avg dev_std = 0.156)
SUFF++ for r=0.9 all L1 = 0.869 +- 0.108 (in-sample avg dev_std = 0.156)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.751
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 270
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.743
SUFF++ for r=0.95 class 0.0 = 0.918 +- 0.032 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.95 class 1.0 = 0.912 +- 0.032 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.95 all KL = 0.981 +- 0.032 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.95 all L1 = 0.915 +- 0.075 (in-sample avg dev_std = 0.118)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.614
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.599
SUFF++ for r=0.3 class 0.0 = 0.931 +- 0.087 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.3 class 1.0 = 0.89 +- 0.087 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.3 all KL = 0.924 +- 0.087 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.3 all L1 = 0.911 +- 0.093 (in-sample avg dev_std = 0.169)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.606
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.597
SUFF++ for r=0.4 class 0.0 = 0.897 +- 0.107 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.4 class 1.0 = 0.855 +- 0.107 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.4 all KL = 0.891 +- 0.107 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.4 all L1 = 0.876 +- 0.102 (in-sample avg dev_std = 0.206)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.588
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.596
SUFF++ for r=0.6 class 0.0 = 0.877 +- 0.111 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 class 1.0 = 0.829 +- 0.111 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all KL = 0.89 +- 0.111 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all L1 = 0.853 +- 0.118 (in-sample avg dev_std = 0.214)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.632
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.623
SUFF++ for r=0.9 class 0.0 = 0.917 +- 0.050 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.9 class 1.0 = 0.881 +- 0.050 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.9 all KL = 0.96 +- 0.050 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.9 all L1 = 0.899 +- 0.089 (in-sample avg dev_std = 0.147)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.65
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 161
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.635
SUFF++ for r=0.95 class 0.0 = 0.941 +- 0.037 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.95 class 1.0 = 0.918 +- 0.037 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.95 all KL = 0.976 +- 0.037 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.95 all L1 = 0.93 +- 0.069 (in-sample avg dev_std = 0.121)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:33:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:19 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:23 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:26 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:29 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1], ori_edge_index=[2, 30], node_perm=[14])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 61...
[0m[1;37mINFO[0m: [1mCheckpoint 61: 
-----------------------------------
Train ROC-AUC: 0.9084
Train Loss: 0.0957
ID Validation ROC-AUC: 0.8316
ID Validation Loss: 0.1288
ID Test ROC-AUC: 0.8079
ID Test Loss: 0.1132
OOD Validation ROC-AUC: 0.7393
OOD Validation Loss: 0.1117
OOD Test ROC-AUC: 0.7327
OOD Test Loss: 0.0860

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 130...
[0m[1;37mINFO[0m: [1mCheckpoint 130: 
-----------------------------------
Train ROC-AUC: 0.9676
Train Loss: 0.0823
ID Validation ROC-AUC: 0.8098
ID Validation Loss: 0.1356
ID Test ROC-AUC: 0.8105
ID Test Loss: 0.1148
OOD Validation ROC-AUC: 0.7817
OOD Validation Loss: 0.1135
OOD Test ROC-AUC: 0.7377
OOD Test Loss: 0.0885

[0m[1;37mINFO[0m: [1mChartInfo 0.8079 0.7327 0.8105 0.7377 0.8098 0.7817[0mGOODHIV(4112)
Data example from id_test: Data(x=[23, 9], edge_index=[2, 48], edge_attr=[48, 3], y=[1, 1], smiles='Cc1occc1C(=S)Nc1ccc(Cl)c(C(=O)OCC(C)C)c1', idx=[1], scaffold='S=C(Nc1ccccc1)c1ccoc1', domain_id=[1], env_id=[1], ori_edge_index=[2, 48], node_perm=[23])
Label distribution from id_test: (tensor([0., 1.]), tensor([3976,  136]))
[1;34mDEBUG[0m: 05/08/2024 04:33:32 PM : [1mUnbalanced warning for GOODHIV (id_test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([136, 136]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODHIV(4108)
Data example from test: Data(x=[19, 9], edge_index=[2, 40], edge_attr=[40, 3], y=[1, 1], smiles='Nc1ccc2nc3ccc(O)cc3nc2c1.[Na]S[Na]', idx=[1], scaffold='c1ccc2nc3ccccc3nc2c1', domain_id=[1], ori_edge_index=[2, 40], node_perm=[19])
Label distribution from test: (tensor([0., 1.]), tensor([4027,   81]))
[1;34mDEBUG[0m: 05/08/2024 04:33:34 PM : [1mUnbalanced warning for GOODHIV (test)
[0mCreating balanced dataset: (tensor([0., 1.]), tensor([81, 81]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.734
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 272
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.703
NEC for r=0.3 class 0.0 = 0.07 +- 0.077 (in-sample avg dev_std = 0.110)
NEC for r=0.3 class 1.0 = 0.135 +- 0.077 (in-sample avg dev_std = 0.110)
NEC for r=0.3 all KL = 0.046 +- 0.077 (in-sample avg dev_std = 0.110)
NEC for r=0.3 all L1 = 0.103 +- 0.110 (in-sample avg dev_std = 0.110)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.749
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 272
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.718
NEC for r=0.4 class 0.0 = 0.078 +- 0.067 (in-sample avg dev_std = 0.128)
NEC for r=0.4 class 1.0 = 0.149 +- 0.067 (in-sample avg dev_std = 0.128)
NEC for r=0.4 all KL = 0.044 +- 0.067 (in-sample avg dev_std = 0.128)
NEC for r=0.4 all L1 = 0.113 +- 0.112 (in-sample avg dev_std = 0.128)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.712
NEC for r=0.6 class 0.0 = 0.107 +- 0.067 (in-sample avg dev_std = 0.138)
NEC for r=0.6 class 1.0 = 0.166 +- 0.067 (in-sample avg dev_std = 0.138)
NEC for r=0.6 all KL = 0.049 +- 0.067 (in-sample avg dev_std = 0.138)
NEC for r=0.6 all L1 = 0.136 +- 0.116 (in-sample avg dev_std = 0.138)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.749
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.712
NEC for r=0.9 class 0.0 = 0.111 +- 0.049 (in-sample avg dev_std = 0.126)
NEC for r=0.9 class 1.0 = 0.141 +- 0.049 (in-sample avg dev_std = 0.126)
NEC for r=0.9 all KL = 0.035 +- 0.049 (in-sample avg dev_std = 0.126)
NEC for r=0.9 all L1 = 0.126 +- 0.099 (in-sample avg dev_std = 0.126)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.759
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 272
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.711
NEC for r=0.95 class 0.0 = 0.115 +- 0.055 (in-sample avg dev_std = 0.141)
NEC for r=0.95 class 1.0 = 0.143 +- 0.055 (in-sample avg dev_std = 0.141)
NEC for r=0.95 all KL = 0.039 +- 0.055 (in-sample avg dev_std = 0.141)
NEC for r=0.95 all L1 = 0.129 +- 0.108 (in-sample avg dev_std = 0.141)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.76
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 272
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.713
NEC for r=1.0 class 0.0 = 0.123 +- 0.063 (in-sample avg dev_std = 0.143)
NEC for r=1.0 class 1.0 = 0.143 +- 0.063 (in-sample avg dev_std = 0.143)
NEC for r=1.0 all KL = 0.042 +- 0.063 (in-sample avg dev_std = 0.143)
NEC for r=1.0 all L1 = 0.133 +- 0.110 (in-sample avg dev_std = 0.143)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.622
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.603
NEC for r=0.3 class 0.0 = 0.064 +- 0.065 (in-sample avg dev_std = 0.097)
NEC for r=0.3 class 1.0 = 0.095 +- 0.065 (in-sample avg dev_std = 0.097)
NEC for r=0.3 all KL = 0.038 +- 0.065 (in-sample avg dev_std = 0.097)
NEC for r=0.3 all L1 = 0.08 +- 0.086 (in-sample avg dev_std = 0.097)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.643
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.641
NEC for r=0.4 class 0.0 = 0.063 +- 0.061 (in-sample avg dev_std = 0.100)
NEC for r=0.4 class 1.0 = 0.109 +- 0.061 (in-sample avg dev_std = 0.100)
NEC for r=0.4 all KL = 0.037 +- 0.061 (in-sample avg dev_std = 0.100)
NEC for r=0.4 all L1 = 0.086 +- 0.084 (in-sample avg dev_std = 0.100)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.65
NEC for r=0.6 class 0.0 = 0.067 +- 0.046 (in-sample avg dev_std = 0.090)
NEC for r=0.6 class 1.0 = 0.117 +- 0.046 (in-sample avg dev_std = 0.090)
NEC for r=0.6 all KL = 0.03 +- 0.046 (in-sample avg dev_std = 0.090)
NEC for r=0.6 all L1 = 0.092 +- 0.088 (in-sample avg dev_std = 0.090)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.651
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.634
NEC for r=0.9 class 0.0 = 0.086 +- 0.050 (in-sample avg dev_std = 0.126)
NEC for r=0.9 class 1.0 = 0.119 +- 0.050 (in-sample avg dev_std = 0.126)
NEC for r=0.9 all KL = 0.031 +- 0.050 (in-sample avg dev_std = 0.126)
NEC for r=0.9 all L1 = 0.102 +- 0.087 (in-sample avg dev_std = 0.126)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.652
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 162
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.628
NEC for r=0.95 class 0.0 = 0.092 +- 0.051 (in-sample avg dev_std = 0.125)
NEC for r=0.95 class 1.0 = 0.115 +- 0.051 (in-sample avg dev_std = 0.125)
NEC for r=0.95 all KL = 0.031 +- 0.051 (in-sample avg dev_std = 0.125)
NEC for r=0.95 all L1 = 0.104 +- 0.092 (in-sample avg dev_std = 0.125)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.655
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 162
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.637
NEC for r=1.0 class 0.0 = 0.082 +- 0.053 (in-sample avg dev_std = 0.129)
NEC for r=1.0 class 1.0 = 0.115 +- 0.053 (in-sample avg dev_std = 0.129)
NEC for r=1.0 all KL = 0.03 +- 0.053 (in-sample avg dev_std = 0.129)
NEC for r=1.0 all L1 = 0.099 +- 0.090 (in-sample avg dev_std = 0.129)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.734
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 272
Effective ratio: 0.309 +- 0.007
Model ROC-AUC over intervened graphs for r=0.3 =  0.661
SUFF++ for r=0.3 class 0.0 = 0.881 +- 0.085 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.3 class 1.0 = 0.825 +- 0.085 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.3 all KL = 0.908 +- 0.085 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.3 all L1 = 0.853 +- 0.098 (in-sample avg dev_std = 0.192)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.75
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 272
Effective ratio: 0.408 +- 0.007
Model ROC-AUC over intervened graphs for r=0.4 =  0.672
SUFF++ for r=0.4 class 0.0 = 0.854 +- 0.086 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.4 class 1.0 = 0.795 +- 0.086 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.4 all KL = 0.898 +- 0.086 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.4 all L1 = 0.824 +- 0.106 (in-sample avg dev_std = 0.216)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 272
Effective ratio: 0.608 +- 0.007
Model ROC-AUC over intervened graphs for r=0.6 =  0.679
SUFF++ for r=0.6 class 0.0 = 0.808 +- 0.105 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.6 class 1.0 = 0.775 +- 0.105 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.6 all KL = 0.887 +- 0.105 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.6 all L1 = 0.791 +- 0.114 (in-sample avg dev_std = 0.248)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.749
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 272
Effective ratio: 0.908 +- 0.007
Model ROC-AUC over intervened graphs for r=0.9 =  0.723
SUFF++ for r=0.9 class 0.0 = 0.861 +- 0.063 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 class 1.0 = 0.851 +- 0.063 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 all KL = 0.95 +- 0.063 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 all L1 = 0.856 +- 0.095 (in-sample avg dev_std = 0.177)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.763
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 270
Effective ratio: 0.958 +- 0.007
Model ROC-AUC over intervened graphs for r=0.95 =  0.74
SUFF++ for r=0.95 class 0.0 = 0.905 +- 0.055 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.95 class 1.0 = 0.9 +- 0.055 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.95 all KL = 0.971 +- 0.055 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.95 all L1 = 0.903 +- 0.084 (in-sample avg dev_std = 0.135)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.622
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 162
Effective ratio: 0.311 +- 0.010
Model ROC-AUC over intervened graphs for r=0.3 =  0.597
SUFF++ for r=0.3 class 0.0 = 0.908 +- 0.067 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.3 class 1.0 = 0.884 +- 0.067 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.3 all KL = 0.935 +- 0.067 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.3 all L1 = 0.896 +- 0.075 (in-sample avg dev_std = 0.148)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.643
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 162
Effective ratio: 0.409 +- 0.008
Model ROC-AUC over intervened graphs for r=0.4 =  0.591
SUFF++ for r=0.4 class 0.0 = 0.892 +- 0.067 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.4 class 1.0 = 0.867 +- 0.067 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.4 all KL = 0.931 +- 0.067 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.4 all L1 = 0.879 +- 0.084 (in-sample avg dev_std = 0.161)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 162
Effective ratio: 0.611 +- 0.009
Model ROC-AUC over intervened graphs for r=0.6 =  0.623
SUFF++ for r=0.6 class 0.0 = 0.889 +- 0.071 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.6 class 1.0 = 0.854 +- 0.071 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.6 all KL = 0.936 +- 0.071 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.6 all L1 = 0.871 +- 0.089 (in-sample avg dev_std = 0.170)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.651
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 162
Effective ratio: 0.909 +- 0.008
Model ROC-AUC over intervened graphs for r=0.9 =  0.641
SUFF++ for r=0.9 class 0.0 = 0.911 +- 0.036 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 class 1.0 = 0.893 +- 0.036 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 all KL = 0.971 +- 0.036 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 all L1 = 0.902 +- 0.069 (in-sample avg dev_std = 0.123)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.648
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 161
Effective ratio: 0.961 +- 0.008
Model ROC-AUC over intervened graphs for r=0.95 =  0.635
SUFF++ for r=0.95 class 0.0 = 0.944 +- 0.021 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.95 class 1.0 = 0.934 +- 0.021 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.95 all KL = 0.986 +- 0.021 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.95 all L1 = 0.939 +- 0.052 (in-sample avg dev_std = 0.094)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.004, 0.006, 0.013, 0.01, 0.01, 0.01], 'all_L1': [0.014, 0.02, 0.03, 0.032, 0.032, 0.03]}), defaultdict(<class 'list'>, {'all_KL': [0.041, 0.049, 0.055, 0.034, 0.036, 0.032], 'all_L1': [0.072, 0.088, 0.108, 0.086, 0.086, 0.083]}), defaultdict(<class 'list'>, {'all_KL': [0.104, 0.098, 0.092, 0.062, 0.054, 0.053], 'all_L1': [0.181, 0.192, 0.195, 0.146, 0.132, 0.124]}), defaultdict(<class 'list'>, {'all_KL': [0.077, 0.079, 0.073, 0.043, 0.041, 0.04], 'all_L1': [0.137, 0.158, 0.166, 0.141, 0.133, 0.128]}), defaultdict(<class 'list'>, {'all_KL': [0.046, 0.044, 0.049, 0.035, 0.039, 0.042], 'all_L1': [0.103, 0.113, 0.136, 0.126, 0.129, 0.133]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.992, 0.991, 0.986, 0.992, 0.995, 1.0], 'all_L1': [0.98, 0.977, 0.967, 0.969, 0.978, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.942, 0.926, 0.919, 0.96, 0.981, 1.0], 'all_L1': [0.91, 0.888, 0.864, 0.907, 0.941, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.856, 0.848, 0.867, 0.947, 0.974, 1.0], 'all_L1': [0.79, 0.766, 0.769, 0.864, 0.913, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.849, 0.85, 0.884, 0.959, 0.981, 1.0], 'all_L1': [0.811, 0.793, 0.801, 0.869, 0.915, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.908, 0.898, 0.887, 0.95, 0.971, 1.0], 'all_L1': [0.853, 0.824, 0.791, 0.856, 0.903, 1.0], 0.0: [1.0], 1.0: [1.0]})]

Eval split test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.003, 0.003, 0.006, 0.005, 0.005, 0.006], 'all_L1': [0.012, 0.013, 0.019, 0.021, 0.024, 0.026]}), defaultdict(<class 'list'>, {'all_KL': [0.025, 0.029, 0.031, 0.023, 0.021, 0.018], 'all_L1': [0.043, 0.056, 0.075, 0.069, 0.066, 0.063]}), defaultdict(<class 'list'>, {'all_KL': [0.071, 0.068, 0.066, 0.039, 0.036, 0.039], 'all_L1': [0.124, 0.131, 0.133, 0.099, 0.093, 0.09]}), defaultdict(<class 'list'>, {'all_KL': [0.041, 0.045, 0.059, 0.03, 0.031, 0.032], 'all_L1': [0.07, 0.082, 0.105, 0.093, 0.094, 0.093]}), defaultdict(<class 'list'>, {'all_KL': [0.038, 0.037, 0.03, 0.031, 0.031, 0.03], 'all_L1': [0.08, 0.086, 0.092, 0.102, 0.104, 0.099]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.996, 0.995, 0.994, 0.996, 0.998, 1.0], 'all_L1': [0.986, 0.983, 0.979, 0.981, 0.987, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.968, 0.949, 0.944, 0.968, 0.984, 1.0], 'all_L1': [0.95, 0.925, 0.902, 0.919, 0.952, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.892, 0.88, 0.889, 0.953, 0.976, 1.0], 'all_L1': [0.843, 0.82, 0.82, 0.89, 0.929, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.924, 0.891, 0.89, 0.96, 0.976, 1.0], 'all_L1': [0.911, 0.876, 0.853, 0.899, 0.93, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.935, 0.931, 0.936, 0.971, 0.986, 1.0], 'all_L1': [0.896, 0.879, 0.871, 0.902, 0.939, 1.0], 0.0: [1.0], 1.0: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.101 +- 0.057, 0.114 +- 0.059, 0.127 +- 0.057, 0.106 +- 0.043, 0.102 +- 0.039, 0.100 +- 0.039
nec class all_KL  =  0.054 +- 0.034, 0.055 +- 0.032, 0.056 +- 0.026, 0.037 +- 0.017, 0.036 +- 0.014, 0.035 +- 0.014
nec_acc_int  =  0.632 +- 0.043, 0.655 +- 0.034, 0.690 +- 0.027, 0.728 +- 0.022, 0.726 +- 0.020, 0.733 +- 0.022
suff++ class all_L1  =  0.869 +- 0.069, 0.850 +- 0.076, 0.838 +- 0.072, 0.893 +- 0.042, 0.930 +- 0.027, 1.000 +- 0.000
suff++ class all_KL  =  0.909 +- 0.054, 0.903 +- 0.053, 0.909 +- 0.042, 0.962 +- 0.016, 0.980 +- 0.008, 1.000 +- 0.000
suff++_acc_int  =  0.605 +- 0.032, 0.624 +- 0.032, 0.666 +- 0.027, 0.726 +- 0.017, 0.738 +- 0.018

Eval split test
nec class all_L1  =  0.066 +- 0.037, 0.074 +- 0.039, 0.085 +- 0.038, 0.077 +- 0.030, 0.076 +- 0.029, 0.074 +- 0.027
nec class all_KL  =  0.036 +- 0.022, 0.036 +- 0.021, 0.038 +- 0.022, 0.026 +- 0.011, 0.025 +- 0.011, 0.025 +- 0.012
nec_acc_int  =  0.583 +- 0.035, 0.605 +- 0.024, 0.636 +- 0.026, 0.656 +- 0.034, 0.654 +- 0.037, 0.658 +- 0.035
suff++ class all_L1  =  0.917 +- 0.049, 0.897 +- 0.055, 0.885 +- 0.054, 0.918 +- 0.033, 0.947 +- 0.021, 1.000 +- 0.000
suff++ class all_KL  =  0.943 +- 0.036, 0.929 +- 0.041, 0.931 +- 0.039, 0.970 +- 0.015, 0.984 +- 0.008, 1.000 +- 0.000
suff++_acc_int  =  0.572 +- 0.026, 0.585 +- 0.011, 0.613 +- 0.018, 0.650 +- 0.020, 0.656 +- 0.027


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.485 +- 0.008, 0.482 +- 0.010, 0.483 +- 0.011, 0.500 +- 0.005, 0.516 +- 0.007, 0.550 +- 0.020
Faith. Armon (L1)= 		  =  0.175 +- 0.091, 0.194 +- 0.092, 0.214 +- 0.087, 0.186 +- 0.070, 0.182 +- 0.066, 0.179 +- 0.067
Faith. GMean (L1)= 	  =  0.276 +- 0.089, 0.292 +- 0.085, 0.311 +- 0.076, 0.298 +- 0.067, 0.300 +- 0.066, 0.307 +- 0.072
Faith. Aritm (KL)= 		  =  0.482 +- 0.012, 0.479 +- 0.012, 0.483 +- 0.010, 0.499 +- 0.004, 0.508 +- 0.004, 0.518 +- 0.007
Faith. Armon (KL)= 		  =  0.100 +- 0.060, 0.102 +- 0.056, 0.105 +- 0.047, 0.070 +- 0.031, 0.069 +- 0.027, 0.068 +- 0.027
Faith. GMean (KL)= 	  =  0.204 +- 0.079, 0.207 +- 0.073, 0.217 +- 0.058, 0.182 +- 0.047, 0.182 +- 0.044, 0.183 +- 0.045

Eval split test
Faith. Aritm (L1)= 		  =  0.491 +- 0.006, 0.485 +- 0.008, 0.485 +- 0.008, 0.498 +- 0.003, 0.512 +- 0.005, 0.537 +- 0.014
Faith. Armon (L1)= 		  =  0.120 +- 0.064, 0.133 +- 0.066, 0.152 +- 0.064, 0.140 +- 0.053, 0.139 +- 0.051, 0.137 +- 0.048
Faith. GMean (L1)= 	  =  0.231 +- 0.072, 0.242 +- 0.072, 0.262 +- 0.067, 0.257 +- 0.059, 0.261 +- 0.057, 0.266 +- 0.057
Faith. Aritm (KL)= 		  =  0.489 +- 0.007, 0.483 +- 0.011, 0.485 +- 0.009, 0.498 +- 0.003, 0.504 +- 0.003, 0.512 +- 0.006
Faith. Armon (KL)= 		  =  0.068 +- 0.041, 0.069 +- 0.039, 0.073 +- 0.040, 0.050 +- 0.022, 0.048 +- 0.021, 0.049 +- 0.022
Faith. GMean (KL)= 	  =  0.169 +- 0.065, 0.170 +- 0.063, 0.177 +- 0.058, 0.151 +- 0.043, 0.150 +- 0.042, 0.152 +- 0.043
Computed for split load_split = id



Completed in  0:06:20.747155  for GSATvGIN GOODHIV/scaffold



DONE GSAT GOODHIV/scaffold

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:34:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/08/2024 04:34:48 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 04:35:20 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:35:31 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:35:42 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:35:58 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:36:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 174...
[0m[1;37mINFO[0m: [1mCheckpoint 174: 
-----------------------------------
Train ROC-AUC: 0.9747
Train Loss: 0.1592
ID Validation ROC-AUC: 0.9216
ID Validation Loss: 0.3096
ID Test ROC-AUC: 0.9242
ID Test Loss: 0.3130
OOD Validation ROC-AUC: 0.6625
OOD Validation Loss: 0.4639
OOD Test ROC-AUC: 0.7200
OOD Test Loss: 0.6879

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ROC-AUC: 0.9117
Train Loss: 0.2596
ID Validation ROC-AUC: 0.8990
ID Validation Loss: 0.2737
ID Test ROC-AUC: 0.9017
ID Test Loss: 0.2762
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.2996
OOD Test ROC-AUC: 0.7346
OOD Test Loss: 0.4781

[0m[1;37mINFO[0m: [1mChartInfo 0.9242 0.7200 0.9017 0.7346 0.8990 0.6935[0mLBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 05/08/2024 04:36:16 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 05/08/2024 04:36:22 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.683
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.68
NEC for r=0.3 class 0.0 = 0.261 +- 0.137 (in-sample avg dev_std = 0.267)
NEC for r=0.3 class 1.0 = 0.287 +- 0.137 (in-sample avg dev_std = 0.267)
NEC for r=0.3 all KL = 0.14 +- 0.137 (in-sample avg dev_std = 0.267)
NEC for r=0.3 all L1 = 0.284 +- 0.143 (in-sample avg dev_std = 0.267)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.771
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.742
NEC for r=0.4 class 0.0 = 0.252 +- 0.130 (in-sample avg dev_std = 0.267)
NEC for r=0.4 class 1.0 = 0.247 +- 0.130 (in-sample avg dev_std = 0.267)
NEC for r=0.4 all KL = 0.132 +- 0.130 (in-sample avg dev_std = 0.267)
NEC for r=0.4 all L1 = 0.247 +- 0.147 (in-sample avg dev_std = 0.267)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.831
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.805
NEC for r=0.6 class 0.0 = 0.237 +- 0.145 (in-sample avg dev_std = 0.257)
NEC for r=0.6 class 1.0 = 0.171 +- 0.145 (in-sample avg dev_std = 0.257)
NEC for r=0.6 all KL = 0.112 +- 0.145 (in-sample avg dev_std = 0.257)
NEC for r=0.6 all L1 = 0.179 +- 0.162 (in-sample avg dev_std = 0.257)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.915
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.876
NEC for r=0.9 class 0.0 = 0.271 +- 0.183 (in-sample avg dev_std = 0.268)
NEC for r=0.9 class 1.0 = 0.112 +- 0.183 (in-sample avg dev_std = 0.268)
NEC for r=0.9 all KL = 0.111 +- 0.183 (in-sample avg dev_std = 0.268)
NEC for r=0.9 all L1 = 0.131 +- 0.175 (in-sample avg dev_std = 0.268)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.922
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.879
NEC for r=0.95 class 0.0 = 0.286 +- 0.197 (in-sample avg dev_std = 0.281)
NEC for r=0.95 class 1.0 = 0.107 +- 0.197 (in-sample avg dev_std = 0.281)
NEC for r=0.95 all KL = 0.115 +- 0.197 (in-sample avg dev_std = 0.281)
NEC for r=0.95 all L1 = 0.128 +- 0.181 (in-sample avg dev_std = 0.281)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.885
NEC for r=1.0 class 0.0 = 0.294 +- 0.196 (in-sample avg dev_std = 0.276)
NEC for r=1.0 class 1.0 = 0.1 +- 0.196 (in-sample avg dev_std = 0.276)
NEC for r=1.0 all KL = 0.113 +- 0.196 (in-sample avg dev_std = 0.276)
NEC for r=1.0 all L1 = 0.123 +- 0.182 (in-sample avg dev_std = 0.276)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.598
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.578
NEC for r=0.3 class 0.0 = 0.285 +- 0.134 (in-sample avg dev_std = 0.264)
NEC for r=0.3 class 1.0 = 0.29 +- 0.134 (in-sample avg dev_std = 0.264)
NEC for r=0.3 all KL = 0.136 +- 0.134 (in-sample avg dev_std = 0.264)
NEC for r=0.3 all L1 = 0.289 +- 0.140 (in-sample avg dev_std = 0.264)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.63
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.625
NEC for r=0.4 class 0.0 = 0.28 +- 0.140 (in-sample avg dev_std = 0.280)
NEC for r=0.4 class 1.0 = 0.282 +- 0.140 (in-sample avg dev_std = 0.280)
NEC for r=0.4 all KL = 0.145 +- 0.140 (in-sample avg dev_std = 0.280)
NEC for r=0.4 all L1 = 0.282 +- 0.149 (in-sample avg dev_std = 0.280)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.667
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.677
NEC for r=0.6 class 0.0 = 0.252 +- 0.161 (in-sample avg dev_std = 0.310)
NEC for r=0.6 class 1.0 = 0.252 +- 0.161 (in-sample avg dev_std = 0.310)
NEC for r=0.6 all KL = 0.155 +- 0.161 (in-sample avg dev_std = 0.310)
NEC for r=0.6 all L1 = 0.252 +- 0.166 (in-sample avg dev_std = 0.310)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.698
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.694
NEC for r=0.9 class 0.0 = 0.262 +- 0.207 (in-sample avg dev_std = 0.336)
NEC for r=0.9 class 1.0 = 0.205 +- 0.207 (in-sample avg dev_std = 0.336)
NEC for r=0.9 all KL = 0.172 +- 0.207 (in-sample avg dev_std = 0.336)
NEC for r=0.9 all L1 = 0.214 +- 0.197 (in-sample avg dev_std = 0.336)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.71
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.703
NEC for r=0.95 class 0.0 = 0.259 +- 0.208 (in-sample avg dev_std = 0.331)
NEC for r=0.95 class 1.0 = 0.189 +- 0.208 (in-sample avg dev_std = 0.331)
NEC for r=0.95 all KL = 0.165 +- 0.208 (in-sample avg dev_std = 0.331)
NEC for r=0.95 all L1 = 0.201 +- 0.196 (in-sample avg dev_std = 0.331)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.718
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.71
NEC for r=1.0 class 0.0 = 0.264 +- 0.219 (in-sample avg dev_std = 0.338)
NEC for r=1.0 class 1.0 = 0.194 +- 0.219 (in-sample avg dev_std = 0.338)
NEC for r=1.0 all KL = 0.175 +- 0.219 (in-sample avg dev_std = 0.338)
NEC for r=1.0 all L1 = 0.206 +- 0.206 (in-sample avg dev_std = 0.338)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.683
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.655
SUFF++ for r=0.3 class 0.0 = 0.699 +- 0.135 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.3 class 1.0 = 0.682 +- 0.135 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.3 all KL = 0.83 +- 0.135 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.3 all L1 = 0.684 +- 0.130 (in-sample avg dev_std = 0.319)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.771
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.728
SUFF++ for r=0.4 class 0.0 = 0.681 +- 0.145 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.4 class 1.0 = 0.718 +- 0.145 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.4 all KL = 0.828 +- 0.145 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.4 all L1 = 0.714 +- 0.155 (in-sample avg dev_std = 0.317)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.831
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.797
SUFF++ for r=0.6 class 0.0 = 0.689 +- 0.170 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.6 class 1.0 = 0.799 +- 0.170 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.6 all KL = 0.849 +- 0.170 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.6 all L1 = 0.786 +- 0.185 (in-sample avg dev_std = 0.308)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.915
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.896
SUFF++ for r=0.9 class 0.0 = 0.839 +- 0.118 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 class 1.0 = 0.932 +- 0.118 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 all KL = 0.952 +- 0.118 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 all L1 = 0.921 +- 0.138 (in-sample avg dev_std = 0.183)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.922
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.912
SUFF++ for r=0.95 class 0.0 = 0.891 +- 0.082 (in-sample avg dev_std = 0.156)
SUFF++ for r=0.95 class 1.0 = 0.962 +- 0.082 (in-sample avg dev_std = 0.156)
SUFF++ for r=0.95 all KL = 0.974 +- 0.082 (in-sample avg dev_std = 0.156)
SUFF++ for r=0.95 all L1 = 0.953 +- 0.099 (in-sample avg dev_std = 0.156)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.598
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.586
SUFF++ for r=0.3 class 0.0 = 0.689 +- 0.145 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 class 1.0 = 0.668 +- 0.145 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 all KL = 0.825 +- 0.145 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.3 all L1 = 0.672 +- 0.130 (in-sample avg dev_std = 0.332)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.63
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.614
SUFF++ for r=0.4 class 0.0 = 0.681 +- 0.160 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.4 class 1.0 = 0.672 +- 0.160 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.4 all KL = 0.805 +- 0.160 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.4 all L1 = 0.674 +- 0.149 (in-sample avg dev_std = 0.350)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.667
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.659
SUFF++ for r=0.6 class 0.0 = 0.704 +- 0.173 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.6 class 1.0 = 0.728 +- 0.173 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.6 all KL = 0.819 +- 0.173 (in-sample avg dev_std = 0.343)
SUFF++ for r=0.6 all L1 = 0.724 +- 0.177 (in-sample avg dev_std = 0.343)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.698
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.699
SUFF++ for r=0.9 class 0.0 = 0.832 +- 0.140 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 1.0 = 0.874 +- 0.140 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all KL = 0.917 +- 0.140 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all L1 = 0.867 +- 0.157 (in-sample avg dev_std = 0.237)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.71
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.709
SUFF++ for r=0.95 class 0.0 = 0.879 +- 0.104 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.95 class 1.0 = 0.924 +- 0.104 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.95 all KL = 0.951 +- 0.104 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.95 all L1 = 0.916 +- 0.118 (in-sample avg dev_std = 0.214)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:40:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/08/2024 04:40:50 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 04:41:21 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:41:32 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:41:44 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:04 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9783
Train Loss: 0.1269
ID Validation ROC-AUC: 0.9244
ID Validation Loss: 0.2658
ID Test ROC-AUC: 0.9267
ID Test Loss: 0.2679
OOD Validation ROC-AUC: 0.6593
OOD Validation Loss: 0.4783
OOD Test ROC-AUC: 0.7128
OOD Test Loss: 0.6262

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9086
Train Loss: 0.2436
ID Validation ROC-AUC: 0.8959
ID Validation Loss: 0.2566
ID Test ROC-AUC: 0.8988
ID Test Loss: 0.2585
OOD Validation ROC-AUC: 0.6869
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7309
OOD Test Loss: 0.4531

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.7128 0.8988 0.7309 0.8959 0.6869[0mLBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 05/08/2024 04:42:25 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 05/08/2024 04:42:31 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.606
NEC for r=0.3 class 0.0 = 0.173 +- 0.086 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 1.0 = 0.206 +- 0.086 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all KL = 0.073 +- 0.086 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all L1 = 0.202 +- 0.113 (in-sample avg dev_std = 0.209)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.729
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.678
NEC for r=0.4 class 0.0 = 0.19 +- 0.106 (in-sample avg dev_std = 0.237)
NEC for r=0.4 class 1.0 = 0.202 +- 0.106 (in-sample avg dev_std = 0.237)
NEC for r=0.4 all KL = 0.088 +- 0.106 (in-sample avg dev_std = 0.237)
NEC for r=0.4 all L1 = 0.2 +- 0.120 (in-sample avg dev_std = 0.237)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.831
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.784
NEC for r=0.6 class 0.0 = 0.216 +- 0.116 (in-sample avg dev_std = 0.238)
NEC for r=0.6 class 1.0 = 0.165 +- 0.116 (in-sample avg dev_std = 0.238)
NEC for r=0.6 all KL = 0.091 +- 0.116 (in-sample avg dev_std = 0.238)
NEC for r=0.6 all L1 = 0.171 +- 0.130 (in-sample avg dev_std = 0.238)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.858
NEC for r=0.9 class 0.0 = 0.262 +- 0.129 (in-sample avg dev_std = 0.227)
NEC for r=0.9 class 1.0 = 0.118 +- 0.129 (in-sample avg dev_std = 0.227)
NEC for r=0.9 all KL = 0.087 +- 0.129 (in-sample avg dev_std = 0.227)
NEC for r=0.9 all L1 = 0.135 +- 0.150 (in-sample avg dev_std = 0.227)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.92
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.876
NEC for r=0.95 class 0.0 = 0.269 +- 0.146 (in-sample avg dev_std = 0.237)
NEC for r=0.95 class 1.0 = 0.112 +- 0.146 (in-sample avg dev_std = 0.237)
NEC for r=0.95 all KL = 0.092 +- 0.146 (in-sample avg dev_std = 0.237)
NEC for r=0.95 all L1 = 0.131 +- 0.158 (in-sample avg dev_std = 0.237)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.922
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.877
NEC for r=1.0 class 0.0 = 0.283 +- 0.157 (in-sample avg dev_std = 0.248)
NEC for r=1.0 class 1.0 = 0.111 +- 0.157 (in-sample avg dev_std = 0.248)
NEC for r=1.0 all KL = 0.097 +- 0.157 (in-sample avg dev_std = 0.248)
NEC for r=1.0 all L1 = 0.131 +- 0.164 (in-sample avg dev_std = 0.248)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.569
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.564
NEC for r=0.3 class 0.0 = 0.191 +- 0.084 (in-sample avg dev_std = 0.205)
NEC for r=0.3 class 1.0 = 0.206 +- 0.084 (in-sample avg dev_std = 0.205)
NEC for r=0.3 all KL = 0.069 +- 0.084 (in-sample avg dev_std = 0.205)
NEC for r=0.3 all L1 = 0.203 +- 0.108 (in-sample avg dev_std = 0.205)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.595
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.589
NEC for r=0.4 class 0.0 = 0.178 +- 0.098 (in-sample avg dev_std = 0.218)
NEC for r=0.4 class 1.0 = 0.207 +- 0.098 (in-sample avg dev_std = 0.218)
NEC for r=0.4 all KL = 0.078 +- 0.098 (in-sample avg dev_std = 0.218)
NEC for r=0.4 all L1 = 0.202 +- 0.114 (in-sample avg dev_std = 0.218)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.627
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.614
NEC for r=0.6 class 0.0 = 0.207 +- 0.114 (in-sample avg dev_std = 0.245)
NEC for r=0.6 class 1.0 = 0.201 +- 0.114 (in-sample avg dev_std = 0.245)
NEC for r=0.6 all KL = 0.091 +- 0.114 (in-sample avg dev_std = 0.245)
NEC for r=0.6 all L1 = 0.202 +- 0.129 (in-sample avg dev_std = 0.245)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.709
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.688
NEC for r=0.9 class 0.0 = 0.269 +- 0.162 (in-sample avg dev_std = 0.302)
NEC for r=0.9 class 1.0 = 0.207 +- 0.162 (in-sample avg dev_std = 0.302)
NEC for r=0.9 all KL = 0.133 +- 0.162 (in-sample avg dev_std = 0.302)
NEC for r=0.9 all L1 = 0.218 +- 0.167 (in-sample avg dev_std = 0.302)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.72
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.698
NEC for r=0.95 class 0.0 = 0.278 +- 0.159 (in-sample avg dev_std = 0.304)
NEC for r=0.95 class 1.0 = 0.202 +- 0.159 (in-sample avg dev_std = 0.304)
NEC for r=0.95 all KL = 0.133 +- 0.159 (in-sample avg dev_std = 0.304)
NEC for r=0.95 all L1 = 0.214 +- 0.169 (in-sample avg dev_std = 0.304)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.719
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.692
NEC for r=1.0 class 0.0 = 0.274 +- 0.174 (in-sample avg dev_std = 0.312)
NEC for r=1.0 class 1.0 = 0.208 +- 0.174 (in-sample avg dev_std = 0.312)
NEC for r=1.0 all KL = 0.144 +- 0.174 (in-sample avg dev_std = 0.312)
NEC for r=1.0 all L1 = 0.219 +- 0.180 (in-sample avg dev_std = 0.312)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.65
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 782
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.579
SUFF++ for r=0.3 class 0.0 = 0.755 +- 0.110 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 class 1.0 = 0.766 +- 0.110 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 all KL = 0.897 +- 0.110 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 all L1 = 0.765 +- 0.099 (in-sample avg dev_std = 0.263)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.729
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 799
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.629
SUFF++ for r=0.4 class 0.0 = 0.768 +- 0.136 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.4 class 1.0 = 0.754 +- 0.136 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.4 all KL = 0.871 +- 0.136 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.4 all L1 = 0.755 +- 0.116 (in-sample avg dev_std = 0.275)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.831
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.761
SUFF++ for r=0.6 class 0.0 = 0.79 +- 0.153 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.6 class 1.0 = 0.802 +- 0.153 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.6 all KL = 0.877 +- 0.153 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.6 all L1 = 0.8 +- 0.144 (in-sample avg dev_std = 0.245)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.905
SUFF++ for r=0.9 class 0.0 = 0.898 +- 0.067 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.9 class 1.0 = 0.953 +- 0.067 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.9 all KL = 0.977 +- 0.067 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.9 all L1 = 0.946 +- 0.083 (in-sample avg dev_std = 0.130)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.92
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.915
SUFF++ for r=0.95 class 0.0 = 0.904 +- 0.043 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.95 class 1.0 = 0.968 +- 0.043 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.95 all KL = 0.987 +- 0.043 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.95 all L1 = 0.961 +- 0.069 (in-sample avg dev_std = 0.110)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.565
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 783
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.555
SUFF++ for r=0.3 class 0.0 = 0.773 +- 0.101 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.3 class 1.0 = 0.769 +- 0.101 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.3 all KL = 0.909 +- 0.101 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.3 all L1 = 0.769 +- 0.101 (in-sample avg dev_std = 0.256)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.594
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 798
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.573
SUFF++ for r=0.4 class 0.0 = 0.768 +- 0.113 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.4 class 1.0 = 0.764 +- 0.113 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.4 all KL = 0.897 +- 0.113 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.4 all L1 = 0.765 +- 0.106 (in-sample avg dev_std = 0.244)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.627
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.615
SUFF++ for r=0.6 class 0.0 = 0.793 +- 0.119 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.6 class 1.0 = 0.787 +- 0.119 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.6 all KL = 0.901 +- 0.119 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.6 all L1 = 0.788 +- 0.127 (in-sample avg dev_std = 0.228)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.709
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.702
SUFF++ for r=0.9 class 0.0 = 0.9 +- 0.056 (in-sample avg dev_std = 0.156)
SUFF++ for r=0.9 class 1.0 = 0.918 +- 0.056 (in-sample avg dev_std = 0.156)
SUFF++ for r=0.9 all KL = 0.971 +- 0.056 (in-sample avg dev_std = 0.156)
SUFF++ for r=0.9 all L1 = 0.915 +- 0.092 (in-sample avg dev_std = 0.156)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.72
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.714
SUFF++ for r=0.95 class 0.0 = 0.911 +- 0.059 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.95 class 1.0 = 0.925 +- 0.059 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.95 all KL = 0.971 +- 0.059 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.95 all L1 = 0.923 +- 0.086 (in-sample avg dev_std = 0.171)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:47:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/08/2024 04:47:01 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 04:47:33 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:47:44 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:47:55 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:12 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:27 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ROC-AUC: 0.9586
Train Loss: 0.1793
ID Validation ROC-AUC: 0.9217
ID Validation Loss: 0.2533
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2525
OOD Validation ROC-AUC: 0.6759
OOD Validation Loss: 0.3745
OOD Test ROC-AUC: 0.7109
OOD Test Loss: 0.5685

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ROC-AUC: 0.9479
Train Loss: 0.1985
ID Validation ROC-AUC: 0.9155
ID Validation Loss: 0.2618
ID Test ROC-AUC: 0.9197
ID Test Loss: 0.2606
OOD Validation ROC-AUC: 0.6885
OOD Validation Loss: 0.3598
OOD Test ROC-AUC: 0.7250
OOD Test Loss: 0.5469

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7109 0.9197 0.7250 0.9155 0.6885[0mLBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 05/08/2024 04:48:28 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 05/08/2024 04:48:33 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.765
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.736
NEC for r=0.3 class 0.0 = 0.216 +- 0.088 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 1.0 = 0.262 +- 0.088 (in-sample avg dev_std = 0.204)
NEC for r=0.3 all KL = 0.095 +- 0.088 (in-sample avg dev_std = 0.204)
NEC for r=0.3 all L1 = 0.256 +- 0.121 (in-sample avg dev_std = 0.204)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.816
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.789
NEC for r=0.4 class 0.0 = 0.236 +- 0.091 (in-sample avg dev_std = 0.200)
NEC for r=0.4 class 1.0 = 0.232 +- 0.091 (in-sample avg dev_std = 0.200)
NEC for r=0.4 all KL = 0.096 +- 0.091 (in-sample avg dev_std = 0.200)
NEC for r=0.4 all L1 = 0.232 +- 0.126 (in-sample avg dev_std = 0.200)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.878
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.836
NEC for r=0.6 class 0.0 = 0.245 +- 0.090 (in-sample avg dev_std = 0.179)
NEC for r=0.6 class 1.0 = 0.149 +- 0.090 (in-sample avg dev_std = 0.179)
NEC for r=0.6 all KL = 0.073 +- 0.090 (in-sample avg dev_std = 0.179)
NEC for r=0.6 all L1 = 0.161 +- 0.132 (in-sample avg dev_std = 0.179)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.879
NEC for r=0.9 class 0.0 = 0.22 +- 0.091 (in-sample avg dev_std = 0.172)
NEC for r=0.9 class 1.0 = 0.095 +- 0.091 (in-sample avg dev_std = 0.172)
NEC for r=0.9 all KL = 0.055 +- 0.091 (in-sample avg dev_std = 0.172)
NEC for r=0.9 all L1 = 0.109 +- 0.127 (in-sample avg dev_std = 0.172)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.916
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.876
NEC for r=0.95 class 0.0 = 0.217 +- 0.094 (in-sample avg dev_std = 0.170)
NEC for r=0.95 class 1.0 = 0.093 +- 0.094 (in-sample avg dev_std = 0.170)
NEC for r=0.95 all KL = 0.055 +- 0.094 (in-sample avg dev_std = 0.170)
NEC for r=0.95 all L1 = 0.108 +- 0.127 (in-sample avg dev_std = 0.170)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.923
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.884
NEC for r=1.0 class 0.0 = 0.218 +- 0.095 (in-sample avg dev_std = 0.173)
NEC for r=1.0 class 1.0 = 0.09 +- 0.095 (in-sample avg dev_std = 0.173)
NEC for r=1.0 all KL = 0.056 +- 0.095 (in-sample avg dev_std = 0.173)
NEC for r=1.0 all L1 = 0.106 +- 0.127 (in-sample avg dev_std = 0.173)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.622
NEC for r=0.3 class 0.0 = 0.245 +- 0.092 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 1.0 = 0.25 +- 0.092 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all KL = 0.087 +- 0.092 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all L1 = 0.249 +- 0.124 (in-sample avg dev_std = 0.195)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.703
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.664
NEC for r=0.4 class 0.0 = 0.253 +- 0.093 (in-sample avg dev_std = 0.213)
NEC for r=0.4 class 1.0 = 0.248 +- 0.093 (in-sample avg dev_std = 0.213)
NEC for r=0.4 all KL = 0.095 +- 0.093 (in-sample avg dev_std = 0.213)
NEC for r=0.4 all L1 = 0.249 +- 0.124 (in-sample avg dev_std = 0.213)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.699
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.694
NEC for r=0.6 class 0.0 = 0.225 +- 0.092 (in-sample avg dev_std = 0.199)
NEC for r=0.6 class 1.0 = 0.199 +- 0.092 (in-sample avg dev_std = 0.199)
NEC for r=0.6 all KL = 0.086 +- 0.092 (in-sample avg dev_std = 0.199)
NEC for r=0.6 all L1 = 0.203 +- 0.130 (in-sample avg dev_std = 0.199)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.715
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.692
NEC for r=0.9 class 0.0 = 0.204 +- 0.103 (in-sample avg dev_std = 0.202)
NEC for r=0.9 class 1.0 = 0.157 +- 0.103 (in-sample avg dev_std = 0.202)
NEC for r=0.9 all KL = 0.079 +- 0.103 (in-sample avg dev_std = 0.202)
NEC for r=0.9 all L1 = 0.165 +- 0.136 (in-sample avg dev_std = 0.202)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.72
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.697
NEC for r=0.95 class 0.0 = 0.195 +- 0.098 (in-sample avg dev_std = 0.201)
NEC for r=0.95 class 1.0 = 0.152 +- 0.098 (in-sample avg dev_std = 0.201)
NEC for r=0.95 all KL = 0.073 +- 0.098 (in-sample avg dev_std = 0.201)
NEC for r=0.95 all L1 = 0.159 +- 0.135 (in-sample avg dev_std = 0.201)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.715
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.688
NEC for r=1.0 class 0.0 = 0.214 +- 0.093 (in-sample avg dev_std = 0.209)
NEC for r=1.0 class 1.0 = 0.151 +- 0.093 (in-sample avg dev_std = 0.209)
NEC for r=1.0 all KL = 0.073 +- 0.093 (in-sample avg dev_std = 0.209)
NEC for r=1.0 all L1 = 0.161 +- 0.136 (in-sample avg dev_std = 0.209)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.765
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.66
SUFF++ for r=0.3 class 0.0 = 0.716 +- 0.083 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 class 1.0 = 0.724 +- 0.083 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 all KL = 0.884 +- 0.083 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 all L1 = 0.723 +- 0.106 (in-sample avg dev_std = 0.263)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.816
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.721
SUFF++ for r=0.4 class 0.0 = 0.691 +- 0.095 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.4 class 1.0 = 0.746 +- 0.095 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.4 all KL = 0.876 +- 0.095 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.4 all L1 = 0.739 +- 0.126 (in-sample avg dev_std = 0.267)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.878
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.79
SUFF++ for r=0.6 class 0.0 = 0.664 +- 0.091 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.6 class 1.0 = 0.842 +- 0.091 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.6 all KL = 0.908 +- 0.091 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.6 all L1 = 0.82 +- 0.147 (in-sample avg dev_std = 0.228)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.913
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.884
SUFF++ for r=0.9 class 0.0 = 0.777 +- 0.058 (in-sample avg dev_std = 0.151)
SUFF++ for r=0.9 class 1.0 = 0.927 +- 0.058 (in-sample avg dev_std = 0.151)
SUFF++ for r=0.9 all KL = 0.964 +- 0.058 (in-sample avg dev_std = 0.151)
SUFF++ for r=0.9 all L1 = 0.909 +- 0.115 (in-sample avg dev_std = 0.151)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.916
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.904
SUFF++ for r=0.95 class 0.0 = 0.852 +- 0.034 (in-sample avg dev_std = 0.114)
SUFF++ for r=0.95 class 1.0 = 0.955 +- 0.034 (in-sample avg dev_std = 0.114)
SUFF++ for r=0.95 all KL = 0.983 +- 0.034 (in-sample avg dev_std = 0.114)
SUFF++ for r=0.95 all L1 = 0.942 +- 0.082 (in-sample avg dev_std = 0.114)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.607
SUFF++ for r=0.3 class 0.0 = 0.727 +- 0.087 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 class 1.0 = 0.724 +- 0.087 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 all KL = 0.89 +- 0.087 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.3 all L1 = 0.725 +- 0.102 (in-sample avg dev_std = 0.266)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.703
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.644
SUFF++ for r=0.4 class 0.0 = 0.7 +- 0.090 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.4 class 1.0 = 0.719 +- 0.090 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.4 all KL = 0.871 +- 0.090 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.4 all L1 = 0.716 +- 0.113 (in-sample avg dev_std = 0.284)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.699
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.66
SUFF++ for r=0.6 class 0.0 = 0.715 +- 0.101 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 class 1.0 = 0.779 +- 0.101 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 all KL = 0.884 +- 0.101 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 all L1 = 0.768 +- 0.137 (in-sample avg dev_std = 0.263)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.715
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.692
SUFF++ for r=0.9 class 0.0 = 0.828 +- 0.070 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 class 1.0 = 0.881 +- 0.070 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 all KL = 0.951 +- 0.070 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.9 all L1 = 0.872 +- 0.117 (in-sample avg dev_std = 0.183)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.72
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.706
SUFF++ for r=0.95 class 0.0 = 0.867 +- 0.050 (in-sample avg dev_std = 0.162)
SUFF++ for r=0.95 class 1.0 = 0.911 +- 0.050 (in-sample avg dev_std = 0.162)
SUFF++ for r=0.95 all KL = 0.969 +- 0.050 (in-sample avg dev_std = 0.162)
SUFF++ for r=0.95 all L1 = 0.904 +- 0.099 (in-sample avg dev_std = 0.162)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:53:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/08/2024 04:53:07 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 04:53:39 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 04:53:50 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:01 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:17 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 04:54:33 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 04:54:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ROC-AUC: 0.9561
Train Loss: 0.1699
ID Validation ROC-AUC: 0.9223
ID Validation Loss: 0.2340
ID Test ROC-AUC: 0.9235
ID Test Loss: 0.2358
OOD Validation ROC-AUC: 0.6576
OOD Validation Loss: 0.3970
OOD Test ROC-AUC: 0.7067
OOD Test Loss: 0.5494

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ROC-AUC: 0.9016
Train Loss: 0.2482
ID Validation ROC-AUC: 0.8949
ID Validation Loss: 0.2557
ID Test ROC-AUC: 0.8953
ID Test Loss: 0.2587
OOD Validation ROC-AUC: 0.6908
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7285
OOD Test Loss: 0.4503

[0m[1;37mINFO[0m: [1mChartInfo 0.9235 0.7067 0.8953 0.7285 0.8949 0.6908[0mLBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 05/08/2024 04:54:34 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 05/08/2024 04:54:40 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.589
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.608
NEC for r=0.3 class 0.0 = 0.196 +- 0.065 (in-sample avg dev_std = 0.181)
NEC for r=0.3 class 1.0 = 0.218 +- 0.065 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all KL = 0.06 +- 0.065 (in-sample avg dev_std = 0.181)
NEC for r=0.3 all L1 = 0.216 +- 0.101 (in-sample avg dev_std = 0.181)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.654
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.667
NEC for r=0.4 class 0.0 = 0.215 +- 0.067 (in-sample avg dev_std = 0.200)
NEC for r=0.4 class 1.0 = 0.23 +- 0.067 (in-sample avg dev_std = 0.200)
NEC for r=0.4 all KL = 0.071 +- 0.067 (in-sample avg dev_std = 0.200)
NEC for r=0.4 all L1 = 0.228 +- 0.100 (in-sample avg dev_std = 0.200)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.783
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.758
NEC for r=0.6 class 0.0 = 0.245 +- 0.100 (in-sample avg dev_std = 0.211)
NEC for r=0.6 class 1.0 = 0.222 +- 0.100 (in-sample avg dev_std = 0.211)
NEC for r=0.6 all KL = 0.096 +- 0.100 (in-sample avg dev_std = 0.211)
NEC for r=0.6 all L1 = 0.225 +- 0.124 (in-sample avg dev_std = 0.211)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.869
NEC for r=0.9 class 0.0 = 0.207 +- 0.105 (in-sample avg dev_std = 0.205)
NEC for r=0.9 class 1.0 = 0.142 +- 0.105 (in-sample avg dev_std = 0.205)
NEC for r=0.9 all KL = 0.08 +- 0.105 (in-sample avg dev_std = 0.205)
NEC for r=0.9 all L1 = 0.15 +- 0.130 (in-sample avg dev_std = 0.205)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.93
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.877
NEC for r=0.95 class 0.0 = 0.209 +- 0.107 (in-sample avg dev_std = 0.201)
NEC for r=0.95 class 1.0 = 0.127 +- 0.107 (in-sample avg dev_std = 0.201)
NEC for r=0.95 all KL = 0.075 +- 0.107 (in-sample avg dev_std = 0.201)
NEC for r=0.95 all L1 = 0.136 +- 0.130 (in-sample avg dev_std = 0.201)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.934
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.877
NEC for r=1.0 class 0.0 = 0.211 +- 0.106 (in-sample avg dev_std = 0.198)
NEC for r=1.0 class 1.0 = 0.114 +- 0.106 (in-sample avg dev_std = 0.198)
NEC for r=1.0 all KL = 0.07 +- 0.106 (in-sample avg dev_std = 0.198)
NEC for r=1.0 all L1 = 0.126 +- 0.127 (in-sample avg dev_std = 0.198)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.532
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.535
NEC for r=0.3 class 0.0 = 0.195 +- 0.065 (in-sample avg dev_std = 0.177)
NEC for r=0.3 class 1.0 = 0.225 +- 0.065 (in-sample avg dev_std = 0.177)
NEC for r=0.3 all KL = 0.061 +- 0.065 (in-sample avg dev_std = 0.177)
NEC for r=0.3 all L1 = 0.22 +- 0.104 (in-sample avg dev_std = 0.177)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.567
NEC for r=0.4 class 0.0 = 0.216 +- 0.068 (in-sample avg dev_std = 0.198)
NEC for r=0.4 class 1.0 = 0.237 +- 0.068 (in-sample avg dev_std = 0.198)
NEC for r=0.4 all KL = 0.072 +- 0.068 (in-sample avg dev_std = 0.198)
NEC for r=0.4 all L1 = 0.233 +- 0.102 (in-sample avg dev_std = 0.198)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.599
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.614
NEC for r=0.6 class 0.0 = 0.24 +- 0.102 (in-sample avg dev_std = 0.220)
NEC for r=0.6 class 1.0 = 0.248 +- 0.102 (in-sample avg dev_std = 0.220)
NEC for r=0.6 all KL = 0.099 +- 0.102 (in-sample avg dev_std = 0.220)
NEC for r=0.6 all L1 = 0.247 +- 0.119 (in-sample avg dev_std = 0.220)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.7
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.685
NEC for r=0.9 class 0.0 = 0.2 +- 0.108 (in-sample avg dev_std = 0.222)
NEC for r=0.9 class 1.0 = 0.193 +- 0.108 (in-sample avg dev_std = 0.222)
NEC for r=0.9 all KL = 0.09 +- 0.108 (in-sample avg dev_std = 0.222)
NEC for r=0.9 all L1 = 0.194 +- 0.131 (in-sample avg dev_std = 0.222)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.709
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.697
NEC for r=0.95 class 0.0 = 0.199 +- 0.112 (in-sample avg dev_std = 0.216)
NEC for r=0.95 class 1.0 = 0.182 +- 0.112 (in-sample avg dev_std = 0.216)
NEC for r=0.95 all KL = 0.085 +- 0.112 (in-sample avg dev_std = 0.216)
NEC for r=0.95 all L1 = 0.185 +- 0.133 (in-sample avg dev_std = 0.216)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.713
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.689
NEC for r=1.0 class 0.0 = 0.2 +- 0.108 (in-sample avg dev_std = 0.222)
NEC for r=1.0 class 1.0 = 0.165 +- 0.108 (in-sample avg dev_std = 0.222)
NEC for r=1.0 all KL = 0.079 +- 0.108 (in-sample avg dev_std = 0.222)
NEC for r=1.0 all L1 = 0.171 +- 0.128 (in-sample avg dev_std = 0.222)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.589
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.596
SUFF++ for r=0.3 class 0.0 = 0.744 +- 0.073 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.3 class 1.0 = 0.753 +- 0.073 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.3 all KL = 0.918 +- 0.073 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.3 all L1 = 0.752 +- 0.087 (in-sample avg dev_std = 0.243)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.654
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.636
SUFF++ for r=0.4 class 0.0 = 0.734 +- 0.088 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.4 class 1.0 = 0.744 +- 0.088 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.4 all KL = 0.901 +- 0.088 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.4 all L1 = 0.743 +- 0.096 (in-sample avg dev_std = 0.263)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.783
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.753
SUFF++ for r=0.6 class 0.0 = 0.727 +- 0.090 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.6 class 1.0 = 0.778 +- 0.090 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.6 all KL = 0.899 +- 0.090 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.6 all L1 = 0.772 +- 0.118 (in-sample avg dev_std = 0.247)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.884
SUFF++ for r=0.9 class 0.0 = 0.801 +- 0.081 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.9 class 1.0 = 0.901 +- 0.081 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.9 all KL = 0.95 +- 0.081 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.9 all L1 = 0.889 +- 0.115 (in-sample avg dev_std = 0.180)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.93
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.914
SUFF++ for r=0.95 class 0.0 = 0.864 +- 0.041 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.95 class 1.0 = 0.947 +- 0.041 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.95 all KL = 0.978 +- 0.041 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.95 all L1 = 0.937 +- 0.078 (in-sample avg dev_std = 0.137)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.532
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.531
SUFF++ for r=0.3 class 0.0 = 0.761 +- 0.063 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 1.0 = 0.755 +- 0.063 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 all KL = 0.923 +- 0.063 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 all L1 = 0.756 +- 0.084 (in-sample avg dev_std = 0.238)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.56
SUFF++ for r=0.4 class 0.0 = 0.762 +- 0.075 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.4 class 1.0 = 0.748 +- 0.075 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.4 all KL = 0.912 +- 0.075 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.4 all L1 = 0.751 +- 0.091 (in-sample avg dev_std = 0.254)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.599
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.613
SUFF++ for r=0.6 class 0.0 = 0.75 +- 0.088 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 class 1.0 = 0.751 +- 0.088 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 all KL = 0.899 +- 0.088 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 all L1 = 0.751 +- 0.109 (in-sample avg dev_std = 0.244)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.7
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.691
SUFF++ for r=0.9 class 0.0 = 0.828 +- 0.079 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.9 class 1.0 = 0.857 +- 0.079 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.9 all KL = 0.941 +- 0.079 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.9 all L1 = 0.852 +- 0.118 (in-sample avg dev_std = 0.199)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.709
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.701
SUFF++ for r=0.95 class 0.0 = 0.892 +- 0.050 (in-sample avg dev_std = 0.167)
SUFF++ for r=0.95 class 1.0 = 0.912 +- 0.050 (in-sample avg dev_std = 0.167)
SUFF++ for r=0.95 all KL = 0.97 +- 0.050 (in-sample avg dev_std = 0.167)
SUFF++ for r=0.95 all L1 = 0.909 +- 0.089 (in-sample avg dev_std = 0.167)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 16:59:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/08/2024 04:59:24 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 04:59:58 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:10 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:23 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:40 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ROC-AUC: 0.9604
Train Loss: 0.1577
ID Validation ROC-AUC: 0.9213
ID Validation Loss: 0.2276
ID Test ROC-AUC: 0.9231
ID Test Loss: 0.2288
OOD Validation ROC-AUC: 0.6638
OOD Validation Loss: 0.4052
OOD Test ROC-AUC: 0.7105
OOD Test Loss: 0.5421

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ROC-AUC: 0.8989
Train Loss: 0.2529
ID Validation ROC-AUC: 0.8912
ID Validation Loss: 0.2608
ID Test ROC-AUC: 0.8911
ID Test Loss: 0.2654
OOD Validation ROC-AUC: 0.6866
OOD Validation Loss: 0.2898
OOD Test ROC-AUC: 0.7229
OOD Test Loss: 0.4564

[0m[1;37mINFO[0m: [1mChartInfo 0.9231 0.7105 0.8911 0.7229 0.8912 0.6866[0mLBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 05/08/2024 05:00:57 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 05/08/2024 05:01:03 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.587
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.614
NEC for r=0.3 class 0.0 = 0.233 +- 0.074 (in-sample avg dev_std = 0.196)
NEC for r=0.3 class 1.0 = 0.246 +- 0.074 (in-sample avg dev_std = 0.196)
NEC for r=0.3 all KL = 0.075 +- 0.074 (in-sample avg dev_std = 0.196)
NEC for r=0.3 all L1 = 0.244 +- 0.109 (in-sample avg dev_std = 0.196)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.644
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.67
NEC for r=0.4 class 0.0 = 0.26 +- 0.080 (in-sample avg dev_std = 0.217)
NEC for r=0.4 class 1.0 = 0.264 +- 0.080 (in-sample avg dev_std = 0.217)
NEC for r=0.4 all KL = 0.093 +- 0.080 (in-sample avg dev_std = 0.217)
NEC for r=0.4 all L1 = 0.263 +- 0.111 (in-sample avg dev_std = 0.217)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.742
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.736
NEC for r=0.6 class 0.0 = 0.25 +- 0.136 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 1.0 = 0.264 +- 0.136 (in-sample avg dev_std = 0.263)
NEC for r=0.6 all KL = 0.138 +- 0.136 (in-sample avg dev_std = 0.263)
NEC for r=0.6 all L1 = 0.263 +- 0.124 (in-sample avg dev_std = 0.263)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.849
NEC for r=0.9 class 0.0 = 0.21 +- 0.159 (in-sample avg dev_std = 0.263)
NEC for r=0.9 class 1.0 = 0.196 +- 0.159 (in-sample avg dev_std = 0.263)
NEC for r=0.9 all KL = 0.132 +- 0.159 (in-sample avg dev_std = 0.263)
NEC for r=0.9 all L1 = 0.198 +- 0.134 (in-sample avg dev_std = 0.263)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.92
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.856
NEC for r=0.95 class 0.0 = 0.187 +- 0.160 (in-sample avg dev_std = 0.255)
NEC for r=0.95 class 1.0 = 0.182 +- 0.160 (in-sample avg dev_std = 0.255)
NEC for r=0.95 all KL = 0.128 +- 0.160 (in-sample avg dev_std = 0.255)
NEC for r=0.95 all L1 = 0.183 +- 0.132 (in-sample avg dev_std = 0.255)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.86
NEC for r=1.0 class 0.0 = 0.19 +- 0.164 (in-sample avg dev_std = 0.255)
NEC for r=1.0 class 1.0 = 0.164 +- 0.164 (in-sample avg dev_std = 0.255)
NEC for r=1.0 all KL = 0.12 +- 0.164 (in-sample avg dev_std = 0.255)
NEC for r=1.0 all L1 = 0.167 +- 0.133 (in-sample avg dev_std = 0.255)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.527
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.509
NEC for r=0.3 class 0.0 = 0.244 +- 0.087 (in-sample avg dev_std = 0.200)
NEC for r=0.3 class 1.0 = 0.247 +- 0.087 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all KL = 0.079 +- 0.087 (in-sample avg dev_std = 0.200)
NEC for r=0.3 all L1 = 0.246 +- 0.118 (in-sample avg dev_std = 0.200)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.521
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.544
NEC for r=0.4 class 0.0 = 0.253 +- 0.084 (in-sample avg dev_std = 0.222)
NEC for r=0.4 class 1.0 = 0.263 +- 0.084 (in-sample avg dev_std = 0.222)
NEC for r=0.4 all KL = 0.091 +- 0.084 (in-sample avg dev_std = 0.222)
NEC for r=0.4 all L1 = 0.261 +- 0.107 (in-sample avg dev_std = 0.222)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.529
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.589
NEC for r=0.6 class 0.0 = 0.287 +- 0.127 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 1.0 = 0.285 +- 0.127 (in-sample avg dev_std = 0.253)
NEC for r=0.6 all KL = 0.134 +- 0.127 (in-sample avg dev_std = 0.253)
NEC for r=0.6 all L1 = 0.286 +- 0.127 (in-sample avg dev_std = 0.253)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.669
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.641
NEC for r=0.9 class 0.0 = 0.223 +- 0.135 (in-sample avg dev_std = 0.263)
NEC for r=0.9 class 1.0 = 0.239 +- 0.135 (in-sample avg dev_std = 0.263)
NEC for r=0.9 all KL = 0.123 +- 0.135 (in-sample avg dev_std = 0.263)
NEC for r=0.9 all L1 = 0.236 +- 0.133 (in-sample avg dev_std = 0.263)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.689
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.648
NEC for r=0.95 class 0.0 = 0.216 +- 0.133 (in-sample avg dev_std = 0.250)
NEC for r=0.95 class 1.0 = 0.221 +- 0.133 (in-sample avg dev_std = 0.250)
NEC for r=0.95 all KL = 0.111 +- 0.133 (in-sample avg dev_std = 0.250)
NEC for r=0.95 all L1 = 0.221 +- 0.136 (in-sample avg dev_std = 0.250)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.702
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.66
NEC for r=1.0 class 0.0 = 0.209 +- 0.140 (in-sample avg dev_std = 0.254)
NEC for r=1.0 class 1.0 = 0.213 +- 0.140 (in-sample avg dev_std = 0.254)
NEC for r=1.0 all KL = 0.112 +- 0.140 (in-sample avg dev_std = 0.254)
NEC for r=1.0 all L1 = 0.213 +- 0.141 (in-sample avg dev_std = 0.254)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.587
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.603
SUFF++ for r=0.3 class 0.0 = 0.768 +- 0.063 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.3 class 1.0 = 0.751 +- 0.063 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.3 all KL = 0.92 +- 0.063 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.3 all L1 = 0.753 +- 0.086 (in-sample avg dev_std = 0.243)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.644
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.632
SUFF++ for r=0.4 class 0.0 = 0.747 +- 0.086 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.4 class 1.0 = 0.734 +- 0.086 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.4 all KL = 0.901 +- 0.086 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.4 all L1 = 0.736 +- 0.096 (in-sample avg dev_std = 0.253)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.742
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.702
SUFF++ for r=0.6 class 0.0 = 0.729 +- 0.128 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 class 1.0 = 0.736 +- 0.128 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 all KL = 0.859 +- 0.128 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 all L1 = 0.736 +- 0.110 (in-sample avg dev_std = 0.274)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.879
SUFF++ for r=0.9 class 0.0 = 0.844 +- 0.102 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.9 class 1.0 = 0.885 +- 0.102 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.9 all KL = 0.942 +- 0.102 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.9 all L1 = 0.88 +- 0.112 (in-sample avg dev_std = 0.172)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.92
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.907
SUFF++ for r=0.95 class 0.0 = 0.914 +- 0.039 (in-sample avg dev_std = 0.113)
SUFF++ for r=0.95 class 1.0 = 0.949 +- 0.039 (in-sample avg dev_std = 0.113)
SUFF++ for r=0.95 all KL = 0.982 +- 0.039 (in-sample avg dev_std = 0.113)
SUFF++ for r=0.95 all L1 = 0.945 +- 0.065 (in-sample avg dev_std = 0.113)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.527
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.549
SUFF++ for r=0.3 class 0.0 = 0.759 +- 0.061 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.3 class 1.0 = 0.755 +- 0.061 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.3 all KL = 0.922 +- 0.061 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.3 all L1 = 0.755 +- 0.082 (in-sample avg dev_std = 0.243)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.521
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.555
SUFF++ for r=0.4 class 0.0 = 0.743 +- 0.079 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.4 class 1.0 = 0.738 +- 0.079 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.4 all KL = 0.905 +- 0.079 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.4 all L1 = 0.739 +- 0.088 (in-sample avg dev_std = 0.256)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.529
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.578
SUFF++ for r=0.6 class 0.0 = 0.728 +- 0.110 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 class 1.0 = 0.722 +- 0.110 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 all KL = 0.872 +- 0.110 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 all L1 = 0.723 +- 0.112 (in-sample avg dev_std = 0.267)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.669
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.648
SUFF++ for r=0.9 class 0.0 = 0.85 +- 0.096 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.9 class 1.0 = 0.837 +- 0.096 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.9 all KL = 0.935 +- 0.096 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.9 all L1 = 0.839 +- 0.121 (in-sample avg dev_std = 0.201)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.689
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.68
SUFF++ for r=0.95 class 0.0 = 0.909 +- 0.059 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.95 class 1.0 = 0.908 +- 0.059 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.95 all KL = 0.97 +- 0.059 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.95 all L1 = 0.909 +- 0.091 (in-sample avg dev_std = 0.161)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.14, 0.132, 0.112, 0.111, 0.115, 0.113], 'all_L1': [0.284, 0.247, 0.179, 0.131, 0.128, 0.123]}), defaultdict(<class 'list'>, {'all_KL': [0.073, 0.088, 0.091, 0.087, 0.092, 0.097], 'all_L1': [0.202, 0.2, 0.171, 0.135, 0.131, 0.131]}), defaultdict(<class 'list'>, {'all_KL': [0.095, 0.096, 0.073, 0.055, 0.055, 0.056], 'all_L1': [0.256, 0.232, 0.161, 0.109, 0.108, 0.106]}), defaultdict(<class 'list'>, {'all_KL': [0.06, 0.071, 0.096, 0.08, 0.075, 0.07], 'all_L1': [0.216, 0.228, 0.225, 0.15, 0.136, 0.126]}), defaultdict(<class 'list'>, {'all_KL': [0.075, 0.093, 0.138, 0.132, 0.128, 0.12], 'all_L1': [0.244, 0.263, 0.263, 0.198, 0.183, 0.167]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.83, 0.828, 0.849, 0.952, 0.974, 1.0], 'all_L1': [0.684, 0.714, 0.786, 0.921, 0.953, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.897, 0.871, 0.877, 0.977, 0.987, 1.0], 'all_L1': [0.765, 0.755, 0.8, 0.946, 0.961, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.884, 0.876, 0.908, 0.964, 0.983, 1.0], 'all_L1': [0.723, 0.739, 0.82, 0.909, 0.942, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.918, 0.901, 0.899, 0.95, 0.978, 1.0], 'all_L1': [0.752, 0.743, 0.772, 0.889, 0.937, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.92, 0.901, 0.859, 0.942, 0.982, 1.0], 'all_L1': [0.753, 0.736, 0.736, 0.88, 0.945, 1.0], 0.0: [1.0], 1.0: [1.0]})]

Eval split test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.136, 0.145, 0.155, 0.172, 0.165, 0.175], 'all_L1': [0.289, 0.282, 0.252, 0.214, 0.201, 0.206]}), defaultdict(<class 'list'>, {'all_KL': [0.069, 0.078, 0.091, 0.133, 0.133, 0.144], 'all_L1': [0.203, 0.202, 0.202, 0.218, 0.214, 0.219]}), defaultdict(<class 'list'>, {'all_KL': [0.087, 0.095, 0.086, 0.079, 0.073, 0.073], 'all_L1': [0.249, 0.249, 0.203, 0.165, 0.159, 0.161]}), defaultdict(<class 'list'>, {'all_KL': [0.061, 0.072, 0.099, 0.09, 0.085, 0.079], 'all_L1': [0.22, 0.233, 0.247, 0.194, 0.185, 0.171]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.091, 0.134, 0.123, 0.111, 0.112], 'all_L1': [0.246, 0.261, 0.286, 0.236, 0.221, 0.213]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.825, 0.805, 0.819, 0.917, 0.951, 1.0], 'all_L1': [0.672, 0.674, 0.724, 0.867, 0.916, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.909, 0.897, 0.901, 0.971, 0.971, 1.0], 'all_L1': [0.769, 0.765, 0.788, 0.915, 0.923, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.89, 0.871, 0.884, 0.951, 0.969, 1.0], 'all_L1': [0.725, 0.716, 0.768, 0.872, 0.904, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.923, 0.912, 0.899, 0.941, 0.97, 1.0], 'all_L1': [0.756, 0.751, 0.751, 0.852, 0.909, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.922, 0.905, 0.872, 0.935, 0.97, 1.0], 'all_L1': [0.755, 0.739, 0.723, 0.839, 0.909, 1.0], 0.0: [1.0], 1.0: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.240 +- 0.029, 0.234 +- 0.021, 0.200 +- 0.038, 0.145 +- 0.030, 0.137 +- 0.025, 0.131 +- 0.020
nec class all_KL  =  0.089 +- 0.028, 0.096 +- 0.020, 0.102 +- 0.022, 0.093 +- 0.026, 0.093 +- 0.026, 0.091 +- 0.025
nec_acc_int  =  0.649 +- 0.051, 0.709 +- 0.048, 0.784 +- 0.035, 0.866 +- 0.011, 0.873 +- 0.008, 0.876 +- 0.009
suff++ class all_L1  =  0.735 +- 0.029, 0.737 +- 0.013, 0.783 +- 0.028, 0.909 +- 0.023, 0.948 +- 0.008, 1.000 +- 0.000
suff++ class all_KL  =  0.890 +- 0.033, 0.875 +- 0.027, 0.878 +- 0.023, 0.957 +- 0.012, 0.981 +- 0.004, 1.000 +- 0.000
suff++_acc_int  =  0.619 +- 0.033, 0.669 +- 0.046, 0.761 +- 0.034, 0.890 +- 0.009, 0.911 +- 0.004

Eval split test
nec class all_L1  =  0.241 +- 0.029, 0.245 +- 0.027, 0.238 +- 0.032, 0.205 +- 0.024, 0.196 +- 0.022, 0.194 +- 0.023
nec class all_KL  =  0.086 +- 0.026, 0.096 +- 0.026, 0.113 +- 0.027, 0.119 +- 0.033, 0.113 +- 0.033, 0.117 +- 0.039
nec_acc_int  =  0.562 +- 0.038, 0.598 +- 0.043, 0.637 +- 0.040, 0.680 +- 0.020, 0.688 +- 0.020, 0.688 +- 0.016
suff++ class all_L1  =  0.735 +- 0.035, 0.729 +- 0.032, 0.751 +- 0.025, 0.869 +- 0.026, 0.912 +- 0.007, 1.000 +- 0.000
suff++ class all_KL  =  0.894 +- 0.036, 0.878 +- 0.039, 0.875 +- 0.030, 0.943 +- 0.018, 0.966 +- 0.008, 1.000 +- 0.000
suff++_acc_int  =  0.566 +- 0.027, 0.589 +- 0.034, 0.625 +- 0.031, 0.687 +- 0.020, 0.702 +- 0.012


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.488 +- 0.006, 0.486 +- 0.008, 0.491 +- 0.007, 0.527 +- 0.012, 0.542 +- 0.013, 0.565 +- 0.010
Faith. Armon (L1)= 		  =  0.361 +- 0.029, 0.355 +- 0.023, 0.316 +- 0.045, 0.248 +- 0.043, 0.239 +- 0.037, 0.230 +- 0.031
Faith. GMean (L1)= 	  =  0.419 +- 0.018, 0.415 +- 0.016, 0.393 +- 0.030, 0.360 +- 0.033, 0.359 +- 0.031, 0.360 +- 0.027
Faith. Aritm (KL)= 		  =  0.489 +- 0.005, 0.486 +- 0.006, 0.490 +- 0.007, 0.525 +- 0.011, 0.537 +- 0.013, 0.546 +- 0.012
Faith. Armon (KL)= 		  =  0.159 +- 0.044, 0.172 +- 0.031, 0.182 +- 0.034, 0.168 +- 0.044, 0.169 +- 0.044, 0.166 +- 0.042
Faith. GMean (KL)= 	  =  0.277 +- 0.037, 0.288 +- 0.025, 0.297 +- 0.029, 0.295 +- 0.042, 0.299 +- 0.044, 0.299 +- 0.042

Eval split test
Faith. Aritm (L1)= 		  =  0.488 +- 0.007, 0.487 +- 0.008, 0.494 +- 0.007, 0.537 +- 0.017, 0.554 +- 0.013, 0.597 +- 0.012
Faith. Armon (L1)= 		  =  0.362 +- 0.028, 0.366 +- 0.027, 0.360 +- 0.034, 0.331 +- 0.032, 0.322 +- 0.031, 0.324 +- 0.033
Faith. GMean (L1)= 	  =  0.420 +- 0.016, 0.422 +- 0.016, 0.421 +- 0.022, 0.422 +- 0.026, 0.422 +- 0.025, 0.440 +- 0.027
Faith. Aritm (KL)= 		  =  0.490 +- 0.006, 0.487 +- 0.008, 0.494 +- 0.007, 0.531 +- 0.015, 0.540 +- 0.014, 0.558 +- 0.019
Faith. Armon (KL)= 		  =  0.156 +- 0.042, 0.172 +- 0.039, 0.199 +- 0.041, 0.210 +- 0.051, 0.201 +- 0.052, 0.207 +- 0.062
Faith. GMean (KL)= 	  =  0.274 +- 0.034, 0.287 +- 0.030, 0.312 +- 0.032, 0.332 +- 0.045, 0.327 +- 0.047, 0.337 +- 0.057
Computed for split load_split = id



Completed in  0:30:47.726029  for LECIvGIN LBAPcore/assay



DONE LECI LBAPcore/assay

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 17:05:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/08/2024 05:05:47 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 05:06:18 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 05:06:28 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 05:06:39 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 05:06:55 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 05:07:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ROC-AUC: 0.9769
Train Loss: 0.1241
ID Validation ROC-AUC: 0.9251
ID Validation Loss: 0.2646
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2693
OOD Validation ROC-AUC: 0.6274
OOD Validation Loss: 0.5719
OOD Test ROC-AUC: 0.7014
OOD Test Loss: 0.7027

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8627
Train Loss: 0.3460
ID Validation ROC-AUC: 0.8591
ID Validation Loss: 0.3495
ID Test ROC-AUC: 0.8621
ID Test Loss: 0.3525
OOD Validation ROC-AUC: 0.7045
OOD Validation Loss: 0.2921
OOD Test ROC-AUC: 0.7135
OOD Test Loss: 0.5263

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7014 0.8621 0.7135 0.8591 0.7045[0mLBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 05/08/2024 05:07:11 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 05/08/2024 05:07:17 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.631
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.627
NEC for r=0.3 class 0.0 = 0.204 +- 0.194 (in-sample avg dev_std = 0.310)
NEC for r=0.3 class 1.0 = 0.239 +- 0.194 (in-sample avg dev_std = 0.310)
NEC for r=0.3 all KL = 0.157 +- 0.194 (in-sample avg dev_std = 0.310)
NEC for r=0.3 all L1 = 0.235 +- 0.190 (in-sample avg dev_std = 0.310)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.643
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.631
NEC for r=0.4 class 0.0 = 0.215 +- 0.180 (in-sample avg dev_std = 0.297)
NEC for r=0.4 class 1.0 = 0.233 +- 0.180 (in-sample avg dev_std = 0.297)
NEC for r=0.4 all KL = 0.144 +- 0.180 (in-sample avg dev_std = 0.297)
NEC for r=0.4 all L1 = 0.231 +- 0.185 (in-sample avg dev_std = 0.297)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.654
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.642
NEC for r=0.6 class 0.0 = 0.18 +- 0.181 (in-sample avg dev_std = 0.288)
NEC for r=0.6 class 1.0 = 0.216 +- 0.181 (in-sample avg dev_std = 0.288)
NEC for r=0.6 all KL = 0.132 +- 0.181 (in-sample avg dev_std = 0.288)
NEC for r=0.6 all L1 = 0.211 +- 0.172 (in-sample avg dev_std = 0.288)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.666
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.649
NEC for r=0.9 class 0.0 = 0.17 +- 0.135 (in-sample avg dev_std = 0.264)
NEC for r=0.9 class 1.0 = 0.192 +- 0.135 (in-sample avg dev_std = 0.264)
NEC for r=0.9 all KL = 0.096 +- 0.135 (in-sample avg dev_std = 0.264)
NEC for r=0.9 all L1 = 0.19 +- 0.144 (in-sample avg dev_std = 0.264)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.669
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.653
NEC for r=0.95 class 0.0 = 0.158 +- 0.129 (in-sample avg dev_std = 0.257)
NEC for r=0.95 class 1.0 = 0.19 +- 0.129 (in-sample avg dev_std = 0.257)
NEC for r=0.95 all KL = 0.09 +- 0.129 (in-sample avg dev_std = 0.257)
NEC for r=0.95 all L1 = 0.186 +- 0.143 (in-sample avg dev_std = 0.257)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.672
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.658
NEC for r=1.0 class 0.0 = 0.159 +- 0.125 (in-sample avg dev_std = 0.256)
NEC for r=1.0 class 1.0 = 0.186 +- 0.125 (in-sample avg dev_std = 0.256)
NEC for r=1.0 all KL = 0.088 +- 0.125 (in-sample avg dev_std = 0.256)
NEC for r=1.0 all L1 = 0.183 +- 0.143 (in-sample avg dev_std = 0.256)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.589
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.603
NEC for r=0.3 class 0.0 = 0.23 +- 0.210 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 1.0 = 0.246 +- 0.210 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all KL = 0.167 +- 0.210 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all L1 = 0.243 +- 0.205 (in-sample avg dev_std = 0.309)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.583
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.592
NEC for r=0.4 class 0.0 = 0.225 +- 0.181 (in-sample avg dev_std = 0.292)
NEC for r=0.4 class 1.0 = 0.234 +- 0.181 (in-sample avg dev_std = 0.292)
NEC for r=0.4 all KL = 0.148 +- 0.181 (in-sample avg dev_std = 0.292)
NEC for r=0.4 all L1 = 0.232 +- 0.189 (in-sample avg dev_std = 0.292)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.583
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.588
NEC for r=0.6 class 0.0 = 0.202 +- 0.163 (in-sample avg dev_std = 0.280)
NEC for r=0.6 class 1.0 = 0.217 +- 0.163 (in-sample avg dev_std = 0.280)
NEC for r=0.6 all KL = 0.128 +- 0.163 (in-sample avg dev_std = 0.280)
NEC for r=0.6 all L1 = 0.214 +- 0.175 (in-sample avg dev_std = 0.280)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.593
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.571
NEC for r=0.9 class 0.0 = 0.175 +- 0.115 (in-sample avg dev_std = 0.237)
NEC for r=0.9 class 1.0 = 0.193 +- 0.115 (in-sample avg dev_std = 0.237)
NEC for r=0.9 all KL = 0.088 +- 0.115 (in-sample avg dev_std = 0.237)
NEC for r=0.9 all L1 = 0.19 +- 0.144 (in-sample avg dev_std = 0.237)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.591
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.573
NEC for r=0.95 class 0.0 = 0.162 +- 0.105 (in-sample avg dev_std = 0.229)
NEC for r=0.95 class 1.0 = 0.189 +- 0.105 (in-sample avg dev_std = 0.229)
NEC for r=0.95 all KL = 0.081 +- 0.105 (in-sample avg dev_std = 0.229)
NEC for r=0.95 all L1 = 0.184 +- 0.135 (in-sample avg dev_std = 0.229)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.592
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.574
NEC for r=1.0 class 0.0 = 0.165 +- 0.121 (in-sample avg dev_std = 0.237)
NEC for r=1.0 class 1.0 = 0.189 +- 0.121 (in-sample avg dev_std = 0.237)
NEC for r=1.0 all KL = 0.085 +- 0.121 (in-sample avg dev_std = 0.237)
NEC for r=1.0 all L1 = 0.185 +- 0.137 (in-sample avg dev_std = 0.237)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.632
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.562
SUFF++ for r=0.3 class 0.0 = 0.677 +- 0.201 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 class 1.0 = 0.626 +- 0.201 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 all KL = 0.677 +- 0.201 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 all L1 = 0.632 +- 0.152 (in-sample avg dev_std = 0.498)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.643
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.561
SUFF++ for r=0.4 class 0.0 = 0.679 +- 0.191 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.4 class 1.0 = 0.641 +- 0.191 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.4 all KL = 0.705 +- 0.191 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.4 all L1 = 0.646 +- 0.150 (in-sample avg dev_std = 0.474)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.655
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.604
SUFF++ for r=0.6 class 0.0 = 0.741 +- 0.200 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 1.0 = 0.665 +- 0.200 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 all KL = 0.74 +- 0.200 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 all L1 = 0.674 +- 0.154 (in-sample avg dev_std = 0.439)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.666
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.644
SUFF++ for r=0.9 class 0.0 = 0.824 +- 0.155 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 1.0 = 0.755 +- 0.155 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 all KL = 0.87 +- 0.155 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 all L1 = 0.763 +- 0.165 (in-sample avg dev_std = 0.279)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.669
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.662
SUFF++ for r=0.95 class 0.0 = 0.892 +- 0.088 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.95 class 1.0 = 0.848 +- 0.088 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.95 all KL = 0.943 +- 0.088 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.95 all L1 = 0.853 +- 0.124 (in-sample avg dev_std = 0.193)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.589
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.554
SUFF++ for r=0.3 class 0.0 = 0.664 +- 0.203 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 1.0 = 0.646 +- 0.203 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 all KL = 0.69 +- 0.203 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 all L1 = 0.649 +- 0.149 (in-sample avg dev_std = 0.480)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.582
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.542
SUFF++ for r=0.4 class 0.0 = 0.679 +- 0.195 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.4 class 1.0 = 0.659 +- 0.195 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.4 all KL = 0.718 +- 0.195 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.4 all L1 = 0.662 +- 0.154 (in-sample avg dev_std = 0.449)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.583
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.562
SUFF++ for r=0.6 class 0.0 = 0.723 +- 0.198 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 1.0 = 0.676 +- 0.198 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 all KL = 0.751 +- 0.198 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 all L1 = 0.684 +- 0.157 (in-sample avg dev_std = 0.434)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.593
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.574
SUFF++ for r=0.9 class 0.0 = 0.828 +- 0.150 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 class 1.0 = 0.777 +- 0.150 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 all KL = 0.887 +- 0.150 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 all L1 = 0.785 +- 0.159 (in-sample avg dev_std = 0.270)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.591
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.589
SUFF++ for r=0.95 class 0.0 = 0.895 +- 0.095 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.95 class 1.0 = 0.858 +- 0.095 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.95 all KL = 0.947 +- 0.095 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.95 all L1 = 0.864 +- 0.123 (in-sample avg dev_std = 0.195)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 17:11:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/08/2024 05:11:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 05:12:09 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 05:12:19 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 05:12:30 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 05:12:45 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ROC-AUC: 0.9559
Train Loss: 0.1818
ID Validation ROC-AUC: 0.9207
ID Validation Loss: 0.2309
ID Test ROC-AUC: 0.9188
ID Test Loss: 0.2372
OOD Validation ROC-AUC: 0.6575
OOD Validation Loss: 0.3564
OOD Test ROC-AUC: 0.7045
OOD Test Loss: 0.5081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 6...
[0m[1;37mINFO[0m: [1mCheckpoint 6: 
-----------------------------------
Train ROC-AUC: 0.8717
Train Loss: 0.3292
ID Validation ROC-AUC: 0.8694
ID Validation Loss: 0.3314
ID Test ROC-AUC: 0.8710
ID Test Loss: 0.3354
OOD Validation ROC-AUC: 0.7102
OOD Validation Loss: 0.2911
OOD Test ROC-AUC: 0.7280
OOD Test Loss: 0.5120

[0m[1;37mINFO[0m: [1mChartInfo 0.9188 0.7045 0.8710 0.7280 0.8694 0.7102[0mLBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 05/08/2024 05:13:00 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 05/08/2024 05:13:06 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.733
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.695
NEC for r=0.3 class 0.0 = 0.219 +- 0.057 (in-sample avg dev_std = 0.166)
NEC for r=0.3 class 1.0 = 0.163 +- 0.057 (in-sample avg dev_std = 0.166)
NEC for r=0.3 all KL = 0.05 +- 0.057 (in-sample avg dev_std = 0.166)
NEC for r=0.3 all L1 = 0.169 +- 0.105 (in-sample avg dev_std = 0.166)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.756
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.737
NEC for r=0.4 class 0.0 = 0.19 +- 0.072 (in-sample avg dev_std = 0.175)
NEC for r=0.4 class 1.0 = 0.167 +- 0.072 (in-sample avg dev_std = 0.175)
NEC for r=0.4 all KL = 0.059 +- 0.072 (in-sample avg dev_std = 0.175)
NEC for r=0.4 all L1 = 0.169 +- 0.108 (in-sample avg dev_std = 0.175)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.807
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.78
NEC for r=0.6 class 0.0 = 0.172 +- 0.086 (in-sample avg dev_std = 0.181)
NEC for r=0.6 class 1.0 = 0.138 +- 0.086 (in-sample avg dev_std = 0.181)
NEC for r=0.6 all KL = 0.061 +- 0.086 (in-sample avg dev_std = 0.181)
NEC for r=0.6 all L1 = 0.142 +- 0.113 (in-sample avg dev_std = 0.181)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.829
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.803
NEC for r=0.9 class 0.0 = 0.143 +- 0.071 (in-sample avg dev_std = 0.144)
NEC for r=0.9 class 1.0 = 0.091 +- 0.071 (in-sample avg dev_std = 0.144)
NEC for r=0.9 all KL = 0.04 +- 0.071 (in-sample avg dev_std = 0.144)
NEC for r=0.9 all L1 = 0.097 +- 0.101 (in-sample avg dev_std = 0.144)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.835
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.814
NEC for r=0.95 class 0.0 = 0.136 +- 0.064 (in-sample avg dev_std = 0.132)
NEC for r=0.95 class 1.0 = 0.081 +- 0.064 (in-sample avg dev_std = 0.132)
NEC for r=0.95 all KL = 0.036 +- 0.064 (in-sample avg dev_std = 0.132)
NEC for r=0.95 all L1 = 0.088 +- 0.095 (in-sample avg dev_std = 0.132)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.838
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.817
NEC for r=1.0 class 0.0 = 0.125 +- 0.059 (in-sample avg dev_std = 0.120)
NEC for r=1.0 class 1.0 = 0.072 +- 0.059 (in-sample avg dev_std = 0.120)
NEC for r=1.0 all KL = 0.03 +- 0.059 (in-sample avg dev_std = 0.120)
NEC for r=1.0 all L1 = 0.078 +- 0.087 (in-sample avg dev_std = 0.120)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.666
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.647
NEC for r=0.3 class 0.0 = 0.183 +- 0.069 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 1.0 = 0.179 +- 0.069 (in-sample avg dev_std = 0.162)
NEC for r=0.3 all KL = 0.052 +- 0.069 (in-sample avg dev_std = 0.162)
NEC for r=0.3 all L1 = 0.18 +- 0.107 (in-sample avg dev_std = 0.162)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.668
NEC for r=0.4 class 0.0 = 0.176 +- 0.069 (in-sample avg dev_std = 0.168)
NEC for r=0.4 class 1.0 = 0.18 +- 0.069 (in-sample avg dev_std = 0.168)
NEC for r=0.4 all KL = 0.055 +- 0.069 (in-sample avg dev_std = 0.168)
NEC for r=0.4 all L1 = 0.179 +- 0.104 (in-sample avg dev_std = 0.168)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.692
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.687
NEC for r=0.6 class 0.0 = 0.166 +- 0.085 (in-sample avg dev_std = 0.184)
NEC for r=0.6 class 1.0 = 0.167 +- 0.085 (in-sample avg dev_std = 0.184)
NEC for r=0.6 all KL = 0.063 +- 0.085 (in-sample avg dev_std = 0.184)
NEC for r=0.6 all L1 = 0.167 +- 0.112 (in-sample avg dev_std = 0.184)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.708
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.697
NEC for r=0.9 class 0.0 = 0.145 +- 0.069 (in-sample avg dev_std = 0.149)
NEC for r=0.9 class 1.0 = 0.12 +- 0.069 (in-sample avg dev_std = 0.149)
NEC for r=0.9 all KL = 0.044 +- 0.069 (in-sample avg dev_std = 0.149)
NEC for r=0.9 all L1 = 0.124 +- 0.103 (in-sample avg dev_std = 0.149)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.708
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.702
NEC for r=0.95 class 0.0 = 0.129 +- 0.065 (in-sample avg dev_std = 0.137)
NEC for r=0.95 class 1.0 = 0.107 +- 0.065 (in-sample avg dev_std = 0.137)
NEC for r=0.95 all KL = 0.037 +- 0.065 (in-sample avg dev_std = 0.137)
NEC for r=0.95 all L1 = 0.111 +- 0.098 (in-sample avg dev_std = 0.137)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.713
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.711
NEC for r=1.0 class 0.0 = 0.121 +- 0.048 (in-sample avg dev_std = 0.125)
NEC for r=1.0 class 1.0 = 0.097 +- 0.048 (in-sample avg dev_std = 0.125)
NEC for r=1.0 all KL = 0.031 +- 0.048 (in-sample avg dev_std = 0.125)
NEC for r=1.0 all L1 = 0.101 +- 0.088 (in-sample avg dev_std = 0.125)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.733
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.684
SUFF++ for r=0.3 class 0.0 = 0.754 +- 0.072 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.3 class 1.0 = 0.779 +- 0.072 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.3 all KL = 0.911 +- 0.072 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.3 all L1 = 0.776 +- 0.104 (in-sample avg dev_std = 0.253)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.756
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.706
SUFF++ for r=0.4 class 0.0 = 0.745 +- 0.085 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.4 class 1.0 = 0.774 +- 0.085 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.4 all KL = 0.893 +- 0.085 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.4 all L1 = 0.771 +- 0.115 (in-sample avg dev_std = 0.275)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.807
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.755
SUFF++ for r=0.6 class 0.0 = 0.757 +- 0.116 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 class 1.0 = 0.805 +- 0.116 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 all KL = 0.882 +- 0.116 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 all L1 = 0.799 +- 0.143 (in-sample avg dev_std = 0.278)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.829
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.804
SUFF++ for r=0.9 class 0.0 = 0.855 +- 0.092 (in-sample avg dev_std = 0.154)
SUFF++ for r=0.9 class 1.0 = 0.89 +- 0.092 (in-sample avg dev_std = 0.154)
SUFF++ for r=0.9 all KL = 0.946 +- 0.092 (in-sample avg dev_std = 0.154)
SUFF++ for r=0.9 all L1 = 0.886 +- 0.126 (in-sample avg dev_std = 0.154)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.835
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.819
SUFF++ for r=0.95 class 0.0 = 0.905 +- 0.050 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.95 class 1.0 = 0.938 +- 0.050 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.95 all KL = 0.978 +- 0.050 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.95 all L1 = 0.934 +- 0.083 (in-sample avg dev_std = 0.098)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.666
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.624
SUFF++ for r=0.3 class 0.0 = 0.743 +- 0.070 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 class 1.0 = 0.766 +- 0.070 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 all KL = 0.91 +- 0.070 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 all L1 = 0.762 +- 0.095 (in-sample avg dev_std = 0.251)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.638
SUFF++ for r=0.4 class 0.0 = 0.751 +- 0.086 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.4 class 1.0 = 0.756 +- 0.086 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.4 all KL = 0.895 +- 0.086 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.4 all L1 = 0.755 +- 0.107 (in-sample avg dev_std = 0.271)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.692
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.643
SUFF++ for r=0.6 class 0.0 = 0.75 +- 0.115 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.6 class 1.0 = 0.773 +- 0.115 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.6 all KL = 0.883 +- 0.115 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.6 all L1 = 0.769 +- 0.132 (in-sample avg dev_std = 0.272)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.708
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.681
SUFF++ for r=0.9 class 0.0 = 0.83 +- 0.089 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 class 1.0 = 0.861 +- 0.089 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all KL = 0.941 +- 0.089 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all L1 = 0.856 +- 0.123 (in-sample avg dev_std = 0.164)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.708
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.7
SUFF++ for r=0.95 class 0.0 = 0.908 +- 0.043 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.95 class 1.0 = 0.922 +- 0.043 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.95 all KL = 0.977 +- 0.043 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.95 all L1 = 0.919 +- 0.081 (in-sample avg dev_std = 0.111)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 17:17:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/08/2024 05:17:45 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 05:18:18 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 05:18:28 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 05:18:39 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 05:18:55 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ROC-AUC: 0.9718
Train Loss: 0.1502
ID Validation ROC-AUC: 0.9222
ID Validation Loss: 0.2869
ID Test ROC-AUC: 0.9201
ID Test Loss: 0.2932
OOD Validation ROC-AUC: 0.6430
OOD Validation Loss: 0.5048
OOD Test ROC-AUC: 0.7020
OOD Test Loss: 0.7112

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ROC-AUC: 0.8089
Train Loss: 0.4646
ID Validation ROC-AUC: 0.8084
ID Validation Loss: 0.4676
ID Test ROC-AUC: 0.8095
ID Test Loss: 0.4731
OOD Validation ROC-AUC: 0.6927
OOD Validation Loss: 0.3283
OOD Test ROC-AUC: 0.6938
OOD Test Loss: 0.4537

[0m[1;37mINFO[0m: [1mChartInfo 0.9201 0.7020 0.8095 0.6938 0.8084 0.6927[0mLBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 05/08/2024 05:19:10 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 05/08/2024 05:19:16 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.608
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.605
NEC for r=0.3 class 0.0 = 0.246 +- 0.197 (in-sample avg dev_std = 0.333)
NEC for r=0.3 class 1.0 = 0.276 +- 0.197 (in-sample avg dev_std = 0.333)
NEC for r=0.3 all KL = 0.188 +- 0.197 (in-sample avg dev_std = 0.333)
NEC for r=0.3 all L1 = 0.272 +- 0.173 (in-sample avg dev_std = 0.333)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.674
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.658
NEC for r=0.4 class 0.0 = 0.256 +- 0.204 (in-sample avg dev_std = 0.355)
NEC for r=0.4 class 1.0 = 0.27 +- 0.204 (in-sample avg dev_std = 0.355)
NEC for r=0.4 all KL = 0.204 +- 0.204 (in-sample avg dev_std = 0.355)
NEC for r=0.4 all L1 = 0.268 +- 0.183 (in-sample avg dev_std = 0.355)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.765
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.733
NEC for r=0.6 class 0.0 = 0.276 +- 0.194 (in-sample avg dev_std = 0.316)
NEC for r=0.6 class 1.0 = 0.224 +- 0.194 (in-sample avg dev_std = 0.316)
NEC for r=0.6 all KL = 0.171 +- 0.194 (in-sample avg dev_std = 0.316)
NEC for r=0.6 all L1 = 0.23 +- 0.185 (in-sample avg dev_std = 0.316)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.825
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.807
NEC for r=0.9 class 0.0 = 0.265 +- 0.146 (in-sample avg dev_std = 0.220)
NEC for r=0.9 class 1.0 = 0.127 +- 0.146 (in-sample avg dev_std = 0.220)
NEC for r=0.9 all KL = 0.094 +- 0.146 (in-sample avg dev_std = 0.220)
NEC for r=0.9 all L1 = 0.144 +- 0.164 (in-sample avg dev_std = 0.220)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.832
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.817
NEC for r=0.95 class 0.0 = 0.245 +- 0.143 (in-sample avg dev_std = 0.211)
NEC for r=0.95 class 1.0 = 0.116 +- 0.143 (in-sample avg dev_std = 0.211)
NEC for r=0.95 all KL = 0.086 +- 0.143 (in-sample avg dev_std = 0.211)
NEC for r=0.95 all L1 = 0.132 +- 0.157 (in-sample avg dev_std = 0.211)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.841
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.822
NEC for r=1.0 class 0.0 = 0.247 +- 0.139 (in-sample avg dev_std = 0.206)
NEC for r=1.0 class 1.0 = 0.109 +- 0.139 (in-sample avg dev_std = 0.206)
NEC for r=1.0 all KL = 0.082 +- 0.139 (in-sample avg dev_std = 0.206)
NEC for r=1.0 all L1 = 0.126 +- 0.154 (in-sample avg dev_std = 0.206)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.542
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.564
NEC for r=0.3 class 0.0 = 0.236 +- 0.185 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 1.0 = 0.267 +- 0.185 (in-sample avg dev_std = 0.306)
NEC for r=0.3 all KL = 0.164 +- 0.185 (in-sample avg dev_std = 0.306)
NEC for r=0.3 all L1 = 0.262 +- 0.175 (in-sample avg dev_std = 0.306)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.567
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.589
NEC for r=0.4 class 0.0 = 0.248 +- 0.197 (in-sample avg dev_std = 0.332)
NEC for r=0.4 class 1.0 = 0.276 +- 0.197 (in-sample avg dev_std = 0.332)
NEC for r=0.4 all KL = 0.185 +- 0.197 (in-sample avg dev_std = 0.332)
NEC for r=0.4 all L1 = 0.271 +- 0.179 (in-sample avg dev_std = 0.332)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.614
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.623
NEC for r=0.6 class 0.0 = 0.265 +- 0.193 (in-sample avg dev_std = 0.321)
NEC for r=0.6 class 1.0 = 0.251 +- 0.193 (in-sample avg dev_std = 0.321)
NEC for r=0.6 all KL = 0.171 +- 0.193 (in-sample avg dev_std = 0.321)
NEC for r=0.6 all L1 = 0.254 +- 0.184 (in-sample avg dev_std = 0.321)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.663
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.66
NEC for r=0.9 class 0.0 = 0.23 +- 0.158 (in-sample avg dev_std = 0.255)
NEC for r=0.9 class 1.0 = 0.181 +- 0.158 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all KL = 0.12 +- 0.158 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all L1 = 0.189 +- 0.173 (in-sample avg dev_std = 0.255)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.658
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.661
NEC for r=0.95 class 0.0 = 0.212 +- 0.154 (in-sample avg dev_std = 0.246)
NEC for r=0.95 class 1.0 = 0.161 +- 0.154 (in-sample avg dev_std = 0.246)
NEC for r=0.95 all KL = 0.107 +- 0.154 (in-sample avg dev_std = 0.246)
NEC for r=0.95 all L1 = 0.169 +- 0.161 (in-sample avg dev_std = 0.246)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.666
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.663
NEC for r=1.0 class 0.0 = 0.2 +- 0.155 (in-sample avg dev_std = 0.238)
NEC for r=1.0 class 1.0 = 0.152 +- 0.155 (in-sample avg dev_std = 0.238)
NEC for r=1.0 all KL = 0.103 +- 0.155 (in-sample avg dev_std = 0.238)
NEC for r=1.0 all L1 = 0.16 +- 0.163 (in-sample avg dev_std = 0.238)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.608
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.604
SUFF++ for r=0.3 class 0.0 = 0.679 +- 0.214 (in-sample avg dev_std = 0.546)
SUFF++ for r=0.3 class 1.0 = 0.593 +- 0.214 (in-sample avg dev_std = 0.546)
SUFF++ for r=0.3 all KL = 0.643 +- 0.214 (in-sample avg dev_std = 0.546)
SUFF++ for r=0.3 all L1 = 0.603 +- 0.145 (in-sample avg dev_std = 0.546)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.675
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.647
SUFF++ for r=0.4 class 0.0 = 0.64 +- 0.223 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.4 class 1.0 = 0.599 +- 0.223 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.4 all KL = 0.618 +- 0.223 (in-sample avg dev_std = 0.554)
SUFF++ for r=0.4 all L1 = 0.604 +- 0.171 (in-sample avg dev_std = 0.554)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.765
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.717
SUFF++ for r=0.6 class 0.0 = 0.64 +- 0.222 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 1.0 = 0.685 +- 0.222 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 all KL = 0.701 +- 0.222 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 all L1 = 0.68 +- 0.199 (in-sample avg dev_std = 0.448)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.825
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.804
SUFF++ for r=0.9 class 0.0 = 0.729 +- 0.186 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 1.0 = 0.847 +- 0.186 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all KL = 0.877 +- 0.186 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all L1 = 0.833 +- 0.183 (in-sample avg dev_std = 0.237)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.832
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.818
SUFF++ for r=0.95 class 0.0 = 0.845 +- 0.109 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.95 class 1.0 = 0.912 +- 0.109 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.95 all KL = 0.949 +- 0.109 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.95 all L1 = 0.904 +- 0.132 (in-sample avg dev_std = 0.158)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.542
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.563
SUFF++ for r=0.3 class 0.0 = 0.673 +- 0.203 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 1.0 = 0.623 +- 0.203 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 all KL = 0.696 +- 0.203 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 all L1 = 0.632 +- 0.153 (in-sample avg dev_std = 0.497)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.568
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.599
SUFF++ for r=0.4 class 0.0 = 0.654 +- 0.218 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.4 class 1.0 = 0.61 +- 0.218 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.4 all KL = 0.662 +- 0.218 (in-sample avg dev_std = 0.531)
SUFF++ for r=0.4 all L1 = 0.618 +- 0.159 (in-sample avg dev_std = 0.531)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.614
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.617
SUFF++ for r=0.6 class 0.0 = 0.641 +- 0.219 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 1.0 = 0.65 +- 0.219 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all KL = 0.699 +- 0.219 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all L1 = 0.648 +- 0.184 (in-sample avg dev_std = 0.465)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.663
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.645
SUFF++ for r=0.9 class 0.0 = 0.78 +- 0.170 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 1.0 = 0.813 +- 0.170 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 all KL = 0.874 +- 0.170 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 all L1 = 0.808 +- 0.173 (in-sample avg dev_std = 0.265)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.658
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.654
SUFF++ for r=0.95 class 0.0 = 0.866 +- 0.107 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.95 class 1.0 = 0.892 +- 0.107 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.95 all KL = 0.945 +- 0.107 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.95 all L1 = 0.887 +- 0.128 (in-sample avg dev_std = 0.185)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 17:23:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/08/2024 05:23:36 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:06 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:16 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:26 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:42 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 05:24:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ROC-AUC: 0.9605
Train Loss: 0.1572
ID Validation ROC-AUC: 0.9210
ID Validation Loss: 0.2207
ID Test ROC-AUC: 0.9206
ID Test Loss: 0.2229
OOD Validation ROC-AUC: 0.6437
OOD Validation Loss: 0.4343
OOD Test ROC-AUC: 0.7008
OOD Test Loss: 0.5543

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8643
Train Loss: 0.3237
ID Validation ROC-AUC: 0.8622
ID Validation Loss: 0.3271
ID Test ROC-AUC: 0.8643
ID Test Loss: 0.3301
OOD Validation ROC-AUC: 0.7009
OOD Validation Loss: 0.2819
OOD Test ROC-AUC: 0.7289
OOD Test Loss: 0.4908

[0m[1;37mINFO[0m: [1mChartInfo 0.9206 0.7008 0.8643 0.7289 0.8622 0.7009[0mLBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 05/08/2024 05:24:58 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 05/08/2024 05:25:03 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.573
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.583
NEC for r=0.3 class 0.0 = 0.256 +- 0.108 (in-sample avg dev_std = 0.265)
NEC for r=0.3 class 1.0 = 0.266 +- 0.108 (in-sample avg dev_std = 0.265)
NEC for r=0.3 all KL = 0.114 +- 0.108 (in-sample avg dev_std = 0.265)
NEC for r=0.3 all L1 = 0.265 +- 0.124 (in-sample avg dev_std = 0.265)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.6
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.61
NEC for r=0.4 class 0.0 = 0.219 +- 0.092 (in-sample avg dev_std = 0.251)
NEC for r=0.4 class 1.0 = 0.257 +- 0.092 (in-sample avg dev_std = 0.251)
NEC for r=0.4 all KL = 0.1 +- 0.092 (in-sample avg dev_std = 0.251)
NEC for r=0.4 all L1 = 0.253 +- 0.112 (in-sample avg dev_std = 0.251)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.67
NEC for r=0.6 class 0.0 = 0.179 +- 0.073 (in-sample avg dev_std = 0.223)
NEC for r=0.6 class 1.0 = 0.228 +- 0.073 (in-sample avg dev_std = 0.223)
NEC for r=0.6 all KL = 0.074 +- 0.073 (in-sample avg dev_std = 0.223)
NEC for r=0.6 all L1 = 0.222 +- 0.106 (in-sample avg dev_std = 0.223)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.694
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.708
NEC for r=0.9 class 0.0 = 0.123 +- 0.058 (in-sample avg dev_std = 0.194)
NEC for r=0.9 class 1.0 = 0.175 +- 0.058 (in-sample avg dev_std = 0.194)
NEC for r=0.9 all KL = 0.047 +- 0.058 (in-sample avg dev_std = 0.194)
NEC for r=0.9 all L1 = 0.169 +- 0.097 (in-sample avg dev_std = 0.194)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.712
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.731
NEC for r=0.95 class 0.0 = 0.107 +- 0.053 (in-sample avg dev_std = 0.188)
NEC for r=0.95 class 1.0 = 0.17 +- 0.053 (in-sample avg dev_std = 0.188)
NEC for r=0.95 all KL = 0.044 +- 0.053 (in-sample avg dev_std = 0.188)
NEC for r=0.95 all L1 = 0.162 +- 0.095 (in-sample avg dev_std = 0.188)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.721
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.733
NEC for r=1.0 class 0.0 = 0.105 +- 0.054 (in-sample avg dev_std = 0.190)
NEC for r=1.0 class 1.0 = 0.166 +- 0.054 (in-sample avg dev_std = 0.190)
NEC for r=1.0 all KL = 0.043 +- 0.054 (in-sample avg dev_std = 0.190)
NEC for r=1.0 all L1 = 0.159 +- 0.092 (in-sample avg dev_std = 0.190)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.498
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.534
NEC for r=0.3 class 0.0 = 0.264 +- 0.110 (in-sample avg dev_std = 0.253)
NEC for r=0.3 class 1.0 = 0.268 +- 0.110 (in-sample avg dev_std = 0.253)
NEC for r=0.3 all KL = 0.111 +- 0.110 (in-sample avg dev_std = 0.253)
NEC for r=0.3 all L1 = 0.267 +- 0.130 (in-sample avg dev_std = 0.253)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.529
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.555
NEC for r=0.4 class 0.0 = 0.237 +- 0.097 (in-sample avg dev_std = 0.244)
NEC for r=0.4 class 1.0 = 0.261 +- 0.097 (in-sample avg dev_std = 0.244)
NEC for r=0.4 all KL = 0.102 +- 0.097 (in-sample avg dev_std = 0.244)
NEC for r=0.4 all L1 = 0.257 +- 0.123 (in-sample avg dev_std = 0.244)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.551
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.586
NEC for r=0.6 class 0.0 = 0.19 +- 0.080 (in-sample avg dev_std = 0.226)
NEC for r=0.6 class 1.0 = 0.234 +- 0.080 (in-sample avg dev_std = 0.226)
NEC for r=0.6 all KL = 0.079 +- 0.080 (in-sample avg dev_std = 0.226)
NEC for r=0.6 all L1 = 0.227 +- 0.112 (in-sample avg dev_std = 0.226)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.593
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.607
NEC for r=0.9 class 0.0 = 0.15 +- 0.060 (in-sample avg dev_std = 0.179)
NEC for r=0.9 class 1.0 = 0.163 +- 0.060 (in-sample avg dev_std = 0.179)
NEC for r=0.9 all KL = 0.043 +- 0.060 (in-sample avg dev_std = 0.179)
NEC for r=0.9 all L1 = 0.161 +- 0.095 (in-sample avg dev_std = 0.179)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.594
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.617
NEC for r=0.95 class 0.0 = 0.134 +- 0.058 (in-sample avg dev_std = 0.182)
NEC for r=0.95 class 1.0 = 0.157 +- 0.058 (in-sample avg dev_std = 0.182)
NEC for r=0.95 all KL = 0.041 +- 0.058 (in-sample avg dev_std = 0.182)
NEC for r=0.95 all L1 = 0.153 +- 0.094 (in-sample avg dev_std = 0.182)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.598
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.615
NEC for r=1.0 class 0.0 = 0.129 +- 0.052 (in-sample avg dev_std = 0.168)
NEC for r=1.0 class 1.0 = 0.147 +- 0.052 (in-sample avg dev_std = 0.168)
NEC for r=1.0 all KL = 0.036 +- 0.052 (in-sample avg dev_std = 0.168)
NEC for r=1.0 all L1 = 0.144 +- 0.091 (in-sample avg dev_std = 0.168)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.573
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.552
SUFF++ for r=0.3 class 0.0 = 0.708 +- 0.121 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 class 1.0 = 0.673 +- 0.121 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 all KL = 0.83 +- 0.121 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 all L1 = 0.677 +- 0.110 (in-sample avg dev_std = 0.357)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.6
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.586
SUFF++ for r=0.4 class 0.0 = 0.718 +- 0.117 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.4 class 1.0 = 0.675 +- 0.117 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.4 all KL = 0.84 +- 0.117 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.4 all L1 = 0.68 +- 0.109 (in-sample avg dev_std = 0.338)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.659
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.633
SUFF++ for r=0.6 class 0.0 = 0.767 +- 0.094 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.6 class 1.0 = 0.709 +- 0.094 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.6 all KL = 0.88 +- 0.094 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.6 all L1 = 0.716 +- 0.105 (in-sample avg dev_std = 0.292)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.695
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.704
SUFF++ for r=0.9 class 0.0 = 0.873 +- 0.073 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 class 1.0 = 0.809 +- 0.073 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 all KL = 0.945 +- 0.073 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.9 all L1 = 0.816 +- 0.111 (in-sample avg dev_std = 0.193)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.712
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.718
SUFF++ for r=0.95 class 0.0 = 0.945 +- 0.041 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.95 class 1.0 = 0.887 +- 0.041 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.95 all KL = 0.978 +- 0.041 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.95 all L1 = 0.894 +- 0.082 (in-sample avg dev_std = 0.135)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.497
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.526
SUFF++ for r=0.3 class 0.0 = 0.723 +- 0.099 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.3 class 1.0 = 0.692 +- 0.099 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.3 all KL = 0.857 +- 0.099 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.3 all L1 = 0.697 +- 0.101 (in-sample avg dev_std = 0.326)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.529
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.545
SUFF++ for r=0.4 class 0.0 = 0.714 +- 0.110 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.4 class 1.0 = 0.69 +- 0.110 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.4 all KL = 0.855 +- 0.110 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.4 all L1 = 0.694 +- 0.110 (in-sample avg dev_std = 0.326)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.553
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.561
SUFF++ for r=0.6 class 0.0 = 0.76 +- 0.089 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 class 1.0 = 0.734 +- 0.089 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 all KL = 0.895 +- 0.089 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.6 all L1 = 0.738 +- 0.104 (in-sample avg dev_std = 0.278)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.593
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.595
SUFF++ for r=0.9 class 0.0 = 0.867 +- 0.060 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.9 class 1.0 = 0.838 +- 0.060 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.9 all KL = 0.958 +- 0.060 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.9 all L1 = 0.843 +- 0.105 (in-sample avg dev_std = 0.168)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.595
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.603
SUFF++ for r=0.95 class 0.0 = 0.942 +- 0.038 (in-sample avg dev_std = 0.112)
SUFF++ for r=0.95 class 1.0 = 0.905 +- 0.038 (in-sample avg dev_std = 0.112)
SUFF++ for r=0.95 all KL = 0.983 +- 0.038 (in-sample avg dev_std = 0.112)
SUFF++ for r=0.95 all L1 = 0.911 +- 0.081 (in-sample avg dev_std = 0.112)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 17:29:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/08/2024 05:29:29 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:00 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:10 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:21 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:36 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:51 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:51 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:30:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ROC-AUC: 0.9755
Train Loss: 0.1331
ID Validation ROC-AUC: 0.9228
ID Validation Loss: 0.2627
ID Test ROC-AUC: 0.9230
ID Test Loss: 0.2676
OOD Validation ROC-AUC: 0.6330
OOD Validation Loss: 0.4920
OOD Test ROC-AUC: 0.6956
OOD Test Loss: 0.6669

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ROC-AUC: 0.8416
Train Loss: 0.7193
ID Validation ROC-AUC: 0.8417
ID Validation Loss: 0.7258
ID Test ROC-AUC: 0.8407
ID Test Loss: 0.7339
OOD Validation ROC-AUC: 0.7030
OOD Validation Loss: 0.4109
OOD Test ROC-AUC: 0.7172
OOD Test Loss: 0.4958

[0m[1;37mINFO[0m: [1mChartInfo 0.9230 0.6956 0.8407 0.7172 0.8417 0.7030[0mLBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 05/08/2024 05:30:52 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 05/08/2024 05:30:58 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.4 = nan
WIoU for r=0.4 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=0.95 = nan
WIoU for r=0.95 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.605
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.608
NEC for r=0.3 class 0.0 = 0.097 +- 0.121 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 1.0 = 0.141 +- 0.121 (in-sample avg dev_std = 0.202)
NEC for r=0.3 all KL = 0.076 +- 0.121 (in-sample avg dev_std = 0.202)
NEC for r=0.3 all L1 = 0.135 +- 0.133 (in-sample avg dev_std = 0.202)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.675
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.638
NEC for r=0.4 class 0.0 = 0.108 +- 0.139 (in-sample avg dev_std = 0.243)
NEC for r=0.4 class 1.0 = 0.166 +- 0.139 (in-sample avg dev_std = 0.243)
NEC for r=0.4 all KL = 0.094 +- 0.139 (in-sample avg dev_std = 0.243)
NEC for r=0.4 all L1 = 0.159 +- 0.152 (in-sample avg dev_std = 0.243)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.731
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.685
NEC for r=0.6 class 0.0 = 0.131 +- 0.144 (in-sample avg dev_std = 0.273)
NEC for r=0.6 class 1.0 = 0.207 +- 0.144 (in-sample avg dev_std = 0.273)
NEC for r=0.6 all KL = 0.11 +- 0.144 (in-sample avg dev_std = 0.273)
NEC for r=0.6 all L1 = 0.198 +- 0.155 (in-sample avg dev_std = 0.273)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.79
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.742
NEC for r=0.9 class 0.0 = 0.172 +- 0.134 (in-sample avg dev_std = 0.251)
NEC for r=0.9 class 1.0 = 0.214 +- 0.134 (in-sample avg dev_std = 0.251)
NEC for r=0.9 all KL = 0.105 +- 0.134 (in-sample avg dev_std = 0.251)
NEC for r=0.9 all L1 = 0.209 +- 0.142 (in-sample avg dev_std = 0.251)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.798
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.756
NEC for r=0.95 class 0.0 = 0.179 +- 0.112 (in-sample avg dev_std = 0.231)
NEC for r=0.95 class 1.0 = 0.191 +- 0.112 (in-sample avg dev_std = 0.231)
NEC for r=0.95 all KL = 0.09 +- 0.112 (in-sample avg dev_std = 0.231)
NEC for r=0.95 all L1 = 0.189 +- 0.132 (in-sample avg dev_std = 0.231)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.804
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.767
NEC for r=1.0 class 0.0 = 0.176 +- 0.122 (in-sample avg dev_std = 0.231)
NEC for r=1.0 class 1.0 = 0.188 +- 0.122 (in-sample avg dev_std = 0.231)
NEC for r=1.0 all KL = 0.09 +- 0.122 (in-sample avg dev_std = 0.231)
NEC for r=1.0 all L1 = 0.187 +- 0.140 (in-sample avg dev_std = 0.231)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.59
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.576
NEC for r=0.3 class 0.0 = 0.116 +- 0.117 (in-sample avg dev_std = 0.192)
NEC for r=0.3 class 1.0 = 0.13 +- 0.117 (in-sample avg dev_std = 0.192)
NEC for r=0.3 all KL = 0.072 +- 0.117 (in-sample avg dev_std = 0.192)
NEC for r=0.3 all L1 = 0.128 +- 0.122 (in-sample avg dev_std = 0.192)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.629
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.584
NEC for r=0.4 class 0.0 = 0.125 +- 0.129 (in-sample avg dev_std = 0.211)
NEC for r=0.4 class 1.0 = 0.145 +- 0.129 (in-sample avg dev_std = 0.211)
NEC for r=0.4 all KL = 0.082 +- 0.129 (in-sample avg dev_std = 0.211)
NEC for r=0.4 all L1 = 0.142 +- 0.141 (in-sample avg dev_std = 0.211)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.622
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.605
NEC for r=0.6 class 0.0 = 0.154 +- 0.137 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 1.0 = 0.186 +- 0.137 (in-sample avg dev_std = 0.253)
NEC for r=0.6 all KL = 0.095 +- 0.137 (in-sample avg dev_std = 0.253)
NEC for r=0.6 all L1 = 0.181 +- 0.149 (in-sample avg dev_std = 0.253)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.667
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.637
NEC for r=0.9 class 0.0 = 0.191 +- 0.123 (in-sample avg dev_std = 0.244)
NEC for r=0.9 class 1.0 = 0.218 +- 0.123 (in-sample avg dev_std = 0.244)
NEC for r=0.9 all KL = 0.098 +- 0.123 (in-sample avg dev_std = 0.244)
NEC for r=0.9 all L1 = 0.213 +- 0.137 (in-sample avg dev_std = 0.244)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.666
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.648
NEC for r=0.95 class 0.0 = 0.184 +- 0.118 (in-sample avg dev_std = 0.240)
NEC for r=0.95 class 1.0 = 0.203 +- 0.118 (in-sample avg dev_std = 0.240)
NEC for r=0.95 all KL = 0.091 +- 0.118 (in-sample avg dev_std = 0.240)
NEC for r=0.95 all L1 = 0.199 +- 0.134 (in-sample avg dev_std = 0.240)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.663
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.654
NEC for r=1.0 class 0.0 = 0.176 +- 0.121 (in-sample avg dev_std = 0.243)
NEC for r=1.0 class 1.0 = 0.195 +- 0.121 (in-sample avg dev_std = 0.243)
NEC for r=1.0 all KL = 0.088 +- 0.121 (in-sample avg dev_std = 0.243)
NEC for r=1.0 all L1 = 0.191 +- 0.138 (in-sample avg dev_std = 0.243)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.605
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.546
SUFF++ for r=0.3 class 0.0 = 0.803 +- 0.173 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 class 1.0 = 0.769 +- 0.173 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 all KL = 0.807 +- 0.173 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 all L1 = 0.773 +- 0.143 (in-sample avg dev_std = 0.406)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.676
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.406 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.575
SUFF++ for r=0.4 class 0.0 = 0.777 +- 0.200 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.4 class 1.0 = 0.712 +- 0.200 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.4 all KL = 0.751 +- 0.200 (in-sample avg dev_std = 0.472)
SUFF++ for r=0.4 all L1 = 0.72 +- 0.170 (in-sample avg dev_std = 0.472)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.73
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.628
SUFF++ for r=0.6 class 0.0 = 0.746 +- 0.200 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.6 class 1.0 = 0.67 +- 0.200 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.6 all KL = 0.753 +- 0.200 (in-sample avg dev_std = 0.447)
SUFF++ for r=0.6 all L1 = 0.679 +- 0.169 (in-sample avg dev_std = 0.447)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.791
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.731
SUFF++ for r=0.9 class 0.0 = 0.787 +- 0.149 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 1.0 = 0.755 +- 0.149 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 all KL = 0.87 +- 0.149 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 all L1 = 0.759 +- 0.157 (in-sample avg dev_std = 0.261)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.798
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.957 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.78
SUFF++ for r=0.95 class 0.0 = 0.868 +- 0.106 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.95 class 1.0 = 0.834 +- 0.106 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.95 all KL = 0.931 +- 0.106 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.95 all L1 = 0.838 +- 0.134 (in-sample avg dev_std = 0.200)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.59
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.537
SUFF++ for r=0.3 class 0.0 = 0.831 +- 0.161 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.3 class 1.0 = 0.816 +- 0.161 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.3 all KL = 0.856 +- 0.161 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.3 all L1 = 0.818 +- 0.131 (in-sample avg dev_std = 0.345)


ratio=0.4


Computing with masking

Model ROC-AUC of binarized graphs for r=0.4 =  0.629
Model XAI F1 of binarized graphs for r=0.4 =  nan
Model XAI WIoU of binarized graphs for r=0.4 =  nan
len(reference) = 800
Effective ratio: 0.407 +- 0.005
Model ROC-AUC over intervened graphs for r=0.4 =  0.56
SUFF++ for r=0.4 class 0.0 = 0.805 +- 0.187 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.4 class 1.0 = 0.77 +- 0.187 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.4 all KL = 0.811 +- 0.187 (in-sample avg dev_std = 0.401)
SUFF++ for r=0.4 all L1 = 0.776 +- 0.156 (in-sample avg dev_std = 0.401)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.596
SUFF++ for r=0.6 class 0.0 = 0.76 +- 0.177 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 1.0 = 0.717 +- 0.177 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 all KL = 0.8 +- 0.177 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 all L1 = 0.724 +- 0.158 (in-sample avg dev_std = 0.407)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.667
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.627
SUFF++ for r=0.9 class 0.0 = 0.808 +- 0.141 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 1.0 = 0.757 +- 0.141 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 all KL = 0.883 +- 0.141 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 all L1 = 0.765 +- 0.156 (in-sample avg dev_std = 0.251)


ratio=0.95


Computing with masking

Model ROC-AUC of binarized graphs for r=0.95 =  0.667
Model XAI F1 of binarized graphs for r=0.95 =  nan
Model XAI WIoU of binarized graphs for r=0.95 =  nan
len(reference) = 800
Effective ratio: 0.958 +- 0.005
Model ROC-AUC over intervened graphs for r=0.95 =  0.649
SUFF++ for r=0.95 class 0.0 = 0.876 +- 0.090 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.95 class 1.0 = 0.851 +- 0.090 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.95 all KL = 0.948 +- 0.090 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.95 all L1 = 0.855 +- 0.118 (in-sample avg dev_std = 0.179)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.157, 0.144, 0.132, 0.096, 0.09, 0.088], 'all_L1': [0.235, 0.231, 0.211, 0.19, 0.186, 0.183]}), defaultdict(<class 'list'>, {'all_KL': [0.05, 0.059, 0.061, 0.04, 0.036, 0.03], 'all_L1': [0.169, 0.169, 0.142, 0.097, 0.088, 0.078]}), defaultdict(<class 'list'>, {'all_KL': [0.188, 0.204, 0.171, 0.094, 0.086, 0.082], 'all_L1': [0.272, 0.268, 0.23, 0.144, 0.132, 0.126]}), defaultdict(<class 'list'>, {'all_KL': [0.114, 0.1, 0.074, 0.047, 0.044, 0.043], 'all_L1': [0.265, 0.253, 0.222, 0.169, 0.162, 0.159]}), defaultdict(<class 'list'>, {'all_KL': [0.076, 0.094, 0.11, 0.105, 0.09, 0.09], 'all_L1': [0.135, 0.159, 0.198, 0.209, 0.189, 0.187]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.677, 0.705, 0.74, 0.87, 0.943, 1.0], 'all_L1': [0.632, 0.646, 0.674, 0.763, 0.853, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.911, 0.893, 0.882, 0.946, 0.978, 1.0], 'all_L1': [0.776, 0.771, 0.799, 0.886, 0.934, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.643, 0.618, 0.701, 0.877, 0.949, 1.0], 'all_L1': [0.603, 0.604, 0.68, 0.833, 0.904, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.83, 0.84, 0.88, 0.945, 0.978, 1.0], 'all_L1': [0.677, 0.68, 0.716, 0.816, 0.894, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.807, 0.751, 0.753, 0.87, 0.931, 1.0], 'all_L1': [0.773, 0.72, 0.679, 0.759, 0.838, 1.0], 0.0: [1.0], 1.0: [1.0]})]

Eval split test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.167, 0.148, 0.128, 0.088, 0.081, 0.085], 'all_L1': [0.243, 0.232, 0.214, 0.19, 0.184, 0.185]}), defaultdict(<class 'list'>, {'all_KL': [0.052, 0.055, 0.063, 0.044, 0.037, 0.031], 'all_L1': [0.18, 0.179, 0.167, 0.124, 0.111, 0.101]}), defaultdict(<class 'list'>, {'all_KL': [0.164, 0.185, 0.171, 0.12, 0.107, 0.103], 'all_L1': [0.262, 0.271, 0.254, 0.189, 0.169, 0.16]}), defaultdict(<class 'list'>, {'all_KL': [0.111, 0.102, 0.079, 0.043, 0.041, 0.036], 'all_L1': [0.267, 0.257, 0.227, 0.161, 0.153, 0.144]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.082, 0.095, 0.098, 0.091, 0.088], 'all_L1': [0.128, 0.142, 0.181, 0.213, 0.199, 0.191]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.69, 0.718, 0.751, 0.887, 0.947, 1.0], 'all_L1': [0.649, 0.662, 0.684, 0.785, 0.864, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.91, 0.895, 0.883, 0.941, 0.977, 1.0], 'all_L1': [0.762, 0.755, 0.769, 0.856, 0.919, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.696, 0.662, 0.699, 0.874, 0.945, 1.0], 'all_L1': [0.632, 0.618, 0.648, 0.808, 0.887, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.857, 0.855, 0.895, 0.958, 0.983, 1.0], 'all_L1': [0.697, 0.694, 0.738, 0.843, 0.911, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.856, 0.811, 0.8, 0.883, 0.948, 1.0], 'all_L1': [0.818, 0.776, 0.724, 0.765, 0.855, 1.0], 0.0: [1.0], 1.0: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.215 +- 0.054, 0.216 +- 0.044, 0.201 +- 0.031, 0.162 +- 0.039, 0.151 +- 0.038, 0.147 +- 0.041
nec class all_KL  =  0.117 +- 0.051, 0.120 +- 0.050, 0.110 +- 0.040, 0.076 +- 0.027, 0.069 +- 0.024, 0.067 +- 0.025
nec_acc_int  =  0.623 +- 0.038, 0.655 +- 0.044, 0.702 +- 0.049, 0.742 +- 0.060, 0.754 +- 0.060, 0.759 +- 0.060
suff++ class all_L1  =  0.692 +- 0.071, 0.684 +- 0.058, 0.710 +- 0.047, 0.811 +- 0.047, 0.885 +- 0.035, 1.000 +- 0.000
suff++ class all_KL  =  0.774 +- 0.100, 0.761 +- 0.097, 0.791 +- 0.075, 0.902 +- 0.036, 0.956 +- 0.019, 1.000 +- 0.000
suff++_acc_int  =  0.590 +- 0.051, 0.615 +- 0.054, 0.667 +- 0.058, 0.738 +- 0.061, 0.759 +- 0.061

Eval split test
nec class all_L1  =  0.216 +- 0.054, 0.216 +- 0.049, 0.209 +- 0.031, 0.175 +- 0.031, 0.163 +- 0.030, 0.156 +- 0.032
nec class all_KL  =  0.113 +- 0.047, 0.114 +- 0.047, 0.107 +- 0.038, 0.079 +- 0.030, 0.071 +- 0.028, 0.069 +- 0.029
nec_acc_int  =  0.585 +- 0.038, 0.597 +- 0.038, 0.618 +- 0.037, 0.634 +- 0.043, 0.640 +- 0.043, 0.644 +- 0.046
suff++ class all_L1  =  0.712 +- 0.070, 0.701 +- 0.058, 0.713 +- 0.042, 0.811 +- 0.034, 0.887 +- 0.025, 1.000 +- 0.000
suff++ class all_KL  =  0.802 +- 0.091, 0.788 +- 0.086, 0.806 +- 0.075, 0.909 +- 0.034, 0.960 +- 0.016, 1.000 +- 0.000
suff++_acc_int  =  0.561 +- 0.034, 0.577 +- 0.037, 0.596 +- 0.032, 0.624 +- 0.038, 0.639 +- 0.040


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.454 +- 0.016, 0.450 +- 0.015, 0.455 +- 0.013, 0.487 +- 0.006, 0.518 +- 0.006, 0.573 +- 0.020
Faith. Armon (L1)= 		  =  0.321 +- 0.059, 0.324 +- 0.046, 0.310 +- 0.037, 0.266 +- 0.053, 0.256 +- 0.055, 0.253 +- 0.063
Faith. GMean (L1)= 	  =  0.380 +- 0.035, 0.381 +- 0.028, 0.375 +- 0.022, 0.358 +- 0.036, 0.362 +- 0.042, 0.379 +- 0.057
Faith. Aritm (KL)= 		  =  0.445 +- 0.027, 0.441 +- 0.027, 0.450 +- 0.020, 0.489 +- 0.005, 0.512 +- 0.004, 0.533 +- 0.013
Faith. Armon (KL)= 		  =  0.196 +- 0.072, 0.200 +- 0.067, 0.188 +- 0.058, 0.139 +- 0.046, 0.128 +- 0.042, 0.124 +- 0.045
Faith. GMean (KL)= 	  =  0.288 +- 0.050, 0.292 +- 0.043, 0.287 +- 0.041, 0.257 +- 0.045, 0.252 +- 0.045, 0.253 +- 0.052

Eval split test
Faith. Aritm (L1)= 		  =  0.464 +- 0.015, 0.459 +- 0.012, 0.461 +- 0.013, 0.493 +- 0.006, 0.525 +- 0.006, 0.578 +- 0.016
Faith. Armon (L1)= 		  =  0.325 +- 0.061, 0.325 +- 0.053, 0.320 +- 0.034, 0.286 +- 0.040, 0.274 +- 0.043, 0.269 +- 0.049
Faith. GMean (L1)= 	  =  0.386 +- 0.037, 0.385 +- 0.032, 0.384 +- 0.021, 0.375 +- 0.027, 0.378 +- 0.032, 0.393 +- 0.043
Faith. Aritm (KL)= 		  =  0.457 +- 0.024, 0.451 +- 0.022, 0.456 +- 0.020, 0.494 +- 0.005, 0.516 +- 0.007, 0.534 +- 0.015
Faith. Armon (KL)= 		  =  0.192 +- 0.069, 0.194 +- 0.066, 0.185 +- 0.056, 0.143 +- 0.051, 0.132 +- 0.048, 0.127 +- 0.052
Faith. GMean (KL)= 	  =  0.290 +- 0.049, 0.290 +- 0.046, 0.287 +- 0.038, 0.261 +- 0.049, 0.256 +- 0.051, 0.255 +- 0.060
Computed for split load_split = id



Completed in  0:29:55.004331  for GSATvGIN LBAPcore/assay



DONE GSAT LBAPcore/assay

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed May  8 17:35:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/08/2024 05:35:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9879
Train Loss: 0.0408
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3836
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3737
OOD Validation ACCURACY: 0.8210
OOD Validation Loss: 0.7581
OOD Test ACCURACY: 0.3357
OOD Test Loss: 4.8493

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ACCURACY: 0.9669
Train Loss: 0.1038
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3636
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3454
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.3944
OOD Test ACCURACY: 0.5937
OOD Test Loss: 1.5026

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.3357 0.8920 0.5937 0.8889 0.8796[0mGOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
[1;31mERROR[0m: 05/08/2024 05:36:00 PM - utils.py - line 52 : [1mCUDA out of memory. Tried to allocate 820.00 MiB. GPU 1 has a total capacty of 11.77 GiB of which 578.25 MiB is free. Process 1398691 has 9.36 GiB memory in use. Including non-PyTorch memory, this process has 1.84 GiB memory in use. Of the allocated memory 932.54 MiB is allocated by PyTorch, and 35.46 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[0m
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/bin/goodtg", line 33, in <module>
    sys.exit(load_entry_point('graph-ood', 'console_scripts', 'goodtg')())
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 639, in goodtg
    print(f'#E#{e}')
