I'm the stability of the DET :))
The PID of this script is: 295677 running on GPU-1
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:36:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:36:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.5235
ID Validation ACCURACY: 0.8683
ID Validation Loss: 0.5030
ID Test ACCURACY: 0.8607
ID Test Loss: 0.5282
OOD Validation ACCURACY: 0.8537
OOD Validation Loss: 0.6475
OOD Test ACCURACY: 0.5690
OOD Test Loss: 1.2550

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 163...
[0m[1;37mINFO[0m: [1mCheckpoint 163: 
-----------------------------------
Train ACCURACY: 0.8449
Train Loss: 0.5037
ID Validation ACCURACY: 0.8490
ID Validation Loss: 0.4950
ID Test ACCURACY: 0.8447
ID Test Loss: 0.5158
OOD Validation ACCURACY: 0.8813
OOD Validation Loss: 0.5724
OOD Test ACCURACY: 0.8553
OOD Test Loss: 0.5144

[0m[1;37mINFO[0m: [1mChartInfo 0.8607 0.5690 0.8447 0.8553 0.8490 0.8813[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.396
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.081344
Plausibility completed in  0:00:25.951114
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5782, device='cuda:1')  +-  tensor(0.3478, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4556, device='cuda:1')  +-  tensor(0.2635, device='cuda:1') (0.101)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5782, device='cuda:1')  +-  tensor(0.3478, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5086, device='cuda:1')  +-  tensor(0.1725, device='cuda:1') (0.106)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.316 +- 0.499
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.598 +- 0.299
Num considered samples: 2966


ratio=0.6


Interventions completed in  0:00:05.510255
Plausibility completed in  0:00:24.082039
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6185, device='cuda:1')  +-  tensor(0.3233, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4376, device='cuda:1')  +-  tensor(0.2774, device='cuda:1') (0.069)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6185, device='cuda:1')  +-  tensor(0.3233, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7815, device='cuda:1')  +-  tensor(0.2686, device='cuda:1') (0.052)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.428 +- 0.491
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.872 +- 0.112
Num considered samples: 2773
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:37:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:37:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 106...
[0m[1;37mINFO[0m: [1mCheckpoint 106: 
-----------------------------------
Train ACCURACY: 0.9087
Train Loss: 0.4218
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.4062
ID Test ACCURACY: 0.9043
ID Test Loss: 0.4406
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.4153
OOD Test ACCURACY: 0.9043
OOD Test Loss: 0.4070

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ACCURACY: 0.8882
Train Loss: 0.4551
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4382
ID Test ACCURACY: 0.8887
ID Test Loss: 0.4541
OOD Validation ACCURACY: 0.9283
OOD Validation Loss: 0.4551
OOD Test ACCURACY: 0.9143
OOD Test Loss: 0.3807

[0m[1;37mINFO[0m: [1mChartInfo 0.9043 0.9043 0.8887 0.9143 0.8927 0.9283[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.341
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.523


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.758280
Plausibility completed in  0:00:24.935979
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6163, device='cuda:1')  +-  tensor(0.2547, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4771, device='cuda:1')  +-  tensor(0.2630, device='cuda:1') (0.057)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6163, device='cuda:1')  +-  tensor(0.2547, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5173, device='cuda:1')  +-  tensor(0.2169, device='cuda:1') (0.067)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.468 +- 0.490
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.683 +- 0.284
Num considered samples: 2820


ratio=0.6


Interventions completed in  0:00:05.366208
Plausibility completed in  0:00:24.820831
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6169, device='cuda:1')  +-  tensor(0.2545, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4927, device='cuda:1')  +-  tensor(0.2880, device='cuda:1') (0.038)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6169, device='cuda:1')  +-  tensor(0.2545, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7885, device='cuda:1')  +-  tensor(0.2184, device='cuda:1') (0.038)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.531 +- 0.499
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.877 +- 0.138
Num considered samples: 2815
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:38:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:38:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.8349
Train Loss: 0.5629
ID Validation ACCURACY: 0.8427
ID Validation Loss: 0.5385
ID Test ACCURACY: 0.8290
ID Test Loss: 0.5847
OOD Validation ACCURACY: 0.7613
OOD Validation Loss: 0.7380
OOD Test ACCURACY: 0.7983
OOD Test Loss: 0.5704

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.8374
Train Loss: 0.5193
ID Validation ACCURACY: 0.8337
ID Validation Loss: 0.5058
ID Test ACCURACY: 0.8260
ID Test Loss: 0.5460
OOD Validation ACCURACY: 0.8300
OOD Validation Loss: 0.6757
OOD Test ACCURACY: 0.8513
OOD Test Loss: 0.4627

[0m[1;37mINFO[0m: [1mChartInfo 0.8290 0.7983 0.8260 0.8513 0.8337 0.8300[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.643
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.754


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.090135
Plausibility completed in  0:00:26.527844
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7653, device='cuda:1')  +-  tensor(0.3009, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6922, device='cuda:1')  +-  tensor(0.2927, device='cuda:1') (0.124)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7653, device='cuda:1')  +-  tensor(0.3009, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6931, device='cuda:1')  +-  tensor(0.2274, device='cuda:1') (0.132)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.535 +- 0.490
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.732 +- 0.273
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.014371
Plausibility completed in  0:00:25.565324
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7722, device='cuda:1')  +-  tensor(0.2909, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6997, device='cuda:1')  +-  tensor(0.3103, device='cuda:1') (0.086)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7722, device='cuda:1')  +-  tensor(0.2909, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8796, device='cuda:1')  +-  tensor(0.1870, device='cuda:1') (0.061)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.610 +- 0.419
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.926 +- 0.085
Num considered samples: 2929
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:40:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:00 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:00 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:40:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:00 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:40:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:40:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 142...
[0m[1;37mINFO[0m: [1mCheckpoint 142: 
-----------------------------------
Train ACCURACY: 0.8396
Train Loss: 0.5054
ID Validation ACCURACY: 0.8567
ID Validation Loss: 0.4677
ID Test ACCURACY: 0.8283
ID Test Loss: 0.5320
OOD Validation ACCURACY: 0.7540
OOD Validation Loss: 0.7147
OOD Test ACCURACY: 0.8567
OOD Test Loss: 0.4681

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 142...
[0m[1;37mINFO[0m: [1mCheckpoint 142: 
-----------------------------------
Train ACCURACY: 0.8396
Train Loss: 0.5054
ID Validation ACCURACY: 0.8567
ID Validation Loss: 0.4677
ID Test ACCURACY: 0.8283
ID Test Loss: 0.5320
OOD Validation ACCURACY: 0.7540
OOD Validation Loss: 0.7147
OOD Test ACCURACY: 0.8567
OOD Test Loss: 0.4681

[0m[1;37mINFO[0m: [1mChartInfo 0.8283 0.8567 0.8283 0.8567 0.8567 0.7540[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.356
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.501


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.809314
Plausibility completed in  0:00:25.790646
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5657, device='cuda:1')  +-  tensor(0.3386, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5698, device='cuda:1')  +-  tensor(0.3254, device='cuda:1') (0.050)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5657, device='cuda:1')  +-  tensor(0.3386, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5681, device='cuda:1')  +-  tensor(0.2458, device='cuda:1') (0.055)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.584 +- 0.444
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.763 +- 0.252
Num considered samples: 2939


ratio=0.6


Interventions completed in  0:00:06.030824
Plausibility completed in  0:00:24.879772
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5708, device='cuda:1')  +-  tensor(0.3409, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5666, device='cuda:1')  +-  tensor(0.3527, device='cuda:1') (0.028)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5708, device='cuda:1')  +-  tensor(0.3409, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7977, device='cuda:1')  +-  tensor(0.2317, device='cuda:1') (0.036)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.563 +- 0.414
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.895 +- 0.103
Num considered samples: 2862
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:41:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:41:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.8734
Train Loss: 0.4599
ID Validation ACCURACY: 0.8810
ID Validation Loss: 0.4475
ID Test ACCURACY: 0.8727
ID Test Loss: 0.4786
OOD Validation ACCURACY: 0.8663
OOD Validation Loss: 0.5284
OOD Test ACCURACY: 0.8430
OOD Test Loss: 0.5743

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ACCURACY: 0.8522
Train Loss: 0.4709
ID Validation ACCURACY: 0.8573
ID Validation Loss: 0.4632
ID Test ACCURACY: 0.8450
ID Test Loss: 0.4949
OOD Validation ACCURACY: 0.9020
OOD Validation Loss: 0.5173
OOD Test ACCURACY: 0.8550
OOD Test Loss: 0.5385

[0m[1;37mINFO[0m: [1mChartInfo 0.8727 0.8430 0.8450 0.8550 0.8573 0.9020[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.378
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.480


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.575623
Plausibility completed in  0:00:23.744618
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6181, device='cuda:1')  +-  tensor(0.2841, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4308, device='cuda:1')  +-  tensor(0.2646, device='cuda:1') (0.069)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6181, device='cuda:1')  +-  tensor(0.2841, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5167, device='cuda:1')  +-  tensor(0.2286, device='cuda:1') (0.071)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.479 +- 0.574
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.690 +- 0.334
Num considered samples: 2731


ratio=0.6


Interventions completed in  0:00:04.028258
Plausibility completed in  0:00:17.009504
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6880, device='cuda:1')  +-  tensor(0.3087, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2760, device='cuda:1')  +-  tensor(0.2911, device='cuda:1') (0.055)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6880, device='cuda:1')  +-  tensor(0.3087, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5302, device='cuda:1')  +-  tensor(0.3969, device='cuda:1') (0.036)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.234 +- 0.483
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.803 +- 0.130
Num considered samples: 1953

\FINISHED GOODMotif2 - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.62872577 0.65326504] +- [0.07132806 0.07029305] (mean across ratios: 0.64 +- 0.05)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.52509295 0.49452221] +- [0.09585581 0.14018604] (mean across ratios: 0.51 +- 0.08)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.7014484  0.91124874] +- [0.08989525 0.06404053] (mean across ratios: 0.81 +- 0.06)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.56077243 0.75551219] +- [0.06946025 0.11809079] (mean across ratios: 0.66 +- 0.07)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999936 0.99999949] +- [6.95103633e-08 2.92001932e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.69313705 0.87464809] +- [0.05591853 0.04025949] (mean across ratios: 0.78 +- 0.03)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999998 1.        ] +- [2.92001932e-08 0.00000000e+00] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.47646905 0.47306702] +- [0.09034407 0.13365506] (mean across ratios: 0.47 +- 0.08)

Overall time of execution:  0:06:23.897456
DONE LECI GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:42:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:42:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.5235
ID Validation ACCURACY: 0.8683
ID Validation Loss: 0.5030
ID Test ACCURACY: 0.8607
ID Test Loss: 0.5282
OOD Validation ACCURACY: 0.8537
OOD Validation Loss: 0.6475
OOD Test ACCURACY: 0.5690
OOD Test Loss: 1.2550

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 163...
[0m[1;37mINFO[0m: [1mCheckpoint 163: 
-----------------------------------
Train ACCURACY: 0.8449
Train Loss: 0.5037
ID Validation ACCURACY: 0.8490
ID Validation Loss: 0.4950
ID Test ACCURACY: 0.8447
ID Test Loss: 0.5158
OOD Validation ACCURACY: 0.8813
OOD Validation Loss: 0.5724
OOD Test ACCURACY: 0.8553
OOD Test Loss: 0.5144

[0m[1;37mINFO[0m: [1mChartInfo 0.8607 0.5690 0.8447 0.8553 0.8490 0.8813[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.396
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.929709
Plausibility completed in  0:00:25.756252
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5782, device='cuda:1')  +-  tensor(0.3478, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4757, device='cuda:1')  +-  tensor(0.3094, device='cuda:1') (0.065)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5782, device='cuda:1')  +-  tensor(0.3478, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4576, device='cuda:1')  +-  tensor(0.1499, device='cuda:1') (0.068)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.013 +- 0.464
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.469 +- 0.260
Num considered samples: 2966


ratio=0.6


Interventions completed in  0:00:05.346712
Plausibility completed in  0:00:23.650424
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6185, device='cuda:1')  +-  tensor(0.3233, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4617, device='cuda:1')  +-  tensor(0.3301, device='cuda:1') (0.031)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6185, device='cuda:1')  +-  tensor(0.3233, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8208, device='cuda:1')  +-  tensor(0.2682, device='cuda:1') (0.023)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.228 +- 0.451
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.893 +- 0.091
Num considered samples: 2773
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:44:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:44:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 106...
[0m[1;37mINFO[0m: [1mCheckpoint 106: 
-----------------------------------
Train ACCURACY: 0.9087
Train Loss: 0.4218
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.4062
ID Test ACCURACY: 0.9043
ID Test Loss: 0.4406
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.4153
OOD Test ACCURACY: 0.9043
OOD Test Loss: 0.4070

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ACCURACY: 0.8882
Train Loss: 0.4551
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4382
ID Test ACCURACY: 0.8887
ID Test Loss: 0.4541
OOD Validation ACCURACY: 0.9283
OOD Validation Loss: 0.4551
OOD Test ACCURACY: 0.9143
OOD Test Loss: 0.3807

[0m[1;37mINFO[0m: [1mChartInfo 0.9043 0.9043 0.8887 0.9143 0.8927 0.9283[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.341
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.523


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.422047
Plausibility completed in  0:00:24.402107
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6163, device='cuda:1')  +-  tensor(0.2547, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4695, device='cuda:1')  +-  tensor(0.2657, device='cuda:1') (0.048)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6163, device='cuda:1')  +-  tensor(0.2547, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4741, device='cuda:1')  +-  tensor(0.1985, device='cuda:1') (0.055)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.313 +- 0.535
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.616 +- 0.296
Num considered samples: 2820


ratio=0.6


Interventions completed in  0:00:05.607521
Plausibility completed in  0:00:24.153997
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6169, device='cuda:1')  +-  tensor(0.2545, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4876, device='cuda:1')  +-  tensor(0.2919, device='cuda:1') (0.029)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6169, device='cuda:1')  +-  tensor(0.2545, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7969, device='cuda:1')  +-  tensor(0.2190, device='cuda:1') (0.029)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.416 +- 0.510
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.896 +- 0.123
Num considered samples: 2815
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:45:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:45:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.8349
Train Loss: 0.5629
ID Validation ACCURACY: 0.8427
ID Validation Loss: 0.5385
ID Test ACCURACY: 0.8290
ID Test Loss: 0.5847
OOD Validation ACCURACY: 0.7613
OOD Validation Loss: 0.7380
OOD Test ACCURACY: 0.7983
OOD Test Loss: 0.5704

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.8374
Train Loss: 0.5193
ID Validation ACCURACY: 0.8337
ID Validation Loss: 0.5058
ID Test ACCURACY: 0.8260
ID Test Loss: 0.5460
OOD Validation ACCURACY: 0.8300
OOD Validation Loss: 0.6757
OOD Test ACCURACY: 0.8513
OOD Test Loss: 0.4627

[0m[1;37mINFO[0m: [1mChartInfo 0.8290 0.7983 0.8260 0.8513 0.8337 0.8300[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.643
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.754


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.914621
Plausibility completed in  0:00:26.133304
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7653, device='cuda:1')  +-  tensor(0.3009, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6744, device='cuda:1')  +-  tensor(0.3036, device='cuda:1') (0.122)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7653, device='cuda:1')  +-  tensor(0.3009, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6374, device='cuda:1')  +-  tensor(0.2218, device='cuda:1') (0.133)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.388 +- 0.533
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.667 +- 0.285
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.611854
Plausibility completed in  0:00:25.177098
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7722, device='cuda:1')  +-  tensor(0.2909, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7220, device='cuda:1')  +-  tensor(0.3224, device='cuda:1') (0.051)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7722, device='cuda:1')  +-  tensor(0.2909, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8837, device='cuda:1')  +-  tensor(0.1993, device='cuda:1') (0.031)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.359 +- 0.440
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.940 +- 0.073
Num considered samples: 2929
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:46:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:37 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:37 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:46:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:37 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:46:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 142...
[0m[1;37mINFO[0m: [1mCheckpoint 142: 
-----------------------------------
Train ACCURACY: 0.8396
Train Loss: 0.5054
ID Validation ACCURACY: 0.8567
ID Validation Loss: 0.4677
ID Test ACCURACY: 0.8283
ID Test Loss: 0.5320
OOD Validation ACCURACY: 0.7540
OOD Validation Loss: 0.7147
OOD Test ACCURACY: 0.8567
OOD Test Loss: 0.4681

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 142...
[0m[1;37mINFO[0m: [1mCheckpoint 142: 
-----------------------------------
Train ACCURACY: 0.8396
Train Loss: 0.5054
ID Validation ACCURACY: 0.8567
ID Validation Loss: 0.4677
ID Test ACCURACY: 0.8283
ID Test Loss: 0.5320
OOD Validation ACCURACY: 0.7540
OOD Validation Loss: 0.7147
OOD Test ACCURACY: 0.8567
OOD Test Loss: 0.4681

[0m[1;37mINFO[0m: [1mChartInfo 0.8283 0.8567 0.8283 0.8567 0.8567 0.7540[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.356
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.501


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.912769
Plausibility completed in  0:00:26.646997
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5657, device='cuda:1')  +-  tensor(0.3386, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5686, device='cuda:1')  +-  tensor(0.3122, device='cuda:1') (0.044)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5657, device='cuda:1')  +-  tensor(0.3386, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5465, device='cuda:1')  +-  tensor(0.2273, device='cuda:1') (0.050)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.443 +- 0.506
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.705 +- 0.269
Num considered samples: 2939


ratio=0.6


Interventions completed in  0:00:05.709439
Plausibility completed in  0:00:24.613188
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5708, device='cuda:1')  +-  tensor(0.3409, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5759, device='cuda:1')  +-  tensor(0.3498, device='cuda:1') (0.015)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5708, device='cuda:1')  +-  tensor(0.3409, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8059, device='cuda:1')  +-  tensor(0.2380, device='cuda:1') (0.022)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.335 +- 0.468
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.901 +- 0.099
Num considered samples: 2862
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:47:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:47:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.8734
Train Loss: 0.4599
ID Validation ACCURACY: 0.8810
ID Validation Loss: 0.4475
ID Test ACCURACY: 0.8727
ID Test Loss: 0.4786
OOD Validation ACCURACY: 0.8663
OOD Validation Loss: 0.5284
OOD Test ACCURACY: 0.8430
OOD Test Loss: 0.5743

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ACCURACY: 0.8522
Train Loss: 0.4709
ID Validation ACCURACY: 0.8573
ID Validation Loss: 0.4632
ID Test ACCURACY: 0.8450
ID Test Loss: 0.4949
OOD Validation ACCURACY: 0.9020
OOD Validation Loss: 0.5173
OOD Test ACCURACY: 0.8550
OOD Test Loss: 0.5385

[0m[1;37mINFO[0m: [1mChartInfo 0.8727 0.8430 0.8450 0.8550 0.8573 0.9020[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.378
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.480


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.280447
Plausibility completed in  0:00:24.274156
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6181, device='cuda:1')  +-  tensor(0.2841, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3305, device='cuda:1')  +-  tensor(0.1666, device='cuda:1') (0.044)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6181, device='cuda:1')  +-  tensor(0.2841, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4366, device='cuda:1')  +-  tensor(0.1564, device='cuda:1') (0.042)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.230 +- 0.659
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.574 +- 0.360
Num considered samples: 2731


ratio=0.6


Interventions completed in  0:00:04.330203
Plausibility completed in  0:00:16.872058
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6880, device='cuda:1')  +-  tensor(0.3087, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1878, device='cuda:1')  +-  tensor(0.1698, device='cuda:1') (0.013)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6880, device='cuda:1')  +-  tensor(0.3087, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5427, device='cuda:1')  +-  tensor(0.4047, device='cuda:1') (0.011)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.001 +- 0.328
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.805 +- 0.096
Num considered samples: 1953

\FINISHED GOODMotif2 - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.62872577 0.65326504] +- [0.07132806 0.07029305] (mean across ratios: 0.64 +- 0.05)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.50371222 0.48701071] +- [0.11428433 0.17507597] (mean across ratios: 0.50 +- 0.10)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.7014484  0.91124874] +- [0.08989525 0.06404053] (mean across ratios: 0.81 +- 0.06)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.51043469 0.7699797 ] +- [0.07344093 0.11763921] (mean across ratios: 0.64 +- 0.07)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999936 0.99999949] +- [6.95103633e-08 2.92001932e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.6059895 0.8869802] +- [0.08178987 0.04424233] (mean across ratios: 0.75 +- 0.05)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999998 1.        ] +- [2.92001932e-08 0.00000000e+00] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.27747923 0.26748949] +- [0.15035161 0.14744069] (mean across ratios: 0.27 +- 0.11)

Overall time of execution:  0:06:20.247816
DONE LECI GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:49:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:18 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:18 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:18 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:49:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:49:18 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 11:49:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 18...
[0m[1;37mINFO[0m: [1mCheckpoint 18: 
-----------------------------------
Train ACCURACY: 0.6871
Train Loss: 0.8504
ID Validation ACCURACY: 0.6993
ID Validation Loss: 0.8351
ID Test ACCURACY: 0.6983
ID Test Loss: 0.8449
OOD Validation ACCURACY: 0.5330
OOD Validation Loss: 1.1042
OOD Test ACCURACY: 0.5190
OOD Test Loss: 1.0268

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ACCURACY: 0.5497
Train Loss: 1.1856
ID Validation ACCURACY: 0.5620
ID Validation Loss: 1.1989
ID Test ACCURACY: 0.5707
ID Test Loss: 1.1955
OOD Validation ACCURACY: 0.6903
OOD Validation Loss: 0.7487
OOD Test ACCURACY: 0.6773
OOD Test Loss: 0.7183

[0m[1;37mINFO[0m: [1mChartInfo 0.6983 0.5190 0.5707 0.6773 0.5620 0.6903[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.049
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.131


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.826966
Plausibility completed in  0:00:25.947788
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3242, device='cuda:1')  +-  tensor(0.2100, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3123, device='cuda:1')  +-  tensor(0.2024, device='cuda:1') (0.013)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3242, device='cuda:1')  +-  tensor(0.2100, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4562, device='cuda:1')  +-  tensor(0.1341, device='cuda:1') (0.010)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.287 +- 0.244
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.645 +- 0.135
Num considered samples: 2793


ratio=0.6


Interventions completed in  0:00:04.464423
Plausibility completed in  0:00:19.168878
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2973, device='cuda:1')  +-  tensor(0.2300, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2024, device='cuda:1')  +-  tensor(0.1944, device='cuda:1') (0.012)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2973, device='cuda:1')  +-  tensor(0.2300, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5230, device='cuda:1')  +-  tensor(0.3320, device='cuda:1') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.114 +- 0.197
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.780 +- 0.074
Num considered samples: 2154
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:50:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:50:33 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:50:33 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:50:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:50:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:50:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:50:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:50:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:50:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:50:33 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 11:50:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.6884
Train Loss: 0.7575
ID Validation ACCURACY: 0.7133
ID Validation Loss: 0.7174
ID Test ACCURACY: 0.6943
ID Test Loss: 0.7583
OOD Validation ACCURACY: 0.5157
OOD Validation Loss: 1.1036
OOD Test ACCURACY: 0.7193
OOD Test Loss: 0.7663

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 75...
[0m[1;37mINFO[0m: [1mCheckpoint 75: 
-----------------------------------
Train ACCURACY: 0.5467
Train Loss: 0.9902
ID Validation ACCURACY: 0.5517
ID Validation Loss: 0.9905
ID Test ACCURACY: 0.5537
ID Test Loss: 0.9969
OOD Validation ACCURACY: 0.7237
OOD Validation Loss: 0.7625
OOD Test ACCURACY: 0.6420
OOD Test Loss: 0.7160

[0m[1;37mINFO[0m: [1mChartInfo 0.6943 0.7193 0.5537 0.6420 0.5517 0.7237[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.035
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.294


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.784390
Plausibility completed in  0:00:26.088656
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3631, device='cuda:1')  +-  tensor(0.1883, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3682, device='cuda:1')  +-  tensor(0.2059, device='cuda:1') (0.052)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3631, device='cuda:1')  +-  tensor(0.1883, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3997, device='cuda:1')  +-  tensor(0.1051, device='cuda:1') (0.034)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.117 +- 0.284
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.509 +- 0.160
Num considered samples: 2879


ratio=0.6


Interventions completed in  0:00:05.638543
Plausibility completed in  0:00:25.132983
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3580, device='cuda:1')  +-  tensor(0.1866, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3611, device='cuda:1')  +-  tensor(0.2191, device='cuda:1') (0.037)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3580, device='cuda:1')  +-  tensor(0.1866, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6966, device='cuda:1')  +-  tensor(0.1890, device='cuda:1') (0.022)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.085 +- 0.314
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.751 +- 0.095
Num considered samples: 2818
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:51:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:53 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:53 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:51:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:51:53 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 11:51:53 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.6692
Train Loss: 0.8985
ID Validation ACCURACY: 0.6720
ID Validation Loss: 0.8802
ID Test ACCURACY: 0.6757
ID Test Loss: 0.8848
OOD Validation ACCURACY: 0.3387
OOD Validation Loss: 1.1799
OOD Test ACCURACY: 0.5467
OOD Test Loss: 0.8602

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 100...
[0m[1;37mINFO[0m: [1mCheckpoint 100: 
-----------------------------------
Train ACCURACY: 0.5163
Train Loss: 1.2847
ID Validation ACCURACY: 0.5163
ID Validation Loss: 1.3363
ID Test ACCURACY: 0.5163
ID Test Loss: 1.3361
OOD Validation ACCURACY: 0.6937
OOD Validation Loss: 0.7726
OOD Test ACCURACY: 0.6027
OOD Test Loss: 0.9304

[0m[1;37mINFO[0m: [1mChartInfo 0.6757 0.5467 0.5163 0.6027 0.5163 0.6937[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.050


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.498861
Plausibility completed in  0:00:24.759488
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2769, device='cuda:1')  +-  tensor(0.1266, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2738, device='cuda:1')  +-  tensor(0.1611, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2769, device='cuda:1')  +-  tensor(0.1266, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4499, device='cuda:1')  +-  tensor(0.1458, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.339 +- 0.220
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.692 +- 0.095
Num considered samples: 2731


ratio=0.6


Interventions completed in  0:00:04.151699
Plausibility completed in  0:00:17.642652
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2266, device='cuda:1')  +-  tensor(0.1064, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1589, device='cuda:1')  +-  tensor(0.1447, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2266, device='cuda:1')  +-  tensor(0.1064, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4885, device='cuda:1')  +-  tensor(0.3467, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.201 +- 0.131
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.816 +- 0.043
Num considered samples: 1998
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:53:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:02 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:02 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:02 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:53:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:53:02 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 11:53:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 0.7740
Train Loss: 0.6713
ID Validation ACCURACY: 0.7883
ID Validation Loss: 0.6566
ID Test ACCURACY: 0.7730
ID Test Loss: 0.7012
OOD Validation ACCURACY: 0.4643
OOD Validation Loss: 1.2859
OOD Test ACCURACY: 0.7057
OOD Test Loss: 0.6370

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.6974
Train Loss: 0.7951
ID Validation ACCURACY: 0.7197
ID Validation Loss: 0.7468
ID Test ACCURACY: 0.7103
ID Test Loss: 0.8074
OOD Validation ACCURACY: 0.6740
OOD Validation Loss: 0.8290
OOD Test ACCURACY: 0.6273
OOD Test Loss: 0.9364

[0m[1;37mINFO[0m: [1mChartInfo 0.7730 0.7057 0.7103 0.6273 0.7197 0.6740[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.035
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.271


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.044919
Plausibility completed in  0:00:26.760288
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3830, device='cuda:1')  +-  tensor(0.1926, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3873, device='cuda:1')  +-  tensor(0.2076, device='cuda:1') (0.025)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3830, device='cuda:1')  +-  tensor(0.1926, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4175, device='cuda:1')  +-  tensor(0.0882, device='cuda:1') (0.023)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.192 +- 0.238
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.567 +- 0.141
Num considered samples: 2935


ratio=0.6


Interventions completed in  0:00:05.887151
Plausibility completed in  0:00:26.520000
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3833, device='cuda:1')  +-  tensor(0.1929, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3847, device='cuda:1')  +-  tensor(0.2099, device='cuda:1') (0.022)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3833, device='cuda:1')  +-  tensor(0.1929, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7175, device='cuda:1')  +-  tensor(0.1360, device='cuda:1') (0.017)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.013 +- 0.252
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.747 +- 0.096
Num considered samples: 2922
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:54:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:54:24 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:54:24 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:54:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:54:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:54:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:54:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:54:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:54:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:54:24 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 11:54:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.6885
Train Loss: 0.8644
ID Validation ACCURACY: 0.6977
ID Validation Loss: 0.8397
ID Test ACCURACY: 0.6903
ID Test Loss: 0.8483
OOD Validation ACCURACY: 0.5057
OOD Validation Loss: 1.1208
OOD Test ACCURACY: 0.6890
OOD Test Loss: 0.8000

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 78...
[0m[1;37mINFO[0m: [1mCheckpoint 78: 
-----------------------------------
Train ACCURACY: 0.4692
Train Loss: 1.2687
ID Validation ACCURACY: 0.4743
ID Validation Loss: 1.2830
ID Test ACCURACY: 0.4663
ID Test Loss: 1.2951
OOD Validation ACCURACY: 0.6260
OOD Validation Loss: 0.8764
OOD Test ACCURACY: 0.3913
OOD Test Loss: 1.4173

[0m[1;37mINFO[0m: [1mChartInfo 0.6903 0.6890 0.4663 0.3913 0.4743 0.6260[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.043


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.502303
Plausibility completed in  0:00:24.280327
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2742, device='cuda:1')  +-  tensor(0.1258, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2704, device='cuda:1')  +-  tensor(0.1567, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2742, device='cuda:1')  +-  tensor(0.1258, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4513, device='cuda:1')  +-  tensor(0.1465, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.362 +- 0.207
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.706 +- 0.085
Num considered samples: 2731


ratio=0.6


Interventions completed in  0:00:03.664717
Plausibility completed in  0:00:16.322795
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1899, device='cuda:1')  +-  tensor(0.0632, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1151, device='cuda:1')  +-  tensor(0.1109, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1899, device='cuda:1')  +-  tensor(0.0632, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4266, device='cuda:1')  +-  tensor(0.3696, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.238 +- 0.085
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.823 +- 0.028
Num considered samples: 1715

\FINISHED GOODMotif2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.32426512 0.29100441] +- [0.04404092 0.07404658] (mean across ratios: 0.31 +- 0.04)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.32238863 0.24443101] +- [0.04791943 0.10871116] (mean across ratios: 0.28 +- 0.06)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.3697978 0.7181155] +- [0.05444451 0.09364763] (mean across ratios: 0.54 +- 0.05)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.43490849 0.5704594 ] +- [0.02230173 0.11593005] (mean across ratios: 0.50 +- 0.06)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999945 0.99999951] +- [2.38418579e-08 2.38418579e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.62353275 0.78326801] +- [0.07526154 0.03151331] (mean across ratios: 0.70 +- 0.04)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1.         0.99999999] +- [0.00000000e+00 2.38418579e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.25949596 0.13017117] +- [0.09218614 0.0809755 ] (mean across ratios: 0.19 +- 0.06)

Overall time of execution:  0:06:16.047869
DONE GSAT GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:55:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:45 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:45 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:55:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:55:45 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 11:55:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 18...
[0m[1;37mINFO[0m: [1mCheckpoint 18: 
-----------------------------------
Train ACCURACY: 0.6871
Train Loss: 0.8504
ID Validation ACCURACY: 0.6993
ID Validation Loss: 0.8351
ID Test ACCURACY: 0.6983
ID Test Loss: 0.8449
OOD Validation ACCURACY: 0.5330
OOD Validation Loss: 1.1042
OOD Test ACCURACY: 0.5190
OOD Test Loss: 1.0268

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ACCURACY: 0.5497
Train Loss: 1.1856
ID Validation ACCURACY: 0.5620
ID Validation Loss: 1.1989
ID Test ACCURACY: 0.5707
ID Test Loss: 1.1955
OOD Validation ACCURACY: 0.6903
OOD Validation Loss: 0.7487
OOD Test ACCURACY: 0.6773
OOD Test Loss: 0.7183

[0m[1;37mINFO[0m: [1mChartInfo 0.6983 0.5190 0.5707 0.6773 0.5620 0.6903[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.049
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.131


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.805916
Plausibility completed in  0:00:24.787367
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3242, device='cuda:1')  +-  tensor(0.2100, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3421, device='cuda:1')  +-  tensor(0.2178, device='cuda:1') (0.012)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3242, device='cuda:1')  +-  tensor(0.2100, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4894, device='cuda:1')  +-  tensor(0.1425, device='cuda:1') (0.010)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.218 +- 0.262
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.648 +- 0.105
Num considered samples: 2793


ratio=0.6


Interventions completed in  0:00:04.488338
Plausibility completed in  0:00:22.176153
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2973, device='cuda:1')  +-  tensor(0.2300, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2215, device='cuda:1')  +-  tensor(0.2227, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2973, device='cuda:1')  +-  tensor(0.2300, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5600, device='cuda:1')  +-  tensor(0.3590, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.137 +- 0.143
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.833 +- 0.077
Num considered samples: 2154
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:57:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:57:02 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:57:02 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:57:02 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:57:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:57:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:57:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:57:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:57:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:57:02 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 11:57:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.6884
Train Loss: 0.7575
ID Validation ACCURACY: 0.7133
ID Validation Loss: 0.7174
ID Test ACCURACY: 0.6943
ID Test Loss: 0.7583
OOD Validation ACCURACY: 0.5157
OOD Validation Loss: 1.1036
OOD Test ACCURACY: 0.7193
OOD Test Loss: 0.7663

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 75...
[0m[1;37mINFO[0m: [1mCheckpoint 75: 
-----------------------------------
Train ACCURACY: 0.5467
Train Loss: 0.9902
ID Validation ACCURACY: 0.5517
ID Validation Loss: 0.9905
ID Test ACCURACY: 0.5537
ID Test Loss: 0.9969
OOD Validation ACCURACY: 0.7237
OOD Validation Loss: 0.7625
OOD Test ACCURACY: 0.6420
OOD Test Loss: 0.7160

[0m[1;37mINFO[0m: [1mChartInfo 0.6943 0.7193 0.5537 0.6420 0.5517 0.7237[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.035
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.294


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.859809
Plausibility completed in  0:00:25.700802
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3631, device='cuda:1')  +-  tensor(0.1883, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4121, device='cuda:1')  +-  tensor(0.2687, device='cuda:1') (0.031)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3631, device='cuda:1')  +-  tensor(0.1883, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4279, device='cuda:1')  +-  tensor(0.1116, device='cuda:1') (0.024)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.087 +- 0.260
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.530 +- 0.136
Num considered samples: 2879


ratio=0.6


Interventions completed in  0:00:05.694146
Plausibility completed in  0:00:26.751984
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3580, device='cuda:1')  +-  tensor(0.1866, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3930, device='cuda:1')  +-  tensor(0.2740, device='cuda:1') (0.022)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3580, device='cuda:1')  +-  tensor(0.1866, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7562, device='cuda:1')  +-  tensor(0.2170, device='cuda:1') (0.016)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.091 +- 0.284
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.817 +- 0.112
Num considered samples: 2818
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:58:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:24 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:24 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:58:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:58:24 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 11:58:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.6692
Train Loss: 0.8985
ID Validation ACCURACY: 0.6720
ID Validation Loss: 0.8802
ID Test ACCURACY: 0.6757
ID Test Loss: 0.8848
OOD Validation ACCURACY: 0.3387
OOD Validation Loss: 1.1799
OOD Test ACCURACY: 0.5467
OOD Test Loss: 0.8602

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 100...
[0m[1;37mINFO[0m: [1mCheckpoint 100: 
-----------------------------------
Train ACCURACY: 0.5163
Train Loss: 1.2847
ID Validation ACCURACY: 0.5163
ID Validation Loss: 1.3363
ID Test ACCURACY: 0.5163
ID Test Loss: 1.3361
OOD Validation ACCURACY: 0.6937
OOD Validation Loss: 0.7726
OOD Test ACCURACY: 0.6027
OOD Test Loss: 0.9304

[0m[1;37mINFO[0m: [1mChartInfo 0.6757 0.5467 0.5163 0.6027 0.5163 0.6937[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.050


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.577783
Plausibility completed in  0:00:24.408988
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2769, device='cuda:1')  +-  tensor(0.1266, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2882, device='cuda:1')  +-  tensor(0.1627, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2769, device='cuda:1')  +-  tensor(0.1266, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4746, device='cuda:1')  +-  tensor(0.1547, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.296 +- 0.216
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.690 +- 0.098
Num considered samples: 2731


ratio=0.6


Interventions completed in  0:00:04.203626
Plausibility completed in  0:00:17.779554
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2266, device='cuda:1')  +-  tensor(0.1064, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1629, device='cuda:1')  +-  tensor(0.1456, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2266, device='cuda:1')  +-  tensor(0.1064, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5049, device='cuda:1')  +-  tensor(0.3584, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.203 +- 0.132
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.834 +- 0.039
Num considered samples: 1998
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 11:59:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:34 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:34 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:34 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 11:59:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 11:59:34 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 11:59:34 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 0.7740
Train Loss: 0.6713
ID Validation ACCURACY: 0.7883
ID Validation Loss: 0.6566
ID Test ACCURACY: 0.7730
ID Test Loss: 0.7012
OOD Validation ACCURACY: 0.4643
OOD Validation Loss: 1.2859
OOD Test ACCURACY: 0.7057
OOD Test Loss: 0.6370

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.6974
Train Loss: 0.7951
ID Validation ACCURACY: 0.7197
ID Validation Loss: 0.7468
ID Test ACCURACY: 0.7103
ID Test Loss: 0.8074
OOD Validation ACCURACY: 0.6740
OOD Validation Loss: 0.8290
OOD Test ACCURACY: 0.6273
OOD Test Loss: 0.9364

[0m[1;37mINFO[0m: [1mChartInfo 0.7730 0.7057 0.7103 0.6273 0.7197 0.6740[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.035
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.271


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.537717
Plausibility completed in  0:00:26.715872
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3830, device='cuda:1')  +-  tensor(0.1926, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4416, device='cuda:1')  +-  tensor(0.2527, device='cuda:1') (0.015)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3830, device='cuda:1')  +-  tensor(0.1926, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4443, device='cuda:1')  +-  tensor(0.0949, device='cuda:1') (0.017)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.101 +- 0.252
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.557 +- 0.118
Num considered samples: 2935


ratio=0.6


Interventions completed in  0:00:05.962001
Plausibility completed in  0:00:26.043317
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3833, device='cuda:1')  +-  tensor(0.1929, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4324, device='cuda:1')  +-  tensor(0.2542, device='cuda:1') (0.010)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3833, device='cuda:1')  +-  tensor(0.1929, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7680, device='cuda:1')  +-  tensor(0.1560, device='cuda:1') (0.010)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.022 +- 0.199
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.806 +- 0.099
Num considered samples: 2922
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 12:01:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:09 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:09 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:01:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 12:01:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.6885
Train Loss: 0.8644
ID Validation ACCURACY: 0.6977
ID Validation Loss: 0.8397
ID Test ACCURACY: 0.6903
ID Test Loss: 0.8483
OOD Validation ACCURACY: 0.5057
OOD Validation Loss: 1.1208
OOD Test ACCURACY: 0.6890
OOD Test Loss: 0.8000

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 78...
[0m[1;37mINFO[0m: [1mCheckpoint 78: 
-----------------------------------
Train ACCURACY: 0.4692
Train Loss: 1.2687
ID Validation ACCURACY: 0.4743
ID Validation Loss: 1.2830
ID Test ACCURACY: 0.4663
ID Test Loss: 1.2951
OOD Validation ACCURACY: 0.6260
OOD Validation Loss: 0.8764
OOD Test ACCURACY: 0.3913
OOD Test Loss: 1.4173

[0m[1;37mINFO[0m: [1mChartInfo 0.6903 0.6890 0.4663 0.3913 0.4743 0.6260[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.043


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.839853
Plausibility completed in  0:00:31.317586
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2742, device='cuda:1')  +-  tensor(0.1258, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2831, device='cuda:1')  +-  tensor(0.1575, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2742, device='cuda:1')  +-  tensor(0.1258, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4770, device='cuda:1')  +-  tensor(0.1557, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.325 +- 0.200
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.707 +- 0.087
Num considered samples: 2731


ratio=0.6


Interventions completed in  0:00:05.285521
Plausibility completed in  0:00:20.624482
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1899, device='cuda:1')  +-  tensor(0.0632, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1189, device='cuda:1')  +-  tensor(0.1135, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1899, device='cuda:1')  +-  tensor(0.0632, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4426, device='cuda:1')  +-  tensor(0.3837, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.242 +- 0.099
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.842 +- 0.032
Num considered samples: 1715

\FINISHED GOODMotif2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.32426512 0.29100441] +- [0.04404092 0.07404658] (mean across ratios: 0.31 +- 0.04)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.35342327 0.2657487 ] +- [0.06411181 0.12496342] (mean across ratios: 0.31 +- 0.07)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.3697978 0.7181155] +- [0.05444451 0.09364763] (mean across ratios: 0.54 +- 0.05)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.46264263 0.60633151] +- [0.02283849 0.132554  ] (mean across ratios: 0.53 +- 0.07)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999945 0.99999951] +- [2.38418579e-08 2.38418579e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.62629875 0.82653042] +- [0.0705756  0.01312753] (mean across ratios: 0.73 +- 0.04)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1.         0.99999999] +- [0.00000000e+00 2.38418579e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.20543896 0.13026947] +- [0.09765191 0.09231277] (mean across ratios: 0.17 +- 0.07)

Overall time of execution:  0:06:48.078086
DONE GSAT GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 12:02:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:50 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:50 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:02:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9989
Train Loss: 0.0081
ID Validation ACCURACY: 0.8799
ID Validation Loss: 0.4755
ID Test ACCURACY: 0.8819
ID Test Loss: 0.4854
OOD Validation ACCURACY: 0.8617
OOD Validation Loss: 0.5669
OOD Test ACCURACY: 0.7476
OOD Test Loss: 1.1971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9611
Train Loss: 0.1229
ID Validation ACCURACY: 0.8749
ID Validation Loss: 0.4002
ID Test ACCURACY: 0.8791
ID Test Loss: 0.3989
OOD Validation ACCURACY: 0.8756
OOD Validation Loss: 0.4110
OOD Test ACCURACY: 0.7587
OOD Test Loss: 0.8224

[0m[1;37mINFO[0m: [1mChartInfo 0.8819 0.7476 0.8791 0.7587 0.8749 0.8756[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:16.704380
Plausibility completed in  0:01:59.900778
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5660, device='cuda:1')  +-  tensor(0.0082, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.725256
Plausibility completed in  0:02:11.144500
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9318, device='cuda:1')  +-  tensor(0.0099, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.992 +- 0.012
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.999 +- 0.001
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 12:25:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ACCURACY: 0.9985
Train Loss: 0.0098
ID Validation ACCURACY: 0.8837
ID Validation Loss: 0.5031
ID Test ACCURACY: 0.8831
ID Test Loss: 0.4930
OOD Validation ACCURACY: 0.8623
OOD Validation Loss: 0.5645
OOD Test ACCURACY: 0.6190
OOD Test Loss: 2.3743

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9724
Train Loss: 0.0901
ID Validation ACCURACY: 0.8793
ID Validation Loss: 0.4008
ID Test ACCURACY: 0.8846
ID Test Loss: 0.3936
OOD Validation ACCURACY: 0.8716
OOD Validation Loss: 0.4173
OOD Test ACCURACY: 0.7290
OOD Test Loss: 0.9761

[0m[1;37mINFO[0m: [1mChartInfo 0.8831 0.6190 0.8846 0.7290 0.8793 0.8716[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.920131
Plausibility completed in  0:02:00.419489
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5660, device='cuda:1')  +-  tensor(0.0082, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.899959
Plausibility completed in  0:02:06.265520
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9318, device='cuda:1')  +-  tensor(0.0099, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.992 +- 0.012
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.999 +- 0.001
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 12:43:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 12:43:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9771
Train Loss: 0.0788
ID Validation ACCURACY: 0.8796
ID Validation Loss: 0.4118
ID Test ACCURACY: 0.8799
ID Test Loss: 0.4099
OOD Validation ACCURACY: 0.8694
OOD Validation Loss: 0.4406
OOD Test ACCURACY: 0.7794
OOD Test Loss: 0.8262

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 151...
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.9966
Train Loss: 0.0192
ID Validation ACCURACY: 0.8714
ID Validation Loss: 0.4738
ID Test ACCURACY: 0.8740
ID Test Loss: 0.4719
OOD Validation ACCURACY: 0.8739
OOD Validation Loss: 0.4821
OOD Test ACCURACY: 0.8027
OOD Test Loss: 0.8199

[0m[1;37mINFO[0m: [1mChartInfo 0.8799 0.7794 0.8740 0.8027 0.8714 0.8739[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.803983
Plausibility completed in  0:01:58.652003
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5660, device='cuda:1')  +-  tensor(0.0082, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.445326
Plausibility completed in  0:02:05.345607
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9318, device='cuda:1')  +-  tensor(0.0099, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.992 +- 0.012
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.999 +- 0.001
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 13:00:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:54 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:54 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:00:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 169...
[0m[1;37mINFO[0m: [1mCheckpoint 169: 
-----------------------------------
Train ACCURACY: 0.9992
Train Loss: 0.0075
ID Validation ACCURACY: 0.8839
ID Validation Loss: 0.4781
ID Test ACCURACY: 0.8827
ID Test Loss: 0.5041
OOD Validation ACCURACY: 0.8734
OOD Validation Loss: 0.5221
OOD Test ACCURACY: 0.7557
OOD Test Loss: 1.1829

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.9862
Train Loss: 0.0531
ID Validation ACCURACY: 0.8741
ID Validation Loss: 0.4244
ID Test ACCURACY: 0.8776
ID Test Loss: 0.4244
OOD Validation ACCURACY: 0.8810
OOD Validation Loss: 0.4194
OOD Test ACCURACY: 0.7921
OOD Test Loss: 0.8078

[0m[1;37mINFO[0m: [1mChartInfo 0.8827 0.7557 0.8776 0.7921 0.8741 0.8810[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.962685
Plausibility completed in  0:01:57.937316
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5660, device='cuda:1')  +-  tensor(0.0082, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.948574
Plausibility completed in  0:02:13.863066
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9318, device='cuda:1')  +-  tensor(0.0099, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.992 +- 0.012
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.999 +- 0.001
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 13:16:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:16:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ACCURACY: 0.9837
Train Loss: 0.0597
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.4132
ID Test ACCURACY: 0.8796
ID Test Loss: 0.4055
OOD Validation ACCURACY: 0.8721
OOD Validation Loss: 0.4230
OOD Test ACCURACY: 0.7870
OOD Test Loss: 0.8251

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9769
Train Loss: 0.0782
ID Validation ACCURACY: 0.8811
ID Validation Loss: 0.4010
ID Test ACCURACY: 0.8799
ID Test Loss: 0.4049
OOD Validation ACCURACY: 0.8813
OOD Validation Loss: 0.4007
OOD Test ACCURACY: 0.7771
OOD Test Loss: 0.8287

[0m[1;37mINFO[0m: [1mChartInfo 0.8796 0.7870 0.8799 0.7771 0.8811 0.8813[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:16.295993
Plausibility completed in  0:01:58.499862
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5660, device='cuda:1')  +-  tensor(0.0082, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.969320
Plausibility completed in  0:02:17.373778
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9318, device='cuda:1')  +-  tensor(0.0099, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.992 +- 0.012
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.999 +- 0.001
Num considered samples: 7000

\FINISHED GOODCMNIST - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.30034459 0.60039657] +- [0. 0.] (mean across ratios: 0.45 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.56600466 0.93181721] +- [1.89148745e-06 1.22826070e-06] (mean across ratios: 0.75 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999958 0.99999958] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.9990921  0.99942935] +- [1.19149670e-06 7.50166546e-07] (mean across ratios: 1.00 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1. 1.] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.99791586 0.99168541] +- [2.63907937e-06 1.24232782e-05] (mean across ratios: 0.99 +- 0.00)

Overall time of execution:  1:29:04.878988
DONE LECI GOODCMNIST/color 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 13:32:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9989
Train Loss: 0.0081
ID Validation ACCURACY: 0.8799
ID Validation Loss: 0.4755
ID Test ACCURACY: 0.8819
ID Test Loss: 0.4854
OOD Validation ACCURACY: 0.8617
OOD Validation Loss: 0.5669
OOD Test ACCURACY: 0.7476
OOD Test Loss: 1.1971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9611
Train Loss: 0.1229
ID Validation ACCURACY: 0.8749
ID Validation Loss: 0.4002
ID Test ACCURACY: 0.8791
ID Test Loss: 0.3989
OOD Validation ACCURACY: 0.8756
OOD Validation Loss: 0.4110
OOD Test ACCURACY: 0.7587
OOD Test Loss: 0.8224

[0m[1;37mINFO[0m: [1mChartInfo 0.8819 0.7476 0.8791 0.7587 0.8749 0.8756[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:17.063222
Plausibility completed in  0:02:07.231420
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6370, device='cuda:1')  +-  tensor(0.0116, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:18.396961
Plausibility completed in  0:02:13.264559
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.001 +- 0.028
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.001
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 13:52:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 01:52:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ACCURACY: 0.9985
Train Loss: 0.0098
ID Validation ACCURACY: 0.8837
ID Validation Loss: 0.5031
ID Test ACCURACY: 0.8831
ID Test Loss: 0.4930
OOD Validation ACCURACY: 0.8623
OOD Validation Loss: 0.5645
OOD Test ACCURACY: 0.6190
OOD Test Loss: 2.3743

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9724
Train Loss: 0.0901
ID Validation ACCURACY: 0.8793
ID Validation Loss: 0.4008
ID Test ACCURACY: 0.8846
ID Test Loss: 0.3936
OOD Validation ACCURACY: 0.8716
OOD Validation Loss: 0.4173
OOD Test ACCURACY: 0.7290
OOD Test Loss: 0.9761

[0m[1;37mINFO[0m: [1mChartInfo 0.8831 0.6190 0.8846 0.7290 0.8793 0.8716[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:16.503208
Plausibility completed in  0:02:00.000283
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6370, device='cuda:1')  +-  tensor(0.0116, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:17.538748
Plausibility completed in  0:02:11.861948
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.001 +- 0.028
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.001
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 14:07:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:07:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9771
Train Loss: 0.0788
ID Validation ACCURACY: 0.8796
ID Validation Loss: 0.4118
ID Test ACCURACY: 0.8799
ID Test Loss: 0.4099
OOD Validation ACCURACY: 0.8694
OOD Validation Loss: 0.4406
OOD Test ACCURACY: 0.7794
OOD Test Loss: 0.8262

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 151...
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.9966
Train Loss: 0.0192
ID Validation ACCURACY: 0.8714
ID Validation Loss: 0.4738
ID Test ACCURACY: 0.8740
ID Test Loss: 0.4719
OOD Validation ACCURACY: 0.8739
OOD Validation Loss: 0.4821
OOD Test ACCURACY: 0.8027
OOD Test Loss: 0.8199

[0m[1;37mINFO[0m: [1mChartInfo 0.8799 0.7794 0.8740 0.8027 0.8714 0.8739[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:16.443524
Plausibility completed in  0:02:05.012322
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6370, device='cuda:1')  +-  tensor(0.0116, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:17.382742
Plausibility completed in  0:02:22.879039
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.001 +- 0.028
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.001
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 14:22:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:22:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 169...
[0m[1;37mINFO[0m: [1mCheckpoint 169: 
-----------------------------------
Train ACCURACY: 0.9992
Train Loss: 0.0075
ID Validation ACCURACY: 0.8839
ID Validation Loss: 0.4781
ID Test ACCURACY: 0.8827
ID Test Loss: 0.5041
OOD Validation ACCURACY: 0.8734
OOD Validation Loss: 0.5221
OOD Test ACCURACY: 0.7557
OOD Test Loss: 1.1829

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.9862
Train Loss: 0.0531
ID Validation ACCURACY: 0.8741
ID Validation Loss: 0.4244
ID Test ACCURACY: 0.8776
ID Test Loss: 0.4244
OOD Validation ACCURACY: 0.8810
OOD Validation Loss: 0.4194
OOD Test ACCURACY: 0.7921
OOD Test Loss: 0.8078

[0m[1;37mINFO[0m: [1mChartInfo 0.8827 0.7557 0.8776 0.7921 0.8741 0.8810[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:17.120181
Plausibility completed in  0:02:18.969684
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6370, device='cuda:1')  +-  tensor(0.0116, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:21.733708
Plausibility completed in  0:02:17.322056
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.001 +- 0.028
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.001
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 14:38:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:38:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ACCURACY: 0.9837
Train Loss: 0.0597
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.4132
ID Test ACCURACY: 0.8796
ID Test Loss: 0.4055
OOD Validation ACCURACY: 0.8721
OOD Validation Loss: 0.4230
OOD Test ACCURACY: 0.7870
OOD Test Loss: 0.8251

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9769
Train Loss: 0.0782
ID Validation ACCURACY: 0.8811
ID Validation Loss: 0.4010
ID Test ACCURACY: 0.8799
ID Test Loss: 0.4049
OOD Validation ACCURACY: 0.8813
OOD Validation Loss: 0.4007
OOD Test ACCURACY: 0.7771
OOD Test Loss: 0.8287

[0m[1;37mINFO[0m: [1mChartInfo 0.8796 0.7870 0.8799 0.7771 0.8811 0.8813[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:17.167086
Plausibility completed in  0:01:54.907895
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6370, device='cuda:1')  +-  tensor(0.0116, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:15.215068
Plausibility completed in  0:02:04.529969
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.001 +- 0.028
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.001
Num considered samples: 7000

\FINISHED GOODCMNIST - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.30034459 0.60039657] +- [0. 0.] (mean across ratios: 0.45 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.6370348  0.99999579] +- [1.30728627e-06 7.15255737e-08] (mean across ratios: 0.82 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999958 0.99999958] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.9992342  0.99954396] +- [1.93214687e-06 0.00000000e+00] (mean across ratios: 1.00 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1. 1.] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[9.97897303e-01 8.18645523e-04] +- [5.25232937e-06 0.00000000e+00] (mean across ratios: 0.50 +- 0.00)

Overall time of execution:  1:21:06.899910
DONE LECI GOODCMNIST/color 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 14:53:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:33 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:33 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:33 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 02:53:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:53:33 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 02:53:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.3520
Train Loss: 4.1012
ID Validation ACCURACY: 0.3500
ID Validation Loss: 4.1593
ID Test ACCURACY: 0.3524
ID Test Loss: 4.1588
OOD Validation ACCURACY: 0.3167
OOD Validation Loss: 6.5550
OOD Test ACCURACY: 0.1637
OOD Test Loss: 33.3198

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.3520
Train Loss: 4.1012
ID Validation ACCURACY: 0.3500
ID Validation Loss: 4.1593
ID Test ACCURACY: 0.3524
ID Test Loss: 4.1588
OOD Validation ACCURACY: 0.3167
OOD Validation Loss: 6.5550
OOD Test ACCURACY: 0.1637
OOD Test Loss: 33.3198

[0m[1;37mINFO[0m: [1mChartInfo 0.3524 0.1637 0.3524 0.1637 0.3500 0.3167[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.484053
Plausibility completed in  0:02:08.907669
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5842, device='cuda:1')  +-  tensor(0.0292, device='cuda:1') (0.017)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.664 +- 0.183
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.844 +- 0.084
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.087516
Plausibility completed in  0:02:06.550649
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8694, device='cuda:1')  +-  tensor(0.0414, device='cuda:1') (0.013)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.307 +- 0.210
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.864 +- 0.059
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 15:12:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 03:12:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.4144
Train Loss: 2.4823
ID Validation ACCURACY: 0.4157
ID Validation Loss: 2.5162
ID Test ACCURACY: 0.4114
ID Test Loss: 2.4803
OOD Validation ACCURACY: 0.3104
OOD Validation Loss: 6.7585
OOD Test ACCURACY: 0.1446
OOD Test Loss: 41.0285

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.2914
Train Loss: 3.5159
ID Validation ACCURACY: 0.2877
ID Validation Loss: 3.5219
ID Test ACCURACY: 0.2904
ID Test Loss: 3.4864
OOD Validation ACCURACY: 0.3116
OOD Validation Loss: 9.4187
OOD Test ACCURACY: 0.1699
OOD Test Loss: 50.5791

[0m[1;37mINFO[0m: [1mChartInfo 0.4114 0.1446 0.2904 0.1699 0.2877 0.3116[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:14.846452
Plausibility completed in  0:02:07.560674
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5867, device='cuda:1')  +-  tensor(0.0302, device='cuda:1') (0.019)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.644 +- 0.171
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.832 +- 0.080
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.095296
Plausibility completed in  0:02:07.918389
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8438, device='cuda:1')  +-  tensor(0.0439, device='cuda:1') (0.015)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.297 +- 0.179
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.850 +- 0.054
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 15:29:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 03:29:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.3567
Train Loss: 3.2947
ID Validation ACCURACY: 0.3594
ID Validation Loss: 3.2787
ID Test ACCURACY: 0.3510
ID Test Loss: 3.2852
OOD Validation ACCURACY: 0.3019
OOD Validation Loss: 3.8731
OOD Test ACCURACY: 0.1820
OOD Test Loss: 4.9479

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.3426
Train Loss: 2.6924
ID Validation ACCURACY: 0.3353
ID Validation Loss: 2.7255
ID Test ACCURACY: 0.3387
ID Test Loss: 2.7041
OOD Validation ACCURACY: 0.3136
OOD Validation Loss: 2.9546
OOD Test ACCURACY: 0.1916
OOD Test Loss: 4.1809

[0m[1;37mINFO[0m: [1mChartInfo 0.3510 0.1820 0.3387 0.1916 0.3353 0.3136[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.768414
Plausibility completed in  0:02:06.724085
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5892, device='cuda:1')  +-  tensor(0.0342, device='cuda:1') (0.021)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.611 +- 0.175
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.815 +- 0.082
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.839728
Plausibility completed in  0:02:10.138045
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8277, device='cuda:1')  +-  tensor(0.0452, device='cuda:1') (0.019)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.288 +- 0.187
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.831 +- 0.057
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 15:44:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 03:44:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.3909
Train Loss: 2.8134
ID Validation ACCURACY: 0.4021
ID Validation Loss: 2.7741
ID Test ACCURACY: 0.3860
ID Test Loss: 2.8356
OOD Validation ACCURACY: 0.3126
OOD Validation Loss: 4.1696
OOD Test ACCURACY: 0.2140
OOD Test Loss: 12.2054

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.3350
Train Loss: 4.2162
ID Validation ACCURACY: 0.3359
ID Validation Loss: 4.3002
ID Test ACCURACY: 0.3386
ID Test Loss: 4.2674
OOD Validation ACCURACY: 0.3293
OOD Validation Loss: 8.2922
OOD Test ACCURACY: 0.1864
OOD Test Loss: 53.4631

[0m[1;37mINFO[0m: [1mChartInfo 0.3860 0.2140 0.3386 0.1864 0.3359 0.3293[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.564927
Plausibility completed in  0:02:06.607676
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5767, device='cuda:1')  +-  tensor(0.0294, device='cuda:1') (0.017)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.636 +- 0.176
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.830 +- 0.081
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.570714
Plausibility completed in  0:02:05.880338
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8446, device='cuda:1')  +-  tensor(0.0470, device='cuda:1') (0.014)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.284 +- 0.208
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.851 +- 0.061
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 16:00:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 04:00:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 190...
[0m[1;37mINFO[0m: [1mCheckpoint 190: 
-----------------------------------
Train ACCURACY: 0.3832
Train Loss: 3.2781
ID Validation ACCURACY: 0.3854
ID Validation Loss: 3.3077
ID Test ACCURACY: 0.3756
ID Test Loss: 3.3515
OOD Validation ACCURACY: 0.2441
OOD Validation Loss: 6.2321
OOD Test ACCURACY: 0.1736
OOD Test Loss: 8.2136

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ACCURACY: 0.3804
Train Loss: 3.3525
ID Validation ACCURACY: 0.3771
ID Validation Loss: 3.3880
ID Test ACCURACY: 0.3827
ID Test Loss: 3.3628
OOD Validation ACCURACY: 0.3297
OOD Validation Loss: 4.5238
OOD Test ACCURACY: 0.2149
OOD Test Loss: 6.5520

[0m[1;37mINFO[0m: [1mChartInfo 0.3756 0.1736 0.3827 0.2149 0.3771 0.3297[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.073382
Plausibility completed in  0:02:08.163829
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5699, device='cuda:1')  +-  tensor(0.0282, device='cuda:1') (0.016)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.627 +- 0.183
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.827 +- 0.084
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.176491
Plausibility completed in  0:02:05.890613
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8533, device='cuda:1')  +-  tensor(0.0506, device='cuda:1') (0.013)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.259 +- 0.224
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.853 +- 0.061
Num considered samples: 7000

\FINISHED GOODCMNIST - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.38008634 0.75870498] +- [0.01471974 0.02879425] (mean across ratios: 0.57 +- 0.02)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.58133705 0.84774599] +- [0.00707509 0.01361258] (mean across ratios: 0.71 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999945 0.99999949] +- [1.70264922e-07 1.22733475e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.82967511 0.84979597] +- [0.00934642 0.01071075] (mean across ratios: 0.84 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999975 0.99999971] +- [3.33786011e-07 3.97880537e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.63638674 0.28694962] +- [0.0175782  0.01623482] (mean across ratios: 0.46 +- 0.01)

Overall time of execution:  1:21:08.092175
DONE GSAT GOODCMNIST/color 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 16:14:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:54 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:54 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:54 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 04:14:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.3520
Train Loss: 4.1012
ID Validation ACCURACY: 0.3500
ID Validation Loss: 4.1593
ID Test ACCURACY: 0.3524
ID Test Loss: 4.1588
OOD Validation ACCURACY: 0.3167
OOD Validation Loss: 6.5550
OOD Test ACCURACY: 0.1637
OOD Test Loss: 33.3198

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.3520
Train Loss: 4.1012
ID Validation ACCURACY: 0.3500
ID Validation Loss: 4.1593
ID Test ACCURACY: 0.3524
ID Test Loss: 4.1588
OOD Validation ACCURACY: 0.3167
OOD Validation Loss: 6.5550
OOD Test ACCURACY: 0.1637
OOD Test Loss: 33.3198

[0m[1;37mINFO[0m: [1mChartInfo 0.3524 0.1637 0.3524 0.1637 0.3500 0.3167[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.558511
Plausibility completed in  0:02:01.957187
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6231, device='cuda:1')  +-  tensor(0.0310, device='cuda:1') (0.019)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.461 +- 0.234
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.779 +- 0.097
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.116660
Plausibility completed in  0:02:00.012413
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9433, device='cuda:1')  +-  tensor(0.0529, device='cuda:1') (0.006)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.031 +- 0.099
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.868 +- 0.041
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 16:33:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 04:33:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.4144
Train Loss: 2.4823
ID Validation ACCURACY: 0.4157
ID Validation Loss: 2.5162
ID Test ACCURACY: 0.4114
ID Test Loss: 2.4803
OOD Validation ACCURACY: 0.3104
OOD Validation Loss: 6.7585
OOD Test ACCURACY: 0.1446
OOD Test Loss: 41.0285

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.2914
Train Loss: 3.5159
ID Validation ACCURACY: 0.2877
ID Validation Loss: 3.5219
ID Test ACCURACY: 0.2904
ID Test Loss: 3.4864
OOD Validation ACCURACY: 0.3116
OOD Validation Loss: 9.4187
OOD Test ACCURACY: 0.1699
OOD Test Loss: 50.5791

[0m[1;37mINFO[0m: [1mChartInfo 0.4114 0.1446 0.2904 0.1699 0.2877 0.3116[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:16.119374
Plausibility completed in  0:02:00.743703
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6156, device='cuda:1')  +-  tensor(0.0300, device='cuda:1') (0.018)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.460 +- 0.204
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.778 +- 0.084
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.322487
Plausibility completed in  0:02:13.604140
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9048, device='cuda:1')  +-  tensor(0.0608, device='cuda:1') (0.008)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.025 +- 0.100
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.850 +- 0.042
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 16:47:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 04:47:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.3567
Train Loss: 3.2947
ID Validation ACCURACY: 0.3594
ID Validation Loss: 3.2787
ID Test ACCURACY: 0.3510
ID Test Loss: 3.2852
OOD Validation ACCURACY: 0.3019
OOD Validation Loss: 3.8731
OOD Test ACCURACY: 0.1820
OOD Test Loss: 4.9479

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.3426
Train Loss: 2.6924
ID Validation ACCURACY: 0.3353
ID Validation Loss: 2.7255
ID Test ACCURACY: 0.3387
ID Test Loss: 2.7041
OOD Validation ACCURACY: 0.3136
OOD Validation Loss: 2.9546
OOD Test ACCURACY: 0.1916
OOD Test Loss: 4.1809

[0m[1;37mINFO[0m: [1mChartInfo 0.3510 0.1820 0.3387 0.1916 0.3353 0.3136[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:14.560050
Plausibility completed in  0:01:59.712930
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6055, device='cuda:1')  +-  tensor(0.0361, device='cuda:1') (0.021)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.393 +- 0.211
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.745 +- 0.091
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.317915
Plausibility completed in  0:01:59.324745
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8805, device='cuda:1')  +-  tensor(0.0609, device='cuda:1') (0.012)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.059 +- 0.120
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.837 +- 0.043
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 17:01:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:43 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:43 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:43 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:43 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:44 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:44 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:44 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 05:01:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.3909
Train Loss: 2.8134
ID Validation ACCURACY: 0.4021
ID Validation Loss: 2.7741
ID Test ACCURACY: 0.3860
ID Test Loss: 2.8356
OOD Validation ACCURACY: 0.3126
OOD Validation Loss: 4.1696
OOD Test ACCURACY: 0.2140
OOD Test Loss: 12.2054

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.3350
Train Loss: 4.2162
ID Validation ACCURACY: 0.3359
ID Validation Loss: 4.3002
ID Test ACCURACY: 0.3386
ID Test Loss: 4.2674
OOD Validation ACCURACY: 0.3293
OOD Validation Loss: 8.2922
OOD Test ACCURACY: 0.1864
OOD Test Loss: 53.4631

[0m[1;37mINFO[0m: [1mChartInfo 0.3860 0.2140 0.3386 0.1864 0.3359 0.3293[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.227697
Plausibility completed in  0:02:04.394420
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6098, device='cuda:1')  +-  tensor(0.0300, device='cuda:1') (0.018)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.455 +- 0.219
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.777 +- 0.090
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:18.355469
Plausibility completed in  0:02:06.383960
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9149, device='cuda:1')  +-  tensor(0.0585, device='cuda:1') (0.007)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.028 +- 0.109
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.859 +- 0.049
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 17:16:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 05:16:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 190...
[0m[1;37mINFO[0m: [1mCheckpoint 190: 
-----------------------------------
Train ACCURACY: 0.3832
Train Loss: 3.2781
ID Validation ACCURACY: 0.3854
ID Validation Loss: 3.3077
ID Test ACCURACY: 0.3756
ID Test Loss: 3.3515
OOD Validation ACCURACY: 0.2441
OOD Validation Loss: 6.2321
OOD Test ACCURACY: 0.1736
OOD Test Loss: 8.2136

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ACCURACY: 0.3804
Train Loss: 3.3525
ID Validation ACCURACY: 0.3771
ID Validation Loss: 3.3880
ID Test ACCURACY: 0.3827
ID Test Loss: 3.3628
OOD Validation ACCURACY: 0.3297
OOD Validation Loss: 4.5238
OOD Test ACCURACY: 0.2149
OOD Test Loss: 6.5520

[0m[1;37mINFO[0m: [1mChartInfo 0.3756 0.1736 0.3827 0.2149 0.3771 0.3297[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.170105
Plausibility completed in  0:02:02.902572
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6028, device='cuda:1')  +-  tensor(0.0293, device='cuda:1') (0.018)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.425 +- 0.225
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.767 +- 0.092
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:15.063964
Plausibility completed in  0:01:59.693350
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9301, device='cuda:1')  +-  tensor(0.0591, device='cuda:1') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.002 +- 0.097
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.865 +- 0.049
Num considered samples: 7000

\FINISHED GOODCMNIST - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.38008625 0.75870503] +- [0.01471968 0.02879426] (mean across ratios: 0.57 +- 0.02)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.61136522 0.91471269] +- [0.00728487 0.02153333] (mean across ratios: 0.76 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999942 0.99999943] +- [2.04401352e-07 1.33812096e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.76923343 0.85575479] +- [0.01295484 0.01108156] (mean across ratios: 0.81 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999967 0.99999945] +- [4.08802705e-07 5.32319869e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.43908541 0.02822024] +- [0.02635386 0.01933098] (mean across ratios: 0.23 +- 0.02)

Overall time of execution:  1:15:23.038109
DONE GSAT GOODCMNIST/color 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 17:30:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 05:30:29 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:01 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:12 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:22 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:39 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:31:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ROC-AUC: 0.9169
Train Loss: 0.2213
ID Validation ROC-AUC: 0.8917
ID Validation Loss: 0.2544
ID Test ROC-AUC: 0.8970
ID Test Loss: 0.2524
OOD Validation ROC-AUC: 0.6382
OOD Validation Loss: 0.3929
OOD Test ROC-AUC: 0.6940
OOD Test Loss: 0.5070

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ROC-AUC: 0.8609
Train Loss: 0.2974
ID Validation ROC-AUC: 0.8471
ID Validation Loss: 0.3106
ID Test ROC-AUC: 0.8565
ID Test Loss: 0.3081
OOD Validation ROC-AUC: 0.6770
OOD Validation Loss: 0.3063
OOD Test ROC-AUC: 0.6903
OOD Test Loss: 0.5439

[0m[1;37mINFO[0m: [1mChartInfo 0.8970 0.6940 0.8565 0.6903 0.8471 0.6770[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 05:31:57 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:26.296020
Plausibility completed in  0:01:49.622953
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5773, device='cuda:1')  +-  tensor(0.0477, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 1.000 +- 0.000
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.746543
Plausibility completed in  0:01:48.516752
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9316, device='cuda:1')  +-  tensor(0.0576, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.807 +- 0.395
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 11300
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 17:38:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 05:38:06 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 05:38:36 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 05:38:49 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:04 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:26 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:39:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ROC-AUC: 0.9177
Train Loss: 0.2213
ID Validation ROC-AUC: 0.8918
ID Validation Loss: 0.2573
ID Test ROC-AUC: 0.8984
ID Test Loss: 0.2518
OOD Validation ROC-AUC: 0.6468
OOD Validation Loss: 0.3762
OOD Test ROC-AUC: 0.6919
OOD Test Loss: 0.5107

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ROC-AUC: 0.8920
Train Loss: 0.2449
ID Validation ROC-AUC: 0.8753
ID Validation Loss: 0.2636
ID Test ROC-AUC: 0.8793
ID Test Loss: 0.2613
OOD Validation ROC-AUC: 0.6705
OOD Validation Loss: 0.3458
OOD Test ROC-AUC: 0.7046
OOD Test Loss: 0.4816

[0m[1;37mINFO[0m: [1mChartInfo 0.8984 0.6919 0.8793 0.7046 0.8753 0.6705[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 05:39:50 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.880577
Plausibility completed in  0:01:47.662170
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5775, device='cuda:1')  +-  tensor(0.0483, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 1.000 +- 0.013
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.604343
Plausibility completed in  0:01:48.962252
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9319, device='cuda:1')  +-  tensor(0.0545, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.807 +- 0.394
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 11305
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 17:45:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 05:45:55 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 05:46:27 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 05:46:39 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 05:46:50 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:09 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:47:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ROC-AUC: 0.9167
Train Loss: 0.2199
ID Validation ROC-AUC: 0.8927
ID Validation Loss: 0.2531
ID Test ROC-AUC: 0.8965
ID Test Loss: 0.2508
OOD Validation ROC-AUC: 0.6401
OOD Validation Loss: 0.3915
OOD Test ROC-AUC: 0.6865
OOD Test Loss: 0.5100

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 36...
[0m[1;37mINFO[0m: [1mCheckpoint 36: 
-----------------------------------
Train ROC-AUC: 0.8702
Train Loss: 0.2826
ID Validation ROC-AUC: 0.8547
ID Validation Loss: 0.2953
ID Test ROC-AUC: 0.8658
ID Test Loss: 0.2920
OOD Validation ROC-AUC: 0.6717
OOD Validation Loss: 0.3020
OOD Test ROC-AUC: 0.6881
OOD Test Loss: 0.5174

[0m[1;37mINFO[0m: [1mChartInfo 0.8965 0.6865 0.8658 0.6881 0.8547 0.6717[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 05:47:26 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:27.980512
Plausibility completed in  0:01:54.345686
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.0487, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 1.000 +- 0.013
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:25.864679
Plausibility completed in  0:01:53.466901
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9321, device='cuda:1')  +-  tensor(0.0532, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.807 +- 0.395
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 11307
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 17:53:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:57 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:29 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:40 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:53 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:12 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ROC-AUC: 0.9170
Train Loss: 0.2226
ID Validation ROC-AUC: 0.8917
ID Validation Loss: 0.2557
ID Test ROC-AUC: 0.8960
ID Test Loss: 0.2545
OOD Validation ROC-AUC: 0.6425
OOD Validation Loss: 0.4071
OOD Test ROC-AUC: 0.6986
OOD Test Loss: 0.5143

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 34...
[0m[1;37mINFO[0m: [1mCheckpoint 34: 
-----------------------------------
Train ROC-AUC: 0.8702
Train Loss: 0.2691
ID Validation ROC-AUC: 0.8562
ID Validation Loss: 0.2805
ID Test ROC-AUC: 0.8672
ID Test Loss: 0.2773
OOD Validation ROC-AUC: 0.6673
OOD Validation Loss: 0.3080
OOD Test ROC-AUC: 0.6889
OOD Test Loss: 0.4959

[0m[1;37mINFO[0m: [1mChartInfo 0.8960 0.6986 0.8672 0.6889 0.8562 0.6673[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 05:55:29 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.643662
Plausibility completed in  0:01:49.358768
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5773, device='cuda:1')  +-  tensor(0.0481, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 1.000 +- 0.016
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.722828
Plausibility completed in  0:01:47.443637
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9318, device='cuda:1')  +-  tensor(0.0551, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.805 +- 0.396
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 11304
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 18:01:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 06:02:10 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 06:02:20 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 06:02:31 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 06:02:47 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ROC-AUC: 0.9165
Train Loss: 0.2206
ID Validation ROC-AUC: 0.8913
ID Validation Loss: 0.2538
ID Test ROC-AUC: 0.8969
ID Test Loss: 0.2504
OOD Validation ROC-AUC: 0.6290
OOD Validation Loss: 0.3879
OOD Test ROC-AUC: 0.6928
OOD Test Loss: 0.5115

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 34...
[0m[1;37mINFO[0m: [1mCheckpoint 34: 
-----------------------------------
Train ROC-AUC: 0.8628
Train Loss: 0.2911
ID Validation ROC-AUC: 0.8493
ID Validation Loss: 0.3012
ID Test ROC-AUC: 0.8611
ID Test Loss: 0.2996
OOD Validation ROC-AUC: 0.6659
OOD Validation Loss: 0.3055
OOD Test ROC-AUC: 0.6840
OOD Test Loss: 0.5249

[0m[1;37mINFO[0m: [1mChartInfo 0.8969 0.6928 0.8611 0.6840 0.8493 0.6659[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 06:03:03 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:32.292559
Plausibility completed in  0:01:49.732380
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5772, device='cuda:1')  +-  tensor(0.0487, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 1.000 +- 0.016
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:25.366908
Plausibility completed in  0:01:52.354726
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9315, device='cuda:1')  +-  tensor(0.0561, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.813 +- 0.390
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 11302

\FINISHED LBAPcore - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.3069239  0.60682634] +- [0.0000000e+00 3.1337762e-06] (mean across ratios: 0.46 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.57742885 0.93175217] +- [0.00019807 0.00022286] (mean across ratios: 0.75 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999946 0.99999946] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.9999997  0.99999986] +- [0.00000000e+00 2.92001932e-08] (mean across ratios: 1.00 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1.         0.99999998] +- [0.00000000e+00 2.92001932e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.99982321 0.80772513] +- [9.68304339e-05 2.62038858e-03] (mean across ratios: 0.90 +- 0.00)

Overall time of execution:  0:39:49.311127
DONE LECI LBAPcore/assay 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 18:10:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 06:10:34 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:10 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:21 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:32 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:51 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ROC-AUC: 0.9169
Train Loss: 0.2213
ID Validation ROC-AUC: 0.8917
ID Validation Loss: 0.2544
ID Test ROC-AUC: 0.8970
ID Test Loss: 0.2524
OOD Validation ROC-AUC: 0.6382
OOD Validation Loss: 0.3929
OOD Test ROC-AUC: 0.6940
OOD Test Loss: 0.5070

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ROC-AUC: 0.8609
Train Loss: 0.2974
ID Validation ROC-AUC: 0.8471
ID Validation Loss: 0.3106
ID Test ROC-AUC: 0.8565
ID Test Loss: 0.3081
OOD Validation ROC-AUC: 0.6770
OOD Validation Loss: 0.3063
OOD Test ROC-AUC: 0.6903
OOD Test Loss: 0.5439

[0m[1;37mINFO[0m: [1mChartInfo 0.8970 0.6940 0.8565 0.6903 0.8471 0.6770[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 06:12:12 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:30.008386
Plausibility completed in  0:01:57.476518
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6725, device='cuda:1')  +-  tensor(0.0805, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.989 +- 0.104
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:26.180468
Plausibility completed in  0:01:51.356082
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9917, device='cuda:1')  +-  tensor(0.0422, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.116 +- 0.320
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 11300
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 18:18:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 06:18:43 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 06:19:13 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 06:19:25 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 06:19:35 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 06:19:52 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ROC-AUC: 0.9177
Train Loss: 0.2213
ID Validation ROC-AUC: 0.8918
ID Validation Loss: 0.2573
ID Test ROC-AUC: 0.8984
ID Test Loss: 0.2518
OOD Validation ROC-AUC: 0.6468
OOD Validation Loss: 0.3762
OOD Test ROC-AUC: 0.6919
OOD Test Loss: 0.5107

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ROC-AUC: 0.8920
Train Loss: 0.2449
ID Validation ROC-AUC: 0.8753
ID Validation Loss: 0.2636
ID Test ROC-AUC: 0.8793
ID Test Loss: 0.2613
OOD Validation ROC-AUC: 0.6705
OOD Validation Loss: 0.3458
OOD Test ROC-AUC: 0.7046
OOD Test Loss: 0.4816

[0m[1;37mINFO[0m: [1mChartInfo 0.8984 0.6919 0.8793 0.7046 0.8753 0.6705[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 06:20:09 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:26.685353
Plausibility completed in  0:01:51.563025
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6726, device='cuda:1')  +-  tensor(0.0806, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.990 +- 0.101
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:25.572826
Plausibility completed in  0:01:49.787769
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9920, device='cuda:1')  +-  tensor(0.0369, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.116 +- 0.320
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 11305
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 18:26:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 06:26:37 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 06:27:12 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 06:27:24 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 06:27:35 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 06:27:51 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ROC-AUC: 0.9167
Train Loss: 0.2199
ID Validation ROC-AUC: 0.8927
ID Validation Loss: 0.2531
ID Test ROC-AUC: 0.8965
ID Test Loss: 0.2508
OOD Validation ROC-AUC: 0.6401
OOD Validation Loss: 0.3915
OOD Test ROC-AUC: 0.6865
OOD Test Loss: 0.5100

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 36...
[0m[1;37mINFO[0m: [1mCheckpoint 36: 
-----------------------------------
Train ROC-AUC: 0.8702
Train Loss: 0.2826
ID Validation ROC-AUC: 0.8547
ID Validation Loss: 0.2953
ID Test ROC-AUC: 0.8658
ID Test Loss: 0.2920
OOD Validation ROC-AUC: 0.6717
OOD Validation Loss: 0.3020
OOD Test ROC-AUC: 0.6881
OOD Test Loss: 0.5174

[0m[1;37mINFO[0m: [1mChartInfo 0.8965 0.6865 0.8658 0.6881 0.8547 0.6717[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 06:28:07 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.404046
Plausibility completed in  0:02:07.511153
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6730, device='cuda:1')  +-  tensor(0.0813, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.990 +- 0.102
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.843177
Plausibility completed in  0:01:45.222410
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9921, device='cuda:1')  +-  tensor(0.0346, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.117 +- 0.321
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 11307
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 18:34:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 06:34:46 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 06:35:18 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 06:35:27 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 06:35:38 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 06:35:54 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:36:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ROC-AUC: 0.9170
Train Loss: 0.2226
ID Validation ROC-AUC: 0.8917
ID Validation Loss: 0.2557
ID Test ROC-AUC: 0.8960
ID Test Loss: 0.2545
OOD Validation ROC-AUC: 0.6425
OOD Validation Loss: 0.4071
OOD Test ROC-AUC: 0.6986
OOD Test Loss: 0.5143

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 34...
[0m[1;37mINFO[0m: [1mCheckpoint 34: 
-----------------------------------
Train ROC-AUC: 0.8702
Train Loss: 0.2691
ID Validation ROC-AUC: 0.8562
ID Validation Loss: 0.2805
ID Test ROC-AUC: 0.8672
ID Test Loss: 0.2773
OOD Validation ROC-AUC: 0.6673
OOD Validation Loss: 0.3080
OOD Test ROC-AUC: 0.6889
OOD Test Loss: 0.4959

[0m[1;37mINFO[0m: [1mChartInfo 0.8960 0.6986 0.8672 0.6889 0.8562 0.6673[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 06:36:10 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.209173
Plausibility completed in  0:01:44.679576
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6724, device='cuda:1')  +-  tensor(0.0804, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.991 +- 0.097
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.327082
Plausibility completed in  0:01:44.847568
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9919, device='cuda:1')  +-  tensor(0.0380, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.116 +- 0.321
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 11304
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 18:42:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 06:42:07 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 06:42:36 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 06:42:45 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 06:42:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:11 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:43:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ROC-AUC: 0.9165
Train Loss: 0.2206
ID Validation ROC-AUC: 0.8913
ID Validation Loss: 0.2538
ID Test ROC-AUC: 0.8969
ID Test Loss: 0.2504
OOD Validation ROC-AUC: 0.6290
OOD Validation Loss: 0.3879
OOD Test ROC-AUC: 0.6928
OOD Test Loss: 0.5115

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 34...
[0m[1;37mINFO[0m: [1mCheckpoint 34: 
-----------------------------------
Train ROC-AUC: 0.8628
Train Loss: 0.2911
ID Validation ROC-AUC: 0.8493
ID Validation Loss: 0.3012
ID Test ROC-AUC: 0.8611
ID Test Loss: 0.2996
OOD Validation ROC-AUC: 0.6659
OOD Validation Loss: 0.3055
OOD Test ROC-AUC: 0.6840
OOD Test Loss: 0.5249

[0m[1;37mINFO[0m: [1mChartInfo 0.8969 0.6928 0.8611 0.6840 0.8493 0.6659[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 06:43:26 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.948718
Plausibility completed in  0:01:45.116196
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6721, device='cuda:1')  +-  tensor(0.0805, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.989 +- 0.102
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.648180
Plausibility completed in  0:01:44.769156
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9918, device='cuda:1')  +-  tensor(0.0402, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.115 +- 0.319
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 11302

\FINISHED LBAPcore - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.3069239  0.60682634] +- [0.0000000e+00 3.1337762e-06] (mean across ratios: 0.46 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.67248733 0.99188913] +- [0.00028191 0.00014575] (mean across ratios: 0.83 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999946 0.99999946] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.9999997  0.99999986] +- [0.00000000e+00 2.92001932e-08] (mean across ratios: 1.00 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1.         0.99999998] +- [0.00000000e+00 2.92001932e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.98967648 0.1158922 ] +- [0.00047892 0.00058274] (mean across ratios: 0.55 +- 0.00)

Overall time of execution:  0:38:49.063923
DONE LECI LBAPcore/assay 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 18:49:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 06:49:37 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 06:50:08 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 06:50:18 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 06:50:29 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 06:50:45 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 06:51:00 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:51:00 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:51:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:51:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:51:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:51:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:51:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:51:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:51:00 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 06:51:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ROC-AUC: 0.9219
Train Loss: 0.2433
ID Validation ROC-AUC: 0.9005
ID Validation Loss: 0.2836
ID Test ROC-AUC: 0.9006
ID Test Loss: 0.2830
OOD Validation ROC-AUC: 0.6415
OOD Validation Loss: 0.5290
OOD Test ROC-AUC: 0.6998
OOD Test Loss: 0.6406

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 100...
[0m[1;37mINFO[0m: [1mCheckpoint 100: 
-----------------------------------
Train ROC-AUC: 0.8862
Train Loss: 0.2825
ID Validation ROC-AUC: 0.8721
ID Validation Loss: 0.3043
ID Test ROC-AUC: 0.8739
ID Test Loss: 0.3017
OOD Validation ROC-AUC: 0.6708
OOD Validation Loss: 0.4663
OOD Test ROC-AUC: 0.6892
OOD Test Loss: 0.5869

[0m[1;37mINFO[0m: [1mChartInfo 0.9006 0.6998 0.8739 0.6892 0.8721 0.6708[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 06:51:02 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:27.353451
Plausibility completed in  0:01:51.026304
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5741, device='cuda:1')  +-  tensor(0.0486, device='cuda:1') (0.005)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.407 +- 0.165
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.771 +- 0.072
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:25.652438
Plausibility completed in  0:02:03.702585
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9166, device='cuda:1')  +-  tensor(0.0648, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.019 +- 0.121
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.926 +- 0.057
Num considered samples: 11307
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 18:57:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 06:57:23 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 06:57:55 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 06:58:05 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 06:58:16 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 06:58:32 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 06:58:47 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:58:47 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:58:47 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 06:58:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:58:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:58:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:58:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:58:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 06:58:47 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 06:58:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ROC-AUC: 0.9224
Train Loss: 0.2417
ID Validation ROC-AUC: 0.9030
ID Validation Loss: 0.2771
ID Test ROC-AUC: 0.9024
ID Test Loss: 0.2775
OOD Validation ROC-AUC: 0.6469
OOD Validation Loss: 0.5210
OOD Test ROC-AUC: 0.6993
OOD Test Loss: 0.6134

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 101...
[0m[1;37mINFO[0m: [1mCheckpoint 101: 
-----------------------------------
Train ROC-AUC: 0.8995
Train Loss: 0.2912
ID Validation ROC-AUC: 0.8814
ID Validation Loss: 0.3229
ID Test ROC-AUC: 0.8856
ID Test Loss: 0.3231
OOD Validation ROC-AUC: 0.6688
OOD Validation Loss: 0.3630
OOD Test ROC-AUC: 0.6979
OOD Test Loss: 0.6124

[0m[1;37mINFO[0m: [1mChartInfo 0.9024 0.6993 0.8856 0.6979 0.8814 0.6688[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 06:58:48 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:26.493453
Plausibility completed in  0:01:50.431191
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5758, device='cuda:1')  +-  tensor(0.0490, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.421 +- 0.151
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.779 +- 0.065
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:26.028981
Plausibility completed in  0:01:49.930757
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9260, device='cuda:1')  +-  tensor(0.0576, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.030 +- 0.095
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.936 +- 0.047
Num considered samples: 11307
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:04:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 07:04:59 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 07:05:29 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 07:05:40 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 07:05:50 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 07:06:06 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 07:06:22 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:06:22 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:06:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:06:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:06:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:06:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:06:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:06:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:06:22 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 07:06:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 153...
[0m[1;37mINFO[0m: [1mCheckpoint 153: 
-----------------------------------
Train ROC-AUC: 0.9160
Train Loss: 0.2563
ID Validation ROC-AUC: 0.8983
ID Validation Loss: 0.2916
ID Test ROC-AUC: 0.8976
ID Test Loss: 0.2924
OOD Validation ROC-AUC: 0.6457
OOD Validation Loss: 0.5279
OOD Test ROC-AUC: 0.7031
OOD Test Loss: 0.6410

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ROC-AUC: 0.8843
Train Loss: 0.2917
ID Validation ROC-AUC: 0.8698
ID Validation Loss: 0.3179
ID Test ROC-AUC: 0.8731
ID Test Loss: 0.3116
OOD Validation ROC-AUC: 0.6741
OOD Validation Loss: 0.4275
OOD Test ROC-AUC: 0.6836
OOD Test Loss: 0.6310

[0m[1;37mINFO[0m: [1mChartInfo 0.8976 0.7031 0.8731 0.6836 0.8698 0.6741[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 07:06:22 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:26.550387
Plausibility completed in  0:01:50.426877
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5697, device='cuda:1')  +-  tensor(0.0518, device='cuda:1') (0.013)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.335 +- 0.195
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.735 +- 0.088
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:26.080600
Plausibility completed in  0:01:49.739835
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8811, device='cuda:1')  +-  tensor(0.0791, device='cuda:1') (0.007)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.038 +- 0.184
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.890 +- 0.071
Num considered samples: 11311
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:12:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 07:12:31 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 07:13:02 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 07:13:12 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 07:13:23 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 07:13:39 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 07:13:54 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:13:54 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:13:54 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:13:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:13:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:13:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:13:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:13:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:13:54 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 07:13:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ROC-AUC: 0.9203
Train Loss: 0.2616
ID Validation ROC-AUC: 0.8992
ID Validation Loss: 0.3023
ID Test ROC-AUC: 0.8991
ID Test Loss: 0.3012
OOD Validation ROC-AUC: 0.6438
OOD Validation Loss: 0.5717
OOD Test ROC-AUC: 0.7015
OOD Test Loss: 0.6695

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 19...
[0m[1;37mINFO[0m: [1mCheckpoint 19: 
-----------------------------------
Train ROC-AUC: 0.8698
Train Loss: 0.3086
ID Validation ROC-AUC: 0.8607
ID Validation Loss: 0.3199
ID Test ROC-AUC: 0.8667
ID Test Loss: 0.3140
OOD Validation ROC-AUC: 0.6746
OOD Validation Loss: 0.4525
OOD Test ROC-AUC: 0.6941
OOD Test Loss: 0.5667

[0m[1;37mINFO[0m: [1mChartInfo 0.8991 0.7015 0.8667 0.6941 0.8607 0.6746[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 07:13:55 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:26.761703
Plausibility completed in  0:01:51.621335
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5671, device='cuda:1')  +-  tensor(0.0507, device='cuda:1') (0.011)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.331 +- 0.200
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.733 +- 0.090
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:25.757137
Plausibility completed in  0:01:50.639121
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8826, device='cuda:1')  +-  tensor(0.0813, device='cuda:1') (0.006)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.029 +- 0.177
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.892 +- 0.072
Num considered samples: 11312
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:20:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:08 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:39 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 07:20:49 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:00 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:16 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:32 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:32 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:21:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:21:32 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 07:21:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 162...
[0m[1;37mINFO[0m: [1mCheckpoint 162: 
-----------------------------------
Train ROC-AUC: 0.9212
Train Loss: 0.2580
ID Validation ROC-AUC: 0.9021
ID Validation Loss: 0.2945
ID Test ROC-AUC: 0.9029
ID Test Loss: 0.2921
OOD Validation ROC-AUC: 0.6499
OOD Validation Loss: 0.5617
OOD Test ROC-AUC: 0.7014
OOD Test Loss: 0.6597

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ROC-AUC: 0.8981
Train Loss: 0.2656
ID Validation ROC-AUC: 0.8784
ID Validation Loss: 0.3013
ID Test ROC-AUC: 0.8854
ID Test Loss: 0.2911
OOD Validation ROC-AUC: 0.6706
OOD Validation Loss: 0.3957
OOD Test ROC-AUC: 0.6942
OOD Test Loss: 0.5938

[0m[1;37mINFO[0m: [1mChartInfo 0.9029 0.7014 0.8854 0.6942 0.8784 0.6706[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 07:21:32 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:27.260806
Plausibility completed in  0:01:51.348228
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5762, device='cuda:1')  +-  tensor(0.0494, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.428 +- 0.147
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.782 +- 0.063
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:26.064980
Plausibility completed in  0:01:48.600806
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9268, device='cuda:1')  +-  tensor(0.0606, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.030 +- 0.089
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.937 +- 0.048
Num considered samples: 11302

\FINISHED LBAPcore - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.32286626 0.63762313] +- [0.01274958 0.02526389] (mean across ratios: 0.48 +- 0.01)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.57260363 0.90660954] +- [0.00357255 0.02054481] (mean across ratios: 0.74 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999946 0.99999948] +- [0.00000000e+00 2.38418579e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.76027838 0.91624577] +- [0.02171083 0.02113655] (mean across ratios: 0.84 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1.         0.99999998] +- [0.00000000e+00 2.92001932e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[ 0.38426151 -0.00246127] +- [0.04237968 0.02965487] (mean across ratios: 0.19 +- 0.03)

Overall time of execution:  0:38:11.206551
DONE GSAT LBAPcore/assay 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:28:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 07:28:06 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 07:28:36 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 07:28:46 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 07:28:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 07:29:11 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 07:29:26 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:29:26 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:29:26 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:29:26 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:29:26 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:29:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:29:26 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:29:26 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 07:29:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ROC-AUC: 0.9219
Train Loss: 0.2433
ID Validation ROC-AUC: 0.9005
ID Validation Loss: 0.2836
ID Test ROC-AUC: 0.9006
ID Test Loss: 0.2830
OOD Validation ROC-AUC: 0.6415
OOD Validation Loss: 0.5290
OOD Test ROC-AUC: 0.6998
OOD Test Loss: 0.6406

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 100...
[0m[1;37mINFO[0m: [1mCheckpoint 100: 
-----------------------------------
Train ROC-AUC: 0.8862
Train Loss: 0.2825
ID Validation ROC-AUC: 0.8721
ID Validation Loss: 0.3043
ID Test ROC-AUC: 0.8739
ID Test Loss: 0.3017
OOD Validation ROC-AUC: 0.6708
OOD Validation Loss: 0.4663
OOD Test ROC-AUC: 0.6892
OOD Test Loss: 0.5869

[0m[1;37mINFO[0m: [1mChartInfo 0.9006 0.6998 0.8739 0.6892 0.8721 0.6708[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 07:29:27 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.348258
Plausibility completed in  0:01:44.759111
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6677, device='cuda:1')  +-  tensor(0.0797, device='cuda:1') (0.005)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.269 +- 0.210
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.792 +- 0.072
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:22.755841
Plausibility completed in  0:01:44.284006
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9854, device='cuda:1')  +-  tensor(0.0466, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.000 +- 0.058
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.979 +- 0.043
Num considered samples: 11307
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:35:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 07:35:02 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 07:35:32 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 07:35:42 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 07:35:52 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 07:36:07 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 07:36:23 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:36:23 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:36:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:36:23 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 07:36:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ROC-AUC: 0.9224
Train Loss: 0.2417
ID Validation ROC-AUC: 0.9030
ID Validation Loss: 0.2771
ID Test ROC-AUC: 0.9024
ID Test Loss: 0.2775
OOD Validation ROC-AUC: 0.6469
OOD Validation Loss: 0.5210
OOD Test ROC-AUC: 0.6993
OOD Test Loss: 0.6134

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 101...
[0m[1;37mINFO[0m: [1mCheckpoint 101: 
-----------------------------------
Train ROC-AUC: 0.8995
Train Loss: 0.2912
ID Validation ROC-AUC: 0.8814
ID Validation Loss: 0.3229
ID Test ROC-AUC: 0.8856
ID Test Loss: 0.3231
OOD Validation ROC-AUC: 0.6688
OOD Validation Loss: 0.3630
OOD Test ROC-AUC: 0.6979
OOD Test Loss: 0.6124

[0m[1;37mINFO[0m: [1mChartInfo 0.9024 0.6993 0.8856 0.6979 0.8814 0.6688[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 07:36:23 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:23.498369
Plausibility completed in  0:01:44.923155
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6703, device='cuda:1')  +-  tensor(0.0808, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.275 +- 0.207
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.798 +- 0.068
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.153590
Plausibility completed in  0:01:44.919342
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9899, device='cuda:1')  +-  tensor(0.0399, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.003 +- 0.033
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.987 +- 0.033
Num considered samples: 11307
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:41:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 07:41:57 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 07:42:27 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 07:42:37 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 07:42:47 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 07:43:03 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 07:43:18 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:43:18 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:43:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:43:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:43:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:43:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:43:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:43:18 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 07:43:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 153...
[0m[1;37mINFO[0m: [1mCheckpoint 153: 
-----------------------------------
Train ROC-AUC: 0.9160
Train Loss: 0.2563
ID Validation ROC-AUC: 0.8983
ID Validation Loss: 0.2916
ID Test ROC-AUC: 0.8976
ID Test Loss: 0.2924
OOD Validation ROC-AUC: 0.6457
OOD Validation Loss: 0.5279
OOD Test ROC-AUC: 0.7031
OOD Test Loss: 0.6410

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ROC-AUC: 0.8843
Train Loss: 0.2917
ID Validation ROC-AUC: 0.8698
ID Validation Loss: 0.3179
ID Test ROC-AUC: 0.8731
ID Test Loss: 0.3116
OOD Validation ROC-AUC: 0.6741
OOD Validation Loss: 0.4275
OOD Test ROC-AUC: 0.6836
OOD Test Loss: 0.6310

[0m[1;37mINFO[0m: [1mChartInfo 0.8976 0.7031 0.8731 0.6836 0.8698 0.6741[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 07:43:18 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:23.876410
Plausibility completed in  0:01:44.666627
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6600, device='cuda:1')  +-  tensor(0.0833, device='cuda:1') (0.014)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.201 +- 0.225
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.756 +- 0.087
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:22.842996
Plausibility completed in  0:01:43.876733
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9605, device='cuda:1')  +-  tensor(0.0655, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.015 +- 0.118
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.943 +- 0.063
Num considered samples: 11311
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:48:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 07:48:48 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 07:49:18 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 07:49:28 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 07:49:38 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 07:49:53 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 07:50:08 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:50:08 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:50:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:50:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:50:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:50:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 07:50:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ROC-AUC: 0.9203
Train Loss: 0.2616
ID Validation ROC-AUC: 0.8992
ID Validation Loss: 0.3023
ID Test ROC-AUC: 0.8991
ID Test Loss: 0.3012
OOD Validation ROC-AUC: 0.6438
OOD Validation Loss: 0.5717
OOD Test ROC-AUC: 0.7015
OOD Test Loss: 0.6695

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 19...
[0m[1;37mINFO[0m: [1mCheckpoint 19: 
-----------------------------------
Train ROC-AUC: 0.8698
Train Loss: 0.3086
ID Validation ROC-AUC: 0.8607
ID Validation Loss: 0.3199
ID Test ROC-AUC: 0.8667
ID Test Loss: 0.3140
OOD Validation ROC-AUC: 0.6746
OOD Validation Loss: 0.4525
OOD Test ROC-AUC: 0.6941
OOD Test Loss: 0.5667

[0m[1;37mINFO[0m: [1mChartInfo 0.8991 0.7015 0.8667 0.6941 0.8607 0.6746[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 07:50:08 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:23.937379
Plausibility completed in  0:01:44.598212
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6578, device='cuda:1')  +-  tensor(0.0809, device='cuda:1') (0.012)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.195 +- 0.229
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.752 +- 0.087
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:22.825599
Plausibility completed in  0:01:45.086472
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9636, device='cuda:1')  +-  tensor(0.0644, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.016 +- 0.117
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.946 +- 0.062
Num considered samples: 11312
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 19:55:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 07:55:44 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 07:56:13 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 07:56:23 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 07:56:33 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 07:56:49 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 07:57:04 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 07:57:04 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 07:57:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 07:57:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:57:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:57:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:57:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 07:57:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 07:57:04 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 07:57:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 162...
[0m[1;37mINFO[0m: [1mCheckpoint 162: 
-----------------------------------
Train ROC-AUC: 0.9212
Train Loss: 0.2580
ID Validation ROC-AUC: 0.9021
ID Validation Loss: 0.2945
ID Test ROC-AUC: 0.9029
ID Test Loss: 0.2921
OOD Validation ROC-AUC: 0.6499
OOD Validation Loss: 0.5617
OOD Test ROC-AUC: 0.7014
OOD Test Loss: 0.6597

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ROC-AUC: 0.8981
Train Loss: 0.2656
ID Validation ROC-AUC: 0.8784
ID Validation Loss: 0.3013
ID Test ROC-AUC: 0.8854
ID Test Loss: 0.2911
OOD Validation ROC-AUC: 0.6706
OOD Validation Loss: 0.3957
OOD Test ROC-AUC: 0.6942
OOD Test Loss: 0.5938

[0m[1;37mINFO[0m: [1mChartInfo 0.9029 0.7014 0.8854 0.6942 0.8784 0.6706[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 07:57:04 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:23.891263
Plausibility completed in  0:01:44.422508
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6708, device='cuda:1')  +-  tensor(0.0813, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.283 +- 0.205
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.801 +- 0.067
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:22.789221
Plausibility completed in  0:01:43.603887
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9892, device='cuda:1')  +-  tensor(0.0452, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.002 +- 0.039
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.987 +- 0.034
Num considered samples: 11302

\FINISHED LBAPcore - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.32286626 0.63762313] +- [0.01274958 0.02526389] (mean across ratios: 0.48 +- 0.01)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.66531705 0.97771654] +- [0.00537202 0.01293797] (mean across ratios: 0.82 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999946 0.99999948] +- [0.00000000e+00 2.38418579e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.7795032  0.96835128] +- [0.02132104 0.01968233] (mean across ratios: 0.87 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1.         0.99999998] +- [0.00000000e+00 2.92001932e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.24463978 0.0053444 ] +- [0.03846654 0.0087291 ] (mean across ratios: 0.12 +- 0.02)

Overall time of execution:  0:34:34.646838
DONE GSAT LBAPcore/assay 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:02:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:02:59 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:02:59 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8721
ID Validation Loss: 0.5525
ID Test ACCURACY: 0.8738
ID Test Loss: 0.6177
OOD Validation ACCURACY: 0.8730
OOD Validation Loss: 0.7070
OOD Test ACCURACY: 0.8114
OOD Test Loss: 1.1250

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8698
ID Validation Loss: 0.5684
ID Test ACCURACY: 0.8749
ID Test Loss: 0.6247
OOD Validation ACCURACY: 0.8748
OOD Validation Loss: 0.7016
OOD Test ACCURACY: 0.8157
OOD Test Loss: 1.0466

[0m[1;37mINFO[0m: [1mChartInfo 0.8738 0.8114 0.8749 0.8157 0.8698 0.8748[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:03:02 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.461684
Plausibility completed in  0:00:16.165557
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.894 +- 0.308
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.516379
Plausibility completed in  0:00:12.735961
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.257 +- 0.437
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 1505
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:03:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:03:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ACCURACY: 0.9485
Train Loss: 0.0766
ID Validation ACCURACY: 0.8749
ID Validation Loss: 0.5049
ID Test ACCURACY: 0.8668
ID Test Loss: 0.5615
OOD Validation ACCURACY: 0.8653
OOD Validation Loss: 0.6072
OOD Test ACCURACY: 0.7872
OOD Test Loss: 0.9617

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0757
ID Validation ACCURACY: 0.8723
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8719
ID Test Loss: 0.6128
OOD Validation ACCURACY: 0.8778
OOD Validation Loss: 0.6058
OOD Test ACCURACY: 0.8173
OOD Test Loss: 0.8048

[0m[1;37mINFO[0m: [1mChartInfo 0.8668 0.7872 0.8719 0.8173 0.8723 0.8778[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:03:50 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.401608
Plausibility completed in  0:00:16.170756
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.894 +- 0.308
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.506770
Plausibility completed in  0:00:12.717937
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.257 +- 0.437
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 1505
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:04:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:04:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8755
ID Validation Loss: 0.5193
ID Test ACCURACY: 0.8710
ID Test Loss: 0.6143
OOD Validation ACCURACY: 0.8741
OOD Validation Loss: 0.6579
OOD Test ACCURACY: 0.7991
OOD Test Loss: 1.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0757
ID Validation ACCURACY: 0.8713
ID Validation Loss: 0.4845
ID Test ACCURACY: 0.8713
ID Test Loss: 0.5534
OOD Validation ACCURACY: 0.8785
OOD Validation Loss: 0.6028
OOD Test ACCURACY: 0.8218
OOD Test Loss: 0.7450

[0m[1;37mINFO[0m: [1mChartInfo 0.8710 0.7991 0.8713 0.8218 0.8713 0.8785[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:04:38 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.353420
Plausibility completed in  0:00:16.115790
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2271, device='cuda:1')  +-  tensor(0.3196, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.873 +- 0.340
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.991 +- 0.065
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.543581
Plausibility completed in  0:00:12.958764
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.4289, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.249 +- 0.434
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.996 +- 0.026
Num considered samples: 1531
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:05:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:05:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0765
ID Validation ACCURACY: 0.8764
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8727
ID Test Loss: 0.4723
OOD Validation ACCURACY: 0.8786
OOD Validation Loss: 0.5089
OOD Test ACCURACY: 0.8355
OOD Test Loss: 0.5859

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0765
ID Validation ACCURACY: 0.8764
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8727
ID Test Loss: 0.4723
OOD Validation ACCURACY: 0.8786
OOD Validation Loss: 0.5089
OOD Test ACCURACY: 0.8355
OOD Test Loss: 0.5859

[0m[1;37mINFO[0m: [1mChartInfo 0.8727 0.8355 0.8727 0.8355 0.8764 0.8786[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:05:26 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.360367
Plausibility completed in  0:00:16.082924
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.894 +- 0.308
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.735486
Plausibility completed in  0:00:12.506532
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.257 +- 0.437
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 1505
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:06:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:06:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 106...
[0m[1;37mINFO[0m: [1mCheckpoint 106: 
-----------------------------------
Train ACCURACY: 0.9487
Train Loss: 0.0764
ID Validation ACCURACY: 0.8762
ID Validation Loss: 0.4746
ID Test ACCURACY: 0.8687
ID Test Loss: 0.5282
OOD Validation ACCURACY: 0.8716
OOD Validation Loss: 0.5888
OOD Test ACCURACY: 0.8079
OOD Test Loss: 0.8214

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0760
ID Validation ACCURACY: 0.8732
ID Validation Loss: 0.4817
ID Test ACCURACY: 0.8685
ID Test Loss: 0.5451
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.5826
OOD Test ACCURACY: 0.8277
OOD Test Loss: 0.6909

[0m[1;37mINFO[0m: [1mChartInfo 0.8687 0.8079 0.8685 0.8277 0.8732 0.8787[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:06:13 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.370231
Plausibility completed in  0:00:16.068985
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.894 +- 0.308
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.734751
Plausibility completed in  0:00:12.531884
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.257 +- 0.437
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 1505

\FINISHED GOODSST2 - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33894594 0.63161348] +- [0.00156053 0.00331864] (mean across ratios: 0.49 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.22729487 0.26810172] +- [0.00011985 0.00151765] (mean across ratios: 0.25 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999934 0.9999993 ] +- [0.00000000e+00 2.38418579e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.99824026 0.99921551] +- [0.00351782 0.00156755] (mean across ratios: 1.00 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1.         0.99999982] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.88977845 0.25541596] +- [0.00830564 0.0034537 ] (mean across ratios: 0.57 +- 0.00)

Overall time of execution:  0:04:02.095514
DONE LECI GOODSST2/length 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:07:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:07:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8721
ID Validation Loss: 0.5525
ID Test ACCURACY: 0.8738
ID Test Loss: 0.6177
OOD Validation ACCURACY: 0.8730
OOD Validation Loss: 0.7070
OOD Test ACCURACY: 0.8114
OOD Test Loss: 1.1250

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8698
ID Validation Loss: 0.5684
ID Test ACCURACY: 0.8749
ID Test Loss: 0.6247
OOD Validation ACCURACY: 0.8748
OOD Validation Loss: 0.7016
OOD Test ACCURACY: 0.8157
OOD Test Loss: 1.0466

[0m[1;37mINFO[0m: [1mChartInfo 0.8738 0.8114 0.8749 0.8157 0.8698 0.8748[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:07:20 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.511847
Plausibility completed in  0:00:16.470818
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.894 +- 0.308
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.793518
Plausibility completed in  0:00:12.765756
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.257 +- 0.437
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 1505
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:08:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ACCURACY: 0.9485
Train Loss: 0.0766
ID Validation ACCURACY: 0.8749
ID Validation Loss: 0.5049
ID Test ACCURACY: 0.8668
ID Test Loss: 0.5615
OOD Validation ACCURACY: 0.8653
OOD Validation Loss: 0.6072
OOD Test ACCURACY: 0.7872
OOD Test Loss: 0.9617

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0757
ID Validation ACCURACY: 0.8723
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8719
ID Test Loss: 0.6128
OOD Validation ACCURACY: 0.8778
OOD Validation Loss: 0.6058
OOD Test ACCURACY: 0.8173
OOD Test Loss: 0.8048

[0m[1;37mINFO[0m: [1mChartInfo 0.8668 0.7872 0.8719 0.8173 0.8723 0.8778[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:08:08 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.413926
Plausibility completed in  0:00:16.514028
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.894 +- 0.308
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.768058
Plausibility completed in  0:00:12.809043
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.257 +- 0.437
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 1505
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:08:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8755
ID Validation Loss: 0.5193
ID Test ACCURACY: 0.8710
ID Test Loss: 0.6143
OOD Validation ACCURACY: 0.8741
OOD Validation Loss: 0.6579
OOD Test ACCURACY: 0.7991
OOD Test Loss: 1.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0757
ID Validation ACCURACY: 0.8713
ID Validation Loss: 0.4845
ID Test ACCURACY: 0.8713
ID Test Loss: 0.5534
OOD Validation ACCURACY: 0.8785
OOD Validation Loss: 0.6028
OOD Test ACCURACY: 0.8218
OOD Test Loss: 0.7450

[0m[1;37mINFO[0m: [1mChartInfo 0.8710 0.7991 0.8713 0.8218 0.8713 0.8785[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:08:55 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.392720
Plausibility completed in  0:00:16.440120
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2271, device='cuda:1')  +-  tensor(0.3196, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.873 +- 0.340
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.991 +- 0.065
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.802093
Plausibility completed in  0:00:12.959561
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.4289, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.249 +- 0.434
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.996 +- 0.026
Num considered samples: 1531
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:09:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0765
ID Validation ACCURACY: 0.8764
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8727
ID Test Loss: 0.4723
OOD Validation ACCURACY: 0.8786
OOD Validation Loss: 0.5089
OOD Test ACCURACY: 0.8355
OOD Test Loss: 0.5859

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0765
ID Validation ACCURACY: 0.8764
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8727
ID Test Loss: 0.4723
OOD Validation ACCURACY: 0.8786
OOD Validation Loss: 0.5089
OOD Test ACCURACY: 0.8355
OOD Test Loss: 0.5859

[0m[1;37mINFO[0m: [1mChartInfo 0.8727 0.8355 0.8727 0.8355 0.8764 0.8786[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:09:42 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.441238
Plausibility completed in  0:00:16.335792
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.894 +- 0.308
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.776392
Plausibility completed in  0:00:12.737040
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.257 +- 0.437
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 1505
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:10:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 106...
[0m[1;37mINFO[0m: [1mCheckpoint 106: 
-----------------------------------
Train ACCURACY: 0.9487
Train Loss: 0.0764
ID Validation ACCURACY: 0.8762
ID Validation Loss: 0.4746
ID Test ACCURACY: 0.8687
ID Test Loss: 0.5282
OOD Validation ACCURACY: 0.8716
OOD Validation Loss: 0.5888
OOD Test ACCURACY: 0.8079
OOD Test Loss: 0.8214

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0760
ID Validation ACCURACY: 0.8732
ID Validation Loss: 0.4817
ID Test ACCURACY: 0.8685
ID Test Loss: 0.5451
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.5826
OOD Test ACCURACY: 0.8277
OOD Test Loss: 0.6909

[0m[1;37mINFO[0m: [1mChartInfo 0.8687 0.8079 0.8685 0.8277 0.8732 0.8787[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:10:29 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.427244
Plausibility completed in  0:00:16.382526
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.894 +- 0.308
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 1.000 +- 0.000
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.544005
Plausibility completed in  0:00:12.783055
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.257 +- 0.437
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.000
Num considered samples: 1505

\FINISHED GOODSST2 - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33894594 0.63161348] +- [0.00156053 0.00331864] (mean across ratios: 0.49 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.22729487 0.26810172] +- [0.00011985 0.00151765] (mean across ratios: 0.25 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999934 0.9999993 ] +- [0.00000000e+00 2.38418579e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.99824026 0.99921551] +- [0.00351782 0.00156755] (mean across ratios: 1.00 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1.         0.99999982] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.88977845 0.25541596] +- [0.00830564 0.0034537 ] (mean across ratios: 0.57 +- 0.00)

Overall time of execution:  0:03:58.627274
DONE LECI GOODSST2/length 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:11:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:11:35 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:11:35 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:11:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:11:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:11:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:11:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:11:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:11:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:11:35 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 08:11:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.8946
Train Loss: 0.2294
ID Validation ACCURACY: 0.8451
ID Validation Loss: 0.4596
ID Test ACCURACY: 0.8359
ID Test Loss: 0.4928
OOD Validation ACCURACY: 0.8442
OOD Validation Loss: 0.7055
OOD Test ACCURACY: 0.7909
OOD Test Loss: 1.2081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 150...
[0m[1;37mINFO[0m: [1mCheckpoint 150: 
-----------------------------------
Train ACCURACY: 0.8613
Train Loss: 0.3029
ID Validation ACCURACY: 0.8268
ID Validation Loss: 0.4327
ID Test ACCURACY: 0.8231
ID Test Loss: 0.4451
OOD Validation ACCURACY: 0.8502
OOD Validation Loss: 0.5097
OOD Test ACCURACY: 0.8121
OOD Test Loss: 0.6943

[0m[1;37mINFO[0m: [1mChartInfo 0.8359 0.7909 0.8231 0.8121 0.8268 0.8502[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:11:36 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.485552
Plausibility completed in  0:00:16.398482
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.060 +- 0.415
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.720 +- 0.181
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.505051
Plausibility completed in  0:00:12.741864
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.031 +- 0.089
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.949 +- 0.095
Num considered samples: 1505
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:12:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:12:24 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:12:24 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:12:24 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:12:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:12:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:12:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:12:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:12:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:12:24 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 08:12:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.1959
ID Validation ACCURACY: 0.8449
ID Validation Loss: 0.5034
ID Test ACCURACY: 0.8380
ID Test Loss: 0.5283
OOD Validation ACCURACY: 0.8458
OOD Validation Loss: 0.8693
OOD Test ACCURACY: 0.8026
OOD Test Loss: 1.3095

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 35...
[0m[1;37mINFO[0m: [1mCheckpoint 35: 
-----------------------------------
Train ACCURACY: 0.8494
Train Loss: 0.3303
ID Validation ACCURACY: 0.8246
ID Validation Loss: 0.3965
ID Test ACCURACY: 0.8274
ID Test Loss: 0.4033
OOD Validation ACCURACY: 0.8494
OOD Validation Loss: 0.3884
OOD Test ACCURACY: 0.8215
OOD Test Loss: 0.4617

[0m[1;37mINFO[0m: [1mChartInfo 0.8380 0.8026 0.8274 0.8215 0.8246 0.8494[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:12:24 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.340435
Plausibility completed in  0:00:16.124730
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.061 +- 0.415
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.720 +- 0.181
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.673858
Plausibility completed in  0:00:12.684673
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.031 +- 0.089
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.949 +- 0.095
Num considered samples: 1505
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:13:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:11 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:11 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:11 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:13:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:11 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 08:13:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.1496
ID Validation ACCURACY: 0.8449
ID Validation Loss: 0.5913
ID Test ACCURACY: 0.8447
ID Test Loss: 0.5983
OOD Validation ACCURACY: 0.8434
OOD Validation Loss: 0.9268
OOD Test ACCURACY: 0.7956
OOD Test Loss: 1.1860

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 58...
[0m[1;37mINFO[0m: [1mCheckpoint 58: 
-----------------------------------
Train ACCURACY: 0.8865
Train Loss: 0.2502
ID Validation ACCURACY: 0.8387
ID Validation Loss: 0.4508
ID Test ACCURACY: 0.8359
ID Test Loss: 0.4682
OOD Validation ACCURACY: 0.8523
OOD Validation Loss: 0.5568
OOD Test ACCURACY: 0.8184
OOD Test Loss: 0.7482

[0m[1;37mINFO[0m: [1mChartInfo 0.8447 0.7956 0.8359 0.8184 0.8387 0.8523[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:13:11 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.343979
Plausibility completed in  0:00:16.278165
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.058 +- 0.415
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.719 +- 0.182
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.677560
Plausibility completed in  0:00:12.629682
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.031 +- 0.089
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.949 +- 0.095
Num considered samples: 1505
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:13:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:58 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:58 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:13:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:13:58 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 08:13:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.8962
Train Loss: 0.2153
ID Validation ACCURACY: 0.8427
ID Validation Loss: 0.4803
ID Test ACCURACY: 0.8374
ID Test Loss: 0.4933
OOD Validation ACCURACY: 0.8439
OOD Validation Loss: 0.7998
OOD Test ACCURACY: 0.7991
OOD Test Loss: 1.0971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 82...
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.8763
Train Loss: 0.2680
ID Validation ACCURACY: 0.8308
ID Validation Loss: 0.4440
ID Test ACCURACY: 0.8295
ID Test Loss: 0.4615
OOD Validation ACCURACY: 0.8541
OOD Validation Loss: 0.6125
OOD Test ACCURACY: 0.8222
OOD Test Loss: 0.7056

[0m[1;37mINFO[0m: [1mChartInfo 0.8374 0.7991 0.8295 0.8222 0.8308 0.8541[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:13:58 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.361819
Plausibility completed in  0:00:16.473933
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.061 +- 0.416
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.720 +- 0.182
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.583675
Plausibility completed in  0:00:12.677496
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.031 +- 0.089
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.949 +- 0.095
Num considered samples: 1505
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:14:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:14:45 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:14:45 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:14:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:14:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:14:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:14:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:14:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:14:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:14:45 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 08:14:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.9018
Train Loss: 0.2011
ID Validation ACCURACY: 0.8468
ID Validation Loss: 0.5144
ID Test ACCURACY: 0.8415
ID Test Loss: 0.5419
OOD Validation ACCURACY: 0.8424
OOD Validation Loss: 0.9462
OOD Test ACCURACY: 0.7918
OOD Test Loss: 1.4711

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.8617
Train Loss: 0.3062
ID Validation ACCURACY: 0.8221
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8200
ID Test Loss: 0.4485
OOD Validation ACCURACY: 0.8539
OOD Validation Loss: 0.4468
OOD Test ACCURACY: 0.8237
OOD Test Loss: 0.5712

[0m[1;37mINFO[0m: [1mChartInfo 0.8415 0.7918 0.8200 0.8237 0.8221 0.8539[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:14:45 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.373455
Plausibility completed in  0:00:16.324722
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.062 +- 0.415
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.720 +- 0.181
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.473594
Plausibility completed in  0:00:12.715180
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.031 +- 0.089
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.949 +- 0.095
Num considered samples: 1505

\FINISHED GOODSST2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33823808 0.63013103] +- [0.00014482 0.00035374] (mean across ratios: 0.48 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.22736292 0.26734419] +- [1.62482262e-05 2.58684158e-06] (mean across ratios: 0.25 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999934 0.99999928] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.71959469 0.94933487] +- [0.00030178 0.00010548] (mean across ratios: 0.83 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1.         0.99999982] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[ 0.0605126  -0.03095238] +- [0.00119141 0.        ] (mean across ratios: 0.01 +- 0.00)

Overall time of execution:  0:03:59.324344
DONE GSAT GOODSST2/length 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:15:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:15:52 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:15:52 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:15:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:15:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:15:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:15:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:15:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:15:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:15:52 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 08:15:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.8946
Train Loss: 0.2294
ID Validation ACCURACY: 0.8451
ID Validation Loss: 0.4596
ID Test ACCURACY: 0.8359
ID Test Loss: 0.4928
OOD Validation ACCURACY: 0.8442
OOD Validation Loss: 0.7055
OOD Test ACCURACY: 0.7909
OOD Test Loss: 1.2081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 150...
[0m[1;37mINFO[0m: [1mCheckpoint 150: 
-----------------------------------
Train ACCURACY: 0.8613
Train Loss: 0.3029
ID Validation ACCURACY: 0.8268
ID Validation Loss: 0.4327
ID Test ACCURACY: 0.8231
ID Test Loss: 0.4451
OOD Validation ACCURACY: 0.8502
OOD Validation Loss: 0.5097
OOD Test ACCURACY: 0.8121
OOD Test Loss: 0.6943

[0m[1;37mINFO[0m: [1mChartInfo 0.8359 0.7909 0.8231 0.8121 0.8268 0.8502[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:15:53 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.581951
Plausibility completed in  0:00:16.719754
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.060 +- 0.415
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.720 +- 0.181
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.583600
Plausibility completed in  0:00:12.993363
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.031 +- 0.089
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.949 +- 0.095
Num considered samples: 1505
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:16:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:16:41 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:16:41 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:16:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:16:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:16:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:16:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:16:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:16:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:16:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 08:16:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.1959
ID Validation ACCURACY: 0.8449
ID Validation Loss: 0.5034
ID Test ACCURACY: 0.8380
ID Test Loss: 0.5283
OOD Validation ACCURACY: 0.8458
OOD Validation Loss: 0.8693
OOD Test ACCURACY: 0.8026
OOD Test Loss: 1.3095

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 35...
[0m[1;37mINFO[0m: [1mCheckpoint 35: 
-----------------------------------
Train ACCURACY: 0.8494
Train Loss: 0.3303
ID Validation ACCURACY: 0.8246
ID Validation Loss: 0.3965
ID Test ACCURACY: 0.8274
ID Test Loss: 0.4033
OOD Validation ACCURACY: 0.8494
OOD Validation Loss: 0.3884
OOD Test ACCURACY: 0.8215
OOD Test Loss: 0.4617

[0m[1;37mINFO[0m: [1mChartInfo 0.8380 0.8026 0.8274 0.8215 0.8246 0.8494[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:16:41 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.417818
Plausibility completed in  0:00:16.533749
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.061 +- 0.415
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.720 +- 0.181
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.762700
Plausibility completed in  0:00:13.023002
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.031 +- 0.089
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.949 +- 0.095
Num considered samples: 1505
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:17:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:17:29 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:17:29 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:17:29 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:17:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:17:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:17:29 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 08:17:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.1496
ID Validation ACCURACY: 0.8449
ID Validation Loss: 0.5913
ID Test ACCURACY: 0.8447
ID Test Loss: 0.5983
OOD Validation ACCURACY: 0.8434
OOD Validation Loss: 0.9268
OOD Test ACCURACY: 0.7956
OOD Test Loss: 1.1860

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 58...
[0m[1;37mINFO[0m: [1mCheckpoint 58: 
-----------------------------------
Train ACCURACY: 0.8865
Train Loss: 0.2502
ID Validation ACCURACY: 0.8387
ID Validation Loss: 0.4508
ID Test ACCURACY: 0.8359
ID Test Loss: 0.4682
OOD Validation ACCURACY: 0.8523
OOD Validation Loss: 0.5568
OOD Test ACCURACY: 0.8184
OOD Test Loss: 0.7482

[0m[1;37mINFO[0m: [1mChartInfo 0.8447 0.7956 0.8359 0.8184 0.8387 0.8523[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:17:30 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.476404
Plausibility completed in  0:00:16.666414
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.058 +- 0.415
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.719 +- 0.182
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.765374
Plausibility completed in  0:00:12.981048
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.031 +- 0.089
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.949 +- 0.095
Num considered samples: 1505
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:18:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:18:17 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:18:17 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:18:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:18:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:18:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:18:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:18:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:18:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:18:17 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 08:18:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.8962
Train Loss: 0.2153
ID Validation ACCURACY: 0.8427
ID Validation Loss: 0.4803
ID Test ACCURACY: 0.8374
ID Test Loss: 0.4933
OOD Validation ACCURACY: 0.8439
OOD Validation Loss: 0.7998
OOD Test ACCURACY: 0.7991
OOD Test Loss: 1.0971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 82...
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.8763
Train Loss: 0.2680
ID Validation ACCURACY: 0.8308
ID Validation Loss: 0.4440
ID Test ACCURACY: 0.8295
ID Test Loss: 0.4615
OOD Validation ACCURACY: 0.8541
OOD Validation Loss: 0.6125
OOD Test ACCURACY: 0.8222
OOD Test Loss: 0.7056

[0m[1;37mINFO[0m: [1mChartInfo 0.8374 0.7991 0.8295 0.8222 0.8308 0.8541[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:18:17 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.464984
Plausibility completed in  0:00:16.637586
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.061 +- 0.416
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.720 +- 0.182
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.565101
Plausibility completed in  0:00:12.994216
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.031 +- 0.089
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.949 +- 0.095
Num considered samples: 1505
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 20:19:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 08:19:04 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 08:19:04 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 08:19:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/21/2024 08:19:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:19:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:19:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:19:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 08:19:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 08:19:04 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 09/21/2024 08:19:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.9018
Train Loss: 0.2011
ID Validation ACCURACY: 0.8468
ID Validation Loss: 0.5144
ID Test ACCURACY: 0.8415
ID Test Loss: 0.5419
OOD Validation ACCURACY: 0.8424
OOD Validation Loss: 0.9462
OOD Test ACCURACY: 0.7918
OOD Test Loss: 1.4711

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.8617
Train Loss: 0.3062
ID Validation ACCURACY: 0.8221
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8200
ID Test Loss: 0.4485
OOD Validation ACCURACY: 0.8539
OOD Validation Loss: 0.4468
OOD Test ACCURACY: 0.8237
OOD Test Loss: 0.5712

[0m[1;37mINFO[0m: [1mChartInfo 0.8415 0.7918 0.8200 0.8237 0.8221 0.8539[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 08:19:05 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.463428
Plausibility completed in  0:00:16.696099
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2274, device='cuda:1')  +-  tensor(0.3200, device='cuda:1') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.062 +- 0.415
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.720 +- 0.181
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:02.556618
Plausibility completed in  0:00:12.992815
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2673, device='cuda:1')  +-  tensor(0.4279, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = -0.031 +- 0.089
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.949 +- 0.095
Num considered samples: 1505

\FINISHED GOODSST2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33823808 0.63013103] +- [0.00014482 0.00035374] (mean across ratios: 0.48 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.22736292 0.26734419] +- [1.62482262e-05 2.58684158e-06] (mean across ratios: 0.25 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999934 0.99999928] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.71959469 0.94933487] +- [0.00030178 0.00010548] (mean across ratios: 0.83 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1.         0.99999982] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[ 0.0605126  -0.03095238] +- [0.00119141 0.        ] (mean across ratios: 0.01 +- 0.00)

Overall time of execution:  0:04:01.912530
DONE GSAT GOODSST2/length 0.10
stability_detector.sh: line 45: DONE all :): command not found
