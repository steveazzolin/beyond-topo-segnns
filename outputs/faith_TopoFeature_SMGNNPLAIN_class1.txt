nohup: ignoring input
I'm computing faithfulness :)
The PID of this script is: 1015655

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 17:01:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 05:01:37 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 05:01:37 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 05:01:37 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 05:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:01:37 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 05:01:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 94 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mChartInfo 0.9560 0.9560 0.9560 0.9560 0.9740 0.9740[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.731
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.794
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.768
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.699
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.648
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.623
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.456
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.333
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.262
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.241
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.782
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.852
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.891
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.909
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.903


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7305703971119133
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.877
SUFF_SIMPLE for r=0.05 class 1.0 = 0.841 +- 0.234 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.05 all KL = 0.835 +- 0.234 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.05 all L1 = 0.841 +- 0.193 (in-sample avg dev_std = 0.344)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7937942238267147
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.883
SUFF_SIMPLE for r=0.1 class 1.0 = 0.838 +- 0.236 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.1 all KL = 0.829 +- 0.236 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.1 all L1 = 0.838 +- 0.194 (in-sample avg dev_std = 0.348)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7677364620938628
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.866
SUFF_SIMPLE for r=0.2 class 1.0 = 0.832 +- 0.252 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.2 all KL = 0.819 +- 0.252 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.2 all L1 = 0.832 +- 0.206 (in-sample avg dev_std = 0.358)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6989314079422383
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.85
SUFF_SIMPLE for r=0.4 class 1.0 = 0.814 +- 0.266 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.4 all KL = 0.8 +- 0.266 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.4 all L1 = 0.814 +- 0.218 (in-sample avg dev_std = 0.354)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6479602888086643
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.785
SUFF_SIMPLE for r=0.8 class 1.0 = 0.764 +- 0.325 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.8 all KL = 0.75 +- 0.325 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.8 all L1 = 0.764 +- 0.271 (in-sample avg dev_std = 0.331)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.102
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6229849206349206
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.037
SUFF_SIMPLE for r=0.05 class 1.0 = 0.884 +- 0.117 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.05 all KL = 0.936 +- 0.117 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.05 all L1 = 0.884 +- 0.179 (in-sample avg dev_std = 0.149)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.102
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.45610277777777775
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.033
SUFF_SIMPLE for r=0.1 class 1.0 = 0.88 +- 0.127 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.1 all KL = 0.931 +- 0.127 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.1 all L1 = 0.88 +- 0.186 (in-sample avg dev_std = 0.146)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.102
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.33257182539682534
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.029
SUFF_SIMPLE for r=0.2 class 1.0 = 0.876 +- 0.133 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.2 all KL = 0.927 +- 0.133 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.2 all L1 = 0.876 +- 0.192 (in-sample avg dev_std = 0.139)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.102
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.26158333333333333
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.023
SUFF_SIMPLE for r=0.4 class 1.0 = 0.868 +- 0.151 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.4 all KL = 0.917 +- 0.151 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.4 all L1 = 0.868 +- 0.205 (in-sample avg dev_std = 0.135)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.102
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.24115833333333336
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.01
SUFF_SIMPLE for r=0.8 class 1.0 = 0.853 +- 0.188 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.8 all KL = 0.896 +- 0.188 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.8 all L1 = 0.853 +- 0.230 (in-sample avg dev_std = 0.098)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.936
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7820214748784441
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.896
SUFF_SIMPLE for r=0.05 class 1.0 = 0.868 +- 0.328 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.05 all KL = 0.821 +- 0.328 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.05 all L1 = 0.868 +- 0.236 (in-sample avg dev_std = 0.342)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.936
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8515162074554294
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.901
SUFF_SIMPLE for r=0.1 class 1.0 = 0.869 +- 0.326 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.1 all KL = 0.827 +- 0.326 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.1 all L1 = 0.869 +- 0.240 (in-sample avg dev_std = 0.326)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.936
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8911324959481361
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.919
SUFF_SIMPLE for r=0.2 class 1.0 = 0.884 +- 0.304 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.2 all KL = 0.848 +- 0.304 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.2 all L1 = 0.884 +- 0.230 (in-sample avg dev_std = 0.265)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.936
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9085854943273907
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.919
SUFF_SIMPLE for r=0.4 class 1.0 = 0.888 +- 0.291 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.4 all KL = 0.868 +- 0.291 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.4 all L1 = 0.888 +- 0.238 (in-sample avg dev_std = 0.246)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.936
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9033411669367909
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.882
SUFF_SIMPLE for r=0.8 class 1.0 = 0.899 +- 0.272 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.8 all KL = 0.897 +- 0.272 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.8 all L1 = 0.899 +- 0.238 (in-sample avg dev_std = 0.096)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7305703971119133
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.889
NEC for r=0.05 class 1.0 = 0.192 +- 0.193 (in-sample avg dev_std = 0.283)
NEC for r=0.05 all KL = 0.185 +- 0.193 (in-sample avg dev_std = 0.283)
NEC for r=0.05 all L1 = 0.192 +- 0.175 (in-sample avg dev_std = 0.283)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7937942238267147
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.921
NEC for r=0.1 class 1.0 = 0.142 +- 0.166 (in-sample avg dev_std = 0.267)
NEC for r=0.1 all KL = 0.134 +- 0.166 (in-sample avg dev_std = 0.267)
NEC for r=0.1 all L1 = 0.142 +- 0.153 (in-sample avg dev_std = 0.267)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7677364620938628
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.947
NEC for r=0.2 class 1.0 = 0.095 +- 0.128 (in-sample avg dev_std = 0.236)
NEC for r=0.2 all KL = 0.087 +- 0.128 (in-sample avg dev_std = 0.236)
NEC for r=0.2 all L1 = 0.095 +- 0.116 (in-sample avg dev_std = 0.236)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6989314079422383
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.955
NEC for r=0.4 class 1.0 = 0.068 +- 0.094 (in-sample avg dev_std = 0.208)
NEC for r=0.4 all KL = 0.06 +- 0.094 (in-sample avg dev_std = 0.208)
NEC for r=0.4 all L1 = 0.068 +- 0.090 (in-sample avg dev_std = 0.208)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6479602888086643
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.959
NEC for r=0.8 class 1.0 = 0.054 +- 0.097 (in-sample avg dev_std = 0.185)
NEC for r=0.8 all KL = 0.045 +- 0.097 (in-sample avg dev_std = 0.185)
NEC for r=0.8 all L1 = 0.054 +- 0.088 (in-sample avg dev_std = 0.185)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.102
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6229849206349206
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.042
NEC for r=0.05 class 1.0 = 0.127 +- 0.155 (in-sample avg dev_std = 0.184)
NEC for r=0.05 all KL = 0.082 +- 0.155 (in-sample avg dev_std = 0.184)
NEC for r=0.05 all L1 = 0.127 +- 0.198 (in-sample avg dev_std = 0.184)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.102
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.45610277777777775
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.075
NEC for r=0.1 class 1.0 = 0.098 +- 0.105 (in-sample avg dev_std = 0.189)
NEC for r=0.1 all KL = 0.054 +- 0.105 (in-sample avg dev_std = 0.189)
NEC for r=0.1 all L1 = 0.098 +- 0.152 (in-sample avg dev_std = 0.189)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.102
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.33257182539682534
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.086
NEC for r=0.2 class 1.0 = 0.071 +- 0.069 (in-sample avg dev_std = 0.166)
NEC for r=0.2 all KL = 0.034 +- 0.069 (in-sample avg dev_std = 0.166)
NEC for r=0.2 all L1 = 0.071 +- 0.113 (in-sample avg dev_std = 0.166)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.102
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.26158333333333333
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.083
NEC for r=0.4 class 1.0 = 0.056 +- 0.054 (in-sample avg dev_std = 0.150)
NEC for r=0.4 all KL = 0.024 +- 0.054 (in-sample avg dev_std = 0.150)
NEC for r=0.4 all L1 = 0.056 +- 0.092 (in-sample avg dev_std = 0.150)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.102
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.24115833333333336
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.073
NEC for r=0.8 class 1.0 = 0.063 +- 0.054 (in-sample avg dev_std = 0.134)
NEC for r=0.8 all KL = 0.024 +- 0.054 (in-sample avg dev_std = 0.134)
NEC for r=0.8 all L1 = 0.063 +- 0.103 (in-sample avg dev_std = 0.134)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.936
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7820214748784441
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.529
NEC for r=0.05 class 1.0 = 0.46 +- 0.354 (in-sample avg dev_std = 0.529)
NEC for r=0.05 all KL = 0.539 +- 0.354 (in-sample avg dev_std = 0.529)
NEC for r=0.05 all L1 = 0.46 +- 0.286 (in-sample avg dev_std = 0.529)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.936
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8515162074554294
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.684
NEC for r=0.1 class 1.0 = 0.329 +- 0.336 (in-sample avg dev_std = 0.504)
NEC for r=0.1 all KL = 0.401 +- 0.336 (in-sample avg dev_std = 0.504)
NEC for r=0.1 all L1 = 0.329 +- 0.262 (in-sample avg dev_std = 0.504)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.936
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8911324959481361
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.78
NEC for r=0.2 class 1.0 = 0.226 +- 0.312 (in-sample avg dev_std = 0.413)
NEC for r=0.2 all KL = 0.279 +- 0.312 (in-sample avg dev_std = 0.413)
NEC for r=0.2 all L1 = 0.226 +- 0.244 (in-sample avg dev_std = 0.413)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.936
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9085854943273907
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.862
NEC for r=0.4 class 1.0 = 0.146 +- 0.269 (in-sample avg dev_std = 0.355)
NEC for r=0.4 all KL = 0.185 +- 0.269 (in-sample avg dev_std = 0.355)
NEC for r=0.4 all L1 = 0.146 +- 0.201 (in-sample avg dev_std = 0.355)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.936
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9033411669367909
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.901
NEC for r=0.8 class 1.0 = 0.116 +- 0.264 (in-sample avg dev_std = 0.328)
NEC for r=0.8 all KL = 0.156 +- 0.264 (in-sample avg dev_std = 0.328)
NEC for r=0.8 all L1 = 0.116 +- 0.184 (in-sample avg dev_std = 0.328)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 17:07:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 05:07:22 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 05:07:22 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 05:07:22 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 05:07:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:07:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:07:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:07:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:07:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:07:22 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 05:07:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mChartInfo 0.9600 0.9600 0.9600 0.9600 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.677
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.747
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.754
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.733
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.714
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.538
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.413
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.337
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.304
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.298
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.774
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.829
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.865
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.887
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.898


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.989
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6774296028880867
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.821
SUFF_SIMPLE for r=0.05 class 1.0 = 0.768 +- 0.368 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.05 all KL = 0.628 +- 0.368 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.05 all L1 = 0.768 +- 0.239 (in-sample avg dev_std = 0.526)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.989
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7472924187725631
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.835
SUFF_SIMPLE for r=0.1 class 1.0 = 0.776 +- 0.360 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.1 all KL = 0.634 +- 0.360 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.1 all L1 = 0.776 +- 0.228 (in-sample avg dev_std = 0.516)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.989
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7538953068592057
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.828
SUFF_SIMPLE for r=0.2 class 1.0 = 0.779 +- 0.364 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.2 all KL = 0.634 +- 0.364 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.2 all L1 = 0.779 +- 0.233 (in-sample avg dev_std = 0.512)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7332851985559566
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.822
SUFF_SIMPLE for r=0.4 class 1.0 = 0.775 +- 0.368 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.4 all KL = 0.661 +- 0.368 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.4 all L1 = 0.775 +- 0.254 (in-sample avg dev_std = 0.485)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.989
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7143465703971118
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.799
SUFF_SIMPLE for r=0.8 class 1.0 = 0.765 +- 0.370 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.8 all KL = 0.684 +- 0.370 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.8 all L1 = 0.765 +- 0.289 (in-sample avg dev_std = 0.392)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.157
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5382329365079365
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.056
SUFF_SIMPLE for r=0.05 class 1.0 = 0.835 +- 0.258 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.05 all KL = 0.851 +- 0.258 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.05 all L1 = 0.835 +- 0.248 (in-sample avg dev_std = 0.245)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.157
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4132091269841271
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.055
SUFF_SIMPLE for r=0.1 class 1.0 = 0.835 +- 0.256 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.1 all KL = 0.851 +- 0.256 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.1 all L1 = 0.835 +- 0.247 (in-sample avg dev_std = 0.244)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.157
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.33721349206349205
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.054
SUFF_SIMPLE for r=0.2 class 1.0 = 0.832 +- 0.262 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.2 all KL = 0.847 +- 0.262 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.2 all L1 = 0.832 +- 0.250 (in-sample avg dev_std = 0.245)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.157
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3041480158730159
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.044
SUFF_SIMPLE for r=0.4 class 1.0 = 0.828 +- 0.271 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.4 all KL = 0.843 +- 0.271 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.4 all L1 = 0.828 +- 0.259 (in-sample avg dev_std = 0.229)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.157
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2983166666666667
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.026
SUFF_SIMPLE for r=0.8 class 1.0 = 0.821 +- 0.290 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.8 all KL = 0.836 +- 0.290 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.8 all L1 = 0.821 +- 0.275 (in-sample avg dev_std = 0.190)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7737374392220421
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.751
SUFF_SIMPLE for r=0.05 class 1.0 = 0.808 +- 0.424 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.05 all KL = 0.659 +- 0.424 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.05 all L1 = 0.808 +- 0.278 (in-sample avg dev_std = 0.448)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8294894651539708
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.758
SUFF_SIMPLE for r=0.1 class 1.0 = 0.823 +- 0.416 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.1 all KL = 0.696 +- 0.416 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.1 all L1 = 0.823 +- 0.278 (in-sample avg dev_std = 0.415)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8646859805510535
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.763
SUFF_SIMPLE for r=0.2 class 1.0 = 0.844 +- 0.396 (in-sample avg dev_std = 0.378)
SUFF_SIMPLE for r=0.2 all KL = 0.747 +- 0.396 (in-sample avg dev_std = 0.378)
SUFF_SIMPLE for r=0.2 all L1 = 0.844 +- 0.275 (in-sample avg dev_std = 0.378)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8868650729335494
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.759
SUFF_SIMPLE for r=0.4 class 1.0 = 0.848 +- 0.388 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.4 all KL = 0.773 +- 0.388 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.4 all L1 = 0.848 +- 0.284 (in-sample avg dev_std = 0.340)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.9
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8980008103727714
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.783
SUFF_SIMPLE for r=0.8 class 1.0 = 0.88 +- 0.339 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.8 all KL = 0.849 +- 0.339 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.8 all L1 = 0.88 +- 0.275 (in-sample avg dev_std = 0.193)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.989
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6774296028880867
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.418
NEC for r=0.05 class 1.0 = 0.599 +- 0.228 (in-sample avg dev_std = 0.511)
NEC for r=0.05 all KL = 0.856 +- 0.228 (in-sample avg dev_std = 0.511)
NEC for r=0.05 all L1 = 0.599 +- 0.235 (in-sample avg dev_std = 0.511)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.989
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7472924187725631
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.61
NEC for r=0.1 class 1.0 = 0.461 +- 0.265 (in-sample avg dev_std = 0.642)
NEC for r=0.1 all KL = 0.744 +- 0.265 (in-sample avg dev_std = 0.642)
NEC for r=0.1 all L1 = 0.461 +- 0.237 (in-sample avg dev_std = 0.642)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.989
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7538953068592057
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.748
NEC for r=0.2 class 1.0 = 0.332 +- 0.303 (in-sample avg dev_std = 0.641)
NEC for r=0.2 all KL = 0.59 +- 0.303 (in-sample avg dev_std = 0.641)
NEC for r=0.2 all L1 = 0.332 +- 0.213 (in-sample avg dev_std = 0.641)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7332851985559566
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.849
NEC for r=0.4 class 1.0 = 0.216 +- 0.336 (in-sample avg dev_std = 0.565)
NEC for r=0.4 all KL = 0.411 +- 0.336 (in-sample avg dev_std = 0.565)
NEC for r=0.4 all L1 = 0.216 +- 0.185 (in-sample avg dev_std = 0.565)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.989
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7143465703971118
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.9
NEC for r=0.8 class 1.0 = 0.142 +- 0.305 (in-sample avg dev_std = 0.455)
NEC for r=0.8 all KL = 0.275 +- 0.305 (in-sample avg dev_std = 0.455)
NEC for r=0.8 all L1 = 0.142 +- 0.155 (in-sample avg dev_std = 0.455)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.157
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5382329365079365
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.015
NEC for r=0.05 class 1.0 = 0.187 +- 0.302 (in-sample avg dev_std = 0.177)
NEC for r=0.05 all KL = 0.172 +- 0.302 (in-sample avg dev_std = 0.177)
NEC for r=0.05 all L1 = 0.187 +- 0.286 (in-sample avg dev_std = 0.177)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.157
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4132091269841271
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.044
NEC for r=0.1 class 1.0 = 0.175 +- 0.286 (in-sample avg dev_std = 0.269)
NEC for r=0.1 all KL = 0.164 +- 0.286 (in-sample avg dev_std = 0.269)
NEC for r=0.1 all L1 = 0.175 +- 0.264 (in-sample avg dev_std = 0.269)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.157
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.33721349206349205
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.069
NEC for r=0.2 class 1.0 = 0.157 +- 0.254 (in-sample avg dev_std = 0.296)
NEC for r=0.2 all KL = 0.144 +- 0.254 (in-sample avg dev_std = 0.296)
NEC for r=0.2 all L1 = 0.157 +- 0.235 (in-sample avg dev_std = 0.296)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.157
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3041480158730159
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.086
NEC for r=0.4 class 1.0 = 0.141 +- 0.220 (in-sample avg dev_std = 0.281)
NEC for r=0.4 all KL = 0.123 +- 0.220 (in-sample avg dev_std = 0.281)
NEC for r=0.4 all L1 = 0.141 +- 0.211 (in-sample avg dev_std = 0.281)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.157
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2983166666666667
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.091
NEC for r=0.8 class 1.0 = 0.131 +- 0.192 (in-sample avg dev_std = 0.257)
NEC for r=0.8 all KL = 0.106 +- 0.192 (in-sample avg dev_std = 0.257)
NEC for r=0.8 all L1 = 0.131 +- 0.197 (in-sample avg dev_std = 0.257)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7737374392220421
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.378
NEC for r=0.05 class 1.0 = 0.562 +- 0.307 (in-sample avg dev_std = 0.576)
NEC for r=0.05 all KL = 0.837 +- 0.307 (in-sample avg dev_std = 0.576)
NEC for r=0.05 all L1 = 0.562 +- 0.287 (in-sample avg dev_std = 0.576)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8294894651539708
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.492
NEC for r=0.1 class 1.0 = 0.46 +- 0.343 (in-sample avg dev_std = 0.579)
NEC for r=0.1 all KL = 0.754 +- 0.343 (in-sample avg dev_std = 0.579)
NEC for r=0.1 all L1 = 0.46 +- 0.298 (in-sample avg dev_std = 0.579)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8646859805510535
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.584
NEC for r=0.2 class 1.0 = 0.368 +- 0.382 (in-sample avg dev_std = 0.576)
NEC for r=0.2 all KL = 0.645 +- 0.382 (in-sample avg dev_std = 0.576)
NEC for r=0.2 all L1 = 0.368 +- 0.297 (in-sample avg dev_std = 0.576)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8868650729335494
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.687
NEC for r=0.4 class 1.0 = 0.268 +- 0.400 (in-sample avg dev_std = 0.544)
NEC for r=0.4 all KL = 0.509 +- 0.400 (in-sample avg dev_std = 0.544)
NEC for r=0.4 all L1 = 0.268 +- 0.272 (in-sample avg dev_std = 0.544)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8980008103727714
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.746
NEC for r=0.8 class 1.0 = 0.204 +- 0.392 (in-sample avg dev_std = 0.497)
NEC for r=0.8 all KL = 0.406 +- 0.392 (in-sample avg dev_std = 0.497)
NEC for r=0.8 all L1 = 0.204 +- 0.248 (in-sample avg dev_std = 0.497)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 17:13:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 05:13:01 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 05:13:01 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 05:13:01 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 05:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:13:01 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 05:13:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mChartInfo 0.9620 0.9620 0.9620 0.9620 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.726
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.794
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.794
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.768
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.745
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.535
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.391
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.307
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.268
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.261
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.777
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.837
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.877
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.897
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.904


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7260072202166065
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.837
SUFF_SIMPLE for r=0.05 class 1.0 = 0.795 +- 0.301 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.05 all KL = 0.719 +- 0.301 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.05 all L1 = 0.795 +- 0.216 (in-sample avg dev_std = 0.443)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7935162454873648
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.845
SUFF_SIMPLE for r=0.1 class 1.0 = 0.806 +- 0.311 (in-sample avg dev_std = 0.436)
SUFF_SIMPLE for r=0.1 all KL = 0.741 +- 0.311 (in-sample avg dev_std = 0.436)
SUFF_SIMPLE for r=0.1 all L1 = 0.806 +- 0.219 (in-sample avg dev_std = 0.436)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7935523465703971
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.86
SUFF_SIMPLE for r=0.2 class 1.0 = 0.832 +- 0.278 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.2 all KL = 0.782 +- 0.278 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.2 all L1 = 0.832 +- 0.208 (in-sample avg dev_std = 0.384)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7679638989169675
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.849
SUFF_SIMPLE for r=0.4 class 1.0 = 0.826 +- 0.297 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.4 all KL = 0.785 +- 0.297 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.4 all L1 = 0.826 +- 0.225 (in-sample avg dev_std = 0.379)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7447906137184116
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.804
SUFF_SIMPLE for r=0.8 class 1.0 = 0.794 +- 0.335 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.8 all KL = 0.758 +- 0.335 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.8 all L1 = 0.794 +- 0.269 (in-sample avg dev_std = 0.346)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.133
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5349789682539682
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.063
SUFF_SIMPLE for r=0.05 class 1.0 = 0.882 +- 0.208 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.05 all KL = 0.899 +- 0.208 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.05 all L1 = 0.882 +- 0.209 (in-sample avg dev_std = 0.231)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.133
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.39148373015873017
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.064
SUFF_SIMPLE for r=0.1 class 1.0 = 0.884 +- 0.202 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.1 all KL = 0.902 +- 0.202 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.1 all L1 = 0.884 +- 0.207 (in-sample avg dev_std = 0.221)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.133
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3066809523809524
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.06
SUFF_SIMPLE for r=0.2 class 1.0 = 0.882 +- 0.208 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.2 all KL = 0.899 +- 0.208 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.2 all L1 = 0.882 +- 0.211 (in-sample avg dev_std = 0.224)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.133
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2684484126984127
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.057
SUFF_SIMPLE for r=0.4 class 1.0 = 0.88 +- 0.210 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.4 all KL = 0.898 +- 0.210 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.4 all L1 = 0.88 +- 0.214 (in-sample avg dev_std = 0.216)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.133
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2607694444444444
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.037
SUFF_SIMPLE for r=0.8 class 1.0 = 0.867 +- 0.245 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.8 all KL = 0.881 +- 0.245 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.8 all L1 = 0.867 +- 0.239 (in-sample avg dev_std = 0.200)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.916
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7772366288492708
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.784
SUFF_SIMPLE for r=0.05 class 1.0 = 0.846 +- 0.363 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.05 all KL = 0.793 +- 0.363 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.05 all L1 = 0.846 +- 0.276 (in-sample avg dev_std = 0.330)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.916
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8372512155591573
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.795
SUFF_SIMPLE for r=0.1 class 1.0 = 0.859 +- 0.350 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.1 all KL = 0.816 +- 0.350 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.1 all L1 = 0.859 +- 0.271 (in-sample avg dev_std = 0.300)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.916
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8769432739059967
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.8
SUFF_SIMPLE for r=0.2 class 1.0 = 0.867 +- 0.339 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.2 all KL = 0.83 +- 0.339 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.2 all L1 = 0.867 +- 0.267 (in-sample avg dev_std = 0.268)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.916
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8974663695299838
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.806
SUFF_SIMPLE for r=0.4 class 1.0 = 0.87 +- 0.337 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.4 all KL = 0.834 +- 0.337 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.4 all L1 = 0.87 +- 0.266 (in-sample avg dev_std = 0.262)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.916
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9035705024311182
len(reference) = 2467
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.827
SUFF_SIMPLE for r=0.8 class 1.0 = 0.893 +- 0.300 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.8 all KL = 0.877 +- 0.300 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.8 all L1 = 0.893 +- 0.257 (in-sample avg dev_std = 0.085)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7260072202166065
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.508
NEC for r=0.05 class 1.0 = 0.527 +- 0.262 (in-sample avg dev_std = 0.488)
NEC for r=0.05 all KL = 0.722 +- 0.262 (in-sample avg dev_std = 0.488)
NEC for r=0.05 all L1 = 0.527 +- 0.226 (in-sample avg dev_std = 0.488)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7935162454873648
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.664
NEC for r=0.1 class 1.0 = 0.399 +- 0.296 (in-sample avg dev_std = 0.574)
NEC for r=0.1 all KL = 0.588 +- 0.296 (in-sample avg dev_std = 0.574)
NEC for r=0.1 all L1 = 0.399 +- 0.226 (in-sample avg dev_std = 0.574)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7935523465703971
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.775
NEC for r=0.2 class 1.0 = 0.284 +- 0.297 (in-sample avg dev_std = 0.540)
NEC for r=0.2 all KL = 0.444 +- 0.297 (in-sample avg dev_std = 0.540)
NEC for r=0.2 all L1 = 0.284 +- 0.206 (in-sample avg dev_std = 0.540)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7679638989169675
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.883
NEC for r=0.4 class 1.0 = 0.167 +- 0.245 (in-sample avg dev_std = 0.444)
NEC for r=0.4 all KL = 0.268 +- 0.245 (in-sample avg dev_std = 0.444)
NEC for r=0.4 all L1 = 0.167 +- 0.149 (in-sample avg dev_std = 0.444)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7447906137184116
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.908
NEC for r=0.8 class 1.0 = 0.127 +- 0.229 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all KL = 0.2 +- 0.229 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all L1 = 0.127 +- 0.136 (in-sample avg dev_std = 0.390)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.133
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5349789682539682
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.02
NEC for r=0.05 class 1.0 = 0.146 +- 0.277 (in-sample avg dev_std = 0.189)
NEC for r=0.05 all KL = 0.135 +- 0.277 (in-sample avg dev_std = 0.189)
NEC for r=0.05 all L1 = 0.146 +- 0.264 (in-sample avg dev_std = 0.189)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.133
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.39148373015873017
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.048
NEC for r=0.1 class 1.0 = 0.132 +- 0.249 (in-sample avg dev_std = 0.247)
NEC for r=0.1 all KL = 0.122 +- 0.249 (in-sample avg dev_std = 0.247)
NEC for r=0.1 all L1 = 0.132 +- 0.236 (in-sample avg dev_std = 0.247)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.133
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3066809523809524
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.071
NEC for r=0.2 class 1.0 = 0.113 +- 0.209 (in-sample avg dev_std = 0.261)
NEC for r=0.2 all KL = 0.101 +- 0.209 (in-sample avg dev_std = 0.261)
NEC for r=0.2 all L1 = 0.113 +- 0.202 (in-sample avg dev_std = 0.261)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.133
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2684484126984127
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.083
NEC for r=0.4 class 1.0 = 0.101 +- 0.182 (in-sample avg dev_std = 0.250)
NEC for r=0.4 all KL = 0.085 +- 0.182 (in-sample avg dev_std = 0.250)
NEC for r=0.4 all L1 = 0.101 +- 0.182 (in-sample avg dev_std = 0.250)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.133
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2607694444444444
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.089
NEC for r=0.8 class 1.0 = 0.089 +- 0.151 (in-sample avg dev_std = 0.224)
NEC for r=0.8 all KL = 0.069 +- 0.151 (in-sample avg dev_std = 0.224)
NEC for r=0.8 all L1 = 0.089 +- 0.161 (in-sample avg dev_std = 0.224)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.916
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7772366288492708
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.378
NEC for r=0.05 class 1.0 = 0.578 +- 0.336 (in-sample avg dev_std = 0.575)
NEC for r=0.05 all KL = 0.791 +- 0.336 (in-sample avg dev_std = 0.575)
NEC for r=0.05 all L1 = 0.578 +- 0.294 (in-sample avg dev_std = 0.575)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.916
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8372512155591573
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.511
NEC for r=0.1 class 1.0 = 0.466 +- 0.358 (in-sample avg dev_std = 0.574)
NEC for r=0.1 all KL = 0.69 +- 0.358 (in-sample avg dev_std = 0.574)
NEC for r=0.1 all L1 = 0.466 +- 0.308 (in-sample avg dev_std = 0.574)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.916
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8769432739059967
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.627
NEC for r=0.2 class 1.0 = 0.355 +- 0.376 (in-sample avg dev_std = 0.550)
NEC for r=0.2 all KL = 0.555 +- 0.376 (in-sample avg dev_std = 0.550)
NEC for r=0.2 all L1 = 0.355 +- 0.299 (in-sample avg dev_std = 0.550)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.916
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8974663695299838
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.711
NEC for r=0.4 class 1.0 = 0.26 +- 0.376 (in-sample avg dev_std = 0.492)
NEC for r=0.4 all KL = 0.413 +- 0.376 (in-sample avg dev_std = 0.492)
NEC for r=0.4 all L1 = 0.26 +- 0.281 (in-sample avg dev_std = 0.492)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.916
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9035705024311182
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.785
NEC for r=0.8 class 1.0 = 0.184 +- 0.347 (in-sample avg dev_std = 0.444)
NEC for r=0.8 all KL = 0.304 +- 0.347 (in-sample avg dev_std = 0.444)
NEC for r=0.8 all L1 = 0.184 +- 0.241 (in-sample avg dev_std = 0.444)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 17:18:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 05:18:44 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 05:18:44 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 05:18:44 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 05:18:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:18:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:18:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:18:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:18:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:18:44 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 05:18:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mChartInfo 0.9440 0.9440 0.9440 0.9440 0.9680 0.9680[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.761
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.795
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.766
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.722
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.694
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.526
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.364
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.261
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.211
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.200
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.790
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.840
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.867
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.884
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.895


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7611263537906137
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.802
SUFF_SIMPLE for r=0.05 class 1.0 = 0.756 +- 0.350 (in-sample avg dev_std = 0.538)
SUFF_SIMPLE for r=0.05 all KL = 0.652 +- 0.350 (in-sample avg dev_std = 0.538)
SUFF_SIMPLE for r=0.05 all L1 = 0.756 +- 0.232 (in-sample avg dev_std = 0.538)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.795043321299639
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.819
SUFF_SIMPLE for r=0.1 class 1.0 = 0.773 +- 0.348 (in-sample avg dev_std = 0.534)
SUFF_SIMPLE for r=0.1 all KL = 0.675 +- 0.348 (in-sample avg dev_std = 0.534)
SUFF_SIMPLE for r=0.1 all L1 = 0.773 +- 0.230 (in-sample avg dev_std = 0.534)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7663176895306859
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.835
SUFF_SIMPLE for r=0.2 class 1.0 = 0.808 +- 0.330 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.2 all KL = 0.749 +- 0.330 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.2 all L1 = 0.808 +- 0.230 (in-sample avg dev_std = 0.463)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7223032490974728
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.836
SUFF_SIMPLE for r=0.4 class 1.0 = 0.812 +- 0.316 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.4 all KL = 0.764 +- 0.316 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.4 all L1 = 0.812 +- 0.233 (in-sample avg dev_std = 0.423)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6939314079422383
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.803
SUFF_SIMPLE for r=0.8 class 1.0 = 0.786 +- 0.340 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.8 all KL = 0.758 +- 0.340 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.8 all L1 = 0.786 +- 0.277 (in-sample avg dev_std = 0.340)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.082
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5261436507936508
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.033
SUFF_SIMPLE for r=0.05 class 1.0 = 0.917 +- 0.122 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.05 all KL = 0.948 +- 0.122 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.05 all L1 = 0.917 +- 0.167 (in-sample avg dev_std = 0.136)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.082
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3638369047619048
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.032
SUFF_SIMPLE for r=0.1 class 1.0 = 0.917 +- 0.123 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all KL = 0.948 +- 0.123 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all L1 = 0.917 +- 0.170 (in-sample avg dev_std = 0.123)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.082
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26057063492063487
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.029
SUFF_SIMPLE for r=0.2 class 1.0 = 0.913 +- 0.134 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.2 all KL = 0.943 +- 0.134 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.2 all L1 = 0.913 +- 0.177 (in-sample avg dev_std = 0.124)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.082
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.21059166666666668
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.025
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.147 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 all KL = 0.938 +- 0.147 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 all L1 = 0.91 +- 0.185 (in-sample avg dev_std = 0.125)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.082
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.20013928571428571
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.013
SUFF_SIMPLE for r=0.8 class 1.0 = 0.9 +- 0.182 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.8 all KL = 0.923 +- 0.182 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.8 all L1 = 0.9 +- 0.207 (in-sample avg dev_std = 0.100)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.889
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7903650729335495
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.755
SUFF_SIMPLE for r=0.05 class 1.0 = 0.789 +- 0.389 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.05 all KL = 0.694 +- 0.389 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.05 all L1 = 0.789 +- 0.292 (in-sample avg dev_std = 0.465)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.889
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8395352512155592
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.763
SUFF_SIMPLE for r=0.1 class 1.0 = 0.805 +- 0.379 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.1 all KL = 0.722 +- 0.379 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.1 all L1 = 0.805 +- 0.288 (in-sample avg dev_std = 0.434)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.889
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8665384927066452
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.746
SUFF_SIMPLE for r=0.2 class 1.0 = 0.831 +- 0.357 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.2 all KL = 0.767 +- 0.357 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.2 all L1 = 0.831 +- 0.279 (in-sample avg dev_std = 0.390)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.889
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8838942463533226
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.744
SUFF_SIMPLE for r=0.4 class 1.0 = 0.835 +- 0.354 (in-sample avg dev_std = 0.366)
SUFF_SIMPLE for r=0.4 all KL = 0.779 +- 0.354 (in-sample avg dev_std = 0.366)
SUFF_SIMPLE for r=0.4 all L1 = 0.835 +- 0.282 (in-sample avg dev_std = 0.366)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.892
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.895316450567261
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.752
SUFF_SIMPLE for r=0.8 class 1.0 = 0.847 +- 0.355 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.8 all KL = 0.809 +- 0.355 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.8 all L1 = 0.847 +- 0.288 (in-sample avg dev_std = 0.309)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7611263537906137
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.25
NEC for r=0.05 class 1.0 = 0.692 +- 0.222 (in-sample avg dev_std = 0.466)
NEC for r=0.05 all KL = 0.856 +- 0.222 (in-sample avg dev_std = 0.466)
NEC for r=0.05 all L1 = 0.692 +- 0.200 (in-sample avg dev_std = 0.466)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.795043321299639
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.458
NEC for r=0.1 class 1.0 = 0.57 +- 0.241 (in-sample avg dev_std = 0.708)
NEC for r=0.1 all KL = 0.773 +- 0.241 (in-sample avg dev_std = 0.708)
NEC for r=0.1 all L1 = 0.57 +- 0.206 (in-sample avg dev_std = 0.708)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7663176895306859
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.656
NEC for r=0.2 class 1.0 = 0.409 +- 0.308 (in-sample avg dev_std = 0.708)
NEC for r=0.2 all KL = 0.609 +- 0.308 (in-sample avg dev_std = 0.708)
NEC for r=0.2 all L1 = 0.409 +- 0.227 (in-sample avg dev_std = 0.708)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7223032490974728
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.783
NEC for r=0.4 class 1.0 = 0.276 +- 0.320 (in-sample avg dev_std = 0.650)
NEC for r=0.4 all KL = 0.449 +- 0.320 (in-sample avg dev_std = 0.650)
NEC for r=0.4 all L1 = 0.276 +- 0.202 (in-sample avg dev_std = 0.650)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6939314079422383
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.866
NEC for r=0.8 class 1.0 = 0.173 +- 0.300 (in-sample avg dev_std = 0.511)
NEC for r=0.8 all KL = 0.286 +- 0.300 (in-sample avg dev_std = 0.511)
NEC for r=0.8 all L1 = 0.173 +- 0.172 (in-sample avg dev_std = 0.511)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.082
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5261436507936508
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.005
NEC for r=0.05 class 1.0 = 0.109 +- 0.219 (in-sample avg dev_std = 0.093)
NEC for r=0.05 all KL = 0.09 +- 0.219 (in-sample avg dev_std = 0.093)
NEC for r=0.05 all L1 = 0.109 +- 0.228 (in-sample avg dev_std = 0.093)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.082
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3638369047619048
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.025
NEC for r=0.1 class 1.0 = 0.095 +- 0.194 (in-sample avg dev_std = 0.192)
NEC for r=0.1 all KL = 0.078 +- 0.194 (in-sample avg dev_std = 0.192)
NEC for r=0.1 all L1 = 0.095 +- 0.201 (in-sample avg dev_std = 0.192)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.082
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26057063492063487
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.043
NEC for r=0.2 class 1.0 = 0.073 +- 0.155 (in-sample avg dev_std = 0.225)
NEC for r=0.2 all KL = 0.058 +- 0.155 (in-sample avg dev_std = 0.225)
NEC for r=0.2 all L1 = 0.073 +- 0.159 (in-sample avg dev_std = 0.225)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.082
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.21059166666666668
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.052
NEC for r=0.4 class 1.0 = 0.058 +- 0.117 (in-sample avg dev_std = 0.198)
NEC for r=0.4 all KL = 0.041 +- 0.117 (in-sample avg dev_std = 0.198)
NEC for r=0.4 all L1 = 0.058 +- 0.127 (in-sample avg dev_std = 0.198)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.082
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.20013928571428571
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.053
NEC for r=0.8 class 1.0 = 0.055 +- 0.091 (in-sample avg dev_std = 0.163)
NEC for r=0.8 all KL = 0.031 +- 0.091 (in-sample avg dev_std = 0.163)
NEC for r=0.8 all L1 = 0.055 +- 0.115 (in-sample avg dev_std = 0.163)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.889
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7903650729335495
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.169
NEC for r=0.05 class 1.0 = 0.671 +- 0.316 (in-sample avg dev_std = 0.502)
NEC for r=0.05 all KL = 0.811 +- 0.316 (in-sample avg dev_std = 0.502)
NEC for r=0.05 all L1 = 0.671 +- 0.275 (in-sample avg dev_std = 0.502)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.889
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8395352512155592
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.308
NEC for r=0.1 class 1.0 = 0.58 +- 0.328 (in-sample avg dev_std = 0.630)
NEC for r=0.1 all KL = 0.739 +- 0.328 (in-sample avg dev_std = 0.630)
NEC for r=0.1 all L1 = 0.58 +- 0.283 (in-sample avg dev_std = 0.630)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.889
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8665384927066452
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.457
NEC for r=0.2 class 1.0 = 0.467 +- 0.353 (in-sample avg dev_std = 0.671)
NEC for r=0.2 all KL = 0.635 +- 0.353 (in-sample avg dev_std = 0.671)
NEC for r=0.2 all L1 = 0.467 +- 0.288 (in-sample avg dev_std = 0.671)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.889
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8838942463533226
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.604
NEC for r=0.4 class 1.0 = 0.338 +- 0.367 (in-sample avg dev_std = 0.641)
NEC for r=0.4 all KL = 0.498 +- 0.367 (in-sample avg dev_std = 0.641)
NEC for r=0.4 all L1 = 0.338 +- 0.275 (in-sample avg dev_std = 0.641)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.889
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.895316450567261
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.691
NEC for r=0.8 class 1.0 = 0.266 +- 0.353 (in-sample avg dev_std = 0.601)
NEC for r=0.8 all KL = 0.416 +- 0.353 (in-sample avg dev_std = 0.601)
NEC for r=0.8 all L1 = 0.266 +- 0.252 (in-sample avg dev_std = 0.601)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 17:24:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 05:24:26 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 05:24:26 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 05:24:26 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 05:24:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:24:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:24:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:24:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:24:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:24:26 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 05:24:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mChartInfo 0.9500 0.9500 0.9500 0.9500 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.712
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.783
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.779
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.752
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.730
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.572
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.434
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.350
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.314
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.308
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.772
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.825
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.860
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.880
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.896


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7116606498194946
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.788
SUFF_SIMPLE for r=0.05 class 1.0 = 0.727 +- 0.346 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.05 all KL = 0.619 +- 0.346 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.05 all L1 = 0.727 +- 0.230 (in-sample avg dev_std = 0.584)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7827003610108303
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.831
SUFF_SIMPLE for r=0.1 class 1.0 = 0.774 +- 0.330 (in-sample avg dev_std = 0.513)
SUFF_SIMPLE for r=0.1 all KL = 0.694 +- 0.330 (in-sample avg dev_std = 0.513)
SUFF_SIMPLE for r=0.1 all L1 = 0.774 +- 0.218 (in-sample avg dev_std = 0.513)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7794079422382671
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.85
SUFF_SIMPLE for r=0.2 class 1.0 = 0.801 +- 0.310 (in-sample avg dev_std = 0.471)
SUFF_SIMPLE for r=0.2 all KL = 0.736 +- 0.310 (in-sample avg dev_std = 0.471)
SUFF_SIMPLE for r=0.2 all L1 = 0.801 +- 0.204 (in-sample avg dev_std = 0.471)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7522454873646209
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.86
SUFF_SIMPLE for r=0.4 class 1.0 = 0.818 +- 0.294 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.4 all KL = 0.778 +- 0.294 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.4 all L1 = 0.818 +- 0.211 (in-sample avg dev_std = 0.434)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7304837545126354
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.818
SUFF_SIMPLE for r=0.8 class 1.0 = 0.793 +- 0.323 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.8 all KL = 0.777 +- 0.323 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.8 all L1 = 0.793 +- 0.266 (in-sample avg dev_std = 0.325)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.126
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.571809126984127
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.041
SUFF_SIMPLE for r=0.05 class 1.0 = 0.861 +- 0.160 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.05 all KL = 0.909 +- 0.160 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.05 all L1 = 0.861 +- 0.204 (in-sample avg dev_std = 0.176)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.126
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.433838492063492
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.042
SUFF_SIMPLE for r=0.1 class 1.0 = 0.861 +- 0.158 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.1 all KL = 0.909 +- 0.158 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.1 all L1 = 0.861 +- 0.203 (in-sample avg dev_std = 0.171)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.126
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3500595238095238
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.04
SUFF_SIMPLE for r=0.2 class 1.0 = 0.858 +- 0.164 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.2 all KL = 0.905 +- 0.164 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.2 all L1 = 0.858 +- 0.208 (in-sample avg dev_std = 0.167)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.126
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.314218253968254
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.036
SUFF_SIMPLE for r=0.4 class 1.0 = 0.854 +- 0.170 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 all KL = 0.901 +- 0.170 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 all L1 = 0.854 +- 0.214 (in-sample avg dev_std = 0.156)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.126
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.30808214285714286
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.018
SUFF_SIMPLE for r=0.8 class 1.0 = 0.838 +- 0.216 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.8 all KL = 0.876 +- 0.216 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.8 all L1 = 0.838 +- 0.242 (in-sample avg dev_std = 0.134)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7716114262560778
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.756
SUFF_SIMPLE for r=0.05 class 1.0 = 0.789 +- 0.405 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.05 all KL = 0.695 +- 0.405 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.05 all L1 = 0.789 +- 0.291 (in-sample avg dev_std = 0.464)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.825064829821718
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.776
SUFF_SIMPLE for r=0.1 class 1.0 = 0.823 +- 0.382 (in-sample avg dev_std = 0.398)
SUFF_SIMPLE for r=0.1 all KL = 0.756 +- 0.382 (in-sample avg dev_std = 0.398)
SUFF_SIMPLE for r=0.1 all L1 = 0.823 +- 0.280 (in-sample avg dev_std = 0.398)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8598087520259319
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.763
SUFF_SIMPLE for r=0.2 class 1.0 = 0.854 +- 0.346 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.2 all KL = 0.812 +- 0.346 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.2 all L1 = 0.854 +- 0.267 (in-sample avg dev_std = 0.336)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8798156401944895
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.765
SUFF_SIMPLE for r=0.4 class 1.0 = 0.865 +- 0.333 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.4 all KL = 0.838 +- 0.333 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.4 all L1 = 0.865 +- 0.269 (in-sample avg dev_std = 0.274)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.885
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8958541329011345
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.771
SUFF_SIMPLE for r=0.8 class 1.0 = 0.88 +- 0.317 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 all KL = 0.868 +- 0.317 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 all L1 = 0.88 +- 0.272 (in-sample avg dev_std = 0.143)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7116606498194946
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.116
NEC for r=0.05 class 1.0 = 0.78 +- 0.151 (in-sample avg dev_std = 0.415)
NEC for r=0.05 all KL = 0.92 +- 0.151 (in-sample avg dev_std = 0.415)
NEC for r=0.05 all L1 = 0.78 +- 0.137 (in-sample avg dev_std = 0.415)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7827003610108303
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.366
NEC for r=0.1 class 1.0 = 0.648 +- 0.215 (in-sample avg dev_std = 0.736)
NEC for r=0.1 all KL = 0.836 +- 0.215 (in-sample avg dev_std = 0.736)
NEC for r=0.1 all L1 = 0.648 +- 0.188 (in-sample avg dev_std = 0.736)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7794079422382671
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.592
NEC for r=0.2 class 1.0 = 0.47 +- 0.288 (in-sample avg dev_std = 0.761)
NEC for r=0.2 all KL = 0.669 +- 0.288 (in-sample avg dev_std = 0.761)
NEC for r=0.2 all L1 = 0.47 +- 0.231 (in-sample avg dev_std = 0.761)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7522454873646209
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.747
NEC for r=0.4 class 1.0 = 0.331 +- 0.323 (in-sample avg dev_std = 0.714)
NEC for r=0.4 all KL = 0.513 +- 0.323 (in-sample avg dev_std = 0.714)
NEC for r=0.4 all L1 = 0.331 +- 0.214 (in-sample avg dev_std = 0.714)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7304837545126354
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.847
NEC for r=0.8 class 1.0 = 0.208 +- 0.323 (in-sample avg dev_std = 0.586)
NEC for r=0.8 all KL = 0.338 +- 0.323 (in-sample avg dev_std = 0.586)
NEC for r=0.8 all L1 = 0.208 +- 0.191 (in-sample avg dev_std = 0.586)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.126
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.571809126984127
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.008
NEC for r=0.05 class 1.0 = 0.173 +- 0.253 (in-sample avg dev_std = 0.120)
NEC for r=0.05 all KL = 0.142 +- 0.253 (in-sample avg dev_std = 0.120)
NEC for r=0.05 all L1 = 0.173 +- 0.263 (in-sample avg dev_std = 0.120)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.126
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.433838492063492
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.032
NEC for r=0.1 class 1.0 = 0.151 +- 0.228 (in-sample avg dev_std = 0.236)
NEC for r=0.1 all KL = 0.122 +- 0.228 (in-sample avg dev_std = 0.236)
NEC for r=0.1 all L1 = 0.151 +- 0.234 (in-sample avg dev_std = 0.236)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.126
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3500595238095238
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.056
NEC for r=0.2 class 1.0 = 0.123 +- 0.185 (in-sample avg dev_std = 0.258)
NEC for r=0.2 all KL = 0.094 +- 0.185 (in-sample avg dev_std = 0.258)
NEC for r=0.2 all L1 = 0.123 +- 0.194 (in-sample avg dev_std = 0.258)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.126
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.314218253968254
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.067
NEC for r=0.4 class 1.0 = 0.105 +- 0.148 (in-sample avg dev_std = 0.242)
NEC for r=0.4 all KL = 0.072 +- 0.148 (in-sample avg dev_std = 0.242)
NEC for r=0.4 all L1 = 0.105 +- 0.163 (in-sample avg dev_std = 0.242)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.126
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.30808214285714286
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.074
NEC for r=0.8 class 1.0 = 0.095 +- 0.116 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all KL = 0.054 +- 0.116 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all L1 = 0.095 +- 0.143 (in-sample avg dev_std = 0.204)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7716114262560778
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.166
NEC for r=0.05 class 1.0 = 0.69 +- 0.309 (in-sample avg dev_std = 0.496)
NEC for r=0.05 all KL = 0.814 +- 0.309 (in-sample avg dev_std = 0.496)
NEC for r=0.05 all L1 = 0.69 +- 0.278 (in-sample avg dev_std = 0.496)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.825064829821718
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.299
NEC for r=0.1 class 1.0 = 0.611 +- 0.324 (in-sample avg dev_std = 0.661)
NEC for r=0.1 all KL = 0.761 +- 0.324 (in-sample avg dev_std = 0.661)
NEC for r=0.1 all L1 = 0.611 +- 0.283 (in-sample avg dev_std = 0.661)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8598087520259319
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.454
NEC for r=0.2 class 1.0 = 0.494 +- 0.361 (in-sample avg dev_std = 0.724)
NEC for r=0.2 all KL = 0.666 +- 0.361 (in-sample avg dev_std = 0.724)
NEC for r=0.2 all L1 = 0.494 +- 0.291 (in-sample avg dev_std = 0.724)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8798156401944895
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.604
NEC for r=0.4 class 1.0 = 0.37 +- 0.381 (in-sample avg dev_std = 0.700)
NEC for r=0.4 all KL = 0.552 +- 0.381 (in-sample avg dev_std = 0.700)
NEC for r=0.4 all L1 = 0.37 +- 0.280 (in-sample avg dev_std = 0.700)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.883
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8958541329011345
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.693
NEC for r=0.8 class 1.0 = 0.272 +- 0.383 (in-sample avg dev_std = 0.640)
NEC for r=0.8 all KL = 0.446 +- 0.383 (in-sample avg dev_std = 0.640)
NEC for r=0.8 all L1 = 0.272 +- 0.257 (in-sample avg dev_std = 0.640)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 17:30:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 05:30:06 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 05:30:06 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 05:30:06 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 05:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:30:06 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 05:30:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mChartInfo 0.9460 0.9460 0.9460 0.9460 0.9560 0.9560[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.709
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.707
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.613
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.508
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.442
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.441
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.272
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.167
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.111
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.092
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.749
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.792
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.813
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.827
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.838


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.971
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7093465703971118
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.697
SUFF_SIMPLE for r=0.05 class 1.0 = 0.641 +- 0.284 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.05 all KL = 0.595 +- 0.284 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.05 all L1 = 0.641 +- 0.222 (in-sample avg dev_std = 0.570)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.971
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7065270758122745
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.737
SUFF_SIMPLE for r=0.1 class 1.0 = 0.687 +- 0.287 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.1 all KL = 0.662 +- 0.287 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.1 all L1 = 0.687 +- 0.230 (in-sample avg dev_std = 0.505)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.971
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6131227436823103
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.749
SUFF_SIMPLE for r=0.2 class 1.0 = 0.704 +- 0.278 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.2 all KL = 0.685 +- 0.278 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.2 all L1 = 0.704 +- 0.226 (in-sample avg dev_std = 0.494)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.971
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5076064981949457
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.77
SUFF_SIMPLE for r=0.4 class 1.0 = 0.733 +- 0.285 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.4 all KL = 0.725 +- 0.285 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.4 all L1 = 0.733 +- 0.233 (in-sample avg dev_std = 0.444)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.971
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.4418880866425993
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.734
SUFF_SIMPLE for r=0.8 class 1.0 = 0.726 +- 0.333 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.8 all KL = 0.745 +- 0.333 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.8 all L1 = 0.726 +- 0.287 (in-sample avg dev_std = 0.293)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.034
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.440875
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.003
SUFF_SIMPLE for r=0.05 class 1.0 = 0.918 +- 0.112 (in-sample avg dev_std = 0.070)
SUFF_SIMPLE for r=0.05 all KL = 0.95 +- 0.112 (in-sample avg dev_std = 0.070)
SUFF_SIMPLE for r=0.05 all L1 = 0.918 +- 0.159 (in-sample avg dev_std = 0.070)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.034
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.27219365079365077
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.003
SUFF_SIMPLE for r=0.1 class 1.0 = 0.918 +- 0.111 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.1 all KL = 0.951 +- 0.111 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.1 all L1 = 0.918 +- 0.158 (in-sample avg dev_std = 0.073)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.034
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.16720793650793653
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.004
SUFF_SIMPLE for r=0.2 class 1.0 = 0.919 +- 0.107 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.2 all KL = 0.952 +- 0.107 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.2 all L1 = 0.919 +- 0.156 (in-sample avg dev_std = 0.072)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.034
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11055158730158729
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.004
SUFF_SIMPLE for r=0.4 class 1.0 = 0.918 +- 0.107 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.4 all KL = 0.952 +- 0.107 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.4 all L1 = 0.918 +- 0.157 (in-sample avg dev_std = 0.071)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.034
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09234603174603175
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.002
SUFF_SIMPLE for r=0.8 class 1.0 = 0.915 +- 0.117 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.8 all KL = 0.947 +- 0.117 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.8 all L1 = 0.915 +- 0.164 (in-sample avg dev_std = 0.046)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.865
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7488812803889789
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.744
SUFF_SIMPLE for r=0.05 class 1.0 = 0.84 +- 0.369 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.05 all KL = 0.79 +- 0.369 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.05 all L1 = 0.84 +- 0.283 (in-sample avg dev_std = 0.305)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.865
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7921794975688817
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.751
SUFF_SIMPLE for r=0.1 class 1.0 = 0.853 +- 0.356 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.1 all KL = 0.813 +- 0.356 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.1 all L1 = 0.853 +- 0.277 (in-sample avg dev_std = 0.265)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.865
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8125721231766612
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.755
SUFF_SIMPLE for r=0.2 class 1.0 = 0.87 +- 0.324 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.2 all KL = 0.85 +- 0.324 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.2 all L1 = 0.87 +- 0.271 (in-sample avg dev_std = 0.240)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.865
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8265968395461912
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.762
SUFF_SIMPLE for r=0.4 class 1.0 = 0.878 +- 0.312 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.4 all KL = 0.864 +- 0.312 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.4 all L1 = 0.878 +- 0.264 (in-sample avg dev_std = 0.215)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.868
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.837620340356564
len(reference) = 2455
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.76
SUFF_SIMPLE for r=0.8 class 1.0 = 0.885 +- 0.304 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.8 all KL = 0.879 +- 0.304 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.8 all L1 = 0.885 +- 0.268 (in-sample avg dev_std = 0.104)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.971
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7093465703971118
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.207
NEC for r=0.05 class 1.0 = 0.719 +- 0.215 (in-sample avg dev_std = 0.474)
NEC for r=0.05 all KL = 0.818 +- 0.215 (in-sample avg dev_std = 0.474)
NEC for r=0.05 all L1 = 0.719 +- 0.177 (in-sample avg dev_std = 0.474)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.971
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7065270758122745
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.394
NEC for r=0.1 class 1.0 = 0.616 +- 0.235 (in-sample avg dev_std = 0.667)
NEC for r=0.1 all KL = 0.728 +- 0.235 (in-sample avg dev_std = 0.667)
NEC for r=0.1 all L1 = 0.616 +- 0.188 (in-sample avg dev_std = 0.667)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.971
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6131227436823103
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.565
NEC for r=0.2 class 1.0 = 0.49 +- 0.256 (in-sample avg dev_std = 0.720)
NEC for r=0.2 all KL = 0.602 +- 0.256 (in-sample avg dev_std = 0.720)
NEC for r=0.2 all L1 = 0.49 +- 0.195 (in-sample avg dev_std = 0.720)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.971
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5076064981949457
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.733
NEC for r=0.4 class 1.0 = 0.332 +- 0.273 (in-sample avg dev_std = 0.634)
NEC for r=0.4 all KL = 0.411 +- 0.273 (in-sample avg dev_std = 0.634)
NEC for r=0.4 all L1 = 0.332 +- 0.198 (in-sample avg dev_std = 0.634)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.971
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.4418880866425993
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.824
NEC for r=0.8 class 1.0 = 0.228 +- 0.240 (in-sample avg dev_std = 0.540)
NEC for r=0.8 all KL = 0.28 +- 0.240 (in-sample avg dev_std = 0.540)
NEC for r=0.8 all L1 = 0.228 +- 0.171 (in-sample avg dev_std = 0.540)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.034
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.440875
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.001
NEC for r=0.05 class 1.0 = 0.089 +- 0.140 (in-sample avg dev_std = 0.041)
NEC for r=0.05 all KL = 0.062 +- 0.140 (in-sample avg dev_std = 0.041)
NEC for r=0.05 all L1 = 0.089 +- 0.175 (in-sample avg dev_std = 0.041)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.034
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.27219365079365077
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.002
NEC for r=0.1 class 1.0 = 0.086 +- 0.131 (in-sample avg dev_std = 0.072)
NEC for r=0.1 all KL = 0.057 +- 0.131 (in-sample avg dev_std = 0.072)
NEC for r=0.1 all L1 = 0.086 +- 0.168 (in-sample avg dev_std = 0.072)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.034
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.16720793650793653
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.004
NEC for r=0.2 class 1.0 = 0.08 +- 0.119 (in-sample avg dev_std = 0.089)
NEC for r=0.2 all KL = 0.05 +- 0.119 (in-sample avg dev_std = 0.089)
NEC for r=0.2 all L1 = 0.08 +- 0.158 (in-sample avg dev_std = 0.089)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.034
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11055158730158729
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.007
NEC for r=0.4 class 1.0 = 0.073 +- 0.101 (in-sample avg dev_std = 0.105)
NEC for r=0.4 all KL = 0.042 +- 0.101 (in-sample avg dev_std = 0.105)
NEC for r=0.4 all L1 = 0.073 +- 0.144 (in-sample avg dev_std = 0.105)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.034
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09234603174603175
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.01
NEC for r=0.8 class 1.0 = 0.066 +- 0.080 (in-sample avg dev_std = 0.105)
NEC for r=0.8 all KL = 0.034 +- 0.080 (in-sample avg dev_std = 0.105)
NEC for r=0.8 all L1 = 0.066 +- 0.128 (in-sample avg dev_std = 0.105)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.865
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7488812803889789
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.218
NEC for r=0.05 class 1.0 = 0.686 +- 0.312 (in-sample avg dev_std = 0.545)
NEC for r=0.05 all KL = 0.804 +- 0.312 (in-sample avg dev_std = 0.545)
NEC for r=0.05 all L1 = 0.686 +- 0.269 (in-sample avg dev_std = 0.545)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.865
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7921794975688817
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.335
NEC for r=0.1 class 1.0 = 0.615 +- 0.305 (in-sample avg dev_std = 0.686)
NEC for r=0.1 all KL = 0.752 +- 0.305 (in-sample avg dev_std = 0.686)
NEC for r=0.1 all L1 = 0.615 +- 0.266 (in-sample avg dev_std = 0.686)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.865
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8125721231766612
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.468
NEC for r=0.2 class 1.0 = 0.477 +- 0.334 (in-sample avg dev_std = 0.716)
NEC for r=0.2 all KL = 0.614 +- 0.334 (in-sample avg dev_std = 0.716)
NEC for r=0.2 all L1 = 0.477 +- 0.283 (in-sample avg dev_std = 0.716)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.865
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8265968395461912
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.606
NEC for r=0.4 class 1.0 = 0.342 +- 0.346 (in-sample avg dev_std = 0.659)
NEC for r=0.4 all KL = 0.467 +- 0.346 (in-sample avg dev_std = 0.659)
NEC for r=0.4 all L1 = 0.342 +- 0.276 (in-sample avg dev_std = 0.659)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.865
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.837620340356564
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.694
NEC for r=0.8 class 1.0 = 0.243 +- 0.341 (in-sample avg dev_std = 0.572)
NEC for r=0.8 all KL = 0.351 +- 0.341 (in-sample avg dev_std = 0.572)
NEC for r=0.8 all L1 = 0.243 +- 0.254 (in-sample avg dev_std = 0.572)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 17:35:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 05:35:41 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 05:35:41 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 05:35:41 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 05:35:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:35:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:35:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:35:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:35:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:35:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 05:35:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mChartInfo 0.9660 0.9660 0.9660 0.9660 0.9720 0.9720[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.745
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.794
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.773
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.730
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.700
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.521
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.364
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.269
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.224
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.213
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.750
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.816
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.854
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.876
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.881


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7449927797833935
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.796
SUFF_SIMPLE for r=0.05 class 1.0 = 0.767 +- 0.335 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.05 all KL = 0.712 +- 0.335 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.05 all L1 = 0.767 +- 0.239 (in-sample avg dev_std = 0.468)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7939638989169675
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.839
SUFF_SIMPLE for r=0.1 class 1.0 = 0.808 +- 0.307 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.1 all KL = 0.775 +- 0.307 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.1 all L1 = 0.808 +- 0.224 (in-sample avg dev_std = 0.404)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7727148014440433
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.859
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.271 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.2 all KL = 0.821 +- 0.271 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.2 all L1 = 0.833 +- 0.210 (in-sample avg dev_std = 0.346)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.729985559566787
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.848
SUFF_SIMPLE for r=0.4 class 1.0 = 0.831 +- 0.269 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.4 all KL = 0.816 +- 0.269 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.4 all L1 = 0.831 +- 0.221 (in-sample avg dev_std = 0.333)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7001552346570397
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.786
SUFF_SIMPLE for r=0.8 class 1.0 = 0.78 +- 0.337 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.8 all KL = 0.768 +- 0.337 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.8 all L1 = 0.78 +- 0.282 (in-sample avg dev_std = 0.329)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.059
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5207976190476191
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.012
SUFF_SIMPLE for r=0.05 class 1.0 = 0.923 +- 0.127 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.05 all KL = 0.95 +- 0.127 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.05 all L1 = 0.923 +- 0.171 (in-sample avg dev_std = 0.095)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.059
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3642964285714286
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.013
SUFF_SIMPLE for r=0.1 class 1.0 = 0.923 +- 0.127 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.1 all KL = 0.95 +- 0.127 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.1 all L1 = 0.923 +- 0.172 (in-sample avg dev_std = 0.093)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.059
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26864404761904764
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.011
SUFF_SIMPLE for r=0.2 class 1.0 = 0.921 +- 0.132 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.2 all KL = 0.948 +- 0.132 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.2 all L1 = 0.921 +- 0.175 (in-sample avg dev_std = 0.092)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.059
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.22398849206349208
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.01
SUFF_SIMPLE for r=0.4 class 1.0 = 0.92 +- 0.137 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.4 all KL = 0.946 +- 0.137 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.4 all L1 = 0.92 +- 0.178 (in-sample avg dev_std = 0.092)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.059
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.21262261904761903
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.004
SUFF_SIMPLE for r=0.8 class 1.0 = 0.914 +- 0.167 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.8 all KL = 0.935 +- 0.167 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.8 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.071)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.917
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7500498379254458
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.76
SUFF_SIMPLE for r=0.05 class 1.0 = 0.835 +- 0.366 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.05 all KL = 0.797 +- 0.366 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.05 all L1 = 0.835 +- 0.301 (in-sample avg dev_std = 0.292)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.917
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8163452188006483
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.78
SUFF_SIMPLE for r=0.1 class 1.0 = 0.857 +- 0.345 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.1 all KL = 0.83 +- 0.345 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.1 all L1 = 0.857 +- 0.289 (in-sample avg dev_std = 0.237)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.917
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8543756077795787
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.786
SUFF_SIMPLE for r=0.2 class 1.0 = 0.862 +- 0.341 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.2 all KL = 0.835 +- 0.341 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.2 all L1 = 0.862 +- 0.283 (in-sample avg dev_std = 0.248)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.917
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8756555915721231
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.8
SUFF_SIMPLE for r=0.4 class 1.0 = 0.865 +- 0.339 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.4 all KL = 0.838 +- 0.339 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.4 all L1 = 0.865 +- 0.280 (in-sample avg dev_std = 0.238)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.917
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8811969205834683
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.807
SUFF_SIMPLE for r=0.8 class 1.0 = 0.887 +- 0.314 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.8 all KL = 0.872 +- 0.314 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.8 all L1 = 0.887 +- 0.271 (in-sample avg dev_std = 0.100)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7449927797833935
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.159
NEC for r=0.05 class 1.0 = 0.731 +- 0.167 (in-sample avg dev_std = 0.472)
NEC for r=0.05 all KL = 0.883 +- 0.167 (in-sample avg dev_std = 0.472)
NEC for r=0.05 all L1 = 0.731 +- 0.140 (in-sample avg dev_std = 0.472)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7939638989169675
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.402
NEC for r=0.1 class 1.0 = 0.589 +- 0.238 (in-sample avg dev_std = 0.688)
NEC for r=0.1 all KL = 0.767 +- 0.238 (in-sample avg dev_std = 0.688)
NEC for r=0.1 all L1 = 0.589 +- 0.198 (in-sample avg dev_std = 0.688)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7727148014440433
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.608
NEC for r=0.2 class 1.0 = 0.42 +- 0.313 (in-sample avg dev_std = 0.678)
NEC for r=0.2 all KL = 0.589 +- 0.313 (in-sample avg dev_std = 0.678)
NEC for r=0.2 all L1 = 0.42 +- 0.241 (in-sample avg dev_std = 0.678)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.729985559566787
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.777
NEC for r=0.4 class 1.0 = 0.268 +- 0.315 (in-sample avg dev_std = 0.609)
NEC for r=0.4 all KL = 0.398 +- 0.315 (in-sample avg dev_std = 0.609)
NEC for r=0.4 all L1 = 0.268 +- 0.213 (in-sample avg dev_std = 0.609)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7001552346570397
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.862
NEC for r=0.8 class 1.0 = 0.172 +- 0.273 (in-sample avg dev_std = 0.488)
NEC for r=0.8 all KL = 0.259 +- 0.273 (in-sample avg dev_std = 0.488)
NEC for r=0.8 all L1 = 0.172 +- 0.168 (in-sample avg dev_std = 0.488)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.059
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5207976190476191
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.003
NEC for r=0.05 class 1.0 = 0.088 +- 0.180 (in-sample avg dev_std = 0.080)
NEC for r=0.05 all KL = 0.069 +- 0.180 (in-sample avg dev_std = 0.080)
NEC for r=0.05 all L1 = 0.088 +- 0.199 (in-sample avg dev_std = 0.080)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.059
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3642964285714286
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.015
NEC for r=0.1 class 1.0 = 0.077 +- 0.157 (in-sample avg dev_std = 0.157)
NEC for r=0.1 all KL = 0.059 +- 0.157 (in-sample avg dev_std = 0.157)
NEC for r=0.1 all L1 = 0.077 +- 0.177 (in-sample avg dev_std = 0.157)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.059
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26864404761904764
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.024
NEC for r=0.2 class 1.0 = 0.066 +- 0.124 (in-sample avg dev_std = 0.163)
NEC for r=0.2 all KL = 0.045 +- 0.124 (in-sample avg dev_std = 0.163)
NEC for r=0.2 all L1 = 0.066 +- 0.150 (in-sample avg dev_std = 0.163)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.059
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.22398849206349208
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.026
NEC for r=0.4 class 1.0 = 0.06 +- 0.100 (in-sample avg dev_std = 0.143)
NEC for r=0.4 all KL = 0.035 +- 0.100 (in-sample avg dev_std = 0.143)
NEC for r=0.4 all L1 = 0.06 +- 0.135 (in-sample avg dev_std = 0.143)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.059
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.21262261904761903
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.028
NEC for r=0.8 class 1.0 = 0.056 +- 0.079 (in-sample avg dev_std = 0.120)
NEC for r=0.8 all KL = 0.029 +- 0.079 (in-sample avg dev_std = 0.120)
NEC for r=0.8 all L1 = 0.056 +- 0.124 (in-sample avg dev_std = 0.120)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.917
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7500498379254458
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.18
NEC for r=0.05 class 1.0 = 0.706 +- 0.273 (in-sample avg dev_std = 0.531)
NEC for r=0.05 all KL = 0.872 +- 0.273 (in-sample avg dev_std = 0.531)
NEC for r=0.05 all L1 = 0.706 +- 0.238 (in-sample avg dev_std = 0.531)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.917
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8163452188006483
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.323
NEC for r=0.1 class 1.0 = 0.607 +- 0.285 (in-sample avg dev_std = 0.639)
NEC for r=0.1 all KL = 0.807 +- 0.285 (in-sample avg dev_std = 0.639)
NEC for r=0.1 all L1 = 0.607 +- 0.258 (in-sample avg dev_std = 0.639)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.917
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8543756077795787
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.483
NEC for r=0.2 class 1.0 = 0.472 +- 0.333 (in-sample avg dev_std = 0.651)
NEC for r=0.2 all KL = 0.672 +- 0.333 (in-sample avg dev_std = 0.651)
NEC for r=0.2 all L1 = 0.472 +- 0.283 (in-sample avg dev_std = 0.651)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.917
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8756555915721231
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.619
NEC for r=0.4 class 1.0 = 0.344 +- 0.362 (in-sample avg dev_std = 0.611)
NEC for r=0.4 all KL = 0.517 +- 0.362 (in-sample avg dev_std = 0.611)
NEC for r=0.4 all L1 = 0.344 +- 0.280 (in-sample avg dev_std = 0.611)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.917
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8811969205834683
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.708
NEC for r=0.8 class 1.0 = 0.251 +- 0.363 (in-sample avg dev_std = 0.536)
NEC for r=0.8 all KL = 0.383 +- 0.363 (in-sample avg dev_std = 0.536)
NEC for r=0.8 all L1 = 0.251 +- 0.270 (in-sample avg dev_std = 0.536)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 17:41:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 05:41:27 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 05:41:27 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 05:41:27 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 05:41:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:41:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:41:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:41:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:41:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:41:27 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 05:41:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mChartInfo 0.9320 0.9320 0.9320 0.9320 0.9260 0.9260[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.678
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.645
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.530
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.389
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.287
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.361
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.220
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.137
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.093
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.725
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.750
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.744
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.732
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.743


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.949
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.678263537906137
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.673
SUFF_SIMPLE for r=0.05 class 1.0 = 0.664 +- 0.321 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.05 all KL = 0.691 +- 0.321 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.05 all L1 = 0.664 +- 0.251 (in-sample avg dev_std = 0.438)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.949
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6454440433212997
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.711
SUFF_SIMPLE for r=0.1 class 1.0 = 0.707 +- 0.286 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.1 all KL = 0.755 +- 0.286 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.1 all L1 = 0.707 +- 0.231 (in-sample avg dev_std = 0.375)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.949
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5300036101083032
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.731
SUFF_SIMPLE for r=0.2 class 1.0 = 0.724 +- 0.260 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.2 all KL = 0.785 +- 0.260 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.2 all L1 = 0.724 +- 0.225 (in-sample avg dev_std = 0.336)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.949
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.38911913357400724
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.728
SUFF_SIMPLE for r=0.4 class 1.0 = 0.73 +- 0.240 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 all KL = 0.801 +- 0.240 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 all L1 = 0.73 +- 0.225 (in-sample avg dev_std = 0.276)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.949
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.28722743682310475
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.669
SUFF_SIMPLE for r=0.8 class 1.0 = 0.683 +- 0.270 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.8 all KL = 0.759 +- 0.270 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.8 all L1 = 0.683 +- 0.253 (in-sample avg dev_std = 0.216)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.072
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3610781746031746
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.011
SUFF_SIMPLE for r=0.05 class 1.0 = 0.861 +- 0.108 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.05 all KL = 0.927 +- 0.108 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.05 all L1 = 0.861 +- 0.177 (in-sample avg dev_std = 0.091)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.072
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22009444444444445
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.01
SUFF_SIMPLE for r=0.1 class 1.0 = 0.861 +- 0.107 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.1 all KL = 0.927 +- 0.107 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.1 all L1 = 0.861 +- 0.178 (in-sample avg dev_std = 0.090)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.072
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.13720436507936506
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.01
SUFF_SIMPLE for r=0.2 class 1.0 = 0.86 +- 0.109 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.2 all KL = 0.926 +- 0.109 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.2 all L1 = 0.86 +- 0.178 (in-sample avg dev_std = 0.090)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.072
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09306944444444443
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.008
SUFF_SIMPLE for r=0.4 class 1.0 = 0.858 +- 0.113 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.4 all KL = 0.924 +- 0.113 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.4 all L1 = 0.858 +- 0.182 (in-sample avg dev_std = 0.082)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.072
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07896309523809522
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.008
SUFF_SIMPLE for r=0.8 class 1.0 = 0.855 +- 0.123 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.8 all KL = 0.919 +- 0.123 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.8 all L1 = 0.855 +- 0.188 (in-sample avg dev_std = 0.073)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.684
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7245903565640194
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.54
SUFF_SIMPLE for r=0.05 class 1.0 = 0.812 +- 0.342 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.05 all KL = 0.812 +- 0.342 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.05 all L1 = 0.812 +- 0.287 (in-sample avg dev_std = 0.247)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.684
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7500494327390599
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.556
SUFF_SIMPLE for r=0.1 class 1.0 = 0.83 +- 0.323 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.1 all KL = 0.84 +- 0.323 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.1 all L1 = 0.83 +- 0.278 (in-sample avg dev_std = 0.174)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.684
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7436523500810373
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.56
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.320 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.2 all KL = 0.843 +- 0.320 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.2 all L1 = 0.833 +- 0.274 (in-sample avg dev_std = 0.162)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.684
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7319833873581848
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.571
SUFF_SIMPLE for r=0.4 class 1.0 = 0.834 +- 0.319 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.4 all KL = 0.843 +- 0.319 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.4 all L1 = 0.834 +- 0.272 (in-sample avg dev_std = 0.161)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.688
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7434311183144247
len(reference) = 2455
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.598
SUFF_SIMPLE for r=0.8 class 1.0 = 0.852 +- 0.298 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 all KL = 0.871 +- 0.298 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 all L1 = 0.852 +- 0.265 (in-sample avg dev_std = 0.052)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.949
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.678263537906137
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.138
NEC for r=0.05 class 1.0 = 0.724 +- 0.218 (in-sample avg dev_std = 0.409)
NEC for r=0.05 all KL = 0.781 +- 0.218 (in-sample avg dev_std = 0.409)
NEC for r=0.05 all L1 = 0.724 +- 0.164 (in-sample avg dev_std = 0.409)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.949
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6454440433212997
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.348
NEC for r=0.1 class 1.0 = 0.605 +- 0.255 (in-sample avg dev_std = 0.651)
NEC for r=0.1 all KL = 0.676 +- 0.255 (in-sample avg dev_std = 0.651)
NEC for r=0.1 all L1 = 0.605 +- 0.198 (in-sample avg dev_std = 0.651)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.949
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5300036101083032
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.546
NEC for r=0.2 class 1.0 = 0.457 +- 0.296 (in-sample avg dev_std = 0.667)
NEC for r=0.2 all KL = 0.517 +- 0.296 (in-sample avg dev_std = 0.667)
NEC for r=0.2 all L1 = 0.457 +- 0.228 (in-sample avg dev_std = 0.667)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.949
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.38911913357400724
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.712
NEC for r=0.4 class 1.0 = 0.319 +- 0.294 (in-sample avg dev_std = 0.624)
NEC for r=0.4 all KL = 0.363 +- 0.294 (in-sample avg dev_std = 0.624)
NEC for r=0.4 all L1 = 0.319 +- 0.211 (in-sample avg dev_std = 0.624)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.949
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.28722743682310475
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.805
NEC for r=0.8 class 1.0 = 0.207 +- 0.262 (in-sample avg dev_std = 0.493)
NEC for r=0.8 all KL = 0.224 +- 0.262 (in-sample avg dev_std = 0.493)
NEC for r=0.8 all L1 = 0.207 +- 0.180 (in-sample avg dev_std = 0.493)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.072
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3610781746031746
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.003
NEC for r=0.05 class 1.0 = 0.162 +- 0.182 (in-sample avg dev_std = 0.077)
NEC for r=0.05 all KL = 0.114 +- 0.182 (in-sample avg dev_std = 0.077)
NEC for r=0.05 all L1 = 0.162 +- 0.218 (in-sample avg dev_std = 0.077)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.072
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22009444444444445
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.012
NEC for r=0.1 class 1.0 = 0.147 +- 0.159 (in-sample avg dev_std = 0.148)
NEC for r=0.1 all KL = 0.097 +- 0.159 (in-sample avg dev_std = 0.148)
NEC for r=0.1 all L1 = 0.147 +- 0.198 (in-sample avg dev_std = 0.148)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.072
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.13720436507936506
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.019
NEC for r=0.2 class 1.0 = 0.127 +- 0.125 (in-sample avg dev_std = 0.163)
NEC for r=0.2 all KL = 0.074 +- 0.125 (in-sample avg dev_std = 0.163)
NEC for r=0.2 all L1 = 0.127 +- 0.171 (in-sample avg dev_std = 0.163)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.072
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09306944444444443
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.025
NEC for r=0.4 class 1.0 = 0.112 +- 0.095 (in-sample avg dev_std = 0.156)
NEC for r=0.4 all KL = 0.056 +- 0.095 (in-sample avg dev_std = 0.156)
NEC for r=0.4 all L1 = 0.112 +- 0.147 (in-sample avg dev_std = 0.156)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.072
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07896309523809522
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.029
NEC for r=0.8 class 1.0 = 0.103 +- 0.070 (in-sample avg dev_std = 0.134)
NEC for r=0.8 all KL = 0.044 +- 0.070 (in-sample avg dev_std = 0.134)
NEC for r=0.8 all L1 = 0.103 +- 0.131 (in-sample avg dev_std = 0.134)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.684
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7245903565640194
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.146
NEC for r=0.05 class 1.0 = 0.59 +- 0.357 (in-sample avg dev_std = 0.285)
NEC for r=0.05 all KL = 0.586 +- 0.357 (in-sample avg dev_std = 0.285)
NEC for r=0.05 all L1 = 0.59 +- 0.287 (in-sample avg dev_std = 0.285)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.684
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7500494327390599
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.231
NEC for r=0.1 class 1.0 = 0.529 +- 0.363 (in-sample avg dev_std = 0.473)
NEC for r=0.1 all KL = 0.538 +- 0.363 (in-sample avg dev_std = 0.473)
NEC for r=0.1 all L1 = 0.529 +- 0.292 (in-sample avg dev_std = 0.473)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.684
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7436523500810373
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.33
NEC for r=0.2 class 1.0 = 0.451 +- 0.358 (in-sample avg dev_std = 0.583)
NEC for r=0.2 all KL = 0.481 +- 0.358 (in-sample avg dev_std = 0.583)
NEC for r=0.2 all L1 = 0.451 +- 0.284 (in-sample avg dev_std = 0.583)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.684
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7319833873581848
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.412
NEC for r=0.4 class 1.0 = 0.364 +- 0.352 (in-sample avg dev_std = 0.580)
NEC for r=0.4 all KL = 0.406 +- 0.352 (in-sample avg dev_std = 0.580)
NEC for r=0.4 all L1 = 0.364 +- 0.280 (in-sample avg dev_std = 0.580)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.684
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7434311183144247
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.479
NEC for r=0.8 class 1.0 = 0.277 +- 0.336 (in-sample avg dev_std = 0.515)
NEC for r=0.8 all KL = 0.316 +- 0.336 (in-sample avg dev_std = 0.515)
NEC for r=0.8 all L1 = 0.277 +- 0.268 (in-sample avg dev_std = 0.515)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 17:47:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 05:47:14 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 05:47:14 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 05:47:14 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 05:47:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:47:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:47:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:47:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:47:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:47:14 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 05:47:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mChartInfo 0.9540 0.9540 0.9540 0.9540 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.674
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.708
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.652
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.576
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.525
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.465
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.307
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.205
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.148
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.130
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.763
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.817
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.850
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.869
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.872


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.993
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6736389891696751
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.753
SUFF_SIMPLE for r=0.05 class 1.0 = 0.663 +- 0.277 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.05 all KL = 0.568 +- 0.277 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.05 all L1 = 0.663 +- 0.213 (in-sample avg dev_std = 0.567)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.993
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7079025270758122
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.778
SUFF_SIMPLE for r=0.1 class 1.0 = 0.693 +- 0.285 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.1 all KL = 0.607 +- 0.285 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.1 all L1 = 0.693 +- 0.206 (in-sample avg dev_std = 0.547)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.993
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6518880866425992
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.798
SUFF_SIMPLE for r=0.2 class 1.0 = 0.722 +- 0.280 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.2 all KL = 0.654 +- 0.280 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.2 all L1 = 0.722 +- 0.214 (in-sample avg dev_std = 0.507)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5759675090252708
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.796
SUFF_SIMPLE for r=0.4 class 1.0 = 0.722 +- 0.279 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.4 all KL = 0.658 +- 0.279 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.4 all L1 = 0.722 +- 0.217 (in-sample avg dev_std = 0.496)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.993
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5253393501805055
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.771
SUFF_SIMPLE for r=0.8 class 1.0 = 0.716 +- 0.317 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.8 all KL = 0.681 +- 0.317 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.8 all L1 = 0.716 +- 0.266 (in-sample avg dev_std = 0.392)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.094
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4646369047619048
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.011
SUFF_SIMPLE for r=0.05 class 1.0 = 0.839 +- 0.199 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.05 all KL = 0.883 +- 0.199 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.05 all L1 = 0.839 +- 0.231 (in-sample avg dev_std = 0.129)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.094
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3073797619047619
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.009
SUFF_SIMPLE for r=0.1 class 1.0 = 0.839 +- 0.198 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.1 all KL = 0.884 +- 0.198 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.1 all L1 = 0.839 +- 0.231 (in-sample avg dev_std = 0.119)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.094
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2047234126984127
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.009
SUFF_SIMPLE for r=0.2 class 1.0 = 0.839 +- 0.197 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 all KL = 0.885 +- 0.197 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.2 all L1 = 0.839 +- 0.231 (in-sample avg dev_std = 0.121)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.094
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1484531746031746
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.01
SUFF_SIMPLE for r=0.4 class 1.0 = 0.84 +- 0.196 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 all KL = 0.885 +- 0.196 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 all L1 = 0.84 +- 0.230 (in-sample avg dev_std = 0.125)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.094
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1301734126984127
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.006
SUFF_SIMPLE for r=0.8 class 1.0 = 0.838 +- 0.199 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.8 all KL = 0.884 +- 0.199 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.8 all L1 = 0.838 +- 0.233 (in-sample avg dev_std = 0.091)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.915
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7628083468395461
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.757
SUFF_SIMPLE for r=0.05 class 1.0 = 0.801 +- 0.379 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.05 all KL = 0.726 +- 0.379 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.05 all L1 = 0.801 +- 0.290 (in-sample avg dev_std = 0.417)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.915
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8170004051863857
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.767
SUFF_SIMPLE for r=0.1 class 1.0 = 0.818 +- 0.372 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.1 all KL = 0.759 +- 0.372 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.1 all L1 = 0.818 +- 0.291 (in-sample avg dev_std = 0.360)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.915
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8501272285251213
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.772
SUFF_SIMPLE for r=0.2 class 1.0 = 0.828 +- 0.366 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.2 all KL = 0.778 +- 0.366 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.2 all L1 = 0.828 +- 0.292 (in-sample avg dev_std = 0.326)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.915
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8688286061588332
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.775
SUFF_SIMPLE for r=0.4 class 1.0 = 0.836 +- 0.362 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.4 all KL = 0.797 +- 0.362 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.4 all L1 = 0.836 +- 0.295 (in-sample avg dev_std = 0.281)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.917
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8723407617504051
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.827
SUFF_SIMPLE for r=0.8 class 1.0 = 0.889 +- 0.301 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.8 all KL = 0.876 +- 0.301 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.8 all L1 = 0.889 +- 0.259 (in-sample avg dev_std = 0.103)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.993
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6736389891696751
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.335
NEC for r=0.05 class 1.0 = 0.654 +- 0.190 (in-sample avg dev_std = 0.450)
NEC for r=0.05 all KL = 0.803 +- 0.190 (in-sample avg dev_std = 0.450)
NEC for r=0.05 all L1 = 0.654 +- 0.176 (in-sample avg dev_std = 0.450)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.993
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7079025270758122
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.527
NEC for r=0.1 class 1.0 = 0.538 +- 0.223 (in-sample avg dev_std = 0.583)
NEC for r=0.1 all KL = 0.688 +- 0.223 (in-sample avg dev_std = 0.583)
NEC for r=0.1 all L1 = 0.538 +- 0.193 (in-sample avg dev_std = 0.583)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.993
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6518880866425992
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.686
NEC for r=0.2 class 1.0 = 0.404 +- 0.247 (in-sample avg dev_std = 0.632)
NEC for r=0.2 all KL = 0.541 +- 0.247 (in-sample avg dev_std = 0.632)
NEC for r=0.2 all L1 = 0.404 +- 0.187 (in-sample avg dev_std = 0.632)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5759675090252708
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.805
NEC for r=0.4 class 1.0 = 0.279 +- 0.263 (in-sample avg dev_std = 0.552)
NEC for r=0.4 all KL = 0.38 +- 0.263 (in-sample avg dev_std = 0.552)
NEC for r=0.4 all L1 = 0.279 +- 0.178 (in-sample avg dev_std = 0.552)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.993
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5253393501805055
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.861
NEC for r=0.8 class 1.0 = 0.197 +- 0.235 (in-sample avg dev_std = 0.481)
NEC for r=0.8 all KL = 0.266 +- 0.235 (in-sample avg dev_std = 0.481)
NEC for r=0.8 all L1 = 0.197 +- 0.158 (in-sample avg dev_std = 0.481)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.094
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4646369047619048
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.001
NEC for r=0.05 class 1.0 = 0.169 +- 0.220 (in-sample avg dev_std = 0.038)
NEC for r=0.05 all KL = 0.129 +- 0.220 (in-sample avg dev_std = 0.038)
NEC for r=0.05 all L1 = 0.169 +- 0.245 (in-sample avg dev_std = 0.038)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.094
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3073797619047619
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.004
NEC for r=0.1 class 1.0 = 0.166 +- 0.213 (in-sample avg dev_std = 0.091)
NEC for r=0.1 all KL = 0.125 +- 0.213 (in-sample avg dev_std = 0.091)
NEC for r=0.1 all L1 = 0.166 +- 0.240 (in-sample avg dev_std = 0.091)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.094
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2047234126984127
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.009
NEC for r=0.2 class 1.0 = 0.16 +- 0.202 (in-sample avg dev_std = 0.130)
NEC for r=0.2 all KL = 0.118 +- 0.202 (in-sample avg dev_std = 0.130)
NEC for r=0.2 all L1 = 0.16 +- 0.231 (in-sample avg dev_std = 0.130)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.094
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1484531746031746
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.019
NEC for r=0.4 class 1.0 = 0.15 +- 0.182 (in-sample avg dev_std = 0.170)
NEC for r=0.4 all KL = 0.106 +- 0.182 (in-sample avg dev_std = 0.170)
NEC for r=0.4 all L1 = 0.15 +- 0.216 (in-sample avg dev_std = 0.170)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.094
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1301734126984127
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.025
NEC for r=0.8 class 1.0 = 0.141 +- 0.163 (in-sample avg dev_std = 0.185)
NEC for r=0.8 all KL = 0.094 +- 0.163 (in-sample avg dev_std = 0.185)
NEC for r=0.8 all L1 = 0.141 +- 0.202 (in-sample avg dev_std = 0.185)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.915
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7628083468395461
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.309
NEC for r=0.05 class 1.0 = 0.629 +- 0.296 (in-sample avg dev_std = 0.602)
NEC for r=0.05 all KL = 0.812 +- 0.296 (in-sample avg dev_std = 0.602)
NEC for r=0.05 all L1 = 0.629 +- 0.254 (in-sample avg dev_std = 0.602)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.915
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8170004051863857
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.417
NEC for r=0.1 class 1.0 = 0.539 +- 0.300 (in-sample avg dev_std = 0.637)
NEC for r=0.1 all KL = 0.742 +- 0.300 (in-sample avg dev_std = 0.637)
NEC for r=0.1 all L1 = 0.539 +- 0.268 (in-sample avg dev_std = 0.637)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.915
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8501272285251213
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.55
NEC for r=0.2 class 1.0 = 0.42 +- 0.342 (in-sample avg dev_std = 0.606)
NEC for r=0.2 all KL = 0.602 +- 0.342 (in-sample avg dev_std = 0.606)
NEC for r=0.2 all L1 = 0.42 +- 0.287 (in-sample avg dev_std = 0.606)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.915
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8688286061588332
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.66
NEC for r=0.4 class 1.0 = 0.316 +- 0.361 (in-sample avg dev_std = 0.557)
NEC for r=0.4 all KL = 0.467 +- 0.361 (in-sample avg dev_std = 0.557)
NEC for r=0.4 all L1 = 0.316 +- 0.281 (in-sample avg dev_std = 0.557)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.915
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8723407617504051
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.743
NEC for r=0.8 class 1.0 = 0.235 +- 0.351 (in-sample avg dev_std = 0.504)
NEC for r=0.8 all KL = 0.352 +- 0.351 (in-sample avg dev_std = 0.504)
NEC for r=0.8 all L1 = 0.235 +- 0.260 (in-sample avg dev_std = 0.504)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 17:53:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 05:53:08 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 05:53:08 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 05:53:08 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 05:53:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:53:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:53:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:53:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:53:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:53:08 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 05:53:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mChartInfo 0.9680 0.9680 0.9680 0.9680 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.746
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.809
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.796
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.753
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.720
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.574
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.404
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.286
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.222
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.201
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.789
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.847
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.883
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.904
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.911


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.986
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7457797833935018
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.911
SUFF_SIMPLE for r=0.05 class 1.0 = 0.889 +- 0.234 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.05 all KL = 0.855 +- 0.234 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.05 all L1 = 0.889 +- 0.170 (in-sample avg dev_std = 0.336)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.986
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8091588447653429
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.914
SUFF_SIMPLE for r=0.1 class 1.0 = 0.886 +- 0.241 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.1 all KL = 0.853 +- 0.241 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.1 all L1 = 0.886 +- 0.176 (in-sample avg dev_std = 0.336)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.986
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7959783393501805
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.896
SUFF_SIMPLE for r=0.2 class 1.0 = 0.873 +- 0.274 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.2 all KL = 0.834 +- 0.274 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.2 all L1 = 0.873 +- 0.201 (in-sample avg dev_std = 0.349)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.986
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7532743682310469
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.883
SUFF_SIMPLE for r=0.4 class 1.0 = 0.857 +- 0.291 (in-sample avg dev_std = 0.361)
SUFF_SIMPLE for r=0.4 all KL = 0.814 +- 0.291 (in-sample avg dev_std = 0.361)
SUFF_SIMPLE for r=0.4 all L1 = 0.857 +- 0.216 (in-sample avg dev_std = 0.361)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.986
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7202707581227437
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.822
SUFF_SIMPLE for r=0.8 class 1.0 = 0.803 +- 0.344 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.8 all KL = 0.758 +- 0.344 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.8 all L1 = 0.803 +- 0.277 (in-sample avg dev_std = 0.352)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.132
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5736623015873016
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.058
SUFF_SIMPLE for r=0.05 class 1.0 = 0.882 +- 0.145 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.05 all KL = 0.923 +- 0.145 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.05 all L1 = 0.882 +- 0.192 (in-sample avg dev_std = 0.177)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.132
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4042134920634921
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.054
SUFF_SIMPLE for r=0.1 class 1.0 = 0.88 +- 0.150 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.1 all KL = 0.92 +- 0.150 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.1 all L1 = 0.88 +- 0.195 (in-sample avg dev_std = 0.175)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.132
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2860722222222222
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.052
SUFF_SIMPLE for r=0.2 class 1.0 = 0.878 +- 0.155 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.2 all KL = 0.917 +- 0.155 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.2 all L1 = 0.878 +- 0.200 (in-sample avg dev_std = 0.171)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.132
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.22185396825396825
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.044
SUFF_SIMPLE for r=0.4 class 1.0 = 0.87 +- 0.173 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 all KL = 0.907 +- 0.173 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 all L1 = 0.87 +- 0.213 (in-sample avg dev_std = 0.168)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.132
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2014285714285714
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.025
SUFF_SIMPLE for r=0.8 class 1.0 = 0.855 +- 0.219 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.8 all KL = 0.885 +- 0.219 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.8 all L1 = 0.855 +- 0.241 (in-sample avg dev_std = 0.149)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.788722042139384
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.927
SUFF_SIMPLE for r=0.05 class 1.0 = 0.894 +- 0.324 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.05 all KL = 0.842 +- 0.324 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.05 all L1 = 0.894 +- 0.229 (in-sample avg dev_std = 0.342)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8467216369529983
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.931
SUFF_SIMPLE for r=0.1 class 1.0 = 0.894 +- 0.318 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 all KL = 0.85 +- 0.318 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 all L1 = 0.894 +- 0.235 (in-sample avg dev_std = 0.324)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8830757698541329
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.942
SUFF_SIMPLE for r=0.2 class 1.0 = 0.897 +- 0.312 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.2 all KL = 0.861 +- 0.312 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.2 all L1 = 0.897 +- 0.242 (in-sample avg dev_std = 0.267)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.903976904376013
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.932
SUFF_SIMPLE for r=0.4 class 1.0 = 0.893 +- 0.321 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.4 all KL = 0.855 +- 0.321 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.4 all L1 = 0.893 +- 0.247 (in-sample avg dev_std = 0.277)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.925
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9111045380875201
len(reference) = 2440
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.903
SUFF_SIMPLE for r=0.8 class 1.0 = 0.915 +- 0.278 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.8 all KL = 0.903 +- 0.278 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.8 all L1 = 0.915 +- 0.241 (in-sample avg dev_std = 0.087)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.986
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7457797833935018
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.872
NEC for r=0.05 class 1.0 = 0.181 +- 0.360 (in-sample avg dev_std = 0.441)
NEC for r=0.05 all KL = 0.233 +- 0.360 (in-sample avg dev_std = 0.441)
NEC for r=0.05 all L1 = 0.181 +- 0.257 (in-sample avg dev_std = 0.441)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.986
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8091588447653429
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.918
NEC for r=0.1 class 1.0 = 0.124 +- 0.303 (in-sample avg dev_std = 0.409)
NEC for r=0.1 all KL = 0.173 +- 0.303 (in-sample avg dev_std = 0.409)
NEC for r=0.1 all L1 = 0.124 +- 0.198 (in-sample avg dev_std = 0.409)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.986
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7959783393501805
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.948
NEC for r=0.2 class 1.0 = 0.081 +- 0.244 (in-sample avg dev_std = 0.343)
NEC for r=0.2 all KL = 0.12 +- 0.244 (in-sample avg dev_std = 0.343)
NEC for r=0.2 all L1 = 0.081 +- 0.142 (in-sample avg dev_std = 0.343)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.986
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7532743682310469
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.961
NEC for r=0.4 class 1.0 = 0.052 +- 0.181 (in-sample avg dev_std = 0.266)
NEC for r=0.4 all KL = 0.074 +- 0.181 (in-sample avg dev_std = 0.266)
NEC for r=0.4 all L1 = 0.052 +- 0.102 (in-sample avg dev_std = 0.266)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.986
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7202707581227437
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.966
NEC for r=0.8 class 1.0 = 0.044 +- 0.157 (in-sample avg dev_std = 0.234)
NEC for r=0.8 all KL = 0.06 +- 0.157 (in-sample avg dev_std = 0.234)
NEC for r=0.8 all L1 = 0.044 +- 0.089 (in-sample avg dev_std = 0.234)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.132
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5736623015873016
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.116
NEC for r=0.05 class 1.0 = 0.168 +- 0.206 (in-sample avg dev_std = 0.293)
NEC for r=0.05 all KL = 0.142 +- 0.206 (in-sample avg dev_std = 0.293)
NEC for r=0.05 all L1 = 0.168 +- 0.226 (in-sample avg dev_std = 0.293)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.132
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4042134920634921
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.164
NEC for r=0.1 class 1.0 = 0.141 +- 0.154 (in-sample avg dev_std = 0.272)
NEC for r=0.1 all KL = 0.109 +- 0.154 (in-sample avg dev_std = 0.272)
NEC for r=0.1 all L1 = 0.141 +- 0.189 (in-sample avg dev_std = 0.272)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.132
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2860722222222222
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.151
NEC for r=0.2 class 1.0 = 0.101 +- 0.112 (in-sample avg dev_std = 0.239)
NEC for r=0.2 all KL = 0.069 +- 0.112 (in-sample avg dev_std = 0.239)
NEC for r=0.2 all L1 = 0.101 +- 0.146 (in-sample avg dev_std = 0.239)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.132
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.22185396825396825
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.129
NEC for r=0.4 class 1.0 = 0.071 +- 0.075 (in-sample avg dev_std = 0.181)
NEC for r=0.4 all KL = 0.039 +- 0.075 (in-sample avg dev_std = 0.181)
NEC for r=0.4 all L1 = 0.071 +- 0.112 (in-sample avg dev_std = 0.181)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.132
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2014285714285714
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.107
NEC for r=0.8 class 1.0 = 0.069 +- 0.068 (in-sample avg dev_std = 0.153)
NEC for r=0.8 all KL = 0.032 +- 0.068 (in-sample avg dev_std = 0.153)
NEC for r=0.8 all L1 = 0.069 +- 0.112 (in-sample avg dev_std = 0.153)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.788722042139384
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.508
NEC for r=0.05 class 1.0 = 0.473 +- 0.381 (in-sample avg dev_std = 0.662)
NEC for r=0.05 all KL = 0.652 +- 0.381 (in-sample avg dev_std = 0.662)
NEC for r=0.05 all L1 = 0.473 +- 0.312 (in-sample avg dev_std = 0.662)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8467216369529983
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.655
NEC for r=0.1 class 1.0 = 0.345 +- 0.387 (in-sample avg dev_std = 0.633)
NEC for r=0.1 all KL = 0.513 +- 0.387 (in-sample avg dev_std = 0.633)
NEC for r=0.1 all L1 = 0.345 +- 0.296 (in-sample avg dev_std = 0.633)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8830757698541329
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.769
NEC for r=0.2 class 1.0 = 0.235 +- 0.371 (in-sample avg dev_std = 0.552)
NEC for r=0.2 all KL = 0.373 +- 0.371 (in-sample avg dev_std = 0.552)
NEC for r=0.2 all L1 = 0.235 +- 0.262 (in-sample avg dev_std = 0.552)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.903976904376013
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.864
NEC for r=0.4 class 1.0 = 0.161 +- 0.343 (in-sample avg dev_std = 0.459)
NEC for r=0.4 all KL = 0.267 +- 0.343 (in-sample avg dev_std = 0.459)
NEC for r=0.4 all L1 = 0.161 +- 0.230 (in-sample avg dev_std = 0.459)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9111045380875201
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.918
NEC for r=0.8 class 1.0 = 0.121 +- 0.329 (in-sample avg dev_std = 0.403)
NEC for r=0.8 all KL = 0.212 +- 0.329 (in-sample avg dev_std = 0.403)
NEC for r=0.8 all L1 = 0.121 +- 0.208 (in-sample avg dev_std = 0.403)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.835, 0.829, 0.819, 0.8, 0.75], 'all_L1': [0.841, 0.838, 0.832, 0.814, 0.764]}), defaultdict(<class 'list'>, {'all_KL': [0.628, 0.634, 0.634, 0.661, 0.684], 'all_L1': [0.768, 0.776, 0.779, 0.775, 0.765]}), defaultdict(<class 'list'>, {'all_KL': [0.719, 0.741, 0.782, 0.785, 0.758], 'all_L1': [0.795, 0.806, 0.832, 0.826, 0.794]}), defaultdict(<class 'list'>, {'all_KL': [0.652, 0.675, 0.749, 0.764, 0.758], 'all_L1': [0.756, 0.773, 0.808, 0.812, 0.786]}), defaultdict(<class 'list'>, {'all_KL': [0.619, 0.694, 0.736, 0.778, 0.777], 'all_L1': [0.727, 0.774, 0.801, 0.818, 0.793]}), defaultdict(<class 'list'>, {'all_KL': [0.595, 0.662, 0.685, 0.725, 0.745], 'all_L1': [0.641, 0.687, 0.704, 0.733, 0.726]}), defaultdict(<class 'list'>, {'all_KL': [0.712, 0.775, 0.821, 0.816, 0.768], 'all_L1': [0.767, 0.808, 0.833, 0.831, 0.78]}), defaultdict(<class 'list'>, {'all_KL': [0.691, 0.755, 0.785, 0.801, 0.759], 'all_L1': [0.664, 0.707, 0.724, 0.73, 0.683]}), defaultdict(<class 'list'>, {'all_KL': [0.568, 0.607, 0.654, 0.658, 0.681], 'all_L1': [0.663, 0.693, 0.722, 0.722, 0.716]}), defaultdict(<class 'list'>, {'all_KL': [0.855, 0.853, 0.834, 0.814, 0.758], 'all_L1': [0.889, 0.886, 0.873, 0.857, 0.803]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.185, 0.134, 0.087, 0.06, 0.045], 'all_L1': [0.192, 0.142, 0.095, 0.068, 0.054]}), defaultdict(<class 'list'>, {'all_KL': [0.856, 0.744, 0.59, 0.411, 0.275], 'all_L1': [0.599, 0.461, 0.332, 0.216, 0.142]}), defaultdict(<class 'list'>, {'all_KL': [0.722, 0.588, 0.444, 0.268, 0.2], 'all_L1': [0.527, 0.399, 0.284, 0.167, 0.127]}), defaultdict(<class 'list'>, {'all_KL': [0.856, 0.773, 0.609, 0.449, 0.286], 'all_L1': [0.692, 0.57, 0.409, 0.276, 0.173]}), defaultdict(<class 'list'>, {'all_KL': [0.92, 0.836, 0.669, 0.513, 0.338], 'all_L1': [0.78, 0.648, 0.47, 0.331, 0.208]}), defaultdict(<class 'list'>, {'all_KL': [0.818, 0.728, 0.602, 0.411, 0.28], 'all_L1': [0.719, 0.616, 0.49, 0.332, 0.228]}), defaultdict(<class 'list'>, {'all_KL': [0.883, 0.767, 0.589, 0.398, 0.259], 'all_L1': [0.731, 0.589, 0.42, 0.268, 0.172]}), defaultdict(<class 'list'>, {'all_KL': [0.781, 0.676, 0.517, 0.363, 0.224], 'all_L1': [0.724, 0.605, 0.457, 0.319, 0.207]}), defaultdict(<class 'list'>, {'all_KL': [0.803, 0.688, 0.541, 0.38, 0.266], 'all_L1': [0.654, 0.538, 0.404, 0.279, 0.197]}), defaultdict(<class 'list'>, {'all_KL': [0.233, 0.173, 0.12, 0.074, 0.06], 'all_L1': [0.181, 0.124, 0.081, 0.052, 0.044]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.936, 0.931, 0.927, 0.917, 0.896], 'all_L1': [0.884, 0.88, 0.876, 0.868, 0.853]}), defaultdict(<class 'list'>, {'all_KL': [0.851, 0.851, 0.847, 0.843, 0.836], 'all_L1': [0.835, 0.835, 0.832, 0.828, 0.821]}), defaultdict(<class 'list'>, {'all_KL': [0.899, 0.902, 0.899, 0.898, 0.881], 'all_L1': [0.882, 0.884, 0.882, 0.88, 0.867]}), defaultdict(<class 'list'>, {'all_KL': [0.948, 0.948, 0.943, 0.938, 0.923], 'all_L1': [0.917, 0.917, 0.913, 0.91, 0.9]}), defaultdict(<class 'list'>, {'all_KL': [0.909, 0.909, 0.905, 0.901, 0.876], 'all_L1': [0.861, 0.861, 0.858, 0.854, 0.838]}), defaultdict(<class 'list'>, {'all_KL': [0.95, 0.951, 0.952, 0.952, 0.947], 'all_L1': [0.918, 0.918, 0.919, 0.918, 0.915]}), defaultdict(<class 'list'>, {'all_KL': [0.95, 0.95, 0.948, 0.946, 0.935], 'all_L1': [0.923, 0.923, 0.921, 0.92, 0.914]}), defaultdict(<class 'list'>, {'all_KL': [0.927, 0.927, 0.926, 0.924, 0.919], 'all_L1': [0.861, 0.861, 0.86, 0.858, 0.855]}), defaultdict(<class 'list'>, {'all_KL': [0.883, 0.884, 0.885, 0.885, 0.884], 'all_L1': [0.839, 0.839, 0.839, 0.84, 0.838]}), defaultdict(<class 'list'>, {'all_KL': [0.923, 0.92, 0.917, 0.907, 0.885], 'all_L1': [0.882, 0.88, 0.878, 0.87, 0.855]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.082, 0.054, 0.034, 0.024, 0.024], 'all_L1': [0.127, 0.098, 0.071, 0.056, 0.063]}), defaultdict(<class 'list'>, {'all_KL': [0.172, 0.164, 0.144, 0.123, 0.106], 'all_L1': [0.187, 0.175, 0.157, 0.141, 0.131]}), defaultdict(<class 'list'>, {'all_KL': [0.135, 0.122, 0.101, 0.085, 0.069], 'all_L1': [0.146, 0.132, 0.113, 0.101, 0.089]}), defaultdict(<class 'list'>, {'all_KL': [0.09, 0.078, 0.058, 0.041, 0.031], 'all_L1': [0.109, 0.095, 0.073, 0.058, 0.055]}), defaultdict(<class 'list'>, {'all_KL': [0.142, 0.122, 0.094, 0.072, 0.054], 'all_L1': [0.173, 0.151, 0.123, 0.105, 0.095]}), defaultdict(<class 'list'>, {'all_KL': [0.062, 0.057, 0.05, 0.042, 0.034], 'all_L1': [0.089, 0.086, 0.08, 0.073, 0.066]}), defaultdict(<class 'list'>, {'all_KL': [0.069, 0.059, 0.045, 0.035, 0.029], 'all_L1': [0.088, 0.077, 0.066, 0.06, 0.056]}), defaultdict(<class 'list'>, {'all_KL': [0.114, 0.097, 0.074, 0.056, 0.044], 'all_L1': [0.162, 0.147, 0.127, 0.112, 0.103]}), defaultdict(<class 'list'>, {'all_KL': [0.129, 0.125, 0.118, 0.106, 0.094], 'all_L1': [0.169, 0.166, 0.16, 0.15, 0.141]}), defaultdict(<class 'list'>, {'all_KL': [0.142, 0.109, 0.069, 0.039, 0.032], 'all_L1': [0.168, 0.141, 0.101, 0.071, 0.069]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.821, 0.827, 0.848, 0.868, 0.897], 'all_L1': [0.868, 0.869, 0.884, 0.888, 0.899]}), defaultdict(<class 'list'>, {'all_KL': [0.659, 0.696, 0.747, 0.773, 0.849], 'all_L1': [0.808, 0.823, 0.844, 0.848, 0.88]}), defaultdict(<class 'list'>, {'all_KL': [0.793, 0.816, 0.83, 0.834, 0.877], 'all_L1': [0.846, 0.859, 0.867, 0.87, 0.893]}), defaultdict(<class 'list'>, {'all_KL': [0.694, 0.722, 0.767, 0.779, 0.809], 'all_L1': [0.789, 0.805, 0.831, 0.835, 0.847]}), defaultdict(<class 'list'>, {'all_KL': [0.695, 0.756, 0.812, 0.838, 0.868], 'all_L1': [0.789, 0.823, 0.854, 0.865, 0.88]}), defaultdict(<class 'list'>, {'all_KL': [0.79, 0.813, 0.85, 0.864, 0.879], 'all_L1': [0.84, 0.853, 0.87, 0.878, 0.885]}), defaultdict(<class 'list'>, {'all_KL': [0.797, 0.83, 0.835, 0.838, 0.872], 'all_L1': [0.835, 0.857, 0.862, 0.865, 0.887]}), defaultdict(<class 'list'>, {'all_KL': [0.812, 0.84, 0.843, 0.843, 0.871], 'all_L1': [0.812, 0.83, 0.833, 0.834, 0.852]}), defaultdict(<class 'list'>, {'all_KL': [0.726, 0.759, 0.778, 0.797, 0.876], 'all_L1': [0.801, 0.818, 0.828, 0.836, 0.889]}), defaultdict(<class 'list'>, {'all_KL': [0.842, 0.85, 0.861, 0.855, 0.903], 'all_L1': [0.894, 0.894, 0.897, 0.893, 0.915]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.539, 0.401, 0.279, 0.185, 0.156], 'all_L1': [0.46, 0.329, 0.226, 0.146, 0.116]}), defaultdict(<class 'list'>, {'all_KL': [0.837, 0.754, 0.645, 0.509, 0.406], 'all_L1': [0.562, 0.46, 0.368, 0.268, 0.204]}), defaultdict(<class 'list'>, {'all_KL': [0.791, 0.69, 0.555, 0.413, 0.304], 'all_L1': [0.578, 0.466, 0.355, 0.26, 0.184]}), defaultdict(<class 'list'>, {'all_KL': [0.811, 0.739, 0.635, 0.498, 0.416], 'all_L1': [0.671, 0.58, 0.467, 0.338, 0.266]}), defaultdict(<class 'list'>, {'all_KL': [0.814, 0.761, 0.666, 0.552, 0.446], 'all_L1': [0.69, 0.611, 0.494, 0.37, 0.272]}), defaultdict(<class 'list'>, {'all_KL': [0.804, 0.752, 0.614, 0.467, 0.351], 'all_L1': [0.686, 0.615, 0.477, 0.342, 0.243]}), defaultdict(<class 'list'>, {'all_KL': [0.872, 0.807, 0.672, 0.517, 0.383], 'all_L1': [0.706, 0.607, 0.472, 0.344, 0.251]}), defaultdict(<class 'list'>, {'all_KL': [0.586, 0.538, 0.481, 0.406, 0.316], 'all_L1': [0.59, 0.529, 0.451, 0.364, 0.277]}), defaultdict(<class 'list'>, {'all_KL': [0.812, 0.742, 0.602, 0.467, 0.352], 'all_L1': [0.629, 0.539, 0.42, 0.316, 0.235]}), defaultdict(<class 'list'>, {'all_KL': [0.652, 0.513, 0.373, 0.267, 0.212], 'all_L1': [0.473, 0.345, 0.235, 0.161, 0.121]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.751 +- 0.076, 0.775 +- 0.061, 0.791 +- 0.054, 0.792 +- 0.046, 0.761 +- 0.038
suff_simple class all_KL  =  0.687 +- 0.092, 0.723 +- 0.078, 0.750 +- 0.068, 0.760 +- 0.056, 0.744 +- 0.032
suff_simple_acc_int  =  0.795 +- 0.070, 0.819 +- 0.059, 0.827 +- 0.050, 0.824 +- 0.044, 0.779 +- 0.044
nec class all_L1  =  0.580 +- 0.208, 0.469 +- 0.182, 0.344 +- 0.141, 0.231 +- 0.098, 0.155 +- 0.061
nec class all_KL  =  0.706 +- 0.254, 0.611 +- 0.237, 0.477 +- 0.195, 0.333 +- 0.145, 0.223 +- 0.092
nec_acc_int  =  0.389 +- 0.273, 0.561 +- 0.205, 0.707 +- 0.139, 0.820 +- 0.084, 0.880 +- 0.051

Eval split val
suff_simple class all_L1  =  0.880 +- 0.030, 0.880 +- 0.030, 0.878 +- 0.030, 0.875 +- 0.031, 0.866 +- 0.031
suff_simple class all_KL  =  0.918 +- 0.031, 0.917 +- 0.030, 0.915 +- 0.031, 0.911 +- 0.031, 0.898 +- 0.031
suff_simple_acc_int  =  0.032 +- 0.021, 0.031 +- 0.021, 0.030 +- 0.020, 0.026 +- 0.017, 0.015 +- 0.011
nec class all_L1  =  0.142 +- 0.034, 0.127 +- 0.033, 0.107 +- 0.033, 0.093 +- 0.033, 0.087 +- 0.029
nec class all_KL  =  0.114 +- 0.035, 0.099 +- 0.034, 0.079 +- 0.033, 0.062 +- 0.031, 0.052 +- 0.027
nec_acc_int  =  0.021 +- 0.034, 0.042 +- 0.046, 0.053 +- 0.042, 0.058 +- 0.037, 0.058 +- 0.032

Eval split test
suff_simple class all_L1  =  0.828 +- 0.033, 0.843 +- 0.026, 0.857 +- 0.022, 0.861 +- 0.021, 0.883 +- 0.019
suff_simple class all_KL  =  0.763 +- 0.060, 0.791 +- 0.051, 0.817 +- 0.038, 0.829 +- 0.032, 0.870 +- 0.025
suff_simple_acc_int  =  0.767 +- 0.098, 0.778 +- 0.095, 0.781 +- 0.098, 0.783 +- 0.095, 0.791 +- 0.080
nec class all_L1  =  0.604 +- 0.084, 0.508 +- 0.101, 0.396 +- 0.094, 0.291 +- 0.077, 0.217 +- 0.056
nec class all_KL  =  0.752 +- 0.109, 0.670 +- 0.129, 0.552 +- 0.127, 0.428 +- 0.111, 0.334 +- 0.087
nec_acc_int  =  0.298 +- 0.137, 0.426 +- 0.147, 0.550 +- 0.136, 0.663 +- 0.126, 0.736 +- 0.117


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.665 +- 0.077, 0.622 +- 0.071, 0.567 +- 0.055, 0.511 +- 0.040, 0.458 +- 0.026
Faith. Armon (L1)= 		  =  0.617 +- 0.159, 0.552 +- 0.168, 0.456 +- 0.156, 0.343 +- 0.128, 0.251 +- 0.088
Faith. GMean (L1)= 	  =  0.638 +- 0.123, 0.582 +- 0.128, 0.502 +- 0.120, 0.412 +- 0.103, 0.334 +- 0.074
Faith. Aritm (KL)= 		  =  0.697 +- 0.090, 0.667 +- 0.093, 0.613 +- 0.082, 0.546 +- 0.066, 0.484 +- 0.047
Faith. Armon (KL)= 		  =  0.647 +- 0.160, 0.616 +- 0.183, 0.546 +- 0.186, 0.438 +- 0.166, 0.331 +- 0.123
Faith. GMean (KL)= 	  =  0.670 +- 0.129, 0.637 +- 0.145, 0.573 +- 0.146, 0.482 +- 0.133, 0.394 +- 0.103

Eval split val
Faith. Aritm (L1)= 		  =  0.511 +- 0.006, 0.503 +- 0.006, 0.492 +- 0.007, 0.484 +- 0.010, 0.476 +- 0.010
Faith. Armon (L1)= 		  =  0.242 +- 0.051, 0.220 +- 0.050, 0.189 +- 0.051, 0.166 +- 0.052, 0.156 +- 0.047
Faith. GMean (L1)= 	  =  0.350 +- 0.039, 0.330 +- 0.040, 0.302 +- 0.042, 0.280 +- 0.045, 0.270 +- 0.041
Faith. Aritm (KL)= 		  =  0.516 +- 0.008, 0.508 +- 0.007, 0.497 +- 0.006, 0.487 +- 0.008, 0.475 +- 0.011
Faith. Armon (KL)= 		  =  0.200 +- 0.054, 0.176 +- 0.055, 0.143 +- 0.055, 0.115 +- 0.053, 0.096 +- 0.047
Faith. GMean (KL)= 	  =  0.318 +- 0.046, 0.295 +- 0.049, 0.261 +- 0.052, 0.230 +- 0.055, 0.208 +- 0.051

Eval split test
Faith. Aritm (L1)= 		  =  0.716 +- 0.033, 0.676 +- 0.044, 0.627 +- 0.040, 0.576 +- 0.033, 0.550 +- 0.022
Faith. Armon (L1)= 		  =  0.694 +- 0.052, 0.627 +- 0.080, 0.534 +- 0.093, 0.428 +- 0.091, 0.344 +- 0.075
Faith. GMean (L1)= 	  =  0.705 +- 0.042, 0.650 +- 0.063, 0.578 +- 0.070, 0.495 +- 0.069, 0.433 +- 0.058
Faith. Aritm (KL)= 		  =  0.757 +- 0.043, 0.730 +- 0.055, 0.685 +- 0.055, 0.628 +- 0.048, 0.602 +- 0.036
Faith. Armon (KL)= 		  =  0.749 +- 0.051, 0.715 +- 0.077, 0.647 +- 0.098, 0.553 +- 0.107, 0.475 +- 0.095
Faith. GMean (KL)= 	  =  0.753 +- 0.047, 0.722 +- 0.066, 0.665 +- 0.078, 0.588 +- 0.081, 0.533 +- 0.071
Computed for split load_split = id



Completed in  0:57:20.561148  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN plain TopoFeature/basis/no_shift NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 17:59:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 05:59:01 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 05:59:01 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 05:59:01 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 05:59:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:59:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:59:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:59:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 05:59:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 05:59:01 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 05:59:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 94 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mChartInfo 0.9560 0.9560 0.9560 0.9560 0.9740 0.9740[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.731
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.794
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.768
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.699
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.648
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.623
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.456
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.333
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.262
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.241
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.782
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.852
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.891
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.909
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.903


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7305703971119133
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.374
SUFF_SIMPLE for r=0.05 class 1.0 = 0.366 +- 0.242 (in-sample avg dev_std = 0.671)
SUFF_SIMPLE for r=0.05 all KL = 0.216 +- 0.242 (in-sample avg dev_std = 0.671)
SUFF_SIMPLE for r=0.05 all L1 = 0.366 +- 0.215 (in-sample avg dev_std = 0.671)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7937942238267147
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.389
SUFF_SIMPLE for r=0.1 class 1.0 = 0.389 +- 0.294 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.1 all KL = 0.255 +- 0.294 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.1 all L1 = 0.389 +- 0.253 (in-sample avg dev_std = 0.623)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7677364620938628
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.354
SUFF_SIMPLE for r=0.2 class 1.0 = 0.377 +- 0.320 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.2 all KL = 0.252 +- 0.320 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.2 all L1 = 0.377 +- 0.272 (in-sample avg dev_std = 0.582)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6989314079422383
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.279
SUFF_SIMPLE for r=0.4 class 1.0 = 0.33 +- 0.323 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.4 all KL = 0.217 +- 0.323 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.4 all L1 = 0.33 +- 0.272 (in-sample avg dev_std = 0.511)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6479602888086643
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.192
SUFF_SIMPLE for r=0.8 class 1.0 = 0.303 +- 0.344 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.8 all KL = 0.216 +- 0.344 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.8 all L1 = 0.303 +- 0.295 (in-sample avg dev_std = 0.167)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.102
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6229849206349206
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.002
SUFF_SIMPLE for r=0.05 class 1.0 = 0.841 +- 0.232 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.05 all KL = 0.874 +- 0.232 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.05 all L1 = 0.841 +- 0.253 (in-sample avg dev_std = 0.052)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.102
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.45610277777777775
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.001
SUFF_SIMPLE for r=0.1 class 1.0 = 0.841 +- 0.232 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.1 all KL = 0.873 +- 0.232 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.1 all L1 = 0.841 +- 0.253 (in-sample avg dev_std = 0.036)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.102
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.33257182539682534
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
SUFF_SIMPLE for r=0.2 class 1.0 = 0.841 +- 0.233 (in-sample avg dev_std = 0.028)
SUFF_SIMPLE for r=0.2 all KL = 0.873 +- 0.233 (in-sample avg dev_std = 0.028)
SUFF_SIMPLE for r=0.2 all L1 = 0.841 +- 0.254 (in-sample avg dev_std = 0.028)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.102
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.26158333333333333
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.841 +- 0.233 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.4 all KL = 0.873 +- 0.233 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.4 all L1 = 0.841 +- 0.254 (in-sample avg dev_std = 0.015)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.102
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.24115833333333336
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.841 +- 0.233 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.873 +- 0.233 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.841 +- 0.254 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.936
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7820214748784441
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.835
SUFF_SIMPLE for r=0.05 class 1.0 = 0.768 +- 0.399 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.05 all KL = 0.709 +- 0.399 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.05 all L1 = 0.768 +- 0.296 (in-sample avg dev_std = 0.393)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.936
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8515162074554294
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.875
SUFF_SIMPLE for r=0.1 class 1.0 = 0.789 +- 0.382 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.1 all KL = 0.744 +- 0.382 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.1 all L1 = 0.789 +- 0.296 (in-sample avg dev_std = 0.326)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.936
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8911324959481361
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.882
SUFF_SIMPLE for r=0.2 class 1.0 = 0.8 +- 0.376 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.2 all KL = 0.765 +- 0.376 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.2 all L1 = 0.8 +- 0.305 (in-sample avg dev_std = 0.240)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.936
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9085854943273907
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.821
SUFF_SIMPLE for r=0.4 class 1.0 = 0.778 +- 0.393 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.4 all KL = 0.761 +- 0.393 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.4 all L1 = 0.778 +- 0.335 (in-sample avg dev_std = 0.163)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.936
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9033411669367909
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.862
SUFF_SIMPLE for r=0.8 class 1.0 = 0.868 +- 0.296 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.8 all KL = 0.873 +- 0.296 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.8 all L1 = 0.868 +- 0.257 (in-sample avg dev_std = 0.017)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7305703971119133
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.155
NEC for r=0.05 class 1.0 = 0.734 +- 0.268 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.836 +- 0.268 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.734 +- 0.229 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7937942238267147
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.124
NEC for r=0.1 class 1.0 = 0.764 +- 0.193 (in-sample avg dev_std = 0.377)
NEC for r=0.1 all KL = 0.882 +- 0.193 (in-sample avg dev_std = 0.377)
NEC for r=0.1 all L1 = 0.764 +- 0.154 (in-sample avg dev_std = 0.377)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7677364620938628
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.383
NEC for r=0.2 class 1.0 = 0.617 +- 0.248 (in-sample avg dev_std = 0.577)
NEC for r=0.2 all KL = 0.745 +- 0.248 (in-sample avg dev_std = 0.577)
NEC for r=0.2 all L1 = 0.617 +- 0.212 (in-sample avg dev_std = 0.577)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6989314079422383
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.574
NEC for r=0.4 class 1.0 = 0.483 +- 0.300 (in-sample avg dev_std = 0.599)
NEC for r=0.4 all KL = 0.593 +- 0.300 (in-sample avg dev_std = 0.599)
NEC for r=0.4 all L1 = 0.483 +- 0.235 (in-sample avg dev_std = 0.599)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6479602888086643
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.657
NEC for r=0.8 class 1.0 = 0.415 +- 0.299 (in-sample avg dev_std = 0.617)
NEC for r=0.8 all KL = 0.521 +- 0.299 (in-sample avg dev_std = 0.617)
NEC for r=0.8 all L1 = 0.415 +- 0.237 (in-sample avg dev_std = 0.617)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.102
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6229849206349206
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.158 +- 0.229 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.124 +- 0.229 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.158 +- 0.253 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.102
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.45610277777777775
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.157 +- 0.227 (in-sample avg dev_std = 0.025)
NEC for r=0.1 all KL = 0.123 +- 0.227 (in-sample avg dev_std = 0.025)
NEC for r=0.1 all L1 = 0.157 +- 0.252 (in-sample avg dev_std = 0.025)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.102
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.33257182539682534
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.026
NEC for r=0.2 class 1.0 = 0.154 +- 0.202 (in-sample avg dev_std = 0.177)
NEC for r=0.2 all KL = 0.118 +- 0.202 (in-sample avg dev_std = 0.177)
NEC for r=0.2 all L1 = 0.154 +- 0.230 (in-sample avg dev_std = 0.177)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.102
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.26158333333333333
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.034
NEC for r=0.4 class 1.0 = 0.147 +- 0.185 (in-sample avg dev_std = 0.199)
NEC for r=0.4 all KL = 0.109 +- 0.185 (in-sample avg dev_std = 0.199)
NEC for r=0.4 all L1 = 0.147 +- 0.219 (in-sample avg dev_std = 0.199)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.102
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.24115833333333336
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.015
NEC for r=0.8 class 1.0 = 0.15 +- 0.203 (in-sample avg dev_std = 0.147)
NEC for r=0.8 all KL = 0.113 +- 0.203 (in-sample avg dev_std = 0.147)
NEC for r=0.8 all L1 = 0.15 +- 0.234 (in-sample avg dev_std = 0.147)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.936
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7820214748784441
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.144
NEC for r=0.05 class 1.0 = 0.683 +- 0.344 (in-sample avg dev_std = 0.165)
NEC for r=0.05 all KL = 0.769 +- 0.344 (in-sample avg dev_std = 0.165)
NEC for r=0.05 all L1 = 0.683 +- 0.291 (in-sample avg dev_std = 0.165)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.936
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8515162074554294
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.237
NEC for r=0.1 class 1.0 = 0.647 +- 0.326 (in-sample avg dev_std = 0.429)
NEC for r=0.1 all KL = 0.743 +- 0.326 (in-sample avg dev_std = 0.429)
NEC for r=0.1 all L1 = 0.647 +- 0.273 (in-sample avg dev_std = 0.429)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.936
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8911324959481361
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.399
NEC for r=0.2 class 1.0 = 0.55 +- 0.343 (in-sample avg dev_std = 0.530)
NEC for r=0.2 all KL = 0.65 +- 0.343 (in-sample avg dev_std = 0.530)
NEC for r=0.2 all L1 = 0.55 +- 0.280 (in-sample avg dev_std = 0.530)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.936
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9085854943273907
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.611
NEC for r=0.4 class 1.0 = 0.387 +- 0.355 (in-sample avg dev_std = 0.526)
NEC for r=0.4 all KL = 0.471 +- 0.355 (in-sample avg dev_std = 0.526)
NEC for r=0.4 all L1 = 0.387 +- 0.280 (in-sample avg dev_std = 0.526)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.936
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9033411669367909
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.812
NEC for r=0.8 class 1.0 = 0.267 +- 0.335 (in-sample avg dev_std = 0.469)
NEC for r=0.8 all KL = 0.339 +- 0.335 (in-sample avg dev_std = 0.469)
NEC for r=0.8 all L1 = 0.267 +- 0.247 (in-sample avg dev_std = 0.469)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 18:04:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 06:04:52 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 06:04:52 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 06:04:52 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 06:04:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:04:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:04:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:04:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:04:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:04:52 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 06:04:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mChartInfo 0.9600 0.9600 0.9600 0.9600 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.677
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.747
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.754
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.733
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.714
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.538
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.413
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.337
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.304
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.298
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.774
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.829
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.865
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.887
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.898


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.989
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6774296028880867
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.309
SUFF_SIMPLE for r=0.05 class 1.0 = 0.324 +- 0.205 (in-sample avg dev_std = 0.633)
SUFF_SIMPLE for r=0.05 all KL = 0.107 +- 0.205 (in-sample avg dev_std = 0.633)
SUFF_SIMPLE for r=0.05 all L1 = 0.324 +- 0.222 (in-sample avg dev_std = 0.633)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.989
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7472924187725631
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.315
SUFF_SIMPLE for r=0.1 class 1.0 = 0.324 +- 0.213 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.1 all KL = 0.108 +- 0.213 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.1 all L1 = 0.324 +- 0.221 (in-sample avg dev_std = 0.642)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.989
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7538953068592057
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.294
SUFF_SIMPLE for r=0.2 class 1.0 = 0.309 +- 0.192 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.2 all KL = 0.094 +- 0.192 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.2 all L1 = 0.309 +- 0.207 (in-sample avg dev_std = 0.646)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7332851985559566
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.259
SUFF_SIMPLE for r=0.4 class 1.0 = 0.285 +- 0.177 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.4 all KL = 0.078 +- 0.177 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.4 all L1 = 0.285 +- 0.194 (in-sample avg dev_std = 0.616)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.989
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7143465703971118
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.286
SUFF_SIMPLE for r=0.8 class 1.0 = 0.367 +- 0.399 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.8 all KL = 0.253 +- 0.399 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.8 all L1 = 0.367 +- 0.348 (in-sample avg dev_std = 0.254)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.157
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5382329365079365
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.017
SUFF_SIMPLE for r=0.05 class 1.0 = 0.81 +- 0.305 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.05 all KL = 0.824 +- 0.305 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.05 all L1 = 0.81 +- 0.290 (in-sample avg dev_std = 0.182)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.157
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4132091269841271
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.015
SUFF_SIMPLE for r=0.1 class 1.0 = 0.809 +- 0.307 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 all KL = 0.823 +- 0.307 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 all L1 = 0.809 +- 0.291 (in-sample avg dev_std = 0.176)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.157
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.33721349206349205
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.01
SUFF_SIMPLE for r=0.2 class 1.0 = 0.809 +- 0.308 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all KL = 0.824 +- 0.308 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all L1 = 0.809 +- 0.293 (in-sample avg dev_std = 0.147)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.157
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3041480158730159
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.004
SUFF_SIMPLE for r=0.4 class 1.0 = 0.809 +- 0.308 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.4 all KL = 0.826 +- 0.308 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.4 all L1 = 0.809 +- 0.296 (in-sample avg dev_std = 0.102)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.157
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2983166666666667
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.809 +- 0.308 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 all KL = 0.828 +- 0.308 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 all L1 = 0.809 +- 0.297 (in-sample avg dev_std = 0.013)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7737374392220421
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.55
SUFF_SIMPLE for r=0.05 class 1.0 = 0.612 +- 0.439 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.05 all KL = 0.386 +- 0.439 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.05 all L1 = 0.612 +- 0.338 (in-sample avg dev_std = 0.555)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8294894651539708
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.561
SUFF_SIMPLE for r=0.1 class 1.0 = 0.635 +- 0.461 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.1 all KL = 0.452 +- 0.461 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.1 all L1 = 0.635 +- 0.354 (in-sample avg dev_std = 0.509)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8646859805510535
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.568
SUFF_SIMPLE for r=0.2 class 1.0 = 0.671 +- 0.471 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.2 all KL = 0.541 +- 0.471 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.2 all L1 = 0.671 +- 0.369 (in-sample avg dev_std = 0.435)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8868650729335494
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.578
SUFF_SIMPLE for r=0.4 class 1.0 = 0.693 +- 0.468 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.4 all KL = 0.603 +- 0.468 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.4 all L1 = 0.693 +- 0.379 (in-sample avg dev_std = 0.349)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.9
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8980008103727714
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.752
SUFF_SIMPLE for r=0.8 class 1.0 = 0.857 +- 0.357 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.8 all KL = 0.832 +- 0.357 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.8 all L1 = 0.857 +- 0.306 (in-sample avg dev_std = 0.061)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.989
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6774296028880867
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.043
NEC for r=0.05 class 1.0 = 0.816 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.955 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.816 +- 0.138 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.989
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7472924187725631
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.068
NEC for r=0.1 class 1.0 = 0.816 +- 0.113 (in-sample avg dev_std = 0.321)
NEC for r=0.1 all KL = 0.965 +- 0.113 (in-sample avg dev_std = 0.321)
NEC for r=0.1 all L1 = 0.816 +- 0.101 (in-sample avg dev_std = 0.321)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.989
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7538953068592057
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.164
NEC for r=0.2 class 1.0 = 0.771 +- 0.127 (in-sample avg dev_std = 0.531)
NEC for r=0.2 all KL = 0.954 +- 0.127 (in-sample avg dev_std = 0.531)
NEC for r=0.2 all L1 = 0.771 +- 0.131 (in-sample avg dev_std = 0.531)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7332851985559566
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.309
NEC for r=0.4 class 1.0 = 0.688 +- 0.155 (in-sample avg dev_std = 0.691)
NEC for r=0.4 all KL = 0.92 +- 0.155 (in-sample avg dev_std = 0.691)
NEC for r=0.4 all L1 = 0.688 +- 0.178 (in-sample avg dev_std = 0.691)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.989
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7143465703971118
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.455
NEC for r=0.8 class 1.0 = 0.592 +- 0.196 (in-sample avg dev_std = 0.734)
NEC for r=0.8 all KL = 0.857 +- 0.196 (in-sample avg dev_std = 0.734)
NEC for r=0.8 all L1 = 0.592 +- 0.215 (in-sample avg dev_std = 0.734)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.157
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5382329365079365
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.008
NEC for r=0.05 class 1.0 = 0.187 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.169 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.187 +- 0.293 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.157
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4132091269841271
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.009
NEC for r=0.1 class 1.0 = 0.188 +- 0.303 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all KL = 0.169 +- 0.303 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all L1 = 0.188 +- 0.291 (in-sample avg dev_std = 0.061)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.157
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.33721349206349205
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.016
NEC for r=0.2 class 1.0 = 0.19 +- 0.305 (in-sample avg dev_std = 0.179)
NEC for r=0.2 all KL = 0.176 +- 0.305 (in-sample avg dev_std = 0.179)
NEC for r=0.2 all L1 = 0.19 +- 0.288 (in-sample avg dev_std = 0.179)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.157
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3041480158730159
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.025
NEC for r=0.4 class 1.0 = 0.189 +- 0.302 (in-sample avg dev_std = 0.218)
NEC for r=0.4 all KL = 0.177 +- 0.302 (in-sample avg dev_std = 0.218)
NEC for r=0.4 all L1 = 0.189 +- 0.283 (in-sample avg dev_std = 0.218)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.157
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2983166666666667
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.025
NEC for r=0.8 class 1.0 = 0.187 +- 0.301 (in-sample avg dev_std = 0.213)
NEC for r=0.8 all KL = 0.175 +- 0.301 (in-sample avg dev_std = 0.213)
NEC for r=0.8 all L1 = 0.187 +- 0.282 (in-sample avg dev_std = 0.213)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7737374392220421
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.054
NEC for r=0.05 class 1.0 = 0.745 +- 0.293 (in-sample avg dev_std = 0.175)
NEC for r=0.05 all KL = 0.889 +- 0.293 (in-sample avg dev_std = 0.175)
NEC for r=0.05 all L1 = 0.745 +- 0.258 (in-sample avg dev_std = 0.175)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8294894651539708
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.136
NEC for r=0.1 class 1.0 = 0.712 +- 0.288 (in-sample avg dev_std = 0.443)
NEC for r=0.1 all KL = 0.892 +- 0.288 (in-sample avg dev_std = 0.443)
NEC for r=0.1 all L1 = 0.712 +- 0.253 (in-sample avg dev_std = 0.443)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8646859805510535
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.263
NEC for r=0.2 class 1.0 = 0.637 +- 0.295 (in-sample avg dev_std = 0.579)
NEC for r=0.2 all KL = 0.873 +- 0.295 (in-sample avg dev_std = 0.579)
NEC for r=0.2 all L1 = 0.637 +- 0.268 (in-sample avg dev_std = 0.579)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8868650729335494
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.415
NEC for r=0.4 class 1.0 = 0.523 +- 0.327 (in-sample avg dev_std = 0.629)
NEC for r=0.4 all KL = 0.806 +- 0.327 (in-sample avg dev_std = 0.629)
NEC for r=0.4 all L1 = 0.523 +- 0.288 (in-sample avg dev_std = 0.629)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8980008103727714
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.54
NEC for r=0.8 class 1.0 = 0.443 +- 0.338 (in-sample avg dev_std = 0.640)
NEC for r=0.8 all KL = 0.749 +- 0.338 (in-sample avg dev_std = 0.640)
NEC for r=0.8 all L1 = 0.443 +- 0.285 (in-sample avg dev_std = 0.640)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 18:10:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 06:10:28 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 06:10:28 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 06:10:28 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 06:10:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:10:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:10:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:10:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:10:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:10:28 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 06:10:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mChartInfo 0.9620 0.9620 0.9620 0.9620 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.726
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.794
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.794
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.768
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.745
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.535
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.391
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.307
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.268
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.261
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.777
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.837
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.877
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.897
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.904


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7260072202166065
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.33
SUFF_SIMPLE for r=0.05 class 1.0 = 0.343 +- 0.216 (in-sample avg dev_std = 0.654)
SUFF_SIMPLE for r=0.05 all KL = 0.152 +- 0.216 (in-sample avg dev_std = 0.654)
SUFF_SIMPLE for r=0.05 all L1 = 0.343 +- 0.212 (in-sample avg dev_std = 0.654)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7935162454873648
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.353
SUFF_SIMPLE for r=0.1 class 1.0 = 0.359 +- 0.221 (in-sample avg dev_std = 0.636)
SUFF_SIMPLE for r=0.1 all KL = 0.169 +- 0.221 (in-sample avg dev_std = 0.636)
SUFF_SIMPLE for r=0.1 all L1 = 0.359 +- 0.227 (in-sample avg dev_std = 0.636)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7935523465703971
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.363
SUFF_SIMPLE for r=0.2 class 1.0 = 0.361 +- 0.206 (in-sample avg dev_std = 0.669)
SUFF_SIMPLE for r=0.2 all KL = 0.155 +- 0.206 (in-sample avg dev_std = 0.669)
SUFF_SIMPLE for r=0.2 all L1 = 0.361 +- 0.215 (in-sample avg dev_std = 0.669)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7679638989169675
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.31
SUFF_SIMPLE for r=0.4 class 1.0 = 0.336 +- 0.258 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.4 all KL = 0.162 +- 0.258 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.4 all L1 = 0.336 +- 0.237 (in-sample avg dev_std = 0.601)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7447906137184116
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.276
SUFF_SIMPLE for r=0.8 class 1.0 = 0.367 +- 0.392 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.8 all KL = 0.267 +- 0.392 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.8 all L1 = 0.367 +- 0.338 (in-sample avg dev_std = 0.262)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.133
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5349789682539682
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.009
SUFF_SIMPLE for r=0.05 class 1.0 = 0.849 +- 0.286 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 all KL = 0.86 +- 0.286 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 all L1 = 0.849 +- 0.275 (in-sample avg dev_std = 0.142)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.133
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.391484126984127
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.005
SUFF_SIMPLE for r=0.1 class 1.0 = 0.848 +- 0.287 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.1 all KL = 0.86 +- 0.287 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.1 all L1 = 0.848 +- 0.278 (in-sample avg dev_std = 0.111)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.133
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3066809523809524
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.005
SUFF_SIMPLE for r=0.2 class 1.0 = 0.847 +- 0.287 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.2 all KL = 0.86 +- 0.287 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.2 all L1 = 0.847 +- 0.278 (in-sample avg dev_std = 0.109)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.133
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2684484126984127
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.002
SUFF_SIMPLE for r=0.4 class 1.0 = 0.847 +- 0.289 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 all KL = 0.859 +- 0.289 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 all L1 = 0.847 +- 0.280 (in-sample avg dev_std = 0.065)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.133
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2607694444444444
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.846 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.859 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.846 +- 0.282 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.916
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7772366288492708
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.629
SUFF_SIMPLE for r=0.05 class 1.0 = 0.714 +- 0.439 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.05 all KL = 0.644 +- 0.439 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.05 all L1 = 0.714 +- 0.362 (in-sample avg dev_std = 0.293)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.916
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8372512155591573
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.646
SUFF_SIMPLE for r=0.1 class 1.0 = 0.728 +- 0.435 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.1 all KL = 0.669 +- 0.435 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.1 all L1 = 0.728 +- 0.360 (in-sample avg dev_std = 0.294)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.916
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8769432739059967
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.648
SUFF_SIMPLE for r=0.2 class 1.0 = 0.729 +- 0.434 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.2 all KL = 0.675 +- 0.434 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.2 all L1 = 0.729 +- 0.365 (in-sample avg dev_std = 0.249)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.916
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8974663695299838
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.644
SUFF_SIMPLE for r=0.4 class 1.0 = 0.729 +- 0.434 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 all KL = 0.676 +- 0.434 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 all L1 = 0.729 +- 0.369 (in-sample avg dev_std = 0.183)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.916
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9035705024311182
len(reference) = 2467
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.808
SUFF_SIMPLE for r=0.8 class 1.0 = 0.869 +- 0.323 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all KL = 0.845 +- 0.323 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all L1 = 0.869 +- 0.274 (in-sample avg dev_std = 0.031)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7260072202166065
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.072
NEC for r=0.05 class 1.0 = 0.793 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.916 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.793 +- 0.165 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7935162454873648
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.063
NEC for r=0.1 class 1.0 = 0.808 +- 0.151 (in-sample avg dev_std = 0.293)
NEC for r=0.1 all KL = 0.937 +- 0.151 (in-sample avg dev_std = 0.293)
NEC for r=0.1 all L1 = 0.808 +- 0.116 (in-sample avg dev_std = 0.293)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7935523465703971
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.144
NEC for r=0.2 class 1.0 = 0.777 +- 0.140 (in-sample avg dev_std = 0.515)
NEC for r=0.2 all KL = 0.932 +- 0.140 (in-sample avg dev_std = 0.515)
NEC for r=0.2 all L1 = 0.777 +- 0.122 (in-sample avg dev_std = 0.515)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7679638989169675
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.301
NEC for r=0.4 class 1.0 = 0.686 +- 0.183 (in-sample avg dev_std = 0.661)
NEC for r=0.4 all KL = 0.875 +- 0.183 (in-sample avg dev_std = 0.661)
NEC for r=0.4 all L1 = 0.686 +- 0.177 (in-sample avg dev_std = 0.661)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7447906137184116
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.447
NEC for r=0.8 class 1.0 = 0.585 +- 0.229 (in-sample avg dev_std = 0.713)
NEC for r=0.8 all KL = 0.793 +- 0.229 (in-sample avg dev_std = 0.713)
NEC for r=0.8 all L1 = 0.585 +- 0.218 (in-sample avg dev_std = 0.713)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.133
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5349789682539682
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.011
NEC for r=0.05 class 1.0 = 0.147 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.132 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.147 +- 0.271 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.133
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.391484126984127
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.026
NEC for r=0.1 class 1.0 = 0.145 +- 0.271 (in-sample avg dev_std = 0.074)
NEC for r=0.1 all KL = 0.129 +- 0.271 (in-sample avg dev_std = 0.074)
NEC for r=0.1 all L1 = 0.145 +- 0.266 (in-sample avg dev_std = 0.074)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.133
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3066809523809524
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.015
NEC for r=0.2 class 1.0 = 0.15 +- 0.282 (in-sample avg dev_std = 0.170)
NEC for r=0.2 all KL = 0.14 +- 0.282 (in-sample avg dev_std = 0.170)
NEC for r=0.2 all L1 = 0.15 +- 0.271 (in-sample avg dev_std = 0.170)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.133
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2684484126984127
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.025
NEC for r=0.4 class 1.0 = 0.147 +- 0.276 (in-sample avg dev_std = 0.208)
NEC for r=0.4 all KL = 0.137 +- 0.276 (in-sample avg dev_std = 0.208)
NEC for r=0.4 all L1 = 0.147 +- 0.263 (in-sample avg dev_std = 0.208)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.133
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2607694444444444
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.026
NEC for r=0.8 class 1.0 = 0.146 +- 0.274 (in-sample avg dev_std = 0.211)
NEC for r=0.8 all KL = 0.135 +- 0.274 (in-sample avg dev_std = 0.211)
NEC for r=0.8 all L1 = 0.146 +- 0.261 (in-sample avg dev_std = 0.211)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.916
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7772366288492708
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.08
NEC for r=0.05 class 1.0 = 0.73 +- 0.322 (in-sample avg dev_std = 0.203)
NEC for r=0.05 all KL = 0.858 +- 0.322 (in-sample avg dev_std = 0.203)
NEC for r=0.05 all L1 = 0.73 +- 0.268 (in-sample avg dev_std = 0.203)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.916
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8372512155591573
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.142
NEC for r=0.1 class 1.0 = 0.712 +- 0.305 (in-sample avg dev_std = 0.410)
NEC for r=0.1 all KL = 0.869 +- 0.305 (in-sample avg dev_std = 0.410)
NEC for r=0.1 all L1 = 0.712 +- 0.260 (in-sample avg dev_std = 0.410)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.916
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8769432739059967
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.288
NEC for r=0.2 class 1.0 = 0.636 +- 0.300 (in-sample avg dev_std = 0.547)
NEC for r=0.2 all KL = 0.842 +- 0.300 (in-sample avg dev_std = 0.547)
NEC for r=0.2 all L1 = 0.636 +- 0.273 (in-sample avg dev_std = 0.547)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.916
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8974663695299838
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.438
NEC for r=0.4 class 1.0 = 0.519 +- 0.344 (in-sample avg dev_std = 0.584)
NEC for r=0.4 all KL = 0.742 +- 0.344 (in-sample avg dev_std = 0.584)
NEC for r=0.4 all L1 = 0.519 +- 0.301 (in-sample avg dev_std = 0.584)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.916
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9035705024311182
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.59
NEC for r=0.8 class 1.0 = 0.406 +- 0.364 (in-sample avg dev_std = 0.595)
NEC for r=0.8 all KL = 0.622 +- 0.364 (in-sample avg dev_std = 0.595)
NEC for r=0.8 all L1 = 0.406 +- 0.296 (in-sample avg dev_std = 0.595)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 18:16:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 06:16:00 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 06:16:00 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 06:16:00 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 06:16:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:16:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:16:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:16:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:16:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:16:00 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 06:16:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mChartInfo 0.9440 0.9440 0.9440 0.9440 0.9680 0.9680[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.761
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.795
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.766
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.722
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.694
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.526
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.364
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.261
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.211
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.200
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.790
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.840
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.867
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.884
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.895


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7611263537906137
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.282
SUFF_SIMPLE for r=0.05 class 1.0 = 0.299 +- 0.186 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.05 all KL = 0.135 +- 0.186 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.05 all L1 = 0.299 +- 0.181 (in-sample avg dev_std = 0.612)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.795043321299639
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.273
SUFF_SIMPLE for r=0.1 class 1.0 = 0.301 +- 0.211 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.1 all KL = 0.147 +- 0.211 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.1 all L1 = 0.301 +- 0.197 (in-sample avg dev_std = 0.574)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7663176895306859
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.259
SUFF_SIMPLE for r=0.2 class 1.0 = 0.293 +- 0.193 (in-sample avg dev_std = 0.575)
SUFF_SIMPLE for r=0.2 all KL = 0.135 +- 0.193 (in-sample avg dev_std = 0.575)
SUFF_SIMPLE for r=0.2 all L1 = 0.293 +- 0.188 (in-sample avg dev_std = 0.575)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7223032490974728
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.201
SUFF_SIMPLE for r=0.4 class 1.0 = 0.262 +- 0.192 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.4 all KL = 0.114 +- 0.192 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.4 all L1 = 0.262 +- 0.179 (in-sample avg dev_std = 0.518)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6939314079422383
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.285
SUFF_SIMPLE for r=0.8 class 1.0 = 0.363 +- 0.375 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.8 all KL = 0.262 +- 0.375 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.8 all L1 = 0.363 +- 0.323 (in-sample avg dev_std = 0.262)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.082
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5261436507936508
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
SUFF_SIMPLE for r=0.05 class 1.0 = 0.889 +- 0.224 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.05 all KL = 0.907 +- 0.224 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.05 all L1 = 0.889 +- 0.233 (in-sample avg dev_std = 0.020)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.082
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3638369047619048
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
SUFF_SIMPLE for r=0.1 class 1.0 = 0.889 +- 0.224 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.1 all KL = 0.907 +- 0.224 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.1 all L1 = 0.889 +- 0.233 (in-sample avg dev_std = 0.015)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.082
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26057063492063487
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
SUFF_SIMPLE for r=0.2 class 1.0 = 0.889 +- 0.224 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.2 all KL = 0.907 +- 0.224 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.2 all L1 = 0.889 +- 0.233 (in-sample avg dev_std = 0.016)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.082
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.21059166666666668
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.889 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.907 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.889 +- 0.233 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.082
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.20013928571428571
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.889 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.907 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.889 +- 0.233 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.889
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7903650729335495
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.585
SUFF_SIMPLE for r=0.05 class 1.0 = 0.582 +- 0.392 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.05 all KL = 0.429 +- 0.392 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.05 all L1 = 0.582 +- 0.325 (in-sample avg dev_std = 0.595)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.889
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8395352512155592
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.561
SUFF_SIMPLE for r=0.1 class 1.0 = 0.599 +- 0.410 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.1 all KL = 0.467 +- 0.410 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.1 all L1 = 0.599 +- 0.340 (in-sample avg dev_std = 0.551)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.889
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8665384927066452
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.532
SUFF_SIMPLE for r=0.2 class 1.0 = 0.628 +- 0.425 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.2 all KL = 0.521 +- 0.425 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.2 all L1 = 0.628 +- 0.354 (in-sample avg dev_std = 0.504)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.889
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8838942463533226
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.529
SUFF_SIMPLE for r=0.4 class 1.0 = 0.633 +- 0.434 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.4 all KL = 0.535 +- 0.434 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.4 all L1 = 0.633 +- 0.361 (in-sample avg dev_std = 0.488)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.892
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.895316450567261
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.671
SUFF_SIMPLE for r=0.8 class 1.0 = 0.792 +- 0.409 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.8 all KL = 0.764 +- 0.409 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.8 all L1 = 0.792 +- 0.352 (in-sample avg dev_std = 0.136)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7611263537906137
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.029
NEC for r=0.05 class 1.0 = 0.812 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.933 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.812 +- 0.131 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.795043321299639
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.019
NEC for r=0.1 class 1.0 = 0.824 +- 0.126 (in-sample avg dev_std = 0.141)
NEC for r=0.1 all KL = 0.948 +- 0.126 (in-sample avg dev_std = 0.141)
NEC for r=0.1 all L1 = 0.824 +- 0.087 (in-sample avg dev_std = 0.141)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7663176895306859
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.076
NEC for r=0.2 class 1.0 = 0.804 +- 0.138 (in-sample avg dev_std = 0.409)
NEC for r=0.2 all KL = 0.937 +- 0.138 (in-sample avg dev_std = 0.409)
NEC for r=0.2 all L1 = 0.804 +- 0.102 (in-sample avg dev_std = 0.409)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7223032490974728
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.222
NEC for r=0.4 class 1.0 = 0.736 +- 0.176 (in-sample avg dev_std = 0.647)
NEC for r=0.4 all KL = 0.897 +- 0.176 (in-sample avg dev_std = 0.647)
NEC for r=0.4 all L1 = 0.736 +- 0.143 (in-sample avg dev_std = 0.647)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6939314079422383
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.377
NEC for r=0.8 class 1.0 = 0.646 +- 0.195 (in-sample avg dev_std = 0.760)
NEC for r=0.8 all KL = 0.838 +- 0.195 (in-sample avg dev_std = 0.760)
NEC for r=0.8 all L1 = 0.646 +- 0.172 (in-sample avg dev_std = 0.760)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.082
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5261436507936508
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.11 +- 0.220 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.091 +- 0.220 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.11 +- 0.231 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.082
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3638369047619048
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.109 +- 0.216 (in-sample avg dev_std = 0.012)
NEC for r=0.1 all KL = 0.088 +- 0.216 (in-sample avg dev_std = 0.012)
NEC for r=0.1 all L1 = 0.109 +- 0.229 (in-sample avg dev_std = 0.012)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.082
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26057063492063487
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.002
NEC for r=0.2 class 1.0 = 0.11 +- 0.222 (in-sample avg dev_std = 0.055)
NEC for r=0.2 all KL = 0.092 +- 0.222 (in-sample avg dev_std = 0.055)
NEC for r=0.2 all L1 = 0.11 +- 0.231 (in-sample avg dev_std = 0.055)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.082
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.21059166666666668
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.005
NEC for r=0.4 class 1.0 = 0.108 +- 0.218 (in-sample avg dev_std = 0.100)
NEC for r=0.4 all KL = 0.091 +- 0.218 (in-sample avg dev_std = 0.100)
NEC for r=0.4 all L1 = 0.108 +- 0.227 (in-sample avg dev_std = 0.100)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.082
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.20013928571428571
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.005
NEC for r=0.8 class 1.0 = 0.108 +- 0.214 (in-sample avg dev_std = 0.097)
NEC for r=0.8 all KL = 0.089 +- 0.214 (in-sample avg dev_std = 0.097)
NEC for r=0.8 all L1 = 0.108 +- 0.225 (in-sample avg dev_std = 0.097)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.889
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7903650729335495
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.044
NEC for r=0.05 class 1.0 = 0.732 +- 0.313 (in-sample avg dev_std = 0.117)
NEC for r=0.05 all KL = 0.854 +- 0.313 (in-sample avg dev_std = 0.117)
NEC for r=0.05 all L1 = 0.732 +- 0.270 (in-sample avg dev_std = 0.117)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.889
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8395352512155592
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.059
NEC for r=0.1 class 1.0 = 0.729 +- 0.302 (in-sample avg dev_std = 0.311)
NEC for r=0.1 all KL = 0.858 +- 0.302 (in-sample avg dev_std = 0.311)
NEC for r=0.1 all L1 = 0.729 +- 0.259 (in-sample avg dev_std = 0.311)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.889
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8665384927066452
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.136
NEC for r=0.2 class 1.0 = 0.689 +- 0.303 (in-sample avg dev_std = 0.483)
NEC for r=0.2 all KL = 0.83 +- 0.303 (in-sample avg dev_std = 0.483)
NEC for r=0.2 all L1 = 0.689 +- 0.262 (in-sample avg dev_std = 0.483)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.889
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8838942463533226
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.293
NEC for r=0.4 class 1.0 = 0.591 +- 0.335 (in-sample avg dev_std = 0.615)
NEC for r=0.4 all KL = 0.744 +- 0.335 (in-sample avg dev_std = 0.615)
NEC for r=0.4 all L1 = 0.591 +- 0.287 (in-sample avg dev_std = 0.615)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.889
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.895316450567261
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.439
NEC for r=0.8 class 1.0 = 0.538 +- 0.301 (in-sample avg dev_std = 0.713)
NEC for r=0.8 all KL = 0.725 +- 0.301 (in-sample avg dev_std = 0.713)
NEC for r=0.8 all L1 = 0.538 +- 0.259 (in-sample avg dev_std = 0.713)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 18:21:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 06:21:38 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 06:21:38 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 06:21:38 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 06:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:21:38 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 06:21:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mChartInfo 0.9500 0.9500 0.9500 0.9500 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.712
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.783
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.779
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.752
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.730
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.572
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.434
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.350
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.314
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.308
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.772
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.825
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.860
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.880
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.896


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7116606498194946
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.251
SUFF_SIMPLE for r=0.05 class 1.0 = 0.276 +- 0.158 (in-sample avg dev_std = 0.634)
SUFF_SIMPLE for r=0.05 all KL = 0.115 +- 0.158 (in-sample avg dev_std = 0.634)
SUFF_SIMPLE for r=0.05 all L1 = 0.276 +- 0.157 (in-sample avg dev_std = 0.634)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7827003610108303
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.272
SUFF_SIMPLE for r=0.1 class 1.0 = 0.288 +- 0.158 (in-sample avg dev_std = 0.657)
SUFF_SIMPLE for r=0.1 all KL = 0.12 +- 0.158 (in-sample avg dev_std = 0.657)
SUFF_SIMPLE for r=0.1 all L1 = 0.288 +- 0.153 (in-sample avg dev_std = 0.657)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7794079422382671
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.267
SUFF_SIMPLE for r=0.2 class 1.0 = 0.288 +- 0.168 (in-sample avg dev_std = 0.641)
SUFF_SIMPLE for r=0.2 all KL = 0.123 +- 0.168 (in-sample avg dev_std = 0.641)
SUFF_SIMPLE for r=0.2 all L1 = 0.288 +- 0.163 (in-sample avg dev_std = 0.641)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7522454873646209
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.193
SUFF_SIMPLE for r=0.4 class 1.0 = 0.248 +- 0.163 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.4 all KL = 0.101 +- 0.163 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.4 all L1 = 0.248 +- 0.153 (in-sample avg dev_std = 0.554)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7304837545126354
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.236
SUFF_SIMPLE for r=0.8 class 1.0 = 0.329 +- 0.365 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.8 all KL = 0.234 +- 0.365 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.8 all L1 = 0.329 +- 0.312 (in-sample avg dev_std = 0.252)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.126
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.571809126984127
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
SUFF_SIMPLE for r=0.05 class 1.0 = 0.823 +- 0.258 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.05 all KL = 0.854 +- 0.258 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.05 all L1 = 0.823 +- 0.269 (in-sample avg dev_std = 0.033)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.126
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.433838492063492
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
SUFF_SIMPLE for r=0.1 class 1.0 = 0.823 +- 0.259 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.1 all KL = 0.854 +- 0.259 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.1 all L1 = 0.823 +- 0.269 (in-sample avg dev_std = 0.022)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.126
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3500595238095238
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
SUFF_SIMPLE for r=0.2 class 1.0 = 0.823 +- 0.259 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.2 all KL = 0.854 +- 0.259 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.2 all L1 = 0.823 +- 0.269 (in-sample avg dev_std = 0.025)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.126
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.314218253968254
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.823 +- 0.259 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all KL = 0.854 +- 0.259 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all L1 = 0.823 +- 0.269 (in-sample avg dev_std = 0.001)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.126
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.30808214285714286
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.823 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.854 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.823 +- 0.269 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7716114262560778
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.611
SUFF_SIMPLE for r=0.05 class 1.0 = 0.606 +- 0.429 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.05 all KL = 0.494 +- 0.429 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.05 all L1 = 0.606 +- 0.335 (in-sample avg dev_std = 0.505)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.825064829821718
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.601
SUFF_SIMPLE for r=0.1 class 1.0 = 0.647 +- 0.435 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.1 all KL = 0.564 +- 0.435 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.1 all L1 = 0.647 +- 0.347 (in-sample avg dev_std = 0.445)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8598087520259319
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.588
SUFF_SIMPLE for r=0.2 class 1.0 = 0.692 +- 0.433 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.2 all KL = 0.642 +- 0.433 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.2 all L1 = 0.692 +- 0.357 (in-sample avg dev_std = 0.345)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8798156401944895
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.599
SUFF_SIMPLE for r=0.4 class 1.0 = 0.708 +- 0.432 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.4 all KL = 0.667 +- 0.432 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.4 all L1 = 0.708 +- 0.359 (in-sample avg dev_std = 0.288)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.885
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8958541329011345
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.748
SUFF_SIMPLE for r=0.8 class 1.0 = 0.851 +- 0.337 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.8 all KL = 0.846 +- 0.337 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.8 all L1 = 0.851 +- 0.293 (in-sample avg dev_std = 0.036)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7116606498194946
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.007
NEC for r=0.05 class 1.0 = 0.831 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.943 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.831 +- 0.085 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7827003610108303
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.029
NEC for r=0.1 class 1.0 = 0.823 +- 0.119 (in-sample avg dev_std = 0.157)
NEC for r=0.1 all KL = 0.943 +- 0.119 (in-sample avg dev_std = 0.157)
NEC for r=0.1 all L1 = 0.823 +- 0.087 (in-sample avg dev_std = 0.157)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7794079422382671
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.064
NEC for r=0.2 class 1.0 = 0.81 +- 0.144 (in-sample avg dev_std = 0.351)
NEC for r=0.2 all KL = 0.934 +- 0.144 (in-sample avg dev_std = 0.351)
NEC for r=0.2 all L1 = 0.81 +- 0.106 (in-sample avg dev_std = 0.351)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7522454873646209
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.176
NEC for r=0.4 class 1.0 = 0.763 +- 0.145 (in-sample avg dev_std = 0.597)
NEC for r=0.4 all KL = 0.917 +- 0.145 (in-sample avg dev_std = 0.597)
NEC for r=0.4 all L1 = 0.763 +- 0.117 (in-sample avg dev_std = 0.597)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7304837545126354
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.344
NEC for r=0.8 class 1.0 = 0.672 +- 0.191 (in-sample avg dev_std = 0.746)
NEC for r=0.8 all KL = 0.847 +- 0.191 (in-sample avg dev_std = 0.746)
NEC for r=0.8 all L1 = 0.672 +- 0.170 (in-sample avg dev_std = 0.746)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.126
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.571809126984127
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.001
NEC for r=0.05 class 1.0 = 0.175 +- 0.253 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.141 +- 0.253 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.175 +- 0.266 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.126
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.433838492063492
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.001
NEC for r=0.1 class 1.0 = 0.174 +- 0.251 (in-sample avg dev_std = 0.028)
NEC for r=0.1 all KL = 0.14 +- 0.251 (in-sample avg dev_std = 0.028)
NEC for r=0.1 all L1 = 0.174 +- 0.265 (in-sample avg dev_std = 0.028)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.126
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3500595238095238
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.002
NEC for r=0.2 class 1.0 = 0.176 +- 0.257 (in-sample avg dev_std = 0.063)
NEC for r=0.2 all KL = 0.145 +- 0.257 (in-sample avg dev_std = 0.063)
NEC for r=0.2 all L1 = 0.176 +- 0.268 (in-sample avg dev_std = 0.063)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.126
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.314218253968254
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.005
NEC for r=0.4 class 1.0 = 0.175 +- 0.254 (in-sample avg dev_std = 0.103)
NEC for r=0.4 all KL = 0.144 +- 0.254 (in-sample avg dev_std = 0.103)
NEC for r=0.4 all L1 = 0.175 +- 0.265 (in-sample avg dev_std = 0.103)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.126
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.30808214285714286
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.007
NEC for r=0.8 class 1.0 = 0.174 +- 0.251 (in-sample avg dev_std = 0.120)
NEC for r=0.8 all KL = 0.143 +- 0.251 (in-sample avg dev_std = 0.120)
NEC for r=0.8 all L1 = 0.174 +- 0.262 (in-sample avg dev_std = 0.120)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7716114262560778
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.054
NEC for r=0.05 class 1.0 = 0.729 +- 0.302 (in-sample avg dev_std = 0.078)
NEC for r=0.05 all KL = 0.842 +- 0.302 (in-sample avg dev_std = 0.078)
NEC for r=0.05 all L1 = 0.729 +- 0.273 (in-sample avg dev_std = 0.078)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.825064829821718
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.067
NEC for r=0.1 class 1.0 = 0.728 +- 0.297 (in-sample avg dev_std = 0.242)
NEC for r=0.1 all KL = 0.848 +- 0.297 (in-sample avg dev_std = 0.242)
NEC for r=0.1 all L1 = 0.728 +- 0.269 (in-sample avg dev_std = 0.242)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8598087520259319
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.136
NEC for r=0.2 class 1.0 = 0.696 +- 0.306 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all KL = 0.822 +- 0.306 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all L1 = 0.696 +- 0.273 (in-sample avg dev_std = 0.450)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8798156401944895
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.282
NEC for r=0.4 class 1.0 = 0.626 +- 0.327 (in-sample avg dev_std = 0.627)
NEC for r=0.4 all KL = 0.767 +- 0.327 (in-sample avg dev_std = 0.627)
NEC for r=0.4 all L1 = 0.626 +- 0.278 (in-sample avg dev_std = 0.627)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.883
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8958541329011345
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.45
NEC for r=0.8 class 1.0 = 0.554 +- 0.322 (in-sample avg dev_std = 0.736)
NEC for r=0.8 all KL = 0.734 +- 0.322 (in-sample avg dev_std = 0.736)
NEC for r=0.8 all L1 = 0.554 +- 0.265 (in-sample avg dev_std = 0.736)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 18:27:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 06:27:18 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 06:27:18 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 06:27:18 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 06:27:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:27:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:27:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:27:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:27:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:27:18 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 06:27:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mChartInfo 0.9460 0.9460 0.9460 0.9460 0.9560 0.9560[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.709
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.707
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.613
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.508
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.442
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.441
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.272
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.167
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.111
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.092
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.749
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.792
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.813
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.827
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.838


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.971
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7093465703971118
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.067
SUFF_SIMPLE for r=0.05 class 1.0 = 0.194 +- 0.135 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.05 all KL = 0.096 +- 0.135 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.05 all L1 = 0.194 +- 0.085 (in-sample avg dev_std = 0.386)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.971
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7065270758122745
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.067
SUFF_SIMPLE for r=0.1 class 1.0 = 0.195 +- 0.139 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.1 all KL = 0.1 +- 0.139 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.1 all L1 = 0.195 +- 0.089 (in-sample avg dev_std = 0.381)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.971
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6131227436823103
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.116
SUFF_SIMPLE for r=0.2 class 1.0 = 0.226 +- 0.198 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.2 all KL = 0.133 +- 0.198 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.2 all L1 = 0.226 +- 0.156 (in-sample avg dev_std = 0.404)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.971
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5076064981949457
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.068
SUFF_SIMPLE for r=0.4 class 1.0 = 0.207 +- 0.193 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.4 all KL = 0.118 +- 0.193 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.4 all L1 = 0.207 +- 0.147 (in-sample avg dev_std = 0.308)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.971
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.4418880866425993
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.074
SUFF_SIMPLE for r=0.8 class 1.0 = 0.225 +- 0.259 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.8 all KL = 0.148 +- 0.259 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.8 all L1 = 0.225 +- 0.213 (in-sample avg dev_std = 0.055)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.034
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.440875
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.937 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.034
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.27219365079365077
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.937 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.91 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.034
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.16720793650793653
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.937 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.91 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.034
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11055158730158729
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.937 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.91 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.034
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09234603174603175
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.937 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.177 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.865
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7488812803889789
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.607
SUFF_SIMPLE for r=0.05 class 1.0 = 0.711 +- 0.445 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.05 all KL = 0.643 +- 0.445 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.05 all L1 = 0.711 +- 0.358 (in-sample avg dev_std = 0.263)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.865
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7921794975688817
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.623
SUFF_SIMPLE for r=0.1 class 1.0 = 0.733 +- 0.435 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.1 all KL = 0.681 +- 0.435 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.1 all L1 = 0.733 +- 0.357 (in-sample avg dev_std = 0.236)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.865
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8125721231766612
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.624
SUFF_SIMPLE for r=0.2 class 1.0 = 0.751 +- 0.417 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.2 all KL = 0.724 +- 0.417 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.2 all L1 = 0.751 +- 0.358 (in-sample avg dev_std = 0.181)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.865
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8265968395461912
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.615
SUFF_SIMPLE for r=0.4 class 1.0 = 0.75 +- 0.418 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.4 all KL = 0.727 +- 0.418 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.4 all L1 = 0.75 +- 0.362 (in-sample avg dev_std = 0.155)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.868
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.837620340356564
len(reference) = 2455
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.734
SUFF_SIMPLE for r=0.8 class 1.0 = 0.857 +- 0.329 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.8 all KL = 0.855 +- 0.329 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.8 all L1 = 0.857 +- 0.290 (in-sample avg dev_std = 0.011)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.971
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7093465703971118
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.043
NEC for r=0.05 class 1.0 = 0.801 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.887 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.801 +- 0.139 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.971
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7065270758122745
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.001
NEC for r=0.1 class 1.0 = 0.827 +- 0.133 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all KL = 0.915 +- 0.133 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all L1 = 0.827 +- 0.074 (in-sample avg dev_std = 0.075)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.971
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6131227436823103
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.022
NEC for r=0.2 class 1.0 = 0.82 +- 0.139 (in-sample avg dev_std = 0.241)
NEC for r=0.2 all KL = 0.91 +- 0.139 (in-sample avg dev_std = 0.241)
NEC for r=0.2 all L1 = 0.82 +- 0.077 (in-sample avg dev_std = 0.241)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.971
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5076064981949457
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.088
NEC for r=0.4 class 1.0 = 0.793 +- 0.143 (in-sample avg dev_std = 0.448)
NEC for r=0.4 all KL = 0.894 +- 0.143 (in-sample avg dev_std = 0.448)
NEC for r=0.4 all L1 = 0.793 +- 0.092 (in-sample avg dev_std = 0.448)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.971
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.4418880866425993
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.196
NEC for r=0.8 class 1.0 = 0.744 +- 0.162 (in-sample avg dev_std = 0.592)
NEC for r=0.8 all KL = 0.853 +- 0.162 (in-sample avg dev_std = 0.592)
NEC for r=0.8 all L1 = 0.744 +- 0.121 (in-sample avg dev_std = 0.592)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.034
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.440875
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.09 +- 0.141 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.062 +- 0.141 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.09 +- 0.176 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.034
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.27219365079365077
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.09 +- 0.141 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.062 +- 0.141 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.09 +- 0.176 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.034
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.16720793650793653
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
NEC for r=0.2 class 1.0 = 0.09 +- 0.143 (in-sample avg dev_std = 0.006)
NEC for r=0.2 all KL = 0.063 +- 0.143 (in-sample avg dev_std = 0.006)
NEC for r=0.2 all L1 = 0.09 +- 0.176 (in-sample avg dev_std = 0.006)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.034
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11055158730158729
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.09 +- 0.142 (in-sample avg dev_std = 0.009)
NEC for r=0.4 all KL = 0.063 +- 0.142 (in-sample avg dev_std = 0.009)
NEC for r=0.4 all L1 = 0.09 +- 0.176 (in-sample avg dev_std = 0.009)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.034
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09234603174603175
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.09 +- 0.142 (in-sample avg dev_std = 0.009)
NEC for r=0.8 all KL = 0.063 +- 0.142 (in-sample avg dev_std = 0.009)
NEC for r=0.8 all L1 = 0.09 +- 0.176 (in-sample avg dev_std = 0.009)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.865
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7488812803889789
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.094
NEC for r=0.05 class 1.0 = 0.732 +- 0.315 (in-sample avg dev_std = 0.029)
NEC for r=0.05 all KL = 0.83 +- 0.315 (in-sample avg dev_std = 0.029)
NEC for r=0.05 all L1 = 0.732 +- 0.271 (in-sample avg dev_std = 0.029)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.865
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7921794975688817
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.076
NEC for r=0.1 class 1.0 = 0.751 +- 0.293 (in-sample avg dev_std = 0.217)
NEC for r=0.1 all KL = 0.853 +- 0.293 (in-sample avg dev_std = 0.217)
NEC for r=0.1 all L1 = 0.751 +- 0.249 (in-sample avg dev_std = 0.217)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.865
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8125721231766612
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.12
NEC for r=0.2 class 1.0 = 0.71 +- 0.301 (in-sample avg dev_std = 0.494)
NEC for r=0.2 all KL = 0.826 +- 0.301 (in-sample avg dev_std = 0.494)
NEC for r=0.2 all L1 = 0.71 +- 0.257 (in-sample avg dev_std = 0.494)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.865
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8265968395461912
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.264
NEC for r=0.4 class 1.0 = 0.619 +- 0.311 (in-sample avg dev_std = 0.662)
NEC for r=0.4 all KL = 0.755 +- 0.311 (in-sample avg dev_std = 0.662)
NEC for r=0.4 all L1 = 0.619 +- 0.271 (in-sample avg dev_std = 0.662)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.865
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.837620340356564
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.471
NEC for r=0.8 class 1.0 = 0.501 +- 0.316 (in-sample avg dev_std = 0.705)
NEC for r=0.8 all KL = 0.662 +- 0.316 (in-sample avg dev_std = 0.705)
NEC for r=0.8 all L1 = 0.501 +- 0.271 (in-sample avg dev_std = 0.705)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 18:33:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 06:33:09 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 06:33:09 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 06:33:09 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 06:33:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:33:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:33:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:33:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:33:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:33:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 06:33:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mChartInfo 0.9660 0.9660 0.9660 0.9660 0.9720 0.9720[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.745
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.794
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.773
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.730
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.700
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.521
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.364
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.269
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.224
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.213
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.750
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.816
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.854
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.876
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.881


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7449927797833935
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.292
SUFF_SIMPLE for r=0.05 class 1.0 = 0.315 +- 0.212 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.05 all KL = 0.174 +- 0.212 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.05 all L1 = 0.315 +- 0.196 (in-sample avg dev_std = 0.566)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7939638989169675
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.313
SUFF_SIMPLE for r=0.1 class 1.0 = 0.326 +- 0.203 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.1 all KL = 0.176 +- 0.203 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.1 all L1 = 0.326 +- 0.193 (in-sample avg dev_std = 0.602)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7727148014440433
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.323
SUFF_SIMPLE for r=0.2 class 1.0 = 0.328 +- 0.223 (in-sample avg dev_std = 0.610)
SUFF_SIMPLE for r=0.2 all KL = 0.178 +- 0.223 (in-sample avg dev_std = 0.610)
SUFF_SIMPLE for r=0.2 all L1 = 0.328 +- 0.201 (in-sample avg dev_std = 0.610)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.729985559566787
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.258
SUFF_SIMPLE for r=0.4 class 1.0 = 0.29 +- 0.199 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.4 all KL = 0.148 +- 0.199 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.4 all L1 = 0.29 +- 0.186 (in-sample avg dev_std = 0.535)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7001552346570397
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.237
SUFF_SIMPLE for r=0.8 class 1.0 = 0.338 +- 0.377 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.8 all KL = 0.253 +- 0.377 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.8 all L1 = 0.338 +- 0.320 (in-sample avg dev_std = 0.216)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.059
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5207976190476191
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.187 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.05 all KL = 0.928 +- 0.187 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.205 (in-sample avg dev_std = 0.021)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.059
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3642964285714286
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.187 (in-sample avg dev_std = 0.028)
SUFF_SIMPLE for r=0.1 all KL = 0.928 +- 0.187 (in-sample avg dev_std = 0.028)
SUFF_SIMPLE for r=0.1 all L1 = 0.91 +- 0.205 (in-sample avg dev_std = 0.028)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.059
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26864404761904764
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.187 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 all KL = 0.928 +- 0.187 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 all L1 = 0.91 +- 0.205 (in-sample avg dev_std = 0.014)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.059
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.22398849206349208
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.928 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.91 +- 0.205 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.059
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.21262261904761903
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.928 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.205 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.917
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7500498379254458
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.625
SUFF_SIMPLE for r=0.05 class 1.0 = 0.726 +- 0.441 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.05 all KL = 0.683 +- 0.441 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.05 all L1 = 0.726 +- 0.379 (in-sample avg dev_std = 0.210)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.917
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8163452188006483
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.643
SUFF_SIMPLE for r=0.1 class 1.0 = 0.736 +- 0.437 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.1 all KL = 0.695 +- 0.437 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.1 all L1 = 0.736 +- 0.373 (in-sample avg dev_std = 0.224)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.917
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8543756077795787
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.65
SUFF_SIMPLE for r=0.2 class 1.0 = 0.732 +- 0.438 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all KL = 0.691 +- 0.438 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all L1 = 0.732 +- 0.375 (in-sample avg dev_std = 0.202)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.917
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8756555915721231
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.639
SUFF_SIMPLE for r=0.4 class 1.0 = 0.731 +- 0.440 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.4 all KL = 0.688 +- 0.440 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.4 all L1 = 0.731 +- 0.378 (in-sample avg dev_std = 0.163)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.917
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8811969205834683
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.789
SUFF_SIMPLE for r=0.8 class 1.0 = 0.868 +- 0.333 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.8 all KL = 0.854 +- 0.333 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.8 all L1 = 0.868 +- 0.289 (in-sample avg dev_std = 0.006)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7449927797833935
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.018
NEC for r=0.05 class 1.0 = 0.823 +- 0.141 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.937 +- 0.141 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.823 +- 0.104 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7939638989169675
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.022
NEC for r=0.1 class 1.0 = 0.82 +- 0.142 (in-sample avg dev_std = 0.133)
NEC for r=0.1 all KL = 0.936 +- 0.142 (in-sample avg dev_std = 0.133)
NEC for r=0.1 all L1 = 0.82 +- 0.105 (in-sample avg dev_std = 0.133)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7727148014440433
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.076
NEC for r=0.2 class 1.0 = 0.799 +- 0.157 (in-sample avg dev_std = 0.401)
NEC for r=0.2 all KL = 0.922 +- 0.157 (in-sample avg dev_std = 0.401)
NEC for r=0.2 all L1 = 0.799 +- 0.115 (in-sample avg dev_std = 0.401)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.729985559566787
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.208
NEC for r=0.4 class 1.0 = 0.739 +- 0.168 (in-sample avg dev_std = 0.623)
NEC for r=0.4 all KL = 0.886 +- 0.168 (in-sample avg dev_std = 0.623)
NEC for r=0.4 all L1 = 0.739 +- 0.135 (in-sample avg dev_std = 0.623)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7001552346570397
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.375
NEC for r=0.8 class 1.0 = 0.646 +- 0.200 (in-sample avg dev_std = 0.720)
NEC for r=0.8 all KL = 0.813 +- 0.200 (in-sample avg dev_std = 0.720)
NEC for r=0.8 all L1 = 0.646 +- 0.166 (in-sample avg dev_std = 0.720)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.059
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5207976190476191
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.09 +- 0.185 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.071 +- 0.185 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.09 +- 0.205 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.059
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3642964285714286
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.001
NEC for r=0.1 class 1.0 = 0.09 +- 0.185 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all KL = 0.071 +- 0.185 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all L1 = 0.09 +- 0.204 (in-sample avg dev_std = 0.015)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.059
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26864404761904764
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.001
NEC for r=0.2 class 1.0 = 0.09 +- 0.186 (in-sample avg dev_std = 0.033)
NEC for r=0.2 all KL = 0.072 +- 0.186 (in-sample avg dev_std = 0.033)
NEC for r=0.2 all L1 = 0.09 +- 0.205 (in-sample avg dev_std = 0.033)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.059
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.22398849206349208
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.001
NEC for r=0.4 class 1.0 = 0.09 +- 0.184 (in-sample avg dev_std = 0.049)
NEC for r=0.4 all KL = 0.071 +- 0.184 (in-sample avg dev_std = 0.049)
NEC for r=0.4 all L1 = 0.09 +- 0.203 (in-sample avg dev_std = 0.049)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.059
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.21262261904761903
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.002
NEC for r=0.8 class 1.0 = 0.089 +- 0.182 (in-sample avg dev_std = 0.062)
NEC for r=0.8 all KL = 0.07 +- 0.182 (in-sample avg dev_std = 0.062)
NEC for r=0.8 all L1 = 0.089 +- 0.202 (in-sample avg dev_std = 0.062)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.917
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7500498379254458
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.047
NEC for r=0.05 class 1.0 = 0.767 +- 0.273 (in-sample avg dev_std = 0.055)
NEC for r=0.05 all KL = 0.895 +- 0.273 (in-sample avg dev_std = 0.055)
NEC for r=0.05 all L1 = 0.767 +- 0.233 (in-sample avg dev_std = 0.055)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.917
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8163452188006483
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.053
NEC for r=0.1 class 1.0 = 0.766 +- 0.266 (in-sample avg dev_std = 0.253)
NEC for r=0.1 all KL = 0.9 +- 0.266 (in-sample avg dev_std = 0.253)
NEC for r=0.1 all L1 = 0.766 +- 0.225 (in-sample avg dev_std = 0.253)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.917
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8543756077795787
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.14
NEC for r=0.2 class 1.0 = 0.719 +- 0.272 (in-sample avg dev_std = 0.495)
NEC for r=0.2 all KL = 0.878 +- 0.272 (in-sample avg dev_std = 0.495)
NEC for r=0.2 all L1 = 0.719 +- 0.235 (in-sample avg dev_std = 0.495)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.917
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8756555915721231
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.293
NEC for r=0.4 class 1.0 = 0.619 +- 0.297 (in-sample avg dev_std = 0.627)
NEC for r=0.4 all KL = 0.809 +- 0.297 (in-sample avg dev_std = 0.627)
NEC for r=0.4 all L1 = 0.619 +- 0.262 (in-sample avg dev_std = 0.627)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.917
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8811969205834683
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.452
NEC for r=0.8 class 1.0 = 0.504 +- 0.327 (in-sample avg dev_std = 0.664)
NEC for r=0.8 all KL = 0.702 +- 0.327 (in-sample avg dev_std = 0.664)
NEC for r=0.8 all L1 = 0.504 +- 0.283 (in-sample avg dev_std = 0.664)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 18:38:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 06:38:56 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 06:38:56 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 06:38:56 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 06:38:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:38:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:38:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:38:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:38:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:38:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 06:38:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mChartInfo 0.9320 0.9320 0.9320 0.9320 0.9260 0.9260[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.678
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.645
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.530
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.389
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.287
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.361
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.220
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.137
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.093
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.725
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.750
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.744
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.732
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.743


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.949
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.678263537906137
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.056
SUFF_SIMPLE for r=0.05 class 1.0 = 0.221 +- 0.180 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.05 all KL = 0.16 +- 0.180 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.05 all L1 = 0.221 +- 0.123 (in-sample avg dev_std = 0.279)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.949
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6454440433212997
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.057
SUFF_SIMPLE for r=0.1 class 1.0 = 0.22 +- 0.175 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.1 all KL = 0.158 +- 0.175 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.1 all L1 = 0.22 +- 0.117 (in-sample avg dev_std = 0.310)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.949
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5300036101083032
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.109
SUFF_SIMPLE for r=0.2 class 1.0 = 0.252 +- 0.225 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.2 all KL = 0.194 +- 0.225 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.2 all L1 = 0.252 +- 0.172 (in-sample avg dev_std = 0.328)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.949
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.38911913357400724
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.11
SUFF_SIMPLE for r=0.4 class 1.0 = 0.266 +- 0.265 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.4 all KL = 0.214 +- 0.265 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.4 all L1 = 0.266 +- 0.211 (in-sample avg dev_std = 0.232)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.949
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.28722743682310475
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.1
SUFF_SIMPLE for r=0.8 class 1.0 = 0.273 +- 0.298 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.8 all KL = 0.226 +- 0.298 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.8 all L1 = 0.273 +- 0.248 (in-sample avg dev_std = 0.068)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.072
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3610781746031746
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
SUFF_SIMPLE for r=0.05 class 1.0 = 0.833 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.881 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.833 +- 0.223 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.072
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22009444444444445
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
SUFF_SIMPLE for r=0.1 class 1.0 = 0.833 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.881 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.833 +- 0.223 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.072
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.13720436507936506
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.881 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.833 +- 0.223 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.072
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09306944444444443
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.833 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.881 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.833 +- 0.223 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.072
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07896309523809522
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.833 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.881 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.833 +- 0.223 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.684
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7245903565640194
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.464
SUFF_SIMPLE for r=0.05 class 1.0 = 0.645 +- 0.403 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.05 all KL = 0.681 +- 0.403 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.05 all L1 = 0.645 +- 0.321 (in-sample avg dev_std = 0.157)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.684
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7500490275526742
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.485
SUFF_SIMPLE for r=0.1 class 1.0 = 0.658 +- 0.396 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.1 all KL = 0.697 +- 0.396 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.1 all L1 = 0.658 +- 0.316 (in-sample avg dev_std = 0.174)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.684
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7436523500810373
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.515
SUFF_SIMPLE for r=0.2 class 1.0 = 0.661 +- 0.395 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.2 all KL = 0.704 +- 0.395 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.2 all L1 = 0.661 +- 0.314 (in-sample avg dev_std = 0.151)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.684
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7319833873581848
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.502
SUFF_SIMPLE for r=0.4 class 1.0 = 0.658 +- 0.400 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.4 all KL = 0.701 +- 0.400 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.4 all L1 = 0.658 +- 0.320 (in-sample avg dev_std = 0.121)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.688
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7434311183144247
len(reference) = 2455
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.646
SUFF_SIMPLE for r=0.8 class 1.0 = 0.77 +- 0.307 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.8 all KL = 0.831 +- 0.307 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.8 all L1 = 0.77 +- 0.272 (in-sample avg dev_std = 0.047)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.949
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.678263537906137
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.022
NEC for r=0.05 class 1.0 = 0.778 +- 0.208 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.833 +- 0.208 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.778 +- 0.154 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.949
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6454440433212997
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.013
NEC for r=0.1 class 1.0 = 0.788 +- 0.187 (in-sample avg dev_std = 0.077)
NEC for r=0.1 all KL = 0.848 +- 0.187 (in-sample avg dev_std = 0.077)
NEC for r=0.1 all L1 = 0.788 +- 0.129 (in-sample avg dev_std = 0.077)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.949
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5300036101083032
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.036
NEC for r=0.2 class 1.0 = 0.786 +- 0.181 (in-sample avg dev_std = 0.286)
NEC for r=0.2 all KL = 0.85 +- 0.181 (in-sample avg dev_std = 0.286)
NEC for r=0.2 all L1 = 0.786 +- 0.118 (in-sample avg dev_std = 0.286)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.949
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.38911913357400724
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.142
NEC for r=0.4 class 1.0 = 0.741 +- 0.198 (in-sample avg dev_std = 0.491)
NEC for r=0.4 all KL = 0.806 +- 0.198 (in-sample avg dev_std = 0.491)
NEC for r=0.4 all L1 = 0.741 +- 0.142 (in-sample avg dev_std = 0.491)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.949
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.28722743682310475
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.229
NEC for r=0.8 class 1.0 = 0.697 +- 0.204 (in-sample avg dev_std = 0.556)
NEC for r=0.8 all KL = 0.76 +- 0.204 (in-sample avg dev_std = 0.556)
NEC for r=0.8 all L1 = 0.697 +- 0.146 (in-sample avg dev_std = 0.556)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.072
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3610781746031746
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.165 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.113 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.165 +- 0.221 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.072
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22009444444444445
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.164 +- 0.178 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.111 +- 0.178 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.164 +- 0.220 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.072
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.13720436507936506
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
NEC for r=0.2 class 1.0 = 0.166 +- 0.188 (in-sample avg dev_std = 0.020)
NEC for r=0.2 all KL = 0.118 +- 0.188 (in-sample avg dev_std = 0.020)
NEC for r=0.2 all L1 = 0.166 +- 0.223 (in-sample avg dev_std = 0.020)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.072
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09306944444444443
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.166 +- 0.186 (in-sample avg dev_std = 0.028)
NEC for r=0.4 all KL = 0.118 +- 0.186 (in-sample avg dev_std = 0.028)
NEC for r=0.4 all L1 = 0.166 +- 0.222 (in-sample avg dev_std = 0.028)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.072
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07896309523809522
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.166 +- 0.186 (in-sample avg dev_std = 0.024)
NEC for r=0.8 all KL = 0.118 +- 0.186 (in-sample avg dev_std = 0.024)
NEC for r=0.8 all L1 = 0.166 +- 0.222 (in-sample avg dev_std = 0.024)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.684
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7245903565640194
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.092
NEC for r=0.05 class 1.0 = 0.601 +- 0.357 (in-sample avg dev_std = 0.019)
NEC for r=0.05 all KL = 0.574 +- 0.357 (in-sample avg dev_std = 0.019)
NEC for r=0.05 all L1 = 0.601 +- 0.280 (in-sample avg dev_std = 0.019)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.684
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7500490275526742
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.095
NEC for r=0.1 class 1.0 = 0.615 +- 0.340 (in-sample avg dev_std = 0.082)
NEC for r=0.1 all KL = 0.605 +- 0.340 (in-sample avg dev_std = 0.082)
NEC for r=0.1 all L1 = 0.615 +- 0.271 (in-sample avg dev_std = 0.082)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.684
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7436523500810373
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.109
NEC for r=0.2 class 1.0 = 0.623 +- 0.336 (in-sample avg dev_std = 0.239)
NEC for r=0.2 all KL = 0.625 +- 0.336 (in-sample avg dev_std = 0.239)
NEC for r=0.2 all L1 = 0.623 +- 0.262 (in-sample avg dev_std = 0.239)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.684
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7319833873581848
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.157
NEC for r=0.4 class 1.0 = 0.597 +- 0.347 (in-sample avg dev_std = 0.431)
NEC for r=0.4 all KL = 0.606 +- 0.347 (in-sample avg dev_std = 0.431)
NEC for r=0.4 all L1 = 0.597 +- 0.263 (in-sample avg dev_std = 0.431)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.684
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7434311183144247
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.268
NEC for r=0.8 class 1.0 = 0.517 +- 0.358 (in-sample avg dev_std = 0.539)
NEC for r=0.8 all KL = 0.532 +- 0.358 (in-sample avg dev_std = 0.539)
NEC for r=0.8 all L1 = 0.517 +- 0.274 (in-sample avg dev_std = 0.539)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 18:44:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 06:44:43 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 06:44:43 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 06:44:43 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 06:44:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:44:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:44:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:44:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:44:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:44:43 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 06:44:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mChartInfo 0.9540 0.9540 0.9540 0.9540 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.674
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.708
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.652
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.576
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.525
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.465
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.307
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.205
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.148
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.130
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.763
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.817
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.850
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.869
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.872


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.993
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6736389891696751
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.151
SUFF_SIMPLE for r=0.05 class 1.0 = 0.212 +- 0.097 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.05 all KL = 0.069 +- 0.097 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.05 all L1 = 0.212 +- 0.072 (in-sample avg dev_std = 0.574)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.993
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7079025270758122
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.167
SUFF_SIMPLE for r=0.1 class 1.0 = 0.226 +- 0.107 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.1 all KL = 0.08 +- 0.107 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.1 all L1 = 0.226 +- 0.098 (in-sample avg dev_std = 0.578)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.993
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6518880866425992
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.163
SUFF_SIMPLE for r=0.2 class 1.0 = 0.224 +- 0.106 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.2 all KL = 0.078 +- 0.106 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.2 all L1 = 0.224 +- 0.098 (in-sample avg dev_std = 0.581)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5759675090252708
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.155
SUFF_SIMPLE for r=0.4 class 1.0 = 0.237 +- 0.214 (in-sample avg dev_std = 0.478)
SUFF_SIMPLE for r=0.4 all KL = 0.11 +- 0.214 (in-sample avg dev_std = 0.478)
SUFF_SIMPLE for r=0.4 all L1 = 0.237 +- 0.181 (in-sample avg dev_std = 0.478)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.993
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5253393501805055
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.217
SUFF_SIMPLE for r=0.8 class 1.0 = 0.317 +- 0.366 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.8 all KL = 0.231 +- 0.366 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.8 all L1 = 0.317 +- 0.315 (in-sample avg dev_std = 0.166)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.094
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4646369047619048
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
SUFF_SIMPLE for r=0.05 class 1.0 = 0.831 +- 0.222 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.05 all KL = 0.87 +- 0.222 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.05 all L1 = 0.831 +- 0.246 (in-sample avg dev_std = 0.006)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.094
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3073797619047619
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
SUFF_SIMPLE for r=0.1 class 1.0 = 0.831 +- 0.222 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.1 all KL = 0.87 +- 0.222 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.1 all L1 = 0.831 +- 0.246 (in-sample avg dev_std = 0.013)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.094
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2047234126984127
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
SUFF_SIMPLE for r=0.2 class 1.0 = 0.831 +- 0.222 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.2 all KL = 0.87 +- 0.222 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.2 all L1 = 0.831 +- 0.246 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.094
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1484531746031746
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.831 +- 0.222 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.4 all KL = 0.87 +- 0.222 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.4 all L1 = 0.831 +- 0.246 (in-sample avg dev_std = 0.004)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.094
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1301734126984127
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.831 +- 0.222 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.87 +- 0.222 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.831 +- 0.246 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.915
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7628083468395461
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.58
SUFF_SIMPLE for r=0.05 class 1.0 = 0.653 +- 0.441 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.05 all KL = 0.554 +- 0.441 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.05 all L1 = 0.653 +- 0.360 (in-sample avg dev_std = 0.431)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.915
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8170004051863857
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.591
SUFF_SIMPLE for r=0.1 class 1.0 = 0.674 +- 0.447 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.1 all KL = 0.595 +- 0.447 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.1 all L1 = 0.674 +- 0.370 (in-sample avg dev_std = 0.372)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.915
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8501272285251213
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.603
SUFF_SIMPLE for r=0.2 class 1.0 = 0.69 +- 0.449 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.2 all KL = 0.628 +- 0.449 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.2 all L1 = 0.69 +- 0.377 (in-sample avg dev_std = 0.305)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.915
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8688286061588332
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.618
SUFF_SIMPLE for r=0.4 class 1.0 = 0.708 +- 0.445 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.4 all KL = 0.66 +- 0.445 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.4 all L1 = 0.708 +- 0.379 (in-sample avg dev_std = 0.214)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.917
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8723407617504051
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.812
SUFF_SIMPLE for r=0.8 class 1.0 = 0.873 +- 0.316 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all KL = 0.862 +- 0.316 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all L1 = 0.873 +- 0.274 (in-sample avg dev_std = 0.002)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.993
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6736389891696751
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.036
NEC for r=0.05 class 1.0 = 0.814 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.929 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.814 +- 0.115 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.993
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7079025270758122
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.033
NEC for r=0.1 class 1.0 = 0.826 +- 0.106 (in-sample avg dev_std = 0.133)
NEC for r=0.1 all KL = 0.943 +- 0.106 (in-sample avg dev_std = 0.133)
NEC for r=0.1 all L1 = 0.826 +- 0.075 (in-sample avg dev_std = 0.133)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.993
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6518880866425992
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.078
NEC for r=0.2 class 1.0 = 0.811 +- 0.097 (in-sample avg dev_std = 0.362)
NEC for r=0.2 all KL = 0.939 +- 0.097 (in-sample avg dev_std = 0.362)
NEC for r=0.2 all L1 = 0.811 +- 0.071 (in-sample avg dev_std = 0.362)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5759675090252708
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.155
NEC for r=0.4 class 1.0 = 0.778 +- 0.107 (in-sample avg dev_std = 0.540)
NEC for r=0.4 all KL = 0.922 +- 0.107 (in-sample avg dev_std = 0.540)
NEC for r=0.4 all L1 = 0.778 +- 0.092 (in-sample avg dev_std = 0.540)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.993
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5253393501805055
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.258
NEC for r=0.8 class 1.0 = 0.725 +- 0.135 (in-sample avg dev_std = 0.646)
NEC for r=0.8 all KL = 0.885 +- 0.135 (in-sample avg dev_std = 0.646)
NEC for r=0.8 all L1 = 0.725 +- 0.122 (in-sample avg dev_std = 0.646)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.094
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4646369047619048
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.169 +- 0.221 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.129 +- 0.221 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.169 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.094
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3073797619047619
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.169 +- 0.222 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all KL = 0.13 +- 0.222 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all L1 = 0.169 +- 0.246 (in-sample avg dev_std = 0.002)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.094
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2047234126984127
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
NEC for r=0.2 class 1.0 = 0.169 +- 0.222 (in-sample avg dev_std = 0.026)
NEC for r=0.2 all KL = 0.13 +- 0.222 (in-sample avg dev_std = 0.026)
NEC for r=0.2 all L1 = 0.169 +- 0.246 (in-sample avg dev_std = 0.026)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.094
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1484531746031746
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.169 +- 0.222 (in-sample avg dev_std = 0.024)
NEC for r=0.4 all KL = 0.13 +- 0.222 (in-sample avg dev_std = 0.024)
NEC for r=0.4 all L1 = 0.169 +- 0.246 (in-sample avg dev_std = 0.024)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.094
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1301734126984127
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.169 +- 0.222 (in-sample avg dev_std = 0.024)
NEC for r=0.8 all KL = 0.13 +- 0.222 (in-sample avg dev_std = 0.024)
NEC for r=0.8 all L1 = 0.169 +- 0.246 (in-sample avg dev_std = 0.024)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.915
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7628083468395461
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.073
NEC for r=0.05 class 1.0 = 0.742 +- 0.300 (in-sample avg dev_std = 0.067)
NEC for r=0.05 all KL = 0.864 +- 0.300 (in-sample avg dev_std = 0.067)
NEC for r=0.05 all L1 = 0.742 +- 0.250 (in-sample avg dev_std = 0.067)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.915
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8170004051863857
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.069
NEC for r=0.1 class 1.0 = 0.757 +- 0.267 (in-sample avg dev_std = 0.359)
NEC for r=0.1 all KL = 0.894 +- 0.267 (in-sample avg dev_std = 0.359)
NEC for r=0.1 all L1 = 0.757 +- 0.219 (in-sample avg dev_std = 0.359)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.915
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8501272285251213
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.184
NEC for r=0.2 class 1.0 = 0.702 +- 0.260 (in-sample avg dev_std = 0.566)
NEC for r=0.2 all KL = 0.875 +- 0.260 (in-sample avg dev_std = 0.566)
NEC for r=0.2 all L1 = 0.702 +- 0.222 (in-sample avg dev_std = 0.566)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.915
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8688286061588332
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.346
NEC for r=0.4 class 1.0 = 0.595 +- 0.287 (in-sample avg dev_std = 0.635)
NEC for r=0.4 all KL = 0.793 +- 0.287 (in-sample avg dev_std = 0.635)
NEC for r=0.4 all L1 = 0.595 +- 0.257 (in-sample avg dev_std = 0.635)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.915
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8723407617504051
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 1.0 = 0.485 +- 0.311 (in-sample avg dev_std = 0.648)
NEC for r=0.8 all KL = 0.688 +- 0.311 (in-sample avg dev_std = 0.648)
NEC for r=0.8 all L1 = 0.485 +- 0.267 (in-sample avg dev_std = 0.648)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 18:50:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 06:50:31 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 06:50:31 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 06:50:31 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 06:50:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:50:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:50:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:50:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:50:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:50:31 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 06:50:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mChartInfo 0.9680 0.9680 0.9680 0.9680 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.746
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.809
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.796
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.753
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.720
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.574
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.404
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.286
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.222
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.201
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.789
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.847
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.883
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.904
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.911


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.986
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7457797833935018
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.519
SUFF_SIMPLE for r=0.05 class 1.0 = 0.468 +- 0.273 (in-sample avg dev_std = 0.740)
SUFF_SIMPLE for r=0.05 all KL = 0.255 +- 0.273 (in-sample avg dev_std = 0.740)
SUFF_SIMPLE for r=0.05 all L1 = 0.468 +- 0.244 (in-sample avg dev_std = 0.740)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.986
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8091588447653429
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.524
SUFF_SIMPLE for r=0.1 class 1.0 = 0.488 +- 0.333 (in-sample avg dev_std = 0.698)
SUFF_SIMPLE for r=0.1 all KL = 0.3 +- 0.333 (in-sample avg dev_std = 0.698)
SUFF_SIMPLE for r=0.1 all L1 = 0.488 +- 0.281 (in-sample avg dev_std = 0.698)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.986
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7959783393501805
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.507
SUFF_SIMPLE for r=0.2 class 1.0 = 0.474 +- 0.326 (in-sample avg dev_std = 0.693)
SUFF_SIMPLE for r=0.2 all KL = 0.285 +- 0.326 (in-sample avg dev_std = 0.693)
SUFF_SIMPLE for r=0.2 all L1 = 0.474 +- 0.278 (in-sample avg dev_std = 0.693)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.986
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7532743682310469
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.404
SUFF_SIMPLE for r=0.4 class 1.0 = 0.405 +- 0.339 (in-sample avg dev_std = 0.645)
SUFF_SIMPLE for r=0.4 all KL = 0.237 +- 0.339 (in-sample avg dev_std = 0.645)
SUFF_SIMPLE for r=0.4 all L1 = 0.405 +- 0.286 (in-sample avg dev_std = 0.645)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.986
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7202707581227437
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.364
SUFF_SIMPLE for r=0.8 class 1.0 = 0.431 +- 0.429 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.8 all KL = 0.335 +- 0.429 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.8 all L1 = 0.431 +- 0.367 (in-sample avg dev_std = 0.288)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.132
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5736623015873016
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.003
SUFF_SIMPLE for r=0.05 class 1.0 = 0.836 +- 0.270 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.05 all KL = 0.858 +- 0.270 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.05 all L1 = 0.836 +- 0.274 (in-sample avg dev_std = 0.077)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.132
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4042134920634921
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.003
SUFF_SIMPLE for r=0.1 class 1.0 = 0.836 +- 0.271 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.1 all KL = 0.857 +- 0.271 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.1 all L1 = 0.836 +- 0.275 (in-sample avg dev_std = 0.080)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.132
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2860722222222222
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.001
SUFF_SIMPLE for r=0.2 class 1.0 = 0.836 +- 0.271 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.2 all KL = 0.858 +- 0.271 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.2 all L1 = 0.836 +- 0.275 (in-sample avg dev_std = 0.045)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.132
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.22185396825396825
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.836 +- 0.272 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.4 all KL = 0.858 +- 0.272 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.4 all L1 = 0.836 +- 0.276 (in-sample avg dev_std = 0.020)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.132
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2014285714285714
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.836 +- 0.272 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.858 +- 0.272 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.836 +- 0.276 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.788722042139384
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.884
SUFF_SIMPLE for r=0.05 class 1.0 = 0.837 +- 0.378 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.05 all KL = 0.773 +- 0.378 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.05 all L1 = 0.837 +- 0.281 (in-sample avg dev_std = 0.411)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8467216369529983
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.914
SUFF_SIMPLE for r=0.1 class 1.0 = 0.849 +- 0.361 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.1 all KL = 0.802 +- 0.361 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.1 all L1 = 0.849 +- 0.285 (in-sample avg dev_std = 0.332)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8830757698541329
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.901
SUFF_SIMPLE for r=0.2 class 1.0 = 0.836 +- 0.375 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.2 all KL = 0.794 +- 0.375 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.2 all L1 = 0.836 +- 0.306 (in-sample avg dev_std = 0.279)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.903976904376013
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.852
SUFF_SIMPLE for r=0.4 class 1.0 = 0.812 +- 0.397 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.4 all KL = 0.774 +- 0.397 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.4 all L1 = 0.812 +- 0.332 (in-sample avg dev_std = 0.228)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.925
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9111045380875201
len(reference) = 2440
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.893
SUFF_SIMPLE for r=0.8 class 1.0 = 0.906 +- 0.290 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.8 all KL = 0.896 +- 0.290 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.8 all L1 = 0.906 +- 0.253 (in-sample avg dev_std = 0.017)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.986
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7457797833935018
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.177
NEC for r=0.05 class 1.0 = 0.701 +- 0.358 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.806 +- 0.358 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.701 +- 0.304 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.986
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8091588447653429
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.187
NEC for r=0.1 class 1.0 = 0.737 +- 0.254 (in-sample avg dev_std = 0.486)
NEC for r=0.1 all KL = 0.88 +- 0.254 (in-sample avg dev_std = 0.486)
NEC for r=0.1 all L1 = 0.737 +- 0.211 (in-sample avg dev_std = 0.486)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.986
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7959783393501805
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.43
NEC for r=0.2 class 1.0 = 0.592 +- 0.265 (in-sample avg dev_std = 0.700)
NEC for r=0.2 all KL = 0.784 +- 0.265 (in-sample avg dev_std = 0.700)
NEC for r=0.2 all L1 = 0.592 +- 0.243 (in-sample avg dev_std = 0.700)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.986
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7532743682310469
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.625
NEC for r=0.4 class 1.0 = 0.426 +- 0.345 (in-sample avg dev_std = 0.666)
NEC for r=0.4 all KL = 0.595 +- 0.345 (in-sample avg dev_std = 0.666)
NEC for r=0.4 all L1 = 0.426 +- 0.276 (in-sample avg dev_std = 0.666)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.986
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7202707581227437
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.763
NEC for r=0.8 class 1.0 = 0.305 +- 0.333 (in-sample avg dev_std = 0.624)
NEC for r=0.8 all KL = 0.454 +- 0.333 (in-sample avg dev_std = 0.624)
NEC for r=0.8 all L1 = 0.305 +- 0.243 (in-sample avg dev_std = 0.624)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.132
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5736623015873016
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.163 +- 0.269 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.14 +- 0.269 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.163 +- 0.275 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.132
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4042134920634921
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.002
NEC for r=0.1 class 1.0 = 0.163 +- 0.267 (in-sample avg dev_std = 0.050)
NEC for r=0.1 all KL = 0.141 +- 0.267 (in-sample avg dev_std = 0.050)
NEC for r=0.1 all L1 = 0.163 +- 0.273 (in-sample avg dev_std = 0.050)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.132
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2860722222222222
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.057
NEC for r=0.2 class 1.0 = 0.179 +- 0.259 (in-sample avg dev_std = 0.286)
NEC for r=0.2 all KL = 0.175 +- 0.259 (in-sample avg dev_std = 0.286)
NEC for r=0.2 all L1 = 0.179 +- 0.252 (in-sample avg dev_std = 0.286)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.132
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.22185396825396825
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.068
NEC for r=0.4 class 1.0 = 0.16 +- 0.231 (in-sample avg dev_std = 0.289)
NEC for r=0.4 all KL = 0.15 +- 0.231 (in-sample avg dev_std = 0.289)
NEC for r=0.4 all L1 = 0.16 +- 0.231 (in-sample avg dev_std = 0.289)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.132
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2014285714285714
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.04
NEC for r=0.8 class 1.0 = 0.155 +- 0.235 (in-sample avg dev_std = 0.237)
NEC for r=0.8 all KL = 0.134 +- 0.235 (in-sample avg dev_std = 0.237)
NEC for r=0.8 all L1 = 0.155 +- 0.243 (in-sample avg dev_std = 0.237)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.788722042139384
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.156
NEC for r=0.05 class 1.0 = 0.689 +- 0.363 (in-sample avg dev_std = 0.281)
NEC for r=0.05 all KL = 0.816 +- 0.363 (in-sample avg dev_std = 0.281)
NEC for r=0.05 all L1 = 0.689 +- 0.304 (in-sample avg dev_std = 0.281)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8467216369529983
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.248
NEC for r=0.1 class 1.0 = 0.65 +- 0.339 (in-sample avg dev_std = 0.529)
NEC for r=0.1 all KL = 0.809 +- 0.339 (in-sample avg dev_std = 0.529)
NEC for r=0.1 all L1 = 0.65 +- 0.289 (in-sample avg dev_std = 0.529)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8830757698541329
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.412
NEC for r=0.2 class 1.0 = 0.542 +- 0.350 (in-sample avg dev_std = 0.641)
NEC for r=0.2 all KL = 0.728 +- 0.350 (in-sample avg dev_std = 0.641)
NEC for r=0.2 all L1 = 0.542 +- 0.300 (in-sample avg dev_std = 0.641)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.903976904376013
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.613
NEC for r=0.4 class 1.0 = 0.404 +- 0.376 (in-sample avg dev_std = 0.651)
NEC for r=0.4 all KL = 0.588 +- 0.376 (in-sample avg dev_std = 0.651)
NEC for r=0.4 all L1 = 0.404 +- 0.301 (in-sample avg dev_std = 0.651)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9111045380875201
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.828
NEC for r=0.8 class 1.0 = 0.271 +- 0.380 (in-sample avg dev_std = 0.604)
NEC for r=0.8 all KL = 0.431 +- 0.380 (in-sample avg dev_std = 0.604)
NEC for r=0.8 all L1 = 0.271 +- 0.269 (in-sample avg dev_std = 0.604)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.216, 0.255, 0.252, 0.217, 0.216], 'all_L1': [0.366, 0.389, 0.377, 0.33, 0.303]}), defaultdict(<class 'list'>, {'all_KL': [0.107, 0.108, 0.094, 0.078, 0.253], 'all_L1': [0.324, 0.324, 0.309, 0.285, 0.367]}), defaultdict(<class 'list'>, {'all_KL': [0.152, 0.169, 0.155, 0.162, 0.267], 'all_L1': [0.343, 0.359, 0.361, 0.336, 0.367]}), defaultdict(<class 'list'>, {'all_KL': [0.135, 0.147, 0.135, 0.114, 0.262], 'all_L1': [0.299, 0.301, 0.293, 0.262, 0.363]}), defaultdict(<class 'list'>, {'all_KL': [0.115, 0.12, 0.123, 0.101, 0.234], 'all_L1': [0.276, 0.288, 0.288, 0.248, 0.329]}), defaultdict(<class 'list'>, {'all_KL': [0.096, 0.1, 0.133, 0.118, 0.148], 'all_L1': [0.194, 0.195, 0.226, 0.207, 0.225]}), defaultdict(<class 'list'>, {'all_KL': [0.174, 0.176, 0.178, 0.148, 0.253], 'all_L1': [0.315, 0.326, 0.328, 0.29, 0.338]}), defaultdict(<class 'list'>, {'all_KL': [0.16, 0.158, 0.194, 0.214, 0.226], 'all_L1': [0.221, 0.22, 0.252, 0.266, 0.273]}), defaultdict(<class 'list'>, {'all_KL': [0.069, 0.08, 0.078, 0.11, 0.231], 'all_L1': [0.212, 0.226, 0.224, 0.237, 0.317]}), defaultdict(<class 'list'>, {'all_KL': [0.255, 0.3, 0.285, 0.237, 0.335], 'all_L1': [0.468, 0.488, 0.474, 0.405, 0.431]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.836, 0.882, 0.745, 0.593, 0.521], 'all_L1': [0.734, 0.764, 0.617, 0.483, 0.415]}), defaultdict(<class 'list'>, {'all_KL': [0.955, 0.965, 0.954, 0.92, 0.857], 'all_L1': [0.816, 0.816, 0.771, 0.688, 0.592]}), defaultdict(<class 'list'>, {'all_KL': [0.916, 0.937, 0.932, 0.875, 0.793], 'all_L1': [0.793, 0.808, 0.777, 0.686, 0.585]}), defaultdict(<class 'list'>, {'all_KL': [0.933, 0.948, 0.937, 0.897, 0.838], 'all_L1': [0.812, 0.824, 0.804, 0.736, 0.646]}), defaultdict(<class 'list'>, {'all_KL': [0.943, 0.943, 0.934, 0.917, 0.847], 'all_L1': [0.831, 0.823, 0.81, 0.763, 0.672]}), defaultdict(<class 'list'>, {'all_KL': [0.887, 0.915, 0.91, 0.894, 0.853], 'all_L1': [0.801, 0.827, 0.82, 0.793, 0.744]}), defaultdict(<class 'list'>, {'all_KL': [0.937, 0.936, 0.922, 0.886, 0.813], 'all_L1': [0.823, 0.82, 0.799, 0.739, 0.646]}), defaultdict(<class 'list'>, {'all_KL': [0.833, 0.848, 0.85, 0.806, 0.76], 'all_L1': [0.778, 0.788, 0.786, 0.741, 0.697]}), defaultdict(<class 'list'>, {'all_KL': [0.929, 0.943, 0.939, 0.922, 0.885], 'all_L1': [0.814, 0.826, 0.811, 0.778, 0.725]}), defaultdict(<class 'list'>, {'all_KL': [0.806, 0.88, 0.784, 0.595, 0.454], 'all_L1': [0.701, 0.737, 0.592, 0.426, 0.305]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.874, 0.873, 0.873, 0.873, 0.873], 'all_L1': [0.841, 0.841, 0.841, 0.841, 0.841]}), defaultdict(<class 'list'>, {'all_KL': [0.824, 0.823, 0.824, 0.826, 0.828], 'all_L1': [0.81, 0.809, 0.809, 0.809, 0.809]}), defaultdict(<class 'list'>, {'all_KL': [0.86, 0.86, 0.86, 0.859, 0.859], 'all_L1': [0.849, 0.848, 0.847, 0.847, 0.846]}), defaultdict(<class 'list'>, {'all_KL': [0.907, 0.907, 0.907, 0.907, 0.907], 'all_L1': [0.889, 0.889, 0.889, 0.889, 0.889]}), defaultdict(<class 'list'>, {'all_KL': [0.854, 0.854, 0.854, 0.854, 0.854], 'all_L1': [0.823, 0.823, 0.823, 0.823, 0.823]}), defaultdict(<class 'list'>, {'all_KL': [0.937, 0.937, 0.937, 0.937, 0.937], 'all_L1': [0.91, 0.91, 0.91, 0.91, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.928, 0.928, 0.928, 0.928, 0.928], 'all_L1': [0.91, 0.91, 0.91, 0.91, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.881, 0.881, 0.881, 0.881, 0.881], 'all_L1': [0.833, 0.833, 0.833, 0.833, 0.833]}), defaultdict(<class 'list'>, {'all_KL': [0.87, 0.87, 0.87, 0.87, 0.87], 'all_L1': [0.831, 0.831, 0.831, 0.831, 0.831]}), defaultdict(<class 'list'>, {'all_KL': [0.858, 0.857, 0.858, 0.858, 0.858], 'all_L1': [0.836, 0.836, 0.836, 0.836, 0.836]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.124, 0.123, 0.118, 0.109, 0.113], 'all_L1': [0.158, 0.157, 0.154, 0.147, 0.15]}), defaultdict(<class 'list'>, {'all_KL': [0.169, 0.169, 0.176, 0.177, 0.175], 'all_L1': [0.187, 0.188, 0.19, 0.189, 0.187]}), defaultdict(<class 'list'>, {'all_KL': [0.132, 0.129, 0.14, 0.137, 0.135], 'all_L1': [0.147, 0.145, 0.15, 0.147, 0.146]}), defaultdict(<class 'list'>, {'all_KL': [0.091, 0.088, 0.092, 0.091, 0.089], 'all_L1': [0.11, 0.109, 0.11, 0.108, 0.108]}), defaultdict(<class 'list'>, {'all_KL': [0.141, 0.14, 0.145, 0.144, 0.143], 'all_L1': [0.175, 0.174, 0.176, 0.175, 0.174]}), defaultdict(<class 'list'>, {'all_KL': [0.062, 0.062, 0.063, 0.063, 0.063], 'all_L1': [0.09, 0.09, 0.09, 0.09, 0.09]}), defaultdict(<class 'list'>, {'all_KL': [0.071, 0.071, 0.072, 0.071, 0.07], 'all_L1': [0.09, 0.09, 0.09, 0.09, 0.089]}), defaultdict(<class 'list'>, {'all_KL': [0.113, 0.111, 0.118, 0.118, 0.118], 'all_L1': [0.165, 0.164, 0.166, 0.166, 0.166]}), defaultdict(<class 'list'>, {'all_KL': [0.129, 0.13, 0.13, 0.13, 0.13], 'all_L1': [0.169, 0.169, 0.169, 0.169, 0.169]}), defaultdict(<class 'list'>, {'all_KL': [0.14, 0.141, 0.175, 0.15, 0.134], 'all_L1': [0.163, 0.163, 0.179, 0.16, 0.155]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.709, 0.744, 0.765, 0.761, 0.873], 'all_L1': [0.768, 0.789, 0.8, 0.778, 0.868]}), defaultdict(<class 'list'>, {'all_KL': [0.386, 0.452, 0.541, 0.603, 0.832], 'all_L1': [0.612, 0.635, 0.671, 0.693, 0.857]}), defaultdict(<class 'list'>, {'all_KL': [0.644, 0.669, 0.675, 0.676, 0.845], 'all_L1': [0.714, 0.728, 0.729, 0.729, 0.869]}), defaultdict(<class 'list'>, {'all_KL': [0.429, 0.467, 0.521, 0.535, 0.764], 'all_L1': [0.582, 0.599, 0.628, 0.633, 0.792]}), defaultdict(<class 'list'>, {'all_KL': [0.494, 0.564, 0.642, 0.667, 0.846], 'all_L1': [0.606, 0.647, 0.692, 0.708, 0.851]}), defaultdict(<class 'list'>, {'all_KL': [0.643, 0.681, 0.724, 0.727, 0.855], 'all_L1': [0.711, 0.733, 0.751, 0.75, 0.857]}), defaultdict(<class 'list'>, {'all_KL': [0.683, 0.695, 0.691, 0.688, 0.854], 'all_L1': [0.726, 0.736, 0.732, 0.731, 0.868]}), defaultdict(<class 'list'>, {'all_KL': [0.681, 0.697, 0.704, 0.701, 0.831], 'all_L1': [0.645, 0.658, 0.661, 0.658, 0.77]}), defaultdict(<class 'list'>, {'all_KL': [0.554, 0.595, 0.628, 0.66, 0.862], 'all_L1': [0.653, 0.674, 0.69, 0.708, 0.873]}), defaultdict(<class 'list'>, {'all_KL': [0.773, 0.802, 0.794, 0.774, 0.896], 'all_L1': [0.837, 0.849, 0.836, 0.812, 0.906]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.769, 0.743, 0.65, 0.471, 0.339], 'all_L1': [0.683, 0.647, 0.55, 0.387, 0.267]}), defaultdict(<class 'list'>, {'all_KL': [0.889, 0.892, 0.873, 0.806, 0.749], 'all_L1': [0.745, 0.712, 0.637, 0.523, 0.443]}), defaultdict(<class 'list'>, {'all_KL': [0.858, 0.869, 0.842, 0.742, 0.622], 'all_L1': [0.73, 0.712, 0.636, 0.519, 0.406]}), defaultdict(<class 'list'>, {'all_KL': [0.854, 0.858, 0.83, 0.744, 0.725], 'all_L1': [0.732, 0.729, 0.689, 0.591, 0.538]}), defaultdict(<class 'list'>, {'all_KL': [0.842, 0.848, 0.822, 0.767, 0.734], 'all_L1': [0.729, 0.728, 0.696, 0.626, 0.554]}), defaultdict(<class 'list'>, {'all_KL': [0.83, 0.853, 0.826, 0.755, 0.662], 'all_L1': [0.732, 0.751, 0.71, 0.619, 0.501]}), defaultdict(<class 'list'>, {'all_KL': [0.895, 0.9, 0.878, 0.809, 0.702], 'all_L1': [0.767, 0.766, 0.719, 0.619, 0.504]}), defaultdict(<class 'list'>, {'all_KL': [0.574, 0.605, 0.625, 0.606, 0.532], 'all_L1': [0.601, 0.615, 0.623, 0.597, 0.517]}), defaultdict(<class 'list'>, {'all_KL': [0.864, 0.894, 0.875, 0.793, 0.688], 'all_L1': [0.742, 0.757, 0.702, 0.595, 0.485]}), defaultdict(<class 'list'>, {'all_KL': [0.816, 0.809, 0.728, 0.588, 0.431], 'all_L1': [0.689, 0.65, 0.542, 0.404, 0.271]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.302 +- 0.078, 0.312 +- 0.083, 0.313 +- 0.073, 0.287 +- 0.054, 0.331 +- 0.054
suff_simple class all_KL  =  0.148 +- 0.054, 0.161 +- 0.066, 0.163 +- 0.063, 0.150 +- 0.053, 0.242 +- 0.045
suff_simple_acc_int  =  0.263 +- 0.134, 0.273 +- 0.137, 0.276 +- 0.117, 0.224 +- 0.094, 0.227 +- 0.083
nec class all_L1  =  0.790 +- 0.040, 0.803 +- 0.029, 0.759 +- 0.079, 0.683 +- 0.120, 0.603 +- 0.133
nec class all_KL  =  0.897 +- 0.051, 0.920 +- 0.036, 0.891 +- 0.069, 0.831 +- 0.122, 0.762 +- 0.142
nec_acc_int  =  0.060 +- 0.056, 0.056 +- 0.055, 0.147 +- 0.136, 0.280 +- 0.173, 0.410 +- 0.172

Eval split val
suff_simple class all_L1  =  0.853 +- 0.034, 0.853 +- 0.035, 0.853 +- 0.035, 0.853 +- 0.035, 0.853 +- 0.035
suff_simple class all_KL  =  0.879 +- 0.033, 0.879 +- 0.034, 0.879 +- 0.033, 0.879 +- 0.033, 0.879 +- 0.033
suff_simple_acc_int  =  0.003 +- 0.005, 0.002 +- 0.004, 0.002 +- 0.003, 0.001 +- 0.001, 0.000 +- 0.000
nec class all_L1  =  0.145 +- 0.034, 0.145 +- 0.034, 0.147 +- 0.035, 0.144 +- 0.034, 0.143 +- 0.034
nec class all_KL  =  0.117 +- 0.032, 0.116 +- 0.032, 0.123 +- 0.037, 0.119 +- 0.034, 0.117 +- 0.033
nec_acc_int  =  0.002 +- 0.004, 0.004 +- 0.008, 0.012 +- 0.017, 0.016 +- 0.021, 0.012 +- 0.013

Eval split test
suff_simple class all_L1  =  0.685 +- 0.076, 0.705 +- 0.073, 0.719 +- 0.061, 0.720 +- 0.050, 0.851 +- 0.038
suff_simple class all_KL  =  0.600 +- 0.121, 0.637 +- 0.109, 0.669 +- 0.084, 0.679 +- 0.068, 0.846 +- 0.033
suff_simple_acc_int  =  0.637 +- 0.121, 0.650 +- 0.130, 0.651 +- 0.128, 0.640 +- 0.108, 0.772 +- 0.074
nec class all_L1  =  0.715 +- 0.045, 0.707 +- 0.049, 0.650 +- 0.061, 0.548 +- 0.084, 0.449 +- 0.099
nec class all_KL  =  0.819 +- 0.089, 0.827 +- 0.086, 0.795 +- 0.089, 0.708 +- 0.108, 0.618 +- 0.133
nec_acc_int  =  0.084 +- 0.037, 0.118 +- 0.069, 0.219 +- 0.109, 0.371 +- 0.142, 0.535 +- 0.163


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.546 +- 0.030, 0.557 +- 0.032, 0.536 +- 0.021, 0.485 +- 0.038, 0.467 +- 0.053
Faith. Armon (L1)= 		  =  0.429 +- 0.074, 0.441 +- 0.080, 0.434 +- 0.055, 0.392 +- 0.032, 0.414 +- 0.045
Faith. GMean (L1)= 	  =  0.483 +- 0.054, 0.495 +- 0.059, 0.481 +- 0.036, 0.435 +- 0.024, 0.439 +- 0.045
Faith. Aritm (KL)= 		  =  0.523 +- 0.019, 0.541 +- 0.027, 0.527 +- 0.015, 0.490 +- 0.040, 0.502 +- 0.064
Faith. Armon (KL)= 		  =  0.249 +- 0.075, 0.268 +- 0.090, 0.268 +- 0.082, 0.246 +- 0.066, 0.360 +- 0.045
Faith. GMean (KL)= 	  =  0.357 +- 0.058, 0.377 +- 0.071, 0.371 +- 0.058, 0.342 +- 0.041, 0.424 +- 0.046

Eval split val
Faith. Aritm (L1)= 		  =  0.499 +- 0.001, 0.499 +- 0.001, 0.500 +- 0.003, 0.499 +- 0.002, 0.498 +- 0.002
Faith. Armon (L1)= 		  =  0.246 +- 0.049, 0.245 +- 0.049, 0.249 +- 0.052, 0.244 +- 0.050, 0.243 +- 0.049
Faith. GMean (L1)= 	  =  0.349 +- 0.037, 0.348 +- 0.037, 0.351 +- 0.038, 0.347 +- 0.037, 0.346 +- 0.037
Faith. Aritm (KL)= 		  =  0.498 +- 0.001, 0.498 +- 0.002, 0.501 +- 0.005, 0.499 +- 0.003, 0.498 +- 0.002
Faith. Armon (KL)= 		  =  0.205 +- 0.049, 0.204 +- 0.050, 0.213 +- 0.056, 0.207 +- 0.053, 0.204 +- 0.051
Faith. GMean (KL)= 	  =  0.317 +- 0.040, 0.316 +- 0.040, 0.324 +- 0.046, 0.319 +- 0.043, 0.316 +- 0.041

Eval split test
Faith. Aritm (L1)= 		  =  0.700 +- 0.041, 0.706 +- 0.037, 0.685 +- 0.027, 0.634 +- 0.032, 0.650 +- 0.041
Faith. Armon (L1)= 		  =  0.697 +- 0.042, 0.702 +- 0.036, 0.679 +- 0.030, 0.616 +- 0.051, 0.579 +- 0.088
Faith. GMean (L1)= 	  =  0.698 +- 0.042, 0.704 +- 0.037, 0.682 +- 0.028, 0.625 +- 0.041, 0.612 +- 0.067
Faith. Aritm (KL)= 		  =  0.709 +- 0.059, 0.732 +- 0.053, 0.732 +- 0.039, 0.694 +- 0.042, 0.732 +- 0.059
Faith. Armon (KL)= 		  =  0.680 +- 0.083, 0.709 +- 0.069, 0.718 +- 0.046, 0.684 +- 0.050, 0.704 +- 0.095
Faith. GMean (KL)= 	  =  0.694 +- 0.071, 0.720 +- 0.061, 0.725 +- 0.042, 0.689 +- 0.046, 0.717 +- 0.078
Computed for split load_split = id



Completed in  0:57:18.905139  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN plain TopoFeature/basis/no_shift NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 18:56:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 06:56:25 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 06:56:25 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 06:56:25 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 06:56:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:56:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:56:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:56:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 06:56:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 06:56:25 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 06:56:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 94 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mChartInfo 0.9560 0.9560 0.9560 0.9560 0.9740 0.9740[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.731
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.794
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.768
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.699
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.648
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.623
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.456
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.333
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.262
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.241
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.782
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.852
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.891
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.909
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.903


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7305703971119133
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.339
SUFF_SIMPLE for r=0.05 class 1.0 = 0.366 +- 0.320 (in-sample avg dev_std = 0.519)
SUFF_SIMPLE for r=0.05 all KL = 0.254 +- 0.320 (in-sample avg dev_std = 0.519)
SUFF_SIMPLE for r=0.05 all L1 = 0.366 +- 0.275 (in-sample avg dev_std = 0.519)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7937942238267147
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.367
SUFF_SIMPLE for r=0.1 class 1.0 = 0.408 +- 0.384 (in-sample avg dev_std = 0.478)
SUFF_SIMPLE for r=0.1 all KL = 0.314 +- 0.384 (in-sample avg dev_std = 0.478)
SUFF_SIMPLE for r=0.1 all L1 = 0.408 +- 0.326 (in-sample avg dev_std = 0.478)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7677364620938628
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.343
SUFF_SIMPLE for r=0.2 class 1.0 = 0.407 +- 0.399 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.2 all KL = 0.32 +- 0.399 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.2 all L1 = 0.407 +- 0.344 (in-sample avg dev_std = 0.405)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6989314079422383
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.268
SUFF_SIMPLE for r=0.4 class 1.0 = 0.359 +- 0.392 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.4 all KL = 0.28 +- 0.392 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.4 all L1 = 0.359 +- 0.334 (in-sample avg dev_std = 0.284)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6479602888086643
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.166
SUFF_SIMPLE for r=0.8 class 1.0 = 0.291 +- 0.346 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.206 +- 0.346 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.291 +- 0.296 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.102
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6229849206349206
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.003
SUFF_SIMPLE for r=0.05 class 1.0 = 0.839 +- 0.234 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.05 all KL = 0.87 +- 0.234 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.05 all L1 = 0.839 +- 0.253 (in-sample avg dev_std = 0.073)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.102
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.45610277777777775
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.002
SUFF_SIMPLE for r=0.1 class 1.0 = 0.839 +- 0.234 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.1 all KL = 0.87 +- 0.234 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.1 all L1 = 0.839 +- 0.253 (in-sample avg dev_std = 0.068)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.102
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.33257182539682534
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.002
SUFF_SIMPLE for r=0.2 class 1.0 = 0.84 +- 0.234 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.2 all KL = 0.871 +- 0.234 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.2 all L1 = 0.84 +- 0.253 (in-sample avg dev_std = 0.056)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.102
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.26158333333333333
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.003
SUFF_SIMPLE for r=0.4 class 1.0 = 0.838 +- 0.239 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.4 all KL = 0.867 +- 0.239 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.4 all L1 = 0.838 +- 0.254 (in-sample avg dev_std = 0.076)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.102
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.24115833333333336
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.841 +- 0.233 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.873 +- 0.233 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.841 +- 0.254 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.936
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7820214748784441
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.824
SUFF_SIMPLE for r=0.05 class 1.0 = 0.754 +- 0.401 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.05 all KL = 0.701 +- 0.401 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.05 all L1 = 0.754 +- 0.299 (in-sample avg dev_std = 0.384)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.936
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8515162074554294
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.846
SUFF_SIMPLE for r=0.1 class 1.0 = 0.761 +- 0.395 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.1 all KL = 0.72 +- 0.395 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.1 all L1 = 0.761 +- 0.311 (in-sample avg dev_std = 0.306)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.936
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8911324959481361
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.821
SUFF_SIMPLE for r=0.2 class 1.0 = 0.744 +- 0.407 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.2 all KL = 0.71 +- 0.407 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.2 all L1 = 0.744 +- 0.335 (in-sample avg dev_std = 0.220)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.936
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9085854943273907
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.706
SUFF_SIMPLE for r=0.4 class 1.0 = 0.674 +- 0.443 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.4 all KL = 0.646 +- 0.443 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.4 all L1 = 0.674 +- 0.375 (in-sample avg dev_std = 0.150)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.936
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9033411669367909
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.862
SUFF_SIMPLE for r=0.8 class 1.0 = 0.863 +- 0.295 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all KL = 0.871 +- 0.295 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all L1 = 0.863 +- 0.256 (in-sample avg dev_std = 0.005)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7305703971119133
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.155
NEC for r=0.05 class 1.0 = 0.734 +- 0.268 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.836 +- 0.268 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.734 +- 0.229 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7937942238267147
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.036
NEC for r=0.1 class 1.0 = 0.801 +- 0.179 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.912 +- 0.179 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.801 +- 0.145 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7677364620938628
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.088
NEC for r=0.2 class 1.0 = 0.789 +- 0.145 (in-sample avg dev_std = 0.372)
NEC for r=0.2 all KL = 0.911 +- 0.145 (in-sample avg dev_std = 0.372)
NEC for r=0.2 all L1 = 0.789 +- 0.110 (in-sample avg dev_std = 0.372)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6989314079422383
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.296
NEC for r=0.4 class 1.0 = 0.672 +- 0.216 (in-sample avg dev_std = 0.569)
NEC for r=0.4 all KL = 0.807 +- 0.216 (in-sample avg dev_std = 0.569)
NEC for r=0.4 all L1 = 0.672 +- 0.188 (in-sample avg dev_std = 0.569)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6479602888086643
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.411
NEC for r=0.8 class 1.0 = 0.612 +- 0.256 (in-sample avg dev_std = 0.645)
NEC for r=0.8 all KL = 0.751 +- 0.256 (in-sample avg dev_std = 0.645)
NEC for r=0.8 all L1 = 0.612 +- 0.219 (in-sample avg dev_std = 0.645)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.102
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6229849206349206
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.158 +- 0.229 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.124 +- 0.229 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.158 +- 0.253 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.102
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.45610277777777775
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.158 +- 0.227 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.123 +- 0.227 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.158 +- 0.252 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.102
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.33257182539682534
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.001
NEC for r=0.2 class 1.0 = 0.157 +- 0.225 (in-sample avg dev_std = 0.037)
NEC for r=0.2 all KL = 0.121 +- 0.225 (in-sample avg dev_std = 0.037)
NEC for r=0.2 all L1 = 0.157 +- 0.250 (in-sample avg dev_std = 0.037)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.102
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.26158333333333333
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.023
NEC for r=0.4 class 1.0 = 0.168 +- 0.226 (in-sample avg dev_std = 0.190)
NEC for r=0.4 all KL = 0.146 +- 0.226 (in-sample avg dev_std = 0.190)
NEC for r=0.4 all L1 = 0.168 +- 0.241 (in-sample avg dev_std = 0.190)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.102
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.24115833333333336
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.007
NEC for r=0.8 class 1.0 = 0.16 +- 0.229 (in-sample avg dev_std = 0.106)
NEC for r=0.8 all KL = 0.129 +- 0.229 (in-sample avg dev_std = 0.106)
NEC for r=0.8 all L1 = 0.16 +- 0.250 (in-sample avg dev_std = 0.106)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.936
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7820214748784441
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.132
NEC for r=0.05 class 1.0 = 0.688 +- 0.345 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.773 +- 0.345 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.688 +- 0.292 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.936
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8515162074554294
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.116
NEC for r=0.1 class 1.0 = 0.704 +- 0.323 (in-sample avg dev_std = 0.164)
NEC for r=0.1 all KL = 0.797 +- 0.323 (in-sample avg dev_std = 0.164)
NEC for r=0.1 all L1 = 0.704 +- 0.274 (in-sample avg dev_std = 0.164)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.936
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8911324959481361
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.21
NEC for r=0.2 class 1.0 = 0.668 +- 0.308 (in-sample avg dev_std = 0.433)
NEC for r=0.2 all KL = 0.772 +- 0.308 (in-sample avg dev_std = 0.433)
NEC for r=0.2 all L1 = 0.668 +- 0.258 (in-sample avg dev_std = 0.433)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.936
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9085854943273907
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.426
NEC for r=0.4 class 1.0 = 0.531 +- 0.345 (in-sample avg dev_std = 0.538)
NEC for r=0.4 all KL = 0.63 +- 0.345 (in-sample avg dev_std = 0.538)
NEC for r=0.4 all L1 = 0.531 +- 0.282 (in-sample avg dev_std = 0.538)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.936
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9033411669367909
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.695
NEC for r=0.8 class 1.0 = 0.377 +- 0.350 (in-sample avg dev_std = 0.525)
NEC for r=0.8 all KL = 0.465 +- 0.350 (in-sample avg dev_std = 0.525)
NEC for r=0.8 all L1 = 0.377 +- 0.270 (in-sample avg dev_std = 0.525)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 19:02:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 07:02:12 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 07:02:12 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 07:02:12 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 07:02:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:02:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:02:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:02:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:02:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:02:12 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 07:02:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mChartInfo 0.9600 0.9600 0.9600 0.9600 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.677
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.747
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.754
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.733
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.714
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.538
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.413
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.337
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.304
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.298
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.774
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.829
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.865
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.887
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.898


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.989
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6774296028880867
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.128
SUFF_SIMPLE for r=0.05 class 1.0 = 0.21 +- 0.117 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.05 all KL = 0.042 +- 0.117 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.05 all L1 = 0.21 +- 0.128 (in-sample avg dev_std = 0.523)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.989
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7472924187725631
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.118
SUFF_SIMPLE for r=0.1 class 1.0 = 0.201 +- 0.116 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.1 all KL = 0.04 +- 0.116 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.1 all L1 = 0.201 +- 0.121 (in-sample avg dev_std = 0.511)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.989
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7538953068592057
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.104
SUFF_SIMPLE for r=0.2 class 1.0 = 0.193 +- 0.119 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 all KL = 0.039 +- 0.119 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 all L1 = 0.193 +- 0.110 (in-sample avg dev_std = 0.493)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7332851985559566
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.075
SUFF_SIMPLE for r=0.4 class 1.0 = 0.184 +- 0.149 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.4 all KL = 0.044 +- 0.149 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.4 all L1 = 0.184 +- 0.126 (in-sample avg dev_std = 0.388)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.989
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7143465703971118
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.253
SUFF_SIMPLE for r=0.8 class 1.0 = 0.356 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.255 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.356 +- 0.353 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.157
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5382329365079365
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.01
SUFF_SIMPLE for r=0.05 class 1.0 = 0.807 +- 0.308 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.05 all KL = 0.822 +- 0.308 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.05 all L1 = 0.807 +- 0.294 (in-sample avg dev_std = 0.147)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.157
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4132091269841271
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.008
SUFF_SIMPLE for r=0.1 class 1.0 = 0.807 +- 0.309 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.1 all KL = 0.823 +- 0.309 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.1 all L1 = 0.807 +- 0.295 (in-sample avg dev_std = 0.132)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.157
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.33721349206349205
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.004
SUFF_SIMPLE for r=0.2 class 1.0 = 0.809 +- 0.308 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.2 all KL = 0.826 +- 0.308 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.2 all L1 = 0.809 +- 0.296 (in-sample avg dev_std = 0.094)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.157
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3041480158730159
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.809 +- 0.308 (in-sample avg dev_std = 0.018)
SUFF_SIMPLE for r=0.4 all KL = 0.827 +- 0.308 (in-sample avg dev_std = 0.018)
SUFF_SIMPLE for r=0.4 all L1 = 0.809 +- 0.297 (in-sample avg dev_std = 0.018)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.157
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2983166666666667
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.809 +- 0.308 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.828 +- 0.308 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.809 +- 0.297 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7737374392220421
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.408
SUFF_SIMPLE for r=0.05 class 1.0 = 0.492 +- 0.405 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.05 all KL = 0.271 +- 0.405 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.05 all L1 = 0.492 +- 0.341 (in-sample avg dev_std = 0.550)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8294894651539708
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.424
SUFF_SIMPLE for r=0.1 class 1.0 = 0.524 +- 0.451 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.1 all KL = 0.35 +- 0.451 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.1 all L1 = 0.524 +- 0.369 (in-sample avg dev_std = 0.486)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8646859805510535
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.435
SUFF_SIMPLE for r=0.2 class 1.0 = 0.562 +- 0.476 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.2 all KL = 0.437 +- 0.476 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.2 all L1 = 0.562 +- 0.393 (in-sample avg dev_std = 0.408)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8868650729335494
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.463
SUFF_SIMPLE for r=0.4 class 1.0 = 0.598 +- 0.484 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.4 all KL = 0.508 +- 0.484 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.4 all L1 = 0.598 +- 0.406 (in-sample avg dev_std = 0.301)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.9
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8980008103727714
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.75
SUFF_SIMPLE for r=0.8 class 1.0 = 0.856 +- 0.357 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all KL = 0.831 +- 0.357 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all L1 = 0.856 +- 0.307 (in-sample avg dev_std = 0.001)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.989
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6774296028880867
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.043
NEC for r=0.05 class 1.0 = 0.816 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.955 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.816 +- 0.138 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.989
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7472924187725631
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.025
NEC for r=0.1 class 1.0 = 0.824 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.96 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.824 +- 0.108 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.989
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7538953068592057
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.081
NEC for r=0.2 class 1.0 = 0.807 +- 0.123 (in-sample avg dev_std = 0.346)
NEC for r=0.2 all KL = 0.96 +- 0.123 (in-sample avg dev_std = 0.346)
NEC for r=0.2 all L1 = 0.807 +- 0.107 (in-sample avg dev_std = 0.346)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.989
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7332851985559566
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.16
NEC for r=0.4 class 1.0 = 0.767 +- 0.126 (in-sample avg dev_std = 0.531)
NEC for r=0.4 all KL = 0.951 +- 0.126 (in-sample avg dev_std = 0.531)
NEC for r=0.4 all L1 = 0.767 +- 0.139 (in-sample avg dev_std = 0.531)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.989
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7143465703971118
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.289
NEC for r=0.8 class 1.0 = 0.699 +- 0.181 (in-sample avg dev_std = 0.660)
NEC for r=0.8 all KL = 0.919 +- 0.181 (in-sample avg dev_std = 0.660)
NEC for r=0.8 all L1 = 0.699 +- 0.190 (in-sample avg dev_std = 0.660)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.157
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5382329365079365
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.008
NEC for r=0.05 class 1.0 = 0.187 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.169 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.187 +- 0.293 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.157
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4132091269841271
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.009
NEC for r=0.1 class 1.0 = 0.187 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.168 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.187 +- 0.292 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.157
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.33721349206349205
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.015
NEC for r=0.2 class 1.0 = 0.192 +- 0.306 (in-sample avg dev_std = 0.093)
NEC for r=0.2 all KL = 0.175 +- 0.306 (in-sample avg dev_std = 0.093)
NEC for r=0.2 all L1 = 0.192 +- 0.293 (in-sample avg dev_std = 0.093)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.157
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3041480158730159
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.026
NEC for r=0.4 class 1.0 = 0.19 +- 0.305 (in-sample avg dev_std = 0.209)
NEC for r=0.4 all KL = 0.178 +- 0.305 (in-sample avg dev_std = 0.209)
NEC for r=0.4 all L1 = 0.19 +- 0.285 (in-sample avg dev_std = 0.209)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.157
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2983166666666667
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.027
NEC for r=0.8 class 1.0 = 0.19 +- 0.305 (in-sample avg dev_std = 0.202)
NEC for r=0.8 all KL = 0.179 +- 0.305 (in-sample avg dev_std = 0.202)
NEC for r=0.8 all L1 = 0.19 +- 0.287 (in-sample avg dev_std = 0.202)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7737374392220421
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.04
NEC for r=0.05 class 1.0 = 0.747 +- 0.293 (in-sample avg dev_std = 0.019)
NEC for r=0.05 all KL = 0.889 +- 0.293 (in-sample avg dev_std = 0.019)
NEC for r=0.05 all L1 = 0.747 +- 0.259 (in-sample avg dev_std = 0.019)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8294894651539708
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.041
NEC for r=0.1 class 1.0 = 0.751 +- 0.288 (in-sample avg dev_std = 0.180)
NEC for r=0.1 all KL = 0.895 +- 0.288 (in-sample avg dev_std = 0.180)
NEC for r=0.1 all L1 = 0.751 +- 0.250 (in-sample avg dev_std = 0.180)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8646859805510535
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.116
NEC for r=0.2 class 1.0 = 0.723 +- 0.292 (in-sample avg dev_std = 0.439)
NEC for r=0.2 all KL = 0.893 +- 0.292 (in-sample avg dev_std = 0.439)
NEC for r=0.2 all L1 = 0.723 +- 0.248 (in-sample avg dev_std = 0.439)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8868650729335494
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.263
NEC for r=0.4 class 1.0 = 0.636 +- 0.303 (in-sample avg dev_std = 0.582)
NEC for r=0.4 all KL = 0.868 +- 0.303 (in-sample avg dev_std = 0.582)
NEC for r=0.4 all L1 = 0.636 +- 0.268 (in-sample avg dev_std = 0.582)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8980008103727714
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.407
NEC for r=0.8 class 1.0 = 0.559 +- 0.279 (in-sample avg dev_std = 0.658)
NEC for r=0.8 all KL = 0.854 +- 0.279 (in-sample avg dev_std = 0.658)
NEC for r=0.8 all L1 = 0.559 +- 0.266 (in-sample avg dev_std = 0.658)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 19:07:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 07:07:48 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 07:07:48 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 07:07:48 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 07:07:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:07:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:07:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:07:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:07:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:07:48 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 07:07:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mChartInfo 0.9620 0.9620 0.9620 0.9620 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.726
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.794
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.794
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.768
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.745
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.535
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.391
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.307
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.268
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.261
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.777
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.837
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.877
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.897
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.904


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7260072202166065
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.124
SUFF_SIMPLE for r=0.05 class 1.0 = 0.215 +- 0.140 (in-sample avg dev_std = 0.540)
SUFF_SIMPLE for r=0.05 all KL = 0.064 +- 0.140 (in-sample avg dev_std = 0.540)
SUFF_SIMPLE for r=0.05 all L1 = 0.215 +- 0.125 (in-sample avg dev_std = 0.540)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7935162454873648
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.14
SUFF_SIMPLE for r=0.1 class 1.0 = 0.22 +- 0.147 (in-sample avg dev_std = 0.540)
SUFF_SIMPLE for r=0.1 all KL = 0.069 +- 0.147 (in-sample avg dev_std = 0.540)
SUFF_SIMPLE for r=0.1 all L1 = 0.22 +- 0.138 (in-sample avg dev_std = 0.540)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7935523465703971
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.17
SUFF_SIMPLE for r=0.2 class 1.0 = 0.252 +- 0.223 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.2 all KL = 0.108 +- 0.223 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.2 all L1 = 0.252 +- 0.202 (in-sample avg dev_std = 0.494)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7679638989169675
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.116
SUFF_SIMPLE for r=0.4 class 1.0 = 0.228 +- 0.244 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.4 all KL = 0.108 +- 0.244 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.4 all L1 = 0.228 +- 0.210 (in-sample avg dev_std = 0.324)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7447906137184116
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.242
SUFF_SIMPLE for r=0.8 class 1.0 = 0.353 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.267 +- 0.400 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.353 +- 0.346 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.133
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5349789682539682
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.002
SUFF_SIMPLE for r=0.05 class 1.0 = 0.846 +- 0.289 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.05 all KL = 0.859 +- 0.289 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.05 all L1 = 0.846 +- 0.281 (in-sample avg dev_std = 0.067)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.133
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.391484126984127
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.001
SUFF_SIMPLE for r=0.1 class 1.0 = 0.846 +- 0.289 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.1 all KL = 0.859 +- 0.289 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.1 all L1 = 0.846 +- 0.281 (in-sample avg dev_std = 0.059)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.133
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3066809523809524
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
SUFF_SIMPLE for r=0.2 class 1.0 = 0.846 +- 0.289 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 all KL = 0.859 +- 0.289 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 all L1 = 0.846 +- 0.281 (in-sample avg dev_std = 0.032)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.133
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2684484126984127
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.846 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.859 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.846 +- 0.282 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.133
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2607694444444444
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.846 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.859 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.846 +- 0.282 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.916
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7772366288492708
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.523
SUFF_SIMPLE for r=0.05 class 1.0 = 0.62 +- 0.458 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.05 all KL = 0.533 +- 0.458 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.05 all L1 = 0.62 +- 0.386 (in-sample avg dev_std = 0.298)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.916
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8372512155591573
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.526
SUFF_SIMPLE for r=0.1 class 1.0 = 0.628 +- 0.459 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.1 all KL = 0.55 +- 0.459 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.1 all L1 = 0.628 +- 0.390 (in-sample avg dev_std = 0.244)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.916
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8769432739059967
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.524
SUFF_SIMPLE for r=0.2 class 1.0 = 0.624 +- 0.461 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.2 all KL = 0.551 +- 0.461 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.2 all L1 = 0.624 +- 0.396 (in-sample avg dev_std = 0.189)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.916
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8974663695299838
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.528
SUFF_SIMPLE for r=0.4 class 1.0 = 0.626 +- 0.460 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.4 all KL = 0.551 +- 0.460 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.4 all L1 = 0.626 +- 0.396 (in-sample avg dev_std = 0.176)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.916
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9035705024311182
len(reference) = 2467
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.807
SUFF_SIMPLE for r=0.8 class 1.0 = 0.864 +- 0.328 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.8 all KL = 0.839 +- 0.328 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.8 all L1 = 0.864 +- 0.276 (in-sample avg dev_std = 0.016)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7260072202166065
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.072
NEC for r=0.05 class 1.0 = 0.793 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.916 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.793 +- 0.165 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7935162454873648
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.043
NEC for r=0.1 class 1.0 = 0.806 +- 0.156 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.93 +- 0.156 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.806 +- 0.128 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7935523465703971
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.067
NEC for r=0.2 class 1.0 = 0.806 +- 0.139 (in-sample avg dev_std = 0.309)
NEC for r=0.2 all KL = 0.939 +- 0.139 (in-sample avg dev_std = 0.309)
NEC for r=0.2 all L1 = 0.806 +- 0.109 (in-sample avg dev_std = 0.309)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7679638989169675
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.141
NEC for r=0.4 class 1.0 = 0.775 +- 0.147 (in-sample avg dev_std = 0.523)
NEC for r=0.4 all KL = 0.93 +- 0.147 (in-sample avg dev_std = 0.523)
NEC for r=0.4 all L1 = 0.775 +- 0.125 (in-sample avg dev_std = 0.523)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7447906137184116
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.266
NEC for r=0.8 class 1.0 = 0.707 +- 0.184 (in-sample avg dev_std = 0.644)
NEC for r=0.8 all KL = 0.891 +- 0.184 (in-sample avg dev_std = 0.644)
NEC for r=0.8 all L1 = 0.707 +- 0.178 (in-sample avg dev_std = 0.644)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.133
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5349789682539682
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.011
NEC for r=0.05 class 1.0 = 0.147 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.132 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.147 +- 0.271 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.133
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.391484126984127
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.031
NEC for r=0.1 class 1.0 = 0.143 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.127 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.143 +- 0.266 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.133
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3066809523809524
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.037
NEC for r=0.2 class 1.0 = 0.149 +- 0.274 (in-sample avg dev_std = 0.109)
NEC for r=0.2 all KL = 0.134 +- 0.274 (in-sample avg dev_std = 0.109)
NEC for r=0.2 all L1 = 0.149 +- 0.267 (in-sample avg dev_std = 0.109)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.133
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2684484126984127
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.017
NEC for r=0.4 class 1.0 = 0.149 +- 0.280 (in-sample avg dev_std = 0.181)
NEC for r=0.4 all KL = 0.139 +- 0.280 (in-sample avg dev_std = 0.181)
NEC for r=0.4 all L1 = 0.149 +- 0.269 (in-sample avg dev_std = 0.181)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.133
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2607694444444444
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.017
NEC for r=0.8 class 1.0 = 0.149 +- 0.281 (in-sample avg dev_std = 0.181)
NEC for r=0.8 all KL = 0.138 +- 0.281 (in-sample avg dev_std = 0.181)
NEC for r=0.8 all L1 = 0.149 +- 0.269 (in-sample avg dev_std = 0.181)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.916
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7772366288492708
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.061
NEC for r=0.05 class 1.0 = 0.733 +- 0.322 (in-sample avg dev_std = 0.050)
NEC for r=0.05 all KL = 0.857 +- 0.322 (in-sample avg dev_std = 0.050)
NEC for r=0.05 all L1 = 0.733 +- 0.269 (in-sample avg dev_std = 0.050)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.916
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8372512155591573
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.066
NEC for r=0.1 class 1.0 = 0.741 +- 0.304 (in-sample avg dev_std = 0.235)
NEC for r=0.1 all KL = 0.875 +- 0.304 (in-sample avg dev_std = 0.235)
NEC for r=0.1 all L1 = 0.741 +- 0.253 (in-sample avg dev_std = 0.235)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.916
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8769432739059967
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.144
NEC for r=0.2 class 1.0 = 0.715 +- 0.285 (in-sample avg dev_std = 0.416)
NEC for r=0.2 all KL = 0.882 +- 0.285 (in-sample avg dev_std = 0.416)
NEC for r=0.2 all L1 = 0.715 +- 0.247 (in-sample avg dev_std = 0.416)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.916
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8974663695299838
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.289
NEC for r=0.4 class 1.0 = 0.631 +- 0.303 (in-sample avg dev_std = 0.552)
NEC for r=0.4 all KL = 0.836 +- 0.303 (in-sample avg dev_std = 0.552)
NEC for r=0.4 all L1 = 0.631 +- 0.273 (in-sample avg dev_std = 0.552)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.916
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9035705024311182
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.445
NEC for r=0.8 class 1.0 = 0.532 +- 0.318 (in-sample avg dev_std = 0.617)
NEC for r=0.8 all KL = 0.767 +- 0.318 (in-sample avg dev_std = 0.617)
NEC for r=0.8 all L1 = 0.532 +- 0.284 (in-sample avg dev_std = 0.617)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 19:13:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 07:13:24 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 07:13:24 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 07:13:24 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 07:13:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:13:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:13:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:13:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:13:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:13:24 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 07:13:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mChartInfo 0.9440 0.9440 0.9440 0.9440 0.9680 0.9680[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.761
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.795
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.766
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.722
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.694
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.526
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.364
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.261
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.211
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.200
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.790
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.840
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.867
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.884
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.895


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7611263537906137
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.051
SUFF_SIMPLE for r=0.05 class 1.0 = 0.174 +- 0.125 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.05 all KL = 0.05 +- 0.125 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.05 all L1 = 0.174 +- 0.082 (in-sample avg dev_std = 0.354)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.795043321299639
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.03
SUFF_SIMPLE for r=0.1 class 1.0 = 0.168 +- 0.125 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.1 all KL = 0.049 +- 0.125 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.1 all L1 = 0.168 +- 0.080 (in-sample avg dev_std = 0.302)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7663176895306859
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.023
SUFF_SIMPLE for r=0.2 class 1.0 = 0.165 +- 0.125 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 all KL = 0.048 +- 0.125 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 all L1 = 0.165 +- 0.078 (in-sample avg dev_std = 0.269)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7223032490974728
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.014
SUFF_SIMPLE for r=0.4 class 1.0 = 0.164 +- 0.139 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.4 all KL = 0.052 +- 0.139 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.4 all L1 = 0.164 +- 0.098 (in-sample avg dev_std = 0.145)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6939314079422383
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.231
SUFF_SIMPLE for r=0.8 class 1.0 = 0.335 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.245 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.335 +- 0.328 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.082
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5261436507936508
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
SUFF_SIMPLE for r=0.05 class 1.0 = 0.889 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.907 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.889 +- 0.233 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.082
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3638369047619048
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
SUFF_SIMPLE for r=0.1 class 1.0 = 0.889 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.907 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.889 +- 0.233 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.082
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26057063492063487
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
SUFF_SIMPLE for r=0.2 class 1.0 = 0.889 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.907 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.889 +- 0.233 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.082
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.21059166666666668
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.889 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.907 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.889 +- 0.233 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.082
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.20013928571428571
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.889 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.907 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.889 +- 0.233 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.889
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7903650729335495
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.437
SUFF_SIMPLE for r=0.05 class 1.0 = 0.453 +- 0.349 (in-sample avg dev_std = 0.605)
SUFF_SIMPLE for r=0.05 all KL = 0.292 +- 0.349 (in-sample avg dev_std = 0.605)
SUFF_SIMPLE for r=0.05 all L1 = 0.453 +- 0.309 (in-sample avg dev_std = 0.605)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.889
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8395352512155592
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.411
SUFF_SIMPLE for r=0.1 class 1.0 = 0.469 +- 0.382 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.1 all KL = 0.328 +- 0.382 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.1 all L1 = 0.469 +- 0.331 (in-sample avg dev_std = 0.562)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.889
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8665384927066452
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.387
SUFF_SIMPLE for r=0.2 class 1.0 = 0.502 +- 0.414 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.2 all KL = 0.382 +- 0.414 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.2 all L1 = 0.502 +- 0.355 (in-sample avg dev_std = 0.518)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.889
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8838942463533226
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.384
SUFF_SIMPLE for r=0.4 class 1.0 = 0.509 +- 0.444 (in-sample avg dev_std = 0.492)
SUFF_SIMPLE for r=0.4 all KL = 0.405 +- 0.444 (in-sample avg dev_std = 0.492)
SUFF_SIMPLE for r=0.4 all L1 = 0.509 +- 0.373 (in-sample avg dev_std = 0.492)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.892
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.895316450567261
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.665
SUFF_SIMPLE for r=0.8 class 1.0 = 0.788 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.762 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.788 +- 0.356 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7611263537906137
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.029
NEC for r=0.05 class 1.0 = 0.812 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.933 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.812 +- 0.131 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.795043321299639
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.022
NEC for r=0.1 class 1.0 = 0.816 +- 0.128 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.942 +- 0.128 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.816 +- 0.092 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7663176895306859
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.046
NEC for r=0.2 class 1.0 = 0.808 +- 0.146 (in-sample avg dev_std = 0.182)
NEC for r=0.2 all KL = 0.934 +- 0.146 (in-sample avg dev_std = 0.182)
NEC for r=0.2 all L1 = 0.808 +- 0.119 (in-sample avg dev_std = 0.182)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7223032490974728
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.083
NEC for r=0.4 class 1.0 = 0.798 +- 0.159 (in-sample avg dev_std = 0.393)
NEC for r=0.4 all KL = 0.931 +- 0.159 (in-sample avg dev_std = 0.393)
NEC for r=0.4 all L1 = 0.798 +- 0.123 (in-sample avg dev_std = 0.393)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6939314079422383
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.183
NEC for r=0.8 class 1.0 = 0.762 +- 0.164 (in-sample avg dev_std = 0.582)
NEC for r=0.8 all KL = 0.914 +- 0.164 (in-sample avg dev_std = 0.582)
NEC for r=0.8 all L1 = 0.762 +- 0.136 (in-sample avg dev_std = 0.582)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.082
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5261436507936508
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.11 +- 0.220 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.091 +- 0.220 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.11 +- 0.231 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.082
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3638369047619048
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.108 +- 0.215 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.087 +- 0.215 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.108 +- 0.229 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.082
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26057063492063487
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
NEC for r=0.2 class 1.0 = 0.106 +- 0.212 (in-sample avg dev_std = 0.023)
NEC for r=0.2 all KL = 0.084 +- 0.212 (in-sample avg dev_std = 0.023)
NEC for r=0.2 all L1 = 0.106 +- 0.227 (in-sample avg dev_std = 0.023)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.082
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.21059166666666668
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.001
NEC for r=0.4 class 1.0 = 0.111 +- 0.224 (in-sample avg dev_std = 0.042)
NEC for r=0.4 all KL = 0.093 +- 0.224 (in-sample avg dev_std = 0.042)
NEC for r=0.4 all L1 = 0.111 +- 0.232 (in-sample avg dev_std = 0.042)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.082
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.20013928571428571
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.111 +- 0.224 (in-sample avg dev_std = 0.028)
NEC for r=0.8 all KL = 0.093 +- 0.224 (in-sample avg dev_std = 0.028)
NEC for r=0.8 all L1 = 0.111 +- 0.232 (in-sample avg dev_std = 0.028)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.889
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7903650729335495
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.041
NEC for r=0.05 class 1.0 = 0.732 +- 0.314 (in-sample avg dev_std = 0.017)
NEC for r=0.05 all KL = 0.854 +- 0.314 (in-sample avg dev_std = 0.017)
NEC for r=0.05 all L1 = 0.732 +- 0.270 (in-sample avg dev_std = 0.017)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.889
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8395352512155592
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.028
NEC for r=0.1 class 1.0 = 0.74 +- 0.303 (in-sample avg dev_std = 0.145)
NEC for r=0.1 all KL = 0.864 +- 0.303 (in-sample avg dev_std = 0.145)
NEC for r=0.1 all L1 = 0.74 +- 0.259 (in-sample avg dev_std = 0.145)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.889
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8665384927066452
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.061
NEC for r=0.2 class 1.0 = 0.727 +- 0.302 (in-sample avg dev_std = 0.319)
NEC for r=0.2 all KL = 0.858 +- 0.302 (in-sample avg dev_std = 0.319)
NEC for r=0.2 all L1 = 0.727 +- 0.257 (in-sample avg dev_std = 0.319)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.889
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8838942463533226
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.169
NEC for r=0.4 class 1.0 = 0.669 +- 0.319 (in-sample avg dev_std = 0.494)
NEC for r=0.4 all KL = 0.809 +- 0.319 (in-sample avg dev_std = 0.494)
NEC for r=0.4 all L1 = 0.669 +- 0.275 (in-sample avg dev_std = 0.494)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.889
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.895316450567261
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.301
NEC for r=0.8 class 1.0 = 0.64 +- 0.275 (in-sample avg dev_std = 0.653)
NEC for r=0.8 all KL = 0.812 +- 0.275 (in-sample avg dev_std = 0.653)
NEC for r=0.8 all L1 = 0.64 +- 0.243 (in-sample avg dev_std = 0.653)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 19:19:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 07:19:11 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 07:19:11 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 07:19:11 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 07:19:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:19:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:19:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:19:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:19:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:19:11 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 07:19:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mChartInfo 0.9500 0.9500 0.9500 0.9500 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.712
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.783
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.779
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.752
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.730
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.572
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.434
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.350
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.314
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.308
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.772
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.825
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.860
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.880
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.896


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7116606498194946
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.061
SUFF_SIMPLE for r=0.05 class 1.0 = 0.176 +- 0.119 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.05 all KL = 0.055 +- 0.119 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.05 all L1 = 0.176 +- 0.076 (in-sample avg dev_std = 0.384)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7827003610108303
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.051
SUFF_SIMPLE for r=0.1 class 1.0 = 0.173 +- 0.121 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.1 all KL = 0.054 +- 0.121 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.1 all L1 = 0.173 +- 0.077 (in-sample avg dev_std = 0.368)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7794079422382671
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.043
SUFF_SIMPLE for r=0.2 class 1.0 = 0.172 +- 0.117 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.2 all KL = 0.053 +- 0.117 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.2 all L1 = 0.172 +- 0.079 (in-sample avg dev_std = 0.331)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7522454873646209
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.019
SUFF_SIMPLE for r=0.4 class 1.0 = 0.165 +- 0.141 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.4 all KL = 0.056 +- 0.141 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.4 all L1 = 0.165 +- 0.098 (in-sample avg dev_std = 0.181)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7304837545126354
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.202
SUFF_SIMPLE for r=0.8 class 1.0 = 0.315 +- 0.371 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.229 +- 0.371 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.315 +- 0.316 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.126
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.571809126984127
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
SUFF_SIMPLE for r=0.05 class 1.0 = 0.823 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.854 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.823 +- 0.269 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.126
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.433838492063492
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
SUFF_SIMPLE for r=0.1 class 1.0 = 0.823 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.854 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.823 +- 0.269 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.126
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3500595238095238
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
SUFF_SIMPLE for r=0.2 class 1.0 = 0.823 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.854 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.823 +- 0.269 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.126
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.314218253968254
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.823 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.854 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.823 +- 0.269 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.126
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.30808214285714286
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.823 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.854 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.823 +- 0.269 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7716114262560778
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.476
SUFF_SIMPLE for r=0.05 class 1.0 = 0.487 +- 0.408 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.05 all KL = 0.372 +- 0.408 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.05 all L1 = 0.487 +- 0.331 (in-sample avg dev_std = 0.506)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.825064829821718
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.467
SUFF_SIMPLE for r=0.1 class 1.0 = 0.528 +- 0.434 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.1 all KL = 0.44 +- 0.434 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.1 all L1 = 0.528 +- 0.355 (in-sample avg dev_std = 0.434)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8598087520259319
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.453
SUFF_SIMPLE for r=0.2 class 1.0 = 0.572 +- 0.451 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.2 all KL = 0.512 +- 0.451 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.2 all L1 = 0.572 +- 0.376 (in-sample avg dev_std = 0.339)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8798156401944895
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.474
SUFF_SIMPLE for r=0.4 class 1.0 = 0.593 +- 0.458 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.4 all KL = 0.536 +- 0.458 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.4 all L1 = 0.593 +- 0.380 (in-sample avg dev_std = 0.309)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.885
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8958541329011345
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.748
SUFF_SIMPLE for r=0.8 class 1.0 = 0.849 +- 0.338 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all KL = 0.845 +- 0.338 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all L1 = 0.849 +- 0.293 (in-sample avg dev_std = 0.001)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7116606498194946
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.007
NEC for r=0.05 class 1.0 = 0.831 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.943 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.831 +- 0.085 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7827003610108303
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.032
NEC for r=0.1 class 1.0 = 0.816 +- 0.132 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.933 +- 0.132 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.816 +- 0.101 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7794079422382671
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.034
NEC for r=0.2 class 1.0 = 0.813 +- 0.144 (in-sample avg dev_std = 0.188)
NEC for r=0.2 all KL = 0.932 +- 0.144 (in-sample avg dev_std = 0.188)
NEC for r=0.2 all L1 = 0.813 +- 0.111 (in-sample avg dev_std = 0.188)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7522454873646209
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.059
NEC for r=0.4 class 1.0 = 0.814 +- 0.135 (in-sample avg dev_std = 0.340)
NEC for r=0.4 all KL = 0.939 +- 0.135 (in-sample avg dev_std = 0.340)
NEC for r=0.4 all L1 = 0.814 +- 0.097 (in-sample avg dev_std = 0.340)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7304837545126354
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.18
NEC for r=0.8 class 1.0 = 0.756 +- 0.214 (in-sample avg dev_std = 0.559)
NEC for r=0.8 all KL = 0.891 +- 0.214 (in-sample avg dev_std = 0.559)
NEC for r=0.8 all L1 = 0.756 +- 0.173 (in-sample avg dev_std = 0.559)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.126
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.571809126984127
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.001
NEC for r=0.05 class 1.0 = 0.175 +- 0.253 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.141 +- 0.253 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.175 +- 0.266 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.126
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.433838492063492
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.001
NEC for r=0.1 class 1.0 = 0.173 +- 0.250 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.138 +- 0.250 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.173 +- 0.265 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.126
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.3500595238095238
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
NEC for r=0.2 class 1.0 = 0.173 +- 0.250 (in-sample avg dev_std = 0.031)
NEC for r=0.2 all KL = 0.138 +- 0.250 (in-sample avg dev_std = 0.031)
NEC for r=0.2 all L1 = 0.173 +- 0.265 (in-sample avg dev_std = 0.031)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.126
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.314218253968254
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.001
NEC for r=0.4 class 1.0 = 0.177 +- 0.258 (in-sample avg dev_std = 0.045)
NEC for r=0.4 all KL = 0.146 +- 0.258 (in-sample avg dev_std = 0.045)
NEC for r=0.4 all L1 = 0.177 +- 0.268 (in-sample avg dev_std = 0.045)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.126
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.30808214285714286
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.177 +- 0.258 (in-sample avg dev_std = 0.024)
NEC for r=0.8 all KL = 0.146 +- 0.258 (in-sample avg dev_std = 0.024)
NEC for r=0.8 all L1 = 0.177 +- 0.269 (in-sample avg dev_std = 0.024)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7716114262560778
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.052
NEC for r=0.05 class 1.0 = 0.728 +- 0.302 (in-sample avg dev_std = 0.008)
NEC for r=0.05 all KL = 0.839 +- 0.302 (in-sample avg dev_std = 0.008)
NEC for r=0.05 all L1 = 0.728 +- 0.272 (in-sample avg dev_std = 0.008)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.825064829821718
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.047
NEC for r=0.1 class 1.0 = 0.73 +- 0.297 (in-sample avg dev_std = 0.088)
NEC for r=0.1 all KL = 0.847 +- 0.297 (in-sample avg dev_std = 0.088)
NEC for r=0.1 all L1 = 0.73 +- 0.269 (in-sample avg dev_std = 0.088)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8598087520259319
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.065
NEC for r=0.2 class 1.0 = 0.725 +- 0.302 (in-sample avg dev_std = 0.237)
NEC for r=0.2 all KL = 0.845 +- 0.302 (in-sample avg dev_std = 0.237)
NEC for r=0.2 all L1 = 0.725 +- 0.270 (in-sample avg dev_std = 0.237)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8798156401944895
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.156
NEC for r=0.4 class 1.0 = 0.695 +- 0.309 (in-sample avg dev_std = 0.459)
NEC for r=0.4 all KL = 0.82 +- 0.309 (in-sample avg dev_std = 0.459)
NEC for r=0.4 all L1 = 0.695 +- 0.268 (in-sample avg dev_std = 0.459)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.883
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8958541329011345
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.312
NEC for r=0.8 class 1.0 = 0.65 +- 0.290 (in-sample avg dev_std = 0.658)
NEC for r=0.8 all KL = 0.806 +- 0.290 (in-sample avg dev_std = 0.658)
NEC for r=0.8 all L1 = 0.65 +- 0.251 (in-sample avg dev_std = 0.658)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 19:24:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 07:24:51 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 07:24:51 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 07:24:51 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 07:24:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:24:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:24:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:24:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:24:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:24:51 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 07:24:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mChartInfo 0.9460 0.9460 0.9460 0.9460 0.9560 0.9560[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.709
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.707
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.613
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.508
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.442
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.441
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.272
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.167
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.111
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.092
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.749
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.792
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.813
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.827
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.838


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.971
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7093465703971118
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.009
SUFF_SIMPLE for r=0.05 class 1.0 = 0.171 +- 0.134 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.05 all KL = 0.083 +- 0.134 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.05 all L1 = 0.171 +- 0.076 (in-sample avg dev_std = 0.137)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.971
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7065270758122745
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.019
SUFF_SIMPLE for r=0.1 class 1.0 = 0.175 +- 0.135 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.1 all KL = 0.086 +- 0.135 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.1 all L1 = 0.175 +- 0.080 (in-sample avg dev_std = 0.225)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.971
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6131227436823103
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.097
SUFF_SIMPLE for r=0.2 class 1.0 = 0.244 +- 0.268 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.2 all KL = 0.167 +- 0.268 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.2 all L1 = 0.244 +- 0.220 (in-sample avg dev_std = 0.177)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.971
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5076064981949457
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.039
SUFF_SIMPLE for r=0.4 class 1.0 = 0.197 +- 0.207 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.4 all KL = 0.116 +- 0.207 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.4 all L1 = 0.197 +- 0.158 (in-sample avg dev_std = 0.098)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.971
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.4418880866425993
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.072
SUFF_SIMPLE for r=0.8 class 1.0 = 0.224 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.147 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.224 +- 0.213 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.034
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.440875
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.937 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.034
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.27219365079365077
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.937 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.91 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.034
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.16720793650793653
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.937 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.91 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.034
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11055158730158729
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.937 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.91 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.034
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09234603174603175
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.937 +- 0.143 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.177 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.865
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7488812803889789
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.513
SUFF_SIMPLE for r=0.05 class 1.0 = 0.63 +- 0.461 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.05 all KL = 0.553 +- 0.461 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.05 all L1 = 0.63 +- 0.378 (in-sample avg dev_std = 0.255)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.865
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7921794975688817
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.525
SUFF_SIMPLE for r=0.1 class 1.0 = 0.648 +- 0.455 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.1 all KL = 0.588 +- 0.455 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.1 all L1 = 0.648 +- 0.379 (in-sample avg dev_std = 0.191)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.865
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8125721231766612
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.503
SUFF_SIMPLE for r=0.2 class 1.0 = 0.647 +- 0.457 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.2 all KL = 0.608 +- 0.457 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.2 all L1 = 0.647 +- 0.393 (in-sample avg dev_std = 0.155)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.865
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8265968395461912
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.499
SUFF_SIMPLE for r=0.4 class 1.0 = 0.648 +- 0.458 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.4 all KL = 0.613 +- 0.458 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.4 all L1 = 0.648 +- 0.395 (in-sample avg dev_std = 0.147)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.868
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.837620340356564
len(reference) = 2455
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.734
SUFF_SIMPLE for r=0.8 class 1.0 = 0.856 +- 0.329 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all KL = 0.855 +- 0.329 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all L1 = 0.856 +- 0.290 (in-sample avg dev_std = 0.001)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.971
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7093465703971118
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.043
NEC for r=0.05 class 1.0 = 0.801 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.887 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.801 +- 0.139 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.971
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7065270758122745
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.822 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.91 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.822 +- 0.075 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.971
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6131227436823103
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.001
NEC for r=0.2 class 1.0 = 0.824 +- 0.136 (in-sample avg dev_std = 0.053)
NEC for r=0.2 all KL = 0.912 +- 0.136 (in-sample avg dev_std = 0.053)
NEC for r=0.2 all L1 = 0.824 +- 0.075 (in-sample avg dev_std = 0.053)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.971
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5076064981949457
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.019
NEC for r=0.4 class 1.0 = 0.821 +- 0.137 (in-sample avg dev_std = 0.172)
NEC for r=0.4 all KL = 0.912 +- 0.137 (in-sample avg dev_std = 0.172)
NEC for r=0.4 all L1 = 0.821 +- 0.084 (in-sample avg dev_std = 0.172)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.971
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.4418880866425993
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.062
NEC for r=0.8 class 1.0 = 0.802 +- 0.170 (in-sample avg dev_std = 0.276)
NEC for r=0.8 all KL = 0.893 +- 0.170 (in-sample avg dev_std = 0.276)
NEC for r=0.8 all L1 = 0.802 +- 0.125 (in-sample avg dev_std = 0.276)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.034
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.440875
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.09 +- 0.141 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.062 +- 0.141 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.09 +- 0.176 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.034
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.27219365079365077
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.09 +- 0.141 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.062 +- 0.141 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.09 +- 0.176 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.034
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.16720793650793653
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
NEC for r=0.2 class 1.0 = 0.09 +- 0.139 (in-sample avg dev_std = 0.004)
NEC for r=0.2 all KL = 0.061 +- 0.139 (in-sample avg dev_std = 0.004)
NEC for r=0.2 all L1 = 0.09 +- 0.176 (in-sample avg dev_std = 0.004)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.034
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.11055158730158729
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.09 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.063 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.09 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.034
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09234603174603175
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.09 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.063 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.09 +- 0.177 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.865
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7488812803889789
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.094
NEC for r=0.05 class 1.0 = 0.73 +- 0.315 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.828 +- 0.315 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.73 +- 0.271 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.865
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7921794975688817
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.063
NEC for r=0.1 class 1.0 = 0.751 +- 0.292 (in-sample avg dev_std = 0.037)
NEC for r=0.1 all KL = 0.851 +- 0.292 (in-sample avg dev_std = 0.037)
NEC for r=0.1 all L1 = 0.751 +- 0.250 (in-sample avg dev_std = 0.037)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.865
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8125721231766612
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.046
NEC for r=0.2 class 1.0 = 0.739 +- 0.305 (in-sample avg dev_std = 0.238)
NEC for r=0.2 all KL = 0.841 +- 0.305 (in-sample avg dev_std = 0.238)
NEC for r=0.2 all L1 = 0.739 +- 0.260 (in-sample avg dev_std = 0.238)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.865
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8265968395461912
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.129
NEC for r=0.4 class 1.0 = 0.695 +- 0.307 (in-sample avg dev_std = 0.502)
NEC for r=0.4 all KL = 0.814 +- 0.307 (in-sample avg dev_std = 0.502)
NEC for r=0.4 all L1 = 0.695 +- 0.266 (in-sample avg dev_std = 0.502)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.865
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.837620340356564
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.322
NEC for r=0.8 class 1.0 = 0.617 +- 0.281 (in-sample avg dev_std = 0.659)
NEC for r=0.8 all KL = 0.775 +- 0.281 (in-sample avg dev_std = 0.659)
NEC for r=0.8 all L1 = 0.617 +- 0.255 (in-sample avg dev_std = 0.659)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 19:30:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 07:30:41 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 07:30:41 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 07:30:41 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 07:30:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:30:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:30:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:30:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:30:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:30:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 07:30:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mChartInfo 0.9660 0.9660 0.9660 0.9660 0.9720 0.9720[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.745
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.794
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.773
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.730
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.700
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.521
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.364
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.269
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.224
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.213
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.750
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.816
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.854
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.876
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.881


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7449927797833935
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.064
SUFF_SIMPLE for r=0.05 class 1.0 = 0.183 +- 0.131 (in-sample avg dev_std = 0.398)
SUFF_SIMPLE for r=0.05 all KL = 0.064 +- 0.131 (in-sample avg dev_std = 0.398)
SUFF_SIMPLE for r=0.05 all L1 = 0.183 +- 0.092 (in-sample avg dev_std = 0.398)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7939638989169675
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.074
SUFF_SIMPLE for r=0.1 class 1.0 = 0.187 +- 0.130 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.1 all KL = 0.065 +- 0.130 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.1 all L1 = 0.187 +- 0.091 (in-sample avg dev_std = 0.432)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7727148014440433
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.157
SUFF_SIMPLE for r=0.2 class 1.0 = 0.237 +- 0.233 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.2 all KL = 0.122 +- 0.233 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.2 all L1 = 0.237 +- 0.193 (in-sample avg dev_std = 0.380)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.729985559566787
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.059
SUFF_SIMPLE for r=0.4 class 1.0 = 0.191 +- 0.181 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.4 all KL = 0.081 +- 0.181 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.4 all L1 = 0.191 +- 0.147 (in-sample avg dev_std = 0.212)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7001552346570397
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.209
SUFF_SIMPLE for r=0.8 class 1.0 = 0.325 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.245 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.325 +- 0.324 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.059
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5207976190476191
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.928 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.205 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.059
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3642964285714286
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.928 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.91 +- 0.205 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.059
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26864404761904764
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.928 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.91 +- 0.205 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.059
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.22398849206349208
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.928 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.91 +- 0.205 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.059
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.21262261904761903
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.928 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.205 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.917
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7500498379254458
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.52
SUFF_SIMPLE for r=0.05 class 1.0 = 0.633 +- 0.471 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.05 all KL = 0.578 +- 0.471 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.05 all L1 = 0.633 +- 0.405 (in-sample avg dev_std = 0.196)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.917
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8163452188006483
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.552
SUFF_SIMPLE for r=0.1 class 1.0 = 0.644 +- 0.466 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 all KL = 0.588 +- 0.466 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 all L1 = 0.644 +- 0.398 (in-sample avg dev_std = 0.176)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.917
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8543756077795787
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.524
SUFF_SIMPLE for r=0.2 class 1.0 = 0.625 +- 0.473 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.2 all KL = 0.57 +- 0.473 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.2 all L1 = 0.625 +- 0.407 (in-sample avg dev_std = 0.161)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.917
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8756555915721231
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.526
SUFF_SIMPLE for r=0.4 class 1.0 = 0.632 +- 0.471 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.4 all KL = 0.575 +- 0.471 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.4 all L1 = 0.632 +- 0.405 (in-sample avg dev_std = 0.139)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.917
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8811969205834683
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.789
SUFF_SIMPLE for r=0.8 class 1.0 = 0.868 +- 0.333 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all KL = 0.853 +- 0.333 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all L1 = 0.868 +- 0.289 (in-sample avg dev_std = 0.001)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7449927797833935
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.018
NEC for r=0.05 class 1.0 = 0.823 +- 0.141 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.937 +- 0.141 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.823 +- 0.104 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7939638989169675
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.025
NEC for r=0.1 class 1.0 = 0.814 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.93 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.814 +- 0.113 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7727148014440433
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.032
NEC for r=0.2 class 1.0 = 0.812 +- 0.154 (in-sample avg dev_std = 0.171)
NEC for r=0.2 all KL = 0.928 +- 0.154 (in-sample avg dev_std = 0.171)
NEC for r=0.2 all L1 = 0.812 +- 0.117 (in-sample avg dev_std = 0.171)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.729985559566787
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.061
NEC for r=0.4 class 1.0 = 0.808 +- 0.142 (in-sample avg dev_std = 0.369)
NEC for r=0.4 all KL = 0.931 +- 0.142 (in-sample avg dev_std = 0.369)
NEC for r=0.4 all L1 = 0.808 +- 0.101 (in-sample avg dev_std = 0.369)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7001552346570397
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.164
NEC for r=0.8 class 1.0 = 0.762 +- 0.189 (in-sample avg dev_std = 0.545)
NEC for r=0.8 all KL = 0.897 +- 0.189 (in-sample avg dev_std = 0.545)
NEC for r=0.8 all L1 = 0.762 +- 0.150 (in-sample avg dev_std = 0.545)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.059
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5207976190476191
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.09 +- 0.185 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.071 +- 0.185 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.09 +- 0.205 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.059
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3642964285714286
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.001
NEC for r=0.1 class 1.0 = 0.089 +- 0.184 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.07 +- 0.184 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.089 +- 0.204 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.059
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26864404761904764
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
NEC for r=0.2 class 1.0 = 0.09 +- 0.185 (in-sample avg dev_std = 0.004)
NEC for r=0.2 all KL = 0.071 +- 0.185 (in-sample avg dev_std = 0.004)
NEC for r=0.2 all L1 = 0.09 +- 0.205 (in-sample avg dev_std = 0.004)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.059
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.22398849206349208
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.09 +- 0.187 (in-sample avg dev_std = 0.012)
NEC for r=0.4 all KL = 0.072 +- 0.187 (in-sample avg dev_std = 0.012)
NEC for r=0.4 all L1 = 0.09 +- 0.205 (in-sample avg dev_std = 0.012)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.059
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.21262261904761903
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.09 +- 0.186 (in-sample avg dev_std = 0.028)
NEC for r=0.8 all KL = 0.072 +- 0.186 (in-sample avg dev_std = 0.028)
NEC for r=0.8 all L1 = 0.09 +- 0.205 (in-sample avg dev_std = 0.028)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.917
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7500498379254458
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.048
NEC for r=0.05 class 1.0 = 0.765 +- 0.274 (in-sample avg dev_std = 0.002)
NEC for r=0.05 all KL = 0.894 +- 0.274 (in-sample avg dev_std = 0.002)
NEC for r=0.05 all L1 = 0.765 +- 0.233 (in-sample avg dev_std = 0.002)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.917
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8163452188006483
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.043
NEC for r=0.1 class 1.0 = 0.769 +- 0.269 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all KL = 0.898 +- 0.269 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all L1 = 0.769 +- 0.229 (in-sample avg dev_std = 0.075)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.917
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8543756077795787
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.055
NEC for r=0.2 class 1.0 = 0.76 +- 0.274 (in-sample avg dev_std = 0.267)
NEC for r=0.2 all KL = 0.893 +- 0.274 (in-sample avg dev_std = 0.267)
NEC for r=0.2 all L1 = 0.76 +- 0.232 (in-sample avg dev_std = 0.267)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.917
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8756555915721231
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.156
NEC for r=0.4 class 1.0 = 0.707 +- 0.284 (in-sample avg dev_std = 0.506)
NEC for r=0.4 all KL = 0.866 +- 0.284 (in-sample avg dev_std = 0.506)
NEC for r=0.4 all L1 = 0.707 +- 0.243 (in-sample avg dev_std = 0.506)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.917
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8811969205834683
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.299
NEC for r=0.8 class 1.0 = 0.623 +- 0.292 (in-sample avg dev_std = 0.638)
NEC for r=0.8 all KL = 0.813 +- 0.292 (in-sample avg dev_std = 0.638)
NEC for r=0.8 all L1 = 0.623 +- 0.259 (in-sample avg dev_std = 0.638)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 19:36:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 07:36:29 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 07:36:29 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 07:36:29 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 07:36:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:36:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:36:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:36:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:36:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:36:29 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 07:36:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mChartInfo 0.9320 0.9320 0.9320 0.9320 0.9260 0.9260[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.678
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.645
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.530
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.389
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.287
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.361
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.220
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.137
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.093
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.725
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.750
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.744
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.732
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.743


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.949
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.678263537906137
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.002
SUFF_SIMPLE for r=0.05 class 1.0 = 0.192 +- 0.171 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.05 all KL = 0.131 +- 0.171 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.05 all L1 = 0.192 +- 0.107 (in-sample avg dev_std = 0.066)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.949
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6454440433212997
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.013
SUFF_SIMPLE for r=0.1 class 1.0 = 0.195 +- 0.171 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.1 all KL = 0.133 +- 0.171 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.1 all L1 = 0.195 +- 0.107 (in-sample avg dev_std = 0.171)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.949
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5300036101083032
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.09
SUFF_SIMPLE for r=0.2 class 1.0 = 0.257 +- 0.282 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.2 all KL = 0.211 +- 0.282 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.2 all L1 = 0.257 +- 0.219 (in-sample avg dev_std = 0.084)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.949
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.38911913357400724
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.081
SUFF_SIMPLE for r=0.4 class 1.0 = 0.25 +- 0.269 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.4 all KL = 0.2 +- 0.269 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.4 all L1 = 0.25 +- 0.214 (in-sample avg dev_std = 0.057)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.949
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.28722743682310475
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.097
SUFF_SIMPLE for r=0.8 class 1.0 = 0.271 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.224 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.271 +- 0.249 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.072
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3610781746031746
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
SUFF_SIMPLE for r=0.05 class 1.0 = 0.833 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.881 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.833 +- 0.223 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.072
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22009444444444445
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
SUFF_SIMPLE for r=0.1 class 1.0 = 0.833 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.881 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.833 +- 0.223 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.072
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.13720436507936506
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.881 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.833 +- 0.223 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.072
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09306944444444443
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.833 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.881 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.833 +- 0.223 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.072
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07896309523809522
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.833 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.881 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.833 +- 0.223 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.684
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7245903565640194
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.434
SUFF_SIMPLE for r=0.05 class 1.0 = 0.518 +- 0.401 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.05 all KL = 0.562 +- 0.401 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.05 all L1 = 0.518 +- 0.308 (in-sample avg dev_std = 0.172)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.684
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7500490275526742
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.457
SUFF_SIMPLE for r=0.1 class 1.0 = 0.536 +- 0.398 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.1 all KL = 0.583 +- 0.398 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.1 all L1 = 0.536 +- 0.307 (in-sample avg dev_std = 0.154)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.684
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7436523500810373
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.463
SUFF_SIMPLE for r=0.2 class 1.0 = 0.515 +- 0.404 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.2 all KL = 0.563 +- 0.404 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.2 all L1 = 0.515 +- 0.307 (in-sample avg dev_std = 0.137)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.684
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7319833873581848
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.453
SUFF_SIMPLE for r=0.4 class 1.0 = 0.51 +- 0.408 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.4 all KL = 0.557 +- 0.408 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.4 all L1 = 0.51 +- 0.310 (in-sample avg dev_std = 0.134)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.688
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7434311183144247
len(reference) = 2455
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.662
SUFF_SIMPLE for r=0.8 class 1.0 = 0.753 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.818 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.753 +- 0.280 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.949
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.678263537906137
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.022
NEC for r=0.05 class 1.0 = 0.778 +- 0.208 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.833 +- 0.208 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.778 +- 0.154 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.949
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6454440433212997
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.011
NEC for r=0.1 class 1.0 = 0.782 +- 0.186 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.838 +- 0.186 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.782 +- 0.128 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.949
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5300036101083032
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.005
NEC for r=0.2 class 1.0 = 0.791 +- 0.173 (in-sample avg dev_std = 0.062)
NEC for r=0.2 all KL = 0.853 +- 0.173 (in-sample avg dev_std = 0.062)
NEC for r=0.2 all L1 = 0.791 +- 0.113 (in-sample avg dev_std = 0.062)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.949
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.38911913357400724
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.042
NEC for r=0.4 class 1.0 = 0.785 +- 0.184 (in-sample avg dev_std = 0.236)
NEC for r=0.4 all KL = 0.85 +- 0.184 (in-sample avg dev_std = 0.236)
NEC for r=0.4 all L1 = 0.785 +- 0.131 (in-sample avg dev_std = 0.236)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.949
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.28722743682310475
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.08
NEC for r=0.8 class 1.0 = 0.765 +- 0.210 (in-sample avg dev_std = 0.301)
NEC for r=0.8 all KL = 0.826 +- 0.210 (in-sample avg dev_std = 0.301)
NEC for r=0.8 all L1 = 0.765 +- 0.157 (in-sample avg dev_std = 0.301)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.072
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3610781746031746
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.165 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.113 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.165 +- 0.221 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.072
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.22009444444444445
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.163 +- 0.177 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.109 +- 0.177 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.163 +- 0.220 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.072
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.13720436507936506
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
NEC for r=0.2 class 1.0 = 0.162 +- 0.178 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all KL = 0.109 +- 0.178 (in-sample avg dev_std = 0.002)
NEC for r=0.2 all L1 = 0.162 +- 0.219 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.072
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09306944444444443
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.167 +- 0.189 (in-sample avg dev_std = 0.003)
NEC for r=0.4 all KL = 0.119 +- 0.189 (in-sample avg dev_std = 0.003)
NEC for r=0.4 all L1 = 0.167 +- 0.223 (in-sample avg dev_std = 0.003)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.072
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07896309523809522
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.167 +- 0.189 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.119 +- 0.189 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.167 +- 0.223 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.684
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7245903565640194
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.092
NEC for r=0.05 class 1.0 = 0.597 +- 0.362 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.567 +- 0.362 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.597 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.684
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7500490275526742
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.088
NEC for r=0.1 class 1.0 = 0.606 +- 0.352 (in-sample avg dev_std = 0.018)
NEC for r=0.1 all KL = 0.584 +- 0.352 (in-sample avg dev_std = 0.018)
NEC for r=0.1 all L1 = 0.606 +- 0.274 (in-sample avg dev_std = 0.018)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.684
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7436523500810373
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.076
NEC for r=0.2 class 1.0 = 0.637 +- 0.328 (in-sample avg dev_std = 0.081)
NEC for r=0.2 all KL = 0.63 +- 0.328 (in-sample avg dev_std = 0.081)
NEC for r=0.2 all L1 = 0.637 +- 0.255 (in-sample avg dev_std = 0.081)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.684
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7319833873581848
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.08
NEC for r=0.4 class 1.0 = 0.651 +- 0.328 (in-sample avg dev_std = 0.242)
NEC for r=0.4 all KL = 0.652 +- 0.328 (in-sample avg dev_std = 0.242)
NEC for r=0.4 all L1 = 0.651 +- 0.245 (in-sample avg dev_std = 0.242)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.684
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7434311183144247
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.176
NEC for r=0.8 class 1.0 = 0.608 +- 0.345 (in-sample avg dev_std = 0.413)
NEC for r=0.8 all KL = 0.611 +- 0.345 (in-sample avg dev_std = 0.413)
NEC for r=0.8 all L1 = 0.608 +- 0.257 (in-sample avg dev_std = 0.413)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 19:42:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 07:42:08 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 07:42:08 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 07:42:08 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 07:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:42:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:42:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:42:08 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 07:42:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mChartInfo 0.9540 0.9540 0.9540 0.9540 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.674
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.708
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.652
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.576
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.525
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.465
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.307
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.205
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.148
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.130
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.763
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.817
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.850
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.869
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.872


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.993
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6736389891696751
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.059
SUFF_SIMPLE for r=0.05 class 1.0 = 0.173 +- 0.091 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.05 all KL = 0.051 +- 0.091 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.05 all L1 = 0.173 +- 0.050 (in-sample avg dev_std = 0.402)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.993
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7079025270758122
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.06
SUFF_SIMPLE for r=0.1 class 1.0 = 0.174 +- 0.092 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.1 all KL = 0.052 +- 0.092 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.1 all L1 = 0.174 +- 0.057 (in-sample avg dev_std = 0.416)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.993
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6518880866425992
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.051
SUFF_SIMPLE for r=0.2 class 1.0 = 0.173 +- 0.109 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.2 all KL = 0.055 +- 0.109 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.2 all L1 = 0.173 +- 0.073 (in-sample avg dev_std = 0.357)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5759675090252708
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.088
SUFF_SIMPLE for r=0.4 class 1.0 = 0.213 +- 0.237 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.4 all KL = 0.108 +- 0.237 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.4 all L1 = 0.213 +- 0.199 (in-sample avg dev_std = 0.258)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.993
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5253393501805055
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.209
SUFF_SIMPLE for r=0.8 class 1.0 = 0.313 +- 0.366 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.229 +- 0.366 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.313 +- 0.317 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.094
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4646369047619048
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
SUFF_SIMPLE for r=0.05 class 1.0 = 0.831 +- 0.222 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.05 all KL = 0.87 +- 0.222 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.05 all L1 = 0.831 +- 0.246 (in-sample avg dev_std = 0.025)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.094
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3073797619047619
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
SUFF_SIMPLE for r=0.1 class 1.0 = 0.831 +- 0.222 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.1 all KL = 0.87 +- 0.222 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.1 all L1 = 0.831 +- 0.246 (in-sample avg dev_std = 0.020)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.094
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2047234126984127
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
SUFF_SIMPLE for r=0.2 class 1.0 = 0.831 +- 0.222 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.2 all KL = 0.87 +- 0.222 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.2 all L1 = 0.831 +- 0.246 (in-sample avg dev_std = 0.004)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.094
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1484531746031746
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.831 +- 0.222 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.87 +- 0.222 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.831 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.094
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1301734126984127
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.831 +- 0.222 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.87 +- 0.222 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.831 +- 0.246 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.915
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7628083468395461
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.459
SUFF_SIMPLE for r=0.05 class 1.0 = 0.557 +- 0.456 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.05 all KL = 0.456 +- 0.456 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.05 all L1 = 0.557 +- 0.381 (in-sample avg dev_std = 0.402)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.915
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8170004051863857
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.471
SUFF_SIMPLE for r=0.1 class 1.0 = 0.577 +- 0.467 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.1 all KL = 0.497 +- 0.467 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.1 all L1 = 0.577 +- 0.395 (in-sample avg dev_std = 0.310)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.915
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8501272285251213
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.486
SUFF_SIMPLE for r=0.2 class 1.0 = 0.595 +- 0.471 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.2 all KL = 0.528 +- 0.471 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.2 all L1 = 0.595 +- 0.402 (in-sample avg dev_std = 0.238)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.915
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8688286061588332
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.502
SUFF_SIMPLE for r=0.4 class 1.0 = 0.609 +- 0.470 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 all KL = 0.547 +- 0.470 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 all L1 = 0.609 +- 0.403 (in-sample avg dev_std = 0.179)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.917
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8723407617504051
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.812
SUFF_SIMPLE for r=0.8 class 1.0 = 0.872 +- 0.316 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all KL = 0.862 +- 0.316 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all L1 = 0.872 +- 0.273 (in-sample avg dev_std = 0.001)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.993
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6736389891696751
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.036
NEC for r=0.05 class 1.0 = 0.814 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.929 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.814 +- 0.115 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.993
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7079025270758122
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.036
NEC for r=0.1 class 1.0 = 0.822 +- 0.112 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.939 +- 0.112 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.822 +- 0.084 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.993
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6518880866425992
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.031
NEC for r=0.2 class 1.0 = 0.825 +- 0.110 (in-sample avg dev_std = 0.179)
NEC for r=0.2 all KL = 0.942 +- 0.110 (in-sample avg dev_std = 0.179)
NEC for r=0.2 all L1 = 0.825 +- 0.077 (in-sample avg dev_std = 0.179)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.993
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5759675090252708
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.051
NEC for r=0.4 class 1.0 = 0.821 +- 0.108 (in-sample avg dev_std = 0.327)
NEC for r=0.4 all KL = 0.943 +- 0.108 (in-sample avg dev_std = 0.327)
NEC for r=0.4 all L1 = 0.821 +- 0.073 (in-sample avg dev_std = 0.327)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.993
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5253393501805055
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.121
NEC for r=0.8 class 1.0 = 0.793 +- 0.123 (in-sample avg dev_std = 0.519)
NEC for r=0.8 all KL = 0.929 +- 0.123 (in-sample avg dev_std = 0.519)
NEC for r=0.8 all L1 = 0.793 +- 0.095 (in-sample avg dev_std = 0.519)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.094
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4646369047619048
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.169 +- 0.221 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.129 +- 0.221 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.169 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.094
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3073797619047619
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.169 +- 0.222 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.13 +- 0.222 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.169 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.094
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2047234126984127
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.0
NEC for r=0.2 class 1.0 = 0.169 +- 0.222 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all KL = 0.13 +- 0.222 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all L1 = 0.169 +- 0.246 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.094
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1484531746031746
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.0
NEC for r=0.4 class 1.0 = 0.169 +- 0.222 (in-sample avg dev_std = 0.006)
NEC for r=0.4 all KL = 0.13 +- 0.222 (in-sample avg dev_std = 0.006)
NEC for r=0.4 all L1 = 0.169 +- 0.246 (in-sample avg dev_std = 0.006)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.094
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1301734126984127
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
NEC for r=0.8 class 1.0 = 0.169 +- 0.222 (in-sample avg dev_std = 0.005)
NEC for r=0.8 all KL = 0.13 +- 0.222 (in-sample avg dev_std = 0.005)
NEC for r=0.8 all L1 = 0.169 +- 0.246 (in-sample avg dev_std = 0.005)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.915
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7628083468395461
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.071
NEC for r=0.05 class 1.0 = 0.742 +- 0.300 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.864 +- 0.300 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.742 +- 0.250 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.915
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8170004051863857
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.02
NEC for r=0.1 class 1.0 = 0.77 +- 0.269 (in-sample avg dev_std = 0.074)
NEC for r=0.1 all KL = 0.896 +- 0.269 (in-sample avg dev_std = 0.074)
NEC for r=0.1 all L1 = 0.77 +- 0.221 (in-sample avg dev_std = 0.074)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.915
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8501272285251213
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.059
NEC for r=0.2 class 1.0 = 0.763 +- 0.262 (in-sample avg dev_std = 0.347)
NEC for r=0.2 all KL = 0.898 +- 0.262 (in-sample avg dev_std = 0.347)
NEC for r=0.2 all L1 = 0.763 +- 0.213 (in-sample avg dev_std = 0.347)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.915
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8688286061588332
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.197
NEC for r=0.4 class 1.0 = 0.696 +- 0.262 (in-sample avg dev_std = 0.568)
NEC for r=0.4 all KL = 0.87 +- 0.262 (in-sample avg dev_std = 0.568)
NEC for r=0.4 all L1 = 0.696 +- 0.224 (in-sample avg dev_std = 0.568)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.915
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8723407617504051
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.342
NEC for r=0.8 class 1.0 = 0.607 +- 0.263 (in-sample avg dev_std = 0.643)
NEC for r=0.8 all KL = 0.811 +- 0.263 (in-sample avg dev_std = 0.643)
NEC for r=0.8 all L1 = 0.607 +- 0.239 (in-sample avg dev_std = 0.643)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Nov  3 19:47:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/03/2024 07:47:47 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/03/2024 07:47:47 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/03/2024 07:47:47 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/03/2024 07:47:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:47:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:47:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:47:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/03/2024 07:47:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/03/2024 07:47:47 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/03/2024 07:47:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mChartInfo 0.9680 0.9680 0.9680 0.9680 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.746
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.809
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.796
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.753
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.720
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.574
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.404
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.286
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.222
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.201
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.789
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.847
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.883
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.904
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.911


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.986
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7457797833935018
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.462
SUFF_SIMPLE for r=0.05 class 1.0 = 0.456 +- 0.379 (in-sample avg dev_std = 0.663)
SUFF_SIMPLE for r=0.05 all KL = 0.299 +- 0.379 (in-sample avg dev_std = 0.663)
SUFF_SIMPLE for r=0.05 all L1 = 0.456 +- 0.316 (in-sample avg dev_std = 0.663)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.986
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8091588447653429
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.453
SUFF_SIMPLE for r=0.1 class 1.0 = 0.462 +- 0.414 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.1 all KL = 0.329 +- 0.414 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.1 all L1 = 0.462 +- 0.339 (in-sample avg dev_std = 0.618)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.986
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7959783393501805
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.428
SUFF_SIMPLE for r=0.2 class 1.0 = 0.45 +- 0.413 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.2 all KL = 0.325 +- 0.413 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.2 all L1 = 0.45 +- 0.343 (in-sample avg dev_std = 0.564)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.986
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7532743682310469
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.35
SUFF_SIMPLE for r=0.4 class 1.0 = 0.406 +- 0.416 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.4 all KL = 0.296 +- 0.416 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.4 all L1 = 0.406 +- 0.351 (in-sample avg dev_std = 0.458)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.986
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7202707581227437
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.314
SUFF_SIMPLE for r=0.8 class 1.0 = 0.409 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.326 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.409 +- 0.376 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.132
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5736623015873016
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.011
SUFF_SIMPLE for r=0.05 class 1.0 = 0.83 +- 0.277 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.05 all KL = 0.844 +- 0.277 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.05 all L1 = 0.83 +- 0.274 (in-sample avg dev_std = 0.153)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.132
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4042134920634921
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.013
SUFF_SIMPLE for r=0.1 class 1.0 = 0.828 +- 0.281 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.1 all KL = 0.84 +- 0.281 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.1 all L1 = 0.828 +- 0.274 (in-sample avg dev_std = 0.170)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.132
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2860722222222222
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.014
SUFF_SIMPLE for r=0.2 class 1.0 = 0.823 +- 0.288 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.2 all KL = 0.832 +- 0.288 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.2 all L1 = 0.823 +- 0.276 (in-sample avg dev_std = 0.185)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.132
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.22185396825396825
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.023
SUFF_SIMPLE for r=0.4 class 1.0 = 0.82 +- 0.295 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 all KL = 0.83 +- 0.295 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 all L1 = 0.82 +- 0.281 (in-sample avg dev_std = 0.184)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.132
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2014285714285714
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.836 +- 0.272 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.858 +- 0.272 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.836 +- 0.276 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.788722042139384
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.868
SUFF_SIMPLE for r=0.05 class 1.0 = 0.824 +- 0.386 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.05 all KL = 0.763 +- 0.386 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.05 all L1 = 0.824 +- 0.295 (in-sample avg dev_std = 0.395)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8467216369529983
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.89
SUFF_SIMPLE for r=0.1 class 1.0 = 0.828 +- 0.377 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.1 all KL = 0.783 +- 0.377 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.1 all L1 = 0.828 +- 0.304 (in-sample avg dev_std = 0.315)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8830757698541329
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.852
SUFF_SIMPLE for r=0.2 class 1.0 = 0.792 +- 0.409 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 all KL = 0.745 +- 0.409 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 all L1 = 0.792 +- 0.338 (in-sample avg dev_std = 0.269)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.903976904376013
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.751
SUFF_SIMPLE for r=0.4 class 1.0 = 0.724 +- 0.446 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.4 all KL = 0.671 +- 0.446 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.4 all L1 = 0.724 +- 0.379 (in-sample avg dev_std = 0.207)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.925
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9111045380875201
len(reference) = 2440
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.893
SUFF_SIMPLE for r=0.8 class 1.0 = 0.907 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.896 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.907 +- 0.253 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.986
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7457797833935018
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.177
NEC for r=0.05 class 1.0 = 0.701 +- 0.358 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.806 +- 0.358 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.701 +- 0.304 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.986
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8091588447653429
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.076
NEC for r=0.1 class 1.0 = 0.782 +- 0.245 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.906 +- 0.245 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.782 +- 0.203 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.986
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7959783393501805
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.134
NEC for r=0.2 class 1.0 = 0.774 +- 0.181 (in-sample avg dev_std = 0.470)
NEC for r=0.2 all KL = 0.924 +- 0.181 (in-sample avg dev_std = 0.470)
NEC for r=0.2 all L1 = 0.774 +- 0.158 (in-sample avg dev_std = 0.470)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.986
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7532743682310469
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.356
NEC for r=0.4 class 1.0 = 0.648 +- 0.227 (in-sample avg dev_std = 0.678)
NEC for r=0.4 all KL = 0.838 +- 0.227 (in-sample avg dev_std = 0.678)
NEC for r=0.4 all L1 = 0.648 +- 0.216 (in-sample avg dev_std = 0.678)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.986
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7202707581227437
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.567
NEC for r=0.8 class 1.0 = 0.501 +- 0.282 (in-sample avg dev_std = 0.746)
NEC for r=0.8 all KL = 0.71 +- 0.282 (in-sample avg dev_std = 0.746)
NEC for r=0.8 all L1 = 0.501 +- 0.238 (in-sample avg dev_std = 0.746)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.132
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.5736623015873016
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.163 +- 0.269 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.14 +- 0.269 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.163 +- 0.275 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.132
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.4042134920634921
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.0
NEC for r=0.1 class 1.0 = 0.162 +- 0.268 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.139 +- 0.268 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.162 +- 0.274 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.132
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2860722222222222
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.007
NEC for r=0.2 class 1.0 = 0.166 +- 0.273 (in-sample avg dev_std = 0.077)
NEC for r=0.2 all KL = 0.147 +- 0.273 (in-sample avg dev_std = 0.077)
NEC for r=0.2 all L1 = 0.166 +- 0.274 (in-sample avg dev_std = 0.077)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.132
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.22185396825396825
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.032
NEC for r=0.4 class 1.0 = 0.177 +- 0.276 (in-sample avg dev_std = 0.241)
NEC for r=0.4 all KL = 0.177 +- 0.276 (in-sample avg dev_std = 0.241)
NEC for r=0.4 all L1 = 0.177 +- 0.264 (in-sample avg dev_std = 0.241)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.132
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2014285714285714
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.015
NEC for r=0.8 class 1.0 = 0.168 +- 0.270 (in-sample avg dev_std = 0.171)
NEC for r=0.8 all KL = 0.152 +- 0.270 (in-sample avg dev_std = 0.171)
NEC for r=0.8 all L1 = 0.168 +- 0.270 (in-sample avg dev_std = 0.171)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.788722042139384
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.124
NEC for r=0.05 class 1.0 = 0.702 +- 0.364 (in-sample avg dev_std = 0.065)
NEC for r=0.05 all KL = 0.821 +- 0.364 (in-sample avg dev_std = 0.065)
NEC for r=0.05 all L1 = 0.702 +- 0.304 (in-sample avg dev_std = 0.065)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8467216369529983
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.132
NEC for r=0.1 class 1.0 = 0.709 +- 0.336 (in-sample avg dev_std = 0.301)
NEC for r=0.1 all KL = 0.842 +- 0.336 (in-sample avg dev_std = 0.301)
NEC for r=0.1 all L1 = 0.709 +- 0.281 (in-sample avg dev_std = 0.301)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8830757698541329
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.242
NEC for r=0.2 class 1.0 = 0.654 +- 0.322 (in-sample avg dev_std = 0.529)
NEC for r=0.2 all KL = 0.82 +- 0.322 (in-sample avg dev_std = 0.529)
NEC for r=0.2 all L1 = 0.654 +- 0.280 (in-sample avg dev_std = 0.529)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.903976904376013
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.439
NEC for r=0.4 class 1.0 = 0.543 +- 0.347 (in-sample avg dev_std = 0.639)
NEC for r=0.4 all KL = 0.73 +- 0.347 (in-sample avg dev_std = 0.639)
NEC for r=0.4 all L1 = 0.543 +- 0.300 (in-sample avg dev_std = 0.639)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9111045380875201
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.711
NEC for r=0.8 class 1.0 = 0.38 +- 0.376 (in-sample avg dev_std = 0.666)
NEC for r=0.8 all KL = 0.57 +- 0.376 (in-sample avg dev_std = 0.666)
NEC for r=0.8 all L1 = 0.38 +- 0.291 (in-sample avg dev_std = 0.666)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.254, 0.314, 0.32, 0.28, 0.206], 'all_L1': [0.366, 0.408, 0.407, 0.359, 0.291]}), defaultdict(<class 'list'>, {'all_KL': [0.042, 0.04, 0.039, 0.044, 0.255], 'all_L1': [0.21, 0.201, 0.193, 0.184, 0.356]}), defaultdict(<class 'list'>, {'all_KL': [0.064, 0.069, 0.108, 0.108, 0.267], 'all_L1': [0.215, 0.22, 0.252, 0.228, 0.353]}), defaultdict(<class 'list'>, {'all_KL': [0.05, 0.049, 0.048, 0.052, 0.245], 'all_L1': [0.174, 0.168, 0.165, 0.164, 0.335]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.054, 0.053, 0.056, 0.229], 'all_L1': [0.176, 0.173, 0.172, 0.165, 0.315]}), defaultdict(<class 'list'>, {'all_KL': [0.083, 0.086, 0.167, 0.116, 0.147], 'all_L1': [0.171, 0.175, 0.244, 0.197, 0.224]}), defaultdict(<class 'list'>, {'all_KL': [0.064, 0.065, 0.122, 0.081, 0.245], 'all_L1': [0.183, 0.187, 0.237, 0.191, 0.325]}), defaultdict(<class 'list'>, {'all_KL': [0.131, 0.133, 0.211, 0.2, 0.224], 'all_L1': [0.192, 0.195, 0.257, 0.25, 0.271]}), defaultdict(<class 'list'>, {'all_KL': [0.051, 0.052, 0.055, 0.108, 0.229], 'all_L1': [0.173, 0.174, 0.173, 0.213, 0.313]}), defaultdict(<class 'list'>, {'all_KL': [0.299, 0.329, 0.325, 0.296, 0.326], 'all_L1': [0.456, 0.462, 0.45, 0.406, 0.409]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.836, 0.912, 0.911, 0.807, 0.751], 'all_L1': [0.734, 0.801, 0.789, 0.672, 0.612]}), defaultdict(<class 'list'>, {'all_KL': [0.955, 0.96, 0.96, 0.951, 0.919], 'all_L1': [0.816, 0.824, 0.807, 0.767, 0.699]}), defaultdict(<class 'list'>, {'all_KL': [0.916, 0.93, 0.939, 0.93, 0.891], 'all_L1': [0.793, 0.806, 0.806, 0.775, 0.707]}), defaultdict(<class 'list'>, {'all_KL': [0.933, 0.942, 0.934, 0.931, 0.914], 'all_L1': [0.812, 0.816, 0.808, 0.798, 0.762]}), defaultdict(<class 'list'>, {'all_KL': [0.943, 0.933, 0.932, 0.939, 0.891], 'all_L1': [0.831, 0.816, 0.813, 0.814, 0.756]}), defaultdict(<class 'list'>, {'all_KL': [0.887, 0.91, 0.912, 0.912, 0.893], 'all_L1': [0.801, 0.822, 0.824, 0.821, 0.802]}), defaultdict(<class 'list'>, {'all_KL': [0.937, 0.93, 0.928, 0.931, 0.897], 'all_L1': [0.823, 0.814, 0.812, 0.808, 0.762]}), defaultdict(<class 'list'>, {'all_KL': [0.833, 0.838, 0.853, 0.85, 0.826], 'all_L1': [0.778, 0.782, 0.791, 0.785, 0.765]}), defaultdict(<class 'list'>, {'all_KL': [0.929, 0.939, 0.942, 0.943, 0.929], 'all_L1': [0.814, 0.822, 0.825, 0.821, 0.793]}), defaultdict(<class 'list'>, {'all_KL': [0.806, 0.906, 0.924, 0.838, 0.71], 'all_L1': [0.701, 0.782, 0.774, 0.648, 0.501]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.87, 0.87, 0.871, 0.867, 0.873], 'all_L1': [0.839, 0.839, 0.84, 0.838, 0.841]}), defaultdict(<class 'list'>, {'all_KL': [0.822, 0.823, 0.826, 0.827, 0.828], 'all_L1': [0.807, 0.807, 0.809, 0.809, 0.809]}), defaultdict(<class 'list'>, {'all_KL': [0.859, 0.859, 0.859, 0.859, 0.859], 'all_L1': [0.846, 0.846, 0.846, 0.846, 0.846]}), defaultdict(<class 'list'>, {'all_KL': [0.907, 0.907, 0.907, 0.907, 0.907], 'all_L1': [0.889, 0.889, 0.889, 0.889, 0.889]}), defaultdict(<class 'list'>, {'all_KL': [0.854, 0.854, 0.854, 0.854, 0.854], 'all_L1': [0.823, 0.823, 0.823, 0.823, 0.823]}), defaultdict(<class 'list'>, {'all_KL': [0.937, 0.937, 0.937, 0.937, 0.937], 'all_L1': [0.91, 0.91, 0.91, 0.91, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.928, 0.928, 0.928, 0.928, 0.928], 'all_L1': [0.91, 0.91, 0.91, 0.91, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.881, 0.881, 0.881, 0.881, 0.881], 'all_L1': [0.833, 0.833, 0.833, 0.833, 0.833]}), defaultdict(<class 'list'>, {'all_KL': [0.87, 0.87, 0.87, 0.87, 0.87], 'all_L1': [0.831, 0.831, 0.831, 0.831, 0.831]}), defaultdict(<class 'list'>, {'all_KL': [0.844, 0.84, 0.832, 0.83, 0.858], 'all_L1': [0.83, 0.828, 0.823, 0.82, 0.836]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.124, 0.123, 0.121, 0.146, 0.129], 'all_L1': [0.158, 0.158, 0.157, 0.168, 0.16]}), defaultdict(<class 'list'>, {'all_KL': [0.169, 0.168, 0.175, 0.178, 0.179], 'all_L1': [0.187, 0.187, 0.192, 0.19, 0.19]}), defaultdict(<class 'list'>, {'all_KL': [0.132, 0.127, 0.134, 0.139, 0.138], 'all_L1': [0.147, 0.143, 0.149, 0.149, 0.149]}), defaultdict(<class 'list'>, {'all_KL': [0.091, 0.087, 0.084, 0.093, 0.093], 'all_L1': [0.11, 0.108, 0.106, 0.111, 0.111]}), defaultdict(<class 'list'>, {'all_KL': [0.141, 0.138, 0.138, 0.146, 0.146], 'all_L1': [0.175, 0.173, 0.173, 0.177, 0.177]}), defaultdict(<class 'list'>, {'all_KL': [0.062, 0.062, 0.061, 0.063, 0.063], 'all_L1': [0.09, 0.09, 0.09, 0.09, 0.09]}), defaultdict(<class 'list'>, {'all_KL': [0.071, 0.07, 0.071, 0.072, 0.072], 'all_L1': [0.09, 0.089, 0.09, 0.09, 0.09]}), defaultdict(<class 'list'>, {'all_KL': [0.113, 0.109, 0.109, 0.119, 0.119], 'all_L1': [0.165, 0.163, 0.162, 0.167, 0.167]}), defaultdict(<class 'list'>, {'all_KL': [0.129, 0.13, 0.13, 0.13, 0.13], 'all_L1': [0.169, 0.169, 0.169, 0.169, 0.169]}), defaultdict(<class 'list'>, {'all_KL': [0.14, 0.139, 0.147, 0.177, 0.152], 'all_L1': [0.163, 0.162, 0.166, 0.177, 0.168]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.701, 0.72, 0.71, 0.646, 0.871], 'all_L1': [0.754, 0.761, 0.744, 0.674, 0.863]}), defaultdict(<class 'list'>, {'all_KL': [0.271, 0.35, 0.437, 0.508, 0.831], 'all_L1': [0.492, 0.524, 0.562, 0.598, 0.856]}), defaultdict(<class 'list'>, {'all_KL': [0.533, 0.55, 0.551, 0.551, 0.839], 'all_L1': [0.62, 0.628, 0.624, 0.626, 0.864]}), defaultdict(<class 'list'>, {'all_KL': [0.292, 0.328, 0.382, 0.405, 0.762], 'all_L1': [0.453, 0.469, 0.502, 0.509, 0.788]}), defaultdict(<class 'list'>, {'all_KL': [0.372, 0.44, 0.512, 0.536, 0.845], 'all_L1': [0.487, 0.528, 0.572, 0.593, 0.849]}), defaultdict(<class 'list'>, {'all_KL': [0.553, 0.588, 0.608, 0.613, 0.855], 'all_L1': [0.63, 0.648, 0.647, 0.648, 0.856]}), defaultdict(<class 'list'>, {'all_KL': [0.578, 0.588, 0.57, 0.575, 0.853], 'all_L1': [0.633, 0.644, 0.625, 0.632, 0.868]}), defaultdict(<class 'list'>, {'all_KL': [0.562, 0.583, 0.563, 0.557, 0.818], 'all_L1': [0.518, 0.536, 0.515, 0.51, 0.753]}), defaultdict(<class 'list'>, {'all_KL': [0.456, 0.497, 0.528, 0.547, 0.862], 'all_L1': [0.557, 0.577, 0.595, 0.609, 0.872]}), defaultdict(<class 'list'>, {'all_KL': [0.763, 0.783, 0.745, 0.671, 0.896], 'all_L1': [0.824, 0.828, 0.792, 0.724, 0.907]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.773, 0.797, 0.772, 0.63, 0.465], 'all_L1': [0.688, 0.704, 0.668, 0.531, 0.377]}), defaultdict(<class 'list'>, {'all_KL': [0.889, 0.895, 0.893, 0.868, 0.854], 'all_L1': [0.747, 0.751, 0.723, 0.636, 0.559]}), defaultdict(<class 'list'>, {'all_KL': [0.857, 0.875, 0.882, 0.836, 0.767], 'all_L1': [0.733, 0.741, 0.715, 0.631, 0.532]}), defaultdict(<class 'list'>, {'all_KL': [0.854, 0.864, 0.858, 0.809, 0.812], 'all_L1': [0.732, 0.74, 0.727, 0.669, 0.64]}), defaultdict(<class 'list'>, {'all_KL': [0.839, 0.847, 0.845, 0.82, 0.806], 'all_L1': [0.728, 0.73, 0.725, 0.695, 0.65]}), defaultdict(<class 'list'>, {'all_KL': [0.828, 0.851, 0.841, 0.814, 0.775], 'all_L1': [0.73, 0.751, 0.739, 0.695, 0.617]}), defaultdict(<class 'list'>, {'all_KL': [0.894, 0.898, 0.893, 0.866, 0.813], 'all_L1': [0.765, 0.769, 0.76, 0.707, 0.623]}), defaultdict(<class 'list'>, {'all_KL': [0.567, 0.584, 0.63, 0.652, 0.611], 'all_L1': [0.597, 0.606, 0.637, 0.651, 0.608]}), defaultdict(<class 'list'>, {'all_KL': [0.864, 0.896, 0.898, 0.87, 0.811], 'all_L1': [0.742, 0.77, 0.763, 0.696, 0.607]}), defaultdict(<class 'list'>, {'all_KL': [0.821, 0.842, 0.82, 0.73, 0.57], 'all_L1': [0.702, 0.709, 0.654, 0.543, 0.38]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.232 +- 0.093, 0.236 +- 0.101, 0.255 +- 0.093, 0.236 +- 0.078, 0.319 +- 0.048
suff_simple class all_KL  =  0.109 +- 0.088, 0.119 +- 0.104, 0.145 +- 0.103, 0.134 +- 0.088, 0.237 +- 0.043
suff_simple_acc_int  =  0.130 +- 0.143, 0.133 +- 0.145, 0.151 +- 0.127, 0.111 +- 0.105, 0.200 +- 0.068
nec class all_L1  =  0.790 +- 0.040, 0.809 +- 0.015, 0.805 +- 0.015, 0.771 +- 0.058, 0.716 +- 0.089
nec class all_KL  =  0.897 +- 0.051, 0.920 +- 0.031, 0.923 +- 0.027, 0.903 +- 0.049, 0.862 +- 0.071
nec_acc_int  =  0.060 +- 0.056, 0.031 +- 0.019, 0.052 +- 0.039, 0.127 +- 0.109, 0.232 +- 0.149

Eval split val
suff_simple class all_L1  =  0.852 +- 0.035, 0.852 +- 0.035, 0.851 +- 0.036, 0.851 +- 0.036, 0.853 +- 0.035
suff_simple class all_KL  =  0.877 +- 0.035, 0.877 +- 0.035, 0.877 +- 0.036, 0.876 +- 0.036, 0.879 +- 0.033
suff_simple_acc_int  =  0.003 +- 0.004, 0.002 +- 0.004, 0.002 +- 0.004, 0.003 +- 0.007, 0.000 +- 0.000
nec class all_L1  =  0.145 +- 0.034, 0.144 +- 0.034, 0.145 +- 0.035, 0.149 +- 0.036, 0.147 +- 0.035
nec class all_KL  =  0.117 +- 0.032, 0.115 +- 0.032, 0.117 +- 0.034, 0.126 +- 0.038, 0.122 +- 0.035
nec_acc_int  =  0.002 +- 0.004, 0.004 +- 0.009, 0.006 +- 0.011, 0.010 +- 0.012, 0.007 +- 0.009

Eval split test
suff_simple class all_L1  =  0.597 +- 0.114, 0.614 +- 0.107, 0.618 +- 0.088, 0.612 +- 0.063, 0.848 +- 0.042
suff_simple class all_KL  =  0.508 +- 0.154, 0.543 +- 0.138, 0.561 +- 0.105, 0.561 +- 0.071, 0.843 +- 0.034
suff_simple_acc_int  =  0.546 +- 0.155, 0.557 +- 0.162, 0.545 +- 0.151, 0.528 +- 0.108, 0.772 +- 0.072
nec class all_L1  =  0.716 +- 0.045, 0.727 +- 0.045, 0.711 +- 0.041, 0.645 +- 0.060, 0.559 +- 0.096
nec class all_KL  =  0.819 +- 0.090, 0.835 +- 0.089, 0.833 +- 0.077, 0.789 +- 0.084, 0.728 +- 0.124
nec_acc_int  =  0.076 +- 0.032, 0.065 +- 0.035, 0.107 +- 0.066, 0.230 +- 0.116, 0.401 +- 0.165


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.511 +- 0.029, 0.522 +- 0.046, 0.530 +- 0.041, 0.503 +- 0.016, 0.518 +- 0.034
Faith. Armon (L1)= 		  =  0.346 +- 0.090, 0.355 +- 0.105, 0.378 +- 0.097, 0.351 +- 0.074, 0.435 +- 0.038
Faith. GMean (L1)= 	  =  0.419 +- 0.064, 0.428 +- 0.081, 0.446 +- 0.074, 0.418 +- 0.048, 0.474 +- 0.031
Faith. Aritm (KL)= 		  =  0.503 +- 0.023, 0.520 +- 0.048, 0.534 +- 0.046, 0.519 +- 0.022, 0.550 +- 0.035
Faith. Armon (KL)= 		  =  0.182 +- 0.122, 0.196 +- 0.145, 0.235 +- 0.146, 0.221 +- 0.122, 0.369 +- 0.050
Faith. GMean (KL)= 	  =  0.290 +- 0.099, 0.305 +- 0.123, 0.341 +- 0.126, 0.328 +- 0.099, 0.449 +- 0.040

Eval split val
Faith. Aritm (L1)= 		  =  0.499 +- 0.001, 0.498 +- 0.002, 0.498 +- 0.002, 0.500 +- 0.001, 0.500 +- 0.001
Faith. Armon (L1)= 		  =  0.246 +- 0.049, 0.244 +- 0.049, 0.246 +- 0.051, 0.251 +- 0.052, 0.249 +- 0.051
Faith. GMean (L1)= 	  =  0.348 +- 0.037, 0.347 +- 0.037, 0.348 +- 0.038, 0.352 +- 0.039, 0.350 +- 0.038
Faith. Aritm (KL)= 		  =  0.497 +- 0.002, 0.496 +- 0.003, 0.497 +- 0.003, 0.501 +- 0.002, 0.501 +- 0.002
Faith. Armon (KL)= 		  =  0.205 +- 0.049, 0.202 +- 0.049, 0.204 +- 0.053, 0.218 +- 0.058, 0.212 +- 0.053
Faith. GMean (KL)= 	  =  0.316 +- 0.040, 0.314 +- 0.040, 0.316 +- 0.043, 0.327 +- 0.046, 0.323 +- 0.043

Eval split test
Faith. Aritm (L1)= 		  =  0.657 +- 0.060, 0.671 +- 0.057, 0.664 +- 0.042, 0.629 +- 0.030, 0.703 +- 0.042
Faith. Armon (L1)= 		  =  0.645 +- 0.067, 0.660 +- 0.062, 0.657 +- 0.045, 0.624 +- 0.033, 0.667 +- 0.072
Faith. GMean (L1)= 	  =  0.651 +- 0.063, 0.666 +- 0.060, 0.661 +- 0.044, 0.626 +- 0.031, 0.685 +- 0.057
Faith. Aritm (KL)= 		  =  0.663 +- 0.076, 0.689 +- 0.071, 0.697 +- 0.054, 0.675 +- 0.041, 0.786 +- 0.057
Faith. Armon (KL)= 		  =  0.608 +- 0.119, 0.643 +- 0.102, 0.661 +- 0.072, 0.649 +- 0.047, 0.774 +- 0.075
Faith. GMean (KL)= 	  =  0.634 +- 0.098, 0.665 +- 0.087, 0.679 +- 0.062, 0.662 +- 0.043, 0.780 +- 0.066
Computed for split load_split = id



Completed in  0:57:02.987730  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN plain TopoFeature/basis/no_shift NEC_ALPHA 0.1
scripts/faithfulness.sh: line 78: syntax error near unexpected token `)'
