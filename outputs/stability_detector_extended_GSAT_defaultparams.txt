nohup: ignoring input
I'm the stability of the DET :))
The PID of this script is: 3207298
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:16:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/17/2024 08:16:05 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:16:05 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:16:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:16:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:16:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:16:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:16:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:16:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:16:05 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:16:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.576
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.231577
Plausibility completed in  0:00:26.584086
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3765, device='cuda:1')  +-  tensor(0.2187, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3861, device='cuda:1')  +-  tensor(0.0662, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.994 +- 0.044
Intervened Stability MCC for r=0.3 = 0.028 +- 0.230
Original Stability F1 for r=0.3 = 0.996 +- 0.029
Intervened Stability F1 for r=0.3 = 0.359 +- 0.154
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.140961
Plausibility completed in  0:00:21.121955
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3759, device='cuda:1')  +-  tensor(0.2172, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7147, device='cuda:1')  +-  tensor(0.0707, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.996 +- 0.030
Intervened Stability MCC for r=0.6 = 0.134 +- 0.326
Original Stability F1 for r=0.6 = 0.998 +- 0.011
Intervened Stability F1 for r=0.6 = 0.733 +- 0.117
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:17:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/17/2024 08:17:23 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:17:23 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:17:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:17:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:17:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:17:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:17:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:17:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:17:23 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:17:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.225691
Plausibility completed in  0:00:24.241294
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3726, device='cuda:1')  +-  tensor(0.2157, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3782, device='cuda:1')  +-  tensor(0.0587, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.994 +- 0.048
Intervened Stability MCC for r=0.3 = 0.030 +- 0.245
Original Stability F1 for r=0.3 = 0.996 +- 0.031
Intervened Stability F1 for r=0.3 = 0.356 +- 0.160
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.190409
Plausibility completed in  0:00:25.985563
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3714, device='cuda:1')  +-  tensor(0.2142, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7139, device='cuda:1')  +-  tensor(0.0697, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.996 +- 0.028
Intervened Stability MCC for r=0.6 = 0.124 +- 0.306
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.733 +- 0.105
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:18:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/17/2024 08:18:43 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:18:43 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:18:43 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:18:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:18:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:18:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:18:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:18:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:18:43 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:18:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.151963
Plausibility completed in  0:00:22.065254
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3704, device='cuda:1')  +-  tensor(0.2159, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3796, device='cuda:1')  +-  tensor(0.0615, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.995 +- 0.039
Intervened Stability MCC for r=0.3 = 0.033 +- 0.252
Original Stability F1 for r=0.3 = 0.996 +- 0.027
Intervened Stability F1 for r=0.3 = 0.356 +- 0.165
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.865089
Plausibility completed in  0:00:25.410226
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3696, device='cuda:1')  +-  tensor(0.2149, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7110, device='cuda:1')  +-  tensor(0.0693, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.996 +- 0.026
Intervened Stability MCC for r=0.6 = 0.125 +- 0.325
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.728 +- 0.118
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:20:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/17/2024 08:20:03 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:20:03 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:20:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:20:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:20:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:20:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:20:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:20:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:20:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:20:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.996742
Plausibility completed in  0:00:24.224108
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3703, device='cuda:1')  +-  tensor(0.2142, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3784, device='cuda:1')  +-  tensor(0.0593, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.997 +- 0.025
Intervened Stability MCC for r=0.3 = 0.027 +- 0.231
Original Stability F1 for r=0.3 = 0.998 +- 0.016
Intervened Stability F1 for r=0.3 = 0.355 +- 0.157
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.996896
Plausibility completed in  0:00:22.782800
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3701, device='cuda:1')  +-  tensor(0.2140, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7152, device='cuda:1')  +-  tensor(0.0716, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.027
Intervened Stability MCC for r=0.6 = 0.081 +- 0.301
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.725 +- 0.113
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:21:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/17/2024 08:21:21 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:21:21 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:21:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:21:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:21:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:21:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:21:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:21:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:21:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:21:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.154460
Plausibility completed in  0:00:25.311345
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3737, device='cuda:1')  +-  tensor(0.2167, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3782, device='cuda:1')  +-  tensor(0.0592, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.995 +- 0.044
Intervened Stability MCC for r=0.3 = 0.035 +- 0.250
Original Stability F1 for r=0.3 = 0.996 +- 0.029
Intervened Stability F1 for r=0.3 = 0.358 +- 0.162
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.007545
Plausibility completed in  0:00:22.255098
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3723, device='cuda:1')  +-  tensor(0.2151, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7117, device='cuda:1')  +-  tensor(0.0671, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.998 +- 0.019
Intervened Stability MCC for r=0.6 = 0.165 +- 0.320
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.740 +- 0.113
Intervened samples: 3000

\FINISHED GOODMotif2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.32386574 0.3238658 ] +- [0.00206968 0.00206961] (mean across ratios: 0.324 +- TODO)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.37272511 0.37187978] +- [0.00230167 0.00221112] (mean across ratios: 0.372 +- TODO)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33397881 0.63404307] +- [0.0018042  0.00155564] (mean across ratios: 0.484 +- TODO)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.38008689 0.71332237] +- [0.00302405 0.00165906] (mean across ratios: 0.547 +- TODO)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.9967489  0.99873712] +- [0.00077687 0.00023086] (mean across ratios: 0.998 +- TODO)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.35688401 0.73200542] +- [0.00136624 0.00503874] (mean across ratios: 0.544 +- TODO)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99515358 0.99660499] +- [0.00117265 0.00063829] (mean across ratios: 0.996 +- TODO)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.03063164 0.1258683 ] +- [0.00293451 0.02683581] (mean across ratios: 0.078 +- TODO)

Overall time of execution:  0:06:35.838794
DONE GSAT GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:22:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/17/2024 08:22:52 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:22:52 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:22:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:22:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:22:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:22:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:22:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:22:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:22:52 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:22:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.576
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.204575
Plausibility completed in  0:00:26.576358
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4338, device='cuda:1')  +-  tensor(0.2689, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4408, device='cuda:1')  +-  tensor(0.1000, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.993 +- 0.051
Intervened Stability MCC for r=0.3 = 0.092 +- 0.269
Original Stability F1 for r=0.3 = 0.996 +- 0.033
Intervened Stability F1 for r=0.3 = 0.464 +- 0.192
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.970165
Plausibility completed in  0:00:25.337358
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4250, device='cuda:1')  +-  tensor(0.2571, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8029, device='cuda:1')  +-  tensor(0.1151, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.995 +- 0.033
Intervened Stability MCC for r=0.6 = -0.008 +- 0.179
Original Stability F1 for r=0.6 = 0.998 +- 0.012
Intervened Stability F1 for r=0.6 = 0.799 +- 0.130
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:24:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/17/2024 08:24:17 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:24:17 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:24:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:24:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:24:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:24:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:24:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:24:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:24:17 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:24:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.036163
Plausibility completed in  0:00:22.057943
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4298, device='cuda:1')  +-  tensor(0.2666, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4311, device='cuda:1')  +-  tensor(0.0889, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.992 +- 0.059
Intervened Stability MCC for r=0.3 = 0.075 +- 0.238
Original Stability F1 for r=0.3 = 0.995 +- 0.038
Intervened Stability F1 for r=0.3 = 0.456 +- 0.169
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.166636
Plausibility completed in  0:00:25.433545
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4126, device='cuda:1')  +-  tensor(0.2451, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7898, device='cuda:1')  +-  tensor(0.1009, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.996 +- 0.027
Intervened Stability MCC for r=0.6 = 0.017 +- 0.224
Original Stability F1 for r=0.6 = 0.998 +- 0.010
Intervened Stability F1 for r=0.6 = 0.789 +- 0.119
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:25:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/17/2024 08:25:33 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:25:33 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:25:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:25:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:25:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:25:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:25:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:25:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:25:34 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:25:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.316835
Plausibility completed in  0:00:19.686068
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4277, device='cuda:1')  +-  tensor(0.2664, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4327, device='cuda:1')  +-  tensor(0.0922, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.996 +- 0.034
Intervened Stability MCC for r=0.3 = 0.051 +- 0.245
Original Stability F1 for r=0.3 = 0.997 +- 0.023
Intervened Stability F1 for r=0.3 = 0.443 +- 0.169
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:06.138399
Plausibility completed in  0:00:19.699045
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4173, device='cuda:1')  +-  tensor(0.2545, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7949, device='cuda:1')  +-  tensor(0.1057, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.022
Intervened Stability MCC for r=0.6 = 0.002 +- 0.203
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.794 +- 0.132
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:26:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/17/2024 08:26:43 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:26:43 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:26:43 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:26:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:26:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:26:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:26:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:26:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:26:43 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:26:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.194555
Plausibility completed in  0:00:19.719210
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4262, device='cuda:1')  +-  tensor(0.2647, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4309, device='cuda:1')  +-  tensor(0.0893, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.997 +- 0.026
Intervened Stability MCC for r=0.3 = 0.049 +- 0.232
Original Stability F1 for r=0.3 = 0.998 +- 0.018
Intervened Stability F1 for r=0.3 = 0.446 +- 0.158
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.915085
Plausibility completed in  0:00:20.078003
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4168, device='cuda:1')  +-  tensor(0.2525, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8020, device='cuda:1')  +-  tensor(0.1150, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.023
Intervened Stability MCC for r=0.6 = -0.009 +- 0.199
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.793 +- 0.137
Intervened samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:27:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/17/2024 08:27:51 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:27:51 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:27:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:27:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:27:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:27:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:27:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:27:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:27:51 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:27:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.966661
Plausibility completed in  0:00:19.880534
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4305, device='cuda:1')  +-  tensor(0.2670, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4309, device='cuda:1')  +-  tensor(0.0890, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.994 +- 0.051
Intervened Stability MCC for r=0.3 = 0.086 +- 0.243
Original Stability F1 for r=0.3 = 0.996 +- 0.034
Intervened Stability F1 for r=0.3 = 0.460 +- 0.169
Intervened samples: 3000


ratio=0.6


Interventions completed in  0:00:05.943911
Plausibility completed in  0:00:19.563021
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4230, device='cuda:1')  +-  tensor(0.2566, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8018, device='cuda:1')  +-  tensor(0.1134, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.016
Intervened Stability MCC for r=0.6 = 0.013 +- 0.204
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.799 +- 0.130
Intervened samples: 3000

\FINISHED GOODMotif2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.32386587 0.32386594] +- [0.00206954 0.00206947] (mean across ratios: 0.324 +- TODO)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.42961329 0.41894392] +- [0.0025872  0.00445545] (mean across ratios: 0.424 +- TODO)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33397881 0.63404307] +- [0.0018042  0.00155564] (mean across ratios: 0.484 +- TODO)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.4332934  0.79826354] +- [0.00378674 0.00510699] (mean across ratios: 0.616 +- TODO)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99625431 0.99874431] +- [0.001045   0.00039436] (mean across ratios: 0.997 +- TODO)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.45391749 0.79504027] +- [0.00810239 0.00386018] (mean across ratios: 0.624 +- TODO)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99439243 0.99662664] +- [0.00162868 0.00107835] (mean across ratios: 0.996 +- TODO)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.07069324 0.00280785] +- [0.01783266 0.01042449] (mean across ratios: 0.037 +- TODO)

Overall time of execution:  0:06:07.779871
DONE GSAT GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:29:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/17/2024 08:29:20 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/17/2024 08:29:32 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/17/2024 08:29:34 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/17/2024 08:29:36 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/17/2024 08:29:39 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/17/2024 08:29:46 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:29:46 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:29:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:29:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:29:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:29:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:29:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:29:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:29:46 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:29:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3249
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3247
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4865
OOD Test ACCURACY: 0.4907
OOD Test Loss: 2.1636

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3304
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3315
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4661
OOD Test ACCURACY: 0.5197
OOD Test Loss: 1.7017

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4907 0.9280 0.5197 0.9323 0.9040[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.624
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.543


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.101207
Plausibility completed in  0:00:19.651179
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3815, device='cuda:1')  +-  tensor(0.1784, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4339, device='cuda:1')  +-  tensor(0.2341, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3815, device='cuda:1')  +-  tensor(0.1784, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3959, device='cuda:1')  +-  tensor(0.0779, device='cuda:1') (0.005)
Original Stability MCC for r=0.3 = 0.993 +- 0.043
Intervened Stability MCC for r=0.3 = 0.266 +- 0.316
Original Stability F1 for r=0.3 = 0.995 +- 0.028
Intervened Stability F1 for r=0.3 = 0.549 +- 0.200
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.844220
Plausibility completed in  0:00:19.712836
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3810, device='cuda:1')  +-  tensor(0.1786, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4305, device='cuda:1')  +-  tensor(0.2346, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3810, device='cuda:1')  +-  tensor(0.1786, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7375, device='cuda:1')  +-  tensor(0.1234, device='cuda:1') (0.004)
Original Stability MCC for r=0.6 = 0.997 +- 0.023
Intervened Stability MCC for r=0.6 = 0.157 +- 0.332
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.786 +- 0.116
Intervened samples: 2958
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:30:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/17/2024 08:30:54 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/17/2024 08:31:06 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/17/2024 08:31:08 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/17/2024 08:31:10 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/17/2024 08:31:14 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/17/2024 08:31:20 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:31:20 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:31:20 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:31:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:31:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:31:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:31:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:31:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:31:20 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:31:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 122...
[0m[1;37mINFO[0m: [1mCheckpoint 122: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3371
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3138
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3425
OOD Validation ACCURACY: 0.8697
OOD Validation Loss: 0.5698
OOD Test ACCURACY: 0.5503
OOD Test Loss: 1.5812

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9264
Train Loss: 0.3343
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3132
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4750
OOD Test ACCURACY: 0.5800
OOD Test Loss: 2.8730

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5503 0.9273 0.5800 0.9327 0.9030[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.603
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.526


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:05.933481
Plausibility completed in  0:00:20.159835
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3737, device='cuda:1')  +-  tensor(0.1750, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4280, device='cuda:1')  +-  tensor(0.2319, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3737, device='cuda:1')  +-  tensor(0.1750, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3911, device='cuda:1')  +-  tensor(0.0759, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.998 +- 0.025
Intervened Stability MCC for r=0.3 = 0.271 +- 0.305
Original Stability F1 for r=0.3 = 0.998 +- 0.016
Intervened Stability F1 for r=0.3 = 0.548 +- 0.195
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.899165
Plausibility completed in  0:00:19.818651
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3731, device='cuda:1')  +-  tensor(0.1746, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4244, device='cuda:1')  +-  tensor(0.2299, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3731, device='cuda:1')  +-  tensor(0.1746, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7393, device='cuda:1')  +-  tensor(0.1179, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.996 +- 0.031
Intervened Stability MCC for r=0.6 = 0.136 +- 0.318
Original Stability F1 for r=0.6 = 0.998 +- 0.011
Intervened Stability F1 for r=0.6 = 0.781 +- 0.114
Intervened samples: 2965
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:32:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/17/2024 08:32:28 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/17/2024 08:32:40 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/17/2024 08:32:42 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/17/2024 08:32:44 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/17/2024 08:32:48 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/17/2024 08:32:54 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:32:54 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:32:54 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:32:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:32:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:32:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:32:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:32:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:32:54 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:32:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3328
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3378
OOD Validation ACCURACY: 0.8910
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4787
OOD Test Loss: 2.2870

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3400
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9237
ID Test Loss: 0.3418
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4991
OOD Test ACCURACY: 0.6000
OOD Test Loss: 1.5258

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4787 0.9237 0.6000 0.9327 0.9017[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.615
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.064158
Plausibility completed in  0:00:20.158718
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3788, device='cuda:1')  +-  tensor(0.1767, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4315, device='cuda:1')  +-  tensor(0.2322, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3788, device='cuda:1')  +-  tensor(0.1767, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3924, device='cuda:1')  +-  tensor(0.0774, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.997 +- 0.026
Intervened Stability MCC for r=0.3 = 0.264 +- 0.304
Original Stability F1 for r=0.3 = 0.998 +- 0.017
Intervened Stability F1 for r=0.3 = 0.545 +- 0.192
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.854925
Plausibility completed in  0:00:19.703819
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3775, device='cuda:1')  +-  tensor(0.1758, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4263, device='cuda:1')  +-  tensor(0.2309, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3775, device='cuda:1')  +-  tensor(0.1758, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7364, device='cuda:1')  +-  tensor(0.1242, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.996 +- 0.029
Intervened Stability MCC for r=0.6 = 0.151 +- 0.319
Original Stability F1 for r=0.6 = 0.999 +- 0.011
Intervened Stability F1 for r=0.6 = 0.784 +- 0.115
Intervened samples: 2957
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:34:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/17/2024 08:34:02 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/17/2024 08:34:14 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/17/2024 08:34:16 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/17/2024 08:34:18 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/17/2024 08:34:21 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/17/2024 08:34:28 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:34:28 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:34:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:34:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:34:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:34:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:34:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:34:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:34:28 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:34:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5283 0.9290 0.5283 0.9337 0.9093[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.614
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.529


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.007698
Plausibility completed in  0:00:19.804039
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3756, device='cuda:1')  +-  tensor(0.1727, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4270, device='cuda:1')  +-  tensor(0.2306, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3756, device='cuda:1')  +-  tensor(0.1727, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3883, device='cuda:1')  +-  tensor(0.0766, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.998 +- 0.019
Intervened Stability MCC for r=0.3 = 0.247 +- 0.315
Original Stability F1 for r=0.3 = 0.999 +- 0.013
Intervened Stability F1 for r=0.3 = 0.534 +- 0.198
Intervened samples: 2963


ratio=0.6


Interventions completed in  0:00:05.780640
Plausibility completed in  0:00:19.640855
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3725, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4161, device='cuda:1')  +-  tensor(0.2240, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3725, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7294, device='cuda:1')  +-  tensor(0.1357, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.995 +- 0.040
Intervened Stability MCC for r=0.6 = 0.136 +- 0.310
Original Stability F1 for r=0.6 = 0.998 +- 0.014
Intervened Stability F1 for r=0.6 = 0.780 +- 0.115
Intervened samples: 2940
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:35:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/17/2024 08:35:35 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/17/2024 08:35:47 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/17/2024 08:35:49 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/17/2024 08:35:51 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/17/2024 08:35:54 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/17/2024 08:36:01 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:36:01 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:36:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:36:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:36:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:36:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:36:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:36:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:36:01 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:36:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3330
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3362
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4896
OOD Test ACCURACY: 0.5230
OOD Test Loss: 2.0987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3396
ID Validation ACCURACY: 0.9320
ID Validation Loss: 0.3109
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3440
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4703
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.1198

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.5230 0.9260 0.5683 0.9320 0.9000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.602
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.534


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.039045
Plausibility completed in  0:00:19.787303
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3765, device='cuda:1')  +-  tensor(0.1766, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4305, device='cuda:1')  +-  tensor(0.2332, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3765, device='cuda:1')  +-  tensor(0.1766, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3902, device='cuda:1')  +-  tensor(0.0746, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.998 +- 0.022
Intervened Stability MCC for r=0.3 = 0.270 +- 0.296
Original Stability F1 for r=0.3 = 0.998 +- 0.015
Intervened Stability F1 for r=0.3 = 0.547 +- 0.190
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.822222
Plausibility completed in  0:00:19.648758
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3743, device='cuda:1')  +-  tensor(0.1753, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4227, device='cuda:1')  +-  tensor(0.2316, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3743, device='cuda:1')  +-  tensor(0.1753, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7338, device='cuda:1')  +-  tensor(0.1302, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.995 +- 0.039
Intervened Stability MCC for r=0.6 = 0.170 +- 0.330
Original Stability F1 for r=0.6 = 0.998 +- 0.014
Intervened Stability F1 for r=0.6 = 0.788 +- 0.114
Intervened samples: 2948

\FINISHED GOODMotif - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.37720627 0.37566883] +- [0.00268543 0.00316751] (mean across ratios: 0.376 +- TODO)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.43015224 0.42400938] +- [0.00247492 0.00473906] (mean across ratios: 0.427 +- TODO)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33988453 0.64245427] +- [0.0020861  0.00250645] (mean across ratios: 0.491 +- TODO)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.39158036 0.73525531] +- [0.00251965 0.00343514] (mean across ratios: 0.563 +- TODO)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99771918 0.99839693] +- [0.00127273 0.00027262] (mean across ratios: 0.998 +- TODO)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.5446007  0.78381459] +- [0.00528835 0.00277728] (mean across ratios: 0.664 +- TODO)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99661626 0.99559063] +- [0.00188947 0.00079962] (mean across ratios: 0.996 +- TODO)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.26338971 0.14991559] +- [0.00851853 0.01294123] (mean across ratios: 0.207 +- TODO)

Overall time of execution:  0:07:51.450595
DONE GSAT GOODMotif/size 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:37:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/17/2024 08:37:28 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/17/2024 08:37:40 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/17/2024 08:37:42 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/17/2024 08:37:44 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/17/2024 08:37:47 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/17/2024 08:37:54 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:37:54 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:37:54 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:37:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:37:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:37:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:37:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:37:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:37:54 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:37:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3249
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3247
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4865
OOD Test ACCURACY: 0.4907
OOD Test Loss: 2.1636

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3304
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3315
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4661
OOD Test ACCURACY: 0.5197
OOD Test Loss: 1.7017

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4907 0.9280 0.5197 0.9323 0.9040[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.624
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.543


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.238453
Plausibility completed in  0:00:19.980798
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3815, device='cuda:1')  +-  tensor(0.1784, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4967, device='cuda:1')  +-  tensor(0.2749, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3815, device='cuda:1')  +-  tensor(0.1784, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4515, device='cuda:1')  +-  tensor(0.1046, device='cuda:1') (0.005)
Original Stability MCC for r=0.3 = 0.992 +- 0.053
Intervened Stability MCC for r=0.3 = 0.237 +- 0.336
Original Stability F1 for r=0.3 = 0.995 +- 0.035
Intervened Stability F1 for r=0.3 = 0.577 +- 0.201
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.958119
Plausibility completed in  0:00:20.020055
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3810, device='cuda:1')  +-  tensor(0.1786, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4861, device='cuda:1')  +-  tensor(0.2700, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3810, device='cuda:1')  +-  tensor(0.1786, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8292, device='cuda:1')  +-  tensor(0.1520, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.996 +- 0.028
Intervened Stability MCC for r=0.6 = 0.059 +- 0.266
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.851 +- 0.123
Intervened samples: 2958
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:39:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/17/2024 08:39:04 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/17/2024 08:39:15 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/17/2024 08:39:17 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/17/2024 08:39:19 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/17/2024 08:39:23 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/17/2024 08:39:29 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:39:29 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:39:29 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:39:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:39:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:39:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:39:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:39:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:39:29 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:39:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 122...
[0m[1;37mINFO[0m: [1mCheckpoint 122: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3371
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3138
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3425
OOD Validation ACCURACY: 0.8697
OOD Validation Loss: 0.5698
OOD Test ACCURACY: 0.5503
OOD Test Loss: 1.5812

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9264
Train Loss: 0.3343
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3132
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4750
OOD Test ACCURACY: 0.5800
OOD Test Loss: 2.8730

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5503 0.9273 0.5800 0.9327 0.9030[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.603
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.526


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.025436
Plausibility completed in  0:00:20.160797
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3737, device='cuda:1')  +-  tensor(0.1750, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4907, device='cuda:1')  +-  tensor(0.2727, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3737, device='cuda:1')  +-  tensor(0.1750, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4464, device='cuda:1')  +-  tensor(0.1017, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.997 +- 0.032
Intervened Stability MCC for r=0.3 = 0.245 +- 0.328
Original Stability F1 for r=0.3 = 0.998 +- 0.021
Intervened Stability F1 for r=0.3 = 0.579 +- 0.195
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:06.000016
Plausibility completed in  0:00:19.879454
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3731, device='cuda:1')  +-  tensor(0.1746, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4783, device='cuda:1')  +-  tensor(0.2610, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3731, device='cuda:1')  +-  tensor(0.1746, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8297, device='cuda:1')  +-  tensor(0.1456, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.996 +- 0.027
Intervened Stability MCC for r=0.6 = 0.081 +- 0.292
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.850 +- 0.121
Intervened samples: 2965
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:40:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/17/2024 08:40:36 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/17/2024 08:40:48 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/17/2024 08:40:50 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/17/2024 08:40:52 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/17/2024 08:40:55 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/17/2024 08:41:02 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:41:02 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:41:02 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:41:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:41:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:41:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:41:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:41:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:41:02 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:41:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3328
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3378
OOD Validation ACCURACY: 0.8910
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4787
OOD Test Loss: 2.2870

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3400
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9237
ID Test Loss: 0.3418
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4991
OOD Test ACCURACY: 0.6000
OOD Test Loss: 1.5258

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4787 0.9237 0.6000 0.9327 0.9017[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.615
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.187111
Plausibility completed in  0:00:20.327560
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3788, device='cuda:1')  +-  tensor(0.1767, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4944, device='cuda:1')  +-  tensor(0.2732, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3788, device='cuda:1')  +-  tensor(0.1767, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4477, device='cuda:1')  +-  tensor(0.1023, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.997 +- 0.021
Intervened Stability MCC for r=0.3 = 0.242 +- 0.322
Original Stability F1 for r=0.3 = 0.998 +- 0.015
Intervened Stability F1 for r=0.3 = 0.576 +- 0.191
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.981850
Plausibility completed in  0:00:19.886564
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3775, device='cuda:1')  +-  tensor(0.1758, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4820, device='cuda:1')  +-  tensor(0.2640, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3775, device='cuda:1')  +-  tensor(0.1758, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8292, device='cuda:1')  +-  tensor(0.1530, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.996 +- 0.031
Intervened Stability MCC for r=0.6 = 0.056 +- 0.265
Original Stability F1 for r=0.6 = 0.999 +- 0.011
Intervened Stability F1 for r=0.6 = 0.849 +- 0.124
Intervened samples: 2957
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:42:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/17/2024 08:42:09 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/17/2024 08:42:20 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/17/2024 08:42:22 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/17/2024 08:42:24 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/17/2024 08:42:27 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/17/2024 08:42:34 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:42:34 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:42:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:42:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:42:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:42:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:42:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:42:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:42:34 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:42:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5283 0.9290 0.5283 0.9337 0.9093[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.614
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.529


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.221224
Plausibility completed in  0:00:20.035384
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3756, device='cuda:1')  +-  tensor(0.1727, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4903, device='cuda:1')  +-  tensor(0.2737, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3756, device='cuda:1')  +-  tensor(0.1727, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4436, device='cuda:1')  +-  tensor(0.1014, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.999 +- 0.017
Intervened Stability MCC for r=0.3 = 0.223 +- 0.331
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.570 +- 0.192
Intervened samples: 2963


ratio=0.6


Interventions completed in  0:00:05.966767
Plausibility completed in  0:00:19.852376
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3725, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4692, device='cuda:1')  +-  tensor(0.2580, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3725, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8201, device='cuda:1')  +-  tensor(0.1642, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.992 +- 0.054
Intervened Stability MCC for r=0.6 = 0.077 +- 0.281
Original Stability F1 for r=0.6 = 0.997 +- 0.018
Intervened Stability F1 for r=0.6 = 0.851 +- 0.123
Intervened samples: 2940
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 17 20:43:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/17/2024 08:43:41 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/17/2024 08:43:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/17/2024 08:43:54 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/17/2024 08:43:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/17/2024 08:44:00 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/17/2024 08:44:06 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/17/2024 08:44:06 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/17/2024 08:44:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/17/2024 08:44:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:44:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:44:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:44:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/17/2024 08:44:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/17/2024 08:44:06 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/17/2024 08:44:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3330
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3362
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4896
OOD Test ACCURACY: 0.5230
OOD Test Loss: 2.0987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3396
ID Validation ACCURACY: 0.9320
ID Validation Loss: 0.3109
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3440
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4703
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.1198

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.5230 0.9260 0.5683 0.9320 0.9000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.602
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.534


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.155380
Plausibility completed in  0:00:19.973067
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3765, device='cuda:1')  +-  tensor(0.1766, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4925, device='cuda:1')  +-  tensor(0.2723, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3765, device='cuda:1')  +-  tensor(0.1766, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4444, device='cuda:1')  +-  tensor(0.0993, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.998 +- 0.023
Intervened Stability MCC for r=0.3 = 0.239 +- 0.321
Original Stability F1 for r=0.3 = 0.999 +- 0.015
Intervened Stability F1 for r=0.3 = 0.574 +- 0.191
Intervened samples: 2971


ratio=0.6


Interventions completed in  0:00:05.940623
Plausibility completed in  0:00:19.838028
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3743, device='cuda:1')  +-  tensor(0.1753, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4776, device='cuda:1')  +-  tensor(0.2646, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3743, device='cuda:1')  +-  tensor(0.1753, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8252, device='cuda:1')  +-  tensor(0.1585, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.995 +- 0.039
Intervened Stability MCC for r=0.6 = 0.074 +- 0.276
Original Stability F1 for r=0.6 = 0.998 +- 0.014
Intervened Stability F1 for r=0.6 = 0.852 +- 0.120
Intervened samples: 2948

\FINISHED GOODMotif - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.37720634 0.3756689 ] +- [0.00268541 0.00316748] (mean across ratios: 0.376 +- TODO)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.49293044 0.47863468] +- [0.00240564 0.0056202 ] (mean across ratios: 0.486 +- TODO)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33988453 0.64245414] +- [0.0020861  0.00250645] (mean across ratios: 0.491 +- TODO)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.44672094 0.8266811 ] +- [0.00279718 0.00366562] (mean across ratios: 0.637 +- TODO)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99763036 0.99818152] +- [0.00155925 0.00049476] (mean across ratios: 0.998 +- TODO)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.57504236 0.8505908 ] +- [0.00310321 0.00086144] (mean across ratios: 0.713 +- TODO)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99648218 0.99497958] +- [0.00234688 0.00148597] (mean across ratios: 0.996 +- TODO)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.23724382 0.06937048] +- [0.0077809  0.00975629] (mean across ratios: 0.153 +- TODO)

Overall time of execution:  0:07:46.860273
DONE GSAT GOODMotif/size 0.10
DONE all :)
